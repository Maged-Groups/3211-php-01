var vZ=Object.defineProperty;var wZ=(e,t,n)=>t in e?vZ(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var F=(e,t,n)=>(wZ(e,typeof t!="symbol"?t+"":t,n),n);function _Z(e,t){for(var n=0;n<t.length;n++){const i=t[n];if(typeof i!="string"&&!Array.isArray(i)){for(const s in i)if(s!=="default"&&!(s in e)){const r=Object.getOwnPropertyDescriptor(i,s);r&&Object.defineProperty(e,s,r.get?r:{enumerable:!0,get:()=>i[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=n(s);fetch(s.href,r)}})();var La=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function bl(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var bN={exports:{}},b5={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TZ=Symbol.for("react.transitional.element"),IZ=Symbol.for("react.fragment");function yN(e,t,n){var i=null;if(n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),"key"in t){n={};for(var s in t)s!=="key"&&(n[s]=t[s])}else n=t;return t=n.ref,{$$typeof:TZ,type:e,key:i,ref:t!==void 0?t:null,props:n}}b5.Fragment=IZ;b5.jsx=yN;b5.jsxs=yN;bN.exports=b5;var fw=bN.exports;const fe=fw.Fragment,g=fw.jsx,N=fw.jsxs;var EN={exports:{}},Ye={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hw=Symbol.for("react.transitional.element"),SZ=Symbol.for("react.portal"),xZ=Symbol.for("react.fragment"),CZ=Symbol.for("react.strict_mode"),AZ=Symbol.for("react.profiler"),MZ=Symbol.for("react.consumer"),kZ=Symbol.for("react.context"),RZ=Symbol.for("react.forward_ref"),DZ=Symbol.for("react.suspense"),LZ=Symbol.for("react.memo"),vN=Symbol.for("react.lazy"),JS=Symbol.iterator;function NZ(e){return e===null||typeof e!="object"?null:(e=JS&&e[JS]||e["@@iterator"],typeof e=="function"?e:null)}var wN={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_N=Object.assign,TN={};function ag(e,t,n){this.props=e,this.context=t,this.refs=TN,this.updater=n||wN}ag.prototype.isReactComponent={};ag.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ag.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function IN(){}IN.prototype=ag.prototype;function gw(e,t,n){this.props=e,this.context=t,this.refs=TN,this.updater=n||wN}var mw=gw.prototype=new IN;mw.constructor=gw;_N(mw,ag.prototype);mw.isPureReactComponent=!0;var ex=Array.isArray,Un={H:null,A:null,T:null,S:null},SN=Object.prototype.hasOwnProperty;function pw(e,t,n,i,s,r){return n=r.ref,{$$typeof:hw,type:e,key:t,ref:n!==void 0?n:null,props:r}}function OZ(e,t){return pw(e.type,t,void 0,void 0,void 0,e.props)}function Uw(e){return typeof e=="object"&&e!==null&&e.$$typeof===hw}function PZ(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var tx=/\/+/g;function ME(e,t){return typeof e=="object"&&e!==null&&e.key!=null?PZ(""+e.key):t.toString(36)}function nx(){}function FZ(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch(typeof e.status=="string"?e.then(nx,nx):(e.status="pending",e.then(function(t){e.status==="pending"&&(e.status="fulfilled",e.value=t)},function(t){e.status==="pending"&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}function gf(e,t,n,i,s){var r=typeof e;(r==="undefined"||r==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(r){case"bigint":case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case hw:case SZ:o=!0;break;case vN:return o=e._init,gf(o(e._payload),t,n,i,s)}}if(o)return s=s(e),o=i===""?"."+ME(e,0):i,ex(s)?(n="",o!=null&&(n=o.replace(tx,"$&/")+"/"),gf(s,t,n,"",function(c){return c})):s!=null&&(Uw(s)&&(s=OZ(s,n+(s.key==null||e&&e.key===s.key?"":(""+s.key).replace(tx,"$&/")+"/")+o)),t.push(s)),1;o=0;var a=i===""?".":i+":";if(ex(e))for(var l=0;l<e.length;l++)i=e[l],r=a+ME(i,l),o+=gf(i,t,n,r,s);else if(l=NZ(e),typeof l=="function")for(e=l.call(e),l=0;!(i=e.next()).done;)i=i.value,r=a+ME(i,l++),o+=gf(i,t,n,r,s);else if(r==="object"){if(typeof e.then=="function")return gf(FZ(e),t,n,i,s);throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return o}function oU(e,t,n){if(e==null)return e;var i=[],s=0;return gf(e,i,"","",function(r){return t.call(n,r,s++)}),i}function BZ(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ix=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function zZ(){}Ye.Children={map:oU,forEach:function(e,t,n){oU(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return oU(e,function(){t++}),t},toArray:function(e){return oU(e,function(t){return t})||[]},only:function(e){if(!Uw(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ye.Component=ag;Ye.Fragment=xZ;Ye.Profiler=AZ;Ye.PureComponent=gw;Ye.StrictMode=CZ;Ye.Suspense=DZ;Ye.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Un;Ye.act=function(){throw Error("act(...) is not supported in production builds of React.")};Ye.cache=function(e){return function(){return e.apply(null,arguments)}};Ye.cloneElement=function(e,t,n){if(e==null)throw Error("The argument must be a React element, but you passed "+e+".");var i=_N({},e.props),s=e.key,r=void 0;if(t!=null)for(o in t.ref!==void 0&&(r=void 0),t.key!==void 0&&(s=""+t.key),t)!SN.call(t,o)||o==="key"||o==="__self"||o==="__source"||o==="ref"&&t.ref===void 0||(i[o]=t[o]);var o=arguments.length-2;if(o===1)i.children=n;else if(1<o){for(var a=Array(o),l=0;l<o;l++)a[l]=arguments[l+2];i.children=a}return pw(e.type,s,void 0,void 0,r,i)};Ye.createContext=function(e){return e={$$typeof:kZ,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null},e.Provider=e,e.Consumer={$$typeof:MZ,_context:e},e};Ye.createElement=function(e,t,n){var i,s={},r=null;if(t!=null)for(i in t.key!==void 0&&(r=""+t.key),t)SN.call(t,i)&&i!=="key"&&i!=="__self"&&i!=="__source"&&(s[i]=t[i]);var o=arguments.length-2;if(o===1)s.children=n;else if(1<o){for(var a=Array(o),l=0;l<o;l++)a[l]=arguments[l+2];s.children=a}if(e&&e.defaultProps)for(i in o=e.defaultProps,o)s[i]===void 0&&(s[i]=o[i]);return pw(e,r,void 0,void 0,null,s)};Ye.createRef=function(){return{current:null}};Ye.forwardRef=function(e){return{$$typeof:RZ,render:e}};Ye.isValidElement=Uw;Ye.lazy=function(e){return{$$typeof:vN,_payload:{_status:-1,_result:e},_init:BZ}};Ye.memo=function(e,t){return{$$typeof:LZ,type:e,compare:t===void 0?null:t}};Ye.startTransition=function(e){var t=Un.T,n={};Un.T=n;try{var i=e(),s=Un.S;s!==null&&s(n,i),typeof i=="object"&&i!==null&&typeof i.then=="function"&&i.then(zZ,ix)}catch(r){ix(r)}finally{Un.T=t}};Ye.unstable_useCacheRefresh=function(){return Un.H.useCacheRefresh()};Ye.use=function(e){return Un.H.use(e)};Ye.useActionState=function(e,t,n){return Un.H.useActionState(e,t,n)};Ye.useCallback=function(e,t){return Un.H.useCallback(e,t)};Ye.useContext=function(e){return Un.H.useContext(e)};Ye.useDebugValue=function(){};Ye.useDeferredValue=function(e,t){return Un.H.useDeferredValue(e,t)};Ye.useEffect=function(e,t){return Un.H.useEffect(e,t)};Ye.useId=function(){return Un.H.useId()};Ye.useImperativeHandle=function(e,t,n){return Un.H.useImperativeHandle(e,t,n)};Ye.useInsertionEffect=function(e,t){return Un.H.useInsertionEffect(e,t)};Ye.useLayoutEffect=function(e,t){return Un.H.useLayoutEffect(e,t)};Ye.useMemo=function(e,t){return Un.H.useMemo(e,t)};Ye.useOptimistic=function(e,t){return Un.H.useOptimistic(e,t)};Ye.useReducer=function(e,t,n){return Un.H.useReducer(e,t,n)};Ye.useRef=function(e){return Un.H.useRef(e)};Ye.useState=function(e){return Un.H.useState(e)};Ye.useSyncExternalStore=function(e,t,n){return Un.H.useSyncExternalStore(e,t,n)};Ye.useTransition=function(){return Un.H.useTransition()};Ye.version="19.0.0";EN.exports=Ye;var D=EN.exports;const ae=bl(D),HZ=_Z({__proto__:null,default:ae},[D]);var xN={exports:{}},y5={},CN={exports:{}},AN={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(z,V){var $=z.length;z.push(V);e:for(;0<$;){var j=$-1>>>1,W=z[j];if(0<s(W,V))z[j]=V,z[$]=W,$=j;else break e}}function n(z){return z.length===0?null:z[0]}function i(z){if(z.length===0)return null;var V=z[0],$=z.pop();if($!==V){z[0]=$;e:for(var j=0,W=z.length,Q=W>>>1;j<Q;){var oe=2*(j+1)-1,me=z[oe],he=oe+1,Me=z[he];if(0>s(me,$))he<W&&0>s(Me,me)?(z[j]=Me,z[he]=$,j=he):(z[j]=me,z[oe]=$,j=oe);else if(he<W&&0>s(Me,$))z[j]=Me,z[he]=$,j=he;else break e}}return V}function s(z,V){var $=z.sortIndex-V.sortIndex;return $!==0?$:z.id-V.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;e.unstable_now=function(){return r.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,d=null,f=3,h=!1,m=!1,p=!1,U=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;function w(z){for(var V=n(c);V!==null;){if(V.callback===null)i(c);else if(V.startTime<=z)i(c),V.sortIndex=V.expirationTime,t(l,V);else break;V=n(c)}}function v(z){if(p=!1,w(z),!m)if(n(l)!==null)m=!0,X();else{var V=n(c);V!==null&&G(v,V.startTime-z)}}var I=!1,C=-1,_=5,T=-1;function k(){return!(e.unstable_now()-T<_)}function S(){if(I){var z=e.unstable_now();T=z;var V=!0;try{e:{m=!1,p&&(p=!1,b(C),C=-1),h=!0;var $=f;try{t:{for(w(z),d=n(l);d!==null&&!(d.expirationTime>z&&k());){var j=d.callback;if(typeof j=="function"){d.callback=null,f=d.priorityLevel;var W=j(d.expirationTime<=z);if(z=e.unstable_now(),typeof W=="function"){d.callback=W,w(z),V=!0;break t}d===n(l)&&i(l),w(z)}else i(l);d=n(l)}if(d!==null)V=!0;else{var Q=n(c);Q!==null&&G(v,Q.startTime-z),V=!1}}break e}finally{d=null,f=$,h=!1}V=void 0}}finally{V?R():I=!1}}}var R;if(typeof y=="function")R=function(){y(S)};else if(typeof MessageChannel<"u"){var P=new MessageChannel,L=P.port2;P.port1.onmessage=S,R=function(){L.postMessage(null)}}else R=function(){U(S,0)};function X(){I||(I=!0,R())}function G(z,V){C=U(function(){z(e.unstable_now())},V)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(z){z.callback=null},e.unstable_continueExecution=function(){m||h||(m=!0,X())},e.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<z?Math.floor(1e3/z):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(z){switch(f){case 1:case 2:case 3:var V=3;break;default:V=f}var $=f;f=V;try{return z()}finally{f=$}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(z,V){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var $=f;f=z;try{return V()}finally{f=$}},e.unstable_scheduleCallback=function(z,V,$){var j=e.unstable_now();switch(typeof $=="object"&&$!==null?($=$.delay,$=typeof $=="number"&&0<$?j+$:j):$=j,z){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=$+W,z={id:u++,callback:V,priorityLevel:z,startTime:$,expirationTime:W,sortIndex:-1},$>j?(z.sortIndex=$,t(c,z),n(l)===null&&z===n(c)&&(p?(b(C),C=-1):p=!0,G(v,$-j))):(z.sortIndex=W,t(l,z),m||h||(m=!0,X())),z},e.unstable_shouldYield=k,e.unstable_wrapCallback=function(z){var V=f;return function(){var $=f;f=V;try{return z.apply(this,arguments)}finally{f=$}}}})(AN);CN.exports=AN;var VZ=CN.exports,MN={exports:{}},ms={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $Z=D;function kN(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Al(){}var cs={d:{f:Al,r:function(){throw Error(kN(522))},D:Al,C:Al,L:Al,m:Al,X:Al,S:Al,M:Al},p:0,findDOMNode:null},GZ=Symbol.for("react.portal");function XZ(e,t,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:GZ,key:i==null?null:""+i,children:e,containerInfo:t,implementation:n}}var q1=$Z.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function E5(e,t){if(e==="font")return"";if(typeof t=="string")return t==="use-credentials"?t:""}ms.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=cs;ms.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)throw Error(kN(299));return XZ(e,t,null,n)};ms.flushSync=function(e){var t=q1.T,n=cs.p;try{if(q1.T=null,cs.p=2,e)return e()}finally{q1.T=t,cs.p=n,cs.d.f()}};ms.preconnect=function(e,t){typeof e=="string"&&(t?(t=t.crossOrigin,t=typeof t=="string"?t==="use-credentials"?t:"":void 0):t=null,cs.d.C(e,t))};ms.prefetchDNS=function(e){typeof e=="string"&&cs.d.D(e)};ms.preinit=function(e,t){if(typeof e=="string"&&t&&typeof t.as=="string"){var n=t.as,i=E5(n,t.crossOrigin),s=typeof t.integrity=="string"?t.integrity:void 0,r=typeof t.fetchPriority=="string"?t.fetchPriority:void 0;n==="style"?cs.d.S(e,typeof t.precedence=="string"?t.precedence:void 0,{crossOrigin:i,integrity:s,fetchPriority:r}):n==="script"&&cs.d.X(e,{crossOrigin:i,integrity:s,fetchPriority:r,nonce:typeof t.nonce=="string"?t.nonce:void 0})}};ms.preinitModule=function(e,t){if(typeof e=="string")if(typeof t=="object"&&t!==null){if(t.as==null||t.as==="script"){var n=E5(t.as,t.crossOrigin);cs.d.M(e,{crossOrigin:n,integrity:typeof t.integrity=="string"?t.integrity:void 0,nonce:typeof t.nonce=="string"?t.nonce:void 0})}}else t==null&&cs.d.M(e)};ms.preload=function(e,t){if(typeof e=="string"&&typeof t=="object"&&t!==null&&typeof t.as=="string"){var n=t.as,i=E5(n,t.crossOrigin);cs.d.L(e,n,{crossOrigin:i,integrity:typeof t.integrity=="string"?t.integrity:void 0,nonce:typeof t.nonce=="string"?t.nonce:void 0,type:typeof t.type=="string"?t.type:void 0,fetchPriority:typeof t.fetchPriority=="string"?t.fetchPriority:void 0,referrerPolicy:typeof t.referrerPolicy=="string"?t.referrerPolicy:void 0,imageSrcSet:typeof t.imageSrcSet=="string"?t.imageSrcSet:void 0,imageSizes:typeof t.imageSizes=="string"?t.imageSizes:void 0,media:typeof t.media=="string"?t.media:void 0})}};ms.preloadModule=function(e,t){if(typeof e=="string")if(t){var n=E5(t.as,t.crossOrigin);cs.d.m(e,{as:typeof t.as=="string"&&t.as!=="script"?t.as:void 0,crossOrigin:n,integrity:typeof t.integrity=="string"?t.integrity:void 0})}else cs.d.m(e)};ms.requestFormReset=function(e){cs.d.r(e)};ms.unstable_batchedUpdates=function(e,t){return e(t)};ms.useFormState=function(e,t,n){return q1.H.useFormState(e,t,n)};ms.useFormStatus=function(){return q1.H.useHostTransitionStatus()};ms.version="19.0.0";function RN(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(RN)}catch(e){console.error(e)}}RN(),MN.exports=ms;var hi=MN.exports;const jZ=bl(hi);/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ii=VZ,DN=D,YZ=hi;function ne(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function LN(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}var WZ=Symbol.for("react.element"),aU=Symbol.for("react.transitional.element"),S1=Symbol.for("react.portal"),xf=Symbol.for("react.fragment"),NN=Symbol.for("react.strict_mode"),t7=Symbol.for("react.profiler"),KZ=Symbol.for("react.provider"),ON=Symbol.for("react.consumer"),Na=Symbol.for("react.context"),bw=Symbol.for("react.forward_ref"),n7=Symbol.for("react.suspense"),i7=Symbol.for("react.suspense_list"),yw=Symbol.for("react.memo"),Vl=Symbol.for("react.lazy"),PN=Symbol.for("react.offscreen"),ZZ=Symbol.for("react.memo_cache_sentinel"),sx=Symbol.iterator;function Kg(e){return e===null||typeof e!="object"?null:(e=sx&&e[sx]||e["@@iterator"],typeof e=="function"?e:null)}var qZ=Symbol.for("react.client.reference");function s7(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===qZ?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case xf:return"Fragment";case S1:return"Portal";case t7:return"Profiler";case NN:return"StrictMode";case n7:return"Suspense";case i7:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Na:return(e.displayName||"Context")+".Provider";case ON:return(e._context.displayName||"Context")+".Consumer";case bw:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case yw:return t=e.displayName||null,t!==null?t:s7(e.type)||"Memo";case Vl:t=e._payload,e=e._init;try{return s7(e(t))}catch{}}return null}var Xe=DN.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,sn=Object.assign,kE,rx;function x1(e){if(kE===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);kE=t&&t[1]||"",rx=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+kE+e+rx}var RE=!1;function DE(e,t){if(!e||RE)return"";RE=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(t){var d=function(){throw Error()};if(Object.defineProperty(d.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(d,[])}catch(h){var f=h}Reflect.construct(e,[],d)}else{try{d.call()}catch(h){f=h}e.call(d.prototype)}}else{try{throw Error()}catch(h){f=h}(d=e())&&typeof d.catch=="function"&&d.catch(function(){})}}catch(h){if(h&&f&&typeof h.stack=="string")return[h.stack,f.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var s=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");s&&s.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var r=i.DetermineComponentFrameRoot(),o=r[0],a=r[1];if(o&&a){var l=o.split(`
`),c=a.split(`
`);for(s=i=0;i<l.length&&!l[i].includes("DetermineComponentFrameRoot");)i++;for(;s<c.length&&!c[s].includes("DetermineComponentFrameRoot");)s++;if(i===l.length||s===c.length)for(i=l.length-1,s=c.length-1;1<=i&&0<=s&&l[i]!==c[s];)s--;for(;1<=i&&0<=s;i--,s--)if(l[i]!==c[s]){if(i!==1||s!==1)do if(i--,s--,0>s||l[i]!==c[s]){var u=`
`+l[i].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=i&&0<=s);break}}}finally{RE=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?x1(n):""}function QZ(e){switch(e.tag){case 26:case 27:case 5:return x1(e.type);case 16:return x1("Lazy");case 13:return x1("Suspense");case 19:return x1("SuspenseList");case 0:case 15:return e=DE(e.type,!1),e;case 11:return e=DE(e.type.render,!1),e;case 1:return e=DE(e.type,!0),e;default:return""}}function ox(e){try{var t="";do t+=QZ(e),e=e.return;while(e);return t}catch(n){return`
Error generating stack: `+n.message+`
`+n.stack}}function lg(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function FN(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function ax(e){if(lg(e)!==e)throw Error(ne(188))}function JZ(e){var t=e.alternate;if(!t){if(t=lg(e),t===null)throw Error(ne(188));return t!==e?null:e}for(var n=e,i=t;;){var s=n.return;if(s===null)break;var r=s.alternate;if(r===null){if(i=s.return,i!==null){n=i;continue}break}if(s.child===r.child){for(r=s.child;r;){if(r===n)return ax(s),e;if(r===i)return ax(s),t;r=r.sibling}throw Error(ne(188))}if(n.return!==i.return)n=s,i=r;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,i=r;break}if(a===i){o=!0,i=s,n=r;break}a=a.sibling}if(!o){for(a=r.child;a;){if(a===n){o=!0,n=r,i=s;break}if(a===i){o=!0,i=r,n=s;break}a=a.sibling}if(!o)throw Error(ne(189))}}if(n.alternate!==i)throw Error(ne(190))}if(n.tag!==3)throw Error(ne(188));return n.stateNode.current===n?e:t}function BN(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=BN(e),t!==null)return t;e=e.sibling}return null}var C1=Array.isArray,nn=YZ.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Hu={pending:!1,data:null,method:null,action:null},r7=[],Cf=-1;function oa(e){return{current:e}}function yi(e){0>Cf||(e.current=r7[Cf],r7[Cf]=null,Cf--)}function cn(e,t){Cf++,r7[Cf]=e.current,e.current=t}var zo=oa(null),H0=oa(null),uc=oa(null),ob=oa(null);function ab(e,t){switch(cn(uc,t),cn(H0,e),cn(zo,null),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)&&(t=t.namespaceURI)?lC(t):0;break;default:if(e=e===8?t.parentNode:t,t=e.tagName,e=e.namespaceURI)e=lC(e),t=qP(e,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}yi(zo),cn(zo,t)}function vh(){yi(zo),yi(H0),yi(uc)}function o7(e){e.memoizedState!==null&&cn(ob,e);var t=zo.current,n=qP(t,e.type);t!==n&&(cn(H0,e),cn(zo,n))}function lb(e){H0.current===e&&(yi(zo),yi(H0)),ob.current===e&&(yi(ob),Q0._currentValue=Hu)}var a7=Object.prototype.hasOwnProperty,Ew=ii.unstable_scheduleCallback,LE=ii.unstable_cancelCallback,eq=ii.unstable_shouldYield,tq=ii.unstable_requestPaint,Ho=ii.unstable_now,nq=ii.unstable_getCurrentPriorityLevel,zN=ii.unstable_ImmediatePriority,HN=ii.unstable_UserBlockingPriority,cb=ii.unstable_NormalPriority,iq=ii.unstable_LowPriority,VN=ii.unstable_IdlePriority,sq=ii.log,rq=ii.unstable_setDisableYieldValue,Km=null,Ys=null;function oq(e){if(Ys&&typeof Ys.onCommitFiberRoot=="function")try{Ys.onCommitFiberRoot(Km,e,void 0,(e.current.flags&128)===128)}catch{}}function nc(e){if(typeof sq=="function"&&rq(e),Ys&&typeof Ys.setStrictMode=="function")try{Ys.setStrictMode(Km,e)}catch{}}var Ws=Math.clz32?Math.clz32:cq,aq=Math.log,lq=Math.LN2;function cq(e){return e>>>=0,e===0?32:31-(aq(e)/lq|0)|0}var lU=128,cU=4194304;function bu(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function v5(e,t){var n=e.pendingLanes;if(n===0)return 0;var i=0,s=e.suspendedLanes,r=e.pingedLanes,o=e.warmLanes;e=e.finishedLanes!==0;var a=n&134217727;return a!==0?(n=a&~s,n!==0?i=bu(n):(r&=a,r!==0?i=bu(r):e||(o=a&~o,o!==0&&(i=bu(o))))):(a=n&~s,a!==0?i=bu(a):r!==0?i=bu(r):e||(o=n&~o,o!==0&&(i=bu(o)))),i===0?0:t!==0&&t!==i&&!(t&s)&&(s=i&-i,o=t&-t,s>=o||s===32&&(o&4194176)!==0)?t:i}function Zm(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function uq(e,t){switch(e){case 1:case 2:case 4:case 8:return t+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $N(){var e=lU;return lU<<=1,!(lU&4194176)&&(lU=128),e}function GN(){var e=cU;return cU<<=1,!(cU&62914560)&&(cU=4194304),e}function NE(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function qm(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function dq(e,t,n,i,s,r){var o=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var a=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=o&~n;0<n;){var u=31-Ws(n),d=1<<u;a[u]=0,l[u]=-1;var f=c[u];if(f!==null)for(c[u]=null,u=0;u<f.length;u++){var h=f[u];h!==null&&(h.lane&=-536870913)}n&=~d}i!==0&&XN(e,i,0),r!==0&&s===0&&e.tag!==0&&(e.suspendedLanes|=r&~(o&~t))}function XN(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var i=31-Ws(t);e.entangledLanes|=t,e.entanglements[i]=e.entanglements[i]|1073741824|n&4194218}function jN(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-Ws(n),s=1<<i;s&t|e[i]&t&&(e[i]|=t),n&=~s}}function YN(e){return e&=-e,2<e?8<e?e&134217727?32:268435456:8:2}function WN(){var e=nn.p;return e!==0?e:(e=window.event,e===void 0?32:aF(e.type))}function fq(e,t){var n=nn.p;try{return nn.p=e,t()}finally{nn.p=n}}var Jc=Math.random().toString(36).slice(2),ji="__reactFiber$"+Jc,xs="__reactProps$"+Jc,cg="__reactContainer$"+Jc,l7="__reactEvents$"+Jc,hq="__reactListeners$"+Jc,gq="__reactHandles$"+Jc,lx="__reactResources$"+Jc,V0="__reactMarker$"+Jc;function vw(e){delete e[ji],delete e[xs],delete e[l7],delete e[hq],delete e[gq]}function Mu(e){var t=e[ji];if(t)return t;for(var n=e.parentNode;n;){if(t=n[cg]||n[ji]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=uC(e);e!==null;){if(n=e[ji])return n;e=uC(e)}return t}e=n,n=e.parentNode}return null}function ug(e){if(e=e[ji]||e[cg]){var t=e.tag;if(t===5||t===6||t===13||t===26||t===27||t===3)return e}return null}function A1(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(ne(33))}function Zf(e){var t=e[lx];return t||(t=e[lx]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function gi(e){e[V0]=!0}var KN=new Set,ZN={};function Ad(e,t){wh(e,t),wh(e+"Capture",t)}function wh(e,t){for(ZN[e]=t,e=0;e<t.length;e++)KN.add(t[e])}var el=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),mq=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),cx={},ux={};function pq(e){return a7.call(ux,e)?!0:a7.call(cx,e)?!1:mq.test(e)?ux[e]=!0:(cx[e]=!0,!1)}function f2(e,t,n){if(pq(t))if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var i=t.toLowerCase().slice(0,5);if(i!=="data-"&&i!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+n)}}function uU(e,t,n){if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+n)}}function fa(e,t,n,i){if(i===null)e.removeAttribute(n);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttributeNS(t,n,""+i)}}function dr(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function qN(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Uq(e){var t=qN(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,r=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){i=""+o,r.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ub(e){e._valueTracker||(e._valueTracker=Uq(e))}function QN(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=qN(e)?e.checked?"true":"false":e.value),e=i,e!==n?(t.setValue(e),!0):!1}function db(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var bq=/[\n"\\]/g;function gr(e){return e.replace(bq,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function c7(e,t,n,i,s,r,o,a){e.name="",o!=null&&typeof o!="function"&&typeof o!="symbol"&&typeof o!="boolean"?e.type=o:e.removeAttribute("type"),t!=null?o==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+dr(t)):e.value!==""+dr(t)&&(e.value=""+dr(t)):o!=="submit"&&o!=="reset"||e.removeAttribute("value"),t!=null?u7(e,o,dr(t)):n!=null?u7(e,o,dr(n)):i!=null&&e.removeAttribute("value"),s==null&&r!=null&&(e.defaultChecked=!!r),s!=null&&(e.checked=s&&typeof s!="function"&&typeof s!="symbol"),a!=null&&typeof a!="function"&&typeof a!="symbol"&&typeof a!="boolean"?e.name=""+dr(a):e.removeAttribute("name")}function JN(e,t,n,i,s,r,o,a){if(r!=null&&typeof r!="function"&&typeof r!="symbol"&&typeof r!="boolean"&&(e.type=r),t!=null||n!=null){if(!(r!=="submit"&&r!=="reset"||t!=null))return;n=n!=null?""+dr(n):"",t=t!=null?""+dr(t):n,a||t===e.value||(e.value=t),e.defaultValue=t}i=i??s,i=typeof i!="function"&&typeof i!="symbol"&&!!i,e.checked=a?e.checked:!!i,e.defaultChecked=!!i,o!=null&&typeof o!="function"&&typeof o!="symbol"&&typeof o!="boolean"&&(e.name=o)}function u7(e,t,n){t==="number"&&db(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function qf(e,t,n,i){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&i&&(e[n].defaultSelected=!0)}else{for(n=""+dr(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,i&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function eO(e,t,n){if(t!=null&&(t=""+dr(t),t!==e.value&&(e.value=t),n==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=n!=null?""+dr(n):""}function tO(e,t,n,i){if(t==null){if(i!=null){if(n!=null)throw Error(ne(92));if(C1(i)){if(1<i.length)throw Error(ne(93));i=i[0]}n=i}n==null&&(n=""),t=n}n=dr(t),e.defaultValue=n,i=e.textContent,i===n&&i!==""&&i!==null&&(e.value=i)}function _h(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var yq=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function dx(e,t,n){var i=t.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?i?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":i?e.setProperty(t,n):typeof n!="number"||n===0||yq.has(t)?t==="float"?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function nO(e,t,n){if(t!=null&&typeof t!="object")throw Error(ne(62));if(e=e.style,n!=null){for(var i in n)!n.hasOwnProperty(i)||t!=null&&t.hasOwnProperty(i)||(i.indexOf("--")===0?e.setProperty(i,""):i==="float"?e.cssFloat="":e[i]="");for(var s in t)i=t[s],t.hasOwnProperty(s)&&n[s]!==i&&dx(e,s,i)}else for(var r in t)t.hasOwnProperty(r)&&dx(e,r,t[r])}function ww(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Eq=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),vq=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function h2(e){return vq.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var d7=null;function _w(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Af=null,Qf=null;function fx(e){var t=ug(e);if(t&&(e=t.stateNode)){var n=e[xs]||null;e:switch(e=t.stateNode,t.type){case"input":if(c7(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+gr(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var s=i[xs]||null;if(!s)throw Error(ne(90));c7(i,s.value,s.defaultValue,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name)}}for(t=0;t<n.length;t++)i=n[t],i.form===e.form&&QN(i)}break e;case"textarea":eO(e,n.value,n.defaultValue);break e;case"select":t=n.value,t!=null&&qf(e,!!n.multiple,t,!1)}}}var OE=!1;function iO(e,t,n){if(OE)return e(t,n);OE=!0;try{var i=e(t);return i}finally{if(OE=!1,(Af!==null||Qf!==null)&&(k5(),Af&&(t=Af,e=Qf,Qf=Af=null,fx(t),e)))for(t=0;t<e.length;t++)fx(e[t])}}function $0(e,t){var n=e.stateNode;if(n===null)return null;var i=n[xs]||null;if(i===null)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(ne(231,t,typeof n));return n}var f7=!1;if(el)try{var Zg={};Object.defineProperty(Zg,"passive",{get:function(){f7=!0}}),window.addEventListener("test",Zg,Zg),window.removeEventListener("test",Zg,Zg)}catch{f7=!1}var ic=null,Tw=null,g2=null;function sO(){if(g2)return g2;var e,t=Tw,n=t.length,i,s="value"in ic?ic.value:ic.textContent,r=s.length;for(e=0;e<n&&t[e]===s[e];e++);var o=n-e;for(i=1;i<=o&&t[n-i]===s[r-i];i++);return g2=s.slice(e,1<i?1-i:void 0)}function m2(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function dU(){return!0}function hx(){return!1}function As(e){function t(n,i,s,r,o){this._reactName=n,this._targetInst=s,this.type=i,this.nativeEvent=r,this.target=o,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(n=e[a],this[a]=n?n(r):r[a]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?dU:hx,this.isPropagationStopped=hx,this}return sn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=dU)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=dU)},persist:function(){},isPersistent:dU}),t}var Md={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},w5=As(Md),Qm=sn({},Md,{view:0,detail:0}),wq=As(Qm),PE,FE,qg,_5=sn({},Qm,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Iw,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==qg&&(qg&&e.type==="mousemove"?(PE=e.screenX-qg.screenX,FE=e.screenY-qg.screenY):FE=PE=0,qg=e),PE)},movementY:function(e){return"movementY"in e?e.movementY:FE}}),gx=As(_5),_q=sn({},_5,{dataTransfer:0}),Tq=As(_q),Iq=sn({},Qm,{relatedTarget:0}),BE=As(Iq),Sq=sn({},Md,{animationName:0,elapsedTime:0,pseudoElement:0}),xq=As(Sq),Cq=sn({},Md,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Aq=As(Cq),Mq=sn({},Md,{data:0}),mx=As(Mq),kq={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Rq={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Dq={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Lq(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Dq[e])?!!t[e]:!1}function Iw(){return Lq}var Nq=sn({},Qm,{key:function(e){if(e.key){var t=kq[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=m2(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Rq[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Iw,charCode:function(e){return e.type==="keypress"?m2(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?m2(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Oq=As(Nq),Pq=sn({},_5,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),px=As(Pq),Fq=sn({},Qm,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Iw}),Bq=As(Fq),zq=sn({},Md,{propertyName:0,elapsedTime:0,pseudoElement:0}),Hq=As(zq),Vq=sn({},_5,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),$q=As(Vq),Gq=sn({},Md,{newState:0,oldState:0}),Xq=As(Gq),jq=[9,13,27,32],Sw=el&&"CompositionEvent"in window,Q1=null;el&&"documentMode"in document&&(Q1=document.documentMode);var Yq=el&&"TextEvent"in window&&!Q1,rO=el&&(!Sw||Q1&&8<Q1&&11>=Q1),Ux=" ",bx=!1;function oO(e,t){switch(e){case"keyup":return jq.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function aO(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Mf=!1;function Wq(e,t){switch(e){case"compositionend":return aO(t);case"keypress":return t.which!==32?null:(bx=!0,Ux);case"textInput":return e=t.data,e===Ux&&bx?null:e;default:return null}}function Kq(e,t){if(Mf)return e==="compositionend"||!Sw&&oO(e,t)?(e=sO(),g2=Tw=ic=null,Mf=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return rO&&t.locale!=="ko"?null:t.data;default:return null}}var Zq={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function yx(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Zq[e.type]:t==="textarea"}function lO(e,t,n,i){Af?Qf?Qf.push(i):Qf=[i]:Af=i,t=xb(t,"onChange"),0<t.length&&(n=new w5("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var J1=null,G0=null;function qq(e){WP(e,0)}function T5(e){var t=A1(e);if(QN(t))return e}function Ex(e,t){if(e==="change")return t}var cO=!1;if(el){var zE;if(el){var HE="oninput"in document;if(!HE){var vx=document.createElement("div");vx.setAttribute("oninput","return;"),HE=typeof vx.oninput=="function"}zE=HE}else zE=!1;cO=zE&&(!document.documentMode||9<document.documentMode)}function wx(){J1&&(J1.detachEvent("onpropertychange",uO),G0=J1=null)}function uO(e){if(e.propertyName==="value"&&T5(G0)){var t=[];lO(t,G0,e,_w(e)),iO(qq,t)}}function Qq(e,t,n){e==="focusin"?(wx(),J1=t,G0=n,J1.attachEvent("onpropertychange",uO)):e==="focusout"&&wx()}function Jq(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return T5(G0)}function eQ(e,t){if(e==="click")return T5(t)}function tQ(e,t){if(e==="input"||e==="change")return T5(t)}function nQ(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var tr=typeof Object.is=="function"?Object.is:nQ;function X0(e,t){if(tr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var s=n[i];if(!a7.call(t,s)||!tr(e[s],t[s]))return!1}return!0}function _x(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Tx(e,t){var n=_x(e);e=0;for(var i;n;){if(n.nodeType===3){if(i=e+n.textContent.length,e<=t&&i>=t)return{node:n,offset:t-e};e=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=_x(n)}}function dO(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?dO(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function fO(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=db(e.document);t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=db(e.document)}return t}function xw(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function iQ(e,t){var n=fO(t);t=e.focusedElem;var i=e.selectionRange;if(n!==t&&t&&t.ownerDocument&&dO(t.ownerDocument.documentElement,t)){if(i!==null&&xw(t)){if(e=i.start,n=i.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var s=t.textContent.length,r=Math.min(i.start,s);i=i.end===void 0?r:Math.min(i.end,s),!n.extend&&r>i&&(s=i,i=r,r=s),s=Tx(t,r);var o=Tx(t,i);s&&o&&(n.rangeCount!==1||n.anchorNode!==s.node||n.anchorOffset!==s.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),n.removeAllRanges(),r>i?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var sQ=el&&"documentMode"in document&&11>=document.documentMode,kf=null,h7=null,e0=null,g7=!1;function Ix(e,t,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;g7||kf==null||kf!==db(i)||(i=kf,"selectionStart"in i&&xw(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),e0&&X0(e0,i)||(e0=i,i=xb(h7,"onSelect"),0<i.length&&(t=new w5("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=kf)))}function hu(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Rf={animationend:hu("Animation","AnimationEnd"),animationiteration:hu("Animation","AnimationIteration"),animationstart:hu("Animation","AnimationStart"),transitionrun:hu("Transition","TransitionRun"),transitionstart:hu("Transition","TransitionStart"),transitioncancel:hu("Transition","TransitionCancel"),transitionend:hu("Transition","TransitionEnd")},VE={},hO={};el&&(hO=document.createElement("div").style,"AnimationEvent"in window||(delete Rf.animationend.animation,delete Rf.animationiteration.animation,delete Rf.animationstart.animation),"TransitionEvent"in window||delete Rf.transitionend.transition);function kd(e){if(VE[e])return VE[e];if(!Rf[e])return e;var t=Rf[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in hO)return VE[e]=t[n];return e}var gO=kd("animationend"),mO=kd("animationiteration"),pO=kd("animationstart"),rQ=kd("transitionrun"),oQ=kd("transitionstart"),aQ=kd("transitioncancel"),UO=kd("transitionend"),bO=new Map,Sx="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function ho(e,t){bO.set(e,t),Ad(t,[e])}var cr=[],Df=0,Cw=0;function I5(){for(var e=Df,t=Cw=Df=0;t<e;){var n=cr[t];cr[t++]=null;var i=cr[t];cr[t++]=null;var s=cr[t];cr[t++]=null;var r=cr[t];if(cr[t++]=null,i!==null&&s!==null){var o=i.pending;o===null?s.next=s:(s.next=o.next,o.next=s),i.pending=s}r!==0&&yO(n,s,r)}}function S5(e,t,n,i){cr[Df++]=e,cr[Df++]=t,cr[Df++]=n,cr[Df++]=i,Cw|=i,e.lanes|=i,e=e.alternate,e!==null&&(e.lanes|=i)}function Aw(e,t,n,i){return S5(e,t,n,i),fb(e)}function Mc(e,t){return S5(e,null,null,t),fb(e)}function yO(e,t,n){e.lanes|=n;var i=e.alternate;i!==null&&(i.lanes|=n);for(var s=!1,r=e.return;r!==null;)r.childLanes|=n,i=r.alternate,i!==null&&(i.childLanes|=n),r.tag===22&&(e=r.stateNode,e===null||e._visibility&1||(s=!0)),e=r,r=r.return;s&&t!==null&&e.tag===3&&(r=e.stateNode,s=31-Ws(n),r=r.hiddenUpdates,e=r[s],e===null?r[s]=[t]:e.push(t),t.lane=n|536870912)}function fb(e){if(50<f0)throw f0=0,O7=null,Error(ne(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var Lf={},xx=new WeakMap;function mr(e,t){if(typeof e=="object"&&e!==null){var n=xx.get(e);return n!==void 0?n:(t={value:e,source:t,stack:ox(t)},xx.set(e,t),t)}return{value:e,source:t,stack:ox(t)}}var Nf=[],Of=0,hb=null,gb=0,fr=[],hr=0,Vu=null,Oa=1,Pa="";function yu(e,t){Nf[Of++]=gb,Nf[Of++]=hb,hb=e,gb=t}function EO(e,t,n){fr[hr++]=Oa,fr[hr++]=Pa,fr[hr++]=Vu,Vu=e;var i=Oa;e=Pa;var s=32-Ws(i)-1;i&=~(1<<s),n+=1;var r=32-Ws(t)+s;if(30<r){var o=s-s%5;r=(i&(1<<o)-1).toString(32),i>>=o,s-=o,Oa=1<<32-Ws(t)+s|n<<s|i,Pa=r+e}else Oa=1<<r|n<<s|i,Pa=e}function Mw(e){e.return!==null&&(yu(e,1),EO(e,1,0))}function kw(e){for(;e===hb;)hb=Nf[--Of],Nf[Of]=null,gb=Nf[--Of],Nf[Of]=null;for(;e===Vu;)Vu=fr[--hr],fr[hr]=null,Pa=fr[--hr],fr[hr]=null,Oa=fr[--hr],fr[hr]=null}var as=null,Ai=null,It=!1,jr=null,ko=!1,m7=Error(ne(519));function td(e){var t=Error(ne(418,""));throw j0(mr(t,e)),m7}function Cx(e){var t=e.stateNode,n=e.type,i=e.memoizedProps;switch(t[ji]=e,t[xs]=i,n){case"dialog":rt("cancel",t),rt("close",t);break;case"iframe":case"object":case"embed":rt("load",t);break;case"video":case"audio":for(n=0;n<K0.length;n++)rt(K0[n],t);break;case"source":rt("error",t);break;case"img":case"image":case"link":rt("error",t),rt("load",t);break;case"details":rt("toggle",t);break;case"input":rt("invalid",t),JN(t,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0),ub(t);break;case"select":rt("invalid",t);break;case"textarea":rt("invalid",t),tO(t,i.value,i.defaultValue,i.children),ub(t)}n=i.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||t.textContent===""+n||i.suppressHydrationWarning===!0||ZP(t.textContent,n)?(i.popover!=null&&(rt("beforetoggle",t),rt("toggle",t)),i.onScroll!=null&&rt("scroll",t),i.onScrollEnd!=null&&rt("scrollend",t),i.onClick!=null&&(t.onclick=D5),t=!0):t=!1,t||td(e)}function Ax(e){for(as=e.return;as;)switch(as.tag){case 3:case 27:ko=!0;return;case 5:case 13:ko=!1;return;default:as=as.return}}function Qg(e){if(e!==as)return!1;if(!It)return Ax(e),It=!0,!1;var t=!1,n;if((n=e.tag!==3&&e.tag!==27)&&((n=e.tag===5)&&(n=e.type,n=!(n!=="form"&&n!=="button")||$7(e.type,e.memoizedProps)),n=!n),n&&(t=!0),t&&Ai&&td(e),Ax(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ne(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8)if(n=e.data,n==="/$"){if(t===0){Ai=Qr(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++;e=e.nextSibling}Ai=null}}else Ai=as?Qr(e.stateNode.nextSibling):null;return!0}function Jm(){Ai=as=null,It=!1}function j0(e){jr===null?jr=[e]:jr.push(e)}var t0=Error(ne(460)),vO=Error(ne(474)),p7={then:function(){}};function Mx(e){return e=e.status,e==="fulfilled"||e==="rejected"}function fU(){}function wO(e,t,n){switch(n=e[n],n===void 0?e.push(t):n!==t&&(t.then(fU,fU),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,e===t0?Error(ne(483)):e;default:if(typeof t.status=="string")t.then(fU,fU);else{if(e=qt,e!==null&&100<e.shellSuspendCounter)throw Error(ne(482));e=t,e.status="pending",e.then(function(i){if(t.status==="pending"){var s=t;s.status="fulfilled",s.value=i}},function(i){if(t.status==="pending"){var s=t;s.status="rejected",s.reason=i}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,e===t0?Error(ne(483)):e}throw n0=t,t0}}var n0=null;function kx(){if(n0===null)throw Error(ne(459));var e=n0;return n0=null,e}var Jf=null,Y0=0;function hU(e){var t=Y0;return Y0+=1,Jf===null&&(Jf=[]),wO(Jf,e,t)}function Jg(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function gU(e,t){throw t.$$typeof===WZ?Error(ne(525)):(e=Object.prototype.toString.call(t),Error(ne(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function Rx(e){var t=e._init;return t(e._payload)}function _O(e){function t(b,y){if(e){var w=b.deletions;w===null?(b.deletions=[y],b.flags|=16):w.push(y)}}function n(b,y){if(!e)return null;for(;y!==null;)t(b,y),y=y.sibling;return null}function i(b){for(var y=new Map;b!==null;)b.key!==null?y.set(b.key,b):y.set(b.index,b),b=b.sibling;return y}function s(b,y){return b=hc(b,y),b.index=0,b.sibling=null,b}function r(b,y,w){return b.index=w,e?(w=b.alternate,w!==null?(w=w.index,w<y?(b.flags|=33554434,y):w):(b.flags|=33554434,y)):(b.flags|=1048576,y)}function o(b){return e&&b.alternate===null&&(b.flags|=33554434),b}function a(b,y,w,v){return y===null||y.tag!==6?(y=e8(w,b.mode,v),y.return=b,y):(y=s(y,w),y.return=b,y)}function l(b,y,w,v){var I=w.type;return I===xf?u(b,y,w.props.children,v,w.key):y!==null&&(y.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===Vl&&Rx(I)===y.type)?(y=s(y,w.props),Jg(y,w),y.return=b,y):(y=E2(w.type,w.key,w.props,null,b.mode,v),Jg(y,w),y.return=b,y)}function c(b,y,w,v){return y===null||y.tag!==4||y.stateNode.containerInfo!==w.containerInfo||y.stateNode.implementation!==w.implementation?(y=t8(w,b.mode,v),y.return=b,y):(y=s(y,w.children||[]),y.return=b,y)}function u(b,y,w,v,I){return y===null||y.tag!==7?(y=Gu(w,b.mode,v,I),y.return=b,y):(y=s(y,w),y.return=b,y)}function d(b,y,w){if(typeof y=="string"&&y!==""||typeof y=="number"||typeof y=="bigint")return y=e8(""+y,b.mode,w),y.return=b,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case aU:return w=E2(y.type,y.key,y.props,null,b.mode,w),Jg(w,y),w.return=b,w;case S1:return y=t8(y,b.mode,w),y.return=b,y;case Vl:var v=y._init;return y=v(y._payload),d(b,y,w)}if(C1(y)||Kg(y))return y=Gu(y,b.mode,w,null),y.return=b,y;if(typeof y.then=="function")return d(b,hU(y),w);if(y.$$typeof===Na)return d(b,mU(b,y),w);gU(b,y)}return null}function f(b,y,w,v){var I=y!==null?y.key:null;if(typeof w=="string"&&w!==""||typeof w=="number"||typeof w=="bigint")return I!==null?null:a(b,y,""+w,v);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case aU:return w.key===I?l(b,y,w,v):null;case S1:return w.key===I?c(b,y,w,v):null;case Vl:return I=w._init,w=I(w._payload),f(b,y,w,v)}if(C1(w)||Kg(w))return I!==null?null:u(b,y,w,v,null);if(typeof w.then=="function")return f(b,y,hU(w),v);if(w.$$typeof===Na)return f(b,y,mU(b,w),v);gU(b,w)}return null}function h(b,y,w,v,I){if(typeof v=="string"&&v!==""||typeof v=="number"||typeof v=="bigint")return b=b.get(w)||null,a(y,b,""+v,I);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case aU:return b=b.get(v.key===null?w:v.key)||null,l(y,b,v,I);case S1:return b=b.get(v.key===null?w:v.key)||null,c(y,b,v,I);case Vl:var C=v._init;return v=C(v._payload),h(b,y,w,v,I)}if(C1(v)||Kg(v))return b=b.get(w)||null,u(y,b,v,I,null);if(typeof v.then=="function")return h(b,y,w,hU(v),I);if(v.$$typeof===Na)return h(b,y,w,mU(y,v),I);gU(y,v)}return null}function m(b,y,w,v){for(var I=null,C=null,_=y,T=y=0,k=null;_!==null&&T<w.length;T++){_.index>T?(k=_,_=null):k=_.sibling;var S=f(b,_,w[T],v);if(S===null){_===null&&(_=k);break}e&&_&&S.alternate===null&&t(b,_),y=r(S,y,T),C===null?I=S:C.sibling=S,C=S,_=k}if(T===w.length)return n(b,_),It&&yu(b,T),I;if(_===null){for(;T<w.length;T++)_=d(b,w[T],v),_!==null&&(y=r(_,y,T),C===null?I=_:C.sibling=_,C=_);return It&&yu(b,T),I}for(_=i(_);T<w.length;T++)k=h(_,b,T,w[T],v),k!==null&&(e&&k.alternate!==null&&_.delete(k.key===null?T:k.key),y=r(k,y,T),C===null?I=k:C.sibling=k,C=k);return e&&_.forEach(function(R){return t(b,R)}),It&&yu(b,T),I}function p(b,y,w,v){if(w==null)throw Error(ne(151));for(var I=null,C=null,_=y,T=y=0,k=null,S=w.next();_!==null&&!S.done;T++,S=w.next()){_.index>T?(k=_,_=null):k=_.sibling;var R=f(b,_,S.value,v);if(R===null){_===null&&(_=k);break}e&&_&&R.alternate===null&&t(b,_),y=r(R,y,T),C===null?I=R:C.sibling=R,C=R,_=k}if(S.done)return n(b,_),It&&yu(b,T),I;if(_===null){for(;!S.done;T++,S=w.next())S=d(b,S.value,v),S!==null&&(y=r(S,y,T),C===null?I=S:C.sibling=S,C=S);return It&&yu(b,T),I}for(_=i(_);!S.done;T++,S=w.next())S=h(_,b,T,S.value,v),S!==null&&(e&&S.alternate!==null&&_.delete(S.key===null?T:S.key),y=r(S,y,T),C===null?I=S:C.sibling=S,C=S);return e&&_.forEach(function(P){return t(b,P)}),It&&yu(b,T),I}function U(b,y,w,v){if(typeof w=="object"&&w!==null&&w.type===xf&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case aU:e:{for(var I=w.key;y!==null;){if(y.key===I){if(I=w.type,I===xf){if(y.tag===7){n(b,y.sibling),v=s(y,w.props.children),v.return=b,b=v;break e}}else if(y.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===Vl&&Rx(I)===y.type){n(b,y.sibling),v=s(y,w.props),Jg(v,w),v.return=b,b=v;break e}n(b,y);break}else t(b,y);y=y.sibling}w.type===xf?(v=Gu(w.props.children,b.mode,v,w.key),v.return=b,b=v):(v=E2(w.type,w.key,w.props,null,b.mode,v),Jg(v,w),v.return=b,b=v)}return o(b);case S1:e:{for(I=w.key;y!==null;){if(y.key===I)if(y.tag===4&&y.stateNode.containerInfo===w.containerInfo&&y.stateNode.implementation===w.implementation){n(b,y.sibling),v=s(y,w.children||[]),v.return=b,b=v;break e}else{n(b,y);break}else t(b,y);y=y.sibling}v=t8(w,b.mode,v),v.return=b,b=v}return o(b);case Vl:return I=w._init,w=I(w._payload),U(b,y,w,v)}if(C1(w))return m(b,y,w,v);if(Kg(w)){if(I=Kg(w),typeof I!="function")throw Error(ne(150));return w=I.call(w),p(b,y,w,v)}if(typeof w.then=="function")return U(b,y,hU(w),v);if(w.$$typeof===Na)return U(b,y,mU(b,w),v);gU(b,w)}return typeof w=="string"&&w!==""||typeof w=="number"||typeof w=="bigint"?(w=""+w,y!==null&&y.tag===6?(n(b,y.sibling),v=s(y,w),v.return=b,b=v):(n(b,y),v=e8(w,b.mode,v),v.return=b,b=v),o(b)):n(b,y)}return function(b,y,w,v){try{Y0=0;var I=U(b,y,w,v);return Jf=null,I}catch(_){if(_===t0)throw _;var C=yr(29,_,null,b.mode);return C.lanes=v,C.return=b,C}finally{}}}var nd=_O(!0),TO=_O(!1),Th=oa(null),mb=oa(0);function Dx(e,t){e=il,cn(mb,e),cn(Th,t),il=e|t.baseLanes}function U7(){cn(mb,il),cn(Th,Th.current)}function Rw(){il=mb.current,yi(Th),yi(mb)}var Ar=oa(null),Vo=null;function Kl(e){var t=e.alternate;cn(Jn,Jn.current&1),cn(Ar,e),Vo===null&&(t===null||Th.current!==null||t.memoizedState!==null)&&(Vo=e)}function IO(e){if(e.tag===22){if(cn(Jn,Jn.current),cn(Ar,e),Vo===null){var t=e.alternate;t!==null&&t.memoizedState!==null&&(Vo=e)}}else Zl()}function Zl(){cn(Jn,Jn.current),cn(Ar,Ar.current)}function Fa(e){yi(Ar),Vo===e&&(Vo=null),yi(Jn)}var Jn=oa(0);function pb(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var lQ=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(n,i){e.push(i)}};this.abort=function(){t.aborted=!0,e.forEach(function(n){return n()})}},cQ=ii.unstable_scheduleCallback,uQ=ii.unstable_NormalPriority,Qn={$$typeof:Na,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Dw(){return{controller:new lQ,data:new Map,refCount:0}}function ep(e){e.refCount--,e.refCount===0&&cQ(uQ,function(){e.controller.abort()})}var i0=null,b7=0,Ih=0,eh=null;function dQ(e,t){if(i0===null){var n=i0=[];b7=0,Ih=n9(),eh={status:"pending",value:void 0,then:function(i){n.push(i)}}}return b7++,t.then(Lx,Lx),t}function Lx(){if(--b7===0&&i0!==null){eh!==null&&(eh.status="fulfilled");var e=i0;i0=null,Ih=0,eh=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function fQ(e,t){var n=[],i={status:"pending",value:null,reason:null,then:function(s){n.push(s)}};return e.then(function(){i.status="fulfilled",i.value=t;for(var s=0;s<n.length;s++)(0,n[s])(t)},function(s){for(i.status="rejected",i.reason=s,s=0;s<n.length;s++)(0,n[s])(void 0)}),i}var Nx=Xe.S;Xe.S=function(e,t){typeof t=="object"&&t!==null&&typeof t.then=="function"&&dQ(e,t),Nx!==null&&Nx(e,t)};var $u=oa(null);function Lw(){var e=$u.current;return e!==null?e:qt.pooledCache}function p2(e,t){t===null?cn($u,$u.current):cn($u,t.pool)}function SO(){var e=Lw();return e===null?null:{parent:Qn._currentValue,pool:e}}var kc=0,Ze=null,Pt=null,Bn=null,Ub=!1,th=!1,id=!1,bb=0,W0=0,nh=null,hQ=0;function Cn(){throw Error(ne(321))}function Nw(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!tr(e[n],t[n]))return!1;return!0}function Ow(e,t,n,i,s,r){return kc=r,Ze=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Xe.H=e===null||e.memoizedState===null?Rd:eu,id=!1,r=n(i,s),id=!1,th&&(r=CO(t,n,i,s)),xO(e),r}function xO(e){Xe.H=Yo;var t=Pt!==null&&Pt.next!==null;if(kc=0,Bn=Pt=Ze=null,Ub=!1,W0=0,nh=null,t)throw Error(ne(300));e===null||pi||(e=e.dependencies,e!==null&&vb(e)&&(pi=!0))}function CO(e,t,n,i){Ze=e;var s=0;do{if(th&&(nh=null),W0=0,th=!1,25<=s)throw Error(ne(301));if(s+=1,Bn=Pt=null,e.updateQueue!=null){var r=e.updateQueue;r.lastEffect=null,r.events=null,r.stores=null,r.memoCache!=null&&(r.memoCache.index=0)}Xe.H=Dd,r=t(n,i)}while(th);return r}function gQ(){var e=Xe.H,t=e.useState()[0];return t=typeof t.then=="function"?tp(t):t,e=e.useState()[0],(Pt!==null?Pt.memoizedState:null)!==e&&(Ze.flags|=1024),t}function Pw(){var e=bb!==0;return bb=0,e}function Fw(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function Bw(e){if(Ub){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}Ub=!1}kc=0,Bn=Pt=Ze=null,th=!1,W0=bb=0,nh=null}function bs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Bn===null?Ze.memoizedState=Bn=e:Bn=Bn.next=e,Bn}function Gn(){if(Pt===null){var e=Ze.alternate;e=e!==null?e.memoizedState:null}else e=Pt.next;var t=Bn===null?Ze.memoizedState:Bn.next;if(t!==null)Bn=t,Pt=e;else{if(e===null)throw Ze.alternate===null?Error(ne(467)):Error(ne(310));Pt=e,e={memoizedState:Pt.memoizedState,baseState:Pt.baseState,baseQueue:Pt.baseQueue,queue:Pt.queue,next:null},Bn===null?Ze.memoizedState=Bn=e:Bn=Bn.next=e}return Bn}var x5;x5=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function tp(e){var t=W0;return W0+=1,nh===null&&(nh=[]),e=wO(nh,e,t),t=Ze,(Bn===null?t.memoizedState:Bn.next)===null&&(t=t.alternate,Xe.H=t===null||t.memoizedState===null?Rd:eu),e}function C5(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return tp(e);if(e.$$typeof===Na)return Yi(e)}throw Error(ne(438,String(e)))}function zw(e){var t=null,n=Ze.updateQueue;if(n!==null&&(t=n.memoCache),t==null){var i=Ze.alternate;i!==null&&(i=i.updateQueue,i!==null&&(i=i.memoCache,i!=null&&(t={data:i.data.map(function(s){return s.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),n===null&&(n=x5(),Ze.updateQueue=n),n.memoCache=t,n=t.data[t.index],n===void 0)for(n=t.data[t.index]=Array(e),i=0;i<e;i++)n[i]=ZZ;return t.index++,n}function tl(e,t){return typeof t=="function"?t(e):t}function U2(e){var t=Gn();return Hw(t,Pt,e)}function Hw(e,t,n){var i=e.queue;if(i===null)throw Error(ne(311));i.lastRenderedReducer=n;var s=e.baseQueue,r=i.pending;if(r!==null){if(s!==null){var o=s.next;s.next=r.next,r.next=o}t.baseQueue=s=r,i.pending=null}if(r=e.baseState,s===null)e.memoizedState=r;else{t=s.next;var a=o=null,l=null,c=t,u=!1;do{var d=c.lane&-536870913;if(d!==c.lane?(ht&d)===d:(kc&d)===d){var f=c.revertLane;if(f===0)l!==null&&(l=l.next={lane:0,revertLane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),d===Ih&&(u=!0);else if((kc&f)===f){c=c.next,f===Ih&&(u=!0);continue}else d={lane:0,revertLane:c.revertLane,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null},l===null?(a=l=d,o=r):l=l.next=d,Ze.lanes|=f,Dc|=f;d=c.action,id&&n(r,d),r=c.hasEagerState?c.eagerState:n(r,d)}else f={lane:d,revertLane:c.revertLane,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null},l===null?(a=l=f,o=r):l=l.next=f,Ze.lanes|=d,Dc|=d;c=c.next}while(c!==null&&c!==t);if(l===null?o=r:l.next=a,!tr(r,e.memoizedState)&&(pi=!0,u&&(n=eh,n!==null)))throw n;e.memoizedState=r,e.baseState=o,e.baseQueue=l,i.lastRenderedState=r}return s===null&&(i.lanes=0),[e.memoizedState,i.dispatch]}function $E(e){var t=Gn(),n=t.queue;if(n===null)throw Error(ne(311));n.lastRenderedReducer=e;var i=n.dispatch,s=n.pending,r=t.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do r=e(r,o.action),o=o.next;while(o!==s);tr(r,t.memoizedState)||(pi=!0),t.memoizedState=r,t.baseQueue===null&&(t.baseState=r),n.lastRenderedState=r}return[r,i]}function AO(e,t,n){var i=Ze,s=Gn(),r=It;if(r){if(n===void 0)throw Error(ne(407));n=n()}else n=t();var o=!tr((Pt||s).memoizedState,n);if(o&&(s.memoizedState=n,pi=!0),s=s.queue,Vw(RO.bind(null,i,s,e),[e]),s.getSnapshot!==t||o||Bn!==null&&Bn.memoizedState.tag&1){if(i.flags|=2048,Sh(9,kO.bind(null,i,s,n,t),{destroy:void 0},null),qt===null)throw Error(ne(349));r||kc&60||MO(i,t,n)}return n}function MO(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Ze.updateQueue,t===null?(t=x5(),Ze.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function kO(e,t,n,i){t.value=n,t.getSnapshot=i,DO(t)&&LO(e)}function RO(e,t,n){return n(function(){DO(t)&&LO(e)})}function DO(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!tr(e,n)}catch{return!0}}function LO(e){var t=Mc(e,2);t!==null&&ds(t,e,2)}function y7(e){var t=bs();if(typeof e=="function"){var n=e;if(e=n(),id){nc(!0);try{n()}finally{nc(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:tl,lastRenderedState:e},t}function NO(e,t,n,i){return e.baseState=n,Hw(e,Pt,typeof i=="function"?i:tl)}function mQ(e,t,n,i,s){if(M5(e))throw Error(ne(485));if(e=t.action,e!==null){var r={payload:s,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(o){r.listeners.push(o)}};Xe.T!==null?n(!0):r.isTransition=!1,i(r),n=t.pending,n===null?(r.next=t.pending=r,OO(t,r)):(r.next=n.next,t.pending=n.next=r)}}function OO(e,t){var n=t.action,i=t.payload,s=e.state;if(t.isTransition){var r=Xe.T,o={};Xe.T=o;try{var a=n(s,i),l=Xe.S;l!==null&&l(o,a),Ox(e,t,a)}catch(c){E7(e,t,c)}finally{Xe.T=r}}else try{r=n(s,i),Ox(e,t,r)}catch(c){E7(e,t,c)}}function Ox(e,t,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(i){Px(e,t,i)},function(i){return E7(e,t,i)}):Px(e,t,n)}function Px(e,t,n){t.status="fulfilled",t.value=n,PO(t),e.state=n,t=e.pending,t!==null&&(n=t.next,n===t?e.pending=null:(n=n.next,t.next=n,OO(e,n)))}function E7(e,t,n){var i=e.pending;if(e.pending=null,i!==null){i=i.next;do t.status="rejected",t.reason=n,PO(t),t=t.next;while(t!==i)}e.action=null}function PO(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function FO(e,t){return t}function BO(e,t){if(It){var n=qt.formState;if(n!==null){e:{var i=Ze;if(It){if(Ai){t:{for(var s=Ai,r=ko;s.nodeType!==8;){if(!r){s=null;break t}if(s=Qr(s.nextSibling),s===null){s=null;break t}}r=s.data,s=r==="F!"||r==="F"?s:null}if(s){Ai=Qr(s.nextSibling),i=s.data==="F!";break e}}td(i)}i=!1}i&&(t=n[0])}}return n=bs(),n.memoizedState=n.baseState=t,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:FO,lastRenderedState:t},n.queue=i,n=nP.bind(null,Ze,i),i.dispatch=n,i=y7(!1),r=jw.bind(null,Ze,!1,i.queue),i=bs(),s={state:t,dispatch:null,action:e,pending:null},i.queue=s,n=mQ.bind(null,Ze,s,r,n),s.dispatch=n,i.memoizedState=e,[t,n,!1]}function zO(e){var t=Gn();return HO(t,Pt,e)}function HO(e,t,n){t=Hw(e,t,FO)[0],e=U2(tl)[0],t=typeof t=="object"&&t!==null&&typeof t.then=="function"?tp(t):t;var i=Gn(),s=i.queue,r=s.dispatch;return n!==i.memoizedState&&(Ze.flags|=2048,Sh(9,pQ.bind(null,s,n),{destroy:void 0},null)),[t,r,e]}function pQ(e,t){e.action=t}function VO(e){var t=Gn(),n=Pt;if(n!==null)return HO(t,n,e);Gn(),t=t.memoizedState,n=Gn();var i=n.queue.dispatch;return n.memoizedState=e,[t,i,!1]}function Sh(e,t,n,i){return e={tag:e,create:t,inst:n,deps:i,next:null},t=Ze.updateQueue,t===null&&(t=x5(),Ze.updateQueue=t),n=t.lastEffect,n===null?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function $O(){return Gn().memoizedState}function b2(e,t,n,i){var s=bs();Ze.flags|=e,s.memoizedState=Sh(1|t,n,{destroy:void 0},i===void 0?null:i)}function A5(e,t,n,i){var s=Gn();i=i===void 0?null:i;var r=s.memoizedState.inst;Pt!==null&&i!==null&&Nw(i,Pt.memoizedState.deps)?s.memoizedState=Sh(t,n,r,i):(Ze.flags|=e,s.memoizedState=Sh(1|t,n,r,i))}function Fx(e,t){b2(8390656,8,e,t)}function Vw(e,t){A5(2048,8,e,t)}function GO(e,t){return A5(4,2,e,t)}function XO(e,t){return A5(4,4,e,t)}function jO(e,t){if(typeof t=="function"){e=e();var n=t(e);return function(){typeof n=="function"?n():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function YO(e,t,n){n=n!=null?n.concat([e]):null,A5(4,4,jO.bind(null,t,e),n)}function $w(){}function WO(e,t){var n=Gn();t=t===void 0?null:t;var i=n.memoizedState;return t!==null&&Nw(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function KO(e,t){var n=Gn();t=t===void 0?null:t;var i=n.memoizedState;if(t!==null&&Nw(t,i[1]))return i[0];if(i=e(),id){nc(!0);try{e()}finally{nc(!1)}}return n.memoizedState=[i,t],i}function Gw(e,t,n){return n===void 0||kc&1073741824?e.memoizedState=t:(e.memoizedState=n,e=PP(),Ze.lanes|=e,Dc|=e,n)}function ZO(e,t,n,i){return tr(n,t)?n:Th.current!==null?(e=Gw(e,n,i),tr(e,t)||(pi=!0),e):kc&42?(e=PP(),Ze.lanes|=e,Dc|=e,t):(pi=!0,e.memoizedState=n)}function qO(e,t,n,i,s){var r=nn.p;nn.p=r!==0&&8>r?r:8;var o=Xe.T,a={};Xe.T=a,jw(e,!1,t,n);try{var l=s(),c=Xe.S;if(c!==null&&c(a,l),l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=fQ(l,i);s0(e,t,u,Ks(e))}else s0(e,t,i,Ks(e))}catch(d){s0(e,t,{then:function(){},status:"rejected",reason:d},Ks())}finally{nn.p=r,Xe.T=o}}function UQ(){}function v7(e,t,n,i){if(e.tag!==5)throw Error(ne(476));var s=QO(e).queue;qO(e,s,t,Hu,n===null?UQ:function(){return JO(e),n(i)})}function QO(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:Hu,baseState:Hu,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:tl,lastRenderedState:Hu},next:null};var n={};return t.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:tl,lastRenderedState:n},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function JO(e){var t=QO(e).next.queue;s0(e,t,{},Ks())}function Xw(){return Yi(Q0)}function eP(){return Gn().memoizedState}function tP(){return Gn().memoizedState}function bQ(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var n=Ks();e=dc(n);var i=fc(t,e,n);i!==null&&(ds(i,t,n),o0(i,t,n)),t={cache:Dw()},e.payload=t;return}t=t.return}}function yQ(e,t,n){var i=Ks();n={lane:i,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},M5(e)?iP(t,n):(n=Aw(e,t,n,i),n!==null&&(ds(n,e,i),sP(n,t,i)))}function nP(e,t,n){var i=Ks();s0(e,t,n,i)}function s0(e,t,n,i){var s={lane:i,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(M5(e))iP(t,s);else{var r=e.alternate;if(e.lanes===0&&(r===null||r.lanes===0)&&(r=t.lastRenderedReducer,r!==null))try{var o=t.lastRenderedState,a=r(o,n);if(s.hasEagerState=!0,s.eagerState=a,tr(a,o))return S5(e,t,s,0),qt===null&&I5(),!1}catch{}finally{}if(n=Aw(e,t,s,i),n!==null)return ds(n,e,i),sP(n,t,i),!0}return!1}function jw(e,t,n,i){if(i={lane:2,revertLane:n9(),action:i,hasEagerState:!1,eagerState:null,next:null},M5(e)){if(t)throw Error(ne(479))}else t=Aw(e,n,i,2),t!==null&&ds(t,e,2)}function M5(e){var t=e.alternate;return e===Ze||t!==null&&t===Ze}function iP(e,t){th=Ub=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function sP(e,t,n){if(n&4194176){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,jN(e,n)}}var Yo={readContext:Yi,use:C5,useCallback:Cn,useContext:Cn,useEffect:Cn,useImperativeHandle:Cn,useLayoutEffect:Cn,useInsertionEffect:Cn,useMemo:Cn,useReducer:Cn,useRef:Cn,useState:Cn,useDebugValue:Cn,useDeferredValue:Cn,useTransition:Cn,useSyncExternalStore:Cn,useId:Cn};Yo.useCacheRefresh=Cn;Yo.useMemoCache=Cn;Yo.useHostTransitionStatus=Cn;Yo.useFormState=Cn;Yo.useActionState=Cn;Yo.useOptimistic=Cn;var Rd={readContext:Yi,use:C5,useCallback:function(e,t){return bs().memoizedState=[e,t===void 0?null:t],e},useContext:Yi,useEffect:Fx,useImperativeHandle:function(e,t,n){n=n!=null?n.concat([e]):null,b2(4194308,4,jO.bind(null,t,e),n)},useLayoutEffect:function(e,t){return b2(4194308,4,e,t)},useInsertionEffect:function(e,t){b2(4,2,e,t)},useMemo:function(e,t){var n=bs();t=t===void 0?null:t;var i=e();if(id){nc(!0);try{e()}finally{nc(!1)}}return n.memoizedState=[i,t],i},useReducer:function(e,t,n){var i=bs();if(n!==void 0){var s=n(t);if(id){nc(!0);try{n(t)}finally{nc(!1)}}}else s=t;return i.memoizedState=i.baseState=s,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:s},i.queue=e,e=e.dispatch=yQ.bind(null,Ze,e),[i.memoizedState,e]},useRef:function(e){var t=bs();return e={current:e},t.memoizedState=e},useState:function(e){e=y7(e);var t=e.queue,n=nP.bind(null,Ze,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:$w,useDeferredValue:function(e,t){var n=bs();return Gw(n,e,t)},useTransition:function(){var e=y7(!1);return e=qO.bind(null,Ze,e.queue,!0,!1),bs().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var i=Ze,s=bs();if(It){if(n===void 0)throw Error(ne(407));n=n()}else{if(n=t(),qt===null)throw Error(ne(349));ht&60||MO(i,t,n)}s.memoizedState=n;var r={value:n,getSnapshot:t};return s.queue=r,Fx(RO.bind(null,i,r,e),[e]),i.flags|=2048,Sh(9,kO.bind(null,i,r,n,t),{destroy:void 0},null),n},useId:function(){var e=bs(),t=qt.identifierPrefix;if(It){var n=Pa,i=Oa;n=(i&~(1<<32-Ws(i)-1)).toString(32)+n,t=":"+t+"R"+n,n=bb++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=hQ++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},useCacheRefresh:function(){return bs().memoizedState=bQ.bind(null,Ze)}};Rd.useMemoCache=zw;Rd.useHostTransitionStatus=Xw;Rd.useFormState=BO;Rd.useActionState=BO;Rd.useOptimistic=function(e){var t=bs();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=jw.bind(null,Ze,!0,n),n.dispatch=t,[e,t]};var eu={readContext:Yi,use:C5,useCallback:WO,useContext:Yi,useEffect:Vw,useImperativeHandle:YO,useInsertionEffect:GO,useLayoutEffect:XO,useMemo:KO,useReducer:U2,useRef:$O,useState:function(){return U2(tl)},useDebugValue:$w,useDeferredValue:function(e,t){var n=Gn();return ZO(n,Pt.memoizedState,e,t)},useTransition:function(){var e=U2(tl)[0],t=Gn().memoizedState;return[typeof e=="boolean"?e:tp(e),t]},useSyncExternalStore:AO,useId:eP};eu.useCacheRefresh=tP;eu.useMemoCache=zw;eu.useHostTransitionStatus=Xw;eu.useFormState=zO;eu.useActionState=zO;eu.useOptimistic=function(e,t){var n=Gn();return NO(n,Pt,e,t)};var Dd={readContext:Yi,use:C5,useCallback:WO,useContext:Yi,useEffect:Vw,useImperativeHandle:YO,useInsertionEffect:GO,useLayoutEffect:XO,useMemo:KO,useReducer:$E,useRef:$O,useState:function(){return $E(tl)},useDebugValue:$w,useDeferredValue:function(e,t){var n=Gn();return Pt===null?Gw(n,e,t):ZO(n,Pt.memoizedState,e,t)},useTransition:function(){var e=$E(tl)[0],t=Gn().memoizedState;return[typeof e=="boolean"?e:tp(e),t]},useSyncExternalStore:AO,useId:eP};Dd.useCacheRefresh=tP;Dd.useMemoCache=zw;Dd.useHostTransitionStatus=Xw;Dd.useFormState=VO;Dd.useActionState=VO;Dd.useOptimistic=function(e,t){var n=Gn();return Pt!==null?NO(n,Pt,e,t):(n.baseState=e,[e,n.queue.dispatch])};function GE(e,t,n,i){t=e.memoizedState,n=n(i,t),n=n==null?t:sn({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var w7={isMounted:function(e){return(e=e._reactInternals)?lg(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=Ks(),s=dc(i);s.payload=t,n!=null&&(s.callback=n),t=fc(e,s,i),t!==null&&(ds(t,e,i),o0(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=Ks(),s=dc(i);s.tag=1,s.payload=t,n!=null&&(s.callback=n),t=fc(e,s,i),t!==null&&(ds(t,e,i),o0(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ks(),i=dc(n);i.tag=2,t!=null&&(i.callback=t),t=fc(e,i,n),t!==null&&(ds(t,e,n),o0(t,e,n))}};function Bx(e,t,n,i,s,r,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,r,o):t.prototype&&t.prototype.isPureReactComponent?!X0(n,i)||!X0(s,r):!0}function zx(e,t,n,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&w7.enqueueReplaceState(t,t.state,null)}function sd(e,t){var n=t;if("ref"in t){n={};for(var i in t)i!=="ref"&&(n[i]=t[i])}if(e=e.defaultProps){n===t&&(n=sn({},n));for(var s in e)n[s]===void 0&&(n[s]=e[s])}return n}var yb=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function rP(e){yb(e)}function oP(e){console.error(e)}function aP(e){yb(e)}function Eb(e,t){try{var n=e.onUncaughtError;n(t.value,{componentStack:t.stack})}catch(i){setTimeout(function(){throw i})}}function Hx(e,t,n){try{var i=e.onCaughtError;i(n.value,{componentStack:n.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(s){setTimeout(function(){throw s})}}function _7(e,t,n){return n=dc(n),n.tag=3,n.payload={element:null},n.callback=function(){Eb(e,t)},n}function lP(e){return e=dc(e),e.tag=3,e}function cP(e,t,n,i){var s=n.type.getDerivedStateFromError;if(typeof s=="function"){var r=i.value;e.payload=function(){return s(r)},e.callback=function(){Hx(t,n,i)}}var o=n.stateNode;o!==null&&typeof o.componentDidCatch=="function"&&(e.callback=function(){Hx(t,n,i),typeof s!="function"&&(gc===null?gc=new Set([this]):gc.add(this));var a=i.stack;this.componentDidCatch(i.value,{componentStack:a!==null?a:""})})}function EQ(e,t,n,i,s){if(n.flags|=32768,i!==null&&typeof i=="object"&&typeof i.then=="function"){if(t=n.alternate,t!==null&&np(t,n,s,!0),n=Ar.current,n!==null){switch(n.tag){case 13:return Vo===null?F7():n.alternate===null&&Tn===0&&(Tn=3),n.flags&=-257,n.flags|=65536,n.lanes=s,i===p7?n.flags|=16384:(t=n.updateQueue,t===null?n.updateQueue=new Set([i]):t.add(i),i8(e,i,s)),!1;case 22:return n.flags|=65536,i===p7?n.flags|=16384:(t=n.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([i])},n.updateQueue=t):(n=t.retryQueue,n===null?t.retryQueue=new Set([i]):n.add(i)),i8(e,i,s)),!1}throw Error(ne(435,n.tag))}return i8(e,i,s),F7(),!1}if(It)return t=Ar.current,t!==null?(!(t.flags&65536)&&(t.flags|=256),t.flags|=65536,t.lanes=s,i!==m7&&(e=Error(ne(422),{cause:i}),j0(mr(e,n)))):(i!==m7&&(t=Error(ne(423),{cause:i}),j0(mr(t,n))),e=e.current.alternate,e.flags|=65536,s&=-s,e.lanes|=s,i=mr(i,n),s=_7(e.stateNode,i,s),ZE(e,s),Tn!==4&&(Tn=2)),!1;var r=Error(ne(520),{cause:i});if(r=mr(r,n),u0===null?u0=[r]:u0.push(r),Tn!==4&&(Tn=2),t===null)return!0;i=mr(i,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=s&-s,n.lanes|=e,e=_7(n.stateNode,i,e),ZE(n,e),!1;case 1:if(t=n.type,r=n.stateNode,(n.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||r!==null&&typeof r.componentDidCatch=="function"&&(gc===null||!gc.has(r))))return n.flags|=65536,s&=-s,n.lanes|=s,s=lP(s),cP(s,e,n,i),ZE(n,s),!1}n=n.return}while(n!==null);return!1}var uP=Error(ne(461)),pi=!1;function Si(e,t,n,i){t.child=e===null?TO(t,null,n,i):nd(t,e.child,n,i)}function Vx(e,t,n,i,s){n=n.render;var r=t.ref;if("ref"in i){var o={};for(var a in i)a!=="ref"&&(o[a]=i[a])}else o=i;return rd(t),i=Ow(e,t,n,o,r,s),a=Pw(),e!==null&&!pi?(Fw(e,t,s),nl(e,t,s)):(It&&a&&Mw(t),t.flags|=1,Si(e,t,i,s),t.child)}function $x(e,t,n,i,s){if(e===null){var r=n.type;return typeof r=="function"&&!qw(r)&&r.defaultProps===void 0&&n.compare===null?(t.tag=15,t.type=r,dP(e,t,r,i,s)):(e=E2(n.type,null,i,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(r=e.child,!Yw(e,s)){var o=r.memoizedProps;if(n=n.compare,n=n!==null?n:X0,n(o,i)&&e.ref===t.ref)return nl(e,t,s)}return t.flags|=1,e=hc(r,i),e.ref=t.ref,e.return=t,t.child=e}function dP(e,t,n,i,s){if(e!==null){var r=e.memoizedProps;if(X0(r,i)&&e.ref===t.ref)if(pi=!1,t.pendingProps=i=r,Yw(e,s))e.flags&131072&&(pi=!0);else return t.lanes=e.lanes,nl(e,t,s)}return T7(e,t,n,i,s)}function fP(e,t,n){var i=t.pendingProps,s=i.children,r=(t.stateNode._pendingVisibility&2)!==0,o=e!==null?e.memoizedState:null;if(r0(e,t),i.mode==="hidden"||r){if(t.flags&128){if(i=o!==null?o.baseLanes|n:n,e!==null){for(s=t.child=e.child,r=0;s!==null;)r=r|s.lanes|s.childLanes,s=s.sibling;t.childLanes=r&~i}else t.childLanes=0,t.child=null;return Gx(e,t,i,n)}if(n&536870912)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&p2(t,o!==null?o.cachePool:null),o!==null?Dx(t,o):U7(),IO(t);else return t.lanes=t.childLanes=536870912,Gx(e,t,o!==null?o.baseLanes|n:n,n)}else o!==null?(p2(t,o.cachePool),Dx(t,o),Zl(),t.memoizedState=null):(e!==null&&p2(t,null),U7(),Zl());return Si(e,t,s,n),t.child}function Gx(e,t,n,i){var s=Lw();return s=s===null?null:{parent:Qn._currentValue,pool:s},t.memoizedState={baseLanes:n,cachePool:s},e!==null&&p2(t,null),U7(),IO(t),e!==null&&np(e,t,i,!0),null}function r0(e,t){var n=t.ref;if(n===null)e!==null&&e.ref!==null&&(t.flags|=2097664);else{if(typeof n!="function"&&typeof n!="object")throw Error(ne(284));(e===null||e.ref!==n)&&(t.flags|=2097664)}}function T7(e,t,n,i,s){return rd(t),n=Ow(e,t,n,i,void 0,s),i=Pw(),e!==null&&!pi?(Fw(e,t,s),nl(e,t,s)):(It&&i&&Mw(t),t.flags|=1,Si(e,t,n,s),t.child)}function Xx(e,t,n,i,s,r){return rd(t),t.updateQueue=null,n=CO(t,i,n,s),xO(e),i=Pw(),e!==null&&!pi?(Fw(e,t,r),nl(e,t,r)):(It&&i&&Mw(t),t.flags|=1,Si(e,t,n,r),t.child)}function jx(e,t,n,i,s){if(rd(t),t.stateNode===null){var r=Lf,o=n.contextType;typeof o=="object"&&o!==null&&(r=Yi(o)),r=new n(i,r),t.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=w7,t.stateNode=r,r._reactInternals=t,r=t.stateNode,r.props=i,r.state=t.memoizedState,r.refs={},Ww(t),o=n.contextType,r.context=typeof o=="object"&&o!==null?Yi(o):Lf,r.state=t.memoizedState,o=n.getDerivedStateFromProps,typeof o=="function"&&(GE(t,n,o,i),r.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(o=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),o!==r.state&&w7.enqueueReplaceState(r,r.state,null),l0(t,i,r,s),a0(),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308),i=!0}else if(e===null){r=t.stateNode;var a=t.memoizedProps,l=sd(n,a);r.props=l;var c=r.context,u=n.contextType;o=Lf,typeof u=="object"&&u!==null&&(o=Yi(u));var d=n.getDerivedStateFromProps;u=typeof d=="function"||typeof r.getSnapshotBeforeUpdate=="function",a=t.pendingProps!==a,u||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(a||c!==o)&&zx(t,r,i,o),$l=!1;var f=t.memoizedState;r.state=f,l0(t,i,r,s),a0(),c=t.memoizedState,a||f!==c||$l?(typeof d=="function"&&(GE(t,n,d,i),c=t.memoizedState),(l=$l||Bx(t,n,l,i,f,c,o))?(u||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount()),typeof r.componentDidMount=="function"&&(t.flags|=4194308)):(typeof r.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=c),r.props=i,r.state=c,r.context=o,i=l):(typeof r.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{r=t.stateNode,M7(e,t),o=t.memoizedProps,u=sd(n,o),r.props=u,d=t.pendingProps,f=r.context,c=n.contextType,l=Lf,typeof c=="object"&&c!==null&&(l=Yi(c)),a=n.getDerivedStateFromProps,(c=typeof a=="function"||typeof r.getSnapshotBeforeUpdate=="function")||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(o!==d||f!==l)&&zx(t,r,i,l),$l=!1,f=t.memoizedState,r.state=f,l0(t,i,r,s),a0();var h=t.memoizedState;o!==d||f!==h||$l||e!==null&&e.dependencies!==null&&vb(e.dependencies)?(typeof a=="function"&&(GE(t,n,a,i),h=t.memoizedState),(u=$l||Bx(t,n,u,i,f,h,l)||e!==null&&e.dependencies!==null&&vb(e.dependencies))?(c||typeof r.UNSAFE_componentWillUpdate!="function"&&typeof r.componentWillUpdate!="function"||(typeof r.componentWillUpdate=="function"&&r.componentWillUpdate(i,h,l),typeof r.UNSAFE_componentWillUpdate=="function"&&r.UNSAFE_componentWillUpdate(i,h,l)),typeof r.componentDidUpdate=="function"&&(t.flags|=4),typeof r.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof r.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=h),r.props=i,r.state=h,r.context=l,i=u):(typeof r.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),i=!1)}return r=i,r0(e,t),i=(t.flags&128)!==0,r||i?(r=t.stateNode,n=i&&typeof n.getDerivedStateFromError!="function"?null:r.render(),t.flags|=1,e!==null&&i?(t.child=nd(t,e.child,null,s),t.child=nd(t,null,n,s)):Si(e,t,n,s),t.memoizedState=r.state,e=t.child):e=nl(e,t,s),e}function Yx(e,t,n,i){return Jm(),t.flags|=256,Si(e,t,n,i),t.child}var XE={dehydrated:null,treeContext:null,retryLane:0};function jE(e){return{baseLanes:e,cachePool:SO()}}function YE(e,t,n){return e=e!==null?e.childLanes&~n:0,t&&(e|=Er),e}function hP(e,t,n){var i=t.pendingProps,s=!1,r=(t.flags&128)!==0,o;if((o=r)||(o=e!==null&&e.memoizedState===null?!1:(Jn.current&2)!==0),o&&(s=!0,t.flags&=-129),o=(t.flags&32)!==0,t.flags&=-33,e===null){if(It){if(s?Kl(t):Zl(),It){var a=Ai,l;if(l=a){e:{for(l=a,a=ko;l.nodeType!==8;){if(!a){a=null;break e}if(l=Qr(l.nextSibling),l===null){a=null;break e}}a=l}a!==null?(t.memoizedState={dehydrated:a,treeContext:Vu!==null?{id:Oa,overflow:Pa}:null,retryLane:536870912},l=yr(18,null,null,0),l.stateNode=a,l.return=t,t.child=l,as=t,Ai=null,l=!0):l=!1}l||td(t)}if(a=t.memoizedState,a!==null&&(a=a.dehydrated,a!==null))return a.data==="$!"?t.lanes=16:t.lanes=536870912,null;Fa(t)}return a=i.children,i=i.fallback,s?(Zl(),s=t.mode,a=S7({mode:"hidden",children:a},s),i=Gu(i,s,n,null),a.return=t,i.return=t,a.sibling=i,t.child=a,s=t.child,s.memoizedState=jE(n),s.childLanes=YE(e,o,n),t.memoizedState=XE,i):(Kl(t),I7(t,a))}if(l=e.memoizedState,l!==null&&(a=l.dehydrated,a!==null)){if(r)t.flags&256?(Kl(t),t.flags&=-257,t=WE(e,t,n)):t.memoizedState!==null?(Zl(),t.child=e.child,t.flags|=128,t=null):(Zl(),s=i.fallback,a=t.mode,i=S7({mode:"visible",children:i.children},a),s=Gu(s,a,n,null),s.flags|=2,i.return=t,s.return=t,i.sibling=s,t.child=i,nd(t,e.child,null,n),i=t.child,i.memoizedState=jE(n),i.childLanes=YE(e,o,n),t.memoizedState=XE,t=s);else if(Kl(t),a.data==="$!"){if(o=a.nextSibling&&a.nextSibling.dataset,o)var c=o.dgst;o=c,i=Error(ne(419)),i.stack="",i.digest=o,j0({value:i,source:null,stack:null}),t=WE(e,t,n)}else if(pi||np(e,t,n,!1),o=(n&e.childLanes)!==0,pi||o){if(o=qt,o!==null){if(i=n&-n,i&42)i=1;else switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=64;break;case 268435456:i=134217728;break;default:i=0}if(i=i&(o.suspendedLanes|n)?0:i,i!==0&&i!==l.retryLane)throw l.retryLane=i,Mc(e,i),ds(o,e,i),uP}a.data==="$?"||F7(),t=WE(e,t,n)}else a.data==="$?"?(t.flags|=128,t.child=e.child,t=NQ.bind(null,e),a._reactRetry=t,t=null):(e=l.treeContext,Ai=Qr(a.nextSibling),as=t,It=!0,jr=null,ko=!1,e!==null&&(fr[hr++]=Oa,fr[hr++]=Pa,fr[hr++]=Vu,Oa=e.id,Pa=e.overflow,Vu=t),t=I7(t,i.children),t.flags|=4096);return t}return s?(Zl(),s=i.fallback,a=t.mode,l=e.child,c=l.sibling,i=hc(l,{mode:"hidden",children:i.children}),i.subtreeFlags=l.subtreeFlags&31457280,c!==null?s=hc(c,s):(s=Gu(s,a,n,null),s.flags|=2),s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,a=e.child.memoizedState,a===null?a=jE(n):(l=a.cachePool,l!==null?(c=Qn._currentValue,l=l.parent!==c?{parent:c,pool:c}:l):l=SO(),a={baseLanes:a.baseLanes|n,cachePool:l}),s.memoizedState=a,s.childLanes=YE(e,o,n),t.memoizedState=XE,i):(Kl(t),n=e.child,e=n.sibling,n=hc(n,{mode:"visible",children:i.children}),n.return=t,n.sibling=null,e!==null&&(o=t.deletions,o===null?(t.deletions=[e],t.flags|=16):o.push(e)),t.child=n,t.memoizedState=null,n)}function I7(e,t){return t=S7({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function S7(e,t){return NP(e,t,0,null)}function WE(e,t,n){return nd(t,e.child,null,n),e=I7(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Wx(e,t,n){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),C7(e.return,t,n)}function KE(e,t,n,i,s){var r=e.memoizedState;r===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:s}:(r.isBackwards=t,r.rendering=null,r.renderingStartTime=0,r.last=i,r.tail=n,r.tailMode=s)}function gP(e,t,n){var i=t.pendingProps,s=i.revealOrder,r=i.tail;if(Si(e,t,i.children,n),i=Jn.current,i&2)i=i&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Wx(e,n,t);else if(e.tag===19)Wx(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}switch(cn(Jn,i),s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&pb(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),KE(t,!1,s,n,r);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&pb(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}KE(t,!0,n,null,r);break;case"together":KE(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function nl(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Dc|=t.lanes,!(n&t.childLanes))if(e!==null){if(np(e,t,n,!1),(n&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(ne(153));if(t.child!==null){for(e=t.child,n=hc(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=hc(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Yw(e,t){return e.lanes&t?!0:(e=e.dependencies,!!(e!==null&&vb(e)))}function vQ(e,t,n){switch(t.tag){case 3:ab(t,t.stateNode.containerInfo),ql(t,Qn,e.memoizedState.cache),Jm();break;case 27:case 5:o7(t);break;case 4:ab(t,t.stateNode.containerInfo);break;case 10:ql(t,t.type,t.memoizedProps.value);break;case 13:var i=t.memoizedState;if(i!==null)return i.dehydrated!==null?(Kl(t),t.flags|=128,null):n&t.child.childLanes?hP(e,t,n):(Kl(t),e=nl(e,t,n),e!==null?e.sibling:null);Kl(t);break;case 19:var s=(e.flags&128)!==0;if(i=(n&t.childLanes)!==0,i||(np(e,t,n,!1),i=(n&t.childLanes)!==0),s){if(i)return gP(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),cn(Jn,Jn.current),i)break;return null;case 22:case 23:return t.lanes=0,fP(e,t,n);case 24:ql(t,Qn,e.memoizedState.cache)}return nl(e,t,n)}function mP(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps)pi=!0;else{if(!Yw(e,n)&&!(t.flags&128))return pi=!1,vQ(e,t,n);pi=!!(e.flags&131072)}else pi=!1,It&&t.flags&1048576&&EO(t,gb,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var i=t.elementType,s=i._init;if(i=s(i._payload),t.type=i,typeof i=="function")qw(i)?(e=sd(i,e),t.tag=1,t=jx(null,t,i,e,n)):(t.tag=0,t=T7(null,t,i,e,n));else{if(i!=null){if(s=i.$$typeof,s===bw){t.tag=11,t=Vx(null,t,i,e,n);break e}else if(s===yw){t.tag=14,t=$x(null,t,i,e,n);break e}}throw t=s7(i)||i,Error(ne(306,t,""))}}return t;case 0:return T7(e,t,t.type,t.pendingProps,n);case 1:return i=t.type,s=sd(i,t.pendingProps),jx(e,t,i,s,n);case 3:e:{if(ab(t,t.stateNode.containerInfo),e===null)throw Error(ne(387));var r=t.pendingProps;s=t.memoizedState,i=s.element,M7(e,t),l0(t,r,null,n);var o=t.memoizedState;if(r=o.cache,ql(t,Qn,r),r!==s.cache&&A7(t,[Qn],n,!0),a0(),r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){t=Yx(e,t,r,n);break e}else if(r!==i){i=mr(Error(ne(424)),t),j0(i),t=Yx(e,t,r,n);break e}else for(Ai=Qr(t.stateNode.containerInfo.firstChild),as=t,It=!0,jr=null,ko=!0,n=TO(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Jm(),r===i){t=nl(e,t,n);break e}Si(e,t,r,n)}t=t.child}return t;case 26:return r0(e,t),e===null?(n=fC(t.type,null,t.pendingProps,null))?t.memoizedState=n:It||(n=t.type,e=t.pendingProps,i=Cb(uc.current).createElement(n),i[ji]=t,i[xs]=e,Mi(i,n,e),gi(i),t.stateNode=i):t.memoizedState=fC(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return o7(t),e===null&&It&&(i=t.stateNode=JP(t.type,t.pendingProps,uc.current),as=t,ko=!0,Ai=Qr(i.firstChild)),i=t.pendingProps.children,e!==null||It?Si(e,t,i,n):t.child=nd(t,null,i,n),r0(e,t),t.child;case 5:return e===null&&It&&((s=i=Ai)&&(i=qQ(i,t.type,t.pendingProps,ko),i!==null?(t.stateNode=i,as=t,Ai=Qr(i.firstChild),ko=!1,s=!0):s=!1),s||td(t)),o7(t),s=t.type,r=t.pendingProps,o=e!==null?e.memoizedProps:null,i=r.children,$7(s,r)?i=null:o!==null&&$7(s,o)&&(t.flags|=32),t.memoizedState!==null&&(s=Ow(e,t,gQ,null,null,n),Q0._currentValue=s),r0(e,t),Si(e,t,i,n),t.child;case 6:return e===null&&It&&((e=n=Ai)&&(n=QQ(n,t.pendingProps,ko),n!==null?(t.stateNode=n,as=t,Ai=null,e=!0):e=!1),e||td(t)),null;case 13:return hP(e,t,n);case 4:return ab(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=nd(t,null,i,n):Si(e,t,i,n),t.child;case 11:return Vx(e,t,t.type,t.pendingProps,n);case 7:return Si(e,t,t.pendingProps,n),t.child;case 8:return Si(e,t,t.pendingProps.children,n),t.child;case 12:return Si(e,t,t.pendingProps.children,n),t.child;case 10:return i=t.pendingProps,ql(t,t.type,i.value),Si(e,t,i.children,n),t.child;case 9:return s=t.type._context,i=t.pendingProps.children,rd(t),s=Yi(s),i=i(s),t.flags|=1,Si(e,t,i,n),t.child;case 14:return $x(e,t,t.type,t.pendingProps,n);case 15:return dP(e,t,t.type,t.pendingProps,n);case 19:return gP(e,t,n);case 22:return fP(e,t,n);case 24:return rd(t),i=Yi(Qn),e===null?(s=Lw(),s===null&&(s=qt,r=Dw(),s.pooledCache=r,r.refCount++,r!==null&&(s.pooledCacheLanes|=n),s=r),t.memoizedState={parent:i,cache:s},Ww(t),ql(t,Qn,s)):(e.lanes&n&&(M7(e,t),l0(t,null,null,n),a0()),s=e.memoizedState,r=t.memoizedState,s.parent!==i?(s={parent:i,cache:i},t.memoizedState=s,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=s),ql(t,Qn,i)):(i=r.cache,ql(t,Qn,i),i!==s.cache&&A7(t,[Qn],n,!0))),Si(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(ne(156,t.tag))}var x7=oa(null),Ld=null,Ba=null;function ql(e,t,n){cn(x7,t._currentValue),t._currentValue=n}function $a(e){e._currentValue=x7.current,yi(x7)}function C7(e,t,n){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function A7(e,t,n,i){var s=e.child;for(s!==null&&(s.return=e);s!==null;){var r=s.dependencies;if(r!==null){var o=s.child;r=r.firstContext;e:for(;r!==null;){var a=r;r=s;for(var l=0;l<t.length;l++)if(a.context===t[l]){r.lanes|=n,a=r.alternate,a!==null&&(a.lanes|=n),C7(r.return,n,e),i||(o=null);break e}r=a.next}}else if(s.tag===18){if(o=s.return,o===null)throw Error(ne(341));o.lanes|=n,r=o.alternate,r!==null&&(r.lanes|=n),C7(o,n,e),o=null}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}}function np(e,t,n,i){e=null;for(var s=t,r=!1;s!==null;){if(!r){if(s.flags&524288)r=!0;else if(s.flags&262144)break}if(s.tag===10){var o=s.alternate;if(o===null)throw Error(ne(387));if(o=o.memoizedProps,o!==null){var a=s.type;tr(s.pendingProps.value,o.value)||(e!==null?e.push(a):e=[a])}}else if(s===ob.current){if(o=s.alternate,o===null)throw Error(ne(387));o.memoizedState.memoizedState!==s.memoizedState.memoizedState&&(e!==null?e.push(Q0):e=[Q0])}s=s.return}e!==null&&A7(t,e,n,i),t.flags|=262144}function vb(e){for(e=e.firstContext;e!==null;){if(!tr(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function rd(e){Ld=e,Ba=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Yi(e){return pP(Ld,e)}function mU(e,t){return Ld===null&&rd(e),pP(e,t)}function pP(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},Ba===null){if(e===null)throw Error(ne(308));Ba=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Ba=Ba.next=t;return n}var $l=!1;function Ww(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function M7(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function dc(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function fc(e,t,n){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,bn&2){var s=i.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),i.pending=t,t=fb(e),yO(e,null,n),t}return S5(e,i,t,n),fb(e)}function o0(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194176)!==0)){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,jN(e,n)}}function ZE(e,t){var n=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var s=null,r=null;if(n=n.firstBaseUpdate,n!==null){do{var o={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};r===null?s=r=o:r=r.next=o,n=n.next}while(n!==null);r===null?s=r=t:r=r.next=t}else s=r=t;n={baseState:i.baseState,firstBaseUpdate:s,lastBaseUpdate:r,shared:i.shared,callbacks:i.callbacks},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var k7=!1;function a0(){if(k7){var e=eh;if(e!==null)throw e}}function l0(e,t,n,i){k7=!1;var s=e.updateQueue;$l=!1;var r=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?r=c:o.next=c,o=l;var u=e.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(r!==null){var d=s.baseState;o=0,u=c=l=null,a=r;do{var f=a.lane&-536870913,h=f!==a.lane;if(h?(ht&f)===f:(i&f)===f){f!==0&&f===Ih&&(k7=!0),u!==null&&(u=u.next={lane:0,tag:a.tag,payload:a.payload,callback:null,next:null});e:{var m=e,p=a;f=t;var U=n;switch(p.tag){case 1:if(m=p.payload,typeof m=="function"){d=m.call(U,d,f);break e}d=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=p.payload,f=typeof m=="function"?m.call(U,d,f):m,f==null)break e;d=sn({},d,f);break e;case 2:$l=!0}}f=a.callback,f!==null&&(e.flags|=64,h&&(e.flags|=8192),h=s.callbacks,h===null?s.callbacks=[f]:h.push(f))}else h={lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=h,l=d):u=u.next=h,o|=f;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;h=a,a=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(!0);u===null&&(l=d),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=u,r===null&&(s.shared.lanes=0),Dc|=o,e.lanes=o,e.memoizedState=d}}function UP(e,t){if(typeof e!="function")throw Error(ne(191,e));e.call(t)}function bP(e,t){var n=e.callbacks;if(n!==null)for(e.callbacks=null,e=0;e<n.length;e++)UP(n[e],t)}function ip(e,t){try{var n=t.updateQueue,i=n!==null?n.lastEffect:null;if(i!==null){var s=i.next;n=s;do{if((n.tag&e)===e){i=void 0;var r=n.create,o=n.inst;i=r(),o.destroy=i}n=n.next}while(n!==s)}}catch(a){Gt(t,t.return,a)}}function Rc(e,t,n){try{var i=t.updateQueue,s=i!==null?i.lastEffect:null;if(s!==null){var r=s.next;i=r;do{if((i.tag&e)===e){var o=i.inst,a=o.destroy;if(a!==void 0){o.destroy=void 0,s=t;var l=n;try{a()}catch(c){Gt(s,l,c)}}}i=i.next}while(i!==r)}}catch(c){Gt(t,t.return,c)}}function yP(e){var t=e.updateQueue;if(t!==null){var n=e.stateNode;try{bP(t,n)}catch(i){Gt(e,e.return,i)}}}function EP(e,t,n){n.props=sd(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(i){Gt(e,t,i)}}function ku(e,t){try{var n=e.ref;if(n!==null){var i=e.stateNode;switch(e.tag){case 26:case 27:case 5:var s=i;break;default:s=i}typeof n=="function"?e.refCleanup=n(s):n.current=s}}catch(r){Gt(e,t,r)}}function zs(e,t){var n=e.ref,i=e.refCleanup;if(n!==null)if(typeof i=="function")try{i()}catch(s){Gt(e,t,s)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(s){Gt(e,t,s)}else n.current=null}function vP(e){var t=e.type,n=e.memoizedProps,i=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&i.focus();break e;case"img":n.src?i.src=n.src:n.srcSet&&(i.srcset=n.srcSet)}}catch(s){Gt(e,e.return,s)}}function Kx(e,t,n){try{var i=e.stateNode;jQ(i,e.type,n,t),i[xs]=t}catch(s){Gt(e,e.return,s)}}function wP(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27||e.tag===4}function qE(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||wP(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==27&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function R7(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=D5));else if(i!==4&&i!==27&&(e=e.child,e!==null))for(R7(e,t,n),e=e.sibling;e!==null;)R7(e,t,n),e=e.sibling}function wb(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(i!==4&&i!==27&&(e=e.child,e!==null))for(wb(e,t,n),e=e.sibling;e!==null;)wb(e,t,n),e=e.sibling}var xa=!1,_n=!1,QE=!1,Zx=typeof WeakSet=="function"?WeakSet:Set,fi=null,qx=!1;function wQ(e,t){if(e=e.containerInfo,H7=Rb,e=fO(e),xw(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var s=i.anchorOffset,r=i.focusNode;i=i.focusOffset;try{n.nodeType,r.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,u=0,d=e,f=null;t:for(;;){for(var h;d!==n||s!==0&&d.nodeType!==3||(a=o+s),d!==r||i!==0&&d.nodeType!==3||(l=o+i),d.nodeType===3&&(o+=d.nodeValue.length),(h=d.firstChild)!==null;)f=d,d=h;for(;;){if(d===e)break t;if(f===n&&++c===s&&(a=o),f===r&&++u===i&&(l=o),(h=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=h}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(V7={focusedElem:e,selectionRange:n},Rb=!1,fi=t;fi!==null;)if(t=fi,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,fi=e;else for(;fi!==null;){switch(t=fi,r=t.alternate,e=t.flags,t.tag){case 0:break;case 11:case 15:break;case 1:if(e&1024&&r!==null){e=void 0,n=t,s=r.memoizedProps,r=r.memoizedState,i=n.stateNode;try{var m=sd(n.type,s,n.elementType===n.type);e=i.getSnapshotBeforeUpdate(m,r),i.__reactInternalSnapshotBeforeUpdate=e}catch(p){Gt(n,n.return,p)}}break;case 3:if(e&1024){if(e=t.stateNode.containerInfo,n=e.nodeType,n===9)G7(e);else if(n===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":G7(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(e&1024)throw Error(ne(163))}if(e=t.sibling,e!==null){e.return=t.return,fi=e;break}fi=t.return}return m=qx,qx=!1,m}function _P(e,t,n){var i=n.flags;switch(n.tag){case 0:case 11:case 15:ga(e,n),i&4&&ip(5,n);break;case 1:if(ga(e,n),i&4)if(e=n.stateNode,t===null)try{e.componentDidMount()}catch(a){Gt(n,n.return,a)}else{var s=sd(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(s,t,e.__reactInternalSnapshotBeforeUpdate)}catch(a){Gt(n,n.return,a)}}i&64&&yP(n),i&512&&ku(n,n.return);break;case 3:if(ga(e,n),i&64&&(i=n.updateQueue,i!==null)){if(e=null,n.child!==null)switch(n.child.tag){case 27:case 5:e=n.child.stateNode;break;case 1:e=n.child.stateNode}try{bP(i,e)}catch(a){Gt(n,n.return,a)}}break;case 26:ga(e,n),i&512&&ku(n,n.return);break;case 27:case 5:ga(e,n),t===null&&i&4&&vP(n),i&512&&ku(n,n.return);break;case 12:ga(e,n);break;case 13:ga(e,n),i&4&&SP(e,n);break;case 22:if(s=n.memoizedState!==null||xa,!s){t=t!==null&&t.memoizedState!==null||_n;var r=xa,o=_n;xa=s,(_n=t)&&!o?Pl(e,n,(n.subtreeFlags&8772)!==0):ga(e,n),xa=r,_n=o}i&512&&(n.memoizedProps.mode==="manual"?ku(n,n.return):zs(n,n.return));break;default:ga(e,n)}}function TP(e){var t=e.alternate;t!==null&&(e.alternate=null,TP(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&vw(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Fn=null,Ls=!1;function ha(e,t,n){for(n=n.child;n!==null;)IP(e,t,n),n=n.sibling}function IP(e,t,n){if(Ys&&typeof Ys.onCommitFiberUnmount=="function")try{Ys.onCommitFiberUnmount(Km,n)}catch{}switch(n.tag){case 26:_n||zs(n,t),ha(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:_n||zs(n,t);var i=Fn,s=Ls;for(Fn=n.stateNode,ha(e,t,n),n=n.stateNode,t=n.attributes;t.length;)n.removeAttributeNode(t[0]);vw(n),Fn=i,Ls=s;break;case 5:_n||zs(n,t);case 6:s=Fn;var r=Ls;if(Fn=null,ha(e,t,n),Fn=s,Ls=r,Fn!==null)if(Ls)try{e=Fn,i=n.stateNode,e.nodeType===8?e.parentNode.removeChild(i):e.removeChild(i)}catch(o){Gt(n,t,o)}else try{Fn.removeChild(n.stateNode)}catch(o){Gt(n,t,o)}break;case 18:Fn!==null&&(Ls?(t=Fn,n=n.stateNode,t.nodeType===8?u8(t.parentNode,n):t.nodeType===1&&u8(t,n),tm(t)):u8(Fn,n.stateNode));break;case 4:i=Fn,s=Ls,Fn=n.stateNode.containerInfo,Ls=!0,ha(e,t,n),Fn=i,Ls=s;break;case 0:case 11:case 14:case 15:_n||Rc(2,n,t),_n||Rc(4,n,t),ha(e,t,n);break;case 1:_n||(zs(n,t),i=n.stateNode,typeof i.componentWillUnmount=="function"&&EP(n,t,i)),ha(e,t,n);break;case 21:ha(e,t,n);break;case 22:_n||zs(n,t),_n=(i=_n)||n.memoizedState!==null,ha(e,t,n),_n=i;break;default:ha(e,t,n)}}function SP(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{tm(e)}catch(n){Gt(t,t.return,n)}}function _Q(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new Zx),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new Zx),t;default:throw Error(ne(435,e.tag))}}function JE(e,t){var n=_Q(e);t.forEach(function(i){var s=OQ.bind(null,e,i);n.has(i)||(n.add(i),i.then(s,s))})}function sr(e,t){var n=t.deletions;if(n!==null)for(var i=0;i<n.length;i++){var s=n[i],r=e,o=t,a=o;e:for(;a!==null;){switch(a.tag){case 27:case 5:Fn=a.stateNode,Ls=!1;break e;case 3:Fn=a.stateNode.containerInfo,Ls=!0;break e;case 4:Fn=a.stateNode.containerInfo,Ls=!0;break e}a=a.return}if(Fn===null)throw Error(ne(160));IP(r,o,s),Fn=null,Ls=!1,r=s.alternate,r!==null&&(r.return=null),s.return=null}if(t.subtreeFlags&13878)for(t=t.child;t!==null;)xP(t,e),t=t.sibling}var Vr=null;function xP(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:sr(t,e),rr(e),i&4&&(Rc(3,e,e.return),ip(3,e),Rc(5,e,e.return));break;case 1:sr(t,e),rr(e),i&512&&(_n||n===null||zs(n,n.return)),i&64&&xa&&(e=e.updateQueue,e!==null&&(i=e.callbacks,i!==null&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=n===null?i:n.concat(i))));break;case 26:var s=Vr;if(sr(t,e),rr(e),i&512&&(_n||n===null||zs(n,n.return)),i&4){var r=n!==null?n.memoizedState:null;if(i=e.memoizedState,n===null)if(i===null)if(e.stateNode===null){e:{i=e.type,n=e.memoizedProps,s=s.ownerDocument||s;t:switch(i){case"title":r=s.getElementsByTagName("title")[0],(!r||r[V0]||r[ji]||r.namespaceURI==="http://www.w3.org/2000/svg"||r.hasAttribute("itemprop"))&&(r=s.createElement(i),s.head.insertBefore(r,s.querySelector("head > title"))),Mi(r,i,n),r[ji]=e,gi(r),i=r;break e;case"link":var o=gC("link","href",s).get(i+(n.href||""));if(o){for(var a=0;a<o.length;a++)if(r=o[a],r.getAttribute("href")===(n.href==null?null:n.href)&&r.getAttribute("rel")===(n.rel==null?null:n.rel)&&r.getAttribute("title")===(n.title==null?null:n.title)&&r.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){o.splice(a,1);break t}}r=s.createElement(i),Mi(r,i,n),s.head.appendChild(r);break;case"meta":if(o=gC("meta","content",s).get(i+(n.content||""))){for(a=0;a<o.length;a++)if(r=o[a],r.getAttribute("content")===(n.content==null?null:""+n.content)&&r.getAttribute("name")===(n.name==null?null:n.name)&&r.getAttribute("property")===(n.property==null?null:n.property)&&r.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&r.getAttribute("charset")===(n.charSet==null?null:n.charSet)){o.splice(a,1);break t}}r=s.createElement(i),Mi(r,i,n),s.head.appendChild(r);break;default:throw Error(ne(468,i))}r[ji]=e,gi(r),i=r}e.stateNode=i}else mC(s,e.type,e.stateNode);else e.stateNode=hC(s,i,e.memoizedProps);else r!==i?(r===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):r.count--,i===null?mC(s,e.type,e.stateNode):hC(s,i,e.memoizedProps)):i===null&&e.stateNode!==null&&Kx(e,e.memoizedProps,n.memoizedProps)}break;case 27:if(i&4&&e.alternate===null){s=e.stateNode,r=e.memoizedProps;try{for(var l=s.firstChild;l;){var c=l.nextSibling,u=l.nodeName;l[V0]||u==="HEAD"||u==="BODY"||u==="SCRIPT"||u==="STYLE"||u==="LINK"&&l.rel.toLowerCase()==="stylesheet"||s.removeChild(l),l=c}for(var d=e.type,f=s.attributes;f.length;)s.removeAttributeNode(f[0]);Mi(s,d,r),s[ji]=e,s[xs]=r}catch(m){Gt(e,e.return,m)}}case 5:if(sr(t,e),rr(e),i&512&&(_n||n===null||zs(n,n.return)),e.flags&32){s=e.stateNode;try{_h(s,"")}catch(m){Gt(e,e.return,m)}}i&4&&e.stateNode!=null&&(s=e.memoizedProps,Kx(e,s,n!==null?n.memoizedProps:s)),i&1024&&(QE=!0);break;case 6:if(sr(t,e),rr(e),i&4){if(e.stateNode===null)throw Error(ne(162));i=e.memoizedProps,n=e.stateNode;try{n.nodeValue=i}catch(m){Gt(e,e.return,m)}}break;case 3:if(w2=null,s=Vr,Vr=Ab(t.containerInfo),sr(t,e),Vr=s,rr(e),i&4&&n!==null&&n.memoizedState.isDehydrated)try{tm(t.containerInfo)}catch(m){Gt(e,e.return,m)}QE&&(QE=!1,CP(e));break;case 4:i=Vr,Vr=Ab(e.stateNode.containerInfo),sr(t,e),rr(e),Vr=i;break;case 12:sr(t,e),rr(e);break;case 13:sr(t,e),rr(e),e.child.flags&8192&&e.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(e9=Ho()),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,JE(e,i)));break;case 22:if(i&512&&(_n||n===null||zs(n,n.return)),l=e.memoizedState!==null,c=n!==null&&n.memoizedState!==null,u=xa,d=_n,xa=u||l,_n=d||c,sr(t,e),_n=d,xa=u,rr(e),t=e.stateNode,t._current=e,t._visibility&=-3,t._visibility|=t._pendingVisibility&2,i&8192&&(t._visibility=l?t._visibility&-2:t._visibility|1,l&&(t=xa||_n,n===null||c||t||mf(e)),e.memoizedProps===null||e.memoizedProps.mode!=="manual"))e:for(n=null,t=e;;){if(t.tag===5||t.tag===26||t.tag===27){if(n===null){c=n=t;try{if(s=c.stateNode,l)r=s.style,typeof r.setProperty=="function"?r.setProperty("display","none","important"):r.display="none";else{o=c.stateNode,a=c.memoizedProps.style;var h=a!=null&&a.hasOwnProperty("display")?a.display:null;o.style.display=h==null||typeof h=="boolean"?"":(""+h).trim()}}catch(m){Gt(c,c.return,m)}}}else if(t.tag===6){if(n===null){c=t;try{c.stateNode.nodeValue=l?"":c.memoizedProps}catch(m){Gt(c,c.return,m)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}i&4&&(i=e.updateQueue,i!==null&&(n=i.retryQueue,n!==null&&(i.retryQueue=null,JE(e,n))));break;case 19:sr(t,e),rr(e),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,JE(e,i)));break;case 21:break;default:sr(t,e),rr(e)}}function rr(e){var t=e.flags;if(t&2){try{if(e.tag!==27){e:{for(var n=e.return;n!==null;){if(wP(n)){var i=n;break e}n=n.return}throw Error(ne(160))}switch(i.tag){case 27:var s=i.stateNode,r=qE(e);wb(e,r,s);break;case 5:var o=i.stateNode;i.flags&32&&(_h(o,""),i.flags&=-33);var a=qE(e);wb(e,a,o);break;case 3:case 4:var l=i.stateNode.containerInfo,c=qE(e);R7(e,c,l);break;default:throw Error(ne(161))}}}catch(u){Gt(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function CP(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;CP(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function ga(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)_P(e,t.alternate,t),t=t.sibling}function mf(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:Rc(4,t,t.return),mf(t);break;case 1:zs(t,t.return);var n=t.stateNode;typeof n.componentWillUnmount=="function"&&EP(t,t.return,n),mf(t);break;case 26:case 27:case 5:zs(t,t.return),mf(t);break;case 22:zs(t,t.return),t.memoizedState===null&&mf(t);break;default:mf(t)}e=e.sibling}}function Pl(e,t,n){for(n=n&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var i=t.alternate,s=e,r=t,o=r.flags;switch(r.tag){case 0:case 11:case 15:Pl(s,r,n),ip(4,r);break;case 1:if(Pl(s,r,n),i=r,s=i.stateNode,typeof s.componentDidMount=="function")try{s.componentDidMount()}catch(c){Gt(i,i.return,c)}if(i=r,s=i.updateQueue,s!==null){var a=i.stateNode;try{var l=s.shared.hiddenCallbacks;if(l!==null)for(s.shared.hiddenCallbacks=null,s=0;s<l.length;s++)UP(l[s],a)}catch(c){Gt(i,i.return,c)}}n&&o&64&&yP(r),ku(r,r.return);break;case 26:case 27:case 5:Pl(s,r,n),n&&i===null&&o&4&&vP(r),ku(r,r.return);break;case 12:Pl(s,r,n);break;case 13:Pl(s,r,n),n&&o&4&&SP(s,r);break;case 22:r.memoizedState===null&&Pl(s,r,n),ku(r,r.return);break;default:Pl(s,r,n)}t=t.sibling}}function Kw(e,t){var n=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==n&&(e!=null&&e.refCount++,n!=null&&ep(n))}function Zw(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&ep(e))}function Ml(e,t,n,i){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)AP(e,t,n,i),t=t.sibling}function AP(e,t,n,i){var s=t.flags;switch(t.tag){case 0:case 11:case 15:Ml(e,t,n,i),s&2048&&ip(9,t);break;case 3:Ml(e,t,n,i),s&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&ep(e)));break;case 12:if(s&2048){Ml(e,t,n,i),e=t.stateNode;try{var r=t.memoizedProps,o=r.id,a=r.onPostCommit;typeof a=="function"&&a(o,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(l){Gt(t,t.return,l)}}else Ml(e,t,n,i);break;case 23:break;case 22:r=t.stateNode,t.memoizedState!==null?r._visibility&4?Ml(e,t,n,i):c0(e,t):r._visibility&4?Ml(e,t,n,i):(r._visibility|=4,pf(e,t,n,i,(t.subtreeFlags&10256)!==0)),s&2048&&Kw(t.alternate,t);break;case 24:Ml(e,t,n,i),s&2048&&Zw(t.alternate,t);break;default:Ml(e,t,n,i)}}function pf(e,t,n,i,s){for(s=s&&(t.subtreeFlags&10256)!==0,t=t.child;t!==null;){var r=e,o=t,a=n,l=i,c=o.flags;switch(o.tag){case 0:case 11:case 15:pf(r,o,a,l,s),ip(8,o);break;case 23:break;case 22:var u=o.stateNode;o.memoizedState!==null?u._visibility&4?pf(r,o,a,l,s):c0(r,o):(u._visibility|=4,pf(r,o,a,l,s)),s&&c&2048&&Kw(o.alternate,o);break;case 24:pf(r,o,a,l,s),s&&c&2048&&Zw(o.alternate,o);break;default:pf(r,o,a,l,s)}t=t.sibling}}function c0(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var n=e,i=t,s=i.flags;switch(i.tag){case 22:c0(n,i),s&2048&&Kw(i.alternate,i);break;case 24:c0(n,i),s&2048&&Zw(i.alternate,i);break;default:c0(n,i)}t=t.sibling}}var M1=8192;function ef(e){if(e.subtreeFlags&M1)for(e=e.child;e!==null;)MP(e),e=e.sibling}function MP(e){switch(e.tag){case 26:ef(e),e.flags&M1&&e.memoizedState!==null&&dJ(Vr,e.memoizedState,e.memoizedProps);break;case 5:ef(e);break;case 3:case 4:var t=Vr;Vr=Ab(e.stateNode.containerInfo),ef(e),Vr=t;break;case 22:e.memoizedState===null&&(t=e.alternate,t!==null&&t.memoizedState!==null?(t=M1,M1=16777216,ef(e),M1=t):ef(e));break;default:ef(e)}}function kP(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function e1(e){var t=e.deletions;if(e.flags&16){if(t!==null)for(var n=0;n<t.length;n++){var i=t[n];fi=i,DP(i,e)}kP(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)RP(e),e=e.sibling}function RP(e){switch(e.tag){case 0:case 11:case 15:e1(e),e.flags&2048&&Rc(9,e,e.return);break;case 3:e1(e);break;case 12:e1(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&4&&(e.return===null||e.return.tag!==13)?(t._visibility&=-5,y2(e)):e1(e);break;default:e1(e)}}function y2(e){var t=e.deletions;if(e.flags&16){if(t!==null)for(var n=0;n<t.length;n++){var i=t[n];fi=i,DP(i,e)}kP(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:Rc(8,t,t.return),y2(t);break;case 22:n=t.stateNode,n._visibility&4&&(n._visibility&=-5,y2(t));break;default:y2(t)}e=e.sibling}}function DP(e,t){for(;fi!==null;){var n=fi;switch(n.tag){case 0:case 11:case 15:Rc(8,n,t);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var i=n.memoizedState.cachePool.pool;i!=null&&i.refCount++}break;case 24:ep(n.memoizedState.cache)}if(i=n.child,i!==null)i.return=n,fi=i;else e:for(n=e;fi!==null;){i=fi;var s=i.sibling,r=i.return;if(TP(i),i===n){fi=null;break e}if(s!==null){s.return=r,fi=s;break e}fi=r}}}function TQ(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function yr(e,t,n,i){return new TQ(e,t,n,i)}function qw(e){return e=e.prototype,!(!e||!e.isReactComponent)}function hc(e,t){var n=e.alternate;return n===null?(n=yr(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&31457280,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function LP(e,t){e.flags&=31457282;var n=e.alternate;return n===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function E2(e,t,n,i,s,r){var o=0;if(i=e,typeof e=="function")qw(e)&&(o=1);else if(typeof e=="string")o=cJ(e,n,zo.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case xf:return Gu(n.children,s,r,t);case NN:o=8,s|=24;break;case t7:return e=yr(12,n,t,s|2),e.elementType=t7,e.lanes=r,e;case n7:return e=yr(13,n,t,s),e.elementType=n7,e.lanes=r,e;case i7:return e=yr(19,n,t,s),e.elementType=i7,e.lanes=r,e;case PN:return NP(n,s,r,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case KZ:case Na:o=10;break e;case ON:o=9;break e;case bw:o=11;break e;case yw:o=14;break e;case Vl:o=16,i=null;break e}o=29,n=Error(ne(130,e===null?"null":typeof e,"")),i=null}return t=yr(o,n,t,s),t.elementType=e,t.type=i,t.lanes=r,t}function Gu(e,t,n,i){return e=yr(7,e,i,t),e.lanes=n,e}function NP(e,t,n,i){e=yr(22,e,i,t),e.elementType=PN,e.lanes=n;var s={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var r=s._current;if(r===null)throw Error(ne(456));if(!(s._pendingVisibility&2)){var o=Mc(r,2);o!==null&&(s._pendingVisibility|=2,ds(o,r,2))}},attach:function(){var r=s._current;if(r===null)throw Error(ne(456));if(s._pendingVisibility&2){var o=Mc(r,2);o!==null&&(s._pendingVisibility&=-3,ds(o,r,2))}}};return e.stateNode=s,e}function e8(e,t,n){return e=yr(6,e,null,t),e.lanes=n,e}function t8(e,t,n){return t=yr(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function ma(e){e.flags|=4}function Qx(e,t){if(t.type!=="stylesheet"||t.state.loading&4)e.flags&=-16777217;else if(e.flags|=16777216,!nF(t)){if(t=Ar.current,t!==null&&((ht&4194176)===ht?Vo!==null:(ht&62914560)!==ht&&!(ht&536870912)||t!==Vo))throw n0=p7,vO;e.flags|=8192}}function pU(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?GN():536870912,e.lanes|=t,xh|=t)}function t1(e,t){if(!It)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function hn(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,i=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,i|=s.subtreeFlags&31457280,i|=s.flags&31457280,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,i|=s.subtreeFlags,i|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function IQ(e,t,n){var i=t.pendingProps;switch(kw(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return hn(t),null;case 1:return hn(t),null;case 3:return n=t.stateNode,i=null,e!==null&&(i=e.memoizedState.cache),t.memoizedState.cache!==i&&(t.flags|=2048),$a(Qn),vh(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Qg(t)?ma(t):e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,jr!==null&&(P7(jr),jr=null))),hn(t),null;case 26:return n=t.memoizedState,e===null?(ma(t),n!==null?(hn(t),Qx(t,n)):(hn(t),t.flags&=-16777217)):n?n!==e.memoizedState?(ma(t),hn(t),Qx(t,n)):(hn(t),t.flags&=-16777217):(e.memoizedProps!==i&&ma(t),hn(t),t.flags&=-16777217),null;case 27:lb(t),n=uc.current;var s=t.type;if(e!==null&&t.stateNode!=null)e.memoizedProps!==i&&ma(t);else{if(!i){if(t.stateNode===null)throw Error(ne(166));return hn(t),null}e=zo.current,Qg(t)?Cx(t):(e=JP(s,i,n),t.stateNode=e,ma(t))}return hn(t),null;case 5:if(lb(t),n=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==i&&ma(t);else{if(!i){if(t.stateNode===null)throw Error(ne(166));return hn(t),null}if(e=zo.current,Qg(t))Cx(t);else{switch(s=Cb(uc.current),e){case 1:e=s.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=s.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=s.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=s.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e=typeof i.is=="string"?s.createElement("select",{is:i.is}):s.createElement("select"),i.multiple?e.multiple=!0:i.size&&(e.size=i.size);break;default:e=typeof i.is=="string"?s.createElement(n,{is:i.is}):s.createElement(n)}}e[ji]=t,e[xs]=i;e:for(s=t.child;s!==null;){if(s.tag===5||s.tag===6)e.appendChild(s.stateNode);else if(s.tag!==4&&s.tag!==27&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break e;for(;s.sibling===null;){if(s.return===null||s.return===t)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}t.stateNode=e;e:switch(Mi(e,n,i),n){case"button":case"input":case"select":case"textarea":e=!!i.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&ma(t)}}return hn(t),t.flags&=-16777217,null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==i&&ma(t);else{if(typeof i!="string"&&t.stateNode===null)throw Error(ne(166));if(e=uc.current,Qg(t)){if(e=t.stateNode,n=t.memoizedProps,i=null,s=as,s!==null)switch(s.tag){case 27:case 5:i=s.memoizedProps}e[ji]=t,e=!!(e.nodeValue===n||i!==null&&i.suppressHydrationWarning===!0||ZP(e.nodeValue,n)),e||td(t)}else e=Cb(e).createTextNode(i),e[ji]=t,t.stateNode=e}return hn(t),null;case 13:if(i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(s=Qg(t),i!==null&&i.dehydrated!==null){if(e===null){if(!s)throw Error(ne(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ne(317));s[ji]=t}else Jm(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;hn(t),s=!1}else jr!==null&&(P7(jr),jr=null),s=!0;if(!s)return t.flags&256?(Fa(t),t):(Fa(t),null)}if(Fa(t),t.flags&128)return t.lanes=n,t;if(n=i!==null,e=e!==null&&e.memoizedState!==null,n){i=t.child,s=null,i.alternate!==null&&i.alternate.memoizedState!==null&&i.alternate.memoizedState.cachePool!==null&&(s=i.alternate.memoizedState.cachePool.pool);var r=null;i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(r=i.memoizedState.cachePool.pool),r!==s&&(i.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),pU(t,t.updateQueue),hn(t),null;case 4:return vh(),e===null&&i9(t.stateNode.containerInfo),hn(t),null;case 10:return $a(t.type),hn(t),null;case 19:if(yi(Jn),s=t.memoizedState,s===null)return hn(t),null;if(i=(t.flags&128)!==0,r=s.rendering,r===null)if(i)t1(s,!1);else{if(Tn!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(r=pb(e),r!==null){for(t.flags|=128,t1(s,!1),e=r.updateQueue,t.updateQueue=e,pU(t,e),t.subtreeFlags=0,e=n,n=t.child;n!==null;)LP(n,e),n=n.sibling;return cn(Jn,Jn.current&1|2),t.child}e=e.sibling}s.tail!==null&&Ho()>_b&&(t.flags|=128,i=!0,t1(s,!1),t.lanes=4194304)}else{if(!i)if(e=pb(r),e!==null){if(t.flags|=128,i=!0,e=e.updateQueue,t.updateQueue=e,pU(t,e),t1(s,!0),s.tail===null&&s.tailMode==="hidden"&&!r.alternate&&!It)return hn(t),null}else 2*Ho()-s.renderingStartTime>_b&&n!==536870912&&(t.flags|=128,i=!0,t1(s,!1),t.lanes=4194304);s.isBackwards?(r.sibling=t.child,t.child=r):(e=s.last,e!==null?e.sibling=r:t.child=r,s.last=r)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Ho(),t.sibling=null,e=Jn.current,cn(Jn,i?e&1|2:e&1),t):(hn(t),null);case 22:case 23:return Fa(t),Rw(),i=t.memoizedState!==null,e!==null?e.memoizedState!==null!==i&&(t.flags|=8192):i&&(t.flags|=8192),i?n&536870912&&!(t.flags&128)&&(hn(t),t.subtreeFlags&6&&(t.flags|=8192)):hn(t),n=t.updateQueue,n!==null&&pU(t,n.retryQueue),n=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),i=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(i=t.memoizedState.cachePool.pool),i!==n&&(t.flags|=2048),e!==null&&yi($u),null;case 24:return n=null,e!==null&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),$a(Qn),hn(t),null;case 25:return null}throw Error(ne(156,t.tag))}function SQ(e,t){switch(kw(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return $a(Qn),vh(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return lb(t),null;case 13:if(Fa(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ne(340));Jm()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return yi(Jn),null;case 4:return vh(),null;case 10:return $a(t.type),null;case 22:case 23:return Fa(t),Rw(),e!==null&&yi($u),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return $a(Qn),null;case 25:return null;default:return null}}function OP(e,t){switch(kw(t),t.tag){case 3:$a(Qn),vh();break;case 26:case 27:case 5:lb(t);break;case 4:vh();break;case 13:Fa(t);break;case 19:yi(Jn);break;case 10:$a(t.type);break;case 22:case 23:Fa(t),Rw(),e!==null&&yi($u);break;case 24:$a(Qn)}}var xQ={getCacheForType:function(e){var t=Yi(Qn),n=t.data.get(e);return n===void 0&&(n=e(),t.data.set(e,n)),n}},CQ=typeof WeakMap=="function"?WeakMap:Map,bn=0,qt=null,Je=null,ht=0,Kt=0,Ns=null,Ca=!1,dg=!1,Qw=!1,il=0,Tn=0,Dc=0,Xu=0,Jw=0,Er=0,xh=0,u0=null,Ro=null,D7=!1,e9=0,_b=1/0,Tb=null,gc=null,UU=!1,Tu=null,d0=0,L7=0,N7=null,f0=0,O7=null;function Ks(){if(bn&2&&ht!==0)return ht&-ht;if(Xe.T!==null){var e=Ih;return e!==0?e:n9()}return WN()}function PP(){Er===0&&(Er=!(ht&536870912)||It?$N():536870912);var e=Ar.current;return e!==null&&(e.flags|=32),Er}function ds(e,t,n){(e===qt&&Kt===2||e.cancelPendingCommit!==null)&&(Ch(e,0),Aa(e,ht,Er,!1)),qm(e,n),(!(bn&2)||e!==qt)&&(e===qt&&(!(bn&2)&&(Xu|=n),Tn===4&&Aa(e,ht,Er,!1)),aa(e))}function FP(e,t,n){if(bn&6)throw Error(ne(327));var i=!n&&(t&60)===0&&(t&e.expiredLanes)===0||Zm(e,t),s=i?kQ(e,t):n8(e,t,!0),r=i;do{if(s===0){dg&&!i&&Aa(e,t,0,!1);break}else if(s===6)Aa(e,t,0,!Ca);else{if(n=e.current.alternate,r&&!AQ(n)){s=n8(e,t,!1),r=!1;continue}if(s===2){if(r=t,e.errorRecoveryDisabledLanes&r)var o=0;else o=e.pendingLanes&-536870913,o=o!==0?o:o&536870912?536870912:0;if(o!==0){t=o;e:{var a=e;s=u0;var l=a.current.memoizedState.isDehydrated;if(l&&(Ch(a,o).flags|=256),o=n8(a,o,!1),o!==2){if(Qw&&!l){a.errorRecoveryDisabledLanes|=r,Xu|=r,s=4;break e}r=Ro,Ro=s,r!==null&&P7(r)}s=o}if(r=!1,s!==2)continue}}if(s===1){Ch(e,0),Aa(e,t,0,!0);break}e:{switch(i=e,s){case 0:case 1:throw Error(ne(345));case 4:if((t&4194176)===t){Aa(i,t,Er,!Ca);break e}break;case 2:Ro=null;break;case 3:case 5:break;default:throw Error(ne(329))}if(i.finishedWork=n,i.finishedLanes=t,(t&62914560)===t&&(r=e9+300-Ho(),10<r)){if(Aa(i,t,Er,!Ca),v5(i,0)!==0)break e;i.timeoutHandle=QP(Jx.bind(null,i,n,Ro,Tb,D7,t,Er,Xu,xh,Ca,2,-0,0),r);break e}Jx(i,n,Ro,Tb,D7,t,Er,Xu,xh,Ca,0,-0,0)}}break}while(!0);aa(e)}function P7(e){Ro===null?Ro=e:Ro.push.apply(Ro,e)}function Jx(e,t,n,i,s,r,o,a,l,c,u,d,f){var h=t.subtreeFlags;if((h&8192||(h&16785408)===16785408)&&(q0={stylesheets:null,count:0,unsuspend:uJ},MP(t),t=fJ(),t!==null)){e.cancelPendingCommit=t(tC.bind(null,e,n,i,s,o,a,l,1,d,f)),Aa(e,r,o,!c);return}tC(e,n,i,s,o,a,l,u,d,f)}function AQ(e){for(var t=e;;){var n=t.tag;if((n===0||n===11||n===15)&&t.flags&16384&&(n=t.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var i=0;i<n.length;i++){var s=n[i],r=s.getSnapshot;s=s.value;try{if(!tr(r(),s))return!1}catch{return!1}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Aa(e,t,n,i){t&=~Jw,t&=~Xu,e.suspendedLanes|=t,e.pingedLanes&=~t,i&&(e.warmLanes|=t),i=e.expirationTimes;for(var s=t;0<s;){var r=31-Ws(s),o=1<<r;i[r]=-1,s&=~o}n!==0&&XN(e,n,t)}function k5(){return bn&6?!0:(sp(0),!1)}function t9(){if(Je!==null){if(Kt===0)var e=Je.return;else e=Je,Ba=Ld=null,Bw(e),Jf=null,Y0=0,e=Je;for(;e!==null;)OP(e.alternate,e),e=e.return;Je=null}}function Ch(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;n!==-1&&(e.timeoutHandle=-1,WQ(n)),n=e.cancelPendingCommit,n!==null&&(e.cancelPendingCommit=null,n()),t9(),qt=e,Je=n=hc(e.current,null),ht=t,Kt=0,Ns=null,Ca=!1,dg=Zm(e,t),Qw=!1,xh=Er=Jw=Xu=Dc=Tn=0,Ro=u0=null,D7=!1,t&8&&(t|=t&32);var i=e.entangledLanes;if(i!==0)for(e=e.entanglements,i&=t;0<i;){var s=31-Ws(i),r=1<<s;t|=e[s],i&=~r}return il=t,I5(),n}function BP(e,t){Ze=null,Xe.H=Yo,t===t0?(t=kx(),Kt=3):t===vO?(t=kx(),Kt=4):Kt=t===uP?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,Ns=t,Je===null&&(Tn=1,Eb(e,mr(t,e.current)))}function zP(){var e=Xe.H;return Xe.H=Yo,e===null?Yo:e}function HP(){var e=Xe.A;return Xe.A=xQ,e}function F7(){Tn=4,Ca||(ht&4194176)!==ht&&Ar.current!==null||(dg=!0),!(Dc&134217727)&&!(Xu&134217727)||qt===null||Aa(qt,ht,Er,!1)}function n8(e,t,n){var i=bn;bn|=2;var s=zP(),r=HP();(qt!==e||ht!==t)&&(Tb=null,Ch(e,t)),t=!1;var o=Tn;e:do try{if(Kt!==0&&Je!==null){var a=Je,l=Ns;switch(Kt){case 8:t9(),o=6;break e;case 3:case 2:case 6:Ar.current===null&&(t=!0);var c=Kt;if(Kt=0,Ns=null,Pf(e,a,l,c),n&&dg){o=0;break e}break;default:c=Kt,Kt=0,Ns=null,Pf(e,a,l,c)}}MQ(),o=Tn;break}catch(u){BP(e,u)}while(!0);return t&&e.shellSuspendCounter++,Ba=Ld=null,bn=i,Xe.H=s,Xe.A=r,Je===null&&(qt=null,ht=0,I5()),o}function MQ(){for(;Je!==null;)VP(Je)}function kQ(e,t){var n=bn;bn|=2;var i=zP(),s=HP();qt!==e||ht!==t?(Tb=null,_b=Ho()+500,Ch(e,t)):dg=Zm(e,t);e:do try{if(Kt!==0&&Je!==null){t=Je;var r=Ns;t:switch(Kt){case 1:Kt=0,Ns=null,Pf(e,t,r,1);break;case 2:if(Mx(r)){Kt=0,Ns=null,eC(t);break}t=function(){Kt===2&&qt===e&&(Kt=7),aa(e)},r.then(t,t);break e;case 3:Kt=7;break e;case 4:Kt=5;break e;case 7:Mx(r)?(Kt=0,Ns=null,eC(t)):(Kt=0,Ns=null,Pf(e,t,r,7));break;case 5:var o=null;switch(Je.tag){case 26:o=Je.memoizedState;case 5:case 27:var a=Je;if(!o||nF(o)){Kt=0,Ns=null;var l=a.sibling;if(l!==null)Je=l;else{var c=a.return;c!==null?(Je=c,R5(c)):Je=null}break t}}Kt=0,Ns=null,Pf(e,t,r,5);break;case 6:Kt=0,Ns=null,Pf(e,t,r,6);break;case 8:t9(),Tn=6;break e;default:throw Error(ne(462))}}RQ();break}catch(u){BP(e,u)}while(!0);return Ba=Ld=null,Xe.H=i,Xe.A=s,bn=n,Je!==null?0:(qt=null,ht=0,I5(),Tn)}function RQ(){for(;Je!==null&&!eq();)VP(Je)}function VP(e){var t=mP(e.alternate,e,il);e.memoizedProps=e.pendingProps,t===null?R5(e):Je=t}function eC(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Xx(n,t,t.pendingProps,t.type,void 0,ht);break;case 11:t=Xx(n,t,t.pendingProps,t.type.render,t.ref,ht);break;case 5:Bw(t);default:OP(n,t),t=Je=LP(t,il),t=mP(n,t,il)}e.memoizedProps=e.pendingProps,t===null?R5(e):Je=t}function Pf(e,t,n,i){Ba=Ld=null,Bw(t),Jf=null,Y0=0;var s=t.return;try{if(EQ(e,s,t,n,ht)){Tn=1,Eb(e,mr(n,e.current)),Je=null;return}}catch(r){if(s!==null)throw Je=s,r;Tn=1,Eb(e,mr(n,e.current)),Je=null;return}t.flags&32768?(It||i===1?e=!0:dg||ht&536870912?e=!1:(Ca=e=!0,(i===2||i===3||i===6)&&(i=Ar.current,i!==null&&i.tag===13&&(i.flags|=16384))),$P(t,e)):R5(t)}function R5(e){var t=e;do{if(t.flags&32768){$P(t,Ca);return}e=t.return;var n=IQ(t.alternate,t,il);if(n!==null){Je=n;return}if(t=t.sibling,t!==null){Je=t;return}Je=t=e}while(t!==null);Tn===0&&(Tn=5)}function $P(e,t){do{var n=SQ(e.alternate,e);if(n!==null){n.flags&=32767,Je=n;return}if(n=e.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&(e=e.sibling,e!==null)){Je=e;return}Je=e=n}while(e!==null);Tn=6,Je=null}function tC(e,t,n,i,s,r,o,a,l,c){var u=Xe.T,d=nn.p;try{nn.p=2,Xe.T=null,DQ(e,t,n,i,d,s,r,o,a,l,c)}finally{Xe.T=u,nn.p=d}}function DQ(e,t,n,i,s,r,o,a){do ih();while(Tu!==null);if(bn&6)throw Error(ne(327));var l=e.finishedWork;if(i=e.finishedLanes,l===null)return null;if(e.finishedWork=null,e.finishedLanes=0,l===e.current)throw Error(ne(177));e.callbackNode=null,e.callbackPriority=0,e.cancelPendingCommit=null;var c=l.lanes|l.childLanes;if(c|=Cw,dq(e,i,c,r,o,a),e===qt&&(Je=qt=null,ht=0),!(l.subtreeFlags&10256)&&!(l.flags&10256)||UU||(UU=!0,L7=c,N7=n,PQ(cb,function(){return ih(),null})),n=(l.flags&15990)!==0,l.subtreeFlags&15990||n?(n=Xe.T,Xe.T=null,r=nn.p,nn.p=2,o=bn,bn|=4,wQ(e,l),xP(l,e),iQ(V7,e.containerInfo),Rb=!!H7,V7=H7=null,e.current=l,_P(e,l.alternate,l),tq(),bn=o,nn.p=r,Xe.T=n):e.current=l,UU?(UU=!1,Tu=e,d0=i):GP(e,c),c=e.pendingLanes,c===0&&(gc=null),oq(l.stateNode),aa(e),t!==null)for(s=e.onRecoverableError,l=0;l<t.length;l++)c=t[l],s(c.value,{componentStack:c.stack});return d0&3&&ih(),c=e.pendingLanes,i&4194218&&c&42?e===O7?f0++:(f0=0,O7=e):f0=0,sp(0),null}function GP(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,ep(t)))}function ih(){if(Tu!==null){var e=Tu,t=L7;L7=0;var n=YN(d0),i=Xe.T,s=nn.p;try{if(nn.p=32>n?32:n,Xe.T=null,Tu===null)var r=!1;else{n=N7,N7=null;var o=Tu,a=d0;if(Tu=null,d0=0,bn&6)throw Error(ne(331));var l=bn;if(bn|=4,RP(o.current),AP(o,o.current,a,n),bn=l,sp(0,!1),Ys&&typeof Ys.onPostCommitFiberRoot=="function")try{Ys.onPostCommitFiberRoot(Km,o)}catch{}r=!0}return r}finally{nn.p=s,Xe.T=i,GP(e,t)}}return!1}function nC(e,t,n){t=mr(n,t),t=_7(e.stateNode,t,2),e=fc(e,t,2),e!==null&&(qm(e,2),aa(e))}function Gt(e,t,n){if(e.tag===3)nC(e,e,n);else for(;t!==null;){if(t.tag===3){nC(t,e,n);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(gc===null||!gc.has(i))){e=mr(n,e),n=lP(2),i=fc(t,n,2),i!==null&&(cP(n,i,t,e),qm(i,2),aa(i));break}}t=t.return}}function i8(e,t,n){var i=e.pingCache;if(i===null){i=e.pingCache=new CQ;var s=new Set;i.set(t,s)}else s=i.get(t),s===void 0&&(s=new Set,i.set(t,s));s.has(n)||(Qw=!0,s.add(n),e=LQ.bind(null,e,t,n),t.then(e,e))}function LQ(e,t,n){var i=e.pingCache;i!==null&&i.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,qt===e&&(ht&n)===n&&(Tn===4||Tn===3&&(ht&62914560)===ht&&300>Ho()-e9?!(bn&2)&&Ch(e,0):Jw|=n,xh===ht&&(xh=0)),aa(e)}function XP(e,t){t===0&&(t=GN()),e=Mc(e,t),e!==null&&(qm(e,t),aa(e))}function NQ(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),XP(e,n)}function OQ(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:i=e.stateNode;break;case 22:i=e.stateNode._retryCache;break;default:throw Error(ne(314))}i!==null&&i.delete(t),XP(e,n)}function PQ(e,t){return Ew(e,t)}var Ib=null,Uf=null,B7=!1,Sb=!1,s8=!1,ju=0;function aa(e){e!==Uf&&e.next===null&&(Uf===null?Ib=Uf=e:Uf=Uf.next=e),Sb=!0,B7||(B7=!0,BQ(FQ))}function sp(e,t){if(!s8&&Sb){s8=!0;do for(var n=!1,i=Ib;i!==null;){if(e!==0){var s=i.pendingLanes;if(s===0)var r=0;else{var o=i.suspendedLanes,a=i.pingedLanes;r=(1<<31-Ws(42|e)+1)-1,r&=s&~(o&~a),r=r&201326677?r&201326677|1:r?r|2:0}r!==0&&(n=!0,iC(i,r))}else r=ht,r=v5(i,i===qt?r:0),!(r&3)||Zm(i,r)||(n=!0,iC(i,r));i=i.next}while(n);s8=!1}}function FQ(){Sb=B7=!1;var e=0;ju!==0&&(YQ()&&(e=ju),ju=0);for(var t=Ho(),n=null,i=Ib;i!==null;){var s=i.next,r=jP(i,t);r===0?(i.next=null,n===null?Ib=s:n.next=s,s===null&&(Uf=n)):(n=i,(e!==0||r&3)&&(Sb=!0)),i=s}sp(e)}function jP(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,s=e.expirationTimes,r=e.pendingLanes&-62914561;0<r;){var o=31-Ws(r),a=1<<o,l=s[o];l===-1?(!(a&n)||a&i)&&(s[o]=uq(a,t)):l<=t&&(e.expiredLanes|=a),r&=~a}if(t=qt,n=ht,n=v5(e,e===t?n:0),i=e.callbackNode,n===0||e===t&&Kt===2||e.cancelPendingCommit!==null)return i!==null&&i!==null&&LE(i),e.callbackNode=null,e.callbackPriority=0;if(!(n&3)||Zm(e,n)){if(t=n&-n,t===e.callbackPriority)return t;switch(i!==null&&LE(i),YN(n)){case 2:case 8:n=HN;break;case 32:n=cb;break;case 268435456:n=VN;break;default:n=cb}return i=YP.bind(null,e),n=Ew(n,i),e.callbackPriority=t,e.callbackNode=n,t}return i!==null&&i!==null&&LE(i),e.callbackPriority=2,e.callbackNode=null,2}function YP(e,t){var n=e.callbackNode;if(ih()&&e.callbackNode!==n)return null;var i=ht;return i=v5(e,e===qt?i:0),i===0?null:(FP(e,i,t),jP(e,Ho()),e.callbackNode!=null&&e.callbackNode===n?YP.bind(null,e):null)}function iC(e,t){if(ih())return null;FP(e,t,!0)}function BQ(e){KQ(function(){bn&6?Ew(zN,e):e()})}function n9(){return ju===0&&(ju=$N()),ju}function sC(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:h2(""+e)}function rC(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}function zQ(e,t,n,i,s){if(t==="submit"&&n&&n.stateNode===s){var r=sC((s[xs]||null).action),o=i.submitter;o&&(t=(t=o[xs]||null)?sC(t.formAction):o.getAttribute("formAction"),t!==null&&(r=t,o=null));var a=new w5("action","action",null,i,s);e.push({event:a,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(ju!==0){var l=o?rC(s,o):new FormData(s);v7(n,{pending:!0,data:l,method:s.method,action:r},null,l)}}else typeof r=="function"&&(a.preventDefault(),l=o?rC(s,o):new FormData(s),v7(n,{pending:!0,data:l,method:s.method,action:r},r,l))},currentTarget:s}]})}}for(var r8=0;r8<Sx.length;r8++){var o8=Sx[r8],HQ=o8.toLowerCase(),VQ=o8[0].toUpperCase()+o8.slice(1);ho(HQ,"on"+VQ)}ho(gO,"onAnimationEnd");ho(mO,"onAnimationIteration");ho(pO,"onAnimationStart");ho("dblclick","onDoubleClick");ho("focusin","onFocus");ho("focusout","onBlur");ho(rQ,"onTransitionRun");ho(oQ,"onTransitionStart");ho(aQ,"onTransitionCancel");ho(UO,"onTransitionEnd");wh("onMouseEnter",["mouseout","mouseover"]);wh("onMouseLeave",["mouseout","mouseover"]);wh("onPointerEnter",["pointerout","pointerover"]);wh("onPointerLeave",["pointerout","pointerover"]);Ad("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ad("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ad("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ad("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ad("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ad("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var K0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$Q=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(K0));function WP(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var i=e[n],s=i.event;i=i.listeners;e:{var r=void 0;if(t)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==r&&s.isPropagationStopped())break e;r=a,s.currentTarget=c;try{r(s)}catch(u){yb(u)}s.currentTarget=null,r=l}else for(o=0;o<i.length;o++){if(a=i[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==r&&s.isPropagationStopped())break e;r=a,s.currentTarget=c;try{r(s)}catch(u){yb(u)}s.currentTarget=null,r=l}}}}function rt(e,t){var n=t[l7];n===void 0&&(n=t[l7]=new Set);var i=e+"__bubble";n.has(i)||(KP(t,e,2,!1),n.add(i))}function a8(e,t,n){var i=0;t&&(i|=4),KP(n,e,i,t)}var bU="_reactListening"+Math.random().toString(36).slice(2);function i9(e){if(!e[bU]){e[bU]=!0,KN.forEach(function(n){n!=="selectionchange"&&($Q.has(n)||a8(n,!1,e),a8(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[bU]||(t[bU]=!0,a8("selectionchange",!1,t))}}function KP(e,t,n,i){switch(aF(t)){case 2:var s=mJ;break;case 8:s=pJ;break;default:s=a9}n=s.bind(null,t,n,e),s=void 0,!f7||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),i?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function l8(e,t,n,i,s){var r=i;if(!(t&1)&&!(t&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=i.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=Mu(a),o===null)return;if(l=o.tag,l===5||l===6||l===26||l===27){i=r=o;continue e}a=a.parentNode}}i=i.return}iO(function(){var c=r,u=_w(n),d=[];e:{var f=bO.get(e);if(f!==void 0){var h=w5,m=e;switch(e){case"keypress":if(m2(n)===0)break e;case"keydown":case"keyup":h=Oq;break;case"focusin":m="focus",h=BE;break;case"focusout":m="blur",h=BE;break;case"beforeblur":case"afterblur":h=BE;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=gx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=Tq;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=Bq;break;case gO:case mO:case pO:h=xq;break;case UO:h=Hq;break;case"scroll":case"scrollend":h=wq;break;case"wheel":h=$q;break;case"copy":case"cut":case"paste":h=Aq;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=px;break;case"toggle":case"beforetoggle":h=Xq}var p=(t&4)!==0,U=!p&&(e==="scroll"||e==="scrollend"),b=p?f!==null?f+"Capture":null:f;p=[];for(var y=c,w;y!==null;){var v=y;if(w=v.stateNode,v=v.tag,v!==5&&v!==26&&v!==27||w===null||b===null||(v=$0(y,b),v!=null&&p.push(Z0(y,v,w))),U)break;y=y.return}0<p.length&&(f=new h(f,m,null,n,u),d.push({event:f,listeners:p}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",f&&n!==d7&&(m=n.relatedTarget||n.fromElement)&&(Mu(m)||m[cg]))break e;if((h||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,h?(m=n.relatedTarget||n.toElement,h=c,m=m?Mu(m):null,m!==null&&(U=lg(m),p=m.tag,m!==U||p!==5&&p!==27&&p!==6)&&(m=null)):(h=null,m=c),h!==m)){if(p=gx,v="onMouseLeave",b="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(p=px,v="onPointerLeave",b="onPointerEnter",y="pointer"),U=h==null?f:A1(h),w=m==null?f:A1(m),f=new p(v,y+"leave",h,n,u),f.target=U,f.relatedTarget=w,v=null,Mu(u)===c&&(p=new p(b,y+"enter",m,n,u),p.target=w,p.relatedTarget=U,v=p),U=v,h&&m)t:{for(p=h,b=m,y=0,w=p;w;w=tf(w))y++;for(w=0,v=b;v;v=tf(v))w++;for(;0<y-w;)p=tf(p),y--;for(;0<w-y;)b=tf(b),w--;for(;y--;){if(p===b||b!==null&&p===b.alternate)break t;p=tf(p),b=tf(b)}p=null}else p=null;h!==null&&oC(d,f,h,p,!1),m!==null&&U!==null&&oC(d,U,m,p,!0)}}e:{if(f=c?A1(c):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var I=Ex;else if(yx(f))if(cO)I=tQ;else{I=Jq;var C=Qq}else h=f.nodeName,!h||h.toLowerCase()!=="input"||f.type!=="checkbox"&&f.type!=="radio"?c&&ww(c.elementType)&&(I=Ex):I=eQ;if(I&&(I=I(e,c))){lO(d,I,n,u);break e}C&&C(e,f,c),e==="focusout"&&c&&f.type==="number"&&c.memoizedProps.value!=null&&u7(f,"number",f.value)}switch(C=c?A1(c):window,e){case"focusin":(yx(C)||C.contentEditable==="true")&&(kf=C,h7=c,e0=null);break;case"focusout":e0=h7=kf=null;break;case"mousedown":g7=!0;break;case"contextmenu":case"mouseup":case"dragend":g7=!1,Ix(d,n,u);break;case"selectionchange":if(sQ)break;case"keydown":case"keyup":Ix(d,n,u)}var _;if(Sw)e:{switch(e){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Mf?oO(e,n)&&(T="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(T="onCompositionStart");T&&(rO&&n.locale!=="ko"&&(Mf||T!=="onCompositionStart"?T==="onCompositionEnd"&&Mf&&(_=sO()):(ic=u,Tw="value"in ic?ic.value:ic.textContent,Mf=!0)),C=xb(c,T),0<C.length&&(T=new mx(T,e,null,n,u),d.push({event:T,listeners:C}),_?T.data=_:(_=aO(n),_!==null&&(T.data=_)))),(_=Yq?Wq(e,n):Kq(e,n))&&(T=xb(c,"onBeforeInput"),0<T.length&&(C=new mx("onBeforeInput","beforeinput",null,n,u),d.push({event:C,listeners:T}),C.data=_)),zQ(d,e,c,n,u)}WP(d,t)})}function Z0(e,t,n){return{instance:e,listener:t,currentTarget:n}}function xb(e,t){for(var n=t+"Capture",i=[];e!==null;){var s=e,r=s.stateNode;s=s.tag,s!==5&&s!==26&&s!==27||r===null||(s=$0(e,n),s!=null&&i.unshift(Z0(e,s,r)),s=$0(e,t),s!=null&&i.push(Z0(e,s,r))),e=e.return}return i}function tf(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function oC(e,t,n,i,s){for(var r=t._reactName,o=[];n!==null&&n!==i;){var a=n,l=a.alternate,c=a.stateNode;if(a=a.tag,l!==null&&l===i)break;a!==5&&a!==26&&a!==27||c===null||(l=c,s?(c=$0(n,r),c!=null&&o.unshift(Z0(n,c,l))):s||(c=$0(n,r),c!=null&&o.push(Z0(n,c,l)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var GQ=/\r\n?/g,XQ=/\u0000|\uFFFD/g;function aC(e){return(typeof e=="string"?e:""+e).replace(GQ,`
`).replace(XQ,"")}function ZP(e,t){return t=aC(t),aC(e)===t}function D5(){}function Ot(e,t,n,i,s,r){switch(n){case"children":typeof i=="string"?t==="body"||t==="textarea"&&i===""||_h(e,i):(typeof i=="number"||typeof i=="bigint")&&t!=="body"&&_h(e,""+i);break;case"className":uU(e,"class",i);break;case"tabIndex":uU(e,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":uU(e,n,i);break;case"style":nO(e,i,r);break;case"data":if(t!=="object"){uU(e,"data",i);break}case"src":case"href":if(i===""&&(t!=="a"||n!=="href")){e.removeAttribute(n);break}if(i==null||typeof i=="function"||typeof i=="symbol"||typeof i=="boolean"){e.removeAttribute(n);break}i=h2(""+i),e.setAttribute(n,i);break;case"action":case"formAction":if(typeof i=="function"){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof r=="function"&&(n==="formAction"?(t!=="input"&&Ot(e,t,"name",s.name,s,null),Ot(e,t,"formEncType",s.formEncType,s,null),Ot(e,t,"formMethod",s.formMethod,s,null),Ot(e,t,"formTarget",s.formTarget,s,null)):(Ot(e,t,"encType",s.encType,s,null),Ot(e,t,"method",s.method,s,null),Ot(e,t,"target",s.target,s,null)));if(i==null||typeof i=="symbol"||typeof i=="boolean"){e.removeAttribute(n);break}i=h2(""+i),e.setAttribute(n,i);break;case"onClick":i!=null&&(e.onclick=D5);break;case"onScroll":i!=null&&rt("scroll",e);break;case"onScrollEnd":i!=null&&rt("scrollend",e);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(ne(61));if(n=i.__html,n!=null){if(s.children!=null)throw Error(ne(60));e.innerHTML=n}}break;case"multiple":e.multiple=i&&typeof i!="function"&&typeof i!="symbol";break;case"muted":e.muted=i&&typeof i!="function"&&typeof i!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(i==null||typeof i=="function"||typeof i=="boolean"||typeof i=="symbol"){e.removeAttribute("xlink:href");break}n=h2(""+i),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":i!=null&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(n,""+i):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":i===!0?e.setAttribute(n,""):i!==!1&&i!=null&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(n,i):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":i!=null&&typeof i!="function"&&typeof i!="symbol"&&!isNaN(i)&&1<=i?e.setAttribute(n,i):e.removeAttribute(n);break;case"rowSpan":case"start":i==null||typeof i=="function"||typeof i=="symbol"||isNaN(i)?e.removeAttribute(n):e.setAttribute(n,i);break;case"popover":rt("beforetoggle",e),rt("toggle",e),f2(e,"popover",i);break;case"xlinkActuate":fa(e,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":fa(e,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":fa(e,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":fa(e,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":fa(e,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":fa(e,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":fa(e,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":fa(e,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":fa(e,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":f2(e,"is",i);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=Eq.get(n)||n,f2(e,n,i))}}function z7(e,t,n,i,s,r){switch(n){case"style":nO(e,i,r);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(ne(61));if(n=i.__html,n!=null){if(s.children!=null)throw Error(ne(60));e.innerHTML=n}}break;case"children":typeof i=="string"?_h(e,i):(typeof i=="number"||typeof i=="bigint")&&_h(e,""+i);break;case"onScroll":i!=null&&rt("scroll",e);break;case"onScrollEnd":i!=null&&rt("scrollend",e);break;case"onClick":i!=null&&(e.onclick=D5);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ZN.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(s=n.endsWith("Capture"),t=n.slice(2,s?n.length-7:void 0),r=e[xs]||null,r=r!=null?r[n]:null,typeof r=="function"&&e.removeEventListener(t,r,s),typeof i=="function")){typeof r!="function"&&r!==null&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,i,s);break e}n in e?e[n]=i:i===!0?e.setAttribute(n,""):f2(e,n,i)}}}function Mi(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":rt("error",e),rt("load",e);var i=!1,s=!1,r;for(r in n)if(n.hasOwnProperty(r)){var o=n[r];if(o!=null)switch(r){case"src":i=!0;break;case"srcSet":s=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(ne(137,t));default:Ot(e,t,r,o,n,null)}}s&&Ot(e,t,"srcSet",n.srcSet,n,null),i&&Ot(e,t,"src",n.src,n,null);return;case"input":rt("invalid",e);var a=r=o=s=null,l=null,c=null;for(i in n)if(n.hasOwnProperty(i)){var u=n[i];if(u!=null)switch(i){case"name":s=u;break;case"type":o=u;break;case"checked":l=u;break;case"defaultChecked":c=u;break;case"value":r=u;break;case"defaultValue":a=u;break;case"children":case"dangerouslySetInnerHTML":if(u!=null)throw Error(ne(137,t));break;default:Ot(e,t,i,u,n,null)}}JN(e,r,a,l,c,o,s,!1),ub(e);return;case"select":rt("invalid",e),i=o=r=null;for(s in n)if(n.hasOwnProperty(s)&&(a=n[s],a!=null))switch(s){case"value":r=a;break;case"defaultValue":o=a;break;case"multiple":i=a;default:Ot(e,t,s,a,n,null)}t=r,n=o,e.multiple=!!i,t!=null?qf(e,!!i,t,!1):n!=null&&qf(e,!!i,n,!0);return;case"textarea":rt("invalid",e),r=s=i=null;for(o in n)if(n.hasOwnProperty(o)&&(a=n[o],a!=null))switch(o){case"value":i=a;break;case"defaultValue":s=a;break;case"children":r=a;break;case"dangerouslySetInnerHTML":if(a!=null)throw Error(ne(91));break;default:Ot(e,t,o,a,n,null)}tO(e,i,s,r),ub(e);return;case"option":for(l in n)if(n.hasOwnProperty(l)&&(i=n[l],i!=null))switch(l){case"selected":e.selected=i&&typeof i!="function"&&typeof i!="symbol";break;default:Ot(e,t,l,i,n,null)}return;case"dialog":rt("cancel",e),rt("close",e);break;case"iframe":case"object":rt("load",e);break;case"video":case"audio":for(i=0;i<K0.length;i++)rt(K0[i],e);break;case"image":rt("error",e),rt("load",e);break;case"details":rt("toggle",e);break;case"embed":case"source":case"link":rt("error",e),rt("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(c in n)if(n.hasOwnProperty(c)&&(i=n[c],i!=null))switch(c){case"children":case"dangerouslySetInnerHTML":throw Error(ne(137,t));default:Ot(e,t,c,i,n,null)}return;default:if(ww(t)){for(u in n)n.hasOwnProperty(u)&&(i=n[u],i!==void 0&&z7(e,t,u,i,n,void 0));return}}for(a in n)n.hasOwnProperty(a)&&(i=n[a],i!=null&&Ot(e,t,a,i,n,null))}function jQ(e,t,n,i){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var s=null,r=null,o=null,a=null,l=null,c=null,u=null;for(h in n){var d=n[h];if(n.hasOwnProperty(h)&&d!=null)switch(h){case"checked":break;case"value":break;case"defaultValue":l=d;default:i.hasOwnProperty(h)||Ot(e,t,h,null,i,d)}}for(var f in i){var h=i[f];if(d=n[f],i.hasOwnProperty(f)&&(h!=null||d!=null))switch(f){case"type":r=h;break;case"name":s=h;break;case"checked":c=h;break;case"defaultChecked":u=h;break;case"value":o=h;break;case"defaultValue":a=h;break;case"children":case"dangerouslySetInnerHTML":if(h!=null)throw Error(ne(137,t));break;default:h!==d&&Ot(e,t,f,h,i,d)}}c7(e,o,a,l,c,u,r,s);return;case"select":h=o=a=f=null;for(r in n)if(l=n[r],n.hasOwnProperty(r)&&l!=null)switch(r){case"value":break;case"multiple":h=l;default:i.hasOwnProperty(r)||Ot(e,t,r,null,i,l)}for(s in i)if(r=i[s],l=n[s],i.hasOwnProperty(s)&&(r!=null||l!=null))switch(s){case"value":f=r;break;case"defaultValue":a=r;break;case"multiple":o=r;default:r!==l&&Ot(e,t,s,r,i,l)}t=a,n=o,i=h,f!=null?qf(e,!!n,f,!1):!!i!=!!n&&(t!=null?qf(e,!!n,t,!0):qf(e,!!n,n?[]:"",!1));return;case"textarea":h=f=null;for(a in n)if(s=n[a],n.hasOwnProperty(a)&&s!=null&&!i.hasOwnProperty(a))switch(a){case"value":break;case"children":break;default:Ot(e,t,a,null,i,s)}for(o in i)if(s=i[o],r=n[o],i.hasOwnProperty(o)&&(s!=null||r!=null))switch(o){case"value":f=s;break;case"defaultValue":h=s;break;case"children":break;case"dangerouslySetInnerHTML":if(s!=null)throw Error(ne(91));break;default:s!==r&&Ot(e,t,o,s,i,r)}eO(e,f,h);return;case"option":for(var m in n)if(f=n[m],n.hasOwnProperty(m)&&f!=null&&!i.hasOwnProperty(m))switch(m){case"selected":e.selected=!1;break;default:Ot(e,t,m,null,i,f)}for(l in i)if(f=i[l],h=n[l],i.hasOwnProperty(l)&&f!==h&&(f!=null||h!=null))switch(l){case"selected":e.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:Ot(e,t,l,f,i,h)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var p in n)f=n[p],n.hasOwnProperty(p)&&f!=null&&!i.hasOwnProperty(p)&&Ot(e,t,p,null,i,f);for(c in i)if(f=i[c],h=n[c],i.hasOwnProperty(c)&&f!==h&&(f!=null||h!=null))switch(c){case"children":case"dangerouslySetInnerHTML":if(f!=null)throw Error(ne(137,t));break;default:Ot(e,t,c,f,i,h)}return;default:if(ww(t)){for(var U in n)f=n[U],n.hasOwnProperty(U)&&f!==void 0&&!i.hasOwnProperty(U)&&z7(e,t,U,void 0,i,f);for(u in i)f=i[u],h=n[u],!i.hasOwnProperty(u)||f===h||f===void 0&&h===void 0||z7(e,t,u,f,i,h);return}}for(var b in n)f=n[b],n.hasOwnProperty(b)&&f!=null&&!i.hasOwnProperty(b)&&Ot(e,t,b,null,i,f);for(d in i)f=i[d],h=n[d],!i.hasOwnProperty(d)||f===h||f==null&&h==null||Ot(e,t,d,f,i,h)}var H7=null,V7=null;function Cb(e){return e.nodeType===9?e:e.ownerDocument}function lC(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function qP(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function $7(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var c8=null;function YQ(){var e=window.event;return e&&e.type==="popstate"?e===c8?!1:(c8=e,!0):(c8=null,!1)}var QP=typeof setTimeout=="function"?setTimeout:void 0,WQ=typeof clearTimeout=="function"?clearTimeout:void 0,cC=typeof Promise=="function"?Promise:void 0,KQ=typeof queueMicrotask=="function"?queueMicrotask:typeof cC<"u"?function(e){return cC.resolve(null).then(e).catch(ZQ)}:QP;function ZQ(e){setTimeout(function(){throw e})}function u8(e,t){var n=t,i=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(i===0){e.removeChild(s),tm(t);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=s}while(n);tm(t)}function G7(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":G7(n),vw(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}e.removeChild(n)}}function qQ(e,t,n,i){for(;e.nodeType===1;){var s=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!i&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(i){if(!e[V0])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(r=e.getAttribute("rel"),r==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(r!==s.rel||e.getAttribute("href")!==(s.href==null?null:s.href)||e.getAttribute("crossorigin")!==(s.crossOrigin==null?null:s.crossOrigin)||e.getAttribute("title")!==(s.title==null?null:s.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(r=e.getAttribute("src"),(r!==(s.src==null?null:s.src)||e.getAttribute("type")!==(s.type==null?null:s.type)||e.getAttribute("crossorigin")!==(s.crossOrigin==null?null:s.crossOrigin))&&r&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var r=s.name==null?null:""+s.name;if(s.type==="hidden"&&e.getAttribute("name")===r)return e}else return e;if(e=Qr(e.nextSibling),e===null)break}return null}function QQ(e,t,n){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=Qr(e.nextSibling),e===null))return null;return e}function Qr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="F!"||t==="F")break;if(t==="/$")return null}}return e}function uC(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}function JP(e,t,n){switch(t=Cb(n),e){case"html":if(e=t.documentElement,!e)throw Error(ne(452));return e;case"head":if(e=t.head,!e)throw Error(ne(453));return e;case"body":if(e=t.body,!e)throw Error(ne(454));return e;default:throw Error(ne(451))}}var Mr=new Map,dC=new Set;function Ab(e){return typeof e.getRootNode=="function"?e.getRootNode():e.ownerDocument}var yl=nn.d;nn.d={f:JQ,r:eJ,D:tJ,C:nJ,L:iJ,m:sJ,X:oJ,S:rJ,M:aJ};function JQ(){var e=yl.f(),t=k5();return e||t}function eJ(e){var t=ug(e);t!==null&&t.tag===5&&t.type==="form"?JO(t):yl.r(e)}var fg=typeof document>"u"?null:document;function eF(e,t,n){var i=fg;if(i&&typeof t=="string"&&t){var s=gr(t);s='link[rel="'+e+'"][href="'+s+'"]',typeof n=="string"&&(s+='[crossorigin="'+n+'"]'),dC.has(s)||(dC.add(s),e={rel:e,crossOrigin:n,href:t},i.querySelector(s)===null&&(t=i.createElement("link"),Mi(t,"link",e),gi(t),i.head.appendChild(t)))}}function tJ(e){yl.D(e),eF("dns-prefetch",e,null)}function nJ(e,t){yl.C(e,t),eF("preconnect",e,t)}function iJ(e,t,n){yl.L(e,t,n);var i=fg;if(i&&e&&t){var s='link[rel="preload"][as="'+gr(t)+'"]';t==="image"&&n&&n.imageSrcSet?(s+='[imagesrcset="'+gr(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(s+='[imagesizes="'+gr(n.imageSizes)+'"]')):s+='[href="'+gr(e)+'"]';var r=s;switch(t){case"style":r=Ah(e);break;case"script":r=hg(e)}Mr.has(r)||(e=sn({rel:"preload",href:t==="image"&&n&&n.imageSrcSet?void 0:e,as:t},n),Mr.set(r,e),i.querySelector(s)!==null||t==="style"&&i.querySelector(rp(r))||t==="script"&&i.querySelector(op(r))||(t=i.createElement("link"),Mi(t,"link",e),gi(t),i.head.appendChild(t)))}}function sJ(e,t){yl.m(e,t);var n=fg;if(n&&e){var i=t&&typeof t.as=="string"?t.as:"script",s='link[rel="modulepreload"][as="'+gr(i)+'"][href="'+gr(e)+'"]',r=s;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":r=hg(e)}if(!Mr.has(r)&&(e=sn({rel:"modulepreload",href:e},t),Mr.set(r,e),n.querySelector(s)===null)){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(op(r)))return}i=n.createElement("link"),Mi(i,"link",e),gi(i),n.head.appendChild(i)}}}function rJ(e,t,n){yl.S(e,t,n);var i=fg;if(i&&e){var s=Zf(i).hoistableStyles,r=Ah(e);t=t||"default";var o=s.get(r);if(!o){var a={loading:0,preload:null};if(o=i.querySelector(rp(r)))a.loading=5;else{e=sn({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Mr.get(r))&&s9(e,n);var l=o=i.createElement("link");gi(l),Mi(l,"link",e),l._p=new Promise(function(c,u){l.onload=c,l.onerror=u}),l.addEventListener("load",function(){a.loading|=1}),l.addEventListener("error",function(){a.loading|=2}),a.loading|=4,v2(o,t,i)}o={type:"stylesheet",instance:o,count:1,state:a},s.set(r,o)}}}function oJ(e,t){yl.X(e,t);var n=fg;if(n&&e){var i=Zf(n).hoistableScripts,s=hg(e),r=i.get(s);r||(r=n.querySelector(op(s)),r||(e=sn({src:e,async:!0},t),(t=Mr.get(s))&&r9(e,t),r=n.createElement("script"),gi(r),Mi(r,"link",e),n.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},i.set(s,r))}}function aJ(e,t){yl.M(e,t);var n=fg;if(n&&e){var i=Zf(n).hoistableScripts,s=hg(e),r=i.get(s);r||(r=n.querySelector(op(s)),r||(e=sn({src:e,async:!0,type:"module"},t),(t=Mr.get(s))&&r9(e,t),r=n.createElement("script"),gi(r),Mi(r,"link",e),n.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},i.set(s,r))}}function fC(e,t,n,i){var s=(s=uc.current)?Ab(s):null;if(!s)throw Error(ne(446));switch(e){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(t=Ah(n.href),n=Zf(s).hoistableStyles,i=n.get(t),i||(i={type:"style",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){e=Ah(n.href);var r=Zf(s).hoistableStyles,o=r.get(e);if(o||(s=s.ownerDocument||s,o={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},r.set(e,o),(r=s.querySelector(rp(e)))&&!r._p&&(o.instance=r,o.state.loading=5),Mr.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Mr.set(e,n),r||lJ(s,e,n,o.state))),t&&i===null)throw Error(ne(528,""));return o}if(t&&i!==null)throw Error(ne(529,""));return null;case"script":return t=n.async,n=n.src,typeof n=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=hg(n),n=Zf(s).hoistableScripts,i=n.get(t),i||(i={type:"script",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(ne(444,e))}}function Ah(e){return'href="'+gr(e)+'"'}function rp(e){return'link[rel="stylesheet"]['+e+"]"}function tF(e){return sn({},e,{"data-precedence":e.precedence,precedence:null})}function lJ(e,t,n,i){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?i.loading=1:(t=e.createElement("link"),i.preload=t,t.addEventListener("load",function(){return i.loading|=1}),t.addEventListener("error",function(){return i.loading|=2}),Mi(t,"link",n),gi(t),e.head.appendChild(t))}function hg(e){return'[src="'+gr(e)+'"]'}function op(e){return"script[async]"+e}function hC(e,t,n){if(t.count++,t.instance===null)switch(t.type){case"style":var i=e.querySelector('style[data-href~="'+gr(n.href)+'"]');if(i)return t.instance=i,gi(i),i;var s=sn({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return i=(e.ownerDocument||e).createElement("style"),gi(i),Mi(i,"style",s),v2(i,n.precedence,e),t.instance=i;case"stylesheet":s=Ah(n.href);var r=e.querySelector(rp(s));if(r)return t.state.loading|=4,t.instance=r,gi(r),r;i=tF(n),(s=Mr.get(s))&&s9(i,s),r=(e.ownerDocument||e).createElement("link"),gi(r);var o=r;return o._p=new Promise(function(a,l){o.onload=a,o.onerror=l}),Mi(r,"link",i),t.state.loading|=4,v2(r,n.precedence,e),t.instance=r;case"script":return r=hg(n.src),(s=e.querySelector(op(r)))?(t.instance=s,gi(s),s):(i=n,(s=Mr.get(r))&&(i=sn({},n),r9(i,s)),e=e.ownerDocument||e,s=e.createElement("script"),gi(s),Mi(s,"link",i),e.head.appendChild(s),t.instance=s);case"void":return null;default:throw Error(ne(443,t.type))}else t.type==="stylesheet"&&!(t.state.loading&4)&&(i=t.instance,t.state.loading|=4,v2(i,n.precedence,e));return t.instance}function v2(e,t,n){for(var i=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),s=i.length?i[i.length-1]:null,r=s,o=0;o<i.length;o++){var a=i[o];if(a.dataset.precedence===t)r=a;else if(r!==s)break}r?r.parentNode.insertBefore(e,r.nextSibling):(t=n.nodeType===9?n.head:n,t.insertBefore(e,t.firstChild))}function s9(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function r9(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var w2=null;function gC(e,t,n){if(w2===null){var i=new Map,s=w2=new Map;s.set(n,i)}else s=w2,i=s.get(n),i||(i=new Map,s.set(n,i));if(i.has(e))return i;for(i.set(e,null),n=n.getElementsByTagName(e),s=0;s<n.length;s++){var r=n[s];if(!(r[V0]||r[ji]||e==="link"&&r.getAttribute("rel")==="stylesheet")&&r.namespaceURI!=="http://www.w3.org/2000/svg"){var o=r.getAttribute(t)||"";o=e+o;var a=i.get(o);a?a.push(r):i.set(o,[r])}}return i}function mC(e,t,n){e=e.ownerDocument||e,e.head.insertBefore(n,t==="title"?e.querySelector("head > title"):null)}function cJ(e,t,n){if(n===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function nF(e){return!(e.type==="stylesheet"&&!(e.state.loading&3))}var q0=null;function uJ(){}function dJ(e,t,n){if(q0===null)throw Error(ne(475));var i=q0;if(t.type==="stylesheet"&&(typeof n.media!="string"||matchMedia(n.media).matches!==!1)&&!(t.state.loading&4)){if(t.instance===null){var s=Ah(n.href),r=e.querySelector(rp(s));if(r){e=r._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(i.count++,i=Mb.bind(i),e.then(i,i)),t.state.loading|=4,t.instance=r,gi(r);return}r=e.ownerDocument||e,n=tF(n),(s=Mr.get(s))&&s9(n,s),r=r.createElement("link"),gi(r);var o=r;o._p=new Promise(function(a,l){o.onload=a,o.onerror=l}),Mi(r,"link",n),t.instance=r}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(t,e),(e=t.state.preload)&&!(t.state.loading&3)&&(i.count++,t=Mb.bind(i),e.addEventListener("load",t),e.addEventListener("error",t))}}function fJ(){if(q0===null)throw Error(ne(475));var e=q0;return e.stylesheets&&e.count===0&&X7(e,e.stylesheets),0<e.count?function(t){var n=setTimeout(function(){if(e.stylesheets&&X7(e,e.stylesheets),e.unsuspend){var i=e.unsuspend;e.unsuspend=null,i()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}function Mb(){if(this.count--,this.count===0){if(this.stylesheets)X7(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var kb=null;function X7(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,kb=new Map,t.forEach(hJ,e),kb=null,Mb.call(e))}function hJ(e,t){if(!(t.state.loading&4)){var n=kb.get(e);if(n)var i=n.get(null);else{n=new Map,kb.set(e,n);for(var s=e.querySelectorAll("link[data-precedence],style[data-precedence]"),r=0;r<s.length;r++){var o=s[r];(o.nodeName==="LINK"||o.getAttribute("media")!=="not all")&&(n.set(o.dataset.precedence,o),i=o)}i&&n.set(null,i)}s=t.instance,o=s.getAttribute("data-precedence"),r=n.get(o)||i,r===i&&n.set(null,s),n.set(o,s),this.count++,i=Mb.bind(this),s.addEventListener("load",i),s.addEventListener("error",i),r?r.parentNode.insertBefore(s,r.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(s,e.firstChild)),t.state.loading|=4}}var Q0={$$typeof:Na,Provider:null,Consumer:null,_currentValue:Hu,_currentValue2:Hu,_threadCount:0};function gJ(e,t,n,i,s,r,o,a){this.tag=1,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=NE(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=NE(0),this.hiddenUpdates=NE(null),this.identifierPrefix=i,this.onUncaughtError=s,this.onCaughtError=r,this.onRecoverableError=o,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=a,this.incompleteTransitions=new Map}function iF(e,t,n,i,s,r,o,a,l,c,u,d){return e=new gJ(e,t,n,o,a,l,c,d),t=1,r===!0&&(t|=24),r=yr(3,null,null,t),e.current=r,r.stateNode=e,t=Dw(),t.refCount++,e.pooledCache=t,t.refCount++,r.memoizedState={element:i,isDehydrated:n,cache:t},Ww(r),e}function sF(e){return e?(e=Lf,e):Lf}function rF(e,t,n,i,s,r){s=sF(s),i.context===null?i.context=s:i.pendingContext=s,i=dc(t),i.payload={element:n},r=r===void 0?null:r,r!==null&&(i.callback=r),n=fc(e,i,t),n!==null&&(ds(n,e,t),o0(n,e,t))}function pC(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function o9(e,t){pC(e,t),(e=e.alternate)&&pC(e,t)}function oF(e){if(e.tag===13){var t=Mc(e,67108864);t!==null&&ds(t,e,67108864),o9(e,67108864)}}var Rb=!0;function mJ(e,t,n,i){var s=Xe.T;Xe.T=null;var r=nn.p;try{nn.p=2,a9(e,t,n,i)}finally{nn.p=r,Xe.T=s}}function pJ(e,t,n,i){var s=Xe.T;Xe.T=null;var r=nn.p;try{nn.p=8,a9(e,t,n,i)}finally{nn.p=r,Xe.T=s}}function a9(e,t,n,i){if(Rb){var s=j7(i);if(s===null)l8(e,t,i,Db,n),UC(e,i);else if(bJ(s,e,t,n,i))i.stopPropagation();else if(UC(e,i),t&4&&-1<UJ.indexOf(e)){for(;s!==null;){var r=ug(s);if(r!==null)switch(r.tag){case 3:if(r=r.stateNode,r.current.memoizedState.isDehydrated){var o=bu(r.pendingLanes);if(o!==0){var a=r;for(a.pendingLanes|=2,a.entangledLanes|=2;o;){var l=1<<31-Ws(o);a.entanglements[1]|=l,o&=~l}aa(r),!(bn&6)&&(_b=Ho()+500,sp(0))}}break;case 13:a=Mc(r,2),a!==null&&ds(a,r,2),k5(),o9(r,2)}if(r=j7(i),r===null&&l8(e,t,i,Db,n),r===s)break;s=r}s!==null&&i.stopPropagation()}else l8(e,t,i,null,n)}}function j7(e){return e=_w(e),l9(e)}var Db=null;function l9(e){if(Db=null,e=Mu(e),e!==null){var t=lg(e);if(t===null)e=null;else{var n=t.tag;if(n===13){if(e=FN(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Db=e,null}function aF(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(nq()){case zN:return 2;case HN:return 8;case cb:case iq:return 32;case VN:return 268435456;default:return 32}default:return 32}}var Y7=!1,mc=null,pc=null,Uc=null,J0=new Map,em=new Map,Ql=[],UJ="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function UC(e,t){switch(e){case"focusin":case"focusout":mc=null;break;case"dragenter":case"dragleave":pc=null;break;case"mouseover":case"mouseout":Uc=null;break;case"pointerover":case"pointerout":J0.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":em.delete(t.pointerId)}}function n1(e,t,n,i,s,r){return e===null||e.nativeEvent!==r?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:r,targetContainers:[s]},t!==null&&(t=ug(t),t!==null&&oF(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function bJ(e,t,n,i,s){switch(t){case"focusin":return mc=n1(mc,e,t,n,i,s),!0;case"dragenter":return pc=n1(pc,e,t,n,i,s),!0;case"mouseover":return Uc=n1(Uc,e,t,n,i,s),!0;case"pointerover":var r=s.pointerId;return J0.set(r,n1(J0.get(r)||null,e,t,n,i,s)),!0;case"gotpointercapture":return r=s.pointerId,em.set(r,n1(em.get(r)||null,e,t,n,i,s)),!0}return!1}function lF(e){var t=Mu(e.target);if(t!==null){var n=lg(t);if(n!==null){if(t=n.tag,t===13){if(t=FN(n),t!==null){e.blockedOn=t,fq(e.priority,function(){if(n.tag===13){var i=Ks(),s=Mc(n,i);s!==null&&ds(s,n,i),o9(n,i)}});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function _2(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=j7(e.nativeEvent);if(n===null){n=e.nativeEvent;var i=new n.constructor(n.type,n);d7=i,n.target.dispatchEvent(i),d7=null}else return t=ug(n),t!==null&&oF(t),e.blockedOn=n,!1;t.shift()}return!0}function bC(e,t,n){_2(e)&&n.delete(t)}function yJ(){Y7=!1,mc!==null&&_2(mc)&&(mc=null),pc!==null&&_2(pc)&&(pc=null),Uc!==null&&_2(Uc)&&(Uc=null),J0.forEach(bC),em.forEach(bC)}function yU(e,t){e.blockedOn===t&&(e.blockedOn=null,Y7||(Y7=!0,ii.unstable_scheduleCallback(ii.unstable_NormalPriority,yJ)))}var EU=null;function yC(e){EU!==e&&(EU=e,ii.unstable_scheduleCallback(ii.unstable_NormalPriority,function(){EU===e&&(EU=null);for(var t=0;t<e.length;t+=3){var n=e[t],i=e[t+1],s=e[t+2];if(typeof i!="function"){if(l9(i||n)===null)continue;break}var r=ug(n);r!==null&&(e.splice(t,3),t-=3,v7(r,{pending:!0,data:s,method:n.method,action:i},i,s))}}))}function tm(e){function t(l){return yU(l,e)}mc!==null&&yU(mc,e),pc!==null&&yU(pc,e),Uc!==null&&yU(Uc,e),J0.forEach(t),em.forEach(t);for(var n=0;n<Ql.length;n++){var i=Ql[n];i.blockedOn===e&&(i.blockedOn=null)}for(;0<Ql.length&&(n=Ql[0],n.blockedOn===null);)lF(n),n.blockedOn===null&&Ql.shift();if(n=(e.ownerDocument||e).$$reactFormReplay,n!=null)for(i=0;i<n.length;i+=3){var s=n[i],r=n[i+1],o=s[xs]||null;if(typeof r=="function")o||yC(n);else if(o){var a=null;if(r&&r.hasAttribute("formAction")){if(s=r,o=r[xs]||null)a=o.formAction;else if(l9(s)!==null)continue}else a=o.action;typeof a=="function"?n[i+1]=a:(n.splice(i,3),i-=3),yC(n)}}}function c9(e){this._internalRoot=e}L5.prototype.render=c9.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ne(409));var n=t.current,i=Ks();rF(n,i,e,t,null,null)};L5.prototype.unmount=c9.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;e.tag===0&&ih(),rF(e.current,2,null,e,null,null),k5(),t[cg]=null}};function L5(e){this._internalRoot=e}L5.prototype.unstable_scheduleHydration=function(e){if(e){var t=WN();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ql.length&&t!==0&&t<Ql[n].priority;n++);Ql.splice(n,0,e),n===0&&lF(e)}};var EC=DN.version;if(EC!=="19.0.0")throw Error(ne(527,EC,"19.0.0"));nn.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ne(188)):(e=Object.keys(e).join(","),Error(ne(268,e)));return e=JZ(t),e=e!==null?BN(e):null,e=e===null?null:e.stateNode,e};var EJ={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:Xe,findFiberByHostInstance:Mu,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vU=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vU.isDisabled&&vU.supportsFiber)try{Km=vU.inject(EJ),Ys=vU}catch{}}y5.createRoot=function(e,t){if(!LN(e))throw Error(ne(299));var n=!1,i="",s=rP,r=oP,o=aP,a=null;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onUncaughtError!==void 0&&(s=t.onUncaughtError),t.onCaughtError!==void 0&&(r=t.onCaughtError),t.onRecoverableError!==void 0&&(o=t.onRecoverableError),t.unstable_transitionCallbacks!==void 0&&(a=t.unstable_transitionCallbacks)),t=iF(e,1,!1,null,null,n,i,s,r,o,a,null),e[cg]=t.current,i9(e.nodeType===8?e.parentNode:e),new c9(t)};y5.hydrateRoot=function(e,t,n){if(!LN(e))throw Error(ne(299));var i=!1,s="",r=rP,o=oP,a=aP,l=null,c=null;return n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onUncaughtError!==void 0&&(r=n.onUncaughtError),n.onCaughtError!==void 0&&(o=n.onCaughtError),n.onRecoverableError!==void 0&&(a=n.onRecoverableError),n.unstable_transitionCallbacks!==void 0&&(l=n.unstable_transitionCallbacks),n.formState!==void 0&&(c=n.formState)),t=iF(e,1,!0,t,n??null,i,s,r,o,a,l,c),t.context=sF(null),n=t.current,i=Ks(),s=dc(i),s.callback=null,fc(n,s,i),t.current.lanes=i,qm(t,i),aa(t),e[cg]=t.current,i9(e),new L5(t)};y5.version="19.0.0";function cF(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(cF)}catch(e){console.error(e)}}cF(),xN.exports=y5;var vJ=xN.exports;const wJ="modulepreload",_J=function(e){return"/"+e},vC={},ye=function(t,n,i){let s=Promise.resolve();return n&&n.length>0&&(document.getElementsByTagName("link"),s=Promise.all(n.map(r=>{if(r=_J(r),r in vC)return;vC[r]=!0;const o=r.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${a}`))return;const l=document.createElement("link");if(l.rel=o?"stylesheet":wJ,o||(l.as="script",l.crossOrigin=""),l.href=r,document.head.appendChild(l),o)return new Promise((c,u)=>{l.addEventListener("load",c),l.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${r}`)))})}))),s.then(()=>t()).catch(r=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=r,window.dispatchEvent(o),!o.defaultPrevented)throw r})};function TJ(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:i,onRegistered:s,onRegisteredSW:r,onRegisterError:o}=e;let a,l;const c=async(d=!0)=>{await l};async function u(){if("serviceWorker"in navigator){if(a=await ye(()=>import("./workbox-window.prod.es5-B9K5rw8f.js"),__vite__mapDeps([])).then(({Workbox:d})=>new d("/sw.js",{scope:"/",type:"classic"})).catch(d=>{o==null||o(d)}),!a)return;a.addEventListener("activated",d=>{(d.isUpdate||d.isExternal)&&window.location.reload()}),a.addEventListener("installed",d=>{d.isUpdate||i==null||i()}),a.register({immediate:t}).then(d=>{r?r("/sw.js",d):s==null||s(d)}).catch(d=>{o==null||o(d)})}}return l=u(),c}const Lt=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,Bt=globalThis,Nd=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,Yu="9.0.1";function N5(){return O5(Bt),Bt}function O5(e){const t=e.__SENTRY__=e.__SENTRY__||{};return t.version=t.version||Yu,t[Yu]=t[Yu]||{}}function P5(e,t,n=Bt){const i=n.__SENTRY__=n.__SENTRY__||{},s=i[Yu]=i[Yu]||{};return s[e]||(s[e]=t())}const IJ="Sentry Logger ",Lb=["debug","info","warn","error","log","assert","trace"],Nb={};function gg(e){if(!("console"in Bt))return e();const t=Bt.console,n={},i=Object.keys(Nb);i.forEach(s=>{const r=Nb[s];n[s]=t[s],t[s]=r});try{return e()}finally{i.forEach(s=>{t[s]=n[s]})}}function SJ(){let e=!1;const t={enable:()=>{e=!0},disable:()=>{e=!1},isEnabled:()=>e};return Nd?Lb.forEach(n=>{t[n]=(...i)=>{e&&gg(()=>{Bt.console[n](`${IJ}[${n}]:`,...i)})}}):Lb.forEach(n=>{t[n]=()=>{}}),t}const He=P5("logger",SJ),uF=50,od="?",wC=/\(error: (.*)\)/,_C=/captureMessage|captureException/;function dF(...e){const t=e.sort((n,i)=>n[0]-i[0]).map(n=>n[1]);return(n,i=0,s=0)=>{const r=[],o=n.split(`
`);for(let a=i;a<o.length;a++){const l=o[a];if(l.length>1024)continue;const c=wC.test(l)?l.replace(wC,"$1"):l;if(!c.match(/\S*Error: /)){for(const u of t){const d=u(c);if(d){r.push(d);break}}if(r.length>=uF+s)break}}return CJ(r.slice(s))}}function xJ(e){return Array.isArray(e)?dF(...e):e}function CJ(e){if(!e.length)return[];const t=Array.from(e);return/sentryWrapped/.test(wU(t).function||"")&&t.pop(),t.reverse(),_C.test(wU(t).function||"")&&(t.pop(),_C.test(wU(t).function||"")&&t.pop()),t.slice(0,uF).map(n=>({...n,filename:n.filename||wU(t).filename,function:n.function||od}))}function wU(e){return e[e.length-1]||{}}const d8="<anonymous>";function Lc(e){try{return!e||typeof e!="function"?d8:e.name||d8}catch{return d8}}function TC(e){const t=e.exception;if(t){const n=[];try{return t.values.forEach(i=>{i.stacktrace.frames&&n.push(...i.stacktrace.frames)}),n}catch{return}}}const T2={},IC={};function Od(e,t){T2[e]=T2[e]||[],T2[e].push(t)}function Pd(e,t){if(!IC[e]){IC[e]=!0;try{t()}catch(n){Nd&&He.error(`Error while instrumenting ${e}`,n)}}}function Jr(e,t){const n=e&&T2[e];if(n)for(const i of n)try{i(t)}catch(s){Nd&&He.error(`Error while triggering instrumentation handler.
Type: ${e}
Name: ${Lc(i)}
Error:`,s)}}let f8=null;function AJ(e){const t="error";Od(t,e),Pd(t,MJ)}function MJ(){f8=Bt.onerror,Bt.onerror=function(e,t,n,i,s){return Jr("error",{column:i,error:s,line:n,msg:e,url:t}),f8?f8.apply(this,arguments):!1},Bt.onerror.__SENTRY_INSTRUMENTED__=!0}let h8=null;function kJ(e){const t="unhandledrejection";Od(t,e),Pd(t,RJ)}function RJ(){h8=Bt.onunhandledrejection,Bt.onunhandledrejection=function(e){return Jr("unhandledrejection",e),h8?h8.apply(this,arguments):!0},Bt.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}const fF=Object.prototype.toString;function u9(e){switch(fF.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return!0;default:return ad(e,Error)}}function mg(e,t){return fF.call(e)===`[object ${t}]`}function hF(e){return mg(e,"ErrorEvent")}function SC(e){return mg(e,"DOMError")}function DJ(e){return mg(e,"DOMException")}function Ga(e){return mg(e,"String")}function d9(e){return typeof e=="object"&&e!==null&&"__sentry_template_string__"in e&&"__sentry_template_values__"in e}function f9(e){return e===null||d9(e)||typeof e!="object"&&typeof e!="function"}function Mh(e){return mg(e,"Object")}function F5(e){return typeof Event<"u"&&ad(e,Event)}function LJ(e){return typeof Element<"u"&&ad(e,Element)}function NJ(e){return mg(e,"RegExp")}function B5(e){return!!(e!=null&&e.then&&typeof e.then=="function")}function OJ(e){return Mh(e)&&"nativeEvent"in e&&"preventDefault"in e&&"stopPropagation"in e}function ad(e,t){try{return e instanceof t}catch{return!1}}function gF(e){return!!(typeof e=="object"&&e!==null&&(e.__isVue||e._isVue))}const h9=Bt,PJ=80;function mF(e,t={}){if(!e)return"<unknown>";try{let n=e;const i=5,s=[];let r=0,o=0;const a=" > ",l=a.length;let c;const u=Array.isArray(t)?t:t.keyAttrs,d=!Array.isArray(t)&&t.maxStringLength||PJ;for(;n&&r++<i&&(c=FJ(n,u),!(c==="html"||r>1&&o+s.length*l+c.length>=d));)s.push(c),o+=c.length,n=n.parentNode;return s.reverse().join(a)}catch{return"<unknown>"}}function FJ(e,t){const n=e,i=[];if(!(n!=null&&n.tagName))return"";if(h9.HTMLElement&&n instanceof HTMLElement&&n.dataset){if(n.dataset.sentryComponent)return n.dataset.sentryComponent;if(n.dataset.sentryElement)return n.dataset.sentryElement}i.push(n.tagName.toLowerCase());const s=t!=null&&t.length?t.filter(o=>n.getAttribute(o)).map(o=>[o,n.getAttribute(o)]):null;if(s!=null&&s.length)s.forEach(o=>{i.push(`[${o[0]}="${o[1]}"]`)});else{n.id&&i.push(`#${n.id}`);const o=n.className;if(o&&Ga(o)){const a=o.split(/\s+/);for(const l of a)i.push(`.${l}`)}}const r=["aria-label","type","name","title","alt"];for(const o of r){const a=n.getAttribute(o);a&&i.push(`[${o}="${a}"]`)}return i.join("")}function g9(){try{return h9.document.location.href}catch{return""}}function BJ(e){if(!h9.HTMLElement)return null;let t=e;const n=5;for(let i=0;i<n;i++){if(!t)return null;if(t instanceof HTMLElement){if(t.dataset.sentryComponent)return t.dataset.sentryComponent;if(t.dataset.sentryElement)return t.dataset.sentryElement}t=t.parentNode}return null}function sh(e,t=0){return typeof e!="string"||t===0||e.length<=t?e:`${e.slice(0,t)}...`}function Ob(e,t){if(!Array.isArray(e))return"";const n=[];for(let i=0;i<e.length;i++){const s=e[i];try{gF(s)?n.push("[VueViewModel]"):n.push(String(s))}catch{n.push("[value cannot be serialized]")}}return n.join(t)}function zJ(e,t,n=!1){return Ga(e)?NJ(t)?t.test(e):Ga(t)?n?e===t:e.includes(t):!1:!1}function z5(e,t=[],n=!1){return t.some(i=>zJ(e,i,n))}function Vs(e,t,n){if(!(t in e))return;const i=e[t],s=n(i);typeof s=="function"&&pF(s,i);try{e[t]=s}catch{Nd&&He.log(`Failed to replace method "${t}" in object`,e)}}function ld(e,t,n){try{Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0})}catch{Nd&&He.log(`Failed to add non-enumerable property "${t}" to object`,e)}}function pF(e,t){try{const n=t.prototype||{};e.prototype=t.prototype=n,ld(e,"__sentry_original__",t)}catch{}}function m9(e){return e.__sentry_original__}function UF(e){if(u9(e))return{message:e.message,name:e.name,stack:e.stack,...CC(e)};if(F5(e)){const t={type:e.type,target:xC(e.target),currentTarget:xC(e.currentTarget),...CC(e)};return typeof CustomEvent<"u"&&ad(e,CustomEvent)&&(t.detail=e.detail),t}else return e}function xC(e){try{return LJ(e)?mF(e):Object.prototype.toString.call(e)}catch{return"<unknown>"}}function CC(e){if(typeof e=="object"&&e!==null){const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}else return{}}function HJ(e,t=40){const n=Object.keys(UF(e));n.sort();const i=n[0];if(!i)return"[object has no keys]";if(i.length>=t)return sh(i,t);for(let s=n.length;s>0;s--){const r=n.slice(0,s).join(", ");if(!(r.length>t))return s===n.length?r:sh(r,t)}return""}function $s(e){return W7(e,new Map)}function W7(e,t){if(VJ(e)){const n=t.get(e);if(n!==void 0)return n;const i={};t.set(e,i);for(const s of Object.getOwnPropertyNames(e))typeof e[s]<"u"&&(i[s]=W7(e[s],t));return i}if(Array.isArray(e)){const n=t.get(e);if(n!==void 0)return n;const i=[];return t.set(e,i),e.forEach(s=>{i.push(W7(s,t))}),i}return e}function VJ(e){if(!Mh(e))return!1;try{const t=Object.getPrototypeOf(e).constructor.name;return!t||t==="Object"}catch{return!0}}const bF=1e3;function ap(){return Date.now()/bF}function $J(){const{performance:e}=Bt;if(!(e!=null&&e.now))return ap;const t=Date.now()-e.now(),n=e.timeOrigin==null?t:e.timeOrigin;return()=>(n+e.now())/bF}const Xa=$J();function _r(){const e=Bt,t=e.crypto||e.msCrypto;let n=()=>Math.random()*16;try{if(t!=null&&t.randomUUID)return t.randomUUID().replace(/-/g,"");t!=null&&t.getRandomValues&&(n=()=>{const i=new Uint8Array(1);return t.getRandomValues(i),i[0]})}catch{}return("10000000100040008000"+1e11).replace(/[018]/g,i=>(i^(n()&15)>>i/4).toString(16))}function yF(e){var t,n;return(n=(t=e.exception)==null?void 0:t.values)==null?void 0:n[0]}function Gl(e){const{message:t,event_id:n}=e;if(t)return t;const i=yF(e);return i?i.type&&i.value?`${i.type}: ${i.value}`:i.type||i.value||n||"<unknown>":n||"<unknown>"}function K7(e,t,n){const i=e.exception=e.exception||{},s=i.values=i.values||[],r=s[0]=s[0]||{};r.value||(r.value=t||""),r.type||(r.type="Error")}function cd(e,t){const n=yF(e);if(!n)return;const i={type:"generic",handled:!0},s=n.mechanism;if(n.mechanism={...i,...s,...t},t&&"data"in t){const r={...s==null?void 0:s.data,...t.data};n.mechanism.data=r}}function AC(e){if(GJ(e))return!0;try{ld(e,"__sentry_captured__",!0)}catch{}return!1}function GJ(e){try{return e.__sentry_captured__}catch{}}var ya;(function(e){e[e.PENDING=0]="PENDING";const n=1;e[e.RESOLVED=n]="RESOLVED";const i=2;e[e.REJECTED=i]="REJECTED"})(ya||(ya={}));function ud(e){return new Nc(t=>{t(e)})}function Pb(e){return new Nc((t,n)=>{n(e)})}class Nc{constructor(t){this._state=ya.PENDING,this._handlers=[],this._runExecutor(t)}then(t,n){return new Nc((i,s)=>{this._handlers.push([!1,r=>{if(!t)i(r);else try{i(t(r))}catch(o){s(o)}},r=>{if(!n)s(r);else try{i(n(r))}catch(o){s(o)}}]),this._executeHandlers()})}catch(t){return this.then(n=>n,t)}finally(t){return new Nc((n,i)=>{let s,r;return this.then(o=>{r=!1,s=o,t&&t()},o=>{r=!0,s=o,t&&t()}).then(()=>{if(r){i(s);return}n(s)})})}_executeHandlers(){if(this._state===ya.PENDING)return;const t=this._handlers.slice();this._handlers=[],t.forEach(n=>{n[0]||(this._state===ya.RESOLVED&&n[1](this._value),this._state===ya.REJECTED&&n[2](this._value),n[0]=!0)})}_runExecutor(t){const n=(r,o)=>{if(this._state===ya.PENDING){if(B5(o)){o.then(i,s);return}this._state=r,this._value=o,this._executeHandlers()}},i=r=>{n(ya.RESOLVED,r)},s=r=>{n(ya.REJECTED,r)};try{t(i,s)}catch(r){s(r)}}}function XJ(e){const t=Xa(),n={sid:_r(),init:!0,timestamp:t,started:t,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>YJ(n)};return e&&kh(n,e),n}function kh(e,t={}){if(t.user&&(!e.ipAddress&&t.user.ip_address&&(e.ipAddress=t.user.ip_address),!e.did&&!t.did&&(e.did=t.user.id||t.user.email||t.user.username)),e.timestamp=t.timestamp||Xa(),t.abnormal_mechanism&&(e.abnormal_mechanism=t.abnormal_mechanism),t.ignoreDuration&&(e.ignoreDuration=t.ignoreDuration),t.sid&&(e.sid=t.sid.length===32?t.sid:_r()),t.init!==void 0&&(e.init=t.init),!e.did&&t.did&&(e.did=`${t.did}`),typeof t.started=="number"&&(e.started=t.started),e.ignoreDuration)e.duration=void 0;else if(typeof t.duration=="number")e.duration=t.duration;else{const n=e.timestamp-e.started;e.duration=n>=0?n:0}t.release&&(e.release=t.release),t.environment&&(e.environment=t.environment),!e.ipAddress&&t.ipAddress&&(e.ipAddress=t.ipAddress),!e.userAgent&&t.userAgent&&(e.userAgent=t.userAgent),typeof t.errors=="number"&&(e.errors=t.errors),t.status&&(e.status=t.status)}function jJ(e,t){let n={};e.status==="ok"&&(n={status:"exited"}),kh(e,n)}function YJ(e){return $s({sid:`${e.sid}`,init:e.init,started:new Date(e.started*1e3).toISOString(),timestamp:new Date(e.timestamp*1e3).toISOString(),status:e.status,errors:e.errors,did:typeof e.did=="number"||typeof e.did=="string"?`${e.did}`:void 0,duration:e.duration,abnormal_mechanism:e.abnormal_mechanism,attrs:{release:e.release,environment:e.environment,ip_address:e.ipAddress,user_agent:e.userAgent}})}function MC(){return _r()}function EF(){return _r().substring(16)}function lp(e,t,n=2){if(!t||typeof t!="object"||n<=0)return t;if(e&&Object.keys(t).length===0)return e;const i={...e};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(i[s]=lp(i[s],t[s],n-1));return i}const Z7="_sentrySpan";function kC(e,t){t?ld(e,Z7,t):delete e[Z7]}function RC(e){return e[Z7]}const WJ=100;class Wo{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:MC(),sampleRand:Math.random()}}clone(){const t=new Wo;return t._breadcrumbs=[...this._breadcrumbs],t._tags={...this._tags},t._extra={...this._extra},t._contexts={...this._contexts},this._contexts.flags&&(t._contexts.flags={values:[...this._contexts.flags.values]}),t._user=this._user,t._level=this._level,t._session=this._session,t._transactionName=this._transactionName,t._fingerprint=this._fingerprint,t._eventProcessors=[...this._eventProcessors],t._attachments=[...this._attachments],t._sdkProcessingMetadata={...this._sdkProcessingMetadata},t._propagationContext={...this._propagationContext},t._client=this._client,t._lastEventId=this._lastEventId,kC(t,RC(this)),t}setClient(t){this._client=t}setLastEventId(t){this._lastEventId=t}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(t){this._scopeListeners.push(t)}addEventProcessor(t){return this._eventProcessors.push(t),this}setUser(t){return this._user=t||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&kh(this._session,{user:t}),this._notifyScopeListeners(),this}getUser(){return this._user}setTags(t){return this._tags={...this._tags,...t},this._notifyScopeListeners(),this}setTag(t,n){return this._tags={...this._tags,[t]:n},this._notifyScopeListeners(),this}setExtras(t){return this._extra={...this._extra,...t},this._notifyScopeListeners(),this}setExtra(t,n){return this._extra={...this._extra,[t]:n},this._notifyScopeListeners(),this}setFingerprint(t){return this._fingerprint=t,this._notifyScopeListeners(),this}setLevel(t){return this._level=t,this._notifyScopeListeners(),this}setTransactionName(t){return this._transactionName=t,this._notifyScopeListeners(),this}setContext(t,n){return n===null?delete this._contexts[t]:this._contexts[t]=n,this._notifyScopeListeners(),this}setSession(t){return t?this._session=t:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(t){if(!t)return this;const n=typeof t=="function"?t(this):t,i=n instanceof Wo?n.getScopeData():Mh(n)?t:void 0,{tags:s,extra:r,user:o,contexts:a,level:l,fingerprint:c=[],propagationContext:u}=i||{};return this._tags={...this._tags,...s},this._extra={...this._extra,...r},this._contexts={...this._contexts,...a},o&&Object.keys(o).length&&(this._user=o),l&&(this._level=l),c.length&&(this._fingerprint=c),u&&(this._propagationContext=u),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._session=void 0,kC(this,void 0),this._attachments=[],this.setPropagationContext({traceId:MC(),sampleRand:Math.random()}),this._notifyScopeListeners(),this}addBreadcrumb(t,n){var r;const i=typeof n=="number"?n:WJ;if(i<=0)return this;const s={timestamp:ap(),...t};return this._breadcrumbs.push(s),this._breadcrumbs.length>i&&(this._breadcrumbs=this._breadcrumbs.slice(-i),(r=this._client)==null||r.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(t){return this._attachments.push(t),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:RC(this)}}setSDKProcessingMetadata(t){return this._sdkProcessingMetadata=lp(this._sdkProcessingMetadata,t,2),this}setPropagationContext(t){return this._propagationContext=t,this}getPropagationContext(){return this._propagationContext}captureException(t,n){const i=(n==null?void 0:n.event_id)||_r();if(!this._client)return He.warn("No client configured on scope - will not capture exception!"),i;const s=new Error("Sentry syntheticException");return this._client.captureException(t,{originalException:t,syntheticException:s,...n,event_id:i},this),i}captureMessage(t,n,i){const s=(i==null?void 0:i.event_id)||_r();if(!this._client)return He.warn("No client configured on scope - will not capture message!"),s;const r=new Error(t);return this._client.captureMessage(t,n,{originalException:t,syntheticException:r,...i,event_id:s},this),s}captureEvent(t,n){const i=(n==null?void 0:n.event_id)||_r();return this._client?(this._client.captureEvent(t,{...n,event_id:i},this),i):(He.warn("No client configured on scope - will not capture event!"),i)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(t=>{t(this)}),this._notifyingListeners=!1)}}function KJ(){return P5("defaultCurrentScope",()=>new Wo)}function ZJ(){return P5("defaultIsolationScope",()=>new Wo)}class qJ{constructor(t,n){let i;t?i=t:i=new Wo;let s;n?s=n:s=new Wo,this._stack=[{scope:i}],this._isolationScope=s}withScope(t){const n=this._pushScope();let i;try{i=t(n)}catch(s){throw this._popScope(),s}return B5(i)?i.then(s=>(this._popScope(),s),s=>{throw this._popScope(),s}):(this._popScope(),i)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const t=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:t}),t}_popScope(){return this._stack.length<=1?!1:!!this._stack.pop()}}function Rh(){const e=N5(),t=O5(e);return t.stack=t.stack||new qJ(KJ(),ZJ())}function QJ(e){return Rh().withScope(e)}function JJ(e,t){const n=Rh();return n.withScope(()=>(n.getStackTop().scope=e,t(e)))}function DC(e){return Rh().withScope(()=>e(Rh().getIsolationScope()))}function eee(){return{withIsolationScope:DC,withScope:QJ,withSetScope:JJ,withSetIsolationScope:(e,t)=>DC(t),getCurrentScope:()=>Rh().getScope(),getIsolationScope:()=>Rh().getIsolationScope()}}function p9(e){const t=O5(e);return t.acs?t.acs:eee()}function El(){const e=N5();return p9(e).getCurrentScope()}function cp(){const e=N5();return p9(e).getIsolationScope()}function tee(){return P5("globalScope",()=>new Wo)}function U9(...e){const t=N5(),n=p9(t);if(e.length===2){const[i,s]=e;return i?n.withSetScope(i,s):n.withScope(s)}return n.withScope(e[0])}function Qi(){return El().getClient()}function nee(e){const t=e.getPropagationContext(),{traceId:n,parentSpanId:i,propagationSpanId:s}=t;return $s({trace_id:n,span_id:s||EF(),parent_span_id:i})}const iee="sentry.source",see="sentry.sample_rate",ree="sentry.op",oee="sentry.origin",vF="sentry.profile_id",wF="sentry.exclusive_time",aee=0,lee=1,cee="_sentryScope",uee="_sentryIsolationScope";function _F(e){return{scope:e[cee],isolationScope:e[uee]}}function dee(e){if(typeof e=="boolean")return Number(e);const t=typeof e=="string"?parseFloat(e):e;if(!(typeof t!="number"||isNaN(t)||t<0||t>1))return t}const fee="sentry-",hee=/^sentry-/;function gee(e){const t=mee(e);if(!t)return;const n=Object.entries(t).reduce((i,[s,r])=>{if(s.match(hee)){const o=s.slice(fee.length);i[o]=r}return i},{});if(Object.keys(n).length>0)return n}function mee(e){if(!(!e||!Ga(e)&&!Array.isArray(e)))return Array.isArray(e)?e.reduce((t,n)=>{const i=LC(n);return Object.entries(i).forEach(([s,r])=>{t[s]=r}),t},{}):LC(e)}function LC(e){return e.split(",").map(t=>t.split("=").map(n=>decodeURIComponent(n.trim()))).reduce((t,[n,i])=>(n&&i&&(t[n]=i),t),{})}const pee=1;let NC=!1;function Uee(e){const{spanId:t,traceId:n,isRemote:i}=e.spanContext(),s=i?t:b9(e).parent_span_id,r=_F(e).scope,o=i?(r==null?void 0:r.getPropagationContext().propagationSpanId)||EF():t;return $s({parent_span_id:s,span_id:o,trace_id:n})}function OC(e){return typeof e=="number"?PC(e):Array.isArray(e)?e[0]+e[1]/1e9:e instanceof Date?PC(e.getTime()):Xa()}function PC(e){return e>9999999999?e/1e3:e}function b9(e){if(yee(e))return e.getSpanJSON();const{spanId:t,traceId:n}=e.spanContext();if(bee(e)){const{attributes:i,startTime:s,name:r,endTime:o,parentSpanId:a,status:l}=e;return $s({span_id:t,trace_id:n,data:i,description:r,parent_span_id:a,start_timestamp:OC(s),timestamp:OC(o)||void 0,status:vee(l),op:i[ree],origin:i[oee]})}return{span_id:t,trace_id:n,start_timestamp:0,data:{}}}function bee(e){const t=e;return!!t.attributes&&!!t.startTime&&!!t.name&&!!t.endTime&&!!t.status}function yee(e){return typeof e.getSpanJSON=="function"}function Eee(e){const{traceFlags:t}=e.spanContext();return t===pee}function vee(e){if(!(!e||e.code===aee))return e.code===lee?"ok":e.message||"unknown_error"}const wee="_sentryRootSpan";function TF(e){return e[wee]||e}function FC(){NC||(gg(()=>{console.warn("[Sentry] Returning null from `beforeSendSpan` is disallowed. To drop certain spans, configure the respective integrations directly.")}),NC=!0)}function _ee(e){var n;if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const t=e||((n=Qi())==null?void 0:n.getOptions());return!!t&&(t.tracesSampleRate!=null||!!t.tracesSampler)}const y9="production",Tee="_frozenDsc";function IF(e,t){const n=t.getOptions(),{publicKey:i}=t.getDsn()||{},s=$s({environment:n.environment||y9,release:n.release,public_key:i,trace_id:e});return t.emit("createDsc",s),s}function Iee(e,t){const n=t.getPropagationContext();return n.dsc||IF(n.traceId,e)}function See(e){var m;const t=Qi();if(!t)return{};const n=TF(e),i=b9(n),s=i.data,r=n.spanContext().traceState,o=(r==null?void 0:r.get("sentry.sample_rate"))??s[see];function a(p){return(typeof o=="number"||typeof o=="string")&&(p.sample_rate=`${o}`),p}const l=n[Tee];if(l)return a(l);const c=r==null?void 0:r.get("sentry.dsc"),u=c&&gee(c);if(u)return a(u);const d=IF(e.spanContext().traceId,t),f=s[iee],h=i.description;return f!=="url"&&h&&(d.transaction=h),_ee()&&(d.sampled=String(Eee(n)),d.sample_rand=(r==null?void 0:r.get("sentry.sample_rand"))??((m=_F(n).scope)==null?void 0:m.getPropagationContext().sampleRand.toString())),a(d),t.emit("createDsc",d,n),d}const xee=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function Cee(e){return e==="http"||e==="https"}function E9(e,t=!1){const{host:n,path:i,pass:s,port:r,projectId:o,protocol:a,publicKey:l}=e;return`${a}://${l}${t&&s?`:${s}`:""}@${n}${r?`:${r}`:""}/${i&&`${i}/`}${o}`}function Aee(e){const t=xee.exec(e);if(!t){gg(()=>{console.error(`Invalid Sentry Dsn: ${e}`)});return}const[n,i,s="",r="",o="",a=""]=t.slice(1);let l="",c=a;const u=c.split("/");if(u.length>1&&(l=u.slice(0,-1).join("/"),c=u.pop()),c){const d=c.match(/^\d+/);d&&(c=d[0])}return SF({host:r,pass:s,path:l,projectId:c,port:o,protocol:n,publicKey:i})}function SF(e){return{protocol:e.protocol,publicKey:e.publicKey||"",pass:e.pass||"",host:e.host,port:e.port||"",path:e.path||"",projectId:e.projectId}}function Mee(e){if(!Nd)return!0;const{port:t,projectId:n,protocol:i}=e;return["protocol","publicKey","host","projectId"].find(o=>e[o]?!1:(He.error(`Invalid Sentry Dsn: ${o} missing`),!0))?!1:n.match(/^\d+$/)?Cee(i)?t&&isNaN(parseInt(t,10))?(He.error(`Invalid Sentry Dsn: Invalid port ${t}`),!1):!0:(He.error(`Invalid Sentry Dsn: Invalid protocol ${i}`),!1):(He.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),!1)}function kee(e){const t=typeof e=="string"?Aee(e):SF(e);if(!(!t||!Mee(t)))return t}function Ea(e,t=100,n=1/0){try{return q7("",e,t,n)}catch(i){return{ERROR:`**non-serializable** (${i})`}}}function xF(e,t=3,n=100*1024){const i=Ea(e,t);return Nee(i)>n?xF(e,t-1,n):i}function q7(e,t,n=1/0,i=1/0,s=Oee()){const[r,o]=s;if(t==null||["boolean","string"].includes(typeof t)||typeof t=="number"&&Number.isFinite(t))return t;const a=Ree(e,t);if(!a.startsWith("[object "))return a;if(t.__sentry_skip_normalization__)return t;const l=typeof t.__sentry_override_normalization_depth__=="number"?t.__sentry_override_normalization_depth__:n;if(l===0)return a.replace("object ","");if(r(t))return"[Circular ~]";const c=t;if(c&&typeof c.toJSON=="function")try{const h=c.toJSON();return q7("",h,l-1,i,s)}catch{}const u=Array.isArray(t)?[]:{};let d=0;const f=UF(t);for(const h in f){if(!Object.prototype.hasOwnProperty.call(f,h))continue;if(d>=i){u[h]="[MaxProperties ~]";break}const m=f[h];u[h]=q7(h,m,l-1,i,s),d++}return o(t),u}function Ree(e,t){try{if(e==="domain"&&t&&typeof t=="object"&&t._events)return"[Domain]";if(e==="domainEmitter")return"[DomainEmitter]";if(typeof global<"u"&&t===global)return"[Global]";if(typeof window<"u"&&t===window)return"[Window]";if(typeof document<"u"&&t===document)return"[Document]";if(gF(t))return"[VueViewModel]";if(OJ(t))return"[SyntheticEvent]";if(typeof t=="number"&&!Number.isFinite(t))return`[${t}]`;if(typeof t=="function")return`[Function: ${Lc(t)}]`;if(typeof t=="symbol")return`[${String(t)}]`;if(typeof t=="bigint")return`[BigInt: ${String(t)}]`;const n=Dee(t);return/^HTML(\w*)Element$/.test(n)?`[HTMLElement: ${n}]`:`[object ${n}]`}catch(n){return`**non-serializable** (${n})`}}function Dee(e){const t=Object.getPrototypeOf(e);return t?t.constructor.name:"null prototype"}function Lee(e){return~-encodeURI(e).split(/%..|./).length}function Nee(e){return Lee(JSON.stringify(e))}function Oee(){const e=new WeakSet;function t(i){return e.has(i)?!0:(e.add(i),!1)}function n(i){e.delete(i)}return[t,n]}function H5(e,t=[]){return[e,t]}function Pee(e,t){const[n,i]=e;return[n,[...i,t]]}function BC(e,t){const n=e[1];for(const i of n){const s=i[0].type;if(t(i,s))return!0}return!1}function Q7(e){const t=O5(Bt);return t.encodePolyfill?t.encodePolyfill(e):new TextEncoder().encode(e)}function Fee(e){const[t,n]=e;let i=JSON.stringify(t);function s(r){typeof i=="string"?i=typeof r=="string"?i+r:[Q7(i),r]:i.push(typeof r=="string"?Q7(r):r)}for(const r of n){const[o,a]=r;if(s(`
${JSON.stringify(o)}
`),typeof a=="string"||a instanceof Uint8Array)s(a);else{let l;try{l=JSON.stringify(a)}catch{l=JSON.stringify(Ea(a))}s(l)}}return typeof i=="string"?i:Bee(i)}function Bee(e){const t=e.reduce((s,r)=>s+r.length,0),n=new Uint8Array(t);let i=0;for(const s of e)n.set(s,i),i+=s.length;return n}function zee(e){const t=typeof e.data=="string"?Q7(e.data):e.data;return[$s({type:"attachment",length:t.length,filename:e.filename,content_type:e.contentType,attachment_type:e.attachmentType}),t]}const Hee={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",raw_security:"security"};function zC(e){return Hee[e]}function CF(e){if(!(e!=null&&e.sdk))return;const{name:t,version:n}=e.sdk;return{name:t,version:n}}function Vee(e,t,n,i){var r;const s=(r=e.sdkProcessingMetadata)==null?void 0:r.dynamicSamplingContext;return{event_id:e.event_id,sent_at:new Date().toISOString(),...t&&{sdk:t},...!!n&&i&&{dsn:E9(i)},...s&&{trace:$s({...s})}}}function $ee(e,t){return t&&(e.sdk=e.sdk||{},e.sdk.name=e.sdk.name||t.name,e.sdk.version=e.sdk.version||t.version,e.sdk.integrations=[...e.sdk.integrations||[],...t.integrations||[]],e.sdk.packages=[...e.sdk.packages||[],...t.packages||[]]),e}function Gee(e,t,n,i){const s=CF(n),r={sent_at:new Date().toISOString(),...s&&{sdk:s},...!!i&&t&&{dsn:E9(t)}},o="aggregates"in e?[{type:"sessions"},e]:[{type:"session"},e.toJSON()];return H5(r,[o])}function Xee(e,t,n,i){const s=CF(n),r=e.type&&e.type!=="replay_event"?e.type:"event";$ee(e,n==null?void 0:n.sdk);const o=Vee(e,s,i,t);return delete e.sdkProcessingMetadata,H5(o,[[{type:r},e]])}function J7(e,t,n,i=0){return new Nc((s,r)=>{const o=e[i];if(t===null||typeof o!="function")s(t);else{const a=o({...t},n);Lt&&o.id&&a===null&&He.log(`Event processor "${o.id}" dropped event`),B5(a)?a.then(l=>J7(e,l,n,i+1).then(s)).then(null,r):J7(e,a,n,i+1).then(s).then(null,r)}})}let _U,HC,TU;function jee(e){const t=Bt._sentryDebugIds;if(!t)return{};const n=Object.keys(t);return TU&&n.length===HC||(HC=n.length,TU=n.reduce((i,s)=>{_U||(_U={});const r=_U[s];if(r)i[r[0]]=r[1];else{const o=e(s);for(let a=o.length-1;a>=0;a--){const l=o[a],c=l==null?void 0:l.filename,u=t[s];if(c&&u){i[c]=u,_U[s]=[c,u];break}}}return i},{})),TU}function Yee(e,t){const{fingerprint:n,span:i,breadcrumbs:s,sdkProcessingMetadata:r}=t;Wee(e,t),i&&qee(e,i),Qee(e,n),Kee(e,s),Zee(e,r)}function VC(e,t){const{extra:n,tags:i,user:s,contexts:r,level:o,sdkProcessingMetadata:a,breadcrumbs:l,fingerprint:c,eventProcessors:u,attachments:d,propagationContext:f,transactionName:h,span:m}=t;IU(e,"extra",n),IU(e,"tags",i),IU(e,"user",s),IU(e,"contexts",r),e.sdkProcessingMetadata=lp(e.sdkProcessingMetadata,a,2),o&&(e.level=o),h&&(e.transactionName=h),m&&(e.span=m),l.length&&(e.breadcrumbs=[...e.breadcrumbs,...l]),c.length&&(e.fingerprint=[...e.fingerprint,...c]),u.length&&(e.eventProcessors=[...e.eventProcessors,...u]),d.length&&(e.attachments=[...e.attachments,...d]),e.propagationContext={...e.propagationContext,...f}}function IU(e,t,n){e[t]=lp(e[t],n,1)}function Wee(e,t){const{extra:n,tags:i,user:s,contexts:r,level:o,transactionName:a}=t,l=$s(n);Object.keys(l).length&&(e.extra={...l,...e.extra});const c=$s(i);Object.keys(c).length&&(e.tags={...c,...e.tags});const u=$s(s);Object.keys(u).length&&(e.user={...u,...e.user});const d=$s(r);Object.keys(d).length&&(e.contexts={...d,...e.contexts}),o&&(e.level=o),a&&e.type!=="transaction"&&(e.transaction=a)}function Kee(e,t){const n=[...e.breadcrumbs||[],...t];e.breadcrumbs=n.length?n:void 0}function Zee(e,t){e.sdkProcessingMetadata={...e.sdkProcessingMetadata,...t}}function qee(e,t){e.contexts={trace:Uee(t),...e.contexts},e.sdkProcessingMetadata={dynamicSamplingContext:See(t),...e.sdkProcessingMetadata};const n=TF(t),i=b9(n).description;i&&!e.transaction&&e.type==="transaction"&&(e.transaction=i)}function Qee(e,t){e.fingerprint=e.fingerprint?Array.isArray(e.fingerprint)?e.fingerprint:[e.fingerprint]:[],t&&(e.fingerprint=e.fingerprint.concat(t)),e.fingerprint.length||delete e.fingerprint}function Jee(e,t,n,i,s,r){const{normalizeDepth:o=3,normalizeMaxBreadth:a=1e3}=e,l={...t,event_id:t.event_id||n.event_id||_r(),timestamp:t.timestamp||ap()},c=n.integrations||e.integrations.map(U=>U.name);ete(l,e),ite(l,c),s&&s.emit("applyFrameMetadata",t),t.type===void 0&&tte(l,e.stackParser);const u=rte(i,n.captureContext);n.mechanism&&cd(l,n.mechanism);const d=s?s.getEventProcessors():[],f=tee().getScopeData();if(r){const U=r.getScopeData();VC(f,U)}if(u){const U=u.getScopeData();VC(f,U)}const h=[...n.attachments||[],...f.attachments];h.length&&(n.attachments=h),Yee(l,f);const m=[...d,...f.eventProcessors];return J7(m,l,n).then(U=>(U&&nte(U),typeof o=="number"&&o>0?ste(U,o,a):U))}function ete(e,t){var l,c;const{environment:n,release:i,dist:s,maxValueLength:r=250}=t;e.environment=e.environment||n||y9,!e.release&&i&&(e.release=i),!e.dist&&s&&(e.dist=s),e.message&&(e.message=sh(e.message,r));const o=(c=(l=e.exception)==null?void 0:l.values)==null?void 0:c[0];o!=null&&o.value&&(o.value=sh(o.value,r));const a=e.request;a!=null&&a.url&&(a.url=sh(a.url,r))}function tte(e,t){var i,s;const n=jee(t);(s=(i=e.exception)==null?void 0:i.values)==null||s.forEach(r=>{var o,a;(a=(o=r.stacktrace)==null?void 0:o.frames)==null||a.forEach(l=>{l.filename&&(l.debug_id=n[l.filename])})})}function nte(e){var i,s;const t={};if((s=(i=e.exception)==null?void 0:i.values)==null||s.forEach(r=>{var o,a;(a=(o=r.stacktrace)==null?void 0:o.frames)==null||a.forEach(l=>{l.debug_id&&(l.abs_path?t[l.abs_path]=l.debug_id:l.filename&&(t[l.filename]=l.debug_id),delete l.debug_id)})}),Object.keys(t).length===0)return;e.debug_meta=e.debug_meta||{},e.debug_meta.images=e.debug_meta.images||[];const n=e.debug_meta.images;Object.entries(t).forEach(([r,o])=>{n.push({type:"sourcemap",code_file:r,debug_id:o})})}function ite(e,t){t.length>0&&(e.sdk=e.sdk||{},e.sdk.integrations=[...e.sdk.integrations||[],...t])}function ste(e,t,n){var s,r;if(!e)return null;const i={...e,...e.breadcrumbs&&{breadcrumbs:e.breadcrumbs.map(o=>({...o,...o.data&&{data:Ea(o.data,t,n)}}))},...e.user&&{user:Ea(e.user,t,n)},...e.contexts&&{contexts:Ea(e.contexts,t,n)},...e.extra&&{extra:Ea(e.extra,t,n)}};return(s=e.contexts)!=null&&s.trace&&i.contexts&&(i.contexts.trace=e.contexts.trace,e.contexts.trace.data&&(i.contexts.trace.data=Ea(e.contexts.trace.data,t,n))),e.spans&&(i.spans=e.spans.map(o=>({...o,...o.data&&{data:Ea(o.data,t,n)}}))),(r=e.contexts)!=null&&r.flags&&i.contexts&&(i.contexts.flags=Ea(e.contexts.flags,3,n)),i}function rte(e,t){if(!t)return e;const n=e?e.clone():new Wo;return n.update(t),n}function ote(e){if(e)return ate(e)?{captureContext:e}:cte(e)?{captureContext:e}:e}function ate(e){return e instanceof Wo||typeof e=="function"}const lte=["user","level","extra","contexts","tags","fingerprint","propagationContext"];function cte(e){return Object.keys(e).some(t=>lte.includes(t))}function v9(e,t){return El().captureException(e,ote(t))}function $C(e,t){const n=typeof t=="string"?t:void 0,i=typeof t!="string"?{captureContext:t}:void 0;return El().captureMessage(e,n,i)}function AF(e,t){return El().captureEvent(e,t)}function GC(e){const t=cp(),n=El(),{userAgent:i}=Bt.navigator||{},s=XJ({user:n.getUser()||t.getUser(),...i&&{userAgent:i},...e}),r=t.getSession();return(r==null?void 0:r.status)==="ok"&&kh(r,{status:"exited"}),MF(),t.setSession(s),s}function MF(){const e=cp(),n=El().getSession()||e.getSession();n&&jJ(n),kF(),e.setSession()}function kF(){const e=cp(),t=Qi(),n=e.getSession();n&&t&&t.captureSession(n)}function XC(e=!1){if(e){MF();return}kF()}const ute="7";function dte(e){const t=e.protocol?`${e.protocol}:`:"",n=e.port?`:${e.port}`:"";return`${t}//${e.host}${n}${e.path?`/${e.path}`:""}/api/`}function fte(e){return`${dte(e)}${e.projectId}/envelope/`}function hte(e,t){const n={sentry_version:ute};return e.publicKey&&(n.sentry_key=e.publicKey),t&&(n.sentry_client=`${t.name}/${t.version}`),new URLSearchParams(n).toString()}function gte(e,t,n){return t||`${fte(e)}?${hte(e,n)}`}const jC=[];function mte(e){const t={};return e.forEach(n=>{const{name:i}=n,s=t[i];s&&!s.isDefaultInstance&&n.isDefaultInstance||(t[i]=n)}),Object.values(t)}function pte(e){const t=e.defaultIntegrations||[],n=e.integrations;t.forEach(s=>{s.isDefaultInstance=!0});let i;if(Array.isArray(n))i=[...t,...n];else if(typeof n=="function"){const s=n(t);i=Array.isArray(s)?s:[s]}else i=t;return mte(i)}function Ute(e,t){const n={};return t.forEach(i=>{i&&RF(e,i,n)}),n}function YC(e,t){for(const n of t)n!=null&&n.afterAllSetup&&n.afterAllSetup(e)}function RF(e,t,n){if(n[t.name]){Lt&&He.log(`Integration skipped because it was already installed: ${t.name}`);return}if(n[t.name]=t,jC.indexOf(t.name)===-1&&typeof t.setupOnce=="function"&&(t.setupOnce(),jC.push(t.name)),t.setup&&typeof t.setup=="function"&&t.setup(e),typeof t.preprocessEvent=="function"){const i=t.preprocessEvent.bind(t);e.on("preprocessEvent",(s,r)=>i(s,r,e))}if(typeof t.processEvent=="function"){const i=t.processEvent.bind(t),s=Object.assign((r,o)=>i(r,o,e),{id:t.name});e.addEventProcessor(s)}Lt&&He.log(`Integration installed: ${t.name}`)}function bte(e,t,n){const i=[{type:"client_report"},{timestamp:ap(),discarded_events:e}];return H5(t?{dsn:t}:{},[i])}class Yr extends Error{constructor(t,n="warn"){super(t),this.message=t,this.logLevel=n}}function DF(e){const t=[];e.message&&t.push(e.message);try{const n=e.exception.values[e.exception.values.length-1];n!=null&&n.value&&(t.push(n.value),n.type&&t.push(`${n.type}: ${n.value}`))}catch{}return t}function yte(e){var l;const{trace_id:t,parent_span_id:n,span_id:i,status:s,origin:r,data:o,op:a}=((l=e.contexts)==null?void 0:l.trace)??{};return $s({data:o??{},description:e.transaction,op:a,parent_span_id:n,span_id:i??"",start_timestamp:e.start_timestamp??0,status:s,timestamp:e.timestamp,trace_id:t??"",origin:r,profile_id:o==null?void 0:o[vF],exclusive_time:o==null?void 0:o[wF],measurements:e.measurements,is_segment:!0})}function Ete(e){const t={type:"transaction",timestamp:e.timestamp,start_timestamp:e.start_timestamp,transaction:e.description,contexts:{trace:{trace_id:e.trace_id,span_id:e.span_id,parent_span_id:e.parent_span_id,op:e.op,status:e.status,origin:e.origin,data:{...e.data,...e.profile_id&&{[vF]:e.profile_id},...e.exclusive_time&&{[wF]:e.exclusive_time}}}},measurements:e.measurements};return $s(t)}const WC="Not capturing exception because it's already been captured.",KC="Discarded session because of missing or non-string release";class vte{constructor(t){if(this._options=t,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],t.dsn?this._dsn=kee(t.dsn):Lt&&He.warn("No DSN provided, client will not send events."),this._dsn){const n=gte(this._dsn,t.tunnel,t._metadata?t._metadata.sdk:void 0);this._transport=t.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...t.transportOptions,url:n})}}captureException(t,n,i){const s=_r();if(AC(t))return Lt&&He.log(WC),s;const r={event_id:s,...n};return this._process(this.eventFromException(t,r).then(o=>this._captureEvent(o,r,i))),r.event_id}captureMessage(t,n,i,s){const r={event_id:_r(),...i},o=d9(t)?t:String(t),a=f9(t)?this.eventFromMessage(o,n,r):this.eventFromException(t,r);return this._process(a.then(l=>this._captureEvent(l,r,s))),r.event_id}captureEvent(t,n,i){const s=_r();if(n!=null&&n.originalException&&AC(n.originalException))return Lt&&He.log(WC),s;const r={event_id:s,...n},o=t.sdkProcessingMetadata||{},a=o.capturedSpanScope,l=o.capturedSpanIsolationScope;return this._process(this._captureEvent(t,r,a||i,l)),r.event_id}captureSession(t){this.sendSession(t),kh(t,{init:!1})}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(t){const n=this._transport;return n?(this.emit("flush"),this._isClientDoneProcessing(t).then(i=>n.flush(t).then(s=>i&&s))):ud(!0)}close(t){return this.flush(t).then(n=>(this.getOptions().enabled=!1,this.emit("close"),n))}getEventProcessors(){return this._eventProcessors}addEventProcessor(t){this._eventProcessors.push(t)}init(){(this._isEnabled()||this._options.integrations.some(({name:t})=>t.startsWith("Spotlight")))&&this._setupIntegrations()}getIntegrationByName(t){return this._integrations[t]}addIntegration(t){const n=this._integrations[t.name];RF(this,t,this._integrations),n||YC(this,[t])}sendEvent(t,n={}){this.emit("beforeSendEvent",t,n);let i=Xee(t,this._dsn,this._options._metadata,this._options.tunnel);for(const r of n.attachments||[])i=Pee(i,zee(r));const s=this.sendEnvelope(i);s&&s.then(r=>this.emit("afterSendEvent",t,r),null)}sendSession(t){const{release:n,environment:i=y9}=this._options;if("aggregates"in t){const r=t.attrs||{};if(!r.release&&!n){Lt&&He.warn(KC);return}r.release=r.release||n,r.environment=r.environment||i,t.attrs=r}else{if(!t.release&&!n){Lt&&He.warn(KC);return}t.release=t.release||n,t.environment=t.environment||i}this.emit("beforeSendSession",t);const s=Gee(t,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(s)}recordDroppedEvent(t,n,i=1){if(this._options.sendClientReports){const s=`${t}:${n}`;Lt&&He.log(`Recording outcome: "${s}"${i>1?` (${i} times)`:""}`),this._outcomes[s]=(this._outcomes[s]||0)+i}}on(t,n){const i=this._hooks[t]=this._hooks[t]||[];return i.push(n),()=>{const s=i.indexOf(n);s>-1&&i.splice(s,1)}}emit(t,...n){const i=this._hooks[t];i&&i.forEach(s=>s(...n))}sendEnvelope(t){return this.emit("beforeEnvelope",t),this._isEnabled()&&this._transport?this._transport.send(t).then(null,n=>(Lt&&He.error("Error while sending envelope:",n),n)):(Lt&&He.error("Transport disabled"),ud({}))}_setupIntegrations(){const{integrations:t}=this._options;this._integrations=Ute(this,t),YC(this,t)}_updateSessionFromEvent(t,n){var l;let i=n.level==="fatal",s=!1;const r=(l=n.exception)==null?void 0:l.values;if(r){s=!0;for(const c of r){const u=c.mechanism;if((u==null?void 0:u.handled)===!1){i=!0;break}}}const o=t.status==="ok";(o&&t.errors===0||o&&i)&&(kh(t,{...i&&{status:"crashed"},errors:t.errors||Number(s||i)}),this.captureSession(t))}_isClientDoneProcessing(t){return new Nc(n=>{let i=0;const s=1,r=setInterval(()=>{this._numProcessing==0?(clearInterval(r),n(!0)):(i+=s,t&&i>=t&&(clearInterval(r),n(!1)))},s)})}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(t,n,i,s){const r=this.getOptions(),o=Object.keys(this._integrations);return!n.integrations&&(o!=null&&o.length)&&(n.integrations=o),this.emit("preprocessEvent",t,n),t.type||s.setLastEventId(t.event_id||n.event_id),Jee(r,t,n,i,this,s).then(a=>{if(a===null)return a;this.emit("postprocessEvent",a,n),a.contexts={trace:nee(i),...a.contexts};const l=Iee(this,i);return a.sdkProcessingMetadata={dynamicSamplingContext:l,...a.sdkProcessingMetadata},a})}_captureEvent(t,n={},i=El(),s=cp()){return Lt&&e4(t)&&He.log(`Captured error event \`${DF(t)[0]||"<unknown>"}\``),this._processEvent(t,n,i,s).then(r=>r.event_id,r=>{Lt&&(r instanceof Yr&&r.logLevel==="log"?He.log(r.message):He.warn(r))})}_processEvent(t,n,i,s){const r=this.getOptions(),{sampleRate:o}=r,a=LF(t),l=e4(t),c=t.type||"error",u=`before send for type \`${c}\``,d=typeof o>"u"?void 0:dee(o);if(l&&typeof d=="number"&&Math.random()>d)return this.recordDroppedEvent("sample_rate","error"),Pb(new Yr(`Discarding event because it's not included in the random sample (sampling rate = ${o})`,"log"));const f=c==="replay_event"?"replay":c;return this._prepareEvent(t,n,i,s).then(h=>{if(h===null)throw this.recordDroppedEvent("event_processor",f),new Yr("An event processor returned `null`, will not send event.","log");if(n.data&&n.data.__sentry__===!0)return h;const p=_te(this,r,h,n);return wte(p,u)}).then(h=>{var U;if(h===null){if(this.recordDroppedEvent("before_send",f),a){const y=1+(t.spans||[]).length;this.recordDroppedEvent("before_send","span",y)}throw new Yr(`${u} returned \`null\`, will not send event.`,"log")}const m=i.getSession()||s.getSession();if(l&&m&&this._updateSessionFromEvent(m,h),a){const b=((U=h.sdkProcessingMetadata)==null?void 0:U.spanCountBeforeProcessing)||0,y=h.spans?h.spans.length:0,w=b-y;w>0&&this.recordDroppedEvent("before_send","span",w)}const p=h.transaction_info;if(a&&p&&h.transaction!==t.transaction){const b="custom";h.transaction_info={...p,source:b}}return this.sendEvent(h,n),h}).then(null,h=>{throw h instanceof Yr?h:(this.captureException(h,{data:{__sentry__:!0},originalException:h}),new Yr(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${h}`))})}_process(t){this._numProcessing++,t.then(n=>(this._numProcessing--,n),n=>(this._numProcessing--,n))}_clearOutcomes(){const t=this._outcomes;return this._outcomes={},Object.entries(t).map(([n,i])=>{const[s,r]=n.split(":");return{reason:s,category:r,quantity:i}})}_flushOutcomes(){Lt&&He.log("Flushing outcomes...");const t=this._clearOutcomes();if(t.length===0){Lt&&He.log("No outcomes to send");return}if(!this._dsn){Lt&&He.log("No dsn provided, will not send outcomes");return}Lt&&He.log("Sending outcomes:",t);const n=bte(t,this._options.tunnel&&E9(this._dsn));this.sendEnvelope(n)}}function wte(e,t){const n=`${t} must return \`null\` or a valid event.`;if(B5(e))return e.then(i=>{if(!Mh(i)&&i!==null)throw new Yr(n);return i},i=>{throw new Yr(`${t} rejected with ${i}`)});if(!Mh(e)&&e!==null)throw new Yr(n);return e}function _te(e,t,n,i){const{beforeSend:s,beforeSendTransaction:r,beforeSendSpan:o}=t;let a=n;if(e4(a)&&s)return s(a,i);if(LF(a)){if(o){const l=o(yte(a));if(l?a=lp(n,Ete(l)):FC(),a.spans){const c=[];for(const u of a.spans){const d=o(u);d?c.push(d):(FC(),c.push(u))}a.spans=c}}if(r){if(a.spans){const l=a.spans.length;a.sdkProcessingMetadata={...n.sdkProcessingMetadata,spanCountBeforeProcessing:l}}return r(a,i)}}return a}function e4(e){return e.type===void 0}function LF(e){return e.type==="transaction"}function Tte(e,t){t.debug===!0&&(Lt?He.enable():gg(()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")})),El().update(t.initialScope);const i=new e(t);return Ite(i),i.init(),i}function Ite(e){El().setClient(e)}function Ste(e){const t=[];function n(){return e===void 0||t.length<e}function i(o){return t.splice(t.indexOf(o),1)[0]||Promise.resolve(void 0)}function s(o){if(!n())return Pb(new Yr("Not adding Promise because buffer limit was reached."));const a=o();return t.indexOf(a)===-1&&t.push(a),a.then(()=>i(a)).then(null,()=>i(a).then(null,()=>{})),a}function r(o){return new Nc((a,l)=>{let c=t.length;if(!c)return a(!0);const u=setTimeout(()=>{o&&o>0&&a(!1)},o);t.forEach(d=>{ud(d).then(()=>{--c||(clearTimeout(u),a(!0))},l)})})}return{$:t,add:s,drain:r}}const xte=60*1e3;function Cte(e,t=Date.now()){const n=parseInt(`${e}`,10);if(!isNaN(n))return n*1e3;const i=Date.parse(`${e}`);return isNaN(i)?xte:i-t}function Ate(e,t){return e[t]||e.all||0}function Mte(e,t,n=Date.now()){return Ate(e,t)>n}function kte(e,{statusCode:t,headers:n},i=Date.now()){const s={...e},r=n==null?void 0:n["x-sentry-rate-limits"],o=n==null?void 0:n["retry-after"];if(r)for(const a of r.trim().split(",")){const[l,c,,,u]=a.split(":",5),d=parseInt(l,10),f=(isNaN(d)?60:d)*1e3;if(!c)s.all=i+f;else for(const h of c.split(";"))h==="metric_bucket"?(!u||u.split(";").includes("custom"))&&(s[h]=i+f):s[h]=i+f}else o?s.all=i+Cte(o,i):t===429&&(s.all=i+60*1e3);return s}const Rte=64;function Dte(e,t,n=Ste(e.bufferSize||Rte)){let i={};const s=o=>n.drain(o);function r(o){const a=[];if(BC(o,(d,f)=>{const h=zC(f);Mte(i,h)?e.recordDroppedEvent("ratelimit_backoff",h):a.push(d)}),a.length===0)return ud({});const l=H5(o[0],a),c=d=>{BC(l,(f,h)=>{e.recordDroppedEvent(d,zC(h))})},u=()=>t({body:Fee(l)}).then(d=>(d.statusCode!==void 0&&(d.statusCode<200||d.statusCode>=300)&&Lt&&He.warn(`Sentry responded with status code ${d.statusCode} to sent event.`),i=kte(i,d),d),d=>{throw c("network_error"),d});return n.add(u).then(d=>d,d=>{if(d instanceof Yr)return Lt&&He.error("Skipped sending event because buffer is full."),c("queue_overflow"),ud({});throw d})}return{send:r,flush:s}}function Lte(e){var t;((t=e.user)==null?void 0:t.ip_address)===void 0&&(e.user={...e.user,ip_address:"{{auto}}"})}function Nte(e){var t;"aggregates"in e?((t=e.attrs)==null?void 0:t.ip_address)===void 0&&(e.attrs={...e.attrs,ip_address:"{{auto}}"}):e.ipAddress===void 0&&(e.ipAddress="{{auto}}")}function Ote(e,t,n=[t],i="npm"){const s=e._metadata||{};s.sdk||(s.sdk={name:`sentry.javascript.${t}`,packages:n.map(r=>({name:`${i}:@sentry/${r}`,version:Yu})),version:Yu}),e._metadata=s}const Pte=100;function dd(e,t){const n=Qi(),i=cp();if(!n)return;const{beforeBreadcrumb:s=null,maxBreadcrumbs:r=Pte}=n.getOptions();if(r<=0)return;const a={timestamp:ap(),...e},l=s?gg(()=>s(a,t)):a;l!==null&&(n.emit&&n.emit("beforeAddBreadcrumb",l,t),i.addBreadcrumb(l,r))}let ZC;const Fte="FunctionToString",qC=new WeakMap,Bte=()=>({name:Fte,setupOnce(){ZC=Function.prototype.toString;try{Function.prototype.toString=function(...e){const t=m9(this),n=qC.has(Qi())&&t!==void 0?t:this;return ZC.apply(n,e)}}catch{}},setup(e){qC.set(e,!0)}}),zte=Bte,Hte=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,"undefined is not an object (evaluating 'a.L')",`can't redefine non-configurable property "solana"`,"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler",/^Non-Error promise rejection captured with value: Object Not Found Matching Id:\d+, MethodName:simulateEvent, ParamCount:\d+$/],Vte="InboundFilters",$te=(e={})=>({name:Vte,processEvent(t,n,i){const s=i.getOptions(),r=Xte(e,s);return jte(t,r)?null:t}}),Gte=$te;function Xte(e={},t={}){return{allowUrls:[...e.allowUrls||[],...t.allowUrls||[]],denyUrls:[...e.denyUrls||[],...t.denyUrls||[]],ignoreErrors:[...e.ignoreErrors||[],...t.ignoreErrors||[],...e.disableErrorDefaults?[]:Hte],ignoreTransactions:[...e.ignoreTransactions||[],...t.ignoreTransactions||[]],ignoreInternal:e.ignoreInternal!==void 0?e.ignoreInternal:!0}}function jte(e,t){return t.ignoreInternal&&qte(e)?(Lt&&He.warn(`Event dropped due to being internal Sentry Error.
Event: ${Gl(e)}`),!0):Yte(e,t.ignoreErrors)?(Lt&&He.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${Gl(e)}`),!0):Jte(e)?(Lt&&He.warn(`Event dropped due to not having an error message, error type or stacktrace.
Event: ${Gl(e)}`),!0):Wte(e,t.ignoreTransactions)?(Lt&&He.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${Gl(e)}`),!0):Kte(e,t.denyUrls)?(Lt&&He.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${Gl(e)}.
Url: ${Fb(e)}`),!0):Zte(e,t.allowUrls)?!1:(Lt&&He.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${Gl(e)}.
Url: ${Fb(e)}`),!0)}function Yte(e,t){return e.type||!t||!t.length?!1:DF(e).some(n=>z5(n,t))}function Wte(e,t){if(e.type!=="transaction"||!t||!t.length)return!1;const n=e.transaction;return n?z5(n,t):!1}function Kte(e,t){if(!(t!=null&&t.length))return!1;const n=Fb(e);return n?z5(n,t):!1}function Zte(e,t){if(!(t!=null&&t.length))return!0;const n=Fb(e);return n?z5(n,t):!0}function qte(e){try{return e.exception.values[0].type==="SentryError"}catch{}return!1}function Qte(e=[]){for(let t=e.length-1;t>=0;t--){const n=e[t];if(n&&n.filename!=="<anonymous>"&&n.filename!=="[native code]")return n.filename||null}return null}function Fb(e){try{let t;try{t=e.exception.values[0].stacktrace.frames}catch{}return t?Qte(t):null}catch{return Lt&&He.error(`Cannot extract url for event ${Gl(e)}`),null}}function Jte(e){var t,n;return e.type||!((n=(t=e.exception)==null?void 0:t.values)!=null&&n.length)?!1:!e.message&&!e.exception.values.some(i=>i.stacktrace||i.type&&i.type!=="Error"||i.value)}function ene(e,t,n=250,i,s,r,o){var l;if(!((l=r.exception)!=null&&l.values)||!o||!ad(o.originalException,Error))return;const a=r.exception.values.length>0?r.exception.values[r.exception.values.length-1]:void 0;a&&(r.exception.values=tne(t4(e,t,s,o.originalException,i,r.exception.values,a,0),n))}function t4(e,t,n,i,s,r,o,a){if(r.length>=n+1)return r;let l=[...r];if(ad(i[s],Error)){QC(o,a);const c=e(t,i[s]),u=l.length;JC(c,s,u,a),l=t4(e,t,n,i[s],s,[c,...l],c,u)}return Array.isArray(i.errors)&&i.errors.forEach((c,u)=>{if(ad(c,Error)){QC(o,a);const d=e(t,c),f=l.length;JC(d,`errors[${u}]`,f,a),l=t4(e,t,n,c,s,[d,...l],d,f)}}),l}function QC(e,t){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,...e.type==="AggregateError"&&{is_exception_group:!0},exception_id:t}}function JC(e,t,n,i){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,type:"chained",source:t,exception_id:n,parent_id:i}}function tne(e,t){return e.map(n=>(n.value&&(n.value=sh(n.value,t)),n))}function NF(e){const t="console";Od(t,e),Pd(t,nne)}function nne(){"console"in Bt&&Lb.forEach(function(e){e in Bt.console&&Vs(Bt.console,e,function(t){return Nb[e]=t,function(...n){Jr("console",{args:n,level:e});const s=Nb[e];s==null||s.apply(Bt.console,n)}})})}function OF(e){return e==="warn"?"warning":["fatal","error","warning","log","info","debug"].includes(e)?e:"log"}const ine="CaptureConsole",sne=(e={})=>{const t=e.levels||Lb,n=e.handled??!0;return{name:ine,setup(i){"console"in Bt&&NF(({args:s,level:r})=>{Qi()!==i||!t.includes(r)||one(s,r,n)})}}},rne=sne;function one(e,t,n){const i={level:OF(t),extra:{arguments:e}};U9(s=>{if(s.addEventProcessor(a=>(a.logger="console",cd(a,{handled:n,type:"console"}),a)),t==="assert"){if(!e[0]){const a=`Assertion failed: ${Ob(e.slice(1)," ")||"console.assert"}`;s.setExtra("arguments",e.slice(1)),$C(a,i)}return}const r=e.find(a=>a instanceof Error);if(r){v9(r,i);return}const o=Ob(e," ");$C(o,i)})}const ane="Dedupe",lne=()=>{let e;return{name:ane,processEvent(t){if(t.type)return t;try{if(une(t,e))return Lt&&He.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return e=t}}},cne=lne;function une(e,t){return t?!!(dne(e,t)||fne(e,t)):!1}function dne(e,t){const n=e.message,i=t.message;return!(!n&&!i||n&&!i||!n&&i||n!==i||!FF(e,t)||!PF(e,t))}function fne(e,t){const n=eA(t),i=eA(e);return!(!n||!i||n.type!==i.type||n.value!==i.value||!FF(e,t)||!PF(e,t))}function PF(e,t){let n=TC(e),i=TC(t);if(!n&&!i)return!0;if(n&&!i||!n&&i||(n=n,i=i,i.length!==n.length))return!1;for(let s=0;s<i.length;s++){const r=i[s],o=n[s];if(r.filename!==o.filename||r.lineno!==o.lineno||r.colno!==o.colno||r.function!==o.function)return!1}return!0}function FF(e,t){let n=e.fingerprint,i=t.fingerprint;if(!n&&!i)return!0;if(n&&!i||!n&&i)return!1;n=n,i=i;try{return n.join("")===i.join("")}catch{return!1}}function eA(e){var t;return((t=e.exception)==null?void 0:t.values)&&e.exception.values[0]}function g8(e){if(!e)return{};const t=e.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};const n=t[6]||"",i=t[8]||"";return{host:t[4],path:t[5],protocol:t[2],search:n,hash:i,relative:t[5]+n+i}}function BF(e){if(e!==void 0)return e>=400&&e<500?"warning":e>=500?"error":void 0}const Bb=Bt;function hne(){return"history"in Bb}function zF(){if(!("fetch"in Bb))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}}function n4(e){return e&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(e.toString())}function gne(){var n;if(typeof EdgeRuntime=="string")return!0;if(!zF())return!1;if(n4(Bb.fetch))return!0;let e=!1;const t=Bb.document;if(t&&typeof t.createElement=="function")try{const i=t.createElement("iframe");i.hidden=!0,t.head.appendChild(i),(n=i.contentWindow)!=null&&n.fetch&&(e=n4(i.contentWindow.fetch)),t.head.removeChild(i)}catch(i){Nd&&He.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",i)}return e}function mne(e,t){const n="fetch";Od(n,e),Pd(n,()=>pne(void 0,t))}function pne(e,t=!1){t&&!gne()||Vs(Bt,"fetch",function(n){return function(...i){const s=new Error,{method:r,url:o}=Une(i),a={args:i,fetchData:{method:r,url:o},startTimestamp:Xa()*1e3,virtualError:s};return Jr("fetch",{...a}),n.apply(Bt,i).then(async l=>(Jr("fetch",{...a,endTimestamp:Xa()*1e3,response:l}),l),l=>{throw Jr("fetch",{...a,endTimestamp:Xa()*1e3,error:l}),u9(l)&&l.stack===void 0&&(l.stack=s.stack,ld(l,"framesToPop",1)),l})}})}function i4(e,t){return!!e&&typeof e=="object"&&!!e[t]}function tA(e){return typeof e=="string"?e:e?i4(e,"url")?e.url:e.toString?e.toString():"":""}function Une(e){if(e.length===0)return{method:"GET",url:""};if(e.length===2){const[n,i]=e;return{url:tA(n),method:i4(i,"method")?String(i.method).toUpperCase():"GET"}}const t=e[0];return{url:tA(t),method:i4(t,"method")?String(t.method).toUpperCase():"GET"}}function bne(){return"npm"}const Rn=Bt;let s4=0;function HF(){return s4>0}function yne(){s4++,setTimeout(()=>{s4--})}function Dh(e,t={}){function n(s){return typeof s=="function"}if(!n(e))return e;try{const s=e.__sentry_wrapped__;if(s)return typeof s=="function"?s:e;if(m9(e))return e}catch{return e}const i=function(...s){try{const r=s.map(o=>Dh(o,t));return e.apply(this,r)}catch(r){throw yne(),U9(o=>{o.addEventProcessor(a=>(t.mechanism&&(K7(a,void 0),cd(a,t.mechanism)),a.extra={...a.extra,arguments:s},a)),v9(r)}),r}};try{for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(i[s]=e[s])}catch{}pF(i,e),ld(e,"__sentry_wrapped__",i);try{Object.getOwnPropertyDescriptor(i,"name").configurable&&Object.defineProperty(i,"name",{get(){return e.name}})}catch{}return i}function w9(e,t){const n=_9(e,t),i={type:Tne(t),value:Ine(t)};return n.length&&(i.stacktrace={frames:n}),i.type===void 0&&i.value===""&&(i.value="Unrecoverable error caught"),i}function Ene(e,t,n,i){const s=Qi(),r=s==null?void 0:s.getOptions().normalizeDepth,o=Mne(t),a={__serialized__:xF(t,r)};if(o)return{exception:{values:[w9(e,o)]},extra:a};const l={exception:{values:[{type:F5(t)?t.constructor.name:i?"UnhandledRejection":"Error",value:Cne(t,{isUnhandledRejection:i})}]},extra:a};if(n){const c=_9(e,n);c.length&&(l.exception.values[0].stacktrace={frames:c})}return l}function m8(e,t){return{exception:{values:[w9(e,t)]}}}function _9(e,t){const n=t.stacktrace||t.stack||"",i=wne(t),s=_ne(t);try{return e(n,i,s)}catch{}return[]}const vne=/Minified React error #\d+;/i;function wne(e){return e&&vne.test(e.message)?1:0}function _ne(e){return typeof e.framesToPop=="number"?e.framesToPop:0}function VF(e){return typeof WebAssembly<"u"&&typeof WebAssembly.Exception<"u"?e instanceof WebAssembly.Exception:!1}function Tne(e){const t=e==null?void 0:e.name;return!t&&VF(e)?e.message&&Array.isArray(e.message)&&e.message.length==2?e.message[0]:"WebAssembly.Exception":t}function Ine(e){const t=e==null?void 0:e.message;return VF(e)?Array.isArray(e.message)&&e.message.length==2?e.message[1]:"wasm exception":t?t.error&&typeof t.error.message=="string"?t.error.message:t:"No error message"}function Sne(e,t,n,i){const s=(n==null?void 0:n.syntheticException)||void 0,r=T9(e,t,s,i);return cd(r),r.level="error",n!=null&&n.event_id&&(r.event_id=n.event_id),ud(r)}function xne(e,t,n="info",i,s){const r=(i==null?void 0:i.syntheticException)||void 0,o=r4(e,t,r,s);return o.level=n,i!=null&&i.event_id&&(o.event_id=i.event_id),ud(o)}function T9(e,t,n,i,s){let r;if(hF(t)&&t.error)return m8(e,t.error);if(SC(t)||DJ(t)){const o=t;if("stack"in t)r=m8(e,t);else{const a=o.name||(SC(o)?"DOMError":"DOMException"),l=o.message?`${a}: ${o.message}`:a;r=r4(e,l,n,i),K7(r,l)}return"code"in o&&(r.tags={...r.tags,"DOMException.code":`${o.code}`}),r}return u9(t)?m8(e,t):Mh(t)||F5(t)?(r=Ene(e,t,n,s),cd(r,{synthetic:!0}),r):(r=r4(e,t,n,i),K7(r,`${t}`),cd(r,{synthetic:!0}),r)}function r4(e,t,n,i){const s={};if(i&&n){const r=_9(e,n);r.length&&(s.exception={values:[{value:t,stacktrace:{frames:r}}]}),cd(s,{synthetic:!0})}if(d9(t)){const{__sentry_template_string__:r,__sentry_template_values__:o}=t;return s.logentry={message:r,params:o},s}return s.message=t,s}function Cne(e,{isUnhandledRejection:t}){const n=HJ(e),i=t?"promise rejection":"exception";return hF(e)?`Event \`ErrorEvent\` captured as ${i} with message \`${e.message}\``:F5(e)?`Event \`${Ane(e)}\` (type=${e.type}) captured as ${i}`:`Object captured as ${i} with keys: ${n}`}function Ane(e){try{const t=Object.getPrototypeOf(e);return t?t.constructor.name:void 0}catch{}}function Mne(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){const n=e[t];if(n instanceof Error)return n}}class kne extends vte{constructor(t){const n={parentSpanIsAlwaysRootSpan:!0,...t},i=Rn.SENTRY_SDK_SOURCE||bne();Ote(n,"browser",["browser"],i),super(n),n.sendClientReports&&Rn.document&&Rn.document.addEventListener("visibilitychange",()=>{Rn.document.visibilityState==="hidden"&&this._flushOutcomes()}),this._options.sendDefaultPii&&(this.on("postprocessEvent",Lte),this.on("beforeSendSession",Nte))}eventFromException(t,n){return Sne(this._options.stackParser,t,n,this._options.attachStacktrace)}eventFromMessage(t,n="info",i){return xne(this._options.stackParser,t,n,i,this._options.attachStacktrace)}_prepareEvent(t,n,i,s){return t.platform=t.platform||"javascript",super._prepareEvent(t,n,i,s)}}const Rne=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,vs=Bt,Dne=1e3;let nA,o4,a4;function Lne(e){const t="dom";Od(t,e),Pd(t,Nne)}function Nne(){if(!vs.document)return;const e=Jr.bind(null,"dom"),t=iA(e,!0);vs.document.addEventListener("click",t,!1),vs.document.addEventListener("keypress",t,!1),["EventTarget","Node"].forEach(n=>{var r,o;const s=(r=vs[n])==null?void 0:r.prototype;(o=s==null?void 0:s.hasOwnProperty)!=null&&o.call(s,"addEventListener")&&(Vs(s,"addEventListener",function(a){return function(l,c,u){if(l==="click"||l=="keypress")try{const d=this.__sentry_instrumentation_handlers__=this.__sentry_instrumentation_handlers__||{},f=d[l]=d[l]||{refCount:0};if(!f.handler){const h=iA(e);f.handler=h,a.call(this,l,h,u)}f.refCount++}catch{}return a.call(this,l,c,u)}}),Vs(s,"removeEventListener",function(a){return function(l,c,u){if(l==="click"||l=="keypress")try{const d=this.__sentry_instrumentation_handlers__||{},f=d[l];f&&(f.refCount--,f.refCount<=0&&(a.call(this,l,f.handler,u),f.handler=void 0,delete d[l]),Object.keys(d).length===0&&delete this.__sentry_instrumentation_handlers__)}catch{}return a.call(this,l,c,u)}}))})}function One(e){if(e.type!==o4)return!1;try{if(!e.target||e.target._sentryId!==a4)return!1}catch{}return!0}function Pne(e,t){return e!=="keypress"?!1:t!=null&&t.tagName?!(t.tagName==="INPUT"||t.tagName==="TEXTAREA"||t.isContentEditable):!0}function iA(e,t=!1){return n=>{if(!n||n._sentryCaptured)return;const i=Fne(n);if(Pne(n.type,i))return;ld(n,"_sentryCaptured",!0),i&&!i._sentryId&&ld(i,"_sentryId",_r());const s=n.type==="keypress"?"input":n.type;One(n)||(e({event:n,name:s,global:t}),o4=n.type,a4=i?i._sentryId:void 0),clearTimeout(nA),nA=vs.setTimeout(()=>{a4=void 0,o4=void 0},Dne)}}function Fne(e){try{return e.target}catch{return null}}let SU;function $F(e){const t="history";Od(t,e),Pd(t,Bne)}function Bne(){if(vs.addEventListener("popstate",()=>{const t=vs.location.href,n=SU;if(SU=t,n===t)return;Jr("history",{from:n,to:t})}),!hne())return;function e(t){return function(...n){const i=n.length>2?n[2]:void 0;if(i){const s=SU,r=String(i);if(SU=r,s===r)return;Jr("history",{from:s,to:r})}return t.apply(this,n)}}Vs(vs.history,"pushState",e),Vs(vs.history,"replaceState",e)}const I2={};function zne(e){const t=I2[e];if(t)return t;let n=vs[e];if(n4(n))return I2[e]=n.bind(vs);const i=vs.document;if(i&&typeof i.createElement=="function")try{const s=i.createElement("iframe");s.hidden=!0,i.head.appendChild(s);const r=s.contentWindow;r!=null&&r[e]&&(n=r[e]),i.head.removeChild(s)}catch(s){Rne&&He.warn(`Could not create sandbox iframe for ${e} check, bailing to window.${e}: `,s)}return n&&(I2[e]=n.bind(vs))}function sA(e){I2[e]=void 0}const k1="__sentry_xhr_v3__";function Hne(e){const t="xhr";Od(t,e),Pd(t,Vne)}function Vne(){if(!vs.XMLHttpRequest)return;const e=XMLHttpRequest.prototype;e.open=new Proxy(e.open,{apply(t,n,i){const s=new Error,r=Xa()*1e3,o=Ga(i[0])?i[0].toUpperCase():void 0,a=$ne(i[1]);if(!o||!a)return t.apply(n,i);n[k1]={method:o,url:a,request_headers:{}},o==="POST"&&a.match(/sentry_key/)&&(n.__sentry_own_request__=!0);const l=()=>{const c=n[k1];if(c&&n.readyState===4){try{c.status_code=n.status}catch{}const u={endTimestamp:Xa()*1e3,startTimestamp:r,xhr:n,virtualError:s};Jr("xhr",u)}};return"onreadystatechange"in n&&typeof n.onreadystatechange=="function"?n.onreadystatechange=new Proxy(n.onreadystatechange,{apply(c,u,d){return l(),c.apply(u,d)}}):n.addEventListener("readystatechange",l),n.setRequestHeader=new Proxy(n.setRequestHeader,{apply(c,u,d){const[f,h]=d,m=u[k1];return m&&Ga(f)&&Ga(h)&&(m.request_headers[f.toLowerCase()]=h),c.apply(u,d)}}),t.apply(n,i)}}),e.send=new Proxy(e.send,{apply(t,n,i){const s=n[k1];if(!s)return t.apply(n,i);i[0]!==void 0&&(s.body=i[0]);const r={startTimestamp:Xa()*1e3,xhr:n};return Jr("xhr",r),t.apply(n,i)}})}function $ne(e){if(Ga(e))return e;try{return e.toString()}catch{}}function Gne(e,t=zne("fetch")){let n=0,i=0;function s(r){const o=r.body.length;n+=o,i++;const a={body:r.body,method:"POST",referrerPolicy:"strict-origin",headers:e.headers,keepalive:n<=6e4&&i<15,...e.fetchOptions};if(!t)return sA("fetch"),Pb("No fetch implementation available");try{return t(e.url,a).then(l=>(n-=o,i--,{statusCode:l.status,headers:{"x-sentry-rate-limits":l.headers.get("X-Sentry-Rate-Limits"),"retry-after":l.headers.get("Retry-After")}}))}catch(l){return sA("fetch"),n-=o,i--,Pb(l)}}return Dte(e,s)}const Xne=30,jne=50;function l4(e,t,n,i){const s={filename:e,function:t==="<anonymous>"?od:t,in_app:!0};return n!==void 0&&(s.lineno=n),i!==void 0&&(s.colno=i),s}const Yne=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,Wne=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,Kne=/\((\S*)(?::(\d+))(?::(\d+))\)/,Zne=e=>{const t=Yne.exec(e);if(t){const[,i,s,r]=t;return l4(i,od,+s,+r)}const n=Wne.exec(e);if(n){if(n[2]&&n[2].indexOf("eval")===0){const o=Kne.exec(n[2]);o&&(n[2]=o[1],n[3]=o[2],n[4]=o[3])}const[s,r]=GF(n[1]||od,n[2]);return l4(r,s,n[3]?+n[3]:void 0,n[4]?+n[4]:void 0)}},qne=[Xne,Zne],Qne=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,Jne=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,eie=e=>{const t=Qne.exec(e);if(t){if(t[3]&&t[3].indexOf(" > eval")>-1){const r=Jne.exec(t[3]);r&&(t[1]=t[1]||"eval",t[3]=r[1],t[4]=r[2],t[5]="")}let i=t[3],s=t[1]||od;return[s,i]=GF(s,i),l4(i,s,t[4]?+t[4]:void 0,t[5]?+t[5]:void 0)}},tie=[jne,eie],nie=[qne,tie],iie=dF(...nie),GF=(e,t)=>{const n=e.indexOf("safari-extension")!==-1,i=e.indexOf("safari-web-extension")!==-1;return n||i?[e.indexOf("@")!==-1?e.split("@")[0]:od,n?`safari-extension:${t}`:`safari-web-extension:${t}`]:[e,t]},nm=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,xU=1024,sie="Breadcrumbs",rie=(e={})=>{const t={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...e};return{name:sie,setup(n){t.console&&NF(cie(n)),t.dom&&Lne(lie(n,t.dom)),t.xhr&&Hne(uie(n)),t.fetch&&mne(die(n)),t.history&&$F(fie(n)),t.sentry&&n.on("beforeSendEvent",aie(n))}}},oie=rie;function aie(e){return function(n){Qi()===e&&dd({category:`sentry.${n.type==="transaction"?"transaction":"event"}`,event_id:n.event_id,level:n.level,message:Gl(n)},{event:n})}}function lie(e,t){return function(i){if(Qi()!==e)return;let s,r,o=typeof t=="object"?t.serializeAttribute:void 0,a=typeof t=="object"&&typeof t.maxStringLength=="number"?t.maxStringLength:void 0;a&&a>xU&&(nm&&He.warn(`\`dom.maxStringLength\` cannot exceed ${xU}, but a value of ${a} was configured. Sentry will use ${xU} instead.`),a=xU),typeof o=="string"&&(o=[o]);try{const c=i.event,u=hie(c)?c.target:c;s=mF(u,{keyAttrs:o,maxStringLength:a}),r=BJ(u)}catch{s="<unknown>"}if(s.length===0)return;const l={category:`ui.${i.name}`,message:s};r&&(l.data={"ui.component_name":r}),dd(l,{event:i.event,name:i.name,global:i.global})}}function cie(e){return function(n){if(Qi()!==e)return;const i={category:"console",data:{arguments:n.args,logger:"console"},level:OF(n.level),message:Ob(n.args," ")};if(n.level==="assert")if(n.args[0]===!1)i.message=`Assertion failed: ${Ob(n.args.slice(1)," ")||"console.assert"}`,i.data.arguments=n.args.slice(1);else return;dd(i,{input:n.args,level:n.level})}}function uie(e){return function(n){if(Qi()!==e)return;const{startTimestamp:i,endTimestamp:s}=n,r=n.xhr[k1];if(!i||!s||!r)return;const{method:o,url:a,status_code:l,body:c}=r,u={method:o,url:a,status_code:l},d={xhr:n.xhr,input:c,startTimestamp:i,endTimestamp:s},f=BF(l);dd({category:"xhr",data:u,type:"http",level:f},d)}}function die(e){return function(n){if(Qi()!==e)return;const{startTimestamp:i,endTimestamp:s}=n;if(!s||n.fetchData.url.match(/sentry_key/)&&n.fetchData.method==="POST")return;const r={method:n.fetchData.method,url:n.fetchData.url};if(n.error){const o={data:n.error,input:n.args,startTimestamp:i,endTimestamp:s};dd({category:"fetch",data:r,level:"error",type:"http"},o)}else{const o=n.response;r.request_body_size=n.fetchData.request_body_size,r.response_body_size=n.fetchData.response_body_size,r.status_code=o==null?void 0:o.status;const a={input:n.args,response:o,startTimestamp:i,endTimestamp:s},l=BF(r.status_code);dd({category:"fetch",data:r,type:"http",level:l},a)}}}function fie(e){return function(n){if(Qi()!==e)return;let i=n.from,s=n.to;const r=g8(Rn.location.href);let o=i?g8(i):void 0;const a=g8(s);o!=null&&o.path||(o=r),r.protocol===a.protocol&&r.host===a.host&&(s=a.relative),r.protocol===o.protocol&&r.host===o.host&&(i=o.relative),dd({category:"navigation",data:{from:i,to:s}})}}function hie(e){return!!e&&!!e.target}const gie=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],mie="BrowserApiErrors",pie=(e={})=>{const t={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...e};return{name:mie,setupOnce(){t.setTimeout&&Vs(Rn,"setTimeout",rA),t.setInterval&&Vs(Rn,"setInterval",rA),t.requestAnimationFrame&&Vs(Rn,"requestAnimationFrame",bie),t.XMLHttpRequest&&"XMLHttpRequest"in Rn&&Vs(XMLHttpRequest.prototype,"send",yie);const n=t.eventTarget;n&&(Array.isArray(n)?n:gie).forEach(Eie)}}},Uie=pie;function rA(e){return function(...t){const n=t[0];return t[0]=Dh(n,{mechanism:{data:{function:Lc(e)},handled:!1,type:"instrument"}}),e.apply(this,t)}}function bie(e){return function(t){return e.apply(this,[Dh(t,{mechanism:{data:{function:"requestAnimationFrame",handler:Lc(e)},handled:!1,type:"instrument"}})])}}function yie(e){return function(...t){const n=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(s=>{s in n&&typeof n[s]=="function"&&Vs(n,s,function(r){const o={mechanism:{data:{function:s,handler:Lc(r)},handled:!1,type:"instrument"}},a=m9(r);return a&&(o.mechanism.data.handler=Lc(a)),Dh(r,o)})}),e.apply(this,t)}}function Eie(e){var i,s;const n=(i=Rn[e])==null?void 0:i.prototype;(s=n==null?void 0:n.hasOwnProperty)!=null&&s.call(n,"addEventListener")&&(Vs(n,"addEventListener",function(r){return function(o,a,l){try{vie(a)&&(a.handleEvent=Dh(a.handleEvent,{mechanism:{data:{function:"handleEvent",handler:Lc(a),target:e},handled:!1,type:"instrument"}}))}catch{}return r.apply(this,[o,Dh(a,{mechanism:{data:{function:"addEventListener",handler:Lc(a),target:e},handled:!1,type:"instrument"}}),l])}}),Vs(n,"removeEventListener",function(r){return function(o,a,l){try{const c=a.__sentry_wrapped__;c&&r.call(this,o,c,l)}catch{}return r.call(this,o,a,l)}}))}function vie(e){return typeof e.handleEvent=="function"}const wie=()=>({name:"BrowserSession",setupOnce(){if(typeof Rn.document>"u"){nm&&He.warn("Using the `browserSessionIntegration` in non-browser environments is not supported.");return}GC({ignoreDuration:!0}),XC(),$F(({from:e,to:t})=>{e!==void 0&&e!==t&&(GC({ignoreDuration:!0}),XC())})}}),_ie="GlobalHandlers",Tie=(e={})=>{const t={onerror:!0,onunhandledrejection:!0,...e};return{name:_ie,setupOnce(){Error.stackTraceLimit=50},setup(n){t.onerror&&(Sie(n),oA("onerror")),t.onunhandledrejection&&(xie(n),oA("onunhandledrejection"))}}},Iie=Tie;function Sie(e){AJ(t=>{const{stackParser:n,attachStacktrace:i}=XF();if(Qi()!==e||HF())return;const{msg:s,url:r,line:o,column:a,error:l}=t,c=Mie(T9(n,l||s,void 0,i,!1),r,o,a);c.level="error",AF(c,{originalException:l,mechanism:{handled:!1,type:"onerror"}})})}function xie(e){kJ(t=>{const{stackParser:n,attachStacktrace:i}=XF();if(Qi()!==e||HF())return;const s=Cie(t),r=f9(s)?Aie(s):T9(n,s,void 0,i,!0);r.level="error",AF(r,{originalException:s,mechanism:{handled:!1,type:"onunhandledrejection"}})})}function Cie(e){if(f9(e))return e;try{if("reason"in e)return e.reason;if("detail"in e&&"reason"in e.detail)return e.detail.reason}catch{}return e}function Aie(e){return{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(e)}`}]}}}function Mie(e,t,n,i){const s=e.exception=e.exception||{},r=s.values=s.values||[],o=r[0]=r[0]||{},a=o.stacktrace=o.stacktrace||{},l=a.frames=a.frames||[],c=i,u=n,d=Ga(t)&&t.length>0?t:g9();return l.length===0&&l.push({colno:c,filename:d,function:od,in_app:!0,lineno:u}),e}function oA(e){nm&&He.log(`Global Handler attached: ${e}`)}function XF(){const e=Qi();return(e==null?void 0:e.getOptions())||{stackParser:()=>[],attachStacktrace:!1}}const kie=()=>({name:"HttpContext",preprocessEvent(e){var o,a;if(!Rn.navigator&&!Rn.location&&!Rn.document)return;const t=((o=e.request)==null?void 0:o.url)||g9(),{referrer:n}=Rn.document||{},{userAgent:i}=Rn.navigator||{},s={...(a=e.request)==null?void 0:a.headers,...n&&{Referer:n},...i&&{"User-Agent":i}},r={...e.request,...t&&{url:t},headers:s};e.request=r}}),Rie="cause",Die=5,Lie="LinkedErrors",Nie=(e={})=>{const t=e.limit||Die,n=e.key||Rie;return{name:Lie,preprocessEvent(i,s,r){const o=r.getOptions();ene(w9,o.stackParser,o.maxValueLength,n,t,i,s)}}},Oie=Nie;function Pie(e){return[Gte(),zte(),Uie(),oie(),Iie(),Oie(),cne(),kie(),wie()]}function Fie(e={}){var n;return{...{defaultIntegrations:Pie(),release:typeof __SENTRY_RELEASE__=="string"?__SENTRY_RELEASE__:(n=Rn.SENTRY_RELEASE)==null?void 0:n.id,sendClientReports:!0},...Bie(e)}}function Bie(e){const t={};for(const n of Object.getOwnPropertyNames(e)){const i=n;e[i]!==void 0&&(t[i]=e[i])}return t}function zie(){var l;const e=typeof Rn.window<"u"&&Rn;if(!e)return!1;const t=e.chrome?"chrome":"browser",n=e[t],i=(l=n==null?void 0:n.runtime)==null?void 0:l.id,s=g9()||"",r=["chrome-extension:","moz-extension:","ms-browser-extension:","safari-web-extension:"],o=!!i&&Rn===Rn.top&&r.some(c=>s.startsWith(`${c}//`)),a=typeof e.nw<"u";return!!i&&!o&&!a}function Hie(e={}){const t=Fie(e);if(!t.skipBrowserExtensionCheck&&zie()){nm&&gg(()=>{console.error("[Sentry] You cannot run Sentry this way in a browser extension, check: https://docs.sentry.io/platforms/javascript/best-practices/browser-extensions/")});return}nm&&!zF()&&He.warn("No Fetch API detected. The Sentry SDK requires a Fetch API compatible environment to send events. Please add a Fetch API polyfill.");const n={...t,stackParser:xJ(t.stackParser||iie),integrations:pte(t),transport:t.transport||Gne};return Tte(kne,n)}function Vie(){const e=Error.prepareStackTrace;try{let t=[];return Error.prepareStackTrace=(n,i)=>{const s=i.slice(1);return t=s,s},new Error().stack,t}finally{Error.prepareStackTrace=e}}var $ie={};const jF={"excalidraw.com":"production","staging.excalidraw.com":"staging","vercel.app":"staging"},Gie=$ie.VITE_APP_DISABLE_SENTRY==="true",p8=!Gie&&Object.keys(jF).find(e=>window.location.hostname.indexOf(e)>=0);Hie({dsn:p8?"https://7bfc596a5bf945eda6b660d3015a5460@sentry.io/5179260":void 0,environment:p8?jF[p8]:void 0,release:"4e0441eeb413ad7234f65cbb8fbb397bc715ff46",ignoreErrors:["undefined is not an object (evaluating 'window.__pad.performLoop')","InvalidStateError: Failed to execute 'transaction' on 'IDBDatabase': The database connection is closing.",/(Failed to fetch|(fetch|loading) dynamically imported module)/i,/QuotaExceededError: (The quota has been exceeded|.*setItem.*Storage)/i,"Internal error opening backing store for indexedDB.open"],integrations:[rne({levels:["error"]})],beforeSend(e){var t;return(t=e.request)!=null&&t.url&&(e.request.url=e.request.url.replace(/#.*$/,"")),e.exception||(e.exception={values:[{type:"ConsoleError",value:e.message??"Unknown error",stacktrace:{frames:Vie().slice(1).filter(n=>{var i;return n.getFileName()&&!((i=n.getFileName())!=null&&i.includes("@sentry_browser.js"))}).map(n=>{var i;return{filename:n.getFileName()??void 0,function:n.getFunctionName()??void 0,in_app:!(((i=n.getFileName())==null?void 0:i.includes("node_modules"))??!1),lineno:n.getLineNumber()??void 0,colno:n.getColumnNumber()??void 0}})},mechanism:{type:"instrument",handled:!0,data:{function:"console.error",handler:"Sentry.beforeSend"}}}]}),e}});class Xie{constructor(t){F(this,"content",[]);this.scoreFunction=t}sinkDown(t){const n=this.content[t],i=this.scoreFunction(n);for(;t>0;){const s=(t+1>>1)-1,r=this.content[s];if(i<this.scoreFunction(r))this.content[t]=r,t=s;else break}this.content[t]=n}bubbleUp(t){const n=this.content.length,i=this.content[t],s=this.scoreFunction(i);for(;;){const r=(t+1<<1)-1,o=r+1;let a=t,l=s;if(r<n){const c=this.scoreFunction(this.content[r]);c<l&&(a=r,l=c)}if(o<n&&this.scoreFunction(this.content[o])<l&&(a=o),a===t)break;this.content[t]=this.content[a],t=a}this.content[t]=i}push(t){this.content.push(t),this.sinkDown(this.content.length-1)}pop(){if(this.content.length===0)return null;const t=this.content[0],n=this.content.pop();return this.content.length>0&&(this.content[0]=n,this.bubbleUp(0)),t}remove(t){if(this.content.length===0)return;const n=this.content.indexOf(t),i=this.content.pop();n<this.content.length&&(this.content[n]=i,this.scoreFunction(i)<this.scoreFunction(t)?this.sinkDown(n):this.bubbleUp(n))}size(){return this.content.length}rescoreElement(t){this.sinkDown(this.content.indexOf(t))}}const jie="#ffffff",Yie="#000000",Wie=["#f8f9fa","#f1f3f5","#e9ecef","#dee2e6","#ced4da","#adb5bd","#868e96","#495057","#343a40","#212529"],Kie=["#fff5f5","#ffe3e3","#ffc9c9","#ffa8a8","#ff8787","#ff6b6b","#fa5252","#f03e3e","#e03131","#c92a2a"],Zie=["#fff0f6","#ffdeeb","#fcc2d7","#faa2c1","#f783ac","#f06595","#e64980","#d6336c","#c2255c","#a61e4d"],qie=["#f8f0fc","#f3d9fa","#eebefa","#e599f7","#da77f2","#cc5de8","#be4bdb","#ae3ec9","#9c36b5","#862e9c"],Qie=["#f3f0ff","#e5dbff","#d0bfff","#b197fc","#9775fa","#845ef7","#7950f2","#7048e8","#6741d9","#5f3dc4"],Jie=["#edf2ff","#dbe4ff","#bac8ff","#91a7ff","#748ffc","#5c7cfa","#4c6ef5","#4263eb","#3b5bdb","#364fc7"],ese=["#e7f5ff","#d0ebff","#a5d8ff","#74c0fc","#4dabf7","#339af0","#228be6","#1c7ed6","#1971c2","#1864ab"],tse=["#e3fafc","#c5f6fa","#99e9f2","#66d9e8","#3bc9db","#22b8cf","#15aabf","#1098ad","#0c8599","#0b7285"],nse=["#e6fcf5","#c3fae8","#96f2d7","#63e6be","#38d9a9","#20c997","#12b886","#0ca678","#099268","#087f5b"],ise=["#ebfbee","#d3f9d8","#b2f2bb","#8ce99a","#69db7c","#51cf66","#40c057","#37b24d","#2f9e44","#2b8a3e"],sse=["#f4fce3","#e9fac8","#d8f5a2","#c0eb75","#a9e34b","#94d82d","#82c91e","#74b816","#66a80f","#5c940d"],rse=["#fff9db","#fff3bf","#ffec99","#ffe066","#ffd43b","#fcc419","#fab005","#f59f00","#f08c00","#e67700"],ose=["#fff4e6","#ffe8cc","#ffd8a8","#ffc078","#ffa94d","#ff922b","#fd7e14","#f76707","#e8590c","#d9480f"],Ui={white:jie,black:Yie,gray:Wie,red:Kie,pink:Zie,grape:qie,violet:Qie,indigo:Jie,blue:ese,cyan:tse,teal:nse,green:ise,lime:sse,yellow:rse,orange:ose},c4=240,ase=(e,t)=>t.reduce((n,i)=>(i in e&&(n[i]=e[i]),n),{}),lse=5,bf=5,cse=4,R1=4,D1=1,Or=[0,2,4,6,8],Pr=(e,t)=>t.map(n=>Ui[e][n]),Ge={transparent:"transparent",black:"#1e1e1e",white:"#ffffff",gray:Pr("gray",Or),red:Pr("red",Or),pink:Pr("pink",Or),grape:Pr("grape",Or),violet:Pr("violet",Or),blue:Pr("blue",Or),cyan:Pr("cyan",Or),teal:Pr("teal",Or),green:Pr("green",Or),yellow:Pr("yellow",Or),orange:Pr("orange",Or),bronze:["#f8f1ee","#eaddd7","#d2bab0","#a18072","#846358"]},YF=ase(Ge,["cyan","blue","violet","grape","pink","green","teal","yellow","orange","red"]),WF=[Ge.black,Ge.red[R1],Ge.green[R1],Ge.blue[R1],Ge.yellow[R1]],KF=[Ge.transparent,Ge.red[D1],Ge.green[D1],Ge.blue[D1],Ge.yellow[D1]],ZF=[Ge.white,"#f8f9fa","#f5faff","#fffce8","#fdf8f6"],use={transparent:Ge.transparent,white:Ge.white,gray:Ge.gray,black:Ge.black,bronze:Ge.bronze,...YF},dse={transparent:Ge.transparent,white:Ge.white,gray:Ge.gray,black:Ge.black,bronze:Ge.bronze,...YF},fse=e=>[Ge.cyan[e],Ge.blue[e],Ge.violet[e],Ge.grape[e],Ge.pink[e],Ge.green[e],Ge.teal[e],Ge.yellow[e],Ge.orange[e],Ge.red[e]],hse=(e,t,n)=>`#${((1<<24)+(e<<16)+(t<<8)+n).toString(16).slice(1)}`,so=/Mac|iPod|iPhone|iPad/.test(navigator.platform),qF=/^Win/.test(navigator.platform),QF=/\b(android)\b/i.test(navigator.userAgent),im=typeof window<"u"&&"netscape"in window&&navigator.userAgent.indexOf("rv:")>1&&navigator.userAgent.indexOf("Gecko")>1,gse=navigator.userAgent.indexOf("Chrome")!==-1,mse=!gse&&navigator.userAgent.indexOf("Safari")!==-1,I9=/iPad|iPhone/i.test(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document,pse=()=>{var e,t;return((t=(e=navigator.brave)==null?void 0:e.isBrave)==null?void 0:t.name)==="isBrave"},u4=typeof window<"u"&&"ResizeObserver"in window,bc="Excalidraw",Use=36,JF=10,aA=20,S2=8,bse=5,lA=1,yse=30,Fs=Math.PI/12,Ese="red",xt={TEXT:"text",CROSSHAIR:"crosshair",GRABBING:"grabbing",GRAB:"grab",POINTER:"pointer",MOVE:"move",AUTO:""},Fl={MAIN:0,WHEEL:1,SECONDARY:2,TOUCH:-1,ERASER:5},Eu={enabled:"all",disabled:"none",inheritFromUI:"var(--ui-pointerEvents)"};var te=(e=>(e.COPY="copy",e.PASTE="paste",e.CUT="cut",e.KEYDOWN="keydown",e.KEYUP="keyup",e.MOUSE_MOVE="mousemove",e.RESIZE="resize",e.UNLOAD="unload",e.FOCUS="focus",e.BLUR="blur",e.DRAG_OVER="dragover",e.DROP="drop",e.GESTURE_END="gestureend",e.BEFORE_UNLOAD="beforeunload",e.GESTURE_START="gesturestart",e.GESTURE_CHANGE="gesturechange",e.POINTER_MOVE="pointermove",e.POINTER_DOWN="pointerdown",e.POINTER_UP="pointerup",e.STATE_CHANGE="statechange",e.WHEEL="wheel",e.TOUCH_START="touchstart",e.TOUCH_END="touchend",e.HASHCHANGE="hashchange",e.VISIBILITY_CHANGE="visibilitychange",e.SCROLL="scroll",e.EXCALIDRAW_LINK="excalidraw-link",e.MENU_ITEM_SELECT="menu.itemSelect",e.MESSAGE="message",e.FULLSCREENCHANGE="fullscreenchange",e))(te||{});const CU={UNSTARTED:-1,ENDED:0,PLAYING:1,PAUSED:2,BUFFERING:3,CUED:5},eB={TEST:"test",DEVELOPMENT:"development"},Zs={SIDEBAR:"sidebar",SHAPE_ACTIONS_MENU:"App-menu__left",ZOOM_ACTIONS:"zoom-actions",SEARCH_MENU_INPUT_WRAPPER:"layer-ui__search-inputWrapper",CONVERT_ELEMENT_TYPE_POPUP:"ConvertElementTypePopup",SHAPE_ACTIONS_THEME_SCOPE:"shape-actions-theme-scope"},Ff="Xiaolai",sm="Segoe UI Emoji",et={Virgil:1,Helvetica:2,Cascadia:3,Excalifont:5,Nunito:6,"Lilita One":7,"Comic Shanns":8,"Liberation Sans":9,Assistant:10},tB="sans-serif",nB="monospace",vse={[tB]:998,[nB]:999},Bf={[Ff]:100,...vse,[sm]:1e3};function wse(e){switch(e){case et.Cascadia:case et["Comic Shanns"]:return nB;default:return tB}}const iB=e=>{const t=wse(e);switch(e){case et.Excalifont:return[Ff,t,sm];default:return[t,sm]}},ke={LIGHT:"light",DARK:"dark"},Ft={strokeColor:"#bbb",strokeWidth:2,strokeStyle:"solid",fillStyle:"solid",roughness:0,roundness:null,backgroundColor:"transparent",radius:8,nameOffsetY:3,nameColorLightTheme:"#999999",nameColorDarkTheme:"#7a7a7a",nameFontSize:14,nameLineHeight:1.25},S9=1,vl=20,tu=et.Excalifont,up="left",zb="top",sB="{version}",fd=2,Hb=2*fd,_se=1e-5,cA=2*Hb-_se,AU="#ffffff",Tse="#1e1e1e",Ise="#a2f1a6",Vb=20,rB=5,Lh={svg:"image/svg+xml",png:"image/png",jpg:"image/jpeg",gif:"image/gif",webp:"image/webp",bmp:"image/bmp",ico:"image/x-icon",avif:"image/avif",jfif:"image/jfif"},Sse={text:"text/plain",html:"text/html",json:"application/json",excalidraw:"application/vnd.excalidraw+json",excalidrawlib:"application/vnd.excalidrawlib+json",excalidrawlibIds:"application/vnd.excalidrawlib.ids+json"},_e={...Sse,"excalidraw.svg":"image/svg+xml","excalidraw.png":"image/png",binary:"application/octet-stream",...Lh},xse=[_e.text,_e.html,...Object.values(Lh)],U8={png:"png",svg:"svg",clipboard:"clipboard"},Tr={excalidraw:"excalidraw",excalidrawClipboard:"excalidraw/clipboard",excalidrawLibrary:"excalidrawlib",excalidrawClipboardWithAPI:"excalidraw-api/clipboard"},x9=()=>window.EXCALIDRAW_EXPORT_SOURCE||window.location.origin,Cse=500,Ase=300,Mse=500,kse=3e4,Rse=100,V5=.1,C9=.1,A9=30,Dse=300,uA=6e4,dA=3e3,M9="invert(93%) hue-rotate(180deg)",d4={addLibrary:"addLibrary"},f4={addLibrary:"addLibrary"},fA={canvasActions:{changeViewBackgroundColor:!0,clearCanvas:!0,export:{saveFileToDisk:!0},loadScene:!0,saveToActiveFile:!0,toggleTheme:null,saveAsImage:!0}},oB=599,Lse=1e3,Nse=500,Ose=oB+1,Pse=1400,aB=1440,Fse=1229,i1=2,k9=[1,2,3],pg=10,Bse=1440,hA=4*1024*1024,it="http://www.w3.org/2000/svg",zse=`<?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`,lB=128,$5={excalidraw:2,excalidrawLibrary:2},Vn=5,Hse=.7,Vse=11,Gs={TOP:"top",MIDDLE:"middle",BOTTOM:"bottom"},rm={LEFT:"left",CENTER:"center",RIGHT:"right"},$se=20,b8=.25,Gse=32,yn={LEGACY:1,PROPORTIONAL_RADIUS:2,ADAPTIVE_RADIUS:3},cB={artist:1,cartoonist:2},y8={thin:1,bold:2,extraBold:4},mn={strokeColor:Ge.black,backgroundColor:Ge.transparent,fillStyle:"solid",strokeWidth:2,strokeStyle:"solid",roughness:cB.artist,opacity:100,locked:!1},$b="library",Wu="search",Ir={name:"default",defaultTab:$b},uB=new Set(["iframe","embeddable","image"]),qn={selection:"selection",rectangle:"rectangle",diamond:"diamond",ellipse:"ellipse",text:"text",image:"image",eraser:"eraser",frame:"frame",magicframe:"magicframe",laser:"laser"},h0={MERMAID_TO_EXCALIDRAW:"mermaid-to-excalidraw",PUBLISH_LIBRARY:"publish-library-data"},dB="Untitled",zf={generalStats:1,elementProperties:2},ur=1,ui={sharp:"sharp",round:"round",elbow:"elbow"},fB=.3,Gb="element";var Ru=(e=>(e.ACTIVE="active",e.AWAY="away",e.IDLE="idle",e))(Ru||{});const Xse=20,jse=35,dp={background:"var(--mobile-action-button-bg)"},Nh={[et.Excalifont]:{metrics:{unitsPerEm:1e3,ascender:886,descender:-374,lineHeight:1.25}},[et.Nunito]:{metrics:{unitsPerEm:1e3,ascender:1011,descender:-353,lineHeight:1.25}},[et["Lilita One"]]:{metrics:{unitsPerEm:1e3,ascender:923,descender:-220,lineHeight:1.15}},[et["Comic Shanns"]]:{metrics:{unitsPerEm:1e3,ascender:750,descender:-250,lineHeight:1.25}},[et.Virgil]:{metrics:{unitsPerEm:1e3,ascender:886,descender:-374,lineHeight:1.25},deprecated:!0},[et.Helvetica]:{metrics:{unitsPerEm:2048,ascender:1577,descender:-471,lineHeight:1.15},deprecated:!0,local:!0},[et.Cascadia]:{metrics:{unitsPerEm:2048,ascender:1900,descender:-480,lineHeight:1.2},deprecated:!0},[et["Liberation Sans"]]:{metrics:{unitsPerEm:2048,ascender:1854,descender:-434,lineHeight:1.15},private:!0},[et.Assistant]:{metrics:{unitsPerEm:2048,ascender:1021,descender:-287,lineHeight:1.25},private:!0},[Bf.Xiaolai]:{metrics:{unitsPerEm:1e3,ascender:880,descender:-144,lineHeight:1.25},fallback:!0},[Bf["Segoe UI Emoji"]]:{metrics:{unitsPerEm:1e3,ascender:886,descender:-374,lineHeight:1.25},local:!0,fallback:!0}},Iu={LATIN:"U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD",LATIN_EXT:"U+0100-02AF, U+0304, U+0308, U+0329, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF",CYRILIC_EXT:"U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F",CYRILIC:"U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116",VIETNAMESE:"U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0, U+0300-0301, U+0303-0304, U+0308-0309, U+0323, U+0329, U+1EA0-1EF9, U+20AB"},R9="local:",hB=(e,t,n)=>{var c;const{unitsPerEm:i,ascender:s,descender:r}=((c=Nh[e])==null?void 0:c.metrics)||Nh[et.Excalifont].metrics,o=t/i,a=(n-o*s+o*r)/2;return o*s+a},Oc=e=>{var n;const{lineHeight:t}=((n=Nh[e])==null?void 0:n.metrics)||Nh[et.Excalifont].metrics;return t};class Yse{constructor(){F(this,"jobs",[]);F(this,"running",!1)}tick(){if(this.running)return;const t=this.jobs.shift();t?(this.running=!0,t.promise.resolve(Pc(t.jobFactory,...t.args).finally(()=>{this.running=!1,this.tick()}))):this.running=!1}push(t,...n){const i=j5();return this.jobs.push({jobFactory:t,promise:i,args:n}),this.tick(),i}}const tt={EQUAL:"Equal",MINUS:"Minus",NUM_ADD:"NumpadAdd",NUM_SUBTRACT:"NumpadSubtract",NUM_ZERO:"Numpad0",BRACKET_RIGHT:"BracketRight",BRACKET_LEFT:"BracketLeft",ONE:"Digit1",TWO:"Digit2",THREE:"Digit3",QUOTE:"Quote",ZERO:"Digit0",SLASH:"Slash",C:"KeyC",D:"KeyD",H:"KeyH",V:"KeyV",Z:"KeyZ",Y:"KeyY",R:"KeyR",S:"KeyS"},H={ARROW_DOWN:"ArrowDown",ARROW_LEFT:"ArrowLeft",ARROW_RIGHT:"ArrowRight",ARROW_UP:"ArrowUp",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",BACKSPACE:"Backspace",ALT:"Alt",CTRL_OR_CMD:so?"metaKey":"ctrlKey",DELETE:"Delete",ENTER:"Enter",ESCAPE:"Escape",QUESTION_MARK:"?",SPACE:" ",TAB:"Tab",CHEVRON_LEFT:"<",CHEVRON_RIGHT:">",PERIOD:".",COMMA:",",SLASH:"/",A:"a",D:"d",E:"e",F:"f",G:"g",H:"h",I:"i",L:"l",O:"o",P:"p",Q:"q",R:"r",S:"s",T:"t",V:"v",X:"x",Y:"y",Z:"z",K:"k",0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9"},Wse=new Map([[H.Z,tt.Z],[H.Y,tt.Y]]),Kse=e=>/^[a-z]$/.test(e.toLowerCase()),h4=(e,t)=>{if(t===e.key.toLowerCase())return!0;const n=Wse.get(t);return!!(n&&!Kse(e.key)&&e.code===n)},L1=e=>e===H.ARROW_LEFT||e===H.ARROW_RIGHT||e===H.ARROW_DOWN||e===H.ARROW_UP,gA=e=>e.altKey,s1=e=>e.shiftKey,g0=e=>e.shiftKey,fp=1e-4,Ke=(e,t,n)=>Math.min(Math.max(e,t),n),ja=(e,t,n="round")=>{const i=Math.pow(10,t);return Math[n]((e+Number.EPSILON)*i)/i},Zse=(e,t,n="round")=>{const i=1/t;return Math[n](e*i)/i},MU=(e,t)=>(e+t)/2,m0=e=>typeof e=="number"&&Number.isFinite(e),mA=(e,t,n=fp)=>Math.abs(e-t)<n,eo=e=>e<0?e%(2*Math.PI)+2*Math.PI:e%(2*Math.PI);function Ku(e){return e*Math.PI/180}function G5(e){return e*180/Math.PI}function qse(e){return Math.abs(Math.sin(2*e))<fp}function Qse(e,t,n){return e=eo(e),t=eo(t),n=eo(n),t<n?e>=t&&e<=n:e>=t||e<=n}function Jse(e,t){e=eo(e),t=eo(t);let n=e-t;return n<-Math.PI?n=n+2*Math.PI:n>Math.PI&&(n=n-2*Math.PI),Math.abs(n)}function pn(e,t,n=0,i=0){return[e-n,t-i]}function ue(e,t=[0,0],n,i=[0,1]){const s=pn(e[0]-t[0],e[1]-t[1]);return n&&gB(s)<n*n?i:s}function bt(e,t){return e[0]*t[1]-t[0]*e[1]}function p0(e,t){return e[0]*t[0]+e[1]*t[1]}function Hf(e,t){return[e[0]+t[0],e[1]+t[1]]}function Xb(e,t){return[e[0]-t[0],e[1]-t[1]]}function In(e,t){return pn(e[0]*t,e[1]*t)}function gB(e){return e[0]*e[0]+e[1]*e[1]}function ere(e){return Math.sqrt(gB(e))}const qs=e=>{const t=ere(e);return t===0?pn(0,0):pn(e[0]/t,e[1]/t)},mB=e=>pn(e[1],-e[0]);function x(e,t){return[e,t]}function X5(e){return e.length===2?x(e[0],e[1]):void 0}function bi(e,t=x(0,0)){return x(t[0]+e[0],t[1]+e[1])}function Vf(e){return Array.isArray(e)&&e.length===2&&typeof e[0]=="number"&&!isNaN(e[0])&&typeof e[1]=="number"&&!isNaN(e[1])}function kr(e,t,n=fp){const i=Math.abs;return i(e[0]-t[0])<n&&i(e[1]-t[1])<n}function q([e,t],[n,i],s){return x((e-n)*Math.cos(s)-(t-i)*Math.sin(s)+n,(e-n)*Math.sin(s)+(t-i)*Math.cos(s)+i)}function jb(e,t=[0,0]){return x(e[0]+t[0],e[1]+t[1])}function Yb(e,t){return x((e[0]+t[0])/2,(e[1]+t[1])/2)}function at(e,t){return Math.hypot(t[0]-e[0],t[1]-e[1])}function Ma(e,t){const n=t[0]-e[0],i=t[1]-e[1];return n*n+i*i}const N1=(e,t,n)=>jb(t,In(ue(e,t),n)),om=(e,t,n)=>t[0]<=Math.max(e[0],n[0])&&t[0]>=Math.min(e[0],n[0])&&t[1]<=Math.max(e[1],n[1])&&t[1]>=Math.min(e[1],n[1]),pB=[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],UB=[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872];function zn(e,t,n,i){return[e,t,n,i]}function tre(e,t,n,i,s=.001,r=10){let o=1/0,a=0;for(;o>=s;){if(a>=r)return null;const l=1-n,c=l*l,u=c*l,d=n*n,f=d*n,h=u*e[0][0]+3*c*n*e[1][0]+3*l*d*e[2][0]+f*e[3][0],m=u*e[0][1]+3*c*n*e[1][1]+3*l*d*e[2][1]+f*e[3][1],p=t[0][0]+i*(t[1][0]-t[0][0]),U=t[0][1]+i*(t[1][1]-t[0][1]),b=h-p,y=m-U;if(o=Math.abs(b)+Math.abs(y),o<s)break;const w=-3*c*e[0][0]+3*c*e[1][0]-6*l*n*e[1][0]-3*d*e[2][0]+6*l*n*e[2][0]+3*d*e[3][0],v=-3*c*e[0][1]+3*c*e[1][1]-6*l*n*e[1][1]-3*d*e[2][1]+6*l*n*e[2][1]+3*d*e[3][1],I=-(t[1][0]-t[0][0]),C=-(t[1][1]-t[0][1]),_=w*C-I*v;if(Math.abs(_)<1e-12)return null;const T=1/_,k=T*(C*-b-I*-y),S=T*(-v*-b+w*-y);n+=k,i+=S,a+=1}return[n,i]}const rh=(e,t)=>x((1-t)**3*e[0][0]+3*(1-t)**2*t*e[1][0]+3*(1-t)*t**2*e[2][0]+t**3*e[3][0],(1-t)**3*e[0][1]+3*(1-t)**2*t*e[1][1]+3*(1-t)*t**2*e[2][1]+t**3*e[3][1]),E8=[[.5,0],[.2,0],[.8,0]],v8=([e,t],n,i)=>{const s=tre(i,n,e,t,.01,3);if(!s)return null;const[r,o]=s;return r<0||r>1||o<0||o>1?null:rh(i,r)};function bB(e,t){let n=v8(E8[0],t,e);return n?[n]:(n=v8(E8[1],t,e),n?[n]:(n=v8(E8[2],t,e),n?[n]:[]))}function nre(e,t,n=.001){const i=(c,u,d,f=n)=>{let h=c,m=u,p;for(;m-h>f;)p=(m+h)/2,d(p-f)<d(p+f)?m=p:h=p;return p};let r=0;for(let c=1/0,u=0;u<30;u++){const d=at(t,rh(e,u/30));d<c&&(c=d,r=u)}const o=Math.max((r-1)/30,0),a=Math.min((r+1)/30,1),l=i(o,a,c=>at(t,rh(e,c)));return l?rh(e,l):null}function D9(e,t){const n=nre(e,t);return n?at(t,n):0}function ire(e){return Array.isArray(e)&&e.length===4&&Vf(e[0])&&Vf(e[1])&&Vf(e[2])&&Vf(e[3])}function L9([e,t,n,i],s){return pn(-3*(1-s)*(1-s)*e[0]+3*(1-s)*(1-s)*t[0]-6*s*(1-s)*t[0]-3*s*s*n[0]+6*s*(1-s)*n[0]+3*s*s*i[0],-3*(1-s)*(1-s)*e[1]+3*(1-s)*(1-s)*t[1]-6*s*(1-s)*t[1]-3*s*s*n[1]+6*s*(1-s)*n[1]+3*s*s*i[1])}function sre(e,t=.5){if(e.length<2)return;const n=[];for(let i=0;i<e.length-1;i++){const s=e[i-1<0?0:i-1],r=e[i],o=e[i+1>=e.length?e.length-1:i+1],a=r[0]+(o[0]-s[0])*t/2,l=r[1]+(o[1]-s[1])*t/2;n.push([x(a,l),x(o[0],o[1])])}return n}function N9(e,t=.5){if(e.length<2)return;const n=[];for(let i=0;i<e.length-1;i++){const s=e[i-1<0?0:i-1],r=e[i],o=e[i+1>=e.length?e.length-1:i+1],a=e[i+2>=e.length?e.length-1:i+2],l=[(o[0]-s[0])*t,(o[1]-s[1])*t],c=[(a[0]-r[0])*t,(a[1]-r[1])*t],u=r[0]+l[0]/3,d=r[1]+l[1]/3,f=o[0]-c[0]/3,h=o[1]-c[1]/3;n.push(zn(x(r[0],r[1]),x(u,d),x(f,h),x(o[0],o[1])))}return n}function Eo([e,t,n,i],s,r=50){const o=[];for(let a=0;a<=r;a++){const l=a/r,c=zn(e,t,n,i),u=rh(c,l),d=qs(L9(c,l)),f=mB(d);o.push(bi(In(f,s),u))}return o}function kl(e,t,n,i,s=50){const r=[];for(let o=0;o<=s;o++){const a=o/s,l=1-a,c=x(l*l*e[0]+2*l*a*t[0]+a*a*n[0],l*l*e[1]+2*l*a*t[1]+a*a*n[1]),u=2*(1-a)*(t[0]-e[0])+2*a*(n[0]-t[0]),d=2*(1-a)*(t[1]-e[1])+2*a*(n[1]-t[1]),f=qs(pn(u,d)),h=mB(f);r.push(bi(In(h,i),c))}return r}function O9(e){let n=0;for(let i=0;i<24;i++){const s=.5*pB[i]+.5,r=L9(e,s),o=Math.sqrt(r[0]*r[0]+r[1]*r[1]);n+=UB[i]*o}return .5*n}function rre(e,t){if(t<=0)return 0;if(t>=1)return O9(e);const n=t/2,i=t/2;let s=0;for(let r=0;r<24;r++){const o=n*pB[r]+i,a=L9(e,o),l=Math.sqrt(a[0]*a[0]+a[1]*a[1]);s+=UB[r]*l}return n*s}function ore(e,t){const n=O9(e),i=n*t;let s=0,r=1,o=t,a=0;const l=n*1e-4,c=20;for(let u=0;u<c&&(a=rre(e,o),!(Math.abs(a-i)<l));u++)a<i?s=o:r=o,o=(s+r)/2;return rh(e,o)}function yB(e,t,n){return{center:e,halfWidth:t,halfHeight:n}}const are=(e,t)=>{const{halfWidth:n,halfHeight:i,center:s}=t,r=n,o=i,a=Hf(ue(e),In(ue(s),-1)),l=Math.abs(a[0]),c=Math.abs(a[1]);let u=.707,d=.707;for(let m=0;m<3;m++){const p=r*u,U=o*d,b=(r*r-o*o)*u**3/r,y=(o*o-r*r)*d**3/o,w=p-b,v=U-y,I=l-b,C=c-y,_=Math.hypot(v,w),T=Math.hypot(C,I);u=Math.min(1,Math.max(0,(I*_/T+b)/r)),d=Math.min(1,Math.max(0,(C*_/T+y)/o));const k=Math.hypot(d,u);u/=k,d/=k}const[f,h]=[r*u*Math.sign(a[0]),o*d*Math.sign(a[1])];return at(bi(a),x(f,h))};function lre(e,t){const n=e.halfWidth,i=e.halfHeight,s=ue(t[1],t[0]),r=pn(t[0][0]-e.center[0],t[0][1]-e.center[1]),o=pn(s[0]/(n*n),s[1]/(i*i)),a=pn(r[0]/(n*n),r[1]/(i*i)),l=p0(s,o),c=p0(s,a),u=p0(r,a)-1,d=c*c-l*u,f=[];if(d>0){const h=(-c-Math.sqrt(d))/l,m=(-c+Math.sqrt(d))/l;0<=h&&h<=1&&f.push(x(t[0][0]+(t[1][0]-t[0][0])*h,t[0][1]+(t[1][1]-t[0][1])*h)),0<=m&&m<=1&&f.push(x(t[0][0]+(t[1][0]-t[0][0])*m,t[0][1]+(t[1][1]-t[0][1])*m))}else if(d===0){const h=-c/l;0<=h&&h<=1&&f.push(x(t[0][0]+(t[1][0]-t[0][0])*h,t[0][1]+(t[1][1]-t[0][1])*h))}return f}function pA(e,t){return[e,t]}function cre(e,t){const n=e[1][1]-e[0][1],i=e[0][0]-e[1][0],s=t[1][1]-t[0][1],r=t[0][0]-t[1][0],o=n*r-s*i;if(o!==0){const a=n*e[0][0]+i*e[0][1],l=s*t[0][0]+r*t[0][1];return x((a*r-l*i)/o,(n*l-s*a)/o)}return null}function Ae(e,t){return[e,t]}const ure=e=>Array.isArray(e)&&e.length===2&&Vf(e[0])&&Vf(e[0]),Wb=(e,t,n=fp)=>{const i=sc(e,t);return i===0?!0:i<n},sc=(e,t)=>{const[n,i]=e,[[s,r],[o,a]]=t,l=n-s,c=i-r,u=o-s,d=a-r,f=l*u+c*d,h=u*u+d*d;let m=-1;h!==0&&(m=f/h);let p,U;m<0?(p=s,U=r):m>1?(p=o,U=a):(p=s+m*u,U=r+m*d);const b=n-p,y=i-U;return Math.sqrt(b*b+y*y)};function am(e,t,n){const i=cre(pA(e[0],e[1]),pA(t[0],t[1]));return!i||!Wb(i,t,n)||!Wb(i,e,n)?null:i}function UA(e,t){return am(e,t)?0:Math.min(sc(e[0],t),sc(e[1],t),sc(t[0],e),sc(t[1],e))}function g4(...e){return vB(e)}function Kb(e){return vB(e)}const EB=(e,t)=>{const[n,i]=e;let s=0;for(let r=0;r<t.length;r++){const o=(r+1)%t.length,[a,l]=t[r],[c,u]=t[o];l<=i?u>i&&(c-a)*(i-l)-(n-a)*(u-l)>0&&s++:u<=i&&(c-a)*(i-l)-(n-a)*(u-l)<0&&s--}return s!==0};function vB(e){return dre(e)?e:[...e,e[0]]}function dre(e){return kr(e[0],e[e.length-1])}function Hi(e,t){return Zo([e,t])}const Zb=([e,t],[n,i])=>e<=n?t>=n:e>=n?i>=e:!1,qb=([e,t],[n,i])=>{const s=Math.max(e,n),r=Math.min(t,i);return s<=r?Zo([s,r]):null},kU=(e,[t,n])=>e>=t&&e<=n;function fre(e,t){return[e,t]}function w8([e,t,n],i){const s=(u,d,f)=>(u[0]-f[0])*(d[1]-f[1])-(d[0]-f[0])*(u[1]-f[1]),r=s(i,e,t),o=s(i,t,n),a=s(i,n,e),l=r<0||o<0||a<0,c=r>0||o>0||a>0;return!(l&&c)}const Oh=e=>{const t=e.map(i=>i[0]),n=e.map(i=>i[1]);return{width:Math.max(...t)-Math.min(...t),height:Math.max(...n)-Math.min(...n)}},Qb=(e,t,n,i)=>{const s=n.map(h=>h[e]),r=Math.max(...s),o=Math.min(...s),a=r-o,l=a===0?1:t/a;let c=1/0;const u=n.map(h=>{const m=h[e]*l,p=[...h];return p[e]=m,m<c&&(c=m),p});if(!i||u.length===2)return u;const d=o-c;return u.map(h=>h.map((m,p)=>p===e?m+d:m))},On=(e,t,n)=>n?[Math.round(e/n)*n,Math.round(t/n)*n]:[e,t];var wB={exports:{}};(function(e,t){(function(n,i){e.exports=i()})(La,function(){var n=function(){this._listeners={}};n.prototype.addEventListener=function(c,u){this._listeners[c]=this._listeners[c]||[],this._listeners[c].indexOf(u)<0&&this._listeners[c].push(u)},n.prototype.removeEventListener=function(c,u){if(this._listeners[c]){var d=this._listeners[c].indexOf(u);d>=0&&this._listeners[c].splice(d,1)}},n.prototype.dispatchEvent=function(c){if(this._listeners[c.type]&&this._listeners[c.type].length)for(var u=this._listeners[c.type].slice(),d=0,f=u.length;d<f;++d)u[d].call(this,c)};var i=function(c){return typeof c.constructor=="function"&&c.constructor.name==="GeneratorFunction"},s=function(c){return{next:function(){var u=c();return u?{value:u}:{done:!0}}}},r=function(c){var u=!1;return{next:function(){return u?{done:!0}:(u=!0,{value:c})}}},o=function(c,u){var d=typeof c;if(d==="object"){if(typeof c.next=="function")return c;if(typeof c.then=="function")return r(c)}return d==="function"?i(c)?c():s(c):r(u.resolve(c))},a=function(c,u,d){this.target=c,this.type=u,this.data=d},l=function(c,u,d){if(n.call(this),typeof u!="number"||Math.floor(u)!==u||u<1)throw new Error("Invalid concurrency");this._concurrency=u,this._options=d||{},this._options.promise=this._options.promise||Promise,this._iterator=o(c,this._options.promise),this._done=!1,this._size=0,this._promise=null,this._callbacks=null};return l.prototype=new n,l.prototype.constructor=l,l.prototype.concurrency=function(c){return typeof c<"u"&&(this._concurrency=c,this.active()&&this._proceed()),this._concurrency},l.prototype.size=function(){return this._size},l.prototype.active=function(){return!!this._promise},l.prototype.promise=function(){return this._promise},l.prototype.start=function(){var c=this,u=this._options.promise;return this._promise=new u(function(d,f){c._callbacks={reject:f,resolve:d},c._proceed()}),this._promise},l.prototype._fireEvent=function(c,u){this.dispatchEvent(new a(this,c,u))},l.prototype._settle=function(c){c?this._callbacks.reject(c):this._callbacks.resolve(),this._promise=null,this._callbacks=null},l.prototype._onPooledPromiseFulfilled=function(c,u){this._size--,this.active()&&(this._fireEvent("fulfilled",{promise:c,result:u}),this._proceed())},l.prototype._onPooledPromiseRejected=function(c,u){this._size--,this.active()&&(this._fireEvent("rejected",{promise:c,error:u}),this._settle(u||new Error("Unknown error")))},l.prototype._trackPromise=function(c){var u=this;c.then(function(d){u._onPooledPromiseFulfilled(c,d)},function(d){u._onPooledPromiseRejected(c,d)}).catch(function(d){u._settle(new Error("Promise processing failed: "+d))})},l.prototype._proceed=function(){if(!this._done){for(var c={done:!1};this._size<this._concurrency&&!(c=this._iterator.next()).done;)this._size++,this._trackPromise(c.value);this._done=c===null||!!c.done}this._done&&this._size===0&&this._settle()},l.PromisePoolEvent=a,l.PromisePool=l,l})})(wB);var hre=wB.exports;const gre=bl(hre);class bA{constructor(t,n){F(this,"pool");F(this,"entries",{});this.pool=new gre(t,n)}all(){const t=n=>{if(n.data.result){const[i,s]=n.data.result;this.entries[i]=s}};return this.pool.addEventListener("fulfilled",t),this.pool.start().then(()=>(setTimeout(()=>{this.pool.removeEventListener("fulfilled",t)}),Object.values(this.entries)))}}let _B=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((t,n)=>(n&=63,n<36?t+=n.toString(36):n<62?t+=(n-26).toString(36).toUpperCase():n>62?t+="-":t+="_",t),"");function mre(){return Math.floor(Math.random()*2**31)}class TB{constructor(t){this.seed=t}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}}const yA=()=>{const e=new Date,t=e.getFullYear(),n=`${e.getMonth()+1}`.padStart(2,"0"),i=`${e.getDate()}`.padStart(2,"0"),s=`${e.getHours()}`.padStart(2,"0"),r=`${e.getMinutes()}`.padStart(2,"0");return`${t}-${n}-${i}-${s}${r}`},Mt=e=>e.charAt(0).toUpperCase()+e.slice(1),pre=e=>e instanceof HTMLElement&&e.className.includes("ToolIcon"),m4=e=>e instanceof HTMLElement&&e.dataset.type==="wysiwyg"||e instanceof HTMLBRElement||e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement||e instanceof HTMLSelectElement,Ure=e=>m4(e)||e instanceof Element&&!!e.closest("label, button"),ka=e=>e instanceof HTMLElement&&e.dataset.type==="wysiwyg"||e instanceof HTMLBRElement||e instanceof HTMLTextAreaElement||e instanceof HTMLInputElement&&(e.type==="text"||e.type==="number"||e.type==="password"||e.type==="search"),hp=({fontFamily:e})=>{for(const[t,n]of Object.entries(et))if(n===e)return`${t}${iB(n).map(i=>`, ${i}`).join("")}`;return sm},gt=({fontSize:e,fontFamily:t})=>`${e}px ${hp({fontFamily:t})}`,bre=async e=>{requestAnimationFrame(()=>requestAnimationFrame(e))},sl=(e,t)=>{let n=0,i=null;const s=(...r)=>{i=r,clearTimeout(n),n=window.setTimeout(()=>{i=null,e(...r)},t)};return s.flush=()=>{if(clearTimeout(n),i){const r=i;i=null,e(...r)}},s.cancel=()=>{i=null,clearTimeout(n)},s},Ug=(e,t)=>{let n=null,i=null,s=null;const r=a=>{n=window.requestAnimationFrame(()=>{n=null,e(...a),i=null,s&&(i=s,s=null,r(i))})},o=(...a)=>{i=a,n===null?r(i):t!=null&&t.trailing&&(s=a)};return o.flush=()=>{n!==null&&(cancelAnimationFrame(n),n=null),i&&(e(...s||i),i=s=null)},o.cancel=()=>{i=s=null,n!==null&&(cancelAnimationFrame(n),n=null)},o},rl=e=>1-Math.pow(1-e,4),EA=(e,t,n)=>(t-e)*rl(n)+e,yre=({fromValues:e,toValues:t,onStep:n,duration:i=250,interpolateValue:s,onStart:r,onEnd:o,onCancel:a})=>{let l=!1,c=0,u;function d(f){if(l)return;u===void 0&&(u=f,r==null||r());const h=Math.min(f-u,i),m=rl(h/i),p={};if(Object.keys(e).forEach(U=>{const b=U,y=(t[b]-e[b])*m+e[b];p[b]=y}),n(p),h<i){const U=h/i,b={};Object.keys(e).forEach(y=>{const w=y,v=e[w],I=t[w];let C;C=s?s(v,I,U,w):EA(v,I,U),C==null&&(C=EA(v,I,U)),b[w]=C}),n(b),c=window.requestAnimationFrame(d)}else n(t),o==null||o()}return c=window.requestAnimationFrame(d),()=>{a==null||a(),l=!0,window.cancelAnimationFrame(c)}},Ere=(e,t)=>{if(!e.length||t<1)return[];let n=0,i=0;const s=Array(Math.ceil(e.length/t));for(;n<e.length;)s[i++]=e.slice(n,n+=t);return s},$i=(e,t)=>Math.abs(e-t),en=(e,t)=>t.type==="custom"?{...e.activeTool,type:"custom",customType:t.customType,locked:t.locked??e.activeTool.locked}:{...e.activeTool,lastActiveTool:t.lastActiveToolBeforeEraser===void 0?e.activeTool.lastActiveTool:t.lastActiveToolBeforeEraser,type:t.type,customType:null,locked:t.locked??e.activeTool.locked,fromSelection:t.fromSelection??!1},Dt=({clientX:e,clientY:t},{zoom:n,offsetLeft:i,offsetTop:s,scrollX:r,scrollY:o})=>{const a=(e-i)/n.value-r,l=(t-s)/n.value-o;return{x:a,y:l}},Xs=({sceneX:e,sceneY:t},{zoom:n,offsetLeft:i,offsetTop:s,scrollX:r,scrollY:o})=>{const a=(e+r)*n.value+i,l=(t+o)*n.value+s;return{x:a,y:l}},RU=e=>getComputedStyle(document.documentElement).getPropertyValue(`--${e}`),vre="A-Za-z--------",wre="---",_re=new RegExp(`^[^${vre}]*[${wre}]`),IB=e=>_re.test(e),Ya=e=>{const[t,n]=e;return{x:t,y:n}},SB=e=>{if((e==null?void 0:e.name)==="AbortError"){console.warn(e);return}throw e},xB=(e,t,n=0)=>{n<0&&(n=e.length+n),n=Math.min(e.length,Math.max(n,0));let i=n-1;for(;++i<e.length;)if(t(e[i],i,e))return i;return-1},Su=(e,t,n=e.length-1)=>{n<0&&(n=e.length+n),n=Math.min(e.length-1,Math.max(n,0));let i=n+1;for(;--i>-1;)if(t(e[i],i,e))return i;return-1},Tre=(e,t)=>{for(let n=0;n<e.length;n++){const i=t(e[n],n);if(i!=null)return i}},ws=e=>{const t=e.length===5&&e.substr(4,1)==="0",n=e.length===9&&e.substr(7,2)==="00";return t||n||e===Ge.transparent},x2=e=>e.fillStyle!=="solid"||ws(e.backgroundColor),j5=()=>{let e,t;const n=new Promise((i,s)=>{e=i,t=s});return n.resolve=e,n.reject=t,n},vA=(e,t)=>{const n=[{value:1,symbol:"b"},{value:1e3,symbol:"k"},{value:1e6,symbol:"M"},{value:1e9,symbol:"G"}],i=/\.0+$|(\.[0-9]*[1-9])0+$/;let s;for(s=n.length-1;s>0&&!(e>=n[s].value);s--);return(e/n[s].value).toFixed(t).replace(i,"$1")+n[s].symbol},p4=()=>{var e;return((e=document.querySelector('meta[name="version"]'))==null?void 0:e.content)||sB},Ire=e=>{let t=e.parentElement;for(;t;){if(t===document.body)return document;const{overflowY:n}=window.getComputedStyle(t);if(t.scrollHeight>t.clientHeight&&(n==="auto"||n==="scroll"||n==="overlay"))return t;t=t.parentElement}return document},Sre=e=>{let t=e.parentElement;for(;t;){if(t.tabIndex>-1){t.focus();return}t=t.parentElement}},P9=e=>{e.preventDefault(),e.returnValue=""},CB=e=>Array.from(e).map(t=>`0${t.toString(16)}`.slice(-2)).join(""),bg=()=>Date.now(),ve=e=>e instanceof Map?e:e.reduce((t,n)=>(t.set(typeof n=="string"?n:n.id,n),t),new Map),xre=e=>e.reduce((t,n,i)=>(t.set(n.id,[n,i]),t),new Map),pa=(e,t)=>e.reduce((n,i,s)=>(n[t?t(i):s]=i,n),{}),Cre=e=>e.reduce((t,n,i)=>{const s={...n,prev:null,next:null};if(i!==0){const r=t[i-1];if(s.prev=r,r.next=s,i===e.length-1){const o=t[0];s.next=o,o.prev=s}}return t.push(s),t},[]),Xl=e=>Array.isArray(e)?e:e.values(),Are=e=>Array.isArray(e)?e:Array.from(Xl(e)),Mre=()=>eB.TEST==="production",F9=()=>eB.DEVELOPMENT==="production",kre=()=>typeof process<"u"&&!0,AB=(e,t)=>new CustomEvent(e,{detail:{nativeEvent:t},cancelable:!0}),C2=(e,t)=>{let n=!1;for(const i in t){const s=t[i];if(typeof s<"u"){if(e[i]===s&&(typeof s!="object"||s===null))continue;n=!0}}return n?{...e,...t}:e},gp=()=>{try{return window.self===window.top?"top":"iframe"}catch{return"iframe"}},Rre=()=>gp()==="iframe",mp=e=>!!e&&typeof e=="object"&&"then"in e&&"catch"in e&&"finally"in e,U4=e=>{const t=e==null?void 0:e.querySelectorAll("button, a, input, select, textarea, div[tabindex], label[tabindex]");return t?Array.from(t).filter(n=>n.tabIndex>-1&&!n.disabled):[]},wA=(e,t)=>Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t,Wi=(e,t,n,i=!1)=>{const s=Object.keys(e),r=Object.keys(t);if(s.length!==r.length)return i&&console.warn("%cisShallowEqual: objects don't have same properties ->","color: #8B4000",e,t),!1;if(n&&Array.isArray(n)){for(const o of n)if(!(e[o]===t[o]||wA(e[o],t[o])))return i&&console.warn(`%cisShallowEqual: ${o} not equal ->`,"color: #8B4000",e[o],t[o]),!1;return!0}return s.every(o=>{const a=n==null?void 0:n[o],l=a?a(e[o],t[o]):e[o]===t[o]||wA(e[o],t[o]);return!l&&i&&console.warn(`%cisShallowEqual: ${o} not equal ->`,"color: #8B4000",e[o],t[o]),l})},Y5=(e,t,{checkForDefaultPrevented:n=!0}={})=>function(s){if(e==null||e(s),!n||!(s!=null&&s.defaultPrevented))return t==null?void 0:t(s)},Ko=(e,t,n)=>{if(!t)return e;if(n)return console.error(t),e;throw new Error(t)};function gn(e,t){if(!e)throw new Error(t)}const Dre=e=>{let t,n;const i=function(s){const r=Object.entries(s);if(t){let a=!0;for(const[l,c]of r)if(t.get(l)!==c){a=!1;break}if(a)return n}const o=e(s);return t=new Map(r),n=o,o};return i.clear=()=>{t=void 0,n=void 0},i},MB=(e,t)=>e instanceof Set||e instanceof Map?e.has(t):"includes"in e?e.includes(t):e.hasOwnProperty(t),Wa=e=>JSON.parse(JSON.stringify(e)),r1=(e,t)=>Wi(e,t)?e:t;function Jt(e,t,n,i){var s;return e?((s=e==null?void 0:e.addEventListener)==null||s.call(e,t,n,i),()=>{var r;(r=e==null?void 0:e.removeEventListener)==null||r.call(e,t,n,i)}):()=>{}}function Lre(e,t=!0){const n=e.length;if(n<4)return"";let i=e[0],s=e[1];const r=e[2];let o=`M${i[0].toFixed(2)},${i[1].toFixed(2)} Q${s[0].toFixed(2)},${s[1].toFixed(2)} ${MU(s[0],r[0]).toFixed(2)},${MU(s[1],r[1]).toFixed(2)} T`;for(let a=2,l=n-1;a<l;a++)i=e[a],s=e[a+1],o+=`${MU(i[0],s[0]).toFixed(2)},${MU(i[1],s[1]).toFixed(2)} `;return t&&(o+="Z"),o}const kB=e=>e.replace(/\r?\n|\r/g,`
`),Zo=e=>e,Pc=async(e,...t)=>new Promise(n=>{n(e(...t))}),Nre=(...e)=>Math.max(...e.map(t=>t?1:0))>0,Ore=e=>{try{return JSON.parse(e)}catch{return null}},A2=e=>e.replace(/"/g,"&quot;"),_8=e=>Array.isArray(e)?e:[e],Pre=e=>Array.isArray(e),RB=e=>Pre(e)?e.length:e instanceof Map||e instanceof Set?e.size:Object.keys(e).length,DB=(e,t)=>{if(RB(e)===0)return null;const n=t||(s=>s);let i=null;for(const s of e){const r=n(s);if((i===null||i===r)&&r!=null)i=r;else return null}return i},vo=()=>{const e=navigator.userAgent||"",t=navigator.platform||"",n=navigator.userAgentData;if(n){const s=(n.platform||"").toLowerCase(),r=s==="windows"||s==="macos"||s==="linux"||s==="chrome os";if(n.mobile===!0)return!0;if(n.mobile===!1&&s==="android")return(matchMedia==null?void 0:matchMedia("(hover: none)").matches)&&(matchMedia==null?void 0:matchMedia("(pointer: coarse)").matches);if(r)return!1}if(I9)return!0;if(QF){const s=/Mobile/i.test(e);if(s||!s)return(matchMedia==null?void 0:matchMedia("(hover: none)").matches)&&(matchMedia==null?void 0:matchMedia("(pointer: coarse)").matches)}return/Win|Linux|CrOS|Mac/.test(t)||/Windows NT|X11|CrOS|Macintosh/.test(e),!1};let Fre=new TB(Date.now());const Rr=()=>Math.floor(Fre.next()*2**31),fs=()=>_B();var B9={};Object.defineProperty(B9,"__esModule",{value:!0});var LB=B9.sanitizeUrl=void 0,Bre=/^([^\w]*)(javascript|data|vbscript)/im,zre=/&#(\w+)(^\w|;)?/g,Hre=/&(newline|tab);/gi,Vre=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,$re=/^.+(:|&colon;)/gim,Gre=[".","/"];function Xre(e){return Gre.indexOf(e[0])>-1}function jre(e){return e.replace(zre,function(t,n){return String.fromCharCode(n)})}function Yre(e){var t=jre(e||"").replace(Hre,"").replace(Vre,"").trim();if(!t)return"about:blank";if(Xre(t))return t;var n=t.match($re);if(!n)return t;var i=n[0];return Bre.test(i)?"about:blank":t}LB=B9.sanitizeUrl=Yre;const Qs=e=>(e=e.trim(),e&&LB(A2(e))),NB=e=>!!(e!=null&&e.includes(location.origin)||e!=null&&e.startsWith("/")),z9=e=>{if(e=Qs(e),e.startsWith("/"))return`${location.origin}${e}`;try{new URL(e)}catch{return"about:blank"}return e};class $r{constructor(){F(this,"subscribers",[])}on(...t){const n=t.flat().filter(i=>typeof i=="function");return this.subscribers.push(...n),()=>this.off(n)}once(...t){const n=t.flat().filter(s=>typeof s=="function");n.push(()=>i());const i=this.on(...n);return i}off(...t){const n=t.flat();this.subscribers=this.subscribers.filter(i=>!n.includes(i))}trigger(...t){for(const n of this.subscribers)n(...t);return this}clear(){this.subscribers=[]}}function OB(e){var t,n,i="";if(typeof e=="string"||typeof e=="number")i+=e;else if(typeof e=="object")if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=OB(e[t]))&&(i&&(i+=" "),i+=n);else for(t in e)e[t]&&(i&&(i+=" "),i+=t);return i}function re(){for(var e=0,t,n,i="";e<arguments.length;)(t=arguments[e++])&&(n=OB(t))&&(i&&(i+=" "),i+=n);return i}var PB="Expected a function",_A=NaN,Wre="[object Symbol]",Kre=/^\s+|\s+$/g,Zre=/^[-+]0x[0-9a-f]+$/i,qre=/^0b[01]+$/i,Qre=/^0o[0-7]+$/i,Jre=parseInt,eoe=typeof La=="object"&&La&&La.Object===Object&&La,toe=typeof self=="object"&&self&&self.Object===Object&&self,noe=eoe||toe||Function("return this")(),ioe=Object.prototype,soe=ioe.toString,roe=Math.max,ooe=Math.min,T8=function(){return noe.Date.now()};function aoe(e,t,n){var i,s,r,o,a,l,c=0,u=!1,d=!1,f=!0;if(typeof e!="function")throw new TypeError(PB);t=TA(t)||0,Jb(n)&&(u=!!n.leading,d="maxWait"in n,r=d?roe(TA(n.maxWait)||0,t):r,f="trailing"in n?!!n.trailing:f);function h(C){var _=i,T=s;return i=s=void 0,c=C,o=e.apply(T,_),o}function m(C){return c=C,a=setTimeout(b,t),u?h(C):o}function p(C){var _=C-l,T=C-c,k=t-_;return d?ooe(k,r-T):k}function U(C){var _=C-l,T=C-c;return l===void 0||_>=t||_<0||d&&T>=r}function b(){var C=T8();if(U(C))return y(C);a=setTimeout(b,p(C))}function y(C){return a=void 0,f&&i?h(C):(i=s=void 0,o)}function w(){a!==void 0&&clearTimeout(a),c=0,i=l=s=a=void 0}function v(){return a===void 0?o:y(T8())}function I(){var C=T8(),_=U(C);if(i=arguments,s=this,l=C,_){if(a===void 0)return m(l);if(d)return a=setTimeout(b,t),h(l)}return a===void 0&&(a=setTimeout(b,t)),o}return I.cancel=w,I.flush=v,I}function loe(e,t,n){var i=!0,s=!0;if(typeof e!="function")throw new TypeError(PB);return Jb(n)&&(i="leading"in n?!!n.leading:i,s="trailing"in n?!!n.trailing:s),aoe(e,t,{leading:i,maxWait:t,trailing:s})}function Jb(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function coe(e){return!!e&&typeof e=="object"}function uoe(e){return typeof e=="symbol"||coe(e)&&soe.call(e)==Wre}function TA(e){if(typeof e=="number")return e;if(uoe(e))return _A;if(Jb(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Jb(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(Kre,"");var n=qre.test(e);return n||Qre.test(e)?Jre(e.slice(2),n?2:8):Zre.test(e)?_A:+e}var doe=loe;const Oo=bl(doe);function b4(e,t,n){if(e&&e.length){const[i,s]=t,r=Math.PI/180*n,o=Math.cos(r),a=Math.sin(r);for(const l of e){const[c,u]=l;l[0]=(c-i)*o-(u-s)*a+i,l[1]=(c-i)*a+(u-s)*o+s}}}function foe(e,t,n){const i=[];e.forEach(s=>i.push(...s)),b4(i,t,n)}function hoe(e,t){return e[0]===t[0]&&e[1]===t[1]}function goe(e,t,n,i=1){const s=n,r=Math.max(t,.1),o=e[0]&&e[0][0]&&typeof e[0][0]=="number"?[e]:e,a=[0,0];if(s)for(const c of o)b4(c,a,s);const l=moe(o,r,i);if(s){for(const c of o)b4(c,a,-s);foe(l,a,-s)}return l}function moe(e,t,n){const i=[];for(const c of e){const u=[...c];hoe(u[0],u[u.length-1])||u.push([u[0][0],u[0][1]]),u.length>2&&i.push(u)}const s=[];t=Math.max(t,.1);const r=[];for(const c of i)for(let u=0;u<c.length-1;u++){const d=c[u],f=c[u+1];if(d[1]!==f[1]){const h=Math.min(d[1],f[1]);r.push({ymin:h,ymax:Math.max(d[1],f[1]),x:h===d[1]?d[0]:f[0],islope:(f[0]-d[0])/(f[1]-d[1])})}}if(r.sort((c,u)=>c.ymin<u.ymin?-1:c.ymin>u.ymin?1:c.x<u.x?-1:c.x>u.x?1:c.ymax===u.ymax?0:(c.ymax-u.ymax)/Math.abs(c.ymax-u.ymax)),!r.length)return s;let o=[],a=r[0].ymin,l=0;for(;o.length||r.length;){if(r.length){let c=-1;for(let d=0;d<r.length&&!(r[d].ymin>a);d++)c=d;r.splice(0,c+1).forEach(d=>{o.push({s:a,edge:d})})}if(o=o.filter(c=>!(c.edge.ymax<=a)),o.sort((c,u)=>c.edge.x===u.edge.x?0:(c.edge.x-u.edge.x)/Math.abs(c.edge.x-u.edge.x)),(n!==1||l%t===0)&&o.length>1)for(let c=0;c<o.length;c=c+2){const u=c+1;if(u>=o.length)break;const d=o[c].edge,f=o[u].edge;s.push([[Math.round(d.x),a],[Math.round(f.x),a]])}a+=n,o.forEach(c=>{c.edge.x=c.edge.x+n*c.edge.islope}),l++}return s}function pp(e,t){var n;const i=t.hachureAngle+90;let s=t.hachureGap;s<0&&(s=t.strokeWidth*4),s=Math.max(s,.1);let r=1;return t.roughness>=1&&(((n=t.randomizer)===null||n===void 0?void 0:n.next())||Math.random())>.7&&(r=s),goe(e,s,i,r||1)}class H9{constructor(t){this.helper=t}fillPolygons(t,n){return this._fillPolygons(t,n)}_fillPolygons(t,n){const i=pp(t,n);return{type:"fillSketch",ops:this.renderLines(i,n)}}renderLines(t,n){const i=[];for(const s of t)i.push(...this.helper.doubleLineOps(s[0][0],s[0][1],s[1][0],s[1][1],n));return i}}function W5(e){const t=e[0],n=e[1];return Math.sqrt(Math.pow(t[0]-n[0],2)+Math.pow(t[1]-n[1],2))}class poe extends H9{fillPolygons(t,n){let i=n.hachureGap;i<0&&(i=n.strokeWidth*4),i=Math.max(i,.1);const s=Object.assign({},n,{hachureGap:i}),r=pp(t,s),o=Math.PI/180*n.hachureAngle,a=[],l=i*.5*Math.cos(o),c=i*.5*Math.sin(o);for(const[d,f]of r)W5([d,f])&&a.push([[d[0]-l,d[1]+c],[...f]],[[d[0]+l,d[1]-c],[...f]]);return{type:"fillSketch",ops:this.renderLines(a,n)}}}class Uoe extends H9{fillPolygons(t,n){const i=this._fillPolygons(t,n),s=Object.assign({},n,{hachureAngle:n.hachureAngle+90}),r=this._fillPolygons(t,s);return i.ops=i.ops.concat(r.ops),i}}class boe{constructor(t){this.helper=t}fillPolygons(t,n){n=Object.assign({},n,{hachureAngle:0});const i=pp(t,n);return this.dotsOnLines(i,n)}dotsOnLines(t,n){const i=[];let s=n.hachureGap;s<0&&(s=n.strokeWidth*4),s=Math.max(s,.1);let r=n.fillWeight;r<0&&(r=n.strokeWidth/2);const o=s/4;for(const a of t){const l=W5(a),c=l/s,u=Math.ceil(c)-1,d=l-u*s,f=(a[0][0]+a[1][0])/2-s/4,h=Math.min(a[0][1],a[1][1]);for(let m=0;m<u;m++){const p=h+d+m*s,U=f-o+Math.random()*2*o,b=p-o+Math.random()*2*o,y=this.helper.ellipse(U,b,r,r,n);i.push(...y.ops)}}return{type:"fillSketch",ops:i}}}class yoe{constructor(t){this.helper=t}fillPolygons(t,n){const i=pp(t,n);return{type:"fillSketch",ops:this.dashedLine(i,n)}}dashedLine(t,n){const i=n.dashOffset<0?n.hachureGap<0?n.strokeWidth*4:n.hachureGap:n.dashOffset,s=n.dashGap<0?n.hachureGap<0?n.strokeWidth*4:n.hachureGap:n.dashGap,r=[];return t.forEach(o=>{const a=W5(o),l=Math.floor(a/(i+s)),c=(a+s-l*(i+s))/2;let u=o[0],d=o[1];u[0]>d[0]&&(u=o[1],d=o[0]);const f=Math.atan((d[1]-u[1])/(d[0]-u[0]));for(let h=0;h<l;h++){const m=h*(i+s),p=m+i,U=[u[0]+m*Math.cos(f)+c*Math.cos(f),u[1]+m*Math.sin(f)+c*Math.sin(f)],b=[u[0]+p*Math.cos(f)+c*Math.cos(f),u[1]+p*Math.sin(f)+c*Math.sin(f)];r.push(...this.helper.doubleLineOps(U[0],U[1],b[0],b[1],n))}}),r}}class Eoe{constructor(t){this.helper=t}fillPolygons(t,n){const i=n.hachureGap<0?n.strokeWidth*4:n.hachureGap,s=n.zigzagOffset<0?i:n.zigzagOffset;n=Object.assign({},n,{hachureGap:i+s});const r=pp(t,n);return{type:"fillSketch",ops:this.zigzagLines(r,s,n)}}zigzagLines(t,n,i){const s=[];return t.forEach(r=>{const o=W5(r),a=Math.round(o/(2*n));let l=r[0],c=r[1];l[0]>c[0]&&(l=r[1],c=r[0]);const u=Math.atan((c[1]-l[1])/(c[0]-l[0]));for(let d=0;d<a;d++){const f=d*2*n,h=(d+1)*2*n,m=Math.sqrt(2*Math.pow(n,2)),p=[l[0]+f*Math.cos(u),l[1]+f*Math.sin(u)],U=[l[0]+h*Math.cos(u),l[1]+h*Math.sin(u)],b=[p[0]+m*Math.cos(u+Math.PI/4),p[1]+m*Math.sin(u+Math.PI/4)];s.push(...this.helper.doubleLineOps(p[0],p[1],b[0],b[1],i),...this.helper.doubleLineOps(b[0],b[1],U[0],U[1],i))}}),s}}const Us={};function voe(e,t){let n=e.fillStyle||"hachure";if(!Us[n])switch(n){case"zigzag":Us[n]||(Us[n]=new poe(t));break;case"cross-hatch":Us[n]||(Us[n]=new Uoe(t));break;case"dots":Us[n]||(Us[n]=new boe(t));break;case"dashed":Us[n]||(Us[n]=new yoe(t));break;case"zigzag-line":Us[n]||(Us[n]=new Eoe(t));break;case"hachure":default:n="hachure",Us[n]||(Us[n]=new H9(t));break}return Us[n]}const woe=0,y4=1,FB=2,DU={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function _oe(e){const t=new Array;for(;e!=="";)if(e.match(/^([ \t\r\n,]+)/))e=e.substr(RegExp.$1.length);else if(e.match(/^([aAcChHlLmMqQsStTvVzZ])/))t[t.length]={type:woe,text:RegExp.$1},e=e.substr(RegExp.$1.length);else if(e.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))t[t.length]={type:y4,text:`${parseFloat(RegExp.$1)}`},e=e.substr(RegExp.$1.length);else return[];return t[t.length]={type:FB,text:""},t}function I8(e,t){return e.type===t}function V9(e){const t=[],n=_oe(e);let i="BOD",s=0,r=n[s];for(;!I8(r,FB);){let o=0;const a=[];if(i==="BOD")if(r.text==="M"||r.text==="m")s++,o=DU[r.text],i=r.text;else return V9("M0,0"+e);else I8(r,y4)?o=DU[i]:(s++,o=DU[r.text],i=r.text);if(s+o<n.length){for(let l=s;l<s+o;l++){const c=n[l];if(I8(c,y4))a[a.length]=+c.text;else throw new Error("Param not a number: "+i+","+c.text)}if(typeof DU[i]=="number"){const l={key:i,data:a};t.push(l),s+=o,r=n[s],i==="M"&&(i="L"),i==="m"&&(i="l")}else throw new Error("Bad segment: "+i)}else throw new Error("Path data ended short")}return t}function BB(e){let t=0,n=0,i=0,s=0;const r=[];for(const{key:o,data:a}of e)switch(o){case"M":r.push({key:"M",data:[...a]}),[t,n]=a,[i,s]=a;break;case"m":t+=a[0],n+=a[1],r.push({key:"M",data:[t,n]}),i=t,s=n;break;case"L":r.push({key:"L",data:[...a]}),[t,n]=a;break;case"l":t+=a[0],n+=a[1],r.push({key:"L",data:[t,n]});break;case"C":r.push({key:"C",data:[...a]}),t=a[4],n=a[5];break;case"c":{const l=a.map((c,u)=>u%2?c+n:c+t);r.push({key:"C",data:l}),t=l[4],n=l[5];break}case"Q":r.push({key:"Q",data:[...a]}),t=a[2],n=a[3];break;case"q":{const l=a.map((c,u)=>u%2?c+n:c+t);r.push({key:"Q",data:l}),t=l[2],n=l[3];break}case"A":r.push({key:"A",data:[...a]}),t=a[5],n=a[6];break;case"a":t+=a[5],n+=a[6],r.push({key:"A",data:[a[0],a[1],a[2],a[3],a[4],t,n]});break;case"H":r.push({key:"H",data:[...a]}),t=a[0];break;case"h":t+=a[0],r.push({key:"H",data:[t]});break;case"V":r.push({key:"V",data:[...a]}),n=a[0];break;case"v":n+=a[0],r.push({key:"V",data:[n]});break;case"S":r.push({key:"S",data:[...a]}),t=a[2],n=a[3];break;case"s":{const l=a.map((c,u)=>u%2?c+n:c+t);r.push({key:"S",data:l}),t=l[2],n=l[3];break}case"T":r.push({key:"T",data:[...a]}),t=a[0],n=a[1];break;case"t":t+=a[0],n+=a[1],r.push({key:"T",data:[t,n]});break;case"Z":case"z":r.push({key:"Z",data:[]}),t=i,n=s;break}return r}function zB(e){const t=[];let n="",i=0,s=0,r=0,o=0,a=0,l=0;for(const{key:c,data:u}of e){switch(c){case"M":t.push({key:"M",data:[...u]}),[i,s]=u,[r,o]=u;break;case"C":t.push({key:"C",data:[...u]}),i=u[4],s=u[5],a=u[2],l=u[3];break;case"L":t.push({key:"L",data:[...u]}),[i,s]=u;break;case"H":i=u[0],t.push({key:"L",data:[i,s]});break;case"V":s=u[0],t.push({key:"L",data:[i,s]});break;case"S":{let d=0,f=0;n==="C"||n==="S"?(d=i+(i-a),f=s+(s-l)):(d=i,f=s),t.push({key:"C",data:[d,f,...u]}),a=u[0],l=u[1],i=u[2],s=u[3];break}case"T":{const[d,f]=u;let h=0,m=0;n==="Q"||n==="T"?(h=i+(i-a),m=s+(s-l)):(h=i,m=s);const p=i+2*(h-i)/3,U=s+2*(m-s)/3,b=d+2*(h-d)/3,y=f+2*(m-f)/3;t.push({key:"C",data:[p,U,b,y,d,f]}),a=h,l=m,i=d,s=f;break}case"Q":{const[d,f,h,m]=u,p=i+2*(d-i)/3,U=s+2*(f-s)/3,b=h+2*(d-h)/3,y=m+2*(f-m)/3;t.push({key:"C",data:[p,U,b,y,h,m]}),a=d,l=f,i=h,s=m;break}case"A":{const d=Math.abs(u[0]),f=Math.abs(u[1]),h=u[2],m=u[3],p=u[4],U=u[5],b=u[6];d===0||f===0?(t.push({key:"C",data:[i,s,U,b,U,b]}),i=U,s=b):(i!==U||s!==b)&&(HB(i,s,U,b,d,f,h,m,p).forEach(function(w){t.push({key:"C",data:w})}),i=U,s=b);break}case"Z":t.push({key:"Z",data:[]}),i=r,s=o;break}n=c}return t}function Toe(e){return Math.PI*e/180}function o1(e,t,n){const i=e*Math.cos(n)-t*Math.sin(n),s=e*Math.sin(n)+t*Math.cos(n);return[i,s]}function HB(e,t,n,i,s,r,o,a,l,c){const u=Toe(o);let d=[],f=0,h=0,m=0,p=0;if(c)[f,h,m,p]=c;else{[e,t]=o1(e,t,-u),[n,i]=o1(n,i,-u);const P=(e-n)/2,L=(t-i)/2;let X=P*P/(s*s)+L*L/(r*r);X>1&&(X=Math.sqrt(X),s=X*s,r=X*r);const G=a===l?-1:1,z=s*s,V=r*r,$=z*V-z*L*L-V*P*P,j=z*L*L+V*P*P,W=G*Math.sqrt(Math.abs($/j));m=W*s*L/r+(e+n)/2,p=W*-r*P/s+(t+i)/2,f=Math.asin(parseFloat(((t-p)/r).toFixed(9))),h=Math.asin(parseFloat(((i-p)/r).toFixed(9))),e<m&&(f=Math.PI-f),n<m&&(h=Math.PI-h),f<0&&(f=Math.PI*2+f),h<0&&(h=Math.PI*2+h),l&&f>h&&(f=f-Math.PI*2),!l&&h>f&&(h=h-Math.PI*2)}let U=h-f;if(Math.abs(U)>Math.PI*120/180){const P=h,L=n,X=i;l&&h>f?h=f+Math.PI*120/180*1:h=f+Math.PI*120/180*-1,n=m+s*Math.cos(h),i=p+r*Math.sin(h),d=HB(n,i,L,X,s,r,o,0,l,[h,P,m,p])}U=h-f;const b=Math.cos(f),y=Math.sin(f),w=Math.cos(h),v=Math.sin(h),I=Math.tan(U/4),C=4/3*s*I,_=4/3*r*I,T=[e,t],k=[e+C*y,t-_*b],S=[n+C*v,i-_*w],R=[n,i];if(k[0]=2*T[0]-k[0],k[1]=2*T[1]-k[1],c)return[k,S,R].concat(d);{d=[k,S,R].concat(d);const P=[];for(let L=0;L<d.length;L+=3){const X=o1(d[L][0],d[L][1],u),G=o1(d[L+1][0],d[L+1][1],u),z=o1(d[L+2][0],d[L+2][1],u);P.push([X[0],X[1],G[0],G[1],z[0],z[1]])}return P}}const Ioe={randOffset:Moe,randOffsetWithRange:koe,ellipse:Coe,doubleLineOps:Roe};function VB(e,t,n,i,s){return{type:"path",ops:ol(e,t,n,i,s)}}function M2(e,t,n){const i=(e||[]).length;if(i>2){const s=[];for(let r=0;r<i-1;r++)s.push(...ol(e[r][0],e[r][1],e[r+1][0],e[r+1][1],n));return t&&s.push(...ol(e[i-1][0],e[i-1][1],e[0][0],e[0][1],n)),{type:"path",ops:s}}else if(i===2)return VB(e[0][0],e[0][1],e[1][0],e[1][1],n);return{type:"path",ops:[]}}function Soe(e,t){return M2(e,!0,t)}function xoe(e,t,n,i,s){const r=[[e,t],[e+n,t],[e+n,t+i],[e,t+i]];return Soe(r,s)}function IA(e,t){let n=AA(e,1*(1+t.roughness*.2),t);if(!t.disableMultiStroke){const i=AA(e,1.5*(1+t.roughness*.22),Doe(t));n=n.concat(i)}return{type:"path",ops:n}}function Coe(e,t,n,i,s){const r=$B(n,i,s);return E4(e,t,s,r).opset}function $B(e,t,n){const i=Math.sqrt(Math.PI*2*Math.sqrt((Math.pow(e/2,2)+Math.pow(t/2,2))/2)),s=Math.ceil(Math.max(n.curveStepCount,n.curveStepCount/Math.sqrt(200)*i)),r=Math.PI*2/s;let o=Math.abs(e/2),a=Math.abs(t/2);const l=1-n.curveFitting;return o+=Oe(o*l,n),a+=Oe(a*l,n),{increment:r,rx:o,ry:a}}function E4(e,t,n,i){const[s,r]=MA(i.increment,e,t,i.rx,i.ry,1,i.increment*e6(.1,e6(.4,1,n),n),n);let o=t6(s,null,n);if(!n.disableMultiStroke&&n.roughness!==0){const[a]=MA(i.increment,e,t,i.rx,i.ry,1.5,0,n),l=t6(a,null,n);o=o.concat(l)}return{estimatedPoints:r,opset:{type:"path",ops:o}}}function SA(e,t,n,i,s,r,o,a,l){const c=e,u=t;let d=Math.abs(n/2),f=Math.abs(i/2);d+=Oe(d*.01,l),f+=Oe(f*.01,l);let h=s,m=r;for(;h<0;)h+=Math.PI*2,m+=Math.PI*2;m-h>Math.PI*2&&(h=0,m=Math.PI*2);const p=Math.PI*2/l.curveStepCount,U=Math.min(p/2,(m-h)/2),b=kA(U,c,u,d,f,h,m,1,l);if(!l.disableMultiStroke){const y=kA(U,c,u,d,f,h,m,1.5,l);b.push(...y)}return o&&(a?b.push(...ol(c,u,c+d*Math.cos(h),u+f*Math.sin(h),l),...ol(c,u,c+d*Math.cos(m),u+f*Math.sin(m),l)):b.push({op:"lineTo",data:[c,u]},{op:"lineTo",data:[c+d*Math.cos(h),u+f*Math.sin(h)]})),{type:"path",ops:b}}function xA(e,t){const n=zB(BB(V9(e))),i=[];let s=[0,0],r=[0,0];for(const{key:o,data:a}of n)switch(o){case"M":{r=[a[0],a[1]],s=[a[0],a[1]];break}case"L":i.push(...ol(r[0],r[1],a[0],a[1],t)),r=[a[0],a[1]];break;case"C":{const[l,c,u,d,f,h]=a;i.push(...Loe(l,c,u,d,f,h,r,t)),r=[f,h];break}case"Z":i.push(...ol(r[0],r[1],s[0],s[1],t)),r=[s[0],s[1]];break}return{type:"path",ops:i}}function S8(e,t){const n=[];for(const i of e)if(i.length){const s=t.maxRandomnessOffset||0,r=i.length;if(r>2){n.push({op:"move",data:[i[0][0]+Oe(s,t),i[0][1]+Oe(s,t)]});for(let o=1;o<r;o++)n.push({op:"lineTo",data:[i[o][0]+Oe(s,t),i[o][1]+Oe(s,t)]})}}return{type:"fillPath",ops:n}}function yf(e,t){return voe(t,Ioe).fillPolygons(e,t)}function Aoe(e,t,n,i,s,r,o){const a=e,l=t;let c=Math.abs(n/2),u=Math.abs(i/2);c+=Oe(c*.01,o),u+=Oe(u*.01,o);let d=s,f=r;for(;d<0;)d+=Math.PI*2,f+=Math.PI*2;f-d>Math.PI*2&&(d=0,f=Math.PI*2);const h=(f-d)/o.curveStepCount,m=[];for(let p=d;p<=f;p=p+h)m.push([a+c*Math.cos(p),l+u*Math.sin(p)]);return m.push([a+c*Math.cos(f),l+u*Math.sin(f)]),m.push([a,l]),yf([m],o)}function Moe(e,t){return Oe(e,t)}function koe(e,t,n){return e6(e,t,n)}function Roe(e,t,n,i,s){return ol(e,t,n,i,s,!0)}function Doe(e){const t=Object.assign({},e);return t.randomizer=void 0,e.seed&&(t.seed=e.seed+1),t}function GB(e){return e.randomizer||(e.randomizer=new TB(e.seed||0)),e.randomizer.next()}function e6(e,t,n,i=1){return n.roughness*i*(GB(n)*(t-e)+e)}function Oe(e,t,n=1){return e6(-e,e,t,n)}function ol(e,t,n,i,s,r=!1){const o=r?s.disableMultiStrokeFill:s.disableMultiStroke,a=CA(e,t,n,i,s,!0,!1);if(o)return a;const l=CA(e,t,n,i,s,!0,!0);return a.concat(l)}function CA(e,t,n,i,s,r,o){const a=Math.pow(e-n,2)+Math.pow(t-i,2),l=Math.sqrt(a);let c=1;l<200?c=1:l>500?c=.4:c=-.0016668*l+1.233334;let u=s.maxRandomnessOffset||0;u*u*100>a&&(u=l/10);const d=u/2,f=.2+GB(s)*.2;let h=s.bowing*s.maxRandomnessOffset*(i-t)/200,m=s.bowing*s.maxRandomnessOffset*(e-n)/200;h=Oe(h,s,c),m=Oe(m,s,c);const p=[],U=()=>Oe(d,s,c),b=()=>Oe(u,s,c),y=s.preserveVertices;return o?p.push({op:"move",data:[e+(y?0:U()),t+(y?0:U())]}):p.push({op:"move",data:[e+(y?0:Oe(u,s,c)),t+(y?0:Oe(u,s,c))]}),o?p.push({op:"bcurveTo",data:[h+e+(n-e)*f+U(),m+t+(i-t)*f+U(),h+e+2*(n-e)*f+U(),m+t+2*(i-t)*f+U(),n+(y?0:U()),i+(y?0:U())]}):p.push({op:"bcurveTo",data:[h+e+(n-e)*f+b(),m+t+(i-t)*f+b(),h+e+2*(n-e)*f+b(),m+t+2*(i-t)*f+b(),n+(y?0:b()),i+(y?0:b())]}),p}function AA(e,t,n){const i=[];i.push([e[0][0]+Oe(t,n),e[0][1]+Oe(t,n)]),i.push([e[0][0]+Oe(t,n),e[0][1]+Oe(t,n)]);for(let s=1;s<e.length;s++)i.push([e[s][0]+Oe(t,n),e[s][1]+Oe(t,n)]),s===e.length-1&&i.push([e[s][0]+Oe(t,n),e[s][1]+Oe(t,n)]);return t6(i,null,n)}function t6(e,t,n){const i=e.length,s=[];if(i>3){const r=[],o=1-n.curveTightness;s.push({op:"move",data:[e[1][0],e[1][1]]});for(let a=1;a+2<i;a++){const l=e[a];r[0]=[l[0],l[1]],r[1]=[l[0]+(o*e[a+1][0]-o*e[a-1][0])/6,l[1]+(o*e[a+1][1]-o*e[a-1][1])/6],r[2]=[e[a+1][0]+(o*e[a][0]-o*e[a+2][0])/6,e[a+1][1]+(o*e[a][1]-o*e[a+2][1])/6],r[3]=[e[a+1][0],e[a+1][1]],s.push({op:"bcurveTo",data:[r[1][0],r[1][1],r[2][0],r[2][1],r[3][0],r[3][1]]})}}else i===3?(s.push({op:"move",data:[e[1][0],e[1][1]]}),s.push({op:"bcurveTo",data:[e[1][0],e[1][1],e[2][0],e[2][1],e[2][0],e[2][1]]})):i===2&&s.push(...ol(e[0][0],e[0][1],e[1][0],e[1][1],n));return s}function MA(e,t,n,i,s,r,o,a){const l=a.roughness===0,c=[],u=[];if(l){e=e/4,u.push([t+i*Math.cos(-e),n+s*Math.sin(-e)]);for(let d=0;d<=Math.PI*2;d=d+e){const f=[t+i*Math.cos(d),n+s*Math.sin(d)];c.push(f),u.push(f)}u.push([t+i*Math.cos(0),n+s*Math.sin(0)]),u.push([t+i*Math.cos(e),n+s*Math.sin(e)])}else{const d=Oe(.5,a)-Math.PI/2;u.push([Oe(r,a)+t+.9*i*Math.cos(d-e),Oe(r,a)+n+.9*s*Math.sin(d-e)]);const f=Math.PI*2+d-.01;for(let h=d;h<f;h=h+e){const m=[Oe(r,a)+t+i*Math.cos(h),Oe(r,a)+n+s*Math.sin(h)];c.push(m),u.push(m)}u.push([Oe(r,a)+t+i*Math.cos(d+Math.PI*2+o*.5),Oe(r,a)+n+s*Math.sin(d+Math.PI*2+o*.5)]),u.push([Oe(r,a)+t+.98*i*Math.cos(d+o),Oe(r,a)+n+.98*s*Math.sin(d+o)]),u.push([Oe(r,a)+t+.9*i*Math.cos(d+o*.5),Oe(r,a)+n+.9*s*Math.sin(d+o*.5)])}return[u,c]}function kA(e,t,n,i,s,r,o,a,l){const c=r+Oe(.1,l),u=[];u.push([Oe(a,l)+t+.9*i*Math.cos(c-e),Oe(a,l)+n+.9*s*Math.sin(c-e)]);for(let d=c;d<=o;d=d+e)u.push([Oe(a,l)+t+i*Math.cos(d),Oe(a,l)+n+s*Math.sin(d)]);return u.push([t+i*Math.cos(o),n+s*Math.sin(o)]),u.push([t+i*Math.cos(o),n+s*Math.sin(o)]),t6(u,null,l)}function Loe(e,t,n,i,s,r,o,a){const l=[],c=[a.maxRandomnessOffset||1,(a.maxRandomnessOffset||1)+.3];let u=[0,0];const d=a.disableMultiStroke?1:2,f=a.preserveVertices;for(let h=0;h<d;h++)h===0?l.push({op:"move",data:[o[0],o[1]]}):l.push({op:"move",data:[o[0]+(f?0:Oe(c[0],a)),o[1]+(f?0:Oe(c[0],a))]}),u=f?[s,r]:[s+Oe(c[h],a),r+Oe(c[h],a)],l.push({op:"bcurveTo",data:[e+Oe(c[h],a),t+Oe(c[h],a),n+Oe(c[h],a),i+Oe(c[h],a),u[0],u[1]]});return l}function a1(e){return[...e]}function Noe(e,t=0){const n=e.length;if(n<3)throw new Error("A curve must have at least three points.");const i=[];if(n===3)i.push(a1(e[0]),a1(e[1]),a1(e[2]),a1(e[2]));else{const s=[];s.push(e[0],e[0]);for(let a=1;a<e.length;a++)s.push(e[a]),a===e.length-1&&s.push(e[a]);const r=[],o=1-t;i.push(a1(s[0]));for(let a=1;a+2<s.length;a++){const l=s[a];r[0]=[l[0],l[1]],r[1]=[l[0]+(o*s[a+1][0]-o*s[a-1][0])/6,l[1]+(o*s[a+1][1]-o*s[a-1][1])/6],r[2]=[s[a+1][0]+(o*s[a][0]-o*s[a+2][0])/6,s[a+1][1]+(o*s[a][1]-o*s[a+2][1])/6],r[3]=[s[a+1][0],s[a+1][1]],i.push(r[1],r[2],r[3])}}return i}function Ooe(e,t){return Math.sqrt(k2(e,t))}function k2(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)}function Poe(e,t,n){const i=k2(t,n);if(i===0)return k2(e,t);let s=((e[0]-t[0])*(n[0]-t[0])+(e[1]-t[1])*(n[1]-t[1]))/i;return s=Math.max(0,Math.min(1,s)),k2(e,vu(t,n,s))}function vu(e,t,n){return[e[0]+(t[0]-e[0])*n,e[1]+(t[1]-e[1])*n]}function Foe(e,t){const n=e[t+0],i=e[t+1],s=e[t+2],r=e[t+3];let o=3*i[0]-2*n[0]-r[0];o*=o;let a=3*i[1]-2*n[1]-r[1];a*=a;let l=3*s[0]-2*r[0]-n[0];l*=l;let c=3*s[1]-2*r[1]-n[1];return c*=c,o<l&&(o=l),a<c&&(a=c),o+a}function v4(e,t,n,i){const s=i||[];if(Foe(e,t)<n){const r=e[t+0];s.length?Ooe(s[s.length-1],r)>1&&s.push(r):s.push(r),s.push(e[t+3])}else{const o=e[t+0],a=e[t+1],l=e[t+2],c=e[t+3],u=vu(o,a,.5),d=vu(a,l,.5),f=vu(l,c,.5),h=vu(u,d,.5),m=vu(d,f,.5),p=vu(h,m,.5);v4([o,u,h,p],0,n,s),v4([p,m,f,c],0,n,s)}return s}function $9(e,t){return n6(e,0,e.length,t)}function n6(e,t,n,i,s){const r=s||[],o=e[t],a=e[n-1];let l=0,c=1;for(let u=t+1;u<n-1;++u){const d=Poe(e[u],o,a);d>l&&(l=d,c=u)}return Math.sqrt(l)>i?(n6(e,t,c+1,i,r),n6(e,c,n,i,r)):(r.length||r.push(o),r.push(a)),r}function Up(e,t=.15,n){const i=[],s=(e.length-1)/3;for(let r=0;r<s;r++){const o=r*3;v4(e,o,t,i)}return n&&n>0?n6(i,0,i.length,n):i}function Boe(e,t,n){const i=V9(e),s=zB(BB(i)),r=[];let o=[],a=[0,0],l=[];const c=()=>{l.length>=4&&o.push(...Up(l,t)),l=[]},u=()=>{c(),o.length&&(r.push(o),o=[])};for(const{key:f,data:h}of s)switch(f){case"M":u(),a=[h[0],h[1]],o.push(a);break;case"L":c(),o.push([h[0],h[1]]);break;case"C":if(!l.length){const m=o.length?o[o.length-1]:a;l.push([m[0],m[1]])}l.push([h[0],h[1]]),l.push([h[2],h[3]]),l.push([h[4],h[5]]);break;case"Z":c(),o.push([a[0],a[1]]);break}if(u(),!n)return r;const d=[];for(const f of r){const h=$9(f,n);h.length&&d.push(h)}return d}const Ds="none";class Ph{constructor(t){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=t||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return mre()}_o(t){return t?Object.assign({},this.defaultOptions,t):this.defaultOptions}_d(t,n,i){return{shape:t,sets:n||[],options:i||this.defaultOptions}}line(t,n,i,s,r){const o=this._o(r);return this._d("line",[VB(t,n,i,s,o)],o)}rectangle(t,n,i,s,r){const o=this._o(r),a=[],l=xoe(t,n,i,s,o);if(o.fill){const c=[[t,n],[t+i,n],[t+i,n+s],[t,n+s]];o.fillStyle==="solid"?a.push(S8([c],o)):a.push(yf([c],o))}return o.stroke!==Ds&&a.push(l),this._d("rectangle",a,o)}ellipse(t,n,i,s,r){const o=this._o(r),a=[],l=$B(i,s,o),c=E4(t,n,o,l);if(o.fill)if(o.fillStyle==="solid"){const u=E4(t,n,o,l).opset;u.type="fillPath",a.push(u)}else a.push(yf([c.estimatedPoints],o));return o.stroke!==Ds&&a.push(c.opset),this._d("ellipse",a,o)}circle(t,n,i,s){const r=this.ellipse(t,n,i,i,s);return r.shape="circle",r}linearPath(t,n){const i=this._o(n);return this._d("linearPath",[M2(t,!1,i)],i)}arc(t,n,i,s,r,o,a=!1,l){const c=this._o(l),u=[],d=SA(t,n,i,s,r,o,a,!0,c);if(a&&c.fill)if(c.fillStyle==="solid"){const f=Object.assign({},c);f.disableMultiStroke=!0;const h=SA(t,n,i,s,r,o,!0,!1,f);h.type="fillPath",u.push(h)}else u.push(Aoe(t,n,i,s,r,o,c));return c.stroke!==Ds&&u.push(d),this._d("arc",u,c)}curve(t,n){const i=this._o(n),s=[],r=IA(t,i);if(i.fill&&i.fill!==Ds&&t.length>=3)if(i.fillStyle==="solid"){const o=IA(t,Object.assign(Object.assign({},i),{disableMultiStroke:!0,roughness:i.roughness?i.roughness+i.fillShapeRoughnessGain:0}));s.push({type:"fillPath",ops:this._mergedShape(o.ops)})}else{const o=Noe(t),a=Up(o,10,(1+i.roughness)/2);s.push(yf([a],i))}return i.stroke!==Ds&&s.push(r),this._d("curve",s,i)}polygon(t,n){const i=this._o(n),s=[],r=M2(t,!0,i);return i.fill&&(i.fillStyle==="solid"?s.push(S8([t],i)):s.push(yf([t],i))),i.stroke!==Ds&&s.push(r),this._d("polygon",s,i)}path(t,n){const i=this._o(n),s=[];if(!t)return this._d("path",s,i);t=(t||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");const r=i.fill&&i.fill!=="transparent"&&i.fill!==Ds,o=i.stroke!==Ds,a=!!(i.simplification&&i.simplification<1),l=a?4-4*(i.simplification||1):(1+i.roughness)/2,c=Boe(t,1,l),u=xA(t,i);if(r)if(i.fillStyle==="solid")if(c.length===1){const d=xA(t,Object.assign(Object.assign({},i),{disableMultiStroke:!0,roughness:i.roughness?i.roughness+i.fillShapeRoughnessGain:0}));s.push({type:"fillPath",ops:this._mergedShape(d.ops)})}else s.push(S8(c,i));else s.push(yf(c,i));return o&&(a?c.forEach(d=>{s.push(M2(d,!1,i))}):s.push(u)),this._d("path",s,i)}opsToPath(t,n){let i="";for(const s of t.ops){const r=typeof n=="number"&&n>=0?s.data.map(o=>+o.toFixed(n)):s.data;switch(s.op){case"move":i+=`M${r[0]} ${r[1]} `;break;case"bcurveTo":i+=`C${r[0]} ${r[1]}, ${r[2]} ${r[3]}, ${r[4]} ${r[5]} `;break;case"lineTo":i+=`L${r[0]} ${r[1]} `;break}}return i.trim()}toPaths(t){const n=t.sets||[],i=t.options||this.defaultOptions,s=[];for(const r of n){let o=null;switch(r.type){case"path":o={d:this.opsToPath(r),stroke:i.stroke,strokeWidth:i.strokeWidth,fill:Ds};break;case"fillPath":o={d:this.opsToPath(r),stroke:Ds,strokeWidth:0,fill:i.fill||Ds};break;case"fillSketch":o=this.fillSketch(r,i);break}o&&s.push(o)}return s}fillSketch(t,n){let i=n.fillWeight;return i<0&&(i=n.strokeWidth/2),{d:this.opsToPath(t),stroke:n.fill||Ds,strokeWidth:i,fill:Ds}}_mergedShape(t){return t.filter((n,i)=>i===0?!0:n.op!=="move")}}class zoe{constructor(t,n){this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.gen=new Ph(n)}draw(t){const n=t.sets||[],i=t.options||this.getDefaultOptions(),s=this.ctx,r=t.options.fixedDecimalPlaceDigits;for(const o of n)switch(o.type){case"path":s.save(),s.strokeStyle=i.stroke==="none"?"transparent":i.stroke,s.lineWidth=i.strokeWidth,i.strokeLineDash&&s.setLineDash(i.strokeLineDash),i.strokeLineDashOffset&&(s.lineDashOffset=i.strokeLineDashOffset),this._drawToContext(s,o,r),s.restore();break;case"fillPath":{s.save(),s.fillStyle=i.fill||"";const a=t.shape==="curve"||t.shape==="polygon"||t.shape==="path"?"evenodd":"nonzero";this._drawToContext(s,o,r,a),s.restore();break}case"fillSketch":this.fillSketch(s,o,i);break}}fillSketch(t,n,i){let s=i.fillWeight;s<0&&(s=i.strokeWidth/2),t.save(),i.fillLineDash&&t.setLineDash(i.fillLineDash),i.fillLineDashOffset&&(t.lineDashOffset=i.fillLineDashOffset),t.strokeStyle=i.fill||"",t.lineWidth=s,this._drawToContext(t,n,i.fixedDecimalPlaceDigits),t.restore()}_drawToContext(t,n,i,s="nonzero"){t.beginPath();for(const r of n.ops){const o=typeof i=="number"&&i>=0?r.data.map(a=>+a.toFixed(i)):r.data;switch(r.op){case"move":t.moveTo(o[0],o[1]);break;case"bcurveTo":t.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5]);break;case"lineTo":t.lineTo(o[0],o[1]);break}}n.type==="fillPath"?t.fill(s):t.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(t,n,i,s,r){const o=this.gen.line(t,n,i,s,r);return this.draw(o),o}rectangle(t,n,i,s,r){const o=this.gen.rectangle(t,n,i,s,r);return this.draw(o),o}ellipse(t,n,i,s,r){const o=this.gen.ellipse(t,n,i,s,r);return this.draw(o),o}circle(t,n,i,s){const r=this.gen.circle(t,n,i,s);return this.draw(r),r}linearPath(t,n){const i=this.gen.linearPath(t,n);return this.draw(i),i}polygon(t,n){const i=this.gen.polygon(t,n);return this.draw(i),i}arc(t,n,i,s,r,o,a=!1,l){const c=this.gen.arc(t,n,i,s,r,o,a,l);return this.draw(c),c}curve(t,n){const i=this.gen.curve(t,n);return this.draw(i),i}path(t,n){const i=this.gen.path(t,n);return this.draw(i),i}}const LU="http://www.w3.org/2000/svg";class Hoe{constructor(t,n){this.svg=t,this.gen=new Ph(n)}draw(t){const n=t.sets||[],i=t.options||this.getDefaultOptions(),s=this.svg.ownerDocument||window.document,r=s.createElementNS(LU,"g"),o=t.options.fixedDecimalPlaceDigits;for(const a of n){let l=null;switch(a.type){case"path":{l=s.createElementNS(LU,"path"),l.setAttribute("d",this.opsToPath(a,o)),l.setAttribute("stroke",i.stroke),l.setAttribute("stroke-width",i.strokeWidth+""),l.setAttribute("fill","none"),i.strokeLineDash&&l.setAttribute("stroke-dasharray",i.strokeLineDash.join(" ").trim()),i.strokeLineDashOffset&&l.setAttribute("stroke-dashoffset",`${i.strokeLineDashOffset}`);break}case"fillPath":{l=s.createElementNS(LU,"path"),l.setAttribute("d",this.opsToPath(a,o)),l.setAttribute("stroke","none"),l.setAttribute("stroke-width","0"),l.setAttribute("fill",i.fill||""),(t.shape==="curve"||t.shape==="polygon")&&l.setAttribute("fill-rule","evenodd");break}case"fillSketch":{l=this.fillSketch(s,a,i);break}}l&&r.appendChild(l)}return r}fillSketch(t,n,i){let s=i.fillWeight;s<0&&(s=i.strokeWidth/2);const r=t.createElementNS(LU,"path");return r.setAttribute("d",this.opsToPath(n,i.fixedDecimalPlaceDigits)),r.setAttribute("stroke",i.fill||""),r.setAttribute("stroke-width",s+""),r.setAttribute("fill","none"),i.fillLineDash&&r.setAttribute("stroke-dasharray",i.fillLineDash.join(" ").trim()),i.fillLineDashOffset&&r.setAttribute("stroke-dashoffset",`${i.fillLineDashOffset}`),r}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(t,n){return this.gen.opsToPath(t,n)}line(t,n,i,s,r){const o=this.gen.line(t,n,i,s,r);return this.draw(o)}rectangle(t,n,i,s,r){const o=this.gen.rectangle(t,n,i,s,r);return this.draw(o)}ellipse(t,n,i,s,r){const o=this.gen.ellipse(t,n,i,s,r);return this.draw(o)}circle(t,n,i,s){const r=this.gen.circle(t,n,i,s);return this.draw(r)}linearPath(t,n){const i=this.gen.linearPath(t,n);return this.draw(i)}polygon(t,n){const i=this.gen.polygon(t,n);return this.draw(i)}arc(t,n,i,s,r,o,a=!1,l){const c=this.gen.arc(t,n,i,s,r,o,a,l);return this.draw(c)}curve(t,n){const i=this.gen.curve(t,n);return this.draw(i)}path(t,n){const i=this.gen.path(t,n);return this.draw(i)}}const nu={canvas(e,t){return new zoe(e,t)},svg(e,t){return new Hoe(e,t)},generator(e){return new Ph(e)},newSeed(){return Ph.newSeed()}};let XB=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((t,n)=>(n&=63,n<36?t+=n.toString(36):n<62?t+=(n-26).toString(36).toUpperCase():n>62?t+="-":t+="_",t),"");const Voe=e=>{const{angle:t,width:n,height:i,x:s,y:r}=e,o=s+n/2,a=r+i/2,l=x(o,a);let c;return e.type==="diamond"?c=g4(q(x(o,r),l,t),q(x(s+n,a),l,t),q(x(o,r+i),l,t),q(x(s,a),l,t)):c=g4(q(x(s,r),l,t),q(x(s+n,r),l,t),q(x(s+n,r+i),l,t),q(x(s,r+i),l,t)),{type:"polygon",data:c}},$oe=e=>{const{width:t,height:n,angle:i,x:s,y:r}=e;return{type:"ellipse",data:{center:x(s+t/2,r+n/2),angle:i,halfWidth:t/2,halfHeight:n/2}}},Fd=e=>{if(!e)return[];for(const t of e.sets)if(t.type==="path")return t.ops;return e.sets[0].ops},Goe=(e,t=x(0,0),n,i)=>{const s=l=>q(x(l[0]+t[0],l[1]+t[1]),i,n),r=Fd(e),o=[];let a=x(0,0);for(const l of r){if(l.op==="move"){const c=X5(l.data);gn(c!=null,"Ops data is not a point"),a=s(c)}if(l.op==="bcurveTo"){const c=s(x(l.data[0],l.data[1])),u=s(x(l.data[2],l.data[3])),d=s(x(l.data[4],l.data[5]));o.push(zn(a,c,u,d)),a=d}}return{type:"polycurve",data:o}},Xoe=e=>{let t=e[0];const n=[];for(let i=1;i<e.length;i++){const s=e[i];n.push(Ae(t,s)),t=s}return n},joe=(e,t,n=!1)=>{const i=r=>q(bi(Hf(ue(r),pn(e.x,e.y))),t,e.angle),s=Xoe(e.points.map(r=>i(r)));return n?{type:"polygon",data:Kb(s.flat())}:{type:"polyline",data:s}},Yoe=(e,t,n=x(0,0),i,s)=>{const r=u=>q(x(u[0]+n[0],u[1]+n[1]),s,i);if(e.roundness===null)return{type:"polygon",data:Kb(e.points.map(u=>r(u)))};const o=Fd(t),a=[];let l=!1;for(const u of o)u.op==="move"?(l=!l,l&&a.push(x(u.data[0],u.data[1]))):u.op==="bcurveTo"?l&&(a.push(x(u.data[0],u.data[1])),a.push(x(u.data[2],u.data[3])),a.push(x(u.data[4],u.data[5]))):u.op==="lineTo"&&l&&a.push(x(u.data[0],u.data[1]));const c=Up(a,10,5).map(u=>r(u));return{type:"polygon",data:Kb(c)}};function RA(e,t,n,i=s=>s){return e*i(.5-t*(.5-n))}function Woe(e){return[-e[0],-e[1]]}function Hr(e,t){return[e[0]+t[0],e[1]+t[1]]}function lr(e,t){return[e[0]-t[0],e[1]-t[1]]}function Br(e,t){return[e[0]*t,e[1]*t]}function Koe(e,t){return[e[0]/t,e[1]/t]}function l1(e){return[e[1],-e[0]]}function DA(e,t){return e[0]*t[0]+e[1]*t[1]}function Zoe(e,t){return e[0]===t[0]&&e[1]===t[1]}function qoe(e){return Math.hypot(e[0],e[1])}function Qoe(e){return e[0]*e[0]+e[1]*e[1]}function LA(e,t){return Qoe(lr(e,t))}function jB(e){return Koe(e,qoe(e))}function Joe(e,t){return Math.hypot(e[1]-t[1],e[0]-t[0])}function c1(e,t,n){let i=Math.sin(n),s=Math.cos(n),r=e[0]-t[0],o=e[1]-t[1],a=r*s-o*i,l=r*i+o*s;return[a+t[0],l+t[1]]}function w4(e,t,n){return Hr(e,Br(lr(t,e),n))}function NA(e,t,n){return Hr(e,Br(t,n))}var{min:nf,PI:eae}=Math,OA=.275,u1=eae+1e-4;function tae(e,t={}){let{size:n=16,smoothing:i=.5,thinning:s=.5,simulatePressure:r=!0,easing:o=V=>V,start:a={},end:l={},last:c=!1}=t,{cap:u=!0,easing:d=V=>V*(2-V)}=a,{cap:f=!0,easing:h=V=>--V*V*V+1}=l;if(e.length===0||n<=0)return[];let m=e[e.length-1].runningLength,p=a.taper===!1?0:a.taper===!0?Math.max(n,m):a.taper,U=l.taper===!1?0:l.taper===!0?Math.max(n,m):l.taper,b=Math.pow(n*i,2),y=[],w=[],v=e.slice(0,10).reduce((V,$)=>{let j=$.pressure;if(r){let W=nf(1,$.distance/n),Q=nf(1,1-W);j=nf(1,V+(Q-V)*(W*OA))}return(V+j)/2},e[0].pressure),I=RA(n,s,e[e.length-1].pressure,o),C,_=e[0].vector,T=e[0].point,k=T,S=T,R=k,P=!1;for(let V=0;V<e.length;V++){let{pressure:$}=e[V],{point:j,vector:W,distance:Q,runningLength:oe}=e[V];if(V<e.length-1&&m-oe<3)continue;if(s){if(r){let je=nf(1,Q/n),lt=nf(1,1-je);$=nf(1,v+(lt-v)*(je*OA))}I=RA(n,s,$,o)}else I=n/2;C===void 0&&(C=I);let me=oe<p?d(oe/p):1,he=m-oe<U?h((m-oe)/U):1;I=Math.max(.01,I*Math.min(me,he));let Me=(V<e.length-1?e[V+1]:e[V]).vector,mt=V<e.length-1?DA(W,Me):1,We=DA(W,_)<0&&!P,Ht=mt!==null&&mt<0;if(We||Ht){let je=Br(l1(_),I);for(let lt=1/13,Vt=0;Vt<=1;Vt+=lt)S=c1(lr(j,je),j,u1*Vt),y.push(S),R=c1(Hr(j,je),j,u1*-Vt),w.push(R);T=S,k=R,Ht&&(P=!0);continue}if(P=!1,V===e.length-1){let je=Br(l1(W),I);y.push(lr(j,je)),w.push(Hr(j,je));continue}let fn=Br(l1(w4(Me,W,mt)),I);S=lr(j,fn),(V<=1||LA(T,S)>b)&&(y.push(S),T=S),R=Hr(j,fn),(V<=1||LA(k,R)>b)&&(w.push(R),k=R),v=$,_=W}let L=e[0].point.slice(0,2),X=e.length>1?e[e.length-1].point.slice(0,2):Hr(e[0].point,[1,1]),G=[],z=[];if(e.length===1){if(!(p||U)||c){let V=NA(L,jB(l1(lr(L,X))),-(C||I)),$=[];for(let j=1/13,W=j;W<=1;W+=j)$.push(c1(V,L,u1*2*W));return $}}else{if(!(p||U&&e.length===1))if(u)for(let $=1/13,j=$;j<=1;j+=$){let W=c1(w[0],L,u1*j);G.push(W)}else{let $=lr(y[0],w[0]),j=Br($,.5),W=Br($,.51);G.push(lr(L,j),lr(L,W),Hr(L,W),Hr(L,j))}let V=l1(Woe(e[e.length-1].vector));if(U||p&&e.length===1)z.push(X);else if(f){let $=NA(X,V,I);for(let j=1/29,W=j;W<1;W+=j)z.push(c1($,X,u1*3*W))}else z.push(Hr(X,Br(V,I)),Hr(X,Br(V,I*.99)),lr(X,Br(V,I*.99)),lr(X,Br(V,I)))}return y.concat(z,w.reverse(),G)}function nae(e,t={}){var n;let{streamline:i=.5,size:s=16,last:r=!1}=t;if(e.length===0)return[];let o=.15+(1-i)*.85,a=Array.isArray(e[0])?e:e.map(({x:h,y:m,pressure:p=.5})=>[h,m,p]);if(a.length===2){let h=a[1];a=a.slice(0,-1);for(let m=1;m<5;m++)a.push(w4(a[0],h,m/4))}a.length===1&&(a=[...a,[...Hr(a[0],[1,1]),...a[0].slice(2)]]);let l=[{point:[a[0][0],a[0][1]],pressure:a[0][2]>=0?a[0][2]:.25,vector:[1,1],distance:0,runningLength:0}],c=!1,u=0,d=l[0],f=a.length-1;for(let h=1;h<a.length;h++){let m=r&&h===f?a[h].slice(0,2):w4(d.point,a[h],o);if(Zoe(d.point,m))continue;let p=Joe(m,d.point);if(u+=p,h<f&&!c){if(u<s)continue;c=!0}d={point:m,pressure:a[h][2]>=0?a[h][2]:.5,vector:jB(lr(d.point,m)),distance:p,runningLength:u},l.push(d)}return l[0].vector=((n=l[1])==null?void 0:n.vector)||[0,0],l}function iae(e,t={}){return tae(nae(e,t),t)}const li=10,sae=(e,t,n,i,s,r,o,a)=>{var R,P;const{width:l,height:c}=al(e),u=i/l,d=s/c,f=(((R=e.crop)==null?void 0:R.x)??0)/u,h=(((P=e.crop)==null?void 0:P.y)??0)/d,m=q(x(r,o),ri(e,t),-e.angle);r=m[0],o=m[1];let p=e.width,U=e.height,b=e.crop??{x:0,y:0,width:i,height:s,naturalWidth:i,naturalHeight:s};const y=b.height,w=b.width,v=e.scale[0]===-1,I=e.scale[1]===-1;let C=o-e.y,_=r-e.x;n.includes("n")&&(U=Ke(e.height-C,li,I?c-h:e.height+h)),n.includes("s")&&(C=o-e.y-e.height,U=Ke(e.height+C,li,I?e.height+h:c-h)),n.includes("e")&&(_=r-e.x-e.width,p=Ke(e.width+_,li,v?e.width+f:l-f)),n.includes("w")&&(p=Ke(e.width-_,li,v?l-f:e.width+f));const T=L=>{L.height=U*d,L.width=p*u};T(b);const k=(L,X)=>{T(X),L.includes("n")&&(I||(X.y+=y-X.height)),L.includes("s")&&I&&(X.y+=y-X.height),L.includes("e")&&v&&(X.x+=w-X.width),L.includes("w")&&(v||(X.x+=w-X.width))};switch(n){case"n":{if(a){const L=f+e.width/2,X=l-f-e.width/2,G=Math.min(L,X)*2;p=Ke(U*a,li,G),U=p/a}k(n,b),a&&(b.x+=(w-b.width)/2);break}case"s":{if(a){const L=f+e.width/2,X=l-f-e.width/2,G=Math.min(L,X)*2;p=Ke(U*a,li,G),U=p/a}k(n,b),a&&(b.x+=(w-b.width)/2);break}case"w":{if(a){const L=h+e.height/2,X=c-h-e.height/2,G=Math.min(L,X)*2;U=Ke(p/a,li,G),p=U*a}k(n,b),a&&(b.y+=(y-b.height)/2);break}case"e":{if(a){const L=h+e.height/2,X=c-h-e.height/2,G=Math.min(L,X)*2;U=Ke(p/a,li,G),p=U*a}k(n,b),a&&(b.y+=(y-b.height)/2);break}case"ne":{if(a)if(_>-C){const L=I?c-h:h+e.height;U=Ke(p/a,li,L),p=U*a}else{const L=v?f+e.width:l-f;p=Ke(U*a,li,L),U=p/a}k(n,b);break}case"nw":{if(a)if(_<C){const L=I?c-h:h+e.height;U=Ke(p/a,li,L),p=U*a}else{const L=v?l-f:f+e.width;p=Ke(U*a,li,L),U=p/a}k(n,b);break}case"se":{if(a)if(_>C){const L=I?h+e.height:c-h;U=Ke(p/a,li,L),p=U*a}else{const L=v?f+e.width:l-f;p=Ke(U*a,li,L),U=p/a}k(n,b);break}case"sw":{if(a)if(-_>C){const L=I?h+e.height:c-h;U=Ke(p/a,li,L),p=U*a}else{const L=v?l-f:f+e.width;p=Ke(U*a,li,L),U=p/a}k(n,b);break}}const S=rae(e,n,p,U,!!a);return mA(b.width,b.naturalWidth)&&mA(b.height,b.naturalHeight)&&(b=null),{x:S[0],y:S[1],width:p,height:U,crop:b}},rae=(e,t,n,i,s)=>{const[r,o,a,l]=dm(e,e.width,e.height,!0),c=x(r,o),u=x(a,l),d=Yb(c,u),[f,h,m,p]=dm(e,n,i,!0),U=m-f,b=p-h;let y=[...c];if(["n","w","nw"].includes(t)&&(y=[u[0]-Math.abs(U),u[1]-Math.abs(b)]),t==="ne"){const T=[c[0],u[1]];y=[T[0],T[1]-Math.abs(b)]}if(t==="sw"){const T=[u[0],c[1]];y=[T[0]-Math.abs(U),T[1]]}s&&(["s","n"].includes(t)&&(y[0]=d[0]-U/2),["e","w"].includes(t)&&(y[1]=d[1]-b/2));const w=e.angle,v=q(y,d,w),I=[y[0]+Math.abs(U)/2,y[1]+Math.abs(b)/2],C=q(I,d,w);y=q(v,C,-w);const _=[...y];return _[0]+=e.x-f,_[1]+=e.y-h,_},oae=(e,t)=>{if(e.crop){const{width:n,height:i}=al(e),[s,r,o,a,l,c]=ze(e,t),u=ue(q(x(s,r),x(l,c),e.angle)),d=ue(q(x(o,r),x(l,c),e.angle)),f=qs(Xb(d,u)),h=ue(q(x(s,a),x(l,c),e.angle)),m=Xb(h,u),p=qs(m),{cropX:U,cropY:b}=aae(e.crop,e.scale),y=Hf(Hf(u,In(f,-U*n/e.crop.naturalWidth)),In(p,-b*i/e.crop.naturalHeight)),w=bi(Hf(Hf(y,In(f,n/2)),In(p,i/2))),v=q(bi(y),w,-e.angle);return{...e,x:v[0],y:v[1],width:n,height:i,crop:null}}return e},al=e=>{if(e.crop){const t=e.width/(e.crop.width/e.crop.naturalWidth),n=e.height/(e.crop.height/e.crop.naturalHeight);return{width:t,height:n}}return{width:e.width,height:e.height}},aae=(e,t)=>{let n=e.x,i=e.y;const s=t[0]===-1,r=t[1]===-1;return s&&(n=e.naturalWidth-Math.abs(n)-e.width),r&&(i=e.naturalHeight-Math.abs(i)-e.height),{cropX:n,cropY:i}},lae=(e,t=!1)=>{const n=e.crop;if(!n)return null;const i=e.scale[0]===-1,s=e.scale[1]===-1;let r=n.x,o=n.y;if(i&&(r=n.naturalWidth-n.width-n.x),s&&(o=n.naturalHeight-n.height-n.y),t)return{x:r,y:o};const{width:a,height:l}=al(e);return{x:r/(n.naturalWidth/a),y:o/(n.naturalHeight/l)}},U0=new WeakMap,G9=(e,t)=>{const n=U0.get(e);if(!n)return;const{version:i,shapes:s}=n;if(i!==e.version){U0.delete(e);return}return s.get(t)},X9=(e,t,n)=>{const i=U0.get(e);if(!i){U0.set(e,{version:e.version,shapes:new Map([[n,t]])});return}const{version:s,shapes:r}=i;if(s!==e.version){U0.set(e,{version:e.version,shapes:new Map([[n,t]])});return}r.set(n,t)};function i6(e){const t=G9(e,0);if(t)return t;const n=rce(e),i=[],s=[];for(let o=0;o<n.length;o+=1){const a=n[o],l=n[o-1]&&X5(n[o-1].data.slice(-2));switch(a.op){case"move":continue;case"lineTo":if(!l)throw new Error("prevPoint is undefined");i.push(Ae(x(e.x+l[0],e.y+l[1]),x(e.x+a.data[0],e.y+a.data[1])));continue;case"bcurveTo":if(!l)throw new Error("prevPoint is undefined");s.push(zn(x(e.x+l[0],e.y+l[1]),x(e.x+a.data[0],e.y+a.data[1]),x(e.x+a.data[2],e.y+a.data[3]),x(e.x+a.data[4],e.y+a.data[5])));continue;default:console.error("Unknown op type",a.op)}}const r=[i,s];return X9(e,r,0),r}function j9(e,t=0){const n=G9(e,t);if(n)return n;let i=us(Math.min(e.width,e.height),e);i===0&&(i=.01);const s=fre(x(e.x,e.y),x(e.x+e.width,e.y+e.height)),r=Ae(x(s[0][0]+i,s[0][1]),x(s[1][0]-i,s[0][1])),o=Ae(x(s[1][0],s[0][1]+i),x(s[1][0],s[1][1]-i)),a=Ae(x(s[0][0]+i,s[1][1]),x(s[1][0]-i,s[1][1])),l=Ae(x(s[0][0],s[1][1]-i),x(s[0][0],s[0][1]+i)),c=[zn(l[1],x(l[1][0]+2/3*(s[0][0]-l[1][0]),l[1][1]+2/3*(s[0][1]-l[1][1])),x(r[0][0]+2/3*(s[0][0]-r[0][0]),r[0][1]+2/3*(s[0][1]-r[0][1])),r[0]),zn(r[1],x(r[1][0]+2/3*(s[1][0]-r[1][0]),r[1][1]+2/3*(s[0][1]-r[1][1])),x(o[0][0]+2/3*(s[1][0]-o[0][0]),o[0][1]+2/3*(s[0][1]-o[0][1])),o[0]),zn(o[1],x(o[1][0]+2/3*(s[1][0]-o[1][0]),o[1][1]+2/3*(s[1][1]-o[1][1])),x(a[1][0]+2/3*(s[1][0]-a[1][0]),a[1][1]+2/3*(s[1][1]-a[1][1])),a[1]),zn(a[0],x(a[0][0]+2/3*(s[0][0]-a[0][0]),a[0][1]+2/3*(s[1][1]-a[0][1])),x(l[0][0]+2/3*(s[0][0]-l[0][0]),l[0][1]+2/3*(s[1][1]-l[0][1])),l[0])],u=t>0?c.map(h=>N9(Eo(h,t))):[[c[0]],[c[1]],[c[2]],[c[3]]],f=[[Ae(u[0][u[0].length-1][3],u[1][0][0]),Ae(u[1][u[1].length-1][3],u[2][0][0]),Ae(u[2][u[2].length-1][3],u[3][0][0]),Ae(u[3][u[3].length-1][3],u[0][0][0])],u.flat()];return X9(e,f,t),f}function Y9(e,t=0){const n=G9(e,t);if(n)return n;const[i,s,r,o,a,l,c,u]=v6(e),d=e.roundness?us(Math.abs(i-c),e):(i-c)*.01,f=e.roundness?us(Math.abs(o-s),e):(o-s)*.01,[h,m,p,U]=[x(e.x+i,e.y+s),x(e.x+r,e.y+o),x(e.x+a,e.y+l),x(e.x+c,e.y+u)],b=[zn(x(m[0]-d,m[1]-f),m,m,x(m[0]-d,m[1]+f)),zn(x(p[0]+d,p[1]-f),p,p,x(p[0]-d,p[1]-f)),zn(x(U[0]+d,U[1]+f),U,U,x(U[0]+d,U[1]-f)),zn(x(h[0]-d,h[1]+f),h,h,x(h[0]+d,h[1]+f))],y=t>0?b.map(I=>N9(Eo(I,t))):[[b[0]],[b[1]],[b[2]],[b[3]]],v=[[Ae(y[0][y[0].length-1][3],y[1][0][0]),Ae(y[1][y[1].length-1][3],y[2][0][0]),Ae(y[2][y[2].length-1][3],y[3][0][0]),Ae(y[3][y[3].length-1][3],y[0][0][0])],y.flat()];return X9(e,v,t),v}const qo=(e,t=1)=>{if(e.length>=3){const[n,i]=[e[0],e[e.length-1]];return at(n,i)<=S2/t}return!1},us=(e,t)=>{var n,i,s,r;if(((n=t.roundness)==null?void 0:n.type)===yn.PROPORTIONAL_RADIUS||((i=t.roundness)==null?void 0:i.type)===yn.LEGACY)return e*b8;if(((s=t.roundness)==null?void 0:s.type)===yn.ADAPTIVE_RADIUS){const o=((r=t.roundness)==null?void 0:r.value)??Gse,a=o/b8;return e<=a?e*b8:o}return 0},Dn=e=>!!e&&e.type==="image"&&!!e.fileId,yt=e=>!!e&&e.type==="image",rs=e=>!!e&&e.type==="embeddable",jl=e=>!!e&&e.type==="iframe",pr=e=>!!e&&(e.type==="iframe"||e.type==="embeddable"),de=e=>e!=null&&e.type==="text",YB=e=>e!=null&&e.type==="frame",R2=e=>e!=null&&e.type==="magicframe",Ee=e=>e!=null&&(e.type==="frame"||e.type==="magicframe"),Zi=e=>e!=null&&cae(e.type),cae=e=>e==="freedraw",Se=e=>e!=null&&W9(e.type),tn=e=>e!=null&&e.type==="line",xe=e=>e!=null&&e.type==="arrow",ge=e=>xe(e)&&e.elbowed,uae=e=>xe(e)&&!e.elbowed,dae=e=>xe(e)&&!e.elbowed&&!e.roundness,fae=e=>xe(e)&&!e.elbowed&&e.roundness!==null,W9=e=>e==="arrow"||e==="line",za=(e,t=!0)=>e!=null&&(!e.locked||t===!0)&&_4(e.type),_4=e=>e==="arrow",ro=(e,t=!0)=>e!=null&&(!e.locked||t===!0)&&(e.type==="rectangle"||e.type==="diamond"||e.type==="ellipse"||e.type==="image"||e.type==="iframe"||e.type==="embeddable"||e.type==="frame"||e.type==="magicframe"||e.type==="text"&&!e.containerId),hae=e=>e!=null&&(e.type==="rectangle"||e.type==="diamond"||e.type==="image"||e.type==="iframe"||e.type==="embeddable"||e.type==="frame"||e.type==="magicframe"||e.type==="text"&&!e.containerId),Zu=(e,t=!0)=>e!=null&&(!e.locked||t===!0)&&(e.type==="rectangle"||e.type==="diamond"||e.type==="ellipse"||xe(e)),WB=e=>{const t=e==null?void 0:e.type;if(!t)return!1;switch(t){case"text":case"diamond":case"rectangle":case"iframe":case"embeddable":case"ellipse":case"arrow":case"freedraw":case"line":case"frame":case"magicframe":case"image":case"selection":return!0;default:return Ko(t,null),!1}},K5=e=>e.type==="rectangle"||e.type==="ellipse"||e.type==="diamond",Di=e=>{var t;return Zu(e)&&!!((t=e.boundElements)!=null&&t.some(({type:n})=>n==="text"))},zt=e=>e!==null&&"containerId"in e&&e.containerId!==null&&de(e),KB=e=>!!e.startBinding||!!e.endBinding,Bd=e=>e==="rectangle"||e==="embeddable"||e==="iframe"||e==="image",ZB=e=>e==="line"||e==="arrow"||e==="diamond",gae=(e,t)=>!!((e===yn.ADAPTIVE_RADIUS||e===yn.LEGACY)&&Bd(t.type)||e===yn.PROPORTIONAL_RADIUS&&ZB(t.type)),mae=e=>ZB(e.type)?{type:yn.PROPORTIONAL_RADIUS}:Bd(e.type)?{type:yn.ADAPTIVE_RADIUS}:null,s6=e=>Object.hasOwn(e,"fixedPoint")&&e.fixedPoint!=null,oh=e=>dae(e)?"sharpArrow":fae(e)?"curvedArrow":ge(e)?"elbowArrow":"line",T4=e=>e.length>3&&kr(e[0],e[e.length-1]),qB=e=>e.length>3||e.length===3&&!kr(e[0],e[e.length-1]),Fh={},r6=(e,t)=>{const n=Fh[e]||(Fh[e]={height:t});return n.height=t,n},QB=e=>{Fh[e]&&delete Fh[e]},pae=e=>{var t;return((t=Fh[e])==null?void 0:t.height)??null},Xn=(e,t,n)=>{const i=e.split(`
`).map(a=>a||" ").join(`
`),s=parseFloat(t),r=Eae(i,s,n);return{width:q9(i,t),height:r}},JB="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".toLocaleUpperCase(),ez=(e,t)=>{const n=vae(e);return n===0?Xn(JB.split("").join(`
`),e,t).width+Vn*2:n+Vn*2},K9=(e,t)=>Xn("",e,t).width+Vn*2,Uae=()=>q9(JB,gt({fontSize:vl,fontFamily:tu}))>0,Bh=e=>kB(e).replace(/\t/g,"        "),Z9=e=>Bh(e).split(`
`),bae=e=>{const t=Z9(e.text).length;return e.height/t/e.fontSize},bp=(e,t)=>e*t,tz=(e,t)=>bp(e,t)+Vn*2;let x8;class yae{constructor(){F(this,"canvas");this.canvas=document.createElement("canvas")}getLineWidth(t,n){const i=this.canvas.getContext("2d");return i.font=n,i.measureText(t).width}}const hd=(e,t)=>(x8||(x8=new yae),x8.getLineWidth(e,t)),q9=(e,t)=>{const n=Z9(e);let i=0;return n.forEach(s=>{i=Math.max(i,hd(s,t))}),i},Eae=(e,t,n)=>{const i=Z9(e).length;return bp(t,n)*i},yp=(()=>{const e={};return{calculate:(s,r)=>{const o=s.charCodeAt(0);if(e[r]||(e[r]=[]),!e[r][o]){const a=hd(s,r);e[r][o]=a}return e[r][o]},getCache:s=>e[s],clearCache:s=>{e[s]=[]}}})(),vae=e=>{const t=yp.getCache(e);if(!t)return 0;const n=t.filter(i=>i!==void 0);return Math.max(...n)};let C8,NU,A8;const wae=e=>(C8||(C8=_t.class(...Object.values(va))),C8.test(e)),_ae=()=>{if(!NU)try{NU=Iae()}catch{NU=Tae()}return NU},Q9=()=>(A8||(A8=Sae()),A8),or={WHITESPACE:/\s/u,HYPHEN:/-/u,OPENING:/<\(\[\{/u,CLOSING:/>\)\]\}.,:;!\?\//u},va={CHAR:new RegExp("\\p{Script=Han}\\p{Script=Hiragana}\\p{Script=Katakana}\\p{Script=Hangul}","u"),OPENING://u,CLOSING://u,CURRENCY://u},gu={FLAG:new RegExp("\\p{RI}\\p{RI}","u"),JOINER:new RegExp("(?:\\p{Emoji_Modifier}|\\uFE0F\\u20E3?|[\\u{E0020}-\\u{E007E}]+\\u{E007F})?","u"),ZWJ:/\u200D/u,ANY:/[\p{Emoji}]/u,MOST:/[\p{Extended_Pictographic}\p{Emoji_Presentation}]/u},Tae=()=>_t.or(Q9(),wn.On(or.HYPHEN,or.WHITESPACE,va.CHAR)),Iae=()=>_t.or(Q9(),wn.Before(or.WHITESPACE).Build(),wn.After(or.WHITESPACE,or.HYPHEN).Build(),wn.Before(va.CHAR,va.CURRENCY).NotPrecededBy(or.OPENING,va.OPENING).Build(),wn.After(va.CHAR).NotFollowedBy(or.HYPHEN,or.CLOSING,va.CLOSING).Build(),wn.BeforeMany(va.OPENING).NotPrecededBy(or.OPENING).Build(),wn.AfterMany(va.CLOSING).NotFollowedBy(or.CLOSING).Build(),wn.AfterMany(or.CLOSING).FollowedBy(or.OPENING).Build()),Sae=()=>_t.group(_t.or(gu.FLAG,_t.and(gu.MOST,gu.JOINER,_t.build(`(?:${gu.ZWJ.source}(?:${gu.FLAG.source}|${gu.ANY.source}${gu.JOINER.source}))*`)))),_t={build:e=>new RegExp(e,"u"),join:(...e)=>e.map(t=>t.source).join(""),and:(...e)=>_t.build(_t.join(...e)),or:(...e)=>_t.build(e.map(t=>t.source).join("|")),group:(...e)=>_t.build(`(${_t.join(...e)})`),class:(...e)=>_t.build(`[${_t.join(...e)}]`)},wn={On:(...e)=>{const t=_t.join(...e);return _t.build(`([${t}])`)},Before:(...e)=>{const t=_t.join(...e),n=()=>_t.build(`(?=[${t}])`);return wn.Chain(n)},After:(...e)=>{const t=_t.join(...e),n=()=>_t.build(`(?<=[${t}])`);return wn.Chain(n)},BeforeMany:(...e)=>{const t=_t.join(...e),n=()=>_t.build(`(?<![${t}])(?=[${t}])`);return wn.Chain(n)},AfterMany:(...e)=>{const t=_t.join(...e),n=()=>_t.build(`(?<=[${t}])(?![${t}])`);return wn.Chain(n)},NotBefore:(...e)=>{const t=_t.join(...e),n=()=>_t.build(`(?![${t}])`);return wn.Chain(n)},NotAfter:(...e)=>{const t=_t.join(...e),n=()=>_t.build(`(?<![${t}])`);return wn.Chain(n)},Chain:e=>({Build:e,PreceededBy:(...t)=>{const n=e(),i=wn.After(...t).Build(),s=()=>_t.and(i,n);return wn.Chain(s)},FollowedBy:(...t)=>{const n=e(),i=wn.Before(...t).Build(),s=()=>_t.and(n,i);return wn.Chain(s)},NotPrecededBy:(...t)=>{const n=e(),i=wn.NotAfter(...t).Build(),s=()=>_t.and(i,n);return wn.Chain(s)},NotFollowedBy:(...t)=>{const n=e(),i=wn.NotBefore(...t).Build(),s=()=>_t.and(n,i);return wn.Chain(s)}})},xae=e=>{const t=_ae();return e.normalize("NFC").split(t).filter(Boolean)},iu=(e,t,n)=>{if(!Number.isFinite(n)||n<0)return e;const i=[],s=e.split(`
`);for(const r of s){if(hd(r,t)<=n){i.push(r);continue}const a=Cae(r,t,n);i.push(...a)}return i.join(`
`)},Cae=(e,t,n)=>{const i=[],r=xae(e)[Symbol.iterator]();let o="",a=0,l=r.next();for(;!l.done;){const c=l.value,u=o+c,d=kae(c)?a+yp.calculate(c,t):hd(u,t);if(/\s/.test(c)||d<=n){o=u,a=d,l=r.next();continue}if(o)i.push(o.trimEnd()),o="",a=0;else{const f=Aae(c,t,n),h=f[f.length-1]??"",m=f.slice(0,-1);i.push(...m),o=h,a=hd(h,t),l=r.next()}}if(o){const c=Mae(o,t,n);i.push(c)}return i},Aae=(e,t,n)=>{if(Q9().test(e))return[e];const i=[],s=Array.from(e);let r="",o=0;for(const a of s){const l=yp.calculate(a,t),c=o+l;if(c<=n){r=r+a,o=c;continue}r&&i.push(r),r=a,o=l}return r&&i.push(r),i},Mae=(e,t,n)=>{if(!(hd(e,t)>n))return e;let[,s,r]=e.match(/^(.+?)(\s+)$/)??[e,e.trimEnd(),""],o=hd(s,t);for(const a of Array.from(r)){const l=yp.calculate(a,t),c=o+l;if(c>n)break;s=s+a,o=c}return s},kae=e=>e.codePointAt(0)!==void 0&&e.codePointAt(1)===void 0,qi=(e,t,n)=>{const i=n.getNonDeletedElementsMap();let s;const r={x:e.x,y:e.y,text:e.text,width:e.width,height:e.height,angle:t?xe(t)?0:t.angle:e.angle};r.text=e.text,(t||!e.autoResize)&&(s=t?Jo(t,e):e.width,r.text=iu(e.originalText,gt(e),s));const o=Xn(r.text,gt(e),e.lineHeight);if(e.autoResize&&(r.width=o.width),r.height=o.height,t){const a=vp(t,e),l=Jo(t,e);if(!xe(t)&&o.height>a){const f=gd(o.height,t.type);n.mutateElement(t,{height:f}),r6(t.id,f)}if(o.width>l){const f=gd(o.width,t.type);n.mutateElement(t,{width:f})}const c={...e,...r},{x:u,y:d}=su(t,c,i);r.x=u,r.y=d}n.mutateElement(e,r)},Ep=(e,t,n,i=!1)=>{const s=t.getNonDeletedElementsMap();if(!Qo(e))return;QB(e.id);const o=Re(e,s);if(o&&o.text){if(!e)return;let a=o.text,l=o.height,c=o.width;const u=Jo(e,o),d=vp(e,o);let f=e.height;if(i||n!=="n"&&n!=="s"){a&&(a=iu(o.originalText,gt(o),u));const h=Xn(a,gt(o),o.lineHeight);l=h.height,c=h.width}if(l>d){f=gd(l,e.type);const h=f-e.height,m=!xe(e)&&(n==="ne"||n==="nw"||n==="n")?e.y-h:e.y;t.mutateElement(e,{height:f,y:m})}t.mutateElement(o,{text:a,width:c,height:l}),xe(e)||t.mutateElement(o,su(e,o,s))}},su=(e,t,n)=>{if(xe(e))return pe.getBoundTextElementPosition(e,t,n);const i=Rae(e),s=vp(e,t),r=Jo(e,t);let o,a;t.verticalAlign===Gs.TOP?a=i.y:t.verticalAlign===Gs.BOTTOM?a=i.y+(s-t.height):a=i.y+(s/2-t.height/2),t.textAlign===rm.LEFT?o=i.x:t.textAlign===rm.RIGHT?o=i.x+(r-t.width):o=i.x+(r/2-t.width/2);const l=e.angle??0;if(l!==0){const c=x(i.x+r/2,i.y+s/2),u=x(o+t.width/2,a+t.height/2),[d,f]=q(u,c,l);return{x:d-t.width/2,y:f-t.height/2}}return{x:o,y:a}},Qo=e=>{var t,n,i;return(t=e==null?void 0:e.boundElements)!=null&&t.length&&((i=(n=e==null?void 0:e.boundElements)==null?void 0:n.find(s=>s.type==="text"))==null?void 0:i.id)||null},Re=(e,t)=>{if(!e)return null;const n=Qo(e);return n&&t.get(n)||null},jn=(e,t)=>e&&e.containerId&&t.get(e.containerId)||null,M8=(e,t,n)=>{if(!xe(e))return{x:e.x+e.width/2,y:e.y+e.height/2};if(pe.getPointsGlobalCoordinates(e,n).length%2===1){const o=Math.floor(e.points.length/2),a=pe.getPointGlobalCoordinates(e,e.points[o],n);return{x:a[0],y:a[1]}}const s=e.points.length/2-1;let r=pe.getEditorMidPoints(e,n,t)[s];return r||(r=pe.getSegmentMidPoint(e,s+1)),{x:r[0],y:r[1]}},Rae=e=>{let t=Vn,n=Vn;return e.type==="ellipse"&&(t+=e.width/2*(1-Math.sqrt(2)/2),n+=e.height/2*(1-Math.sqrt(2)/2)),e.type==="diamond"&&(t+=e.width/4,n+=e.height/4),{x:e.x+t,y:e.y+n}},Dae=(e,t)=>xe(t)?0:t?t.angle:e.angle,nz=(e,t)=>e.some(n=>{if(zt(n)){const i=jn(n,t);return!xe(i)}return!1}),iz=(e,t)=>e.some(n=>{if(zt(n)){const i=jn(n,t);return!xe(i)}return de(n)}),Lae=new Set(["rectangle","ellipse","diamond","arrow"]),Nae=e=>Lae.has(e.type),gd=(e,t)=>{e=Math.ceil(e);const n=Vn*2;return t==="ellipse"?Math.round((e+n)/Math.sqrt(2)*2):t==="arrow"?e+n*8:t==="diamond"?2*(e+n):e+n},Jo=(e,t)=>{const{width:n}=e;if(xe(e)){const i=((t==null?void 0:t.fontSize)??vl)*Vse;return Math.max(Hse*n,i)}return e.type==="ellipse"?Math.round(n/2*Math.sqrt(2))-Vn*2:e.type==="diamond"?Math.round(n/2)-Vn*2:n-Vn*2},vp=(e,t)=>{const{height:n}=e;return xe(e)?n-Vn*8*2<=0?t.height:n:e.type==="ellipse"?Math.round(n/2*Math.sqrt(2))-Vn*2:e.type==="diamond"?Math.round(n/2)-Vn*2:n-Vn*2},sz=(e,t=`

`)=>e.reduce((i,s)=>(de(s)&&i.push(s.text),i),[]).join(t),wp=(e,t,n)=>{switch(e.type){case"selection":case"rectangle":case"image":case"text":case"iframe":case"embeddable":case"frame":case"magicframe":return Oae(e,t,n);case"diamond":return Pae(e,t,n);case"ellipse":return Fae(e,t,n);case"line":case"arrow":case"freedraw":return Bae(e,n)}},Oae=(e,t,n)=>{const i=ri(e,t),s=q(n,i,-e.angle),[r,o]=j9(e);return Math.min(...r.map(a=>sc(s,a)),...o.map(a=>D9(a,s)).filter(a=>a!==null))},Pae=(e,t,n)=>{const i=ri(e,t),s=q(n,i,-e.angle),[r,o]=Y9(e);return Math.min(...r.map(a=>sc(s,a)),...o.map(a=>D9(a,s)).filter(a=>a!==null))},Fae=(e,t,n)=>{const i=ri(e,t);return are(q(n,i,-e.angle),yB(i,e.width/2,e.height/2))},Bae=(e,t)=>{const[n,i]=i6(e);return Math.min(...n.map(s=>sc(t,s)),...i.map(s=>D9(s,t)))},o6=e=>{if(e.type==="arrow")return!1;const t=!ws(e.backgroundColor)||Di(e)||pr(e)||de(e);return e.type==="line"||e.type==="freedraw"?t&&qo(e.points):t||yt(e)},Ef=({point:e,element:t,threshold:n,elementsMap:i,frameNameBound:s=null})=>{const r=s?om(x(s.x-n,s.y-n),e,x(s.x+s.width+n,s.y+s.height+n)):!1,o=si(t,i,!0);return!om(x(o[0]-n,o[1]-n),q(e,wg(o),-t.angle),x(o[2]+n,o[3]+n))&&!r?!1:o6(t)&&J9(e,t,i)||PA(e,t,i,n)||r},Z5=(e,t,n,i=0)=>{let[s,r,o,a]=si(t,n);return s-=i,r-=i,o+=i,a+=i,om(x(s,r),e,x(o,a))},zae=(e,t)=>!Ef(e)&&!rz(e.point,e.element,t)&&Z5(e.point,e.element,t),rz=(e,t,n)=>{const i=Re(t,n);if(!i)return!1;const s=Se(t)?{...i,...pe.getBoundTextElementPosition(t,i,n)}:i;return J9(e,s,n)},$o=(e,t,n,i=0,s=!1)=>{const r=[Math.min(n[0][0]-i,n[1][0]-i),Math.min(n[0][1]-i,n[1][1]-i),Math.max(n[0][0]+i,n[1][0]+i),Math.max(n[0][1]+i,n[1][1]+i)],o=si(e,t);if(!zd(r,o))return[];switch(e.type){case"rectangle":case"image":case"text":case"iframe":case"embeddable":case"frame":case"selection":case"magicframe":return Vae(e,t,n,i,s);case"diamond":return $ae(e,t,n,i,s);case"ellipse":return Gae(e,t,n,i);case"line":case"freedraw":case"arrow":return Hae(e,n,s)}},oz=(e,t,n,i,s,r=!1)=>{for(const o of e){const a=U_(o[0],o[1],o[2],o[3]),l=[Math.min(t[0][0],t[1][0]),Math.min(t[0][1],t[1][1]),Math.max(t[0][0],t[1][0]),Math.max(t[0][1],t[1][1])];if(!zd(a,l))continue;const c=bB(o,t);if(c.length>0){for(const u of c)n.push(q(u,i,s));if(r)return n}}return n},az=(e,t,n,i,s,r=!1)=>{for(const o of e){const a=am(o,t);if(a&&(n.push(q(a,i,s)),r))return n}return n},Hae=(e,t,n=!1)=>{const[i,s]=i6(e),r=[];for(const o of i){const a=am(o,t);if(a&&(r.push(a),n))return r}for(const o of s){const a=U_(o[0],o[1],o[2],o[3]),l=[Math.min(t[0][0],t[1][0]),Math.min(t[0][1],t[1][1]),Math.max(t[0][0],t[1][0]),Math.max(t[0][1],t[1][1])];if(!zd(a,l))continue;const c=bB(o,t);if(c.length>0&&(r.push(...c),n))return r}return r},Vae=(e,t,n,i=0,s=!1)=>{const r=ri(e,t),o=q(n[0],r,-e.angle),a=q(n[1],r,-e.angle),l=Ae(o,a),[c,u]=j9(e,i),d=[];return az(c,l,d,r,e.angle,s),s&&d.length>0||oz(u,l,d,r,e.angle,s),d},$ae=(e,t,n,i=0,s=!1)=>{const r=ri(e,t),o=q(n[0],r,-e.angle),a=q(n[1],r,-e.angle),l=Ae(o,a),[c,u]=Y9(e,i),d=[];return az(c,l,d,r,e.angle,s),s&&d.length>0||oz(u,l,d,r,e.angle,s),d},Gae=(e,t,n,i=0)=>{const s=ri(e,t),r=q(n[0],s,-e.angle),o=q(n[1],s,-e.angle);return lre(yB(s,e.width/2+i,e.height/2+i),Ae(r,o)).map(a=>q(a,s,e.angle))},PA=(e,t,n,i=1)=>wp(t,n,e)<=i,J9=(e,t,n)=>{if((Se(t)||Zi(t))&&!qo(t.points))return!1;const[i,s,r,o]=si(t,n);if(!om(x(i,s),e,x(r,o)))return!1;const a=x((i+r)/2,(s+o)/2),l=bi(In(qs(ue(e,a,.1)),Math.max(t.width,t.height)*2),a),c=Ae(e,l);return $o(t,n,c).filter((d,f,h)=>h.findIndex(m=>kr(m,d))===f).length%2===1},Hn=[1,0],ls=[0,1],Ur=[-1,0],Kr=[0,-1],zh=e=>{const[t,n]=e,i=Math.abs(t),s=Math.abs(n);return t>s?Hn:t<=-s?Ur:n>i?ls:Kr},Os=(e,t)=>zh(ue(e,t)),Ra=(e,t)=>Po(Os(e,t)),$n=(e,t)=>e[0]===t[0]&&e[1]===t[1],Po=e=>$n(e,Hn)||$n(e,Ur),Xae=(e,t,n)=>{const i=wg(t),s=.95,r=bi(In(ue(q(x(e.x+e.width/2,e.y),i,e.angle),i),s),i),o=bi(In(ue(q(x(e.x+e.width,e.y+e.height/2),i,e.angle),i),s),i),a=bi(In(ue(q(x(e.x+e.width/2,e.y+e.height),i,e.angle),i),s),i),l=bi(In(ue(q(x(e.x,e.y+e.height/2),i,e.angle),i),s),i);if(bt(ue(n,r),ue(r,o))<=0&&bt(ue(n,r),ue(r,l))>0)return Os(r,i);if(bt(ue(n,o),ue(o,a))<=0&&bt(ue(n,o),ue(o,r))>0)return Os(o,i);if(bt(ue(n,a),ue(a,l))<=0&&bt(ue(n,a),ue(a,o))>0)return Os(a,i);if(bt(ue(n,l),ue(l,r))<=0&&bt(ue(n,l),ue(l,a))>0)return Os(l,i);if(bt(ue(n,i),ue(r,i))<=0&&bt(ue(n,i),ue(o,i))>0){const u=e.width>e.height?r:o;return Os(u,i)}else if(bt(ue(n,i),ue(o,i))<=0&&bt(ue(n,i),ue(a,i))>0){const u=e.width>e.height?a:o;return Os(u,i)}else if(bt(ue(n,i),ue(a,i))<=0&&bt(ue(n,i),ue(l,i))>0){const u=e.width>e.height?a:l;return Os(u,i)}const c=e.width>e.height?r:l;return Os(c,i)},e_=(e,t,n)=>{const s=wg(t);if(e.type==="diamond")return Xae(e,t,n);const r=N1(x(t[0],t[1]),s,2),o=N1(x(t[2],t[1]),s,2),a=N1(x(t[0],t[3]),s,2),l=N1(x(t[2],t[3]),s,2);return w8([r,o,s],n)?Kr:w8([o,l,s],n)?Hn:w8([l,a,s],n)?ls:Ur},lz=e=>[e[0]===0?0:e[0]>0?-1:1,e[1]===0?0:e[1]>0?-1:1],t_=1,Mn=40,jae=(e,t)=>{const n=e.fixedSegments?e.fixedSegments.slice():null;if(n){const i=[];e.points.map(o=>x(e.x+o[0],e.y+o[1])).forEach((o,a,l)=>{if(a<2)return i.push(o);const c=Os(o,l[a-1]),u=Os(l[a-1],l[a-2]);if($n(c,u)){const d=(n==null?void 0:n.findIndex(h=>h.index===a-1))??-1,f=(n==null?void 0:n.findIndex(h=>h.index===a))??-1;f!==-1&&(n[f].start=x(l[a-2][0]-e.x,l[a-2][1]-e.y)),d!==-1&&n.splice(d,1),i.splice(-1,1),n.forEach(h=>{h.index>a-1&&(h.index-=1)})}return i.push(o)});const s=[];i.forEach((o,a,l)=>{if(a<3)return s.push(o);if(at(l[a-2],l[a-1])<t_){const c=(n==null?void 0:n.findIndex(f=>f.index===a-2))??-1,u=(n==null?void 0:n.findIndex(f=>f.index===a-1))??-1;u!==-1&&n.splice(u,1),c!==-1&&n.splice(c,1),s.splice(-2,2),n.forEach(f=>{f.index>a-2&&(f.index-=2)});const d=Ra(o,l[a-1]);return s.push(x(d?o[0]:l[a-2][0],d?l[a-2][1]:o[1]))}s.push(o)});const r=n.filter(o=>o.index!==1&&o.index!==s.length-1);return r.length===0?Ka(s_(r_(i_(e,n_(e,t,s.map(o=>x(o[0]-e.x,o[1]-e.y))))??[])),r,null,null):Ka(s,r,e.startIsSpecial,e.endIsSpecial)}return{x:e.x,y:e.y,points:e.points,fixedSegments:e.fixedSegments,startIsSpecial:e.startIsSpecial,endIsSpecial:e.endIsSpecial}},Yae=(e,t,n)=>{var k,S;const i=t.map(R=>R.index),r=(((k=e.fixedSegments)==null?void 0:k.map(R=>R.index))??[]).findIndex(R=>!i.includes(R));if(r===-1||!((S=e.fixedSegments)!=null&&S[r]))return{points:e.points};const o=e.fixedSegments[r].index,a=e.fixedSegments[r-1],l=e.fixedSegments[r+1],c=e.x+(a?a.end[0]:0),u=e.y+(a?a.end[1]:0),d=a?null:e.startBinding,f=l?null:e.endBinding,{startHeading:h,endHeading:m,startGlobalPoint:p,endGlobalPoint:U,hoveredStartElement:b,hoveredEndElement:y,...w}=n_({x:c,y:u,startBinding:d,endBinding:f,startArrowhead:null,endArrowhead:null,points:e.points},n,[x(0,0),x(e.x+((l==null?void 0:l.start[0])??e.points[e.points.length-1][0])-c,e.y+((l==null?void 0:l.start[1])??e.points[e.points.length-1][1])-u)],{isDragging:!1}),{points:v}=Ka(s_(r_(i_(e,{startHeading:h,endHeading:m,startGlobalPoint:p,endGlobalPoint:U,hoveredEndElement:y,...w})??[])),t,null,null);if(!v||v.length<2)throw new Error("Property 'points' is required in the update returned by normalizeArrowElementUpdate()");const I=[];if(a)for(let R=0;R<a.index;R++)I.push(x(e.x+e.points[R][0],e.y+e.points[R][1]));if(v.forEach(R=>{I.push(x(e.x+(a?a.end[0]:0)+R[0],e.y+(a?a.end[1]:0)+R[1]))}),l)for(let R=l.index;R<e.points.length;R++)I.push(x(e.x+e.points[R][0],e.y+e.points[R][1]));const C=((l==null?void 0:l.index)??e.points.length)-((a==null?void 0:a.index)??0)-1,_=t.map(R=>R.index>o?{...R,index:R.index-C+(v.length-1)}:R),T=I.flatMap((R,P)=>{const L=I[P-1],X=I[P+1];if(L&&X){const G=Os(R,L),z=Os(X,R);if($n(G,z))return _.forEach(V=>{V.index>P&&(V.index-=1)}),[];if($n(G,lz(z)))return _.forEach(V=>{V.index>P&&(V.index+=1)}),[R,R]}return[R]});return Ka(T,_,!1,!1)},Wae=(e,t,n,i,s,r)=>{var I,C;const o=t.map((_,T)=>e.fixedSegments==null||e.fixedSegments[T]===void 0||e.fixedSegments[T].index!==_.index||(_.start[0]!==e.fixedSegments[T].start[0]&&_.end[0]!==e.fixedSegments[T].end[0])!=(_.start[1]!==e.fixedSegments[T].start[1]&&_.end[1]!==e.fixedSegments[T].end[1])?T:null).filter(_=>_!==null).shift();if(o==null)return{points:e.points};const a=((I=e.fixedSegments)==null?void 0:I.findIndex(_=>_.index===1))??-1,l=((C=e.fixedSegments)==null?void 0:C.findIndex(_=>_.index===e.points.length-1))??-1,c=at(t[o].start,t[o].end),u=c<Mn+5;if(a===-1&&t[o].index===1&&s){const _=Po(n),k=(_?$n(n,Hn):$n(n,ls))?u?c/2:Mn:u?-c/2:-40;t[o].start=x(t[o].start[0]+(_?k:0),t[o].start[1]+(_?0:k))}if(l===-1&&t[o].index===e.points.length-1&&r){const _=Po(i),k=(_?$n(i,Hn):$n(i,ls))?u?c/2:Mn:u?-c/2:-40;t[o].end=x(t[o].end[0]+(_?k:0),t[o].end[1]+(_?0:k))}const d=t.map(_=>({..._,start:x(e.x+_.start[0],e.y+_.start[1]),end:x(e.x+_.end[0],e.y+_.end[1])})),f=e.points.map((_,T)=>x(e.x+_[0],e.y+_[1])),h=d[o].index-1,m=d[o].index,p=d[o].start,U=d[o].end,b=f[h-1]&&!kr(f[h],f[h-1])?Ra(f[h-1],f[h]):void 0,y=f[m+1]&&!kr(f[m],f[m+1])?Ra(f[m+1],f[m]):void 0;if(b!==void 0){const _=b?1:0;f[h-1][_]=p[_]}if(f[h]=p,f[m]=U,y!==void 0){const _=y?1:0;f[m+1][_]=U[_]}const w=d.findIndex(_=>_.index===h);if(w!==-1){const _=Ra(d[w].end,d[w].start)?1:0;d[w].start[_]=p[_],d[w].end=p}const v=d.findIndex(_=>_.index===m+1);if(v!==-1){const _=Ra(d[v].end,d[v].start)?1:0;d[v].end[_]=U[_],d[v].start=U}if(a===-1&&h===0){const _=s?Po(n):Ra(f[1],f[0]);f.unshift(x(_?p[0]:e.x+e.points[0][0],_?e.y+e.points[0][1]:p[1])),s&&f.unshift(x(e.x+e.points[0][0],e.y+e.points[0][1]));for(const T of d)T.index+=s?2:1}if(l===-1&&m===e.points.length-1){const _=Po(i);f.push(x(_?U[0]:e.x+e.points[e.points.length-1][0],_?e.y+e.points[e.points.length-1][1]:U[1])),r&&f.push(x(e.x+e.points[e.points.length-1][0],e.y+e.points[e.points.length-1][1]))}return Ka(f,d.map(_=>({..._,start:x(_.start[0]-e.x,_.start[1]-e.y),end:x(_.end[0]-e.x,_.end[1]-e.y)})),!1,!1)},Kae=(e,t,n,i,s,r,o,a,l)=>{let c=e.startIsSpecial??null,u=e.endIsSpecial??null;const d=t.map((U,b)=>b===0||b===t.length-1?x(e.x+U[0],e.y+U[1]):x(e.x+e.points[b][0],e.y+e.points[b][1])),f=n.map(U=>({...U,start:x(e.x+(U.start[0]-t[0][0]),e.y+(U.start[1]-t[0][1])),end:x(e.x+(U.end[0]-t[0][0]),e.y+(U.end[1]-t[0][1]))})),h=[],m=2+(c?1:0),p=2+(u?1:0);for(;h.length+m<d.length-p;)h.push(d[h.length+m]);{const U=d.at(c?2:1),b=d.at(c?3:2);if(!U||!b)throw new Error(`Second and third points must exist when handling endpoint drag (${c})`);const y=Po(i),w=Po(zh(ue(U,b)));if(a&&y===w){const v=y?$n(i,Hn):$n(i,ls);if(h.unshift(x(w?r[0]+(v?Mn:-40):b[0],w?b[1]:r[1]+(v?Mn:-40))),h.unshift(x(y?r[0]+(v?Mn:-40):r[0],y?r[1]:r[1]+(v?Mn:-40))),!c){c=!0;for(const I of f)I.index>1&&(I.index+=1)}}else if(h.unshift(x(w?r[0]:U[0],w?U[1]:r[1])),c){c=!1;for(const v of f)v.index>1&&(v.index-=1)}h.unshift(r)}{const U=d.at(d.length-(u?3:2)),b=d.at(d.length-(u?4:3));if(!U||!b)throw new Error(`Second and third to last points must exist when handling endpoint drag (${u})`);const y=Po(s),w=Ra(b,U);if(l&&y===w){const v=y?$n(s,Hn):$n(s,ls);h.push(x(w?o[0]+(v?Mn:-40):b[0],w?b[1]:o[1]+(v?Mn:-40))),h.push(x(y?o[0]+(v?Mn:-40):o[0],y?o[1]:o[1]+(v?Mn:-40))),u||(u=!0)}else h.push(x(w?o[0]:U[0],w?U[1]:o[1])),u&&(u=!1)}return h.push(o),Ka(h,f.map(({index:U})=>({index:U,start:h[U-1],end:h[U]})).map(U=>({...U,start:x(U.start[0]-r[0],U.start[1]-r[1]),end:x(U.end[0]-r[0],U.end[1]-r[1])})),c,u)},OU=1e6,yg=(e,t,n,i)=>{var I;if(e.points.length<2)return{points:n.points??e.points};const s=n.fixedSegments??e.fixedSegments??[],r=n.points?n.points&&n.points.length===2?e.points.map((C,_)=>_===0?n.points[0]:_===e.points.length-1?n.points[1]:C):n.points.slice():e.points.slice(),{startBinding:o,endBinding:a,...l}=n,c=typeof o<"u"?o:e.startBinding,u=typeof a<"u"?a:e.endBinding,d=c&&a6(c.elementId,t),f=u&&a6(u.elementId,t),h=uz(r);if(c&&!d&&h||u&&!f&&h||t.size===0&&h||Object.keys(l).length===0&&((d==null?void 0:d.id)!==(c==null?void 0:c.elementId)||(f==null?void 0:f.id)!==(u==null?void 0:u.elementId)))return Ka(r.map(C=>x(e.x+C[0],e.y+C[1])),e.fixedSegments,e.startIsSpecial,e.endIsSpecial);const{startHeading:m,endHeading:p,startGlobalPoint:U,endGlobalPoint:b,hoveredStartElement:y,hoveredEndElement:w,...v}=n_({x:e.x,y:e.y,startBinding:c,endBinding:u,startArrowhead:e.startArrowhead,endArrowhead:e.endArrowhead,points:e.points},t,r,i);return t.size===0&&h?Ka(r.map(C=>x(e.x+C[0],e.y+C[1])),e.fixedSegments,e.startIsSpecial,e.endIsSpecial):!n.points&&!n.fixedSegments&&!n.startBinding&&!n.endBinding?jae(e,t):n.startBinding===e.startBinding&&n.endBinding===e.endBinding&&(n.points??[]).every((C,_)=>kr(C,e.points[_]??x(1/0,1/0)))&&h?{}:s.length===0?Ka(s_(r_(i_(e,{startHeading:m,endHeading:p,startGlobalPoint:U,endGlobalPoint:b,hoveredEndElement:w,...v})??[])),s,null,null):(((I=e.fixedSegments)==null?void 0:I.length)??0)>s.length?Yae(e,s,t):n.points?n.points&&n.fixedSegments?n:Kae(e,r,s,m,p,U,b,y,w):Wae(e,s,m,p,y,w)},n_=(e,t,n,i)=>{var I,C;const s=jb(n[0],pn(e.x,e.y)),r=jb(n[n.length-1],pn(e.x,e.y));let o=null,a=null;if(i!=null&&i.isDragging){const _=Array.from(t.values());o=HA(s,t,_,i==null?void 0:i.zoom)||null,a=HA(r,t,_,i==null?void 0:i.zoom)||null}else o=e.startBinding&&a6(e.startBinding.elementId,t)||null,a=e.endBinding&&a6(e.endBinding.elementId,t)||null;const l=BA({...e,type:"arrow",elbowed:!0,points:n},"start",(I=e.startBinding)==null?void 0:I.fixedPoint,s,o,t,i==null?void 0:i.isDragging),c=BA({...e,type:"arrow",elbowed:!0,points:n},"end",(C=e.endBinding)==null?void 0:C.fixedPoint,r,a,t,i==null?void 0:i.isDragging),u=zA(l,c,o,s,t),d=zA(c,l,a,r,t),f=[l[0]-2,l[1]-2,l[0]+2,l[1]+2],h=[c[0]-2,c[1]-2,c[0]+2,c[1]+2],m=o?wa(o,t,Rl(u,e.startArrowhead?kt*6:kt*2,1)):f,p=a?wa(a,t,Rl(d,e.endArrowhead?kt*6:kt*2,1)):h,U=fm(l,a?wa(a,t,Rl(d,Mn,Mn)):h)||fm(c,o?wa(o,t,Rl(u,Mn,Mn)):f),b=cz(U?[f,h]:[m,p]),y=Qae(U?f:m,U?h:p,b,U?Rl(u,!o&&!a?0:Mn,0):Rl(u,!o&&!a?0:Mn-(e.startArrowhead?kt*6:kt*2),Mn),U?Rl(d,!o&&!a?0:Mn,0):Rl(d,!o&&!a?0:Mn-(e.endArrowhead?kt*6:kt*2),Mn),U,o&&wa(o,t),a&&wa(a,t)),w=FA(y[0],u,l),v=FA(y[1],d,c);return{dynamicAABBs:y,startDonglePosition:w,startGlobalPoint:l,startHeading:u,endDonglePosition:v,endGlobalPoint:c,endHeading:d,commonBounds:b,hoveredStartElement:o,hoveredEndElement:a,boundsOverlap:U,startElementBounds:m,endElementBounds:p}},i_=(e,t)=>{const{dynamicAABBs:n,startDonglePosition:i,startGlobalPoint:s,startHeading:r,endDonglePosition:o,endGlobalPoint:a,endHeading:l,commonBounds:c,hoveredEndElement:u}=t,d=Jae(n,i||s,r,o||a,l,c),f=i&&PU(i,d),h=o&&PU(o,d),m=PU(a,d);m&&u&&(m.closed=!0);const p=PU(s,d);p&&e.startBinding&&(p.closed=!0);const U=f&&h&&(fm(f.pos,n[1])||fm(h.pos,n[0])),b=Zae(f||p,h||m,d,r||Hn,l||Hn,U?[]:n);if(b){const y=b.map(w=>[w.pos[0],w.pos[1]]);return f&&y.unshift(s),h&&y.push(a),y}return null},Rl=(e,t,n)=>{switch(e){case Kr:return[t,n,n,n];case Hn:return[n,t,n,n];case ls:return[n,n,t,n]}return[n,n,n,t]},Zae=(e,t,n,i,s,r)=>{const o=k8(e.pos,t.pos),a=new Xie(l=>l.f);for(a.push(e);a.size()>0;){const l=a.pop();if(!l||l.closed)continue;if(l===t)return qae(e,l);l.closed=!0;const c=tle(l.addr,n);for(let u=0;u<4;u++){const d=c[u];if(!d||d.closed)continue;const f=N1(d.pos,l.pos,.5);if(Nre(...r.map(v=>fm(f,v))))continue;const h=nle(u),m=l.parent?zh(ue(l.pos,l.parent.pos)):i,p=lz(m);if($n(p,h)||VA(e.addr,d.addr)&&$n(h,i)||VA(t.addr,d.addr)&&$n(h,s))continue;const b=m!==h,y=l.g+k8(d.pos,l.pos)+(b?Math.pow(o,3):0),w=d.visited;if(!w||y<d.g){const v=ele(d,t,h,s);d.visited=!0,d.parent=l,d.h=k8(t.pos,d.pos)+v*Math.pow(o,2),d.g=y,d.f=d.g+d.h,w?a.rescoreElement(d):a.push(d)}}}return null},qae=(e,t)=>{let n=t;const i=[];for(;n.parent;)i.unshift(n),n=n.parent;return i.unshift(e),i},k8=(e,t)=>Math.abs(e[0]-t[0])+Math.abs(e[1]-t[1]),Qae=(e,t,n,i,s,r,o,a)=>{const l=o??e,c=a??t,[u,d,f,h]=i??[0,0,0,0],[m,p,U,b]=s??[0,0,0,0],y=[e[0]>t[2]?e[1]>t[3]||e[3]<t[1]?Math.min((l[0]+c[2])/2,e[0]-h):(l[0]+c[2])/2:e[0]>t[0]?e[0]-h:n[0]-h,e[1]>t[3]?e[0]>t[2]||e[2]<t[0]?Math.min((l[1]+c[3])/2,e[1]-u):(l[1]+c[3])/2:e[1]>t[1]?e[1]-u:n[1]-u,e[2]<t[0]?e[1]>t[3]||e[3]<t[1]?Math.max((l[2]+c[0])/2,e[2]+d):(l[2]+c[0])/2:e[2]<t[2]?e[2]+d:n[2]+d,e[3]<t[1]?e[0]>t[2]||e[2]<t[0]?Math.max((l[3]+c[1])/2,e[3]+f):(l[3]+c[1])/2:e[3]<t[3]?e[3]+f:n[3]+f],w=[t[0]>e[2]?t[1]>e[3]||t[3]<e[1]?Math.min((c[0]+l[2])/2,t[0]-b):(c[0]+l[2])/2:t[0]>e[0]?t[0]-b:n[0]-b,t[1]>e[3]?t[0]>e[2]||t[2]<e[0]?Math.min((c[1]+l[3])/2,t[1]-m):(c[1]+l[3])/2:t[1]>e[1]?t[1]-m:n[1]-m,t[2]<e[0]?t[1]>e[3]||t[3]<e[1]?Math.max((c[2]+l[0])/2,t[2]+p):(c[2]+l[0])/2:t[2]<e[2]?t[2]+p:n[2]+p,t[3]<e[1]?t[0]>e[2]||t[2]<e[0]?Math.max((c[3]+l[1])/2,t[3]+U):(c[3]+l[1])/2:t[3]<e[3]?t[3]+U:n[3]+U],v=cz([y,w]);if(!r&&y[2]-y[0]+w[2]-w[0]>v[2]-v[0]+1e-11&&y[3]-y[1]+w[3]-w[1]>v[3]-v[1]+1e-11){const[I,C]=[(w[0]+w[2])/2,(w[1]+w[3])/2];if(t[0]>e[2]&&e[1]>t[3]){const _=y[2]+(w[0]-y[2])/2,T=w[3]+(y[1]-w[3])/2;return bt(pn(e[2]-I,e[1]-C),pn(e[0]-I,e[3]-C))>0?[[y[0],y[1],_,y[3]],[_,w[1],w[2],w[3]]]:[[y[0],T,y[2],y[3]],[w[0],w[1],w[2],T]]}else if(e[2]<t[0]&&e[3]<t[1]){const _=y[2]+(w[0]-y[2])/2,T=y[3]+(w[1]-y[3])/2;return bt(pn(e[0]-I,e[1]-C),pn(e[2]-I,e[3]-C))>0?[[y[0],y[1],y[2],T],[w[0],T,w[2],w[3]]]:[[y[0],y[1],_,y[3]],[_,w[1],w[2],w[3]]]}else if(e[0]>t[2]&&e[3]<t[1]){const _=w[2]+(y[0]-w[2])/2,T=y[3]+(w[1]-y[3])/2;return bt(pn(e[2]-I,e[1]-C),pn(e[0]-I,e[3]-C))>0?[[_,y[1],y[2],y[3]],[w[0],w[1],_,w[3]]]:[[y[0],y[1],y[2],T],[w[0],T,w[2],w[3]]]}else if(e[0]>t[2]&&e[1]>t[3]){const _=w[2]+(y[0]-w[2])/2,T=w[3]+(y[1]-w[3])/2;return bt(pn(e[0]-I,e[1]-C),pn(e[2]-I,e[3]-C))>0?[[_,y[1],y[2],y[3]],[w[0],w[1],_,w[3]]]:[[y[0],T,y[2],y[3]],[w[0],w[1],w[2],T]]}}return[y,w]},Jae=(e,t,n,i,s,r)=>{const o=new Set,a=new Set;n===Ur||n===Hn?a.add(t[1]):o.add(t[0]),s===Ur||s===Hn?a.add(i[1]):o.add(i[0]),e.forEach(u=>{o.add(u[0]),o.add(u[2]),a.add(u[1]),a.add(u[3])}),o.add(r[0]),o.add(r[2]),a.add(r[1]),a.add(r[3]);const l=Array.from(a).sort((u,d)=>u-d),c=Array.from(o).sort((u,d)=>u-d);return{row:l.length,col:c.length,data:l.flatMap((u,d)=>c.map((f,h)=>({f:0,g:0,h:0,closed:!1,visited:!1,parent:null,addr:[h,d],pos:[f,u]})))}},FA=(e,t,n)=>{switch(t){case Kr:return x(n[0],e[1]);case Hn:return x(e[2],n[1]);case ls:return x(n[0],e[3])}return x(e[0],n[1])},ele=(e,t,n,i)=>{if(i===Hn)switch(n){case Hn:return e.pos[0]>=t.pos[0]?4:e.pos[1]===t.pos[1]?0:2;case Kr:return e.pos[1]>t.pos[1]&&e.pos[0]<t.pos[0]?1:3;case ls:return e.pos[1]<t.pos[1]&&e.pos[0]<t.pos[0]?1:3;case Ur:return e.pos[1]===t.pos[1]?4:2}else if(i===Ur)switch(n){case Hn:return e.pos[1]===t.pos[1]?4:2;case Kr:return e.pos[1]>t.pos[1]&&e.pos[0]>t.pos[0]?1:3;case ls:return e.pos[1]<t.pos[1]&&e.pos[0]>t.pos[0]?1:3;case Ur:return e.pos[0]<=t.pos[0]?4:e.pos[1]===t.pos[1]?0:2}else if(i===Kr)switch(n){case Hn:return e.pos[1]>t.pos[1]&&e.pos[0]<t.pos[0]?1:3;case Kr:return e.pos[1]>=t.pos[1]?4:e.pos[0]===t.pos[0]?0:2;case ls:return e.pos[0]===t.pos[0]?4:2;case Ur:return e.pos[1]>t.pos[1]&&e.pos[0]>t.pos[0]?1:3}else if(i===ls)switch(n){case Hn:return e.pos[1]<t.pos[1]&&e.pos[0]<t.pos[0]?1:3;case Kr:return e.pos[0]===t.pos[0]?4:2;case ls:return e.pos[1]<=t.pos[1]?4:e.pos[0]===t.pos[0]?0:2;case Ur:return e.pos[1]<t.pos[1]&&e.pos[0]>t.pos[0]?1:3}return 0},tle=([e,t],n)=>[O1([e,t-1],n),O1([e+1,t],n),O1([e,t+1],n),O1([e-1,t],n)],O1=([e,t],n)=>e<0||e>=n.col||t<0||t>=n.row?null:n.data[t*n.col+e]??null,PU=(e,t)=>{for(let n=0;n<t.col;n++)for(let i=0;i<t.row;i++){const s=O1([n,i],t);if(s&&e[0]===s.pos[0]&&e[1]===s.pos[1])return s}return null},cz=e=>[Math.min(...e.map(t=>t[0])),Math.min(...e.map(t=>t[1])),Math.max(...e.map(t=>t[2])),Math.max(...e.map(t=>t[3]))],a6=(e,t)=>{const n=t.get(e);return n&&ro(n)?n:null},Ka=(e,t,n,i)=>{const s=e[0][0],r=e[0][1];let o=e.map(a=>jb(a,In(ue(e[0]),-1)));return(s<-1e6||s>OU||r<-1e6||r>OU||s+o[o.length-1][0]<-1e6||r+o[o.length-1][0]>OU||s+o[o.length-1][1]<-1e6||r+o[o.length-1][1]>OU)&&console.error("Elbow arrow normalization is outside reasonable bounds (> 1e6)",{x:s,y:r,points:o,...Oh(o)}),o=o.map(([a,l])=>x(Ke(a,-1e6,1e6),Ke(l,-1e6,1e6))),{points:o,x:Ke(s,-1e6,1e6),y:Ke(r,-1e6,1e6),fixedSegments:((t==null?void 0:t.length)??0)>0?t:null,...Oh(o),startIsSpecial:n,endIsSpecial:i}},s_=e=>{if(e.length>1){let t=Math.abs(e[0][1]-e[1][1])<Math.abs(e[0][0]-e[1][0]);return e.filter((n,i)=>{if(i===0||i===e.length-1)return!0;const s=e[i+1],r=Math.abs(n[1]-s[1])<Math.abs(n[0]-s[0]);return t===r?(t=r,!1):(t=r,!0)})}return e},r_=e=>e.length>=4?e.filter((t,n)=>{if(n===0||n===e.length-1)return!0;const i=e[n-1];return at(i,t)>t_}):e,nle=e=>{switch(e){case 0:return Kr;case 1:return Hn;case 2:return ls}return Ur},BA=(e,t,n,i,s,r,o)=>o?s&&r?mz(e,s,t,r):i:s?S4(n||[0,0],s,r??ve([s])):i,zA=(e,t,n,i,s)=>ple(e,t,n,n&&wa(n,s,Array(4).fill(wp(n,s,e))),i,s),HA=(e,t,n,i)=>Za(Ya(e),n,t,i,!0,!0),VA=(e,t)=>e[0]===t[0]&&e[1]===t[1],uz=(e,t=t_)=>e.slice(1).map((n,i)=>Math.abs(n[0]-e[i][0])<t||Math.abs(n[1]-e[i][1])<t).every(Boolean),vi=(e,t,n,i)=>{let s=!1;const{points:r,fixedSegments:o,startBinding:a,endBinding:l,fileId:c}=n;ge(e)&&(Object.keys(n).length===0||typeof r<"u"||typeof o<"u"||typeof a<"u"||typeof l<"u")?n={...n,angle:0,...yg({...e,x:n.x||e.x,y:n.y||e.y},t,n,i)}:typeof r<"u"&&(n={...Oh(r),...n});for(const u in n){const d=n[u];if(typeof d<"u"){if(e[u]===d&&(typeof d!="object"||d===null||u==="groupIds"||u==="scale"))continue;if(u==="scale"){const f=e[u],h=d;if(f[0]===h[0]&&f[1]===h[1])continue}else if(u==="points"){const f=e[u],h=d;if(f.length===h.length){let m=!1,p=f.length;for(;--p;){const U=f[p],b=h[p];if(U[0]!==b[0]||U[1]!==b[1]){m=!0;break}}if(!m)continue}}e[u]=d,s=!0}}return s&&((typeof n.height<"u"||typeof n.width<"u"||typeof c<"u"||typeof r<"u")&&Zt.delete(e),e.version=n.version??e.version+1,e.versionNonce=n.versionNonce??Rr(),e.updated=bg()),e},Te=(e,t,n=!1)=>{let i=!1;for(const s in t){const r=t[s];if(typeof r<"u"){if(e[s]===r&&(typeof r!="object"||r===null))continue;i=!0}}return!i&&!n?e:{...e,...t,version:t.version??e.version+1,versionNonce:t.versionNonce??Rr(),updated:bg()}},Da=(e,t)=>(e.version=(t??e.version)+1,e.versionNonce=Rr(),e.updated=bg(),e),ile=e=>!e[H.CTRL_OR_CMD],qu=e=>e.isBindingEnabled,kt=5,sle=10,rle=(e,t)=>{const n=[];return t.forEach(i=>{const s=e.getNonDeletedElement(i);s!=null&&n.push(s)}),n},l6=(e,t,n,i)=>{i.getNonDeletedElementsMap();const s=new Set,r=new Set;$A(e,t,n,"start",s,r,i),$A(e,n,t,"end",s,r,i);const o=Array.from(r).filter(a=>!s.has(a));rle(i,o).forEach(a=>{var l;i.mutateElement(a,{boundElements:(l=a.boundElements)==null?void 0:l.filter(c=>c.type!=="arrow"||c.id!==e.id)})})},$A=(e,t,n,i,s,r,o,a)=>{if(t!=="keep"){if(t===null){const l=ule(e,i,o);l!=null&&r.add(l);return}gz(e)?(n==null||(n==="keep"?!fz(e,t,i):i==="start"||n.id!==t.id))&&(ea(e,t,i,o),s.add(t.id)):(ea(e,t,i,o),s.add(t.id))}},dz=(e,t,n)=>["start","end"].map(i=>{var o,a;const s=pz(e,i,t),r=i==="start"?(o=e.startBinding)==null?void 0:o.elementId:(a=e.endBinding)==null?void 0:a.elementId;if(r){const l=t.get(r);if(ro(l)&&D2(l,s,t,n))return l}return null}),ole=(e,t,n,i,s,r)=>{const a=e.points.length-1,l=n.findIndex(f=>f===0)>-1,c=n.findIndex(f=>f===a)>-1,u=l?t?d6(e,"start",i,s,r):null:"keep",d=c?t?d6(e,"end",i,s,r):null:"keep";return[u,d]},ale=(e,t,n,i,s)=>{if(ge(e))return["keep","keep"];const[r,o]=dz(e,t,s),a=r&&i?d6(e,"start",t,n,s):null,l=o&&i?d6(e,"end",t,n,s):null;return[a,l]},c6=(e,t,n,i,s)=>{e.forEach(r=>{const[o,a]=n!=null&&n.length?ole(r,t,n??[],i.getNonDeletedElementsMap(),i.getNonDeletedElements(),s):ale(r,i.getNonDeletedElementsMap(),i.getNonDeletedElements(),t,s);l6(r,o,a,i)})},R8=(e,t,n)=>e.length>50?[]:e.filter(Se).flatMap(i=>dz(i,t,n)).filter(i=>i!==null).filter(i=>e.filter(s=>s.id===(i==null?void 0:i.id)).length===0),I4=(e,t,n,i,s)=>Array.from(t.reduce((r,o)=>{const a=Za(o,n.getNonDeletedElements(),n.getNonDeletedElementsMap(),i,ge(e),ge(e));return a!=null&&!hz(e,s==null?void 0:s.id,a)&&r.add(a),r},new Set)),lle=(e,t,n,i)=>{const s=i.getNonDeletedElements(),r=i.getNonDeletedElementsMap();t.startBoundElement!=null&&ea(e,t.startBoundElement,"start",i);const o=Za(n,s,r,t.zoom,ge(e),ge(e));o!==null&&(fz(e,o,"end")||ea(e,o,"end",i))},cle=(e,t)=>({...e,gap:Math.min(e.gap,Eg(t,t.width,t.height))}),ea=(e,t,n,i)=>{if(!xe(e))return;let s={elementId:t.id,...cle(hle(e,t,n,i.getNonDeletedElementsMap()),t)};ge(e)&&(s={...s,...u6(e,t,n,i.getNonDeletedElementsMap())}),i.mutateElement(e,{[n==="start"?"startBinding":"endBinding"]:s}),ve(t.boundElements||[]).has(e.id)||i.mutateElement(t,{boundElements:(t.boundElements||[]).concat({id:e.id,type:"arrow"})})},fz=(e,t,n)=>{const i=e[n==="start"?"endBinding":"startBinding"];return hz(e,i==null?void 0:i.elementId,t)},hz=(e,t,n)=>t===n.id&&gz(e),gz=e=>e.points.length<3&&!ge(e),ule=(e,t,n)=>{const i=t==="start"?"startBinding":"endBinding",s=e[i];return s==null?null:(n.mutateElement(e,{[i]:null}),s.elementId)},Za=(e,t,n,i,s,r)=>{if(r){let a=!1;const l=fle(t,u=>ro(u,!1)&&D2(u,e,n,i,(s||!x2(u))&&!Ee(u))).filter(u=>a?!1:(x2(u)||(a=!0),!0));if(!l||l.length===0)return null;if(l.length===1)return l[0];const c=l.filter(u=>D2(u,e,n,i,!1));return c.length===1?c[0]:l.sort((u,d)=>d.width**2+d.height**2-(u.width**2+u.height**2)).pop()}return dle(t,a=>ro(a,!1)&&D2(a,e,n,i,(s||!x2(a))&&!Ee(a)))},dle=(e,t)=>{let n=null;for(let i=e.length-1;i>=0;--i){const s=e[i];if(!s.isDeleted&&t(s)){n=s;break}}return n},fle=(e,t)=>{const n=[];for(let i=e.length-1;i>=0;--i){const s=e[i];s.isDeleted||t(s)&&n.push(s)}return n},hle=(e,t,n,i)=>{const s=n==="start"?-1:1,r=s===-1?0:e.points.length-1,o=r-s,a=pe.getPointAtIndexGlobalCoordinates(e,r,i),l=pe.getPointAtIndexGlobalCoordinates(e,o,i);return{focus:wle(t,i,l,a),gap:Math.max(1,wp(t,i,a))}},Is=(e,t,n)=>{if(!ro(e))return;const{newSize:i,simultaneouslyUpdated:s}=n??{},r=mle(s);let o=t.getNonDeletedElementsMap();n!=null&&n.changedElements&&(o=new Map(o),n.changedElements.forEach(a=>{o.set(a.id,a)})),f6(o,e,a=>{var p,U;if(!Se(a)||a.isDeleted||!gle(a,e))return;const l=a.startBinding?o.get(a.startBinding.elementId):null,c=a.endBinding?o.get(a.endBinding.elementId):null;let u=null,d=null;l&&c&&(u=si(l,o),d=si(c,o));const f={startBinding:GA(e,a.startBinding,i),endBinding:GA(e,a.endBinding,i)};if(r.has(a.id)){t.mutateElement(a,f);return}const h=h6(o,a,(b,y)=>{var w,v;if(b&&ro(b)&&(y==="startBinding"||y==="endBinding")&&(e.id===((w=a[y])==null?void 0:w.elementId)||e.id===((v=a[y==="startBinding"?"endBinding":"startBinding"])==null?void 0:v.elementId)&&!zd(u,d))){const I=Ele(a,y,f[y],b,o);if(I)return[y==="startBinding"?0:a.points.length-1,{point:I}]}return null}).filter(b=>b!==null);pe.movePoints(a,t,new Map(h),{...e.id===((p=a.startBinding)==null?void 0:p.elementId)?{startBinding:f.startBinding}:{},...e.id===((U=a.endBinding)==null?void 0:U.elementId)?{endBinding:f.endBinding}:{}});const m=Re(a,o);m&&!m.isDeleted&&Ep(a,t,!1)})},lm=(e,t,n)=>{Se(e)?c6([e],!0,[],t,n==null?void 0:n.zoom):Is(e,t,{...n,changedElements:new Map([[e.id,e]])})},gle=(e,t)=>{var n,i;return((n=e.startBinding)==null?void 0:n.elementId)===t.id||((i=e.endBinding)==null?void 0:i.elementId)===t.id},mle=e=>new Set((e||[]).map(t=>t.id)),ple=(e,t,n,i,s,r,o)=>{const a=zh(ue(t,e));return!n||!i?a:Ule(s,n,r,o)?e_(n,i,e):zh(ue(e,ri(n,r)))},Ule=(e,t,n,i)=>{const s=wp(t,n,e),r=Eg(t,t.width,t.height,i);return s>r?null:s},mz=(e,t,n,i)=>{const s=wa(t,i),r=e.points[n==="start"?0:e.points.length-1],o=x(e.x+r[0],e.y+r[1]),a=hae(t)?ble(t,i,o):o,l=ge(e),c=wg(s),u=n==="start"?1:e.points.length-2,d=q(x(e.x+e.points[u][0],e.y+e.points[u][1]),c,e.angle??0);let f=null;if(l){const h=Po(e_(t,s,o)),m=yle(t,i,a),p=x(h?c[0]:m[0],h?m[1]:c[1]),U=Ae(p,bi(In(qs(ue(m,p)),Math.max(t.width,t.height)*2),p));if(f=$o(t,i,U,kt).sort(Ma)[0],!f){const b=x(h?m[0]:c[0],h?c[1]:m[1]),y=Ae(b,bi(In(qs(ue(m,b)),Math.max(t.width,t.height)*2),b));f=$o(t,i,y,kt).sort(Ma)[0]}}else f=$o(t,i,Ae(d,bi(In(qs(ue(a,d)),at(a,d)+Math.max(t.width,t.height)*2),d)),kt).sort((h,m)=>Ma(h,d)-Ma(m,d))[0];return!f||Ma(a,f)<fp?a:l?f:a},ble=(e,t,n)=>{const i=ri(e,t),s=q(n,i,-e.angle);return s[0]<e.x&&s[1]<e.y?s[1]-e.y>-5?q(x(e.x-kt,e.y),i,e.angle):q(x(e.x,e.y-kt),i,e.angle):s[0]<e.x&&s[1]>e.y+e.height?s[0]-e.x>-5?q(x(e.x,e.y+e.height+kt),i,e.angle):q(x(e.x-kt,e.y+e.height),i,e.angle):s[0]>e.x+e.width&&s[1]>e.y+e.height?s[0]-e.x<e.width+kt?q(x(e.x+e.width,e.y+e.height+kt),i,e.angle):q(x(e.x+e.width+kt,e.y+e.height),i,e.angle):s[0]>e.x+e.width&&s[1]<e.y?s[0]-e.x<e.width+kt?q(x(e.x+e.width,e.y-kt),i,e.angle):q(x(e.x+e.width+kt,e.y),i,e.angle):n},yle=(e,t,n,i=.05)=>{const{x:s,y:r,width:o,height:a,angle:l}=e,c=ri(e,t,-.1,-.1),u=q(n,c,-l),d=Ke(i*a,5,80),f=Ke(i*o,5,80);if(u[0]<=s+o/2&&u[1]>c[1]-d&&u[1]<c[1]+d)return q(x(s-kt,c[1]),c,l);if(u[1]<=r+a/2&&u[0]>c[0]-f&&u[0]<c[0]+f)return q(x(c[0],r-kt),c,l);if(u[0]>=s+o/2&&u[1]>c[1]-d&&u[1]<c[1]+d)return q(x(s+o+kt,c[1]),c,l);if(u[1]>=r+a/2&&u[0]>c[0]-f&&u[0]<c[0]+f)return q(x(c[0],r+a+kt),c,l);if(e.type==="diamond"){const h=kt,m=x(s+o/4-h,r+a/4-h),p=x(s+3*o/4+h,r+a/4-h),U=x(s+o/4-h,r+3*a/4+h),b=x(s+3*o/4+h,r+3*a/4+h);if(at(m,u)<Math.max(f,d))return q(m,c,l);if(at(p,u)<Math.max(f,d))return q(p,c,l);if(at(U,u)<Math.max(f,d))return q(U,c,l);if(at(b,u)<Math.max(f,d))return q(b,c,l)}return n},Ele=(e,t,n,i,s)=>{if(n==null||n.elementId!==i.id&&e.points.length>2)return null;const r=t==="startBinding"?-1:1,o=r===-1?0:e.points.length-1;if(ge(e)&&s6(n)){const d=q5(n.fixedPoint)??u6(e,i,t==="startBinding"?"start":"end",s).fixedPoint,f=ri(i,s),h=x(i.x+d[0]*i.width,i.y+d[1]*i.height),m=q(h,f,i.angle);return pe.pointFromAbsoluteCoords(e,m,s)}const a=o-r,l=pe.getPointAtIndexGlobalCoordinates(e,a,s),c=_le(i,s,n.focus,l);let u;if(n.gap===0)u=c;else{const d=pe.getPointAtIndexGlobalCoordinates(e,o,s),f=ri(i,s),h=at(l,d)+at(l,f)+Math.max(i.width,i.height)*2,m=[...$o(i,s,Ae(l,bi(In(qs(ue(c,l)),h),l)),n.gap).sort((p,U)=>Ma(p,l)-Ma(U,l)),bi(In(qs(ue(c,l)),at(l,d)),l)];m.length>1?u=m[0]:m.length===1?u=c:u=d}return pe.pointFromAbsoluteCoords(e,u,s)},u6=(e,t,n,i)=>{const s=[t.x,t.y,t.x+t.width,t.y+t.height],r=mz(e,t,n,i),o=x(s[0]+(s[2]-s[0])/2,s[1]+(s[3]-s[1])/2),a=q(r,o,-t.angle);return{fixedPoint:q5([(a[0]-t.x)/t.width,(a[1]-t.y)/t.height])}},GA=(e,t,n)=>{if(t==null||n==null)return t;const{width:i,height:s}=n,{width:r,height:o}=e,a=Math.max(1,Math.min(Eg(e,i,s),t.gap*(i<s?i/r:s/o)));return{...t,gap:a}},d6=(e,t,n,i,s)=>Za(pz(e,t,n),i,n,s,ge(e),ge(e)),pz=(e,t,n)=>{const i=t==="start"?0:-1;return Ya(pe.getPointAtIndexGlobalCoordinates(e,i,n))},vle=(e,t,n)=>{for(const i of e){if("boundElements"in i&&i.boundElements&&Object.assign(i,{boundElements:i.boundElements.reduce((s,r)=>{const o=t.get(r.id);return o&&s.push({...r,id:o}),s},[])}),"containerId"in i&&i.containerId&&Object.assign(i,{containerId:t.get(i.containerId)??null}),"endBinding"in i&&i.endBinding){const s=t.get(i.endBinding.elementId);Object.assign(i,{endBinding:s?{...i.endBinding,elementId:s}:null})}if("startBinding"in i&&i.startBinding){const s=t.get(i.startBinding.elementId);Object.assign(i,{startBinding:s?{...i.startBinding,elementId:s}:null})}ge(i)&&Object.assign(i,yg(i,n,{points:[i.points[0],i.points[i.points.length-1]]}))}},Uz=(e,t)=>{const n=ve(e);for(const i of t)$f.unbindAffected(n,i,(s,r)=>vi(s,n,r)),Gf.unbindAffected(n,i,(s,r)=>vi(s,n,r))},b0=(e,t,n=[])=>{if(!e)return null;const i=e.filter(s=>!t.has(s.id));return i.push(...n.map(s=>({id:s.id,type:s.type}))),i},D2=(e,{x:t,y:n},i,s,r)=>{const o=x(t,n),a=Eg(e,e.width,e.height,s),l=(r||!x2(e))&&!Ee(e),c=[t-a,n-a,t+a,n+a],u=si(e,i);if(!zd(c,u))return!1;const d=$o(e,i,Ae(ri(e,i),o)),f=wp(e,i,o);return l?d.length===0||f<=a:d.length>0&&f<=a},Eg=(e,t,n,i)=>{const s=i!=null&&i.value&&i.value<1?i.value:1,o=(e.type==="diamond"?1/Math.sqrt(2):1)*Math.min(t,n);return Math.max(16,Math.min(.25*o,32),sle/s+kt)},wle=(e,t,n,i)=>{const s=ri(e,t);if(kr(n,i))return 0;const r=q(n,s,-e.angle),o=q(i,s,-e.angle),a=Math.sign(bt(ue(o,n),ue(o,s)))*-1,l=Ae(o,bi(In(qs(ue(o,r)),Math.max(e.width*2,e.height*2)),o)),c=e.type==="diamond"?[Ae(x(e.x+e.width/2,e.y),x(e.x+e.width/2,e.y+e.height)),Ae(x(e.x,e.y+e.height/2),x(e.x+e.width,e.y+e.height/2))]:[Ae(x(e.x,e.y),x(e.x+e.width,e.y+e.height)),Ae(x(e.x+e.width,e.y),x(e.x,e.y+e.height))],u=e.type==="diamond"?[Ae(x(e.x+e.width/2,e.y-e.height),x(e.x+e.width/2,e.y+e.height*2)),Ae(x(e.x-e.width,e.y+e.height/2),x(e.x+e.width*2,e.y+e.height/2))]:[Ae(x(e.x-e.width,e.y-e.height),x(e.x+e.width*2,e.y+e.height*2)),Ae(x(e.x+e.width*2,e.y-e.height),x(e.x-e.width,e.y+e.height*2))];return[am(l,u[0]),am(l,u[1])].filter(h=>h!==null).sort((h,m)=>Ma(h,i)-Ma(m,i)).map((h,m)=>a*at(s,h)/(e.type==="diamond"?at(c[m][0],c[m][1])/2:Math.sqrt(e.width**2+e.height**2)/2)).sort((h,m)=>Math.abs(h)-Math.abs(m))[0]??0},_le=(e,t,n,i)=>{const s=ri(e,t);if(n===0)return s;const r=(e.type==="diamond"?[x(e.x,e.y+e.height/2),x(e.x+e.width/2,e.y),x(e.x+e.width,e.y+e.height/2),x(e.x+e.width/2,e.y+e.height)]:[x(e.x,e.y),x(e.x+e.width,e.y),x(e.x+e.width,e.y+e.height),x(e.x,e.y+e.height)]).map(l=>bi(In(ue(l,s),Math.abs(n)),s)).map(l=>q(l,s,e.angle)),o=[bt(ue(i,r[0]),ue(r[1],r[0]))>0&&(n>0?bt(ue(i,r[1]),ue(r[2],r[1]))<0:bt(ue(i,r[3]),ue(r[0],r[3]))<0),bt(ue(i,r[1]),ue(r[2],r[1]))>0&&(n>0?bt(ue(i,r[2]),ue(r[3],r[2]))<0:bt(ue(i,r[0]),ue(r[1],r[0]))<0),bt(ue(i,r[2]),ue(r[3],r[2]))>0&&(n>0?bt(ue(i,r[3]),ue(r[0],r[3]))<0:bt(ue(i,r[1]),ue(r[2],r[1]))<0),bt(ue(i,r[3]),ue(r[0],r[3]))>0&&(n>0?bt(ue(i,r[0]),ue(r[1],r[0]))<0:bt(ue(i,r[2]),ue(r[3],r[2]))<0)];return o[0]?n>0?r[1]:r[0]:o[1]?n>0?r[2]:r[1]:o[2]?n>0?r[3]:r[2]:n>0?r[0]:r[3]},Tle=new Set(["boundElements","frameId","containerId","startBinding","endBinding"]),f6=(e,t,n)=>{var i;ro(t)&&(((i=t.boundElements)==null?void 0:i.slice())??[]).forEach(({id:r})=>{n(e.get(r),"boundElements",r)})},h6=(e,t,n)=>{const i=[];if(t.frameId){const s=t.frameId;i.push(n(e.get(s),"frameId",s))}if(zt(t)){const s=t.containerId;i.push(n(e.get(s),"containerId",s))}if(xe(t)){if(t.startBinding){const s=t.startBinding.elementId;i.push(n(e.get(s),"startBinding",s))}if(t.endBinding){const s=t.endBinding.elementId;i.push(n(e.get(s),"endBinding",s))}}return i};class $f{static unbindAffected(t,n,i){n&&h6(t,n,s=>{!s||s.isDeleted||f6(t,s,(r,o,a)=>{a===n.id&&i(s,{boundElements:b0(s.boundElements,new Set([a]))})})})}}F($f,"rebindAffected",(t,n,i)=>{!n||n.isDeleted||h6(t,n,(s,r)=>{var o,a;if(!s||s.isDeleted){i(n,{[r]:null});return}r!=="frameId"&&((o=s.boundElements)!=null&&o.find(l=>l.id===n.id)||(xe(n)&&i(s,{boundElements:b0(s.boundElements,new Set,new Array(n))}),de(n)&&((a=s.boundElements)!=null&&a.find(l=>l.type==="text")?i(n,{[r]:null}):i(s,{boundElements:b0(s.boundElements,new Set,new Array(n))}))))})});class Gf{static unbindAffected(t,n,i){n&&f6(t,n,s=>{!s||s.isDeleted||h6(t,s,(r,o,a)=>{a===n.id&&i(s,{[o]:null})})})}}F(Gf,"rebindAffected",(t,n,i)=>{!n||n.isDeleted||f6(t,n,(s,r,o)=>{var a,l;if(!s||s.isDeleted){i(n,{boundElements:b0(n.boundElements,new Set([o]))});return}de(s)&&(((l=(((a=n.boundElements)==null?void 0:a.slice())??[]).reverse().find(u=>u.type==="text"))==null?void 0:l.id)===s.id?s.containerId!==n.id&&i(s,{containerId:n.id}):(s.containerId!==null&&i(s,{containerId:null}),i(n,{boundElements:b0(n.boundElements,new Set([s.id]))})))})});const S4=(e,t,n)=>{const[i,s]=q5(e);return q(x(t.x+t.width*i,t.y+t.height*s),ri(t,n),t.angle)},Ile=(e,t)=>{const n=e.startBinding&&t.get(e.startBinding.elementId),i=e.endBinding&&t.get(e.endBinding.elementId),s=n&&e.startBinding?S4(e.startBinding.fixedPoint,n,t):x(e.x+e.points[0][0],e.y+e.points[0][1]),r=i&&e.endBinding?S4(e.endBinding.fixedPoint,i,t):x(e.x+e.points[e.points.length-1][0],e.y+e.points[e.points.length-1][1]);return[s,r]},Sle=(e,t)=>{const[n,i]=Ile(e,t);return[pe.pointFromAbsoluteCoords(e,n,t),pe.pointFromAbsoluteCoords(e,i,t)]},q5=e=>e&&(Math.abs(e[0]-.5)<1e-4||Math.abs(e[1]-.5)<1e-4)?e.map(t=>Math.abs(t-.5)<1e-4?.5001:t):e,D8=({points:e})=>{const t=e[0][0],n=e[0][1];return{points:e.map(i=>x(i[0]-t,i[1]-n)),offsetX:t,offsetY:n}},Ie=class Ie{constructor(t,n,i=!1){F(this,"elementId");F(this,"selectedPointsIndices");F(this,"pointerDownState");F(this,"isDragging");F(this,"lastUncommittedPoint");F(this,"pointerOffset");F(this,"startBindingElement");F(this,"endBindingElement");F(this,"hoverPointIndex");F(this,"segmentMidPointHoveredCoords");F(this,"elbowed");F(this,"customLineAngle");F(this,"isEditing");this.elementId=t.id,kr(t.points[0],x(0,0))||(console.error("Linear element is not normalized",Error().stack),vi(t,n,Ie.getNormalizeElementPointsAndCoords(t))),this.selectedPointsIndices=null,this.lastUncommittedPoint=null,this.isDragging=!1,this.pointerOffset={x:0,y:0},this.startBindingElement="keep",this.endBindingElement="keep",this.pointerDownState={prevSelectedPointsIndices:null,lastClickedPoint:-1,lastClickedIsEndPoint:!1,origin:null,segmentMidpoint:{value:null,index:null,added:!1}},this.hoverPointIndex=-1,this.segmentMidPointHoveredCoords=null,this.elbowed=ge(t)&&t.elbowed,this.customLineAngle=null,this.isEditing=i}static getElement(t,n){const i=n.get(t);return i||null}static handleBoxSelection(t,n,i,s){var p;if(!((p=n.selectedLinearElement)!=null&&p.isEditing)||!n.selectionElement)return!1;const{selectedLinearElement:r}=n,{selectedPointsIndices:o,elementId:a}=r,l=Ie.getElement(a,s);if(!l)return!1;const[c,u,d,f]=ze(n.selectionElement,s),m=Ie.getPointsGlobalCoordinates(l,s).reduce((U,b,y)=>((b[0]>=c&&b[0]<=d&&b[1]>=u&&b[1]<=f||t.shiftKey&&(o!=null&&o.includes(y)))&&U.push(y),U),[]).filter(U=>!(ge(l)&&U!==0&&U!==l.points.length-1));i({selectedLinearElement:{...r,selectedPointsIndices:m.length?m:null}})}static handlePointDragging(t,n,i,s,r){var h,m;if(!r)return null;const{elementId:o}=r,a=n.scene.getNonDeletedElementsMap(),l=Ie.getElement(o,a);let c=r.customLineAngle;if(!l||ge(l)&&!r.pointerDownState.lastClickedIsEndPoint&&r.pointerDownState.lastClickedPoint!==0)return null;const u=ge(l)?[(h=r.selectedPointsIndices)!=null&&h.includes(0)?0:void 0,(m=r.selectedPointsIndices)!=null&&m.find(p=>p>0)?l.points.length-1:void 0].filter(p=>p!==void 0):r.selectedPointsIndices,d=ge(l)?r.pointerDownState.lastClickedPoint>0?l.points.length-1:0:r.pointerDownState.lastClickedPoint,f=l.points[d];if(u&&f){if(g0(t)&&u.length===1&&l.points.length>1){const y=u[0],w=l.points[y===0?1:y-1];c=r.customLineAngle??Math.atan2(l.points[y][1]-w[1],l.points[y][0]-w[0]);const[v,I]=Ie._getShiftLockedDelta(l,a,w,x(i,s),t[H.CTRL_OR_CMD]?null:n.getEffectiveGridSize(),c);Ie.movePoints(l,n.scene,new Map([[y,{point:x(v+w[0],I+w[1]),isDragging:y===d}]]))}else{const y=Ie.createPointAt(l,a,i-r.pointerOffset.x,s-r.pointerOffset.y,t[H.CTRL_OR_CMD]?null:n.getEffectiveGridSize()),w=y[0]-f[0],v=y[1]-f[1];Ie.movePoints(l,n.scene,new Map(u.map(I=>{const C=I===d?Ie.createPointAt(l,a,i-r.pointerOffset.x,s-r.pointerOffset.y,t[H.CTRL_OR_CMD]?null:n.getEffectiveGridSize()):x(l.points[I][0]+w,l.points[I][1]+v);return[I,{point:C,isDragging:I===d}]})))}Re(l,a)&&Ep(l,n.scene,!1);let U=[];if(za(l,!1)){const y=u[0]===0,w=u[u.length-1]===l.points.length-1,v=[];!y!=!w?v.push({x:i,y:s}):(y&&v.push(Ya(Ie.getPointGlobalCoordinates(l,l.points[0],a))),w&&v.push(Ya(Ie.getPointGlobalCoordinates(l,l.points[u[u.length-1]],a)))),v.length&&(U=I4(l,v,n.scene,n.state.zoom))}const b={...r,selectedPointsIndices:u,segmentMidPointHoveredCoords:d!==0&&d!==l.points.length-1?this.getPointGlobalCoordinates(l,f,a):null,hoverPointIndex:d===0||d===l.points.length-1?d:-1,isDragging:!0,customLineAngle:c};return{...n.state,selectedLinearElement:b,suggestedBindings:U}}return null}static handlePointerUp(t,n,i,s){var m;const r=s.getNonDeletedElementsMap(),o=s.getNonDeletedElements(),a=Dt(t,i),{elementId:l,selectedPointsIndices:c,isDragging:u,pointerDownState:d}=n,f=Ie.getElement(l,r);if(!f)return n;const h={};if(u&&c){for(const p of c)if(p===0||p===f.points.length-1){qo(f.points,i.zoom.value)&&(tn(f)&&s.mutateElement(f,{...p_(f,!0)},{informMutation:!1,isDragging:!1}),Ie.movePoints(f,s,new Map([[p,{point:p===0?f.points[f.points.length-1]:f.points[0]}]])));const U=qu(i)?Za(((c==null?void 0:c.length)??0)>1?Ya(Ie.getPointAtIndexGlobalCoordinates(f,p,r)):a,o,r,i.zoom,ge(f),ge(f)):null;h[p===0?"startBindingElement":"endBindingElement"]=U}}return{...n,...h,segmentMidPointHoveredCoords:null,hoverPointIndex:-1,selectedPointsIndices:u||t.shiftKey?!u&&t.shiftKey&&((m=d.prevSelectedPointsIndices)!=null&&m.includes(d.lastClickedPoint))?c&&c.filter(p=>p!==d.lastClickedPoint):c:c!=null&&c.includes(d.lastClickedPoint)?[d.lastClickedPoint]:c,isDragging:!1,pointerOffset:{x:0,y:0},customLineAngle:null}}static isSegmentTooShort(t,n,i,s,r){if(ge(t))return s>=0&&s<t.points.length?at(n,i)*r.value<Ie.POINT_HANDLE_SIZE/2:!1;let o=at(n,i);if(t.points.length>2&&t.roundness){const[a,l]=i6(t);gn(a.length===0&&l.length>0,"Only linears built out of curves are supported"),gn(a.length+l.length>=s,"Invalid segment index while calculating mid point"),o=O9(l[s])}return o*r.value<Ie.POINT_HANDLE_SIZE*4}static getSegmentMidPoint(t,n){if(ge(t)){gn(t.points.length>=n,"Invalid segment index while calculating elbow arrow mid point");const r=Yb(t.points[n-1],t.points[n]);return x(t.x+r[0],t.y+r[1])}const[i,s]=i6(t);if(gn(i.length===0&&s.length>0||i.length>0&&s.length===0,"Only linears built out of either segments or curves are supported"),gn(i.length+s.length>=n,"Invalid segment index while calculating mid point"),i.length){const r=i[n-1];return Yb(r[0],r[1])}if(s.length){const r=s[n-1];return ore(r,.5)}gn(!1,"Invalid segment type while calculating mid point")}static getSegmentMidPointIndex(t,n,i,s){const r=Ie.getElement(t.elementId,s);if(!r)return-1;const o=Ie.getEditorMidPoints(r,s,n);let a=0;for(;a<o.length;){if(Ie.arePointsEqual(i,o[a]))return a+1;a++}return-1}static handlePointerDown(t,n,i,s,r,o){var T,k;const a=n.state,l=o.getNonDeletedElementsMap(),c=o.getNonDeletedElements(),u={didAddPoint:!1,hitElement:null,linearElementEditor:null};if(!r)return u;const{elementId:d}=r,f=Ie.getElement(d,l);if(!f)return u;const h=Ie.getSegmentMidpointHitCoords(r,s,a,l);let m=null;if(h)m=Ie.getSegmentMidPointIndex(r,a,h,l);else if(t.altKey&&((T=a.selectedLinearElement)!=null&&T.isEditing))return r.lastUncommittedPoint==null&&(o.mutateElement(f,{points:[...f.points,Ie.createPointAt(f,l,s.x,s.y,t[H.CTRL_OR_CMD]?null:n.getEffectiveGridSize())]}),u.didAddPoint=!0),i.scheduleCapture(),u.linearElementEditor={...r,pointerDownState:{prevSelectedPointsIndices:r.selectedPointsIndices,lastClickedPoint:-1,lastClickedIsEndPoint:!1,origin:{x:s.x,y:s.y},segmentMidpoint:{value:h,index:m,added:!1}},selectedPointsIndices:[f.points.length-1],lastUncommittedPoint:null,endBindingElement:Za(s,c,l,n.state.zoom,r.elbowed)},u.didAddPoint=!0,u;const p=Ie.getPointIndexUnderCursor(f,l,a.zoom,s.x,s.y);if(p>=0||h)u.hitElement=f;else{const{startBindingElement:S,endBindingElement:R}=r;qu(a)&&za(f)&&l6(f,S,R,o)}const[U,b,y,w]=ze(f,l),v=(U+y)/2,I=(b+w)/2,C=p>-1&&q(x(f.x+f.points[p][0],f.y+f.points[p][1]),x(v,I),f.angle),_=p>-1||t.shiftKey?t.shiftKey||(k=r.selectedPointsIndices)!=null&&k.includes(p)?xle([...r.selectedPointsIndices||[],p]):[p]:null;return u.linearElementEditor={...r,pointerDownState:{prevSelectedPointsIndices:r.selectedPointsIndices,lastClickedPoint:p,lastClickedIsEndPoint:p===f.points.length-1,origin:{x:s.x,y:s.y},segmentMidpoint:{value:h,index:m,added:!1}},selectedPointsIndices:_,pointerOffset:C?{x:s.x-C[0],y:s.y-C[1]}:{x:0,y:0}},u}static arePointsEqual(t,n){return!t&&!n?!0:!t||!n?!1:kr(t,n)}static handlePointerMove(t,n,i,s){var h,m;const r=s.state;if(!((h=r.selectedLinearElement)!=null&&h.isEditing))return null;const{elementId:o,lastUncommittedPoint:a}=r.selectedLinearElement,l=s.scene.getNonDeletedElementsMap(),c=Ie.getElement(o,l);if(!c)return r.selectedLinearElement;const{points:u}=c,d=u[u.length-1];if(!t.altKey)return d===a&&Ie.deletePoints(c,s,[u.length-1]),(m=r.selectedLinearElement)!=null&&m.lastUncommittedPoint?{...r.selectedLinearElement,lastUncommittedPoint:null}:r.selectedLinearElement;let f;if(g0(t)&&u.length>=2){const p=u[u.length-2],[U,b]=Ie._getShiftLockedDelta(c,l,p,x(n,i),t[H.CTRL_OR_CMD]?null:s.getEffectiveGridSize());f=x(U+p[0],b+p[1])}else f=Ie.createPointAt(c,l,n-r.selectedLinearElement.pointerOffset.x,i-r.selectedLinearElement.pointerOffset.y,t[H.CTRL_OR_CMD]||ge(c)?null:s.getEffectiveGridSize());return d===a?Ie.movePoints(c,s.scene,new Map([[c.points.length-1,{point:f}]])):Ie.addPoints(c,s.scene,[f]),{...r.selectedLinearElement,lastUncommittedPoint:c.points[c.points.length-1]}}static getPointGlobalCoordinates(t,n,i){const[s,r,o,a]=ze(t,i),l=(s+o)/2,c=(r+a)/2,{x:u,y:d}=t;return q(x(u+n[0],d+n[1]),x(l,c),t.angle)}static getPointsGlobalCoordinates(t,n){const[i,s,r,o]=ze(t,n),a=(i+r)/2,l=(s+o)/2;return t.points.map(c=>{const{x:u,y:d}=t;return q(x(u+c[0],d+c[1]),x(a,l),t.angle)})}static getPointAtIndexGlobalCoordinates(t,n,i){const s=n<0?t.points.length+n:n,[r,o,a,l]=ze(t,i),c=(r+a)/2,u=(o+l)/2,d=t.points[s],{x:f,y:h}=t;return q(d?x(f+d[0],h+d[1]):x(f,h),x(c,u),t.angle)}static pointFromAbsoluteCoords(t,n,i){if(ge(t))return x(n[0]-t.x,n[1]-t.y);const[s,r,o,a]=ze(t,i),l=(s+o)/2,c=(r+a)/2,[u,d]=q(x(n[0],n[1]),x(l,c),-t.angle);return x(u-t.x,d-t.y)}static getPointIndexUnderCursor(t,n,i,s,r){const o=Ie.getPointsGlobalCoordinates(t,n);let a=o.length;for(;--a>-1;){const l=o[a];if(at(x(s,r),x(l[0],l[1]))*i.value<Ie.POINT_HANDLE_SIZE+1)return a}return-1}static createPointAt(t,n,i,s,r){const o=On(i,s,r),[a,l,c,u]=ze(t,n),d=(a+c)/2,f=(l+u)/2,[h,m]=q(x(o[0],o[1]),x(d,f),-t.angle);return x(h-t.x,m-t.y)}static getNormalizeElementPointsAndCoords(t){const{points:n,offsetX:i,offsetY:s}=D8(t);return{points:n,x:t.x+i,y:t.y+s}}static duplicateSelectedPoints(t,n){var f;gn((f=t.selectedLinearElement)==null?void 0:f.isEditing,"Not currently editing a linear element");const i=n.getNonDeletedElementsMap(),{selectedPointsIndices:s,elementId:r}=t.selectedLinearElement,o=Ie.getElement(r,i);gn(o,"The linear element does not exist in the provided Scene"),gn(s!=null,"There are no selected points to duplicate");const{points:a}=o,l=[];let c=!1,u=-1;const d=a.reduce((h,m,p)=>{if(++u,h.push(m),s.includes(p)){const b=a[p+1];b||(c=!0),h.push(b?x((m[0]+b[0])/2,(m[1]+b[1])/2):x(m[0],m[1])),l.push(u+1),++u}return h},[]);if(n.mutateElement(o,{points:d}),c){const h=o.points[o.points.length-1];Ie.movePoints(o,n,new Map([[o.points.length-1,{point:x(h[0]+30,h[1]+30)}]]))}return{...t,selectedLinearElement:{...t.selectedLinearElement,selectedPointsIndices:l}}}static deletePoints(t,n,i){var u,d;const s=((u=n.state.selectedLinearElement)==null?void 0:u.isEditing)&&((d=n.state.selectedLinearElement)==null?void 0:d.lastUncommittedPoint)===t.points[t.points.length-1],r=t.points.filter((f,h)=>!i.includes(h));tn(t)&&t.polygon&&(s||i.includes(0)||i.includes(t.points.length-1))&&(r[0]=x(r[r.length-1][0],r[r.length-1][1]));const{points:a,offsetX:l,offsetY:c}=D8({points:r});Ie._updatePoints(t,n.scene,a,l,c)}static addPoints(t,n,i){const s=[...t.points,...i];tn(t)&&t.polygon&&(s[0]=x(s[s.length-1][0],s[s.length-1][1]));const{points:r,offsetX:o,offsetY:a}=D8({points:s});Ie._updatePoints(t,n,r,o,a)}static movePoints(t,n,i,s){var u,d,f;const{points:r}=t;if(tn(t)&&t.polygon){const h=i.get(0),m=i.get(r.length-1);h?i.set(r.length-1,{point:x(h.point[0],h.point[1]),isDragging:h.isDragging}):m&&i.set(0,{point:x(m.point[0],m.point[1]),isDragging:m.isDragging})}const o=((u=i.get(0))==null?void 0:u.point)??x(0,0),[a,l]=o,c=ge(t)?[((d=i.get(0))==null?void 0:d.point)??r[0],((f=i.get(r.length-1))==null?void 0:f.point)??r[r.length-1]]:r.map((h,m)=>{var U;const p=((U=i.get(m))==null?void 0:U.point)??h;return x(p[0]-a,p[1]-l)});Ie._updatePoints(t,n,c,a,l,s,{isDragging:Array.from(i.values()).some(h=>h.isDragging)})}static shouldAddMidpoint(t,n,i,s){var c;const r=Ie.getElement(t.elementId,s);if(r&&ge(r)||!r)return!1;const{segmentMidpoint:o}=t.pointerDownState;if(o.added||o.value===null||o.index===null||t.pointerDownState.origin===null)return!1;const a=t.pointerDownState.origin,l=at(x(a.x,a.y),x(n.x,n.y));return!(!((c=i.selectedLinearElement)!=null&&c.isEditing)&&l<JF/i.zoom.value)}static addMidpoint(t,n,i,s,r){const o=r.getNonDeletedElementsMap(),a=Ie.getElement(t.elementId,o);if(!a)return;const{segmentMidpoint:l}=t.pointerDownState,c={pointerDownState:t.pointerDownState,selectedPointsIndices:t.selectedPointsIndices},u=Ie.createPointAt(a,o,n.x,n.y,s&&!ge(a)?i.getEffectiveGridSize():null),d=[...a.points.slice(0,l.index),u,...a.points.slice(l.index)];return r.mutateElement(a,{points:d}),c.pointerDownState={...t.pointerDownState,segmentMidpoint:{...t.pointerDownState.segmentMidpoint,added:!0},lastClickedPoint:l.index},c.selectedPointsIndices=[l.index],c}static _updatePoints(t,n,i,s,r,o,a){if(ge(t)){const l={};(o==null?void 0:o.startBinding)!==void 0&&(l.startBinding=o.startBinding!==null&&s6(o.startBinding)?o.startBinding:null),(o==null?void 0:o.endBinding)!==void 0&&(l.endBinding=o.endBinding!==null&&s6(o.endBinding)?o.endBinding:null),l.points=Array.from(i),n.mutateElement(t,l,{informMutation:!0,isDragging:(a==null?void 0:a.isDragging)??!1})}else{const l=rM(t,i),c=rM(t,t.points),u=(l[0]+l[2])/2,d=(l[1]+l[3])/2,f=(c[0]+c[2])/2,h=(c[1]+c[3])/2,m=f-u,p=h-d,U=q(x(s,r),x(m,p),t.angle);n.mutateElement(t,{...o,points:i,x:t.x+U[0],y:t.y+U[1]})}}static _getShiftLockedDelta(t,n,i,s,r,o){const a=Ie.getPointGlobalCoordinates(t,i,n);if(ge(t))return[s[0]-a[0],s[1]-a[1]];const[l,c]=On(s[0],s[1],r),{width:u,height:d}=k4(a[0],a[1],l,c,o);return q(x(u,d),x(0,0),-t.angle)}static moveFixedSegment(t,n,i,s,r){const o=r.getNonDeletedElementsMap(),a=Ie.getElement(t.elementId,o);if(!a||!ge(a))return t;if(n&&n>0&&n<a.points.length){const l=Po(zh(ue(a.points[n],a.points[n-1]))),c=(a.fixedSegments??[]).reduce((h,m)=>(h[m.index]=m,h),{});c[n]={index:n,start:x(l?a.points[n-1][0]:i-a.x,l?s-a.y:a.points[n-1][1]),end:x(l?a.points[n][0]:i-a.x,l?s-a.y:a.points[n][1])};const u=Object.values(c).sort((h,m)=>h.index-m.index),d=u.map(h=>h.index).reduce((h,m)=>m<n?h+1:h,0);r.mutateElement(a,{fixedSegments:u});const f=x(a.x+(a.fixedSegments[d].start[0]+a.fixedSegments[d].end[0])/2,a.y+(a.fixedSegments[d].start[1]+a.fixedSegments[d].end[1])/2);return{...t,segmentMidPointHoveredCoords:f,pointerDownState:{...t.pointerDownState,segmentMidpoint:{added:!1,index:a.fixedSegments[d].index,value:f}}}}return t}static deleteFixedSegment(t,n,i){var s;n.mutateElement(t,{fixedSegments:(s=t.fixedSegments)==null?void 0:s.filter(r=>r.index!==i)})}};F(Ie,"POINT_HANDLE_SIZE",10),F(Ie,"getEditorMidPoints",(t,n,i)=>{var l;const s=Re(t,n);if(!ge(t)&&!((l=i.selectedLinearElement)!=null&&l.isEditing)&&t.points.length>2&&!s)return[];const r=Ie.getPointsGlobalCoordinates(t,n);let o=0;const a=[];for(;o<r.length-1;){if(Ie.isSegmentTooShort(t,t.points[o],t.points[o+1],o,i.zoom)){a.push(null),o++;continue}const c=Ie.getSegmentMidPoint(t,o+1);a.push(c),o++}return a}),F(Ie,"getSegmentMidpointHitCoords",(t,n,i,s)=>{var h;const{elementId:r}=t,o=Ie.getElement(r,s);if(!o)return null;const a=Ie.getPointIndexUnderCursor(o,s,i.zoom,n.x,n.y);if(!ge(o)&&a>=0||Ie.getPointsGlobalCoordinates(o,s).length>=3&&!((h=i.selectedLinearElement)!=null&&h.isEditing)&&!ge(o))return null;const c=(Ie.POINT_HANDLE_SIZE+1)/i.zoom.value,u=t.segmentMidPointHoveredCoords;if(u&&at(x(u[0],u[1]),x(n.x,n.y))<=c)return u;let d=0;const f=Ie.getEditorMidPoints(o,s,i);for(;d<f.length;){if(f[d]!==null&&at(f[d],x(n.x,n.y))<=c)return f[d];d++}return null}),F(Ie,"getBoundTextElementPosition",(t,n,i)=>{Ie.getPointsGlobalCoordinates(t,i).length<2&&vi(n,i,{isDeleted:!0});let r=0,o=0;if(t.points.length%2===1){const a=Math.floor(t.points.length/2),l=Ie.getPointGlobalCoordinates(t,t.points[a],i);r=l[0]-n.width/2,o=l[1]-n.height/2}else{const a=t.points.length/2-1,l=Ie.getSegmentMidPoint(t,a+1);r=l[0]-n.width/2,o=l[1]-n.height/2}return{x:r,y:o}}),F(Ie,"getMinMaxXYWithBoundText",(t,n,i,s)=>{let[r,o,a,l]=i;const c=(r+a)/2,u=(o+l)/2,{x:d,y:f}=Ie.getBoundTextElementPosition(t,s,n),h=d+s.width,m=f+s.height,p=x(c,u),U=q(x(r,o),p,t.angle),b=q(x(a,o),p,t.angle),y=q(x(d,f),p,-t.angle),w=q(x(h,f),p,-t.angle),v=q(x(d,m),p,-t.angle),I=q(x(h,m),p,-t.angle);return U[0]<b[0]&&U[1]>=b[1]?(r=Math.min(r,v[0]),a=Math.max(a,Math.max(w[0],I[0])),o=Math.min(o,y[1]),l=Math.max(l,I[1])):U[0]>=b[0]&&U[1]>b[1]?(r=Math.min(r,I[0]),a=Math.max(a,Math.max(y[0],w[0])),o=Math.min(o,v[1]),l=Math.max(l,w[1])):U[0]>=b[0]?(r=Math.min(r,w[0]),a=Math.max(a,v[0]),o=Math.min(o,I[1]),l=Math.max(l,y[1])):U[1]<=b[1]&&(r=Math.min(r,Math.min(w[0],y[0])),a=Math.max(a,I[0]),o=Math.min(o,w[1]),l=Math.max(l,v[1])),[r,o,a,l,c,u]}),F(Ie,"getElementAbsoluteCoords",(t,n,i=!1)=>{let s,r,o,a,l;if(t.points.length<2||!Zt.get(t)){const{minX:f,minY:h,maxX:m,maxY:p}=t.points.reduce((U,[b,y])=>(U.minY=Math.min(U.minY,y),U.minX=Math.min(U.minX,b),U.maxX=Math.max(U.maxX,b),U.maxY=Math.max(U.maxY,y),U),{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0});r=f+t.x,o=h+t.y,a=m+t.x,l=p+t.y}else{const f=Zt.generateElementShape(t,null),h=Fd(f[0]),[m,p,U,b]=iy(h);r=m+t.x,o=p+t.y,a=U+t.x,l=b+t.y}const c=(r+a)/2,u=(o+l)/2;if(s=[r,o,a,l,c,u],!i)return s;const d=Re(t,n);return d&&(s=Ie.getMinMaxXYWithBoundText(t,n,[r,o,a,l],d)),s});let pe=Ie;const xle=e=>{let t=[...new Set(e.filter(n=>n!==null&&n!==-1))];return t=t.sort((n,i)=>n-i),t.length?t:null};function XA(e){return[Math.min(e[0][0],e[1][0]),Math.min(e[0][1],e[1][1]),Math.max(e[0][0],e[1][0]),Math.max(e[0][1],e[1][1])]}function Cle(e,t){return e[0]<=t[2]&&e[2]>=t[0]&&e[1]<=t[3]&&e[3]>=t[1]}const Ale=1e-6;function jA(e,t){const n=ue(e[1],e[0]),i=ue(t,e[0]),s=bt(n,i);return Math.abs(s)<Ale}function L8(e,t){const n=ue(e[1],e[0]),i=ue(t,e[0]);return bt(n,i)<0}function YA(e,t){return jA(e,t[0])||jA(e,t[1])||(L8(e,t[0])?!L8(e,t[1]):L8(e,t[1]))}function Mle(e,t){return Cle(XA(e),XA(t))&&YA(e,t)&&YA(t,e)}const kle=e=>e.type==="diamond"?[x(e.width/2,0),x(e.width,e.height/2),x(e.width/2,e.height),x(0,e.height/2)]:[x(0,0),x(0+e.width,0),x(0+e.width,e.height),x(0,e.height)],Rle=e=>Se(e)||Zi(e)?e.points:kle(e),WA=e=>{const t=e.reduce((n,[i,s])=>(n.minY=Math.min(n.minY,s),n.minX=Math.min(n.minX,i),n.maxX=Math.max(n.maxX,i),n.maxY=Math.max(n.maxY,s),n),{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0,cx:0,cy:0});return t.cx=(t.maxX+t.minX)/2,t.cy=(t.maxY+t.minY)/2,t},Dle=e=>{const t=Rle(e),{cx:n,cy:i}=WA(t),s=x(n,i),r=t.map(u=>q(u,s,e.angle)),{minX:o,minY:a,maxX:l,maxY:c}=WA(r);return[o+e.x,a+e.y,l+e.x,c+e.y]},Lle=(e,t)=>{const n=Dle(e);return(kU(n[0],Hi(t[0],t[2]))||kU(t[0],Hi(n[0],n[2])))&&(kU(n[1],Hi(t[1],t[3]))||kU(t[1],Hi(n[1],n[3])))},Nle=({elements:e,bounds:t,type:n,errorMargin:i=0})=>{var o;WB(t)&&(t=si(t,ve(e)));const s=[t[0]-i,t[1]-i,t[2]+i,t[3]+i],r=new Set;for(const a of e){if(r.has(a.id))continue;if(Lle(a,s)){if(r.add(a.id),a.boundElements)for(const c of a.boundElements)r.add(c.id);de(a)&&a.containerId&&r.add(a.containerId),xe(a)&&(a.startBinding&&r.add(a.startBinding.elementId),a.endBinding&&r.add((o=a.endBinding)==null?void 0:o.elementId))}}return e.filter(a=>r.has(a.id))},bz=(e,t,n)=>{const i=n.reduce((s,r)=>(r.groupIds.includes(e)&&(s[r.id]=!0),s),{});return Object.keys(i).length<2?t.selectedGroupIds[e]||t.editingGroupId===e?{selectedElementIds:t.selectedElementIds,selectedGroupIds:{...t.selectedGroupIds,[e]:!1},editingGroupId:null}:t:{editingGroupId:t.editingGroupId,selectedGroupIds:{...t.selectedGroupIds,[e]:!0},selectedElementIds:{...t.selectedElementIds,...i}}},Ii=function(){let e=null,t=null,n=null;const i=(r,o,a,l)=>{if(n!==void 0&&o===t&&r===e&&a.editingGroupId===(n==null?void 0:n.editingGroupId))return n;const c={};for(const f of r){let h=f.groupIds;if(a.editingGroupId){const m=h.indexOf(a.editingGroupId);m>-1&&(h=h.slice(0,m))}if(h.length>0){const m=h[h.length-1];c[m]=!0}}const u={},d=o.reduce((f,h)=>{if(h.isDeleted)return f;const m=h.groupIds.find(p=>c[p]);return m&&(f[h.id]=!0,Array.isArray(u[m])?u[m].push(h.id):u[m]=[h.id]),f},{});for(const f of Object.keys(u))u[f].length<2&&c[f]&&(c[f]=!1);return t=o,e=r,n={editingGroupId:a.editingGroupId,selectedGroupIds:c,selectedElementIds:St({...a.selectedElementIds,...d},l)},n},s=(r,o,a,l)=>{const c=l?l.scene.getSelectedElements({selectedElementIds:r.selectedElementIds,elements:o}):Ve(o,r);return c.length?i(c,o,r,a):{selectedGroupIds:{},editingGroupId:null,selectedElementIds:St(r.selectedElementIds,a)}};return s.clearCache=()=>{t=null,e=null,n=null},s}(),o_=(e,t)=>yz(e,t)!=null,yz=(e,t)=>t.groupIds.filter(n=>n!==e.editingGroupId).find(n=>e.selectedGroupIds[n]),yc=e=>Object.entries(e.selectedGroupIds).filter(([t,n])=>n).map(([t,n])=>t),_p=(e,t)=>{let n={...t,selectedGroupIds:{}};for(const i of e){let s=i.groupIds;if(t.editingGroupId){const r=s.indexOf(t.editingGroupId);r>-1&&(s=s.slice(0,r))}if(s.length>0){const r=s[s.length-1];n={...n,...bz(r,n,e)}}}return n.selectedGroupIds},Ole=(e,t)=>({...e,editingGroupId:t.groupIds.length?t.groupIds[0]:null,selectedGroupIds:{},selectedElementIds:{[t.id]:!0}}),cm=(e,t)=>e.groupIds.includes(t),Ct=(e,t)=>{const n=[];for(const i of e.values())cm(i,t)&&n.push(i);return n},Ez=(e,t)=>e.groupIds.find(n=>t[n]),Ple=(e,t,n)=>{const i=[...e],s=n?i.indexOf(n):-1,r=s>-1?s:i.length;return i.splice(r,0,t),i},Fle=(e,t)=>e.filter(n=>!t[n]),vz=(e,t)=>{const n=new Map;return e.forEach(i=>{const s=i.groupIds.length===0?i.id:i.groupIds[i.groupIds.length-1],r=n.get(s)||[],o=Re(i,t);o&&r.push(o),n.set(s,[...r,i])}),Array.from(n.values())},Ble=e=>{const t=new Set;for(const[,n]of e)if(!n.isDeleted)for(const i of n.groupIds??[])t.add(i);return t},a_=e=>{const t=e.flatMap(s=>s.groupIds),n=new Map;let i=0;for(const s of t)n.set(s,(n.get(s)??0)+1),n.get(s)>i&&(i=n.get(s));return i===e.length},Hh=e=>e.groupIds.length>0,zle=(e,t,n)=>{const i=[...e],s=t?e.indexOf(t):-1,r=s>-1?s:e.length;for(let o=0;o<r;o++)i[o]=n(i[o]);return i},Q5=(e,t,n)=>{const i=yc(n),s=e.filter(d=>!zt(d)),r=new Map,o=new Map,a=d=>{const f=o.get(d.id)||[],h=Re(d,t);h&&f.push(h),o.set(d.id,[...f,d])},l=(d,f)=>{const h=r.get(f)||[],m=Re(d,t);m&&h.push(m),r.set(f,[...h,d])},c=(d,f)=>{const h=d.groupIds.indexOf(f,0);return d.groupIds.slice(0,h).length>0?l(d,d.groupIds[h-1]):a(d)},u=e.every(d=>o_(n,d));return s.forEach(d=>{const f=Ez(d,n.selectedGroupIds);f?i.length===1&&u?c(d,f):l(d,f):a(d)}),Array.from(r.values()).concat(Array.from(o.values()))},l_=e=>{const t=new Set;return e.forEach(n=>{Ee(n)&&t.add(n.id)}),e.filter(n=>!(n.frameId&&t.has(n.frameId)))},c_=(e,t,n,i=!0)=>{const[s,r,o,a]=ze(t,n);let l=e.filter(c=>{let[u,d,f,h]=si(c,n);const m=Ss(c,n);if(m){const[p,U,b,y]=si(m,n);u=Math.max(p,u),d=Math.max(U,d),f=Math.min(b,f),h=Math.min(y,h)}return c.locked===!1&&c.type!=="selection"&&!zt(c)&&s<=u&&r<=d&&o>=f&&a>=h});return l=i?l_(l):l,l=l.filter(c=>{const u=Ss(c,n);return u?Fc(c,u,n):!0}),l},wz=(e,t,n,i)=>{const s=new Set(t.map(r=>r.id));return e.filter(r=>{const o=w6(r,n.width,n.height,n,i);return!s.has(r.id)&&o})},Yn=function(){let e=null,t=null,n=null;const i=(s,r)=>(n!=null&&s===e&&r.selectedElementIds===t||(n=s.some(o=>r.selectedElementIds[o.id]),e=s,t=r.selectedElementIds),n);return i.clearCache=()=>{e=null,t=null,n=null},i}(),Ve=(e,t,n)=>{const i=new Set,s=[];for(const r of e.values()){if(t.selectedElementIds[r.id]){s.push(r),i.add(r.id);continue}if(n!=null&&n.includeBoundTextElement&&zt(r)&&t.selectedElementIds[r==null?void 0:r.containerId]){s.push(r),i.add(r.id);continue}}if(n!=null&&n.includeElementsInFrames){const r=[];return s.forEach(o=>{Ee(o)&&Js(e,o.id).forEach(a=>!i.has(a.id)&&r.push(a)),r.push(o)}),r}return s},J5=(e,t)=>t.editingTextElement?[t.editingTextElement]:t.newElement?[t.newElement]:Ve(e,t,{includeBoundTextElement:!0}),St=(e,t)=>Wi(t.selectedElementIds,e)?t.selectedElementIds:e,Hle=(e,t)=>{var i;const n=e.filter(Se);if(n.length===1){const s=n[0],r=((i=s.boundElements)==null?void 0:i.map(a=>a.id))??[];if(e.every(a=>a.id===s.id||r.includes(a.id)))return new pe(s,ve(t))}return null},_z=(e,t,n)=>({selectedLinearElement:Hle(e,t),...Ii({editingGroupId:n.editingGroupId,selectedElementIds:l_(e).reduce((i,s)=>(zt(s)||(i[s.id]=!0),i),{})},t,n,null)}),Vle=(e,t,n)=>{const i=ve(e);for(const s of t)if(s.frameId){const r=n.get(s.id),o=n.get(s.frameId),a=r&&i.get(r);a&&vi(a,i,{frameId:o??null})}};function u_(e,t,n){const i=E6(t,n),s=E6(e,n);return i.some(o=>s.some(a=>Mle(o,a)))}const Tz=(e,t,n)=>ty(c_(e,t,n,!1)).filter(i=>!Ee(i)&&!i.frameId||i.frameId===t.id),d_=(e,t,n)=>c_([t],e,n).some(i=>i.id===t.id),Tp=(e,t,n)=>{const[i,s,r,o]=ze(t,n),[a,l,c,u]=ft(e);return i<=a&&s<=l&&r>=c&&o>=u},Fc=(e,t,n)=>Tp([e],t,n)||u_(e,t,n)||d_(e,t,n),KA=(e,t,n)=>{const[i,s,r,o]=ze(t,n);return om(x(i,s),x(e.x,e.y),x(r,o))},$le=e=>{const t=new Map;for(const n of e){const i=Ee(n)?n.id:n.frameId;i&&!t.has(i)&&t.set(i,Js(e,i))}return t},Js=(e,t)=>{const n=[];for(const i of e.values())i.frameId===t&&n.push(i);return n},f_=e=>e.filter(t=>Ee(t)),h_=e=>{const t=ve(f_(e));return e.filter(n=>t.has(n.id)||!n.frameId||!t.has(n.frameId))},Go=(e,t,n,i)=>{const s=Js(e,t.id),r=new Set(s),o=new Set([...Tz(e,t,i),...s.filter(f=>d_(f,t,i))]),a=s.filter(f=>!o.has(f)),l=new Set(Array.from(o).flatMap(f=>f.groupIds));for(const f of a)if(!u_(f,t,i))f.groupIds.length===0&&r.delete(f);else if(f.groupIds.length>0)for(const h of f.groupIds)l.add(h);for(const f of a)if(f.groupIds.length>0){let h=!0;for(const m of f.groupIds)l.has(m)&&(h=!1);h&&r.delete(f)}const c=Array.from(o).filter(f=>f.groupIds.length===0);for(const f of c)r.add(f);const u=Array.from(o).filter(f=>f.groupIds.length>0),d=_p(u,n);for(const[f,h]of Object.entries(d))if(h){const m=Ct(e,f);if(Tp(m,t,i))for(const p of m)r.add(p)}return[...r].filter(f=>!(de(f)&&f.containerId))},Gle=(e,t,n)=>Xle(ty(e,Tz(e,t,n)),t,n),Xle=(e,t,n)=>{const i=[],s=new Map;for(const r of e){let o=!1;if(r.groupIds.length>0){if(r.groupIds.some(a=>s.get(a)))o=!0;else{const a=new Set(r.groupIds.flatMap(l=>Ct(n,l)));o=!Tp(Array.from(a),t,n)}r.groupIds.forEach(a=>{s.set(a,o)})}o||i.push(r)}return i},Ss=(e,t)=>e.frameId&&t.get(e.frameId)||null,jle=(e,t)=>{const n=new Set,i=ve(e);e=ty(e);for(const o of e)Ee(o)&&o.id!==t.id&&n.add(o.id);const s=new Set,r=[];for(const o of e)if(!(Ee(o)||o.frameId&&n.has(o.frameId)))if(o.groupIds.length){const a=o.groupIds.at(-1);if(!s.has(a)){s.add(a);const l=Ct(e,a);if(l.some(c=>Fc(c,t,i)))for(const c of l)r.push(c)}}else Fc(o,t,i)&&r.push(o);return r},y0=(e,t,n,i)=>{const s=ve(e),r=new Map;for(const c of e.values())c.frameId===n.id&&r.set(c.id,!0);const o=new Set(t.map(c=>c.id)),a=[],l=new Set;for(const c of t)Ee(c)&&c.id!==n.id&&l.add(c.id);for(const c of ty(e,t)){if(Ee(c)||c.frameId&&l.has(c.frameId)||c.frameId&&i.selectedElementIds[c.id]&&i.selectedElementIds[c.frameId])continue;r.has(c.id)||a.push(c);const u=Re(c,s);u&&!o.has(u.id)&&!r.has(u.id)&&a.push(u)}for(const c of a)vi(c,s,{frameId:n.id});return e},ey=(e,t)=>{const n=new Map,i=new Map;for(const s of e)if(s.frameId){n.set(s.id,s);const r=i.get(s.frameId)||[];r.push(s);const o=Re(s,t);o&&(n.set(o.id,o),r.push(o)),i.set(s.frameId,r)}for(const[,s]of n)vi(s,t,{frameId:null})},Iz=(e,t)=>{const n=Js(e,t.id);return ey(n,ve(e)),e},vg=(e,t,n,i)=>y0(Iz(e,n),t,n,i.state).slice(),Vh=(e,t,n)=>{const i=n.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,elements:e}),s=new Set(i);if(t.editingGroupId)for(const a of i)a.groupIds.length===0?s.add(a):a.groupIds.flatMap(l=>Ct(e,l)).forEach(l=>s.add(l));const r=new Set,o=ve(e);return s.forEach(a=>{a.frameId&&!Ee(a)&&!m6(a,o,t)&&r.add(a)}),r.size>0&&ey(r,o),e},ty=(e,t)=>{const n=new Set,i=t||e;for(const o of i.values()){const a=o.groupIds[o.groupIds.length-1];a&&n.add(a)}const s=new Set;for(const o of n)Ct(e,o).some(a=>Ee(a))&&s.add(o);const r=[];for(const o of i.values())s.has(o.groupIds[o.groupIds.length-1])||r.push(o);return r},g6=(e,t,n)=>{const i=de(e)&&jn(e,t)||e;return i.frameId&&n.selectedElementIds[i.id]&&n.selectedElementIds[i.frameId]?Ss(i,t):n.selectedElementIds[i.id]&&n.selectedElementsAreBeingDragged?n.frameToHighlight:Ss(i,t)},m6=(e,t,n,i)=>{var l;const s=(i==null?void 0:i.targetFrame)??g6(e,t,n);if(!s)return!1;const r=de(e)&&jn(e,t)||e,o=c=>{i!=null&&i.checkedGroups&&r.groupIds.forEach(u=>{var d;(d=i.checkedGroups)==null||d.set(u,c)})};if(!n.selectedElementIds[r.id]||!n.selectedElementsAreBeingDragged||n.selectedElementIds[r.id]&&n.selectedElementIds[s.id])return!0;if(r.groupIds.length===0)return Fc(r,s,t);for(const c of r.groupIds)if((l=i==null?void 0:i.checkedGroups)!=null&&l.has(c))return i.checkedGroups.get(c);const a=new Set(r.groupIds.filter(c=>i!=null&&i.checkedGroups?!i.checkedGroups.has(c):!0).flatMap(c=>Ct(t,c)));if(n.editingGroupId&&n.selectedElementsAreBeingDragged){const c=new Set(Ve(t,n));if(n.frameToHighlight!==null)return!0;c.forEach(d=>{a.delete(d)})}for(const c of a)if(Ee(c))return o(!1),!1;for(const c of a)if(Fc(c,s,t))return o(!0),!0;return!1},x4=(e,t,n,i,s)=>{if(!n.frameRendering||!n.frameRendering.clip)return!1;const r=u_(e,t,i)||d_(e,t,i);if(r){for(const o of e.groupIds)s==null||s.set(o,!0);return!0}if(!r&&e.groupIds.length>0&&!Tp([e],t,i)){let o=!1;if(n.selectedElementsAreBeingDragged)o=m6(e,i,n,{targetFrame:t,checkedGroups:s});else{o=e.frameId===t.id;for(const a of e.groupIds)s==null||s.set(a,o)}for(const a of e.groupIds)s==null||s.set(a,o);return o}return!1},Yle="Frame",Wle="AI Frame",g_=e=>YB(e)?Yle:Wle,Sz=e=>e.name===null?g_(e):e.name,m_=(e,t)=>Nle({elements:e,bounds:t,type:"overlap"}).filter(n=>!n.frameId||n.frameId===t.id),xz=e=>{const t=ve(e);return e.length>1&&e.some(n=>n.frameId&&t.has(n.frameId))},Cz="invert(100%) hue-rotate(180deg) saturate(1.25)",Az=(e,t)=>Dn(e)&&!t.imageCache.has(e.fileId),Mz=(e,t,n)=>{var i;return n.theme===ke.DARK&&Dn(e)&&!Az(e,t)&&((i=t.imageCache.get(e.fileId))==null?void 0:i.mimeType)!==_e.svg},ny=e=>{switch(e.type){case"freedraw":return e.strokeWidth*12;case"text":return e.fontSize/2;case"arrow":return e.endArrowhead||e.endArrowhead?40:20;default:return 20}},kz=(e,t,n,i,s=1)=>{let r=((t==null?void 0:t.opacity)??100)*e.opacity/1e4*s;return(n.has(e.id)||i&&i.some(o=>o.id===e.id)||t&&n.has(t.id))&&(r*=$se/100),r},Kle=(e,t,n)=>{const r=ny(e),[o,a,l,c]=ze(e,t),u=Se(e)||Zi(e)?$i(o,l):e.width,d=Se(e)||Zi(e)?$i(a,c):e.height;let f=u*window.devicePixelRatio+r*2,h=d*window.devicePixelRatio+r*2,m=n.value;return(f*m>32767||h*m>32767)&&(m=Math.min(32767/f,32767/h)),f*h*m*m>16777216&&(m=Math.sqrt(16777216/(f*h))),f=Math.floor(f*m),h=Math.floor(h*m),{width:f,height:h,scale:m}},Rz=(e,t,n,i,s)=>{var b,y;const r=document.createElement("canvas"),o=r.getContext("2d"),a=ny(e),{width:l,height:c,scale:u}=Kle(e,t,n);if(!l||!c)return null;r.width=l,r.height=c;let d=-100,f=0;if(Se(e)||Zi(e)){const[w,v]=ze(e,t);d=e.x>w?$i(e.x,w)*window.devicePixelRatio*u:0,f=e.y>v?$i(e.y,v)*window.devicePixelRatio*u:0,o.translate(d,f)}o.save(),o.translate(a*u,a*u),o.scale(window.devicePixelRatio*u,window.devicePixelRatio*u);const h=nu.canvas(r);Mz(e,i,s)&&(o.filter=Cz),L2(e,h,o,i),o.restore();const m=Re(e,t),p=document.createElement("canvas"),U=p.getContext("2d");if(xe(e)&&m){const[w,v,I,C]=ze(e,t),_=Math.max($i(w,I),$i(v,C));p.width=_*window.devicePixelRatio*u+a*u*10,p.height=_*window.devicePixelRatio*u+a*u*10,U.translate(p.width/2,p.height/2),U.rotate(e.angle),U.drawImage(r,-r.width/2,-r.height/2,r.width,r.height);const[,,,,T,k]=ze(m,t);U.rotate(-e.angle);const S=(p.width-r.width)/2,R=(p.height-r.height)/2,P=p.width/2-(T-w)*window.devicePixelRatio*u-S-a*u,L=p.height/2-(k-v)*window.devicePixelRatio*u-R-a*u;U.translate(-P,-L),U.clearRect(-(m.width/2+Vn)*window.devicePixelRatio*u,-(m.height/2+Vn)*window.devicePixelRatio*u,(m.width+Vn*2)*window.devicePixelRatio*u,(m.height+Vn*2)*window.devicePixelRatio*u)}return{element:e,canvas:r,theme:s.theme,scale:u,zoomValue:n.value,canvasOffsetX:d,canvasOffsetY:f,boundTextElementVersion:((b=Re(e,t))==null?void 0:b.version)||null,containingFrameOpacity:((y=Ss(e,t))==null?void 0:y.opacity)||100,boundTextCanvas:p,angle:e.angle,imageCrop:yt(e)?e.crop:null}},Dz=typeof document<"u"?document.createElement("img"):{src:""};Dz.src=`data:${_e.svg},${encodeURIComponent('<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="image" class="svg-inline--fa fa-image fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="#888" d="M464 448H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h416c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48zM112 120c-30.928 0-56 25.072-56 56s25.072 56 56 56 56-25.072 56-56-25.072-56-56-56zM64 384h384V272l-87.515-87.515c-4.686-4.686-12.284-4.686-16.971 0L208 320l-55.515-55.515c-4.686-4.686-12.284-4.686-16.971 0L64 336v48z"></path></svg>')}`;const Lz=typeof document<"u"?document.createElement("img"):{src:""};Lz.src=`data:${_e.svg},${encodeURIComponent('<svg viewBox="0 0 668 668" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2"><path d="M464 448H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h416c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48ZM112 120c-30.928 0-56 25.072-56 56s25.072 56 56 56 56-25.072 56-56-25.072-56-56-56ZM64 384h384V272l-87.515-87.515c-4.686-4.686-12.284-4.686-16.971 0L208 320l-55.515-55.515c-4.686-4.686-12.284-4.686-16.971 0L64 336v48Z" style="fill:#888;fill-rule:nonzero" transform="matrix(.81709 0 0 .81709 124.825 145.825)"/><path d="M256 8C119.034 8 8 119.033 8 256c0 136.967 111.034 248 248 248s248-111.034 248-248S392.967 8 256 8Zm130.108 117.892c65.448 65.448 70 165.481 20.677 235.637L150.47 105.216c70.204-49.356 170.226-44.735 235.638 20.676ZM125.892 386.108c-65.448-65.448-70-165.481-20.677-235.637L361.53 406.784c-70.203 49.356-170.226 44.736-235.638-20.676Z" style="fill:#888;fill-rule:nonzero" transform="matrix(.30366 0 0 .30366 506.822 60.065)"/></svg>')}`;const Zle=(e,t)=>{t.fillStyle="#E7E7E7",t.fillRect(0,0,e.width,e.height);const n=Math.min(e.width,e.height),i=Math.min(n,Math.min(n*.4,100));t.drawImage(e.status==="error"?Lz:Dz,e.width/2-i/2,e.height/2-i/2,i,i)},L2=(e,t,n,i,s)=>{var r;switch(e.type){case"rectangle":case"iframe":case"embeddable":case"diamond":case"ellipse":{n.lineJoin="round",n.lineCap="round",t.draw(Zt.get(e));break}case"arrow":case"line":{n.lineJoin="round",n.lineCap="round",Zt.get(e).forEach(o=>{t.draw(o)});break}case"freedraw":{n.save(),n.fillStyle=e.strokeColor;const o=Jle(e),a=Zt.get(e);a&&t.draw(a),n.fillStyle=e.strokeColor,n.fill(o),n.restore();break}case"image":{const o=Dn(e)?(r=i.imageCache.get(e.fileId))==null?void 0:r.image:void 0;if(o!=null&&!(o instanceof Promise)){e.roundness&&n.roundRect&&(n.beginPath(),n.roundRect(0,0,e.width,e.height,us(Math.min(e.width,e.height),e)),n.clip());const{x:a,y:l,width:c,height:u}=e.crop?e.crop:{x:0,y:0,width:o.naturalWidth,height:o.naturalHeight};n.drawImage(o,a,l,c,u,0,0,e.width,e.height)}else Zle(e,n);break}default:if(de(e)){const o=IB(e.text),a=o&&!n.canvas.isConnected;a&&document.body.appendChild(n.canvas),n.canvas.setAttribute("dir",o?"rtl":"ltr"),n.save(),n.font=gt(e),n.fillStyle=e.strokeColor,n.textAlign=e.textAlign;const l=e.text.replace(/\r\n?/g,`
`).split(`
`),c=e.textAlign==="center"?e.width/2:e.textAlign==="right"?e.width:0,u=bp(e.fontSize,e.lineHeight),d=hB(e.fontFamily,e.fontSize,u);for(let f=0;f<l.length;f++)n.fillText(l[f],c,f*u+d);n.restore(),a&&n.canvas.remove()}else throw new Error(`Unimplemented type ${e.type}`)}},C4=new WeakMap,ZA=(e,t,n,i)=>{var d;const s=n?i.zoom:{value:1},r=C4.get(e),o=r&&r.zoomValue!==s.value&&!(i!=null&&i.shouldCacheIgnoreZoom),a=Re(e,t),l=(a==null?void 0:a.version)||null,c=yt(e)?e.crop:null,u=((d=Ss(e,t))==null?void 0:d.opacity)||100;if(!r||o||r.theme!==i.theme||r.boundTextElementVersion!==l||r.imageCrop!==c||r.containingFrameOpacity!==u||xe(e)&&a&&e.angle!==r.angle){const f=Rz(e,t,s,n,i);return f?(C4.set(e,f),f):null}return r},N8=(e,t,n,i,s)=>{const r=e.element,o=ny(r),a=e.scale,[l,c,u,d]=ze(r,s),f=((l+u)/2+i.scrollX)*window.devicePixelRatio,h=((c+d)/2+i.scrollY)*window.devicePixelRatio;t.save(),t.scale(1/window.devicePixelRatio,1/window.devicePixelRatio);const m=Re(r,s);if(xe(r)&&m){const p=(e.boundTextCanvas.width-e.canvas.width)/2,U=(e.boundTextCanvas.height-e.canvas.height)/2;t.translate(f,h),t.drawImage(e.boundTextCanvas,-(u-l)/2*window.devicePixelRatio-p/a-o,-(d-c)/2*window.devicePixelRatio-U/a-o,e.boundTextCanvas.width/a,e.boundTextCanvas.height/a)}else t.translate(f,h),t.rotate(r.angle),"scale"in e.element&&!Az(r,n)&&t.scale(e.element.scale[0],e.element.scale[1]),t.translate(-f,-h),t.drawImage(e.canvas,(l+i.scrollX)*window.devicePixelRatio-o*e.scale/e.scale,(c+i.scrollY)*window.devicePixelRatio-o*e.scale/e.scale,e.canvas.width/e.scale,e.canvas.height/e.scale);t.restore()},qle=(e,t,n,i)=>{t.save(),t.translate(e.x+n.scrollX,e.y+n.scrollY),t.fillStyle="rgba(0, 0, 200, 0.04)";const s=.5/n.zoom.value;t.fillRect(s,s,e.width,e.height),t.lineWidth=1/n.zoom.value,t.strokeStyle=i,t.strokeRect(s,s,e.width,e.height),t.restore()},wu=(e,t,n,i,s,r,o)=>{var l;const a=((l=o.openDialog)==null?void 0:l.name)==="elementLinkSelector"&&!o.selectedElementIds[e.id]&&!o.hoveredElementIds[e.id];switch(s.globalAlpha=kz(e,Ss(e,t),r.elementsPendingErasure,r.pendingFlowchartNodes,a?fB:1),e.type){case"magicframe":case"frame":{o.frameRendering.enabled&&o.frameRendering.outline&&(s.save(),s.translate(e.x+o.scrollX,e.y+o.scrollY),s.fillStyle="rgba(0, 0, 200, 0.04)",s.lineWidth=Ft.strokeWidth/o.zoom.value,s.strokeStyle=Ft.strokeColor,R2(e)&&(s.strokeStyle=o.theme===ke.LIGHT?"#7affd7":"#1d8264"),s.roundRect?(s.beginPath(),s.roundRect(0,0,e.width,e.height,Ft.radius/o.zoom.value),s.stroke(),s.closePath()):s.strokeRect(0,0,e.width,e.height),s.restore());break}case"freedraw":{if(Zt.generateElementShape(e,null),r.isExporting){const[c,u,d,f]=ze(e,t),h=(c+d)/2+o.scrollX,m=(u+f)/2+o.scrollY,p=(d-c)/2-(e.x-c),U=(f-u)/2-(e.y-u);s.save(),s.translate(h,m),s.rotate(e.angle),s.translate(-p,-U),L2(e,i,s,r),s.restore()}else{const c=ZA(e,n,r,o);if(!c)return;N8(c,s,r,o,n)}break}case"rectangle":case"diamond":case"ellipse":case"line":case"arrow":case"image":case"text":case"iframe":case"embeddable":{if(Zt.generateElementShape(e,r),r.isExporting){const[c,u,d,f]=ze(e,t),h=(c+d)/2+o.scrollX,m=(u+f)/2+o.scrollY;let p=(d-c)/2-(e.x-c),U=(f-u)/2-(e.y-u);if(de(e)){const y=jn(e,t);if(xe(y)){const w=pe.getBoundTextElementPosition(y,e,t);p=(d-c)/2-(w.x-c),U=(f-u)/2-(w.y-u)}}s.save(),s.translate(h,m),Mz(e,r,o)&&(s.filter="none");const b=Re(e,t);if(xe(e)&&b){const y=document.createElement("canvas"),w=y.getContext("2d"),v=Math.max($i(c,d),$i(u,f)),I=ny(e);y.width=v*o.exportScale+I*10*o.exportScale,y.height=v*o.exportScale+I*10*o.exportScale,w.translate(y.width/2,y.height/2),w.scale(o.exportScale,o.exportScale),p=e.width/2-(e.x-c),U=e.height/2-(e.y-u),w.rotate(e.angle);const C=nu.canvas(y);w.translate(-p,-U),L2(e,C,w,r),w.translate(p,U),w.rotate(-e.angle);const[,,,,_,T]=ze(b,t),k=(c+d)/2-_,S=(u+f)/2-T;w.translate(-k,-S),w.clearRect(-b.width/2,-b.height/2,b.width,b.height),s.scale(1/o.exportScale,1/o.exportScale),s.drawImage(y,-y.width/2,-y.height/2,y.width,y.height)}else s.rotate(e.angle),e.type==="image"&&s.scale(e.scale[0],e.scale[1]),s.translate(-p,-U),L2(e,i,s,r);s.restore()}else{const c=ZA(e,n,r,o);if(!c)return;const u=s.imageSmoothingEnabled;if(!(o!=null&&o.shouldCacheIgnoreZoom)&&(!e.angle||qse(e.angle))&&(s.imageSmoothingEnabled=!1),e.id===o.croppingElementId&&yt(c.element)&&c.element.crop!==null){s.save(),s.globalAlpha=.1;const d=Rz(oae(c.element,t),n,o.zoom,r,o);d&&N8(d,s,r,o,n),s.restore()}N8(c,s,r,o,n),s.imageSmoothingEnabled=u}break}default:throw new Error(`Unimplemented type ${e.type}`)}s.globalAlpha=1},Nz=new WeakMap([]);function Qle(e){const t=Oz(e),n=new Path2D(t);return Nz.set(e,n),n}function Jle(e){return Nz.get(e)}function Oz(e){return nce(Pz(e))}function ece(e,t,n){const i=si({...e,angle:0},n),s=x((i[0]+i[2])/2,(i[1]+i[3])/2);return gn(t.length>=2,"Freepath outline must have at least 2 points"),t.slice(2).reduce((r,o)=>(r.push(Ae(r[r.length-1][1],q(x(o[0]+e.x,o[1]+e.y),s,e.angle))),r),[Ae(q(x(t[0][0]+e.x,t[0][1]+e.y),s,e.angle),q(x(t[1][0]+e.x,t[1][1]+e.y),s,e.angle))])}function Pz(e){const t=e.simulatePressure?e.points:e.points.length?e.points.map(([i,s],r)=>[i,s,e.pressures[r]]):[[0,0,.5]],n={simulatePressure:e.simulatePressure,size:e.strokeWidth*4.25,thinning:.6,smoothing:.5,streamline:.5,easing:i=>Math.sin(i*Math.PI/2),last:!!e.lastCommittedPoint};return iae(t,n)}function qA(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}const tce=/(\s?[A-Z]?,?-?[0-9]*\.[0-9]{0,2})(([0-9]|e|-)*)/g;function nce(e){if(!e.length)return"";const t=e.length-1;return e.reduce((n,i,s,r)=>(s===t?n.push(i,qA(i,r[0]),"L",r[0],"Z"):n.push(i,qA(i,r[s+1])),n),["M",e[0],"Q"]).join(" ").replace(tce,"$1")}const Bc=e=>e==="rectangle"||e==="iframe"||e==="embeddable"||e==="ellipse"||e==="diamond"||e==="line"||e==="freedraw",A4=e=>e==="rectangle"||e==="ellipse"||e==="diamond"||e==="freedraw"||e==="arrow"||e==="line"||e==="text",p6=e=>e==="rectangle"||e==="iframe"||e==="embeddable"||e==="ellipse"||e==="diamond"||e==="freedraw"||e==="arrow"||e==="line",U6=e=>e==="rectangle"||e==="iframe"||e==="embeddable"||e==="ellipse"||e==="diamond"||e==="arrow"||e==="line",um=e=>e==="rectangle"||e==="iframe"||e==="embeddable"||e==="line"||e==="diamond"||e==="image",b6=e=>e==="arrow",y6=e=>e==="arrow",zi=class zi{};F(zi,"rg",new Ph),F(zi,"cache",new WeakMap),F(zi,"get",t=>zi.cache.get(t)),F(zi,"set",(t,n)=>zi.cache.set(t,n)),F(zi,"delete",t=>zi.cache.delete(t)),F(zi,"destroy",()=>{zi.cache=new WeakMap}),F(zi,"generateElementShape",(t,n)=>{const i=n!=null&&n.isExporting?void 0:zi.get(t);if(i!==void 0)return i;C4.delete(t);const s=oce(t,zi.rg,n||{isExporting:!1,canvasBackgroundColor:Ge.white,embedsValidationStatus:null});return zi.cache.set(t,s),s});let Zt=zi;const ice=e=>[8,8+e],Fz=e=>[1.5,6+e];function sce(e){const t=e.roughness,n=Math.max(e.width,e.height),i=Math.min(e.width,e.height);return i>=20&&n>=50||i>=15&&e.roundness&&um(e.type)||Se(e)&&n>=50?t:Math.min(t/(n<10?3:2),2.5)}const Ps=(e,t=!1)=>{const n={seed:e.seed,strokeLineDash:e.strokeStyle==="dashed"?ice(e.strokeWidth):e.strokeStyle==="dotted"?Fz(e.strokeWidth):void 0,disableMultiStroke:e.strokeStyle!=="solid",strokeWidth:e.strokeStyle!=="solid"?e.strokeWidth+.5:e.strokeWidth,fillWeight:e.strokeWidth/2,hachureGap:e.strokeWidth*4,roughness:sce(e),stroke:e.strokeColor,preserveVertices:t||e.roughness<cB.cartoonist};switch(e.type){case"rectangle":case"iframe":case"embeddable":case"diamond":case"ellipse":return n.fillStyle=e.fillStyle,n.fill=ws(e.backgroundColor)?void 0:e.backgroundColor,e.type==="ellipse"&&(n.curveFitting=1),n;case"line":case"freedraw":return qo(e.points)&&(n.fillStyle=e.fillStyle,n.fill=e.backgroundColor==="transparent"?void 0:e.backgroundColor),n;case"arrow":return n;default:throw new Error(`Unimplemented type ${e.type}`)}},QA=(e,t,n)=>pr(e)&&(t||rs(e)&&(n==null?void 0:n.get(e.id))!==!0)&&ws(e.backgroundColor)&&ws(e.strokeColor)?{...e,roughness:0,backgroundColor:"#d3d3d3",fillStyle:"solid"}:jl(e)?{...e,strokeColor:ws(e.strokeColor)?"#000000":e.strokeColor,backgroundColor:ws(e.backgroundColor)?"#f4f4f6":e.backgroundColor}:e,JA=(e,t,n,i,s,r,o)=>{const a=sM(e,t,n,i);if(a===null)return[];const l=(c,u)=>{if(c===null)return[];const[,,d,f,h,m]=c;return[s.line(d,f,h,m,u)]};switch(i){case"dot":case"circle":case"circle_outline":{const[c,u,d]=a;return delete r.strokeLineDash,[s.circle(c,u,d,{...r,fill:i==="circle_outline"?o:e.strokeColor,fillStyle:"solid",stroke:e.strokeColor,roughness:Math.min(.5,r.roughness||0)})]}case"triangle":case"triangle_outline":{const[c,u,d,f,h,m]=a;return delete r.strokeLineDash,[s.polygon([[c,u],[d,f],[h,m],[c,u]],{...r,fill:i==="triangle_outline"?o:e.strokeColor,fillStyle:"solid",roughness:Math.min(1,r.roughness||0)})]}case"diamond":case"diamond_outline":{const[c,u,d,f,h,m,p,U]=a;return delete r.strokeLineDash,[s.polygon([[c,u],[d,f],[h,m],[p,U],[c,u]],{...r,fill:i==="diamond_outline"?o:e.strokeColor,fillStyle:"solid",roughness:Math.min(1,r.roughness||0)})]}case"crowfoot_one":return l(a,r);case"bar":case"arrow":case"crowfoot_many":case"crowfoot_one_or_many":default:{const[c,u,d,f,h,m]=a;if(e.strokeStyle==="dotted"){const p=Fz(e.strokeWidth-1);r.strokeLineDash=[p[0],p[1]-1]}else delete r.strokeLineDash;return r.roughness=Math.min(1,r.roughness||0),[s.line(d,f,c,u,r),s.line(h,m,c,u,r),...i==="crowfoot_one_or_many"?l(sM(e,t,n,"crowfoot_one"),r):[]]}}},rce=e=>{const t=new Ph,n={seed:e.seed,disableMultiStroke:!0,disableMultiStrokeFill:!0,roughness:0,preserveVertices:!0},i=wg(e.points.reduce((s,r)=>[Math.min(e.x+r[0],s[0]),Math.min(e.y+r[1],s[1]),Math.max(e.x+r[0],s[2]),Math.max(e.y+r[1],s[3])],[1/0,1/0,-1/0,-1/0]));switch(e.type){case"line":case"arrow":{const s=e.points.length?e.points:[x(0,0)];return ge(e)?t.path(Bz(s,16),n).sets[0].ops:e.roundness?t.curve(s,n).sets[0].ops.slice(0,e.points.length).map((r,o)=>{if(o===0){const a=q(x(e.x+r.data[0],e.y+r.data[1]),i,e.angle);return{op:"move",data:x(a[0]-e.x,a[1]-e.y)}}return{op:"bcurveTo",data:[q(x(e.x+r.data[0],e.y+r.data[1]),i,e.angle),q(x(e.x+r.data[2],e.y+r.data[3]),i,e.angle),q(x(e.x+r.data[4],e.y+r.data[5]),i,e.angle)].map(a=>x(a[0]-e.x,a[1]-e.y)).flat()}}):s.map((r,o)=>{const a=q(x(e.x+r[0],e.y+r[1]),i,e.angle);return{op:o===0?"move":"lineTo",data:x(a[0]-e.x,a[1]-e.y)}})}case"freedraw":{if(e.points.length<2)return[];const s=$9(e.points,.75);return t.curve(s,n).sets[0].ops.slice(0,e.points.length).map((r,o)=>{if(o===0){const a=q(x(e.x+r.data[0],e.y+r.data[1]),i,e.angle);return{op:"move",data:x(a[0]-e.x,a[1]-e.y)}}return{op:"bcurveTo",data:[q(x(e.x+r.data[0],e.y+r.data[1]),i,e.angle),q(x(e.x+r.data[2],e.y+r.data[3]),i,e.angle),q(x(e.x+r.data[4],e.y+r.data[5]),i,e.angle)].map(a=>x(a[0]-e.x,a[1]-e.y)).flat()}})}}},oce=(e,t,{isExporting:n,canvasBackgroundColor:i,embedsValidationStatus:s})=>{switch(e.type){case"rectangle":case"iframe":case"embeddable":{let r;if(e.roundness){const o=e.width,a=e.height,l=us(Math.min(o,a),e);r=t.path(`M ${l} 0 L ${o-l} 0 Q ${o} 0, ${o} ${l} L ${o} ${a-l} Q ${o} ${a}, ${o-l} ${a} L ${l} ${a} Q 0 ${a}, 0 ${a-l} L 0 ${l} Q 0 0, ${l} 0`,Ps(QA(e,n,s),!0))}else r=t.rectangle(0,0,e.width,e.height,Ps(QA(e,n,s),!1));return r}case"diamond":{let r;const[o,a,l,c,u,d,f,h]=v6(e);if(e.roundness){const m=us(Math.abs(o-f),e),p=us(Math.abs(c-a),e);r=t.path(`M ${o+m} ${a+p} L ${l-m} ${c-p}
            C ${l} ${c}, ${l} ${c}, ${l-m} ${c+p}
            L ${u+m} ${d-p}
            C ${u} ${d}, ${u} ${d}, ${u-m} ${d-p}
            L ${f+m} ${h+p}
            C ${f} ${h}, ${f} ${h}, ${f+m} ${h-p}
            L ${o-m} ${a+p}
            C ${o} ${a}, ${o} ${a}, ${o+m} ${a+p}`,Ps(e,!0))}else r=t.polygon([[o,a],[l,c],[u,d],[f,h]],Ps(e));return r}case"ellipse":return t.ellipse(e.width/2,e.height/2,e.width,e.height,Ps(e));case"line":case"arrow":{let r;const o=Ps(e),a=e.points.length?e.points:[x(0,0)];if(ge(e)?a.every(l=>Math.abs(l[0])<=1e6&&Math.abs(l[1])<=1e6)?r=[t.path(Bz(a,16),Ps(e,!0))]:(console.error("Elbow arrow with extreme point positions detected. Arrow not rendered.",e.id,JSON.stringify(a)),r=[]):e.roundness?r=[t.curve(a,o)]:o.fill?r=[t.polygon(a,o)]:r=[t.linearPath(a,o)],e.type==="arrow"){const{startArrowhead:l=null,endArrowhead:c="arrow"}=e;if(l!==null){const u=JA(e,r,"start",l,t,o,i);r.push(...u)}if(c!==null){const u=JA(e,r,"end",c,t,o,i);r.push(...u)}}return r}case"freedraw":{let r;if(Qle(e),qo(e.points)){const o=$9(e.points,.75);r=t.curve(o,{...Ps(e),stroke:"none"})}else r=null;return r}case"frame":case"magicframe":case"text":case"image":return null;default:return Ko(e,`generateElementShape(): Unimplemented type ${e==null?void 0:e.type}`),null}},Bz=(e,t)=>{const n=[];for(let s=1;s<e.length-1;s+=1){const r=e[s-1],o=e[s+1],a=e[s],l=Ra(a,r),c=Ra(o,a),u=Math.min(t,at(e[s],o)/2,at(e[s],r)/2);l?r[0]<a[0]?n.push([e[s][0]-u,e[s][1]]):n.push([e[s][0]+u,e[s][1]]):r[1]<a[1]?n.push([e[s][0],e[s][1]-u]):n.push([e[s][0],e[s][1]+u]),n.push(e[s]),c?o[0]<a[0]?n.push([e[s][0]-u,e[s][1]]):n.push([e[s][0]+u,e[s][1]]):o[1]<a[1]?n.push([e[s][0],e[s][1]-u]):n.push([e[s][0],e[s][1]+u])}const i=[`M ${e[0][0]} ${e[0][1]}`];for(let s=0;s<n.length;s+=3)i.push(`L ${n[s][0]} ${n[s][1]}`),i.push(`Q ${n[s+1][0]} ${n[s+1][1]}, ${n[s+2][0]} ${n[s+2][1]}`);return i.push(`L ${e[e.length-1][0]} ${e[e.length-1][1]}`),i.join(" ")},ace=(e,t)=>{var n;switch(e.type){case"rectangle":case"diamond":case"frame":case"magicframe":case"embeddable":case"image":case"iframe":case"text":case"selection":return Voe(e);case"arrow":case"line":{const i=((n=Zt.get(e))==null?void 0:n[0])??Zt.generateElementShape(e,null)[0],[,,,,s,r]=ze(e,t);return o6(e)?Yoe(e,i,x(e.x,e.y),e.angle,x(s,r)):Goe(i,x(e.x,e.y),e.angle,x(s,r))}case"ellipse":return $oe(e);case"freedraw":{const[,,,,i,s]=ze(e,t);return joe(e,x(i,s),o6(e))}}},p_=(e,t)=>{const n=[...e.points];if(t){if(!qB(e.points))return null;const s=n[0],r=n[n.length-1];Math.hypot(s[0]-r[0],s[1]-r[1])>Xse||n.length<4?n.push(x(s[0],s[1])):n[n.length-1]=x(s[0],s[1])}return{polygon:t,points:n}},Co=class Co{static getBounds(t,n,i=!1){const s=i&&t.angle!==0?Co.nonRotatedBoundsCache.get(t):Co.boundsCache.get(t);if(s!=null&&s.version&&s.version===t.version&&!zt(t))return s.bounds;if(i&&t.angle!==0){const o=Co.calculateBounds({...t,angle:0},n);return Co.nonRotatedBoundsCache.set(t,{version:t.version,bounds:o}),o}const r=Co.calculateBounds(t,n);return Co.boundsCache.set(t,{version:t.version,bounds:r}),r}static calculateBounds(t,n){let i;const[s,r,o,a,l,c]=ze(t,n);if(Zi(t)){const[u,d,f,h]=b_(t.points.map(([m,p])=>q(x(m,p),x(l-t.x,c-t.y),t.angle)));return[u+t.x,d+t.y,f+t.x,h+t.y]}else if(Se(t))i=gce(t,l,c,n);else if(t.type==="diamond"){const[u,d]=q(x(l,r),x(l,c),t.angle),[f,h]=q(x(l,a),x(l,c),t.angle),[m,p]=q(x(s,c),x(l,c),t.angle),[U,b]=q(x(o,c),x(l,c),t.angle),y=Math.min(u,f,m,U),w=Math.min(d,h,p,b),v=Math.max(u,f,m,U),I=Math.max(d,h,p,b);i=[y,w,v,I]}else if(t.type==="ellipse"){const u=(o-s)/2,d=(a-r)/2,f=Math.cos(t.angle),h=Math.sin(t.angle),m=Math.hypot(u*f,d*h),p=Math.hypot(d*f,u*h);i=[l-m,c-p,l+m,c+p]}else{const[u,d]=q(x(s,r),x(l,c),t.angle),[f,h]=q(x(s,a),x(l,c),t.angle),[m,p]=q(x(o,a),x(l,c),t.angle),[U,b]=q(x(o,r),x(l,c),t.angle),y=Math.min(u,f,m,U),w=Math.min(d,h,p,b),v=Math.max(u,f,m,U),I=Math.max(d,h,p,b);i=[y,w,v,I]}return i}};F(Co,"boundsCache",new WeakMap),F(Co,"nonRotatedBoundsCache",new WeakMap);let M4=Co;const ze=(e,t,n=!1)=>{if(Zi(e))return uce(e);if(Se(e))return pe.getElementAbsoluteCoords(e,t,n);if(de(e)){const i=t?jn(e,t):null;if(xe(i)){const{x:s,y:r}=pe.getBoundTextElementPosition(i,e,t);return[s,r,s+e.width,r+e.height,s+e.width/2,r+e.height/2]}}return[e.x,e.y,e.x+e.width,e.y+e.height,e.x+e.width/2,e.y+e.height/2]},E6=(e,t)=>{const n=ace(e,t),[i,s,r,o,a,l]=ze(e,t),c=x(a,l);if(n.type==="polycurve"){const b=n.data.map(w=>Up(w,10)),y=[];if(tn(e)&&!e.polygon||xe(e))for(const w of b){let v=0;for(;v<w.length-1;)y.push(Ae(x(w[v][0],w[v][1]),x(w[v+1][0],w[v+1][1]))),v++}else{const w=b.flat();let v=0;for(;v<w.length-1;)y.push(Ae(x(w[v][0],w[v][1]),x(w[v+1][0],w[v+1][1]))),v++}return y}else{if(n.type==="polyline")return n.data;if(lce(e)){const[U,b]=j9(e),y=b.map(v=>tM(v,c,e.angle)).flat();return[...eM(U,c,e.angle),...y]}else if(e.type==="diamond"){const[U,b]=Y9(e),y=b.map(v=>tM(v,c,e.angle)).flat();return[...eM(U,c,e.angle),...y]}else if(n.type==="polygon"){if(de(e)){const y=jn(e,t);if(y&&Se(y))return[Ae(x(i,s),x(r,s)),Ae(x(r,s),x(r,o)),Ae(x(r,o),x(i,o)),Ae(x(i,o),x(i,s))]}const U=n.data,b=[];for(let y=0;y<U.length-1;y++)b.push(Ae(U[y],U[y+1]));return b}else if(n.type==="ellipse")return cce(e)}const[u,d,f,h,,,m,p]=[[i,s],[r,s],[i,o],[r,o],[a,s],[a,o],[i,l],[r,l]].map(U=>q(U,c,e.angle));return[Ae(u,d),Ae(f,h),Ae(u,f),Ae(d,h),Ae(u,p),Ae(f,p),Ae(d,m),Ae(h,m)]},lce=e=>e!=null&&(e.type==="rectangle"||e.type==="image"||e.type==="iframe"||e.type==="embeddable"||e.type==="frame"||e.type==="magicframe"||e.type==="text"&&!e.containerId),eM=(e,t,n)=>e.map(i=>Ae(q(i[0],t,n),q(i[1],t,n))),tM=(e,t,n)=>{const i=Up(e,10);let s=0;const r=[];for(;s<i.length-1;)r.push(Ae(q(x(i[s][0],i[s][1]),t,n),q(x(i[s+1][0],i[s+1][1]),t,n))),s++;return r},cce=e=>{const t=x(e.x+e.width/2,e.y+e.height/2),n=e.width/2,i=e.height/2,s=[],r=[],o=90,a=Math.PI*2/o;for(let l=0;l<o;l++){const c=l*a,u=t[0]+n*Math.cos(c),d=t[1]+i*Math.sin(c);r.push(q(x(u,d),t,e.angle))}for(let l=0;l<r.length-1;l++)s.push(Ae(r[l],r[l+1]));return s.push(Ae(r[r.length-1],r[0])),s},v6=e=>{const t=Math.floor(e.width/2)+1,n=0,i=e.width,s=Math.floor(e.height/2)+1,r=t,o=e.height;return[t,n,i,s,r,o,0,s]},nM=(e,t,n,i,s)=>{const r=1-e;return Math.pow(r,3)*t+3*Math.pow(r,2)*e*n+3*r*Math.pow(e,2)*i+Math.pow(e,3)*s},iM=(e,t,n,i)=>{const s=t-e,r=n-t,o=i-n,a=3*s-6*r+3*o,l=6*r-6*s,c=3*s,u=l*l-4*a*c;if(!(u>=0))return!1;let f=null,h=null,m=1/0,p=1/0;return a===0?m=p=-c/l:(m=(-l+Math.sqrt(u))/(2*a),p=(-l-Math.sqrt(u))/(2*a)),m>=0&&m<=1&&(f=nM(m,e,t,n,i)),p>=0&&p<=1&&(h=nM(p,e,t,n,i)),[f,h]},U_=(e,t,n,i)=>{const s=iM(e[0],t[0],n[0],i[0]),r=iM(e[1],t[1],n[1],i[1]);let o=Math.min(e[0],i[0]),a=Math.max(e[0],i[0]);if(s){const u=s.filter(d=>d!==null);o=Math.min(o,...u),a=Math.max(a,...u)}let l=Math.min(e[1],i[1]),c=Math.max(e[1],i[1]);if(r){const u=r.filter(d=>d!==null);l=Math.min(l,...u),c=Math.max(c,...u)}return[o,l,a,c]},iy=(e,t)=>{let n=x(0,0);const{minX:i,minY:s,maxX:r,maxY:o}=e.reduce((a,{op:l,data:c})=>{if(l==="move"){const u=X5(c);gn(u!=null,"Op data is not a point"),n=u}else if(l==="bcurveTo"){const u=x(c[0],c[1]),d=x(c[2],c[3]),f=x(c[4],c[5]),h=t?t(u):u,m=t?t(d):d,p=t?t(f):f,U=t?t(n):n;n=f;const[b,y,w,v]=U_(U,h,m,p);a.minX=Math.min(a.minX,b),a.minY=Math.min(a.minY,y),a.maxX=Math.max(a.maxX,w),a.maxY=Math.max(a.maxY,v)}return a},{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0});return[i,s,r,o]},b_=e=>{let t=1/0,n=1/0,i=-1/0,s=-1/0;for(const[r,o]of e)t=Math.min(t,r),n=Math.min(n,o),i=Math.max(i,r),s=Math.max(s,o);return[t,n,i,s]},uce=e=>{const[t,n,i,s]=b_(e.points),r=t+e.x,o=n+e.y,a=i+e.x,l=s+e.y;return[r,o,a,l,(r+a)/2,(o+l)/2]},dce=e=>{switch(e){case"arrow":return 25;case"diamond":case"diamond_outline":return 12;case"crowfoot_many":case"crowfoot_one":case"crowfoot_one_or_many":return 20;default:return 15}},fce=e=>{switch(e){case"bar":return 90;case"arrow":return 20;default:return 25}},sM=(e,t,n,i)=>{if(t.length<1)return null;const s=Fd(t[0]);if(s.length<1)return null;const r=n==="start"?1:s.length-1,o=s[r].data;gn(o.length===6,"Op data length is not 6");const a=x(o[4],o[5]),l=x(o[2],o[3]),c=x(o[0],o[1]),u=s[r-1];let d=x(0,0);if(u.op==="move"){const G=X5(u.data);gn(G!=null,"Op data is not a point"),d=G}else u.op==="bcurveTo"&&(d=x(u.data[4],u.data[5]));const f=(G,z)=>Math.pow(1-G,3)*a[z]+3*G*Math.pow(1-G,2)*l[z]+3*Math.pow(G,2)*(1-G)*c[z]+d[z]*Math.pow(G,3),[h,m]=n==="start"?d:a,[p,U]=[f(.3,0),f(.3,1)],b=Math.hypot(h-p,m-U),y=(h-p)/b,w=(m-U)/b,v=dce(i);let I=0;{const[G,z]=n==="end"?e.points[e.points.length-1]:e.points[0],[V,$]=e.points.length>1?n==="end"?e.points[e.points.length-2]:e.points[1]:[0,0];I=Math.hypot(G-V,z-$)}const _=Math.min(v,I*(i==="diamond"||i==="diamond_outline"?.25:.5)),T=h-y*_,k=m-w*_;if(i==="dot"||i==="circle"||i==="circle_outline"){const G=Math.hypot(k-m,T-h)+e.strokeWidth-2;return[h,m,G]}const S=fce(i);if(i==="crowfoot_many"||i==="crowfoot_one_or_many"){const[G,z]=q(x(h,m),x(T,k),Ku(-S)),[V,$]=q(x(h,m),x(T,k),Ku(S));return[T,k,G,z,V,$]}const[R,P]=q(x(T,k),x(h,m),-S*Math.PI/180),[L,X]=q(x(T,k),x(h,m),Ku(S));if(i==="diamond"||i==="diamond_outline"){let G,z;if(n==="start"){const[V,$]=e.points.length>1?e.points[1]:[0,0];[G,z]=q(x(h+_*2,m),x(h,m),Math.atan2($-m,V-h))}else{const[V,$]=e.points.length>1?e.points[e.points.length-2]:[0,0];[G,z]=q(x(h-_*2,m),x(h,m),Math.atan2(m-$,h-V))}return[h,m,R,P,G,z,L,X]}return[h,m,R,P,L,X]},hce=e=>{const t=nu.generator(),n=Ps(e),i=e.roundness?"curve":n.fill?"polygon":"linearPath";return t[i](e.points,n)},gce=(e,t,n,i)=>{var d;const s=Re(e,i);if(e.points.length<2){const[f,h]=e.points[0],[m,p]=q(x(e.x+f,e.y+h),x(t,n),e.angle);let U=[m,p,m,p];if(s){const b=pe.getMinMaxXYWithBoundText(e,i,[m,p,m,p],s);U=[b[0],b[1],b[2],b[3]]}return U}const o=((d=Zt.get(e))==null?void 0:d[0])??hce(e),a=Fd(o),c=iy(a,([f,h])=>q(x(e.x+f,e.y+h),x(t,n),e.angle));let u=[c[0],c[1],c[2],c[3]];if(s){const f=pe.getMinMaxXYWithBoundText(e,i,u,s);u=[f[0],f[1],f[2],f[3]]}return u},si=(e,t,n=!1)=>M4.getBounds(e,t,n),ft=(e,t)=>{if(!RB(e))return[0,0,0,0];let n=1/0,i=-1/0,s=1/0,r=-1/0;const o=t||ve(e);return e.forEach(a=>{const[l,c,u,d]=si(a,o);n=Math.min(n,l),s=Math.min(s,c),i=Math.max(i,u),r=Math.max(r,d)}),[n,s,i,r]},y_=(e,t)=>{const[n,i,s,r]=ft(e);return[n+t.x,i+t.y,s+t.x,r+t.y]},dm=(e,t,n,i)=>{if(!(Se(e)||Zi(e)))return[e.x,e.y,e.x+t,e.y+n];const s=Qb(0,t,Qb(1,n,e.points,i),i);let r;if(Zi(e))r=b_(s);else{const u=nu.generator(),d=e.roundness?u.curve(s,Ps(e)):u.linearPath(s,Ps(e)),f=Fd(d);r=iy(f)}const[o,a,l,c]=r;return[o+e.x,a+e.y,l+e.x,c+e.y]},rM=(e,t)=>{const n=nu.generator(),i=e.roundness==null?n.linearPath(t,Ps(e)):n.curve(t,Ps(e)),s=Fd(i),[r,o,a,l]=iy(s);return[r+e.x,o+e.y,a+e.x,l+e.y]},mce=(e,t)=>{if(!e.length)return[0,0,0,0];let n=1/0,i=e[0];const s=ve(e);return e.forEach(r=>{const[o,a,l,c]=si(r,s),u=at(x((o+l)/2,(a+c)/2),x(t.x,t.y));u<n&&(n=u,i=r)}),si(i,s)},Sr=e=>{const[t,n,i,s]=ft(e);return{minX:t,minY:n,maxX:i,maxY:s,width:i-t,height:s-n,midX:(t+i)/2,midY:(n+s)/2}},zz=({scrollX:e,scrollY:t,width:n,height:i,zoom:s})=>[-e,-t,-e+n/s.value,-t+i/s.value],wg=e=>x(e[0]+(e[2]-e[0])/2,e[1]+(e[3]-e[1])/2),wa=(e,t,n)=>{const i={minX:e.x,minY:e.y,maxX:e.x+e.width,maxY:e.y+e.height,midX:e.x+e.width/2,midY:e.y+e.height/2},s=ri(e,t),[r,o]=q(x(i.minX,i.minY),s,e.angle),[a,l]=q(x(i.maxX,i.minY),s,e.angle),[c,u]=q(x(i.maxX,i.maxY),s,e.angle),[d,f]=q(x(i.minX,i.maxY),s,e.angle),h=[Math.min(r,a,c,d),Math.min(o,l,u,f),Math.max(r,a,c,d),Math.max(o,l,u,f)];if(n){const[m,p,U,b]=n;return[h[0]-b,h[1]-m,h[2]+p,h[3]+U]}return h},fm=(e,t)=>e[0]>t[0]&&e[0]<t[2]&&e[1]>t[1]&&e[1]<t[3],zd=(e,t)=>{if(e==null||t==null)return!1;const[n,i,s,r]=e,[o,a,l,c]=t;return n<l&&s>o&&i<c&&r>a},ri=(e,t,n=0,i=0)=>{const[s,r]=wg(si(e,t));return x(s+n,r+i)},pce=.1,qa=e=>Se(e)||Zi(e)?e.points.length<2||e.points.length===2&&xe(e)&&kr(e.points[0],e.points[e.points.length-1],pce):e.width===0&&e.height===0,w6=(e,t,n,i,s)=>{const[r,o,a,l]=si(e,s),c=Dt({clientX:i.offsetLeft,clientY:i.offsetTop},i),u=Dt({clientX:i.offsetLeft+t,clientY:i.offsetTop+n},i);return c.x<=a&&c.y<=l&&u.x>=r&&u.y>=o},N2=(e,t,n,i,s,r)=>{const[o,a,l,c]=ft(e,s),u=Dt({clientX:i.offsetLeft+((r==null?void 0:r.left)||0),clientY:i.offsetTop+((r==null?void 0:r.top)||0)},i),d=Dt({clientX:i.offsetLeft+t-((r==null?void 0:r.right)||0),clientY:i.offsetTop+n-((r==null?void 0:r.bottom)||0)},i);return o>=u.x&&a>=u.y&&l<=d.x&&c<=d.y},oM=(e,t,n)=>{const i=Math.abs(t),s=Math.abs(n);if(e==="line"||e==="arrow"||e==="freedraw"){const r=Math.round(Math.atan(s/i)/Fs)*Fs;r===0?n=0:r===Math.PI/2?t=0:n=i*Math.tan(r)*Math.sign(n)||n}else e!=="selection"&&(n=i*Math.sign(n));return{width:t,height:n}},k4=(e,t,n,i,s)=>{let r=n-e,o=i-t;const a=Math.atan2(o,r);let l=Math.round(a/Fs)*Fs;if(s){const c=Math.floor(s/Fs)*Fs;Qse(a,c,c+Fs)&&(Jse(a,s)<Fs/6?l=s:eo(a)>eo(s)?l=c+Fs:l=c)}if(l===0)o=0;else if(l===Math.PI/2)r=0;else{const c=Math.tan(l),u=-1,d=t-c*e,f=-1/c,h=-1,m=i-f*n,p=(u*m-h*d)/(c*h-f*u),U=(d*f-m*c)/(c*h-f*u);r=p-e,o=U-t}return{width:r,height:o}},Hz=e=>{const t={width:e.width,height:e.height,x:e.x,y:e.y};if(e.width<0){const n=Math.abs(e.width);t.width=n,t.x=e.x-n}if(e.height<0){const n=Math.abs(e.height);t.height=n,t.y=e.y-n}return t},Uce=(e,t,n,i)=>{const s=Q5(e,n.getNonDeletedElementsMap(),i),r=Sr(e);return s.flatMap(o=>{const a=bce(o,r,t);return o.map(l=>{const c=n.mutateElement(l,{x:l.x+a.x,y:l.y+a.y});return Is(l,n,{simultaneouslyUpdated:o}),c})})},bce=(e,t,{axis:n,position:i})=>{const s=Sr(e),[r,o]=n==="x"?["minX","maxX"]:["minY","maxY"],a={x:0,y:0};return i==="start"?{...a,[n]:t[r]-s[r]}:i==="end"?{...a,[n]:t[o]-s[o]}:{...a,[n]:(t[r]+t[o])/2-(s[r]+s[o])/2}},yce=e=>{const t=e.slice(),n=new Set,i=r=>{var c,u,d;const o=(u=(c=r[0])==null?void 0:c.groupIds)==null?void 0:u.join(""),a=[r[0]],l=[];for(const f of r.slice(1))((d=f.groupIds)==null?void 0:d.join(""))===o?a.push(f):l.push(f);return l.length?[...a,...i(l)]:a},s=new Map;return t.forEach((r,o)=>{var a;if(!s.has(r.id))if((a=r.groupIds)!=null&&a.length){const l=r.groupIds[r.groupIds.length-1],c=t.slice(o).filter(u=>{var f;const d=(f=u==null?void 0:u.groupIds)==null?void 0:f.some(h=>h===l);return d&&s.set(u.id,!0),d});for(const u of i(c))n.add(u)}else n.add(r)}),n.size!==e.length?(console.error("normalizeGroupElementOrder: lost some elements... bailing!"),e):[...n]},Ece=e=>{const t=xre(e),n=e.slice(),i=new Set;return n.forEach((s,r)=>{var o,a;if(s)if((o=s.boundElements)!=null&&o.length)i.add(s),n[r]=null,s.boundElements.forEach(l=>{const c=t.get(l.id);c&&l.type==="text"&&(i.add(c[0]),n[c[1]]=null)});else if(s.type==="text"&&s.containerId){const l=t.get(s.containerId);(a=l==null?void 0:l[0].boundElements)!=null&&a.find(c=>c.id===s.id)||(i.add(s),n[r]=null)}else i.add(s),n[r]=null}),i.size!==e.length?(console.error("normalizeBoundElementsOrder: lost some elements... bailing!"),e):[...i]},vce=e=>Ece(yce(e)),wce=(e,t,n,i)=>{const s=zc(n);return s.id=fs(),s.updated=bg(),i&&(s.seed=Rr(),Da(s)),s.groupIds=zle(s.groupIds,e,r=>(t.has(r)||t.set(r,fs()),t.get(r))),s},E0=e=>{let{elements:t}=e;const n="appState"in e?e.appState:{editingGroupId:null,selectedGroupIds:{}},i=new Map,s=new Map,r=[],o=[],a=new Map,l=new Map,c=new Map,u=ve(t),d=e.type==="in-place"?e.idsOfElementsToDuplicate:new Map(t.map(U=>[U.id,U]));if(e.type==="in-place")for(const U of Object.keys(e.appState.selectedGroupIds))t.filter(b=>{var y;return(y=b.groupIds)==null?void 0:y.includes(U)}).forEach(b=>d.set(b.id,b));t=vce(t);const f=t.slice(),h=U=>{const y=_8(U).reduce((w,v)=>{if(i.has(v.id))return w;i.set(v.id,!0);const I=wce(n.editingGroupId,s,v,e.randomizeSeed);return i.set(I.id,!0),c.set(I.id,I),a.set(v.id,I.id),l.set(I.id,v),o.push(v),r.push(I),w.push(I),w},[]);return Array.isArray(U)?y:y[0]||null},m=(U,b)=>{if(b){if(U>f.length-1){f.push(..._8(b));return}f.splice(U+1,0,..._8(b))}},p=new Set(t.filter(U=>d.has(U.id)&&Ee(U)).map(U=>U.id));for(const U of t){if(i.has(U.id)||!d.has(U.id))continue;const b=yz(n,U);if(b){const y=Ct(t,b).flatMap(v=>Ee(v)?[...Js(t,v.id),v]:[v]),w=Su(f,v=>{var I;return(I=v.groupIds)==null?void 0:I.includes(b)});m(w,h(y));continue}if(!(U.frameId&&p.has(U.frameId))){if(Ee(U)){const y=U.id,w=Js(t,y),v=Su(f,I=>I.frameId===y||I.id===y);m(v,h([...w,U]));continue}if(Di(U)){const y=Re(U,u),w=Su(f,v=>v.id===U.id||"containerId"in v&&v.containerId===U.id);y?m(w,h([U,y])):m(w,h(U));continue}if(zt(U)){const y=jn(U,u),w=Su(f,v=>v.id===U.id||v.id===(y==null?void 0:y.id));y?m(w,h([y,U])):m(w,h(U));continue}m(Su(f,y=>y.id===U.id),h(U))}}if(vle(r,a,c),Vle(f,o,a),e.overrides)for(const U of r){const b=l.get(U.id);b&&Object.assign(U,e.overrides({duplicateElement:U,origElement:b,origIdToDuplicateId:a}))}return{duplicatedElements:r,duplicateElementsMap:c,elementsWithDuplicates:f,origIdToDuplicateId:a}},R4=(e,t=0)=>{if(e==null||typeof e!="object")return e;if(Object.prototype.toString.call(e)==="[object Object]"){const i=typeof e.constructor=="function"?Object.create(Object.getPrototypeOf(e)):{};for(const s in e)if(e.hasOwnProperty(s)){if(t===0&&(s==="shape"||s==="canvas"))continue;i[s]=R4(e[s],t+1)}return i}if(Array.isArray(e)){let i=e.length;const s=new Array(i);for(;i--;)s[i]=R4(e[i],t+1);return s}return e},zc=e=>R4(e),K={IMMEDIATELY:"IMMEDIATELY",NEVER:"NEVER",EVENTUALLY:"EVENTUALLY"};class _ce{constructor(t){F(this,"onDurableIncrementEmitter",new $r);F(this,"onStoreIncrementEmitter",new $r);F(this,"scheduledMacroActions",new Set);F(this,"scheduledMicroActions",[]);F(this,"_snapshot",Fo.empty());this.app=t}get snapshot(){return this._snapshot}set snapshot(t){this._snapshot=t}scheduleAction(t){this.scheduledMacroActions.add(t),this.satisfiesScheduledActionsInvariant()}scheduleCapture(){this.scheduleAction(K.IMMEDIATELY)}scheduleMicroAction(t){const{action:n}=t;let i;if("change"in t)i=t.change;else{const r=Fo.create(this.app.scene.getElementsMapIncludingDeleted(),this.app.state),o=r.maybeClone(n,t.elements?Ace(t.elements):void 0,t.appState);i=ah.create(r,o)}const s="delta"in t?t.delta:void 0;this.scheduledMicroActions.push(()=>this.processAction({action:n,change:i,delta:s}))}commit(t,n){this.flushMicroActions();try{const i=this.getScheduledMacroAction();this.processAction({action:i,elements:t,appState:n})}finally{this.satisfiesScheduledActionsInvariant(),this.scheduledMacroActions=new Set}}clear(){this.snapshot=Fo.empty(),this.scheduledMacroActions=new Set}emitDurableIncrement(t,n=void 0,i=void 0){const s=this.snapshot;let r,o;if(n?r=n:r=ah.create(s,t),i?o=i:o=md.calculate(s,t),!o.isEmpty()){const a=new Tce(r,o);this.onDurableIncrementEmitter.trigger(a),this.onStoreIncrementEmitter.trigger(a)}}emitEphemeralIncrement(t,n=void 0){let i;if(n)i=n;else{const r=this.snapshot;i=ah.create(r,t)}const s=new Ice(i);this.onStoreIncrementEmitter.trigger(s)}applyChangeToSnapshot(t){const n=this.snapshot,i=this.snapshot.applyChange(t);return n===i?null:i}maybeCloneSnapshot(t,n,i){if(!n&&!i)return null;const s=this.snapshot,r=this.snapshot.maybeClone(t,n,i);return s===r?null:r}flushMicroActions(){for(const t of this.scheduledMicroActions)try{t()}catch(n){console.error("Failed to execute scheduled micro action",n)}this.scheduledMicroActions=[]}processAction(t){const{action:n}=t;if(n===K.EVENTUALLY&&!this.onStoreIncrementEmitter.subscribers.length)return;let i;if("change"in t?i=this.applyChangeToSnapshot(t.change):i=this.maybeCloneSnapshot(n,t.elements,t.appState),!i)return;const s="change"in t?t.change:void 0,r="delta"in t?t.delta:void 0;try{switch(n){case K.IMMEDIATELY:this.emitDurableIncrement(i,s,r);break;case K.NEVER:case K.EVENTUALLY:this.emitEphemeralIncrement(i,s);break;default:Ko(n,"Unknown store action")}}finally{switch(n){case K.IMMEDIATELY:case K.NEVER:this.snapshot=i;break}}}getScheduledMacroAction(){let t;return this.scheduledMacroActions.has(K.IMMEDIATELY)?t=K.IMMEDIATELY:this.scheduledMacroActions.has(K.NEVER)?t=K.NEVER:t=K.EVENTUALLY,t}satisfiesScheduledActionsInvariant(){if(!(this.scheduledMacroActions.size>=0&&this.scheduledMacroActions.size<=Object.keys(K).length)){const t=`There can be at most three store actions scheduled at the same time, but there are "${this.scheduledMacroActions.size}".`;console.error(t,this.scheduledMacroActions.values())}}}class ah{constructor(t,n){this.elements=t,this.appState=n}static create(t,n){const i=n.getChangedElements(t),s=n.getChangedAppState(t);return new ah(i,s)}}class Vz{constructor(t,n){this.type=t,this.change=n}static isDurable(t){return t.type==="durable"}static isEphemeral(t){return t.type==="ephemeral"}}class Tce extends Vz{constructor(t,n){super("durable",t),this.change=t,this.delta=n}}class Ice extends Vz{constructor(t){super("ephemeral",t),this.change=t}}class md{constructor(t,n,i){this.id=t,this.elements=n,this.appState=i}static create(t,n,i={id:fs()}){return new this(i.id,t,n)}static calculate(t,n){const i=n.metadata.didElementsChange?xu.calculate(t.elements,n.elements):xu.empty(),s=n.metadata.didAppStateChange?An.calculate(t.appState,n.appState):An.empty();return this.create(i,s)}static restore(t){const{id:n,elements:i,appState:s}=t;return new this(n,xu.restore(i),An.restore(s))}static load({id:t,elements:{added:n,removed:i,updated:s},appState:{delta:r}}){const o=xu.create(n,i,s),a=An.create(r);return new this(t,o,a)}static squash(...t){const n=md.empty();for(const i of t)n.elements.squash(i.elements),n.appState.squash(i.appState);return n}static inverse(t){return this.create(t.elements.inverse(),t.appState.inverse())}static applyTo(t,n,i,s){const[r,o]=t.elements.applyTo(n,Fo.empty().elements,s),[a,l]=t.appState.applyTo(i,r);return[r,a,o||l]}static applyLatestChanges(t,n,i,s){return this.create(t.elements.applyLatestChanges(n,i,s),t.appState,{id:t.id})}static empty(){return md.create(xu.empty(),An.empty())}isEmpty(){return this.elements.isEmpty()&&this.appState.isEmpty()}}class Fo{constructor(t,n,i={didElementsChange:!1,didAppStateChange:!1,isEmpty:!1}){F(this,"_lastChangedElementsHash",0);F(this,"_lastChangedAppStateHash",0);this.elements=t,this.appState=n,this.metadata=i}static create(t,n,i={didElementsChange:!1,didAppStateChange:!1}){return new Fo(t,aM(n)?n:lh(n),i)}static empty(){return new Fo(new Map,Sce(),{didElementsChange:!1,didAppStateChange:!1,isEmpty:!0})}getChangedElements(t){const n={};for(const i of Xl(t.elements))this.elements.get(i.id)||(n[i.id]=Te(i,{isDeleted:!0}));for(const i of Xl(this.elements))t.elements.get(i.id)!==i&&(n[i.id]=i);return n}getChangedAppState(t){return De.getRightDifferences(t.appState,this.appState).reduce((n,i)=>Object.assign(n,{[i]:this.appState[i]}),{})}isEmpty(){return this.metadata.isEmpty}applyChange(t){const n=new Map(this.elements);for(const[s,r]of Object.entries(t.elements))n.set(s,r);const i=lh({...this.appState,...t.appState});return Fo.create(n,i,{didElementsChange:Object.keys(t.elements).length>0,didAppStateChange:Object.keys(t.appState).length>0})}maybeClone(t,n,i){const s={shouldCompareHashes:!1};t===K.EVENTUALLY&&(s.shouldCompareHashes=!0);const r=this.maybeCreateElementsSnapshot(n,s),o=this.maybeCreateAppStateSnapshot(i,s);let a=!1,l=!1;return this.elements!==r&&(a=!0),this.appState!==o&&(l=!0),!a&&!l?this:new Fo(r,o,{didElementsChange:a,didAppStateChange:l})}maybeCreateAppStateSnapshot(t,n={shouldCompareHashes:!1}){if(!t)return this.appState;const i=aM(t)?t:lh(t);return this.detectChangedAppState(i,n)?i:this.appState}maybeCreateElementsSnapshot(t,n={shouldCompareHashes:!1}){if(!t)return this.elements;const i=this.detectChangedElements(t,n);return i!=null&&i.size?this.createElementsSnapshot(i):this.elements}detectChangedAppState(t,n={shouldCompareHashes:!1}){if(this.appState===t)return;const i=De.isRightDifferent(this.appState,t);if(!i)return;const s=C_(JSON.stringify(t));if(!(n.shouldCompareHashes&&this._lastChangedAppStateHash===s))return this._lastChangedAppStateHash=s,i}detectChangedElements(t,n={shouldCompareHashes:!1}){if(this.elements===t)return;const i=new Map;for(const r of Xl(this.elements))t.get(r.id)||i.set(r.id,Te(r,{isDeleted:!0}));for(const r of Xl(t)){const o=this.elements.get(r.id);if(!o||o.version<r.version){if(yt(r)&&!Dn(r))continue;i.set(r.id,r)}}if(!i.size)return;const s=gH(i);if(!(n.shouldCompareHashes&&this._lastChangedElementsHash===s))return this._lastChangedElementsHash=s,i}createElementsSnapshot(t){const n=new Map;for(const i of Xl(this.elements))n.set(i.id,i);for(const i of Xl(t))n.set(i.id,zc(i));return n}}const $z="__observedAppState",Sce=()=>({name:null,editingGroupId:null,viewBackgroundColor:Ge.white,selectedElementIds:{},selectedGroupIds:{},selectedLinearElement:null,croppingElementId:null,activeLockedId:null,lockedMultiSelections:{}}),lh=e=>{const t={name:e.name,editingGroupId:e.editingGroupId,viewBackgroundColor:e.viewBackgroundColor,selectedElementIds:e.selectedElementIds,selectedGroupIds:e.selectedGroupIds,croppingElementId:e.croppingElementId,activeLockedId:e.activeLockedId,lockedMultiSelections:e.lockedMultiSelections,selectedLinearElement:e.selectedLinearElement?{elementId:e.selectedLinearElement.elementId,isEditing:!!e.selectedLinearElement.isEditing}:null};return Reflect.defineProperty(t,$z,{value:!0,enumerable:!1}),t},aM=e=>!!Reflect.get(e,$z),Gz="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function Xf(e,t,n){const i=n[0];if(t!=null&&e>=t)throw new Error(e+" >= "+t);if(e.slice(-1)===i||t&&t.slice(-1)===i)throw new Error("trailing zero");if(t){let o=0;for(;(e[o]||i)===t[o];)o++;if(o>0)return t.slice(0,o)+Xf(e.slice(o),t.slice(o),n)}const s=e?n.indexOf(e[0]):0,r=t!=null?n.indexOf(t[0]):n.length;if(r-s>1){const o=Math.round(.5*(s+r));return n[o]}else return t&&t.length>1?t.slice(0,1):n[s]+Xf(e.slice(1),null,n)}function Xz(e){if(e.length!==jz(e[0]))throw new Error("invalid integer part of order key: "+e)}function jz(e){if(e>="a"&&e<="z")return e.charCodeAt(0)-97+2;if(e>="A"&&e<="Z")return 90-e.charCodeAt(0)+2;throw new Error("invalid order key head: "+e)}function P1(e){const t=jz(e[0]);if(t>e.length)throw new Error("invalid order key: "+e);return e.slice(0,t)}function lM(e,t){if(e==="A"+t[0].repeat(26))throw new Error("invalid order key: "+e);const n=P1(e);if(e.slice(n.length).slice(-1)===t[0])throw new Error("invalid order key: "+e)}function cM(e,t){Xz(e);const[n,...i]=e.split("");let s=!0;for(let r=i.length-1;s&&r>=0;r--){const o=t.indexOf(i[r])+1;o===t.length?i[r]=t[0]:(i[r]=t[o],s=!1)}if(s){if(n==="Z")return"a"+t[0];if(n==="z")return null;const r=String.fromCharCode(n.charCodeAt(0)+1);return r>"a"?i.push(t[0]):i.pop(),r+i.join("")}else return n+i.join("")}function xce(e,t){Xz(e);const[n,...i]=e.split("");let s=!0;for(let r=i.length-1;s&&r>=0;r--){const o=t.indexOf(i[r])-1;o===-1?i[r]=t.slice(-1):(i[r]=t[o],s=!1)}if(s){if(n==="a")return"Z"+t.slice(-1);if(n==="A")return null;const r=String.fromCharCode(n.charCodeAt(0)-1);return r<"Z"?i.push(t.slice(-1)):i.pop(),r+i.join("")}else return n+i.join("")}function sf(e,t,n=Gz){if(e!=null&&lM(e,n),t!=null&&lM(t,n),e!=null&&t!=null&&e>=t)throw new Error(e+" >= "+t);if(e==null){if(t==null)return"a"+n[0];const l=P1(t),c=t.slice(l.length);if(l==="A"+n[0].repeat(26))return l+Xf("",c,n);if(l<t)return l;const u=xce(l,n);if(u==null)throw new Error("cannot decrement any more");return u}if(t==null){const l=P1(e),c=e.slice(l.length),u=cM(l,n);return u??l+Xf(c,null,n)}const i=P1(e),s=e.slice(i.length),r=P1(t),o=t.slice(r.length);if(i===r)return i+Xf(s,o,n);const a=cM(i,n);if(a==null)throw new Error("cannot increment any more");return a<t?a:i+Xf(s,null,n)}function D4(e,t,n,i=Gz){if(n===0)return[];if(n===1)return[sf(e,t,i)];if(t==null){let o=sf(e,t,i);const a=[o];for(let l=0;l<n-1;l++)o=sf(o,t,i),a.push(o);return a}if(e==null){let o=sf(e,t,i);const a=[o];for(let l=0;l<n-1;l++)o=sf(e,o,i),a.push(o);return a.reverse(),a}const s=Math.floor(n/2),r=sf(e,t,i);return[...D4(e,r,s,i),r,...D4(r,t,n-s-1,i)]}class Cce extends Error{constructor(){super(...arguments);F(this,"code","ELEMENT_HAS_INVALID_INDEX")}}const E_=(e,{shouldThrow:t=!1,includeBoundTextValidation:n=!1,ignoreLogs:i,reconciliationContext:s})=>{const r=[],o=l=>`${l==null?void 0:l.index}:${l==null?void 0:l.id}:${l==null?void 0:l.type}:${l==null?void 0:l.isDeleted}:${l==null?void 0:l.version}:${l==null?void 0:l.versionNonce}`,a=e.map(l=>l.index);for(const[l,c]of a.entries()){const u=a[l-1],d=a[l+1];if(L4(c,u,d)||r.push(`Fractional indices invariant has been compromised: "${o(e[l-1])}", "${o(e[l])}", "${o(e[l+1])}"`),n&&Di(e[l])){const f=e[l],h=Re(f,ve(e));h&&h.index<=f.index&&r.push(`Fractional indices invariant for bound elements has been compromised: "${o(h)}", "${o(f)}"`)}}if(r.length){const l=new Cce,c=[];if(s&&(c.push("Additional reconciliation context:"),c.push(s.localElements.map(u=>o(u))),c.push(s.remoteElements.map(u=>o(u)))),i||console.error(r.join(`

`),l.stack,e.map(u=>o(u)),...c),t)throw l}},v_=e=>e.sort((t,n)=>uM(t)&&uM(n)?t.index<n.index?-1:t.index>n.index?1:t.id<n.id?-1:1:1),oo=(e,t)=>{try{const n=ve(e),i=Mce(e,t),s=w_(e,i),r=e.map(o=>{const a=s.get(o);return a?{...o,index:a.index}:o});E_(r,{includeBoundTextValidation:!1,shouldThrow:!0,ignoreLogs:!0});for(const[o,{index:a}]of s)vi(o,n,{index:a})}catch{ru(e)}return e},ru=e=>{const t=ve(e),n=Yz(e),i=w_(e,n);for(const[s,{index:r}]of i)vi(s,t,{index:r});return e},Ace=e=>{const t=ve(e),n=Yz(e),i=w_(e,n);for(const[s,{index:r}]of i)t.set(s.id,Te(s,{index:r}));return t},Mce=(e,t)=>{const n=[];let i=0;for(;i<e.length;)if(t.has(e[i].id)){const s=[i-1,i];for(;++i<e.length&&t.has(e[i].id);)s.push(i);s.push(i),n.push(s)}else i++;return n},Yz=e=>{const t=[];let n,i,s=-1,r=0;const o=c=>{var f;const u=e[s]?e[s].index:void 0,d=(f=e[c-1])==null?void 0:f.index;return!u&&d||u&&d&&d>u?[d,c-1]:[u,s]},a=c=>{var f;const u=e[r]?e[r].index:void 0;if(u&&c<r)return[u,r];let d=r;for(;++d<e.length;){const h=(f=e[d])==null?void 0:f.index;if(!u&&h||u&&h&&h>u)return[h,d]}return[void 0,d]};let l=0;for(;l<e.length;){const c=e[l].index;if([n,s]=o(l),[i,r]=a(l),L4(c,n,i))l++;else{const u=[s,l];for(;++l<e.length;){const d=e[l].index,[f,h]=o(l),[m,p]=a(l);if(L4(d,f,m))break;[n,s]=[f,h],[i,r]=[m,p],u.push(l)}u.push(r),t.push(u)}}return t},L4=(e,t,n)=>e?t&&n?t<e&&e<n:!t&&n?e<n:t&&!n?t<e:!!e:!1,w_=(e,t)=>{var i,s;const n=new Map;for(const r of t){const o=r.shift(),a=r.pop(),l=D4((i=e[o])==null?void 0:i.index,(s=e[a])==null?void 0:s.index,r.length);for(let c=0;c<r.length;c++){const u=e[r[c]];n.set(u,{index:l[c]})}}return n},uM=e=>!!e.index,dM=e=>{const t=new Map,n=[];for(const i of e)i.isDeleted||(n.push(i),t.set(i.id,i));return{elementsMap:t,elements:n}},kce=Oo(e=>{window!=null&&window.DEBUG_FRACTIONAL_INDICES&&E_(e,{shouldThrow:Mre(),includeBoundTextValidation:!0})},1e3*60,{leading:!0,trailing:!1}),Rce=e=>{const t=["includeBoundTextElement","includeElementsInFrames"];let n="";for(const i of t)n+=`${i}:${e[i]?"1":"0"}`;return n};class _6{constructor(t=null,n){F(this,"callbacks",new Set);F(this,"nonDeletedElements",[]);F(this,"nonDeletedElementsMap",Zo(new Map));F(this,"elements",[]);F(this,"nonDeletedFramesLikes",[]);F(this,"frames",[]);F(this,"elementsMap",Zo(new Map));F(this,"selectedElementsCache",{selectedElementIds:null,elements:null,cache:new Map});F(this,"sceneNonce");F(this,"insertElement",t=>{const n=t.frameId?this.getElementIndex(t.frameId):this.elements.length;this.insertElementAtIndex(t,n)});F(this,"insertElements",t=>{var i;if(!t.length)return;const n=(i=t[0])!=null&&i.frameId?this.getElementIndex(t[0].frameId):this.elements.length;this.insertElementsAtIndex(t,n)});F(this,"getContainerElement",t=>t&&t.containerId&&this.getElement(t.containerId)||null);F(this,"getElementsFromId",t=>{const n=this.getNonDeletedElementsMap(),i=n.get(t);return i?[i]:Ct(n,t)});t&&this.replaceAllElements(t,n)}getSceneNonce(){return this.sceneNonce}getNonDeletedElementsMap(){return this.nonDeletedElementsMap}getElementsIncludingDeleted(){return this.elements}getElementsMapIncludingDeleted(){return this.elementsMap}getNonDeletedElements(){return this.nonDeletedElements}getFramesIncludingDeleted(){return this.frames}getSelectedElements(t){const n=Rce(t),i=(t==null?void 0:t.elements)||this.nonDeletedElements;if(this.selectedElementsCache.elements===i&&this.selectedElementsCache.selectedElementIds===t.selectedElementIds){const r=this.selectedElementsCache.cache.get(n);if(r)return r}else(t==null?void 0:t.elements)==null&&this.selectedElementsCache.cache.clear();const s=Ve(i,{selectedElementIds:t.selectedElementIds},t);return(t==null?void 0:t.elements)==null&&(this.selectedElementsCache.selectedElementIds=t.selectedElementIds,this.selectedElementsCache.elements=this.nonDeletedElements,this.selectedElementsCache.cache.set(n,s)),s}getNonDeletedFramesLikes(){return this.nonDeletedFramesLikes}getElement(t){return this.elementsMap.get(t)||null}getNonDeletedElement(t){const n=this.getElement(t);return n&&$4(n)?n:null}mapElements(t){let n=!1;const i=this.elements.map(s=>{const r=t(s);return r!==s&&(n=!0),r});return n&&this.replaceAllElements(i),n}replaceAllElements(t,n){const i=Are(t),s=[];n!=null&&n.skipValidation||kce(i),this.elements=ru(i),this.elementsMap.clear(),this.elements.forEach(o=>{Ee(o)&&s.push(o),this.elementsMap.set(o.id,o)});const r=dM(this.elements);this.nonDeletedElements=r.elements,this.nonDeletedElementsMap=r.elementsMap,this.frames=s,this.nonDeletedFramesLikes=dM(this.frames).elements,this.triggerUpdate()}triggerUpdate(){this.sceneNonce=Rr();for(const t of Array.from(this.callbacks))t()}onUpdate(t){if(this.callbacks.has(t))throw new Error;return this.callbacks.add(t),()=>{if(!this.callbacks.has(t))throw new Error;this.callbacks.delete(t)}}destroy(){this.elements=[],this.nonDeletedElements=[],this.nonDeletedFramesLikes=[],this.frames=[],this.elementsMap.clear(),this.selectedElementsCache.selectedElementIds=null,this.selectedElementsCache.elements=null,this.selectedElementsCache.cache.clear(),this.callbacks.clear()}insertElementAtIndex(t,n){if(!Number.isFinite(n)||n<0)throw new Error("insertElementAtIndex can only be called with index >= 0");const i=[...this.elements.slice(0,n),t,...this.elements.slice(n)];oo(i,ve([t])),this.replaceAllElements(i)}insertElementsAtIndex(t,n){if(!t.length)return;if(!Number.isFinite(n)||n<0)throw new Error("insertElementAtIndex can only be called with index >= 0");const i=[...this.elements.slice(0,n),...t,...this.elements.slice(n)];oo(i,ve(t)),this.replaceAllElements(i)}getElementIndex(t){return this.elements.findIndex(n=>n.id===t)}mutateElement(t,n,i={informMutation:!0,isDragging:!1}){const s=this.getNonDeletedElementsMap(),{version:r}=t,{version:o}=vi(t,s,n,i);return this.elementsMap.has(t.id)&&r!==o&&i.informMutation&&this.triggerUpdate(),t}}class De{constructor(t,n){this.deleted=t,this.inserted=n}static create(t,n,i,s){const r=i&&s!=="inserted"?i(t,"deleted"):t,o=i&&s!=="deleted"?i(n,"inserted"):n;return new De(r,o)}static calculate(t,n,i,s){if(t===n)return De.empty();const r={},o={};for(const c of this.getDifferences(t,n))r[c]=t[c],o[c]=n[c];const[a,l]=s?s(r,o):[r,o];return De.create(a,l,i)}static empty(){return new De({},{})}static isEmpty(t){return!Object.keys(t.deleted).length&&!Object.keys(t.inserted).length}static merge(t,n,i=De.empty()){return De.create({...t.deleted,...n.deleted,...i.deleted},{...t.inserted,...n.inserted,...i.inserted})}static mergeObjects(t,n,i={}){const s={...t};for(const r of Object.keys(i))delete s[r];return{...s,...n}}static mergeArrays(t,n,i,s){return Object.values(De.mergeObjects(pa(t??[],s),pa(n??[],s),pa(i??[],s)))}static diffObjects(t,n,i,s){if(!t[i]&&!n[i])return;const r=t[i]!==null&&typeof t[i]=="object",o=n[i]!==null&&typeof n[i]=="object";if(r||o){const a=t[i]??{},l=n[i]??{},c=De.getLeftDifferences(a,l).reduce((d,f)=>(d[f]=s(a[f]),d),{}),u=De.getRightDifferences(a,l).reduce((d,f)=>(d[f]=s(l[f]),d),{});Object.keys(c).length||Object.keys(u).length?(Reflect.set(t,i,c),Reflect.set(n,i,u)):(Reflect.deleteProperty(t,i),Reflect.deleteProperty(n,i))}else t[i]===n[i]&&(Reflect.deleteProperty(t,i),Reflect.deleteProperty(n,i))}static diffArrays(t,n,i,s){if(!(!t[i]&&!n[i])&&(Array.isArray(t[i])||Array.isArray(n[i]))){const r=Array.isArray(t[i])?t[i]:[],o=Array.isArray(n[i])?n[i]:[],a=pa(De.getLeftDifferences(pa(r,s),pa(o,s)),c=>c),l=pa(De.getRightDifferences(pa(r,s),pa(o,s)),c=>c);if(Object.keys(a).length||Object.keys(l).length){const c=r.filter(d=>a[s?s(d):String(d)]),u=o.filter(d=>l[s?s(d):String(d)]);Reflect.set(t,i,c),Reflect.set(n,i,u)}else Reflect.deleteProperty(t,i),Reflect.deleteProperty(n,i)}}static isLeftDifferent(t,n,i=!1){return!!this.distinctKeysIterator("left",t,n,i).next().value}static isRightDifferent(t,n,i=!1){return!!this.distinctKeysIterator("right",t,n,i).next().value}static isInnerDifferent(t,n,i=!1){return!!!!this.distinctKeysIterator("inner",t,n,i).next().value}static isDifferent(t,n,i=!1){return!!!!this.distinctKeysIterator("full",t,n,i).next().value}static getLeftDifferences(t,n,i=!1){return Array.from(this.distinctKeysIterator("left",t,n,i)).sort()}static getRightDifferences(t,n,i=!1){return Array.from(this.distinctKeysIterator("right",t,n,i)).sort()}static getInnerDifferences(t,n,i=!1){return Array.from(this.distinctKeysIterator("inner",t,n,i)).sort()}static getDifferences(t,n,i=!1){return Array.from(this.distinctKeysIterator("full",t,n,i)).sort()}static*distinctKeysIterator(t,n,i,s=!1){if(n===i)return;let r=[];t==="left"?r=Object.keys(n):t==="right"?r=Object.keys(i):t==="inner"?r=Object.keys(n).filter(o=>o in i):t==="full"?r=Array.from(new Set([...Object.keys(n),...Object.keys(i)])):Ko(t,`Unknown distinctKeysIterator's join param "${t}"`,!0);for(const o of r){const a=n[o],l=i[o];if(a!==l){if(!s&&typeof a=="object"&&typeof l=="object"&&a!==null&&l!==null&&Wi(a,l))continue;yield o}}}}class An{constructor(t){this.delta=t}static create(t){return new An(t)}static calculate(t,n){const i=De.calculate(t,n,An.orderAppStateKeys,An.postProcess);return new An(i)}static restore(t){const{delta:n}=t;return new An(n)}static empty(){return new An(De.create({},{}))}inverse(){const t=De.create(this.delta.inserted,this.delta.deleted);return new An(t)}squash(t){if(t.isEmpty())return this;const n=De.mergeObjects(this.delta.deleted.selectedElementIds??{},t.delta.deleted.selectedElementIds??{}),i=De.mergeObjects(this.delta.inserted.selectedElementIds??{},t.delta.inserted.selectedElementIds??{}),s=De.mergeObjects(this.delta.deleted.selectedGroupIds??{},t.delta.deleted.selectedGroupIds??{}),r=De.mergeObjects(this.delta.inserted.selectedGroupIds??{},t.delta.inserted.selectedGroupIds??{}),o=De.mergeObjects(this.delta.deleted.lockedMultiSelections??{},t.delta.deleted.lockedMultiSelections??{}),a=De.mergeObjects(this.delta.inserted.lockedMultiSelections??{},t.delta.inserted.lockedMultiSelections??{}),l={},c={};return(Object.keys(n).length||Object.keys(i).length)&&(c.selectedElementIds=n,l.selectedElementIds=i),(Object.keys(s).length||Object.keys(r).length)&&(c.selectedGroupIds=s,l.selectedGroupIds=r),(Object.keys(o).length||Object.keys(a).length)&&(c.lockedMultiSelections=o,l.lockedMultiSelections=a),this.delta=De.merge(this.delta,t.delta,De.create(c,l)),this}applyTo(t,n){try{const{selectedElementIds:i={},selectedGroupIds:s={},lockedMultiSelections:r={}}=this.delta.deleted,{selectedElementIds:o={},selectedGroupIds:a={},lockedMultiSelections:l={},selectedLinearElement:c,...u}=this.delta.inserted,d=De.mergeObjects(t.selectedElementIds,o,i),f=De.mergeObjects(t.selectedGroupIds,a,s),h=De.mergeObjects(t.lockedMultiSelections,l,r),m=c&&n.has(c.elementId)?new pe(n.get(c.elementId),n,c.isEditing):null,p={...t,...u,selectedElementIds:d,selectedGroupIds:f,lockedMultiSelections:h,selectedLinearElement:typeof c<"u"?m:t.selectedLinearElement},U=this.filterInvisibleChanges(t,p,n);return[p,U]}catch(i){return console.error("Couldn't apply appstate change",i),[t,!1]}}isEmpty(){return De.isEmpty(this.delta)}filterInvisibleChanges(t,n,i){const s=lh(t),r=lh(n),o=De.isRightDifferent(An.stripElementsProps(s),An.stripElementsProps(r)),a=De.isRightDifferent(An.stripStandaloneProps(s),An.stripStandaloneProps(r));if(!o&&!a)return!1;const l={value:o};if(a){const c=De.getRightDifferences(An.stripStandaloneProps(s),An.stripStandaloneProps(r));let u=new Set;(c.includes("editingGroupId")||c.includes("selectedGroupIds"))&&(u=Ble(i));for(const d of c)switch(d){case"selectedElementIds":n[d]=An.filterSelectedElements(n[d],i,l);break;case"selectedGroupIds":n[d]=An.filterSelectedGroups(n[d],u,l);break;case"croppingElementId":{const y=n[d];if(!y)l.value=!0;else{const w=i.get(y);w&&!w.isDeleted?l.value=!0:n[d]=null}break}case"editingGroupId":const f=n[d];f?u.has(f)?l.value=!0:n[d]=null:l.value=!0;break;case"selectedLinearElement":const h=n[d];if(!h)l.value=!0;else{const y=i.get(h.elementId);y&&!y.isDeleted?l.value=!0:n[d]=null}break;case"lockedMultiSelections":const m=t[d]||{},p=n[d]||{};Wi(m,p)||(l.value=!0);break;case"activeLockedId":const U=t[d]||null,b=n[d]||null;U!==b&&(l.value=!0);break;default:Ko(d,`Unknown ObservedElementsAppState's key "${d}"`,!0)}}return l.value}static filterSelectedElements(t,n,i){const s=Object.keys(t);if(!s.length)return i.value=!0,t;const r={...t};for(const o of s){const a=n.get(o);a&&!a.isDeleted?i.value=!0:delete r[o]}return r}static filterSelectedGroups(t,n,i){if(!Object.keys(t).length)return i.value=!0,t;const r={...t};for(const o of Object.keys(r))n.has(o)?i.value=!0:delete r[o];return r}static stripElementsProps(t){const{editingGroupId:n,selectedGroupIds:i,selectedElementIds:s,selectedLinearElement:r,croppingElementId:o,lockedMultiSelections:a,activeLockedId:l,...c}=t;return c}static stripStandaloneProps(t){const{name:n,viewBackgroundColor:i,...s}=t;return s}static postProcess(t,n){try{De.diffObjects(t,n,"selectedElementIds",i=>!0),De.diffObjects(t,n,"selectedGroupIds",i=>i??!1),De.diffObjects(t,n,"lockedMultiSelections",i=>i??{})}catch{console.error("Couldn't postprocess appstate change deltas.")}finally{return[t,n]}}static orderAppStateKeys(t){const n={};for(const i of Object.keys(t).sort())n[i]=t[i];return n}}const Ut=class Ut{constructor(t,n,i){this.added=t,this.removed=n,this.updated=i}static create(t,n,i,s={shouldRedistribute:!1}){let r;if(s.shouldRedistribute){const o={},a={},l={},c=[...Object.entries(t),...Object.entries(n),...Object.entries(i)];for(const[u,d]of c)this.satisfiesAddition(d)?o[u]=d:this.satisfiesRemoval(d)?a[u]=d:l[u]=d;r=new Ut(o,a,l)}else r=new Ut(t,n,i);return r}static restore(t){const{added:n,removed:i,updated:s}=t;return Ut.create(n,i,s)}static validate(t,n,i){for(const[s,r]of Object.entries(t[n]))if(!this.satisfiesCommmonInvariants(r)||!this.satisfiesUniqueInvariants(t,s)||!i(r))throw console.error(`Broken invariant for "${n}" delta, element "${s}", delta:`,r),new Error(`ElementsDelta invariant broken for element "${s}".`)}static calculate(t,n){if(t===n)return Ut.empty();const i={},s={},r={};for(const o of t.values())if(!n.get(o.id)){const l={...o},c={isDeleted:!0,version:o.version+1,versionNonce:Rr()},u=De.create(l,c,Ut.stripIrrelevantProps);o.isDeleted?r[o.id]=u:s[o.id]=u}for(const o of n.values()){const a=t.get(o.id);if(!a){const l={isDeleted:!0,version:o.version-1,versionNonce:Rr()},c={...o},u=De.create(l,c,Ut.stripIrrelevantProps);o.isDeleted?r[o.id]=u:i[o.id]=u;continue}if(a.versionNonce!==o.versionNonce){const l=De.calculate(a,o,Ut.stripIrrelevantProps,Ut.postProcess);if(typeof a.isDeleted=="boolean"&&typeof o.isDeleted=="boolean"&&a.isDeleted!==o.isDeleted){a.isDeleted&&!o.isDeleted?i[o.id]=l:s[o.id]=l;continue}r[o.id]=l}}return Ut.create(i,s,r)}static empty(){return Ut.create({},{},{})}inverse(){const t=r=>{const o={};for(const[a,{inserted:l,deleted:c}]of Object.entries(r))o[a]=De.create({...l},{...c});return o},n=t(this.added),i=t(this.removed),s=t(this.updated);return Ut.create(i,n,s)}isEmpty(){return Object.keys(this.added).length===0&&Object.keys(this.removed).length===0&&Object.keys(this.updated).length===0}applyLatestChanges(t,n,i){const s=(c,u)=>(d,f)=>{let h;switch(f){case"deleted":h=c;break;case"inserted":h=u;break}if(!h)return console.error("Element not found when trying to apply latest changes"),d;const m={};for(const p of Object.keys(d))switch(p){case"boundElements":m[p]=d[p];break;default:m[p]=h[p]}return m},r=c=>{const u={};for(const[d,f]of Object.entries(c)){const h=t.get(d),m=n.get(d);let p=null;h||m?p=De.create(f.deleted,f.inserted,s(h,m),i):p=f,De.isInnerDifferent(p.deleted,p.inserted)&&(u[d]=p)}return u},o=r(this.added),a=r(this.removed),l=r(this.updated);return Ut.create(o,a,l,{shouldRedistribute:!0})}applyTo(t,n=Fo.empty().elements,i){let s=new Map(t),r;const o={containsVisibleDifference:!1,containsZindexDifference:!1,applyDirection:void 0};try{const a=Ut.createApplier(t,s,n,o,i),l=a(this.added),c=a(this.removed),u=a(this.updated),d=this.resolveConflicts(t,s,o.applyDirection);r=new Map([...l,...c,...u,...d])}catch(a){return console.error("Couldn't apply elements delta",a),[t,!0]}try{s=Ut.reorderElements(s,r,o),Ut.redrawElements(s,r)}catch(a){console.error("Couldn't mutate elements after applying elements change",a)}finally{return[s,o.containsVisibleDifference]}}squash(t){if(t.isEmpty())return this;const{added:n,removed:i,updated:s}=t,r=(o,a)=>{const l=De.mergeArrays(o.deleted.boundElements??[],a.deleted.boundElements??[],void 0,u=>u.id)??[],c=De.mergeArrays(o.inserted.boundElements??[],a.inserted.boundElements??[],void 0,u=>u.id)??[];if(!(!l.length&&!c.length))return De.create({boundElements:l},{boundElements:c})};for(const[o,a]of Object.entries(n)){const l=this.added[o]??this.removed[o]??this.updated[o];if(!l)this.added[o]=a;else{const c=r(l,a);delete this.removed[o],delete this.updated[o],this.added[o]=De.merge(l,a,c)}}for(const[o,a]of Object.entries(i)){const l=this.added[o]??this.removed[o]??this.updated[o];if(!l)this.removed[o]=a;else{const c=r(l,a);delete this.added[o],delete this.updated[o],this.removed[o]=De.merge(l,a,c)}}for(const[o,a]of Object.entries(s)){const l=this.added[o]??this.removed[o]??this.updated[o];if(!l)this.updated[o]=a;else{const c=r(l,a),u=De.merge(l,a,c);l===this.added[o]?this.added[o]=u:l===this.removed[o]?this.removed[o]=u:this.updated[o]=u}}return this}static applyDelta(t,n,i,s){var o,a,l;const r={};for(const c of Object.keys(n.inserted)){if(c==="boundElements"||(o=s==null?void 0:s.excludedProperties)!=null&&o.has(c))continue;const u=n.inserted[c];Reflect.set(r,c,u)}if((a=n.deleted.boundElements)!=null&&a.length||(l=n.inserted.boundElements)!=null&&l.length){const c=De.mergeArrays(t.boundElements,n.inserted.boundElements,n.deleted.boundElements,u=>u.id);Object.assign(r,{boundElements:c})}if(!i.containsVisibleDifference){const{index:c,...u}=r,d=Ut.checkForVisibleDifference(t,u);i.containsVisibleDifference=d}return i.containsZindexDifference||(i.containsZindexDifference=n.deleted.index!==n.inserted.index),Te(t,r,!0)}static checkForVisibleDifference(t,n){return t.isDeleted&&n.isDeleted!==!1?!1:t.isDeleted&&n.isDeleted===!1||t.isDeleted===!1&&n.isDeleted?!0:De.isRightDifferent(t,n)}resolveConflicts(t,n,i="forward"){const s=new Map,r=(a,l)=>{const c=n.get(a.id);if(!c)return;const u=t.get(a.id),d=i==="forward"?c.version+1:c.version-1,f=l;let h;u===c?h=Te(c,{...f,version:d},!0):h=vi(c,n,{...f,version:(u==null?void 0:u.version)!==c.version?c.version:d}),s.set(h.id,h),n.set(h.id,h)};for(const a of Object.keys(this.removed))Ut.unbindAffected(t,n,a,r);for(const a of Object.keys(this.added))Ut.rebindAffected(t,n,a,r);for(const[a]of Array.from(Object.entries(this.updated)).filter(([l,c])=>Object.keys({...c.deleted,...c.inserted}).find(u=>Tle.has(u)))){const l=n.get(a);!l||l.isDeleted||Ut.rebindAffected(t,n,a,r)}const o=new Map(Array.from(t).filter(([a])=>s.has(a)));return this.squash(Ut.calculate(o,s)),s}static unbindAffected(t,n,i,s){const r=()=>t.get(i),o=()=>n.get(i);$f.unbindAffected(n,r(),s),$f.unbindAffected(n,o(),s),Gf.unbindAffected(n,r(),s),Gf.unbindAffected(n,o(),s)}static rebindAffected(t,n,i,s){const r=()=>t.get(i),o=()=>n.get(i);$f.unbindAffected(n,r(),s),$f.rebindAffected(n,o(),s),Gf.unbindAffected(n,r(),(a,l)=>{de(a)&&s(a,l)}),Gf.rebindAffected(n,o(),s)}static redrawElements(t,n){try{const i=new _6(t,{skipValidation:!0});Ut.redrawTextBoundingBoxes(i,n),Ut.redrawBoundArrows(i,n)}catch(i){console.error("Couldn't redraw elements",i)}finally{return t}}static redrawTextBoundingBoxes(t,n){const i=t.getNonDeletedElementsMap(),s=new Map;for(const r of n.values()){if(zt(r)){const{containerId:o}=r,a=o?i.get(o):void 0;a&&s.set(a.id,{container:a,boundText:r})}if(Di(r)){const o=Qo(r),a=o?i.get(o):void 0;a&&s.set(r.id,{container:r,boundText:a})}}for(const{container:r,boundText:o}of s.values())r.isDeleted||o.isDeleted||qi(o,r,t)}static redrawBoundArrows(t,n){for(const i of n.values())!i.isDeleted&&ro(i)&&Is(i,t,{changedElements:n})}static reorderElements(t,n,i){if(!i.containsZindexDifference)return t;const s=Array.from(t.values()),r=v_([...s]),o=De.getRightDifferences(s,r,!0).reduce((a,l)=>{const c=s[Number(l)];return c&&n.has(c.id)&&a.set(c.id,c),a},new Map);return!i.containsVisibleDifference&&o.size&&(i.containsVisibleDifference=!0),ve(oo(r,o))}static postProcess(t,n){try{De.diffArrays(t,n,"boundElements",r=>r.id);const i=t.points??[],s=n.points??[];De.isDifferent(i,s)||(Reflect.deleteProperty(t,"points"),Reflect.deleteProperty(n,"points"))}catch{console.error("Couldn't postprocess elements delta.")}finally{return[t,n]}}static stripIrrelevantProps(t){const{id:n,updated:i,...s}=t;return s}};F(Ut,"satisfiesAddition",({deleted:t,inserted:n})=>t.isDeleted===!0&&!n.isDeleted),F(Ut,"satisfiesRemoval",({deleted:t,inserted:n})=>!t.isDeleted&&n.isDeleted===!0),F(Ut,"satisfiesUpdate",({deleted:t,inserted:n})=>!!t.isDeleted==!!n.isDeleted),F(Ut,"satisfiesCommmonInvariants",({deleted:t,inserted:n})=>!!(Number.isInteger(t.version)&&Number.isInteger(n.version)&&t.version>=0&&n.version>=0&&t.version!==n.version)),F(Ut,"satisfiesUniqueInvariants",(t,n)=>{const{added:i,removed:s,updated:r}=t;return[i[n],s[n],r[n]].filter(Boolean).length===1}),F(Ut,"createApplier",(t,n,i,s,r)=>o=>{const a=Ut.createGetter(n,i,s);return Object.entries(o).reduce((l,[c,u])=>{const d=a(c,u.inserted);if(d){const f=Ut.applyDelta(d,u,s,r);if(n.set(f.id,f),l.set(f.id,f),!s.applyDirection){const h=t.get(c);h&&(s.applyDirection=h.version>f.version?"backward":"forward")}}return l},new Map)}),F(Ut,"createGetter",(t,n,i)=>(s,r)=>{let o=t.get(s);return o||(o=n.get(s),o?(i.containsZindexDifference=!0,(!r.isDeleted||r.isDeleted&&!o.isDeleted)&&(i.containsVisibleDifference=!0)):o=Te({id:s,version:1},{...r})),o});let xu=Ut;const Dce=(e,t,n,i)=>{const[s,r,o,a]=n.axis==="x"?["minX","midX","maxX","width"]:["minY","midY","maxY","height"],l=Sr(e),c=Q5(e,t,i).map(h=>[h,Sr(h)]).sort((h,m)=>h[1][r]-m[1][r]);let u=0;for(const h of c)u+=h[1][a];const d=(l[a]-u)/(c.length-1);if(d<0){const h=c.findIndex(b=>b[1][s]===l[s]),m=c.findIndex(b=>b[1][o]===l[o]),p=(c[m][1][r]-c[h][1][r])/(c.length-1);let U=c[h][1][r];return c.flatMap(([b,y],w)=>{const v={x:0,y:0};return w!==h&&w!==m&&(U+=p,v[n.axis]=U-y[r]),b.map(I=>Te(I,{x:I.x+v.x,y:I.y+v.y}))})}let f=l[s];return c.flatMap(([h,m])=>{const p={x:0,y:0};return p[n.axis]=f-m[s],f+=d,f+=m[a],h.map(U=>Te(U,{x:U.x+p.x,y:U.y+p.y}))})},Lce=(e,t,n,i,s,r)=>{if(t.length===1&&ge(t[0])&&(t[0].startBinding||t[0].endBinding))return;const o=t.filter(d=>{if(ge(d)&&d.startBinding&&d.endBinding){const f=t.find(m=>{var p;return m.id===((p=d.startBinding)==null?void 0:p.elementId)}),h=t.find(m=>{var p;return m.id===((p=d.endBinding)==null?void 0:p.elementId)});return f&&h}return!0}),a=new Set(o),l=o.filter(d=>Ee(d)).map(d=>d.id);if(l.length>0)for(const d of i.getNonDeletedElements())d.frameId!==null&&l.includes(d.frameId)&&a.add(d);const c=[];for(const d of a){const f=e.originalElements.get(d.id);if(!f)return;c.push(f)}const u=Nce(ft(c),n,s,r);a.forEach(d=>{if(fM(e,d,i,u),!xe(d)){const f=Re(d,i.getNonDeletedElementsMap());f&&fM(e,f,i,u),Is(d,i,{simultaneouslyUpdated:Array.from(a)})}})},Nce=(e,t,n,i)=>{const[s,r]=e;let o=s+t.x+n.x,a=r+t.y+n.y;if(n.x===0||n.y===0){const[l,c]=On(s+t.x,r+t.y,i);n.x===0&&(o=l),n.y===0&&(a=c)}return{x:o-s,y:a-r}},fM=(e,t,n,i)=>{const s=e.originalElements.get(t.id)??t,r=s.x+i.x,o=s.y+i.y;n.mutateElement(t,{x:r,y:o})},Oce=(e,t,n)=>{const[i,s]=ft(e);return[t-i,n-s]},hM=({newElement:e,elementType:t,originX:n,originY:i,x:s,y:r,width:o,height:a,shouldMaintainAspectRatio:l,shouldResizeFromCenter:c,zoom:u,scene:d,widthAspectRatio:f=null,originOffset:h=null,informMutation:m=!0})=>{l&&e.type!=="selection"&&(f?a=o/f:(Math.abs(r-i)>Math.abs(s-n)?{width:o,height:a}=oM(t,a,s<n?-o:o):{width:o,height:a}=oM(t,o,r<i?-a:a),a<0&&(a=-a)));let p=s<n?n-o:n,U=r<i?i-a:i;c&&(o+=o,a+=a,p=n-o/2,U=i-a/2);let b=null;if(de(e)){a=e.height;const y=K9(gt({fontSize:e.fontSize,fontFamily:e.fontFamily}),e.lineHeight);o=Math.max(o,y),Math.abs(s-n)>Use/u&&(b={autoResize:!1}),U=i,c&&(p=n-o/2)}if(o!==0&&a!==0){let y=null;yt(e)&&(y={initialWidth:o,initialHeight:a}),d.mutateElement(e,{x:p+((h==null?void 0:h.x)??0),y:U+((h==null?void 0:h.y)??0),width:o,height:a,...b,...y},{informMutation:m,isDragging:!1})}},Wz=(e,t)=>{const n=window.location.href;try{const i=new URL(n);return i.searchParams.set(Gb,e),Qs(i.toString())}catch(i){console.error(i)}return Qs(n)},Kz=(e,t)=>{if(e.length>0&&T6(e)){if(e.length===1)return{id:e[0].id,type:"element"};if(e.length>1){const n=Object.keys(t.selectedGroupIds)[0];return n?{id:n,type:"group"}:{id:e[0].groupIds[0],type:"group"}}}return null},T6=e=>!!(e.length===1||e.length>1&&a_(e)),ch=e=>{try{const t=new URL(e);return t.searchParams.has(Gb)&&t.host===window.location.host}catch{return!1}},Pce=e=>{try{const{searchParams:t}=new URL(e);if(t.has(Gb))return t.get(Gb)}catch{}return null},ao=(e,{x:t,y:n,strokeColor:i=mn.strokeColor,backgroundColor:s=mn.backgroundColor,fillStyle:r=mn.fillStyle,strokeWidth:o=mn.strokeWidth,strokeStyle:a=mn.strokeStyle,roughness:l=mn.roughness,opacity:c=mn.opacity,width:u=0,height:d=0,angle:f=0,groupIds:h=[],frameId:m=null,index:p=null,roundness:U=null,boundElements:b=null,link:y=null,locked:w=mn.locked,...v})=>((t<-1e6||t>1e6||n<-1e6||n>1e6||u<-1e6||u>1e6||d<-1e6||d>1e6)&&console.error("New element size or position is too large",{x:t,y:n,width:u,height:d,points:v.points}),{id:v.id||fs(),type:e,x:t,y:n,width:u,height:d,angle:f,strokeColor:i,backgroundColor:s,fillStyle:r,strokeWidth:o,strokeStyle:a,roughness:l,opacity:c,groupIds:h,frameId:m,index:p,roundness:U,seed:v.seed??Rr(),version:v.version||1,versionNonce:v.versionNonce??0,isDeleted:!1,boundElements:b,updated:bg(),link:y,locked:w,customData:v.customData}),ta=e=>ao(e.type,e),gM=e=>ao("embeddable",e),Fce=e=>({...ao("iframe",e)}),__=e=>Te({...ao("frame",e),type:"frame",name:(e==null?void 0:e.name)||null},{}),N4=e=>Te({...ao("magicframe",e),type:"magicframe",name:(e==null?void 0:e.name)||null},{}),Zz=(e,t)=>({x:e.textAlign==="center"?t.width/2:e.textAlign==="right"?t.width:0,y:e.verticalAlign==="middle"?t.height/2:0}),nr=e=>{const t=e.fontFamily||tu,n=e.fontSize||vl,i=e.lineHeight||Oc(t),s=Bh(e.text),r=Xn(s,gt({fontFamily:t,fontSize:n}),i),o=e.textAlign||up,a=e.verticalAlign||zb,l=Zz({textAlign:o,verticalAlign:a},r),c={...ao("text",e),text:s,fontSize:n,fontFamily:t,textAlign:o,verticalAlign:a,x:e.x-l.x,y:e.y-l.y,width:r.width,height:r.height,containerId:e.containerId||null,originalText:e.originalText??s,autoResize:e.autoResize??!0,lineHeight:i};return Te(c,{})},Bce=(e,t,n)=>{let{width:i,height:s}=Xn(n,gt(e),e.lineHeight);e.autoResize||(i=e.width);const{textAlign:r,verticalAlign:o}=e;let a,l;if(r==="center"&&o===Gs.MIDDLE&&!e.containerId&&e.autoResize){const c=Xn(e.text,gt(e),e.lineHeight),u=Zz(e,{width:i-c.width,height:s-c.height});a=e.x-u.x,l=e.y-u.y}else{const[c,u,d,f]=ze(e,t),[h,m,p,U]=dm(e,i,s,!1),b=(c-h)/2,y=(u-m)/2,w=(d-p)/2,v=(f-U)/2;[a,l]=zce({s:!0,e:r==="center"||r==="left",w:r==="center"||r==="right"},e.x,e.y,e.angle,b,y,w,v)}return{width:i,height:s,x:Number.isFinite(a)?a:e.x,y:Number.isFinite(l)?l:e.y}},zce=(e,t,n,i,s,r,o,a)=>{const l=Math.cos(i),c=Math.sin(i);return e.e&&e.w?t+=s+o:e.e?(t+=s*(1+l),n+=s*c,t+=o*(1-l),n+=o*-c):e.w&&(t+=s*(1-l),n+=s*-c,t+=o*(1+l),n+=o*c),e.n&&e.s?n+=r+a:e.n?(t+=r*c,n+=r*(1-l),t+=a*-c,n+=a*(1+l)):(t+=r*-c,n+=r*(1+l),t+=a*c,n+=a*(1-l)),[t,n]},qz=(e,t,n,i=e.text)=>{if(e.isDeleted)return;(t||!e.autoResize)&&(i=iu(i,gt(e),t?Jo(t,e):e.width));const s=Bce(e,n,i);return{text:i,...s}},Hce=e=>({...ao(e.type,e),points:e.points||[],pressures:e.pressures||[],simulatePressure:e.simulatePressure,lastCommittedPoint:null}),Ec=e=>{const t={...ao(e.type,e),points:e.points||[],lastCommittedPoint:null,startBinding:null,endBinding:null,startArrowhead:null,endArrowhead:null};return tn(t)?{...t,polygon:e.polygon??!1}:t},uh=e=>e.elbowed?{...ao(e.type,e),points:e.points||[],lastCommittedPoint:null,startBinding:null,endBinding:null,startArrowhead:e.startArrowhead||null,endArrowhead:e.endArrowhead||null,elbowed:!0,fixedSegments:e.fixedSegments||[],startIsSpecial:!1,endIsSpecial:!1}:{...ao(e.type,e),points:e.points||[],lastCommittedPoint:null,startBinding:null,endBinding:null,startArrowhead:e.startArrowhead||null,endArrowhead:e.endArrowhead||null,elbowed:!1},Qz=e=>({...ao("image",e),strokeColor:"transparent",status:e.status??"pending",fileId:e.fileId??null,scale:e.scale??[1,1],crop:e.crop??null}),po=new Map,Vce=/^(?:http(?:s)?:\/\/)?(?:www\.)?youtu(?:be\.com|\.be)\/(embed\/|watch\?v=|shorts\/|playlist\?list=|embed\/videoseries\?list=)?([a-zA-Z0-9_-]+)/,$ce=/^(?:http(?:s)?:\/\/)?(?:(?:w){3}\.)?(?:player\.)?vimeo\.com\/(?:video\/)?([^?\s]+)(?:\?.*)?$/,Gce=/^https:\/\/(?:www\.)?figma\.com/,mM=/^https:\/\/gist\.github\.com\/([\w_-]+)\/([\w_-]+)/,Xce=/^<script[\s\S]*?\ssrc=["'](https:\/\/gist\.github\.com\/.*?)\.js["']/i,jce=/^(?:https?:\/\/)?forms\.microsoft\.com\//,pM=/(?:https?:\/\/)?(?:(?:w){3}\.)?(?:twitter|x)\.com\/[^/]+\/status\/(\d+)/,Yce=/^<blockquote[\s\S]*?\shref=["'](https?:\/\/(?:twitter|x)\.com\/[^"']*)/i,Wce=/^https:\/\/(?:www\.)?val\.town\/(v|embed)\/[a-zA-Z_$][0-9a-zA-Z_$]+\.[a-zA-Z_$][0-9a-zA-Z_$]+/,Kce=/^<(?:iframe|blockquote)[\s\S]*?\s(?:src|href)=["']([^"']*)["'][\s\S]*?>$/i,UM=/giphy.com\/(?:clips|embed|gifs)\/[a-zA-Z0-9]*?-?([a-zA-Z0-9]+)(?:[^a-zA-Z0-9]|$)/,bM=/^(?:http(?:s)?:\/\/)?(?:www\.)?reddit\.com\/r\/([a-zA-Z0-9_]+)\/comments\/([a-zA-Z0-9_]+)\/([a-zA-Z0-9_]+)\/?(?:\?[^#\s]*)?(?:#[^\s]*)?$/,Zce=/^<blockquote[\s\S]*?\shref=["'](https?:\/\/(?:www\.)?reddit\.com\/[^"']*)/i,qce=e=>{let t;try{const o=new URL(e.startsWith("http")?e:`https://${e}`);t=o.searchParams.get("t")||o.searchParams.get("start")}catch{const a=e.match(/[?&#](?:t|start)=([^&#\s]+)/);t=a==null?void 0:a[1]}if(!t)return 0;if(/^\d+$/.test(t))return parseInt(t,10);const n=t.match(/^(?:(\d+)h)?(?:(\d+)m)?(?:(\d+)s)?$/);if(!n)return 0;const[,i="0",s="0",r="0"]=n;return parseInt(i)*3600+parseInt(s)*60+parseInt(r)},O4=new Set(["youtube.com","youtu.be","vimeo.com","player.vimeo.com","figma.com","link.excalidraw.com","gist.github.com","twitter.com","x.com","*.simplepdf.eu","stackblitz.com","val.town","giphy.com","reddit.com","forms.microsoft.com"]),yM=new Set(["youtube.com","youtu.be","vimeo.com","player.vimeo.com","figma.com","twitter.com","x.com","*.simplepdf.eu","stackblitz.com","reddit.com","forms.microsoft.com"]),v0=e=>`<html><body>${e}</body></html>`,jf=e=>{if(!e)return null;if(po.has(e))return po.get(e);const t=e,n=yM.has(P4(e,yM)||"");let i="generic",s={w:560,h:840};const r=e.match(Vce);if(r!=null&&r[2]){const c=qce(t),u=c>0?`&start=${c}`:"",d=e.includes("shorts");switch(i="video",r[1]){case"embed/":case"watch?v=":case"shorts/":e=`https://www.youtube.com/embed/${r[2]}?enablejsapi=1${u}`;break;case"playlist?list=":case"embed/videoseries?list=":e=`https://www.youtube.com/embed/videoseries?list=${r[2]}&enablejsapi=1${u}`;break;default:e=`https://www.youtube.com/embed/${r[2]}?enablejsapi=1${u}`;break}return s=d?{w:315,h:560}:{w:560,h:315},po.set(t,{link:e,intrinsicSize:s,type:i,sandbox:{allowSameOrigin:n}}),{link:e,intrinsicSize:s,type:i,sandbox:{allowSameOrigin:n}}}const o=e.match($ce);if(o!=null&&o[1]){const c=o==null?void 0:o[1],u=/^\d+$/.test(c)?void 0:new URIError("Invalid embed link format");return i="video",e=`https://player.vimeo.com/video/${c}?api=1`,s={w:560,h:315},po.set(t,{link:e,intrinsicSize:s,type:i,sandbox:{allowSameOrigin:n}}),{link:e,intrinsicSize:s,type:i,error:u,sandbox:{allowSameOrigin:n}}}if(e.match(Gce))return i="generic",e=`https://www.figma.com/embed?embed_host=share&url=${encodeURIComponent(e)}`,s={w:550,h:550},po.set(t,{link:e,intrinsicSize:s,type:i,sandbox:{allowSameOrigin:n}}),{link:e,intrinsicSize:s,type:i,sandbox:{allowSameOrigin:n}};const l=e.match(Wce);if(l)return e=l[1]==="embed"?l[0]:l[0].replace("/v","/embed"),po.set(t,{link:e,intrinsicSize:s,type:i,sandbox:{allowSameOrigin:n}}),{link:e,intrinsicSize:s,type:i,sandbox:{allowSameOrigin:n}};if(jce.test(e)&&!e.includes("embed=true")&&(e+=e.includes("?")?"&embed=true":"?embed=true"),pM.test(e)){const c=e.match(pM)[1],u=A2(`https://twitter.com/x/status/${c}`),d={type:"document",srcdoc:f=>v0(`<blockquote class="twitter-tweet" data-dnt="true" data-theme="${f}"><a href="${u}"></a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"><\/script>`),intrinsicSize:{w:480,h:480},sandbox:{allowSameOrigin:n}};return po.set(t,d),d}if(bM.test(e)){const[,c,u,d]=e.match(bM),f=A2(`https://reddit.com/r/${c}/comments/${u}/${d}`),h={type:"document",srcdoc:m=>v0(`<blockquote class="reddit-embed-bq" data-embed-theme="${m}"><a href="${f}"></a><br></blockquote><script async="" src="https://embed.reddit.com/widgets.js" charset="UTF-8"><\/script>`),intrinsicSize:{w:480,h:480},sandbox:{allowSameOrigin:n}};return po.set(t,h),h}if(mM.test(e)){const[,c,u]=e.match(mM),d=A2(`https://gist.github.com/${c}/${u}`),f={type:"document",srcdoc:()=>v0(`
          <script src="${d}.js"><\/script>
          <style type="text/css">
            * { margin: 0px; }
            table, .gist { height: 100%; }
            .gist .gist-file { height: calc(100vh - 2px); padding: 0px; display: grid; grid-template-rows: 1fr auto; }
          </style>
        `),intrinsicSize:{w:550,h:720},sandbox:{allowSameOrigin:n}};return po.set(e,f),f}return po.set(e,{link:e,intrinsicSize:s,type:i,sandbox:{allowSameOrigin:n}}),{link:e,intrinsicSize:s,type:i,sandbox:{allowSameOrigin:n}}},Jz=e=>{let t;jl(e)?t="IFrame element":t=!e.link||(e==null?void 0:e.link)===""?"Empty Web-Embed":e.link;const n=Math.max(Math.min(e.width/2,e.width/t.length),e.width/30),i=et.Helvetica,s=gt({fontSize:n,fontFamily:i});return nr({x:e.x+e.width/2,y:e.y+e.height/2,strokeColor:e.strokeColor!=="transparent"?e.strokeColor:"black",backgroundColor:"transparent",fontFamily:i,fontSize:n,text:iu(t,s,e.width-20),textAlign:"center",verticalAlign:Gs.MIDDLE,angle:e.angle??0})},P4=(e,t)=>{try{const{hostname:n}=new URL(e),i=n.replace(/^www\./,"");if(t instanceof Set){if(O4.has(i))return i;const r=i.replace(/^([^.]+)/,"*");return O4.has(r)?r:null}const s=t.replace(/^www\./,"");if(i===s)return s}catch{}return null},Qce=e=>{const t=e.match(Yce);if(t&&t.length===2)return t[1];const n=e.match(Zce);if(n&&n.length===2)return n[1];const i=e.match(Xce);if(i&&i.length===2)return i[1];if(UM.test(e))return`https://giphy.com/embed/${UM.exec(e)[1]}`;const s=e.match(Kce);return s&&s.length===2?s[1]:e},O2=(e,t)=>{if(!e)return!1;if(t!=null)if(typeof t=="function"){const n=t(e);if(typeof n=="boolean")return n}else{if(typeof t=="boolean")return t;if(t instanceof RegExp)return t.test(e);if(Array.isArray(t)){for(const n of t)if(n instanceof RegExp){if(e.match(n))return!0}else if(P4(e,n))return!0;return!1}}return!!P4(e,O4)},dh=100,Du=100,EM=e=>{switch(e){case H.ARROW_UP:return"up";case H.ARROW_DOWN:return"down";case H.ARROW_RIGHT:return"right";case H.ARROW_LEFT:return"left";default:return"right"}},eH=(e,t,n,i)=>{const s=[...n.values()].reduce((r,o)=>{var l;let a;if(ge(o)&&(a=o[e==="predecessors"?"startBinding":"endBinding"])&&((l=o[e==="predecessors"?"endBinding":"startBinding"])==null?void 0:l.elementId)===t.id){const c=n.get(a.elementId);if(!c)return r;gn(ro(c),"not an ExcalidrawBindableElement");const u=e==="predecessors"?o.points[o.points.length-1]:[0,0],d=e_(t,wa(t,n),[u[0]+o.x,u[1]+o.y]);r.push({relative:c,heading:d})}return r},[]);switch(i){case"up":return s.filter(r=>$n(r.heading,Kr)).map(r=>r.relative);case"down":return s.filter(r=>$n(r.heading,ls)).map(r=>r.relative);case"right":return s.filter(r=>$n(r.heading,Hn)).map(r=>r.relative);case"left":return s.filter(r=>$n(r.heading,Ur)).map(r=>r.relative)}},F4=(e,t,n)=>eH("successors",e,t,n),B4=(e,t,n)=>eH("predecessors",e,t,n),Jce=(e,t,n)=>{const i=Du+e.width;if(n==="up"||n==="down"){const a=dh+e.height,l=e.x,c=e.x+e.width;if(t.every(u=>u.x+u.width<l||u.x>c))return{x:0,y:a*(n==="up"?-1:1)}}else if(n==="right"||n==="left"){const a=e.y,l=e.y+e.height;if(t.every(c=>c.y+c.height<a||c.y>l))return{x:(Du+e.width)*(n==="left"?-1:1),y:0}}if(n==="up"||n==="down"){const a=dh+e.height,l=(t.length===0,a),c=t.length===0?0:(t.length+1)%2===0?(t.length+1)/2*i:t.length/2*i*-1;return n==="up"?{x:c,y:l*-1}:{x:c,y:l}}const s=dh+e.height,r=(t.length===0,Du+e.width),o=t.length===0?0:(t.length+1)%2===0?(t.length+1)/2*s:t.length/2*s*-1;return n==="left"?{x:r*-1,y:o}:{x:r,y:o}},eue=(e,t,n,i)=>{const s=i.getNonDeletedElementsMap(),r=F4(e,s,n),o=B4(e,s,n),a=Jce(e,[...r,...o],n),l=ta({type:e.type,x:e.x+a.x,y:e.y+a.y,width:e.width,height:e.height,roundness:e.roundness,roughness:e.roughness,backgroundColor:e.backgroundColor,strokeColor:e.strokeColor,strokeWidth:e.strokeWidth,opacity:e.opacity,fillStyle:e.fillStyle,strokeStyle:e.strokeStyle});gn(K5(l),"not an ExcalidrawFlowchartNodeElement");const c=tH(e,l,n,t,i);return{nextNode:l,bindingArrow:c}},tue=(e,t,n,i,s)=>{const r=[];for(let o=0;o<s;o++){let a,l;if(n==="left"||n==="right"){const d=dh*(s-1)+s*e.height,f=e.y+e.height/2-d/2;let h=Du+e.width;n==="left"&&(h*=-1),a=e.x+h;const m=(dh+e.height)*o;l=f+m}else{const d=Du*(s-1)+s*e.width,f=e.x+e.width/2-d/2;let h=dh+e.height;n==="up"&&(h*=-1),l=e.y+h;const m=(Du+e.width)*o;a=f+m}const c=ta({type:e.type,x:a,y:l,width:e.width,height:e.height,roundness:e.roundness,roughness:e.roughness,backgroundColor:e.backgroundColor,strokeColor:e.strokeColor,strokeWidth:e.strokeWidth,opacity:e.opacity,fillStyle:e.fillStyle,strokeStyle:e.strokeStyle});gn(K5(c),"not an ExcalidrawFlowchartNodeElement");const u=tH(e,c,n,t,i);r.push(c),r.push(u)}return r},tH=(e,t,n,i,s)=>{let r,o;switch(n){case"up":{r=e.x+e.width/2,o=e.y-6;break}case"down":{r=e.x+e.width/2,o=e.y+e.height+6;break}case"right":{r=e.x+e.width+6,o=e.y+e.height/2;break}case"left":{r=e.x-6,o=e.y+e.height/2;break}}let l,c;switch(n){case"up":{l=t.x+t.width/2-r,c=t.y+t.height-o+6;break}case"down":{l=t.x+t.width/2-r,c=t.y-o-6;break}case"right":{l=t.x-r-6,c=t.y-o+t.height/2;break}case"left":{l=t.x+t.width-r+6,c=t.y-o+t.height/2;break}}const u=uh({type:"arrow",x:r,y:o,startArrowhead:null,endArrowhead:i.currentItemEndArrowhead,strokeColor:e.strokeColor,strokeStyle:e.strokeStyle,strokeWidth:e.strokeWidth,opacity:e.opacity,roughness:e.roughness,points:[x(0,0),x(l,c)],elbowed:!0}),d=s.getNonDeletedElementsMap();ea(u,e,"start",s),ea(u,t,"end",s);const f=new Map;f.set(e.id,e),f.set(t.id,t),f.set(u.id,u),pe.movePoints(u,s,new Map([[1,{point:u.points[1]}]]));const h=yg(u,Zo(new Map([...d.entries(),[e.id,e],[t.id,t],[u.id,u]])),{points:u.points});return{...u,...h}};class nue{constructor(){F(this,"isExploring",!1);F(this,"sameLevelNodes",[]);F(this,"sameLevelIndex",0);F(this,"direction",null);F(this,"visitedNodes",new Set)}clear(){this.isExploring=!1,this.sameLevelNodes=[],this.sameLevelIndex=0,this.direction=null,this.visitedNodes.clear()}exploreByDirection(t,n,i){if(!ro(t))return null;if(i!==this.direction&&this.clear(),this.visitedNodes.has(t.id)||this.visitedNodes.add(t.id),this.isExploring&&i===this.direction&&this.sameLevelNodes.length>1)return this.sameLevelIndex=(this.sameLevelIndex+1)%this.sameLevelNodes.length,this.sameLevelNodes[this.sameLevelIndex].id;const s=[...F4(t,n,i),...B4(t,n,i)];if(s.length>0)return this.sameLevelIndex=0,this.isExploring=!0,this.sameLevelNodes=s,this.direction=i,this.visitedNodes.add(s[0].id),s[0].id;if(i===this.direction||!this.isExploring){this.isExploring||this.visitedNodes.add(t.id);const o=["up","right","down","left"].filter(a=>a!==i).map(a=>[...F4(t,n,a),...B4(t,n,a)]).flat().filter(a=>!this.visitedNodes.has(a.id));for(const a of o)if(!this.visitedNodes.has(a.id))return this.visitedNodes.add(a.id),this.isExploring=!0,this.direction=i,a.id}return null}}class iue{constructor(){F(this,"isCreatingChart",!1);F(this,"numberOfNodes",0);F(this,"direction","right");F(this,"pendingNodes",null)}createNodes(t,n,i,s){const r=s.getNonDeletedElementsMap();if(i!==this.direction){const{nextNode:o,bindingArrow:a}=eue(t,n,i,s);this.numberOfNodes=1,this.isCreatingChart=!0,this.direction=i,this.pendingNodes=[o,a]}else{this.numberOfNodes+=1;const o=tue(t,n,i,s,this.numberOfNodes);this.isCreatingChart=!0,this.direction=i,this.pendingNodes=o}if(t.frameId){const o=r.get(t.frameId);gn(o&&YB(o),"not an ExcalidrawFrameElement"),o&&this.pendingNodes.every(a=>Tp([a],o,r)||Fc(a,o,r))&&(this.pendingNodes=this.pendingNodes.map(a=>vi(a,r,{frameId:t.frameId})))}}clear(){this.isCreatingChart=!1,this.pendingNodes=null,this.direction=null,this.numberOfNodes=0}}const sue=(e,t)=>{var n,i;for(const[,s]of t)if(s.type==="arrow"&&(((n=s.startBinding)==null?void 0:n.elementId)===e.id||((i=s.endBinding)==null?void 0:i.elementId)===e.id))return!0;return!1},rue=e=>new Promise((t,n)=>{const i=new Image;i.onload=()=>{t(i)},i.onerror=s=>{n(s)},i.src=e}),nH=async({fileIds:e,files:t,imageCache:n})=>{const i=new Map,s=new Map;return await Promise.all(e.reduce((r,o)=>{const a=t[o];return a&&!i.has(o)?(i.set(o,!0),r.concat((async()=>{try{if(a.mimeType===_e.binary)throw new Error("Only images can be added to ImageCache");const l=rue(a.dataURL),c={image:l,mimeType:a.mimeType};n.set(o,c);const u=await l;n.set(o,{...c,image:u})}catch{s.set(o,!0)}})())):r},[])),{imageCache:n,updatedFiles:i,erroredFiles:s}},iH=e=>e.filter(t=>Dn(t)),oue=e=>(e==null?void 0:e.nodeName.toLowerCase())==="svg",vM=e=>{const t=new DOMParser().parseFromString(e,_e.svg),n=t.querySelector("svg");if(t.querySelector("parsererror")||!oue(n))throw new Error("Invalid SVG");{n.hasAttribute("xmlns")||n.setAttribute("xmlns",it);let s=n.getAttribute("width"),r=n.getAttribute("height");(s!=null&&s.includes("%")||s==="auto")&&(s=null),(r!=null&&r.includes("%")||r==="auto")&&(r=null);const o=n.getAttribute("viewBox");if(!s||!r){if(s=s||"50",r=r||"50",o){const a=o.match(/\d+ +\d+ +(\d+(?:\.\d+)?) +(\d+(?:\.\d+)?)/);a&&([,s,r]=a)}n.setAttribute("width",s),n.setAttribute("height",r)}return o||n.setAttribute("viewBox",`0 0 ${s} ${r}`),n.outerHTML}},wM=(e,t,n,i=50)=>{if(!e||e.length===0)return[];const s=[],r=Array.isArray(e[0])?e:e.map(h=>[h]),o=r.length,a=Math.max(1,Math.ceil(Math.sqrt(o))),l=[];for(let h=0;h<o;h+=a)l.push(r.slice(h,h+a));let c=0;const u=l.map(h=>{let m=0,p=0;const U=h.map(b=>{const[y,w,v,I]=ft(b);return{elements:b,bounds:[y,w,v,I],width:v-y,height:I-w}});return U.forEach((b,y)=>{m+=b.width,y<U.length-1&&(m+=i),b.height>p&&(p=b.height)}),c+=p,{unitBounds:U,width:m,maxHeight:p}}),d=c+Math.max(0,l.length-1)*i;let f=n-d/2;return u.forEach(h=>{const{unitBounds:m,width:p,maxHeight:U}=h;let b=t-p/2;m.forEach(y=>{const[w,v]=y.bounds,I=b-w,C=f-v;y.elements.forEach(_=>{s.push(Te(_,{x:_.x+I,y:_.y+C}))}),b+=y.width+i}),f+=U+i}),s},aue=(e,t,n,i,s,r,o,a,l,c,u)=>{const d=i.getNonDeletedElementsMap();if(n.length===1){const[f]=n;if(t==="rotation")ge(f)||(lue(f,i,a,l,s),Is(f,i));else if(t){const h=n[0].id,m=d.get(h),p=e.get(h);if(m&&p){const{nextWidth:U,nextHeight:b}=gue(m,p,t,a,l,{shouldMaintainAspectRatio:o,shouldResizeFromCenter:r});hm(U,b,m,p,e,i,t,{shouldMaintainAspectRatio:o,shouldResizeFromCenter:r})}}return de(f)&&Is(f,i),!0}else if(n.length>1){if(t==="rotation")return uue(e,n,i,a,l,s,c,u),!0;if(t){const{nextWidth:f,nextHeight:h,flipByX:m,flipByY:p,originalBoundingBox:U}=mue(n,e,d,t,a,l,{shouldMaintainAspectRatio:o,shouldResizeFromCenter:r});return sH(n,d,t,i,e,{shouldResizeFromCenter:r,shouldMaintainAspectRatio:o,flipByX:m,flipByY:p,nextWidth:f,nextHeight:h,originalBoundingBox:U}),!0}}return!1},lue=(e,t,n,i,s)=>{const[r,o,a,l]=ze(e,t.getNonDeletedElementsMap()),c=(r+a)/2,u=(o+l)/2;let d;Ee(e)?d=0:(d=5*Math.PI/2+Math.atan2(i-u,n-c),s&&(d=d+Fs/2,d=d-d%Fs),d=eo(d));const f=Qo(e);if(t.mutateElement(e,{angle:d}),f){const h=t.getElement(f);if(h&&!xe(e)){const{x:m,y:p}=su(e,h,t.getNonDeletedElementsMap());t.mutateElement(h,{angle:d,x:m,y:p})}}},T_=(e,t,n,i)=>Se(e)||Zi(e)?{points:Qb(0,t,Qb(1,n,e.points,i),i)}:{},I_=(e,t,n)=>{let i=e.width;if(zt(e)){const o=jn(e,t);o&&(i=Jo(o,e))}const r=e.fontSize*(n/i);return r<S9?null:{size:r}},cue=(e,t,n,i,s,r,o)=>{const a=n.getNonDeletedElementsMap(),l=t.width*(o/t.height),c=I_(t,a,l);if(c!==null){if(i.includes("n")||i.includes("s")){const u=x(e.x,e.y),d=z4(u,e.width,e.height,l,o,e.angle,i,!1,s);n.mutateElement(t,{fontSize:c.size,width:l,height:o,x:d.x,y:d.y});return}if(i==="e"||i==="w"){const u=K9(gt({fontSize:t.fontSize,fontFamily:t.fontFamily}),t.lineHeight),d=Math.max(u,r),f=iu(t.originalText,gt(t),Math.abs(d)),h=Xn(f,gt(t),t.lineHeight),m=h.height,p=x(e.x,e.y),U=z4(p,e.width,e.height,d,m,t.angle,i,!1,s),b={width:Math.abs(d),height:Math.abs(h.height),x:U.x,y:U.y,text:f,autoResize:!1};n.mutateElement(t,b)}}},uue=(e,t,n,i,s,r,o,a)=>{var u;const l=n.getNonDeletedElementsMap();let c=5*Math.PI/2+Math.atan2(s-a,i-o);r&&(c+=Fs/2,c-=c%Fs);for(const d of t)if(!Ee(d)){const[f,h,m,p]=ze(d,l),U=(f+m)/2,b=(h+p)/2,y=((u=e.get(d.id))==null?void 0:u.angle)??d.angle,[w,v]=q(x(U,b),x(o,a),c+y-d.angle),I=ge(d)?{points:Sle(d,l)}:{x:d.x+(w-U),y:d.y+(v-b),angle:eo(c+y)};n.mutateElement(d,I),Is(d,n,{simultaneouslyUpdated:t});const C=Re(d,l);if(C&&!xe(d)){const{x:_,y:T}=su(d,C,l);n.mutateElement(C,{x:_,y:T,angle:eo(c+y)})}}n.triggerUpdate()},due=(e,t,n,i,s)=>{const[r,o,a,l]=t.length===1?ze(t[0],n):ft(t),c=(r+a)/2,u=(o+l)/2,d=t.length===1?t[0].angle:0;switch([i,s]=q(x(i,s),x(c,u),-d),e){case"n":return q(x(i-(r+a)/2,s-o),x(0,0),d);case"s":return q(x(i-(r+a)/2,s-l),x(0,0),d);case"w":return q(x(i-r,s-(o+l)/2),x(0,0),d);case"e":return q(x(i-a,s-(o+l)/2),x(0,0),d);case"nw":return q(x(i-r,s-o),x(0,0),d);case"ne":return q(x(i-a,s-o),x(0,0),d);case"sw":return q(x(i-r,s-l),x(0,0),d);case"se":return q(x(i-a,s-l),x(0,0),d);default:return[0,0]}},fue=(e,t)=>{const[,[n,i]]=t.points;return e==="nw"&&(n<0||i<0)||e==="ne"&&n>=0||e==="sw"&&n<=0||e==="se"&&(n>0||i>0)?"end":"origin"},hue=(e,t,n)=>{if(n)return"center";if(t)switch(e){case"n":return"south-side";case"e":return"west-side";case"s":return"north-side";case"w":return"east-side";case"ne":return"bottom-left";case"nw":return"bottom-right";case"se":return"top-left";case"sw":return"top-right"}return["e","se","s"].includes(e)?"top-left":["n","nw","w"].includes(e)?"bottom-right":e==="ne"?"bottom-left":"top-right"},z4=(e,t,n,i,s,r,o,a,l)=>{const c=hue(o,a,l),[u,d]=e;switch(c){case"top-left":return{x:u+(t-i)/2+(i-t)/2*Math.cos(r)+(n-s)/2*Math.sin(r),y:d+(n-s)/2+(i-t)/2*Math.sin(r)+(s-n)/2*Math.cos(r)};case"top-right":return{x:u+(t-i)/2*(Math.cos(r)+1)+(n-s)/2*Math.sin(r),y:d+(n-s)/2+(t-i)/2*Math.sin(r)+(s-n)/2*Math.cos(r)};case"bottom-left":return{x:u+(t-i)/2*(1-Math.cos(r))+(s-n)/2*Math.sin(r),y:d+(n-s)/2*(Math.cos(r)+1)+(i-t)/2*Math.sin(r)};case"bottom-right":return{x:u+(t-i)/2*(Math.cos(r)+1)+(s-n)/2*Math.sin(r),y:d+(n-s)/2*(Math.cos(r)+1)+(t-i)/2*Math.sin(r)};case"center":return{x:u-(i-t)/2,y:d-(s-n)/2};case"east-side":return{x:u+(t-i)/2*(Math.cos(r)+1),y:d+(t-i)/2*Math.sin(r)+(n-s)/2};case"west-side":return{x:u+(t-i)/2*(1-Math.cos(r)),y:d+(i-t)/2*Math.sin(r)+(n-s)/2};case"north-side":return{x:u+(t-i)/2+(n-s)/2*Math.sin(r),y:d+(s-n)/2*(Math.cos(r)-1)};case"south-side":return{x:u+(t-i)/2+(s-n)/2*Math.sin(r),y:d+(n-s)/2*(Math.cos(r)+1)}}},hm=(e,t,n,i,s,r,o,{shouldInformMutation:a=!0,shouldMaintainAspectRatio:l=!1,shouldResizeFromCenter:c=!1}={})=>{if(de(n)&&de(i))return cue(i,n,r,o,c,e,t);let u={};const d=r.getNonDeletedElementsMap(),f=Re(n,d);if(f){const U=s.get(f.id);if(U&&(u={fontSize:U.fontSize}),l){const b={...n,width:e},y=I_(f,d,Jo(b,f));if(y===null)return;u={fontSize:y.size}}else{const b=ez(gt(f),f.lineHeight),y=tz(f.fontSize,f.lineHeight);e=Math.max(e,b),t=Math.max(t,y)}}const h=T_(i,e,t,!0);let m=x(i.x,i.y);if(Se(i)){const[U,b]=si(i,s);m=x(U,b)}const p=z4(m,i.width,i.height,e,t,i.angle,o,l,c);if(Se(i)&&h.points){const U=i.x-m[0],b=i.y-m[1];p.x+=U,p.y+=b;const y=h.points[0][0],w=h.points[0][1];p.x+=y,p.y+=w,h.points=h.points.map(v=>x(v[0]-y,v[1]-w))}if(e<0&&(p.x=p.x+e),t<0&&(p.y=p.y+t),"scale"in n&&"scale"in i&&r.mutateElement(n,{scale:[(Math.sign(e)||i.scale[0])*i.scale[0],(Math.sign(t)||i.scale[1])*i.scale[1]]}),xe(n)&&f&&l){const U=e/n.width*f.fontSize;if(U<S9)return;u.fontSize=U}if(e!==0&&t!==0&&Number.isFinite(p.x)&&Number.isFinite(p.y)){const U={...p,width:Math.abs(e),height:Math.abs(t),...h};r.mutateElement(n,U,{informMutation:a,isDragging:!1}),f&&u!=null&&r.mutateElement(f,{fontSize:u.fontSize}),Ep(n,r,o,l),Is(n,r,{newSize:{width:e,height:t}})}},gue=(e,t,n,i,s,{shouldMaintainAspectRatio:r=!1,shouldResizeFromCenter:o=!1}={})=>{const[a,l,c,u]=dm(t,t.width,t.height,!0),d=x(a,l),f=x(c,u),h=Yb(d,f),m=q(x(i,s),h,-t.angle),[p,U,b,y]=dm(e,e.width,e.height,!0),w=b-p,v=y-U,I=f[0]-d[0],C=f[1]-d[1];let _=I/w,T=C/v;n.includes("e")&&(_=(m[0]-d[0])/w),n.includes("s")&&(T=(m[1]-d[1])/v),n.includes("w")&&(_=(f[0]-m[0])/w),n.includes("n")&&(T=(f[1]-m[1])/v);let k=e.width*_,S=e.height*T;if(o&&(k=2*k-t.width,S=2*S-t.height),r){const R=Math.abs(k)/t.width,P=Math.abs(S)/t.height;if(n.length===1&&(S*=R,k*=P),n.length===2){const L=Math.max(R,P);k=t.width*L*Math.sign(k),S=t.height*L*Math.sign(S)}}return{nextWidth:k,nextHeight:S}},mue=(e,t,n,i,s,r,{shouldMaintainAspectRatio:o=!1,shouldResizeFromCenter:a=!1}={})=>{const l=e.map(L=>t.get(L.id)),c=l.reduce((L,X)=>{if(!Se(X))return L;const G=Qo(X);if(!G)return L;const z=t.get(G)??null;return zt(z)?[...L,{...z,...pe.getBoundTextElementPosition(X,z,n)}]:L},[]),u=Sr(l.map(L=>L).concat(c)),{minX:d,minY:f,maxX:h,maxY:m,midX:p,midY:U}=u,b=h-d,y=m-f,w={ne:[d,m],se:[d,f],sw:[h,f],nw:[h,m],e:[d,f+y/2],w:[h,f+y/2],n:[d+b/2,m],s:[d+b/2,f]},[v,I]=a?[p,U]:w[i],C=a?2:1,_=Math.max(Math.abs(s-v)/b||0,Math.abs(r-I)/y||0)*C;let T=i.includes("e")||i.includes("w")?Math.abs(s-v)*C:b,k=i.includes("n")||i.includes("s")?Math.abs(r-I)*C:y;o&&(T=b*_*Math.sign(s-v),k=y*_*Math.sign(r-I));const S={ne:[s<v,r>I],se:[s<v,r<I],sw:[s>v,r<I],nw:[s>v,r>I],e:[s<v,!1],w:[s>v,!1],n:[!1,r>I],s:[!1,r<I]},[R,P]=S[i].map(L=>L);return{originalBoundingBox:u,nextWidth:T,nextHeight:k,flipByX:R,flipByY:P}},sH=(e,t,n,i,s,{shouldMaintainAspectRatio:r=!1,shouldResizeFromCenter:o=!1,flipByX:a=!1,flipByY:l=!1,nextHeight:c,nextWidth:u,originalBoundingBox:d}={})=>{if(u===void 0&&c===void 0&&a===void 0&&l===void 0||c===0||u===0)return;s||(s=t);const f=e.reduce((C,_)=>{const T=s.get(_.id);return T&&C.push({orig:T,latest:_}),C},[]);let h;if(d)h=d;else{const C=f.reduce((_,{orig:T})=>{if(!Se(T))return _;const k=Qo(T);if(!k)return _;const S=s.get(k)??null;return zt(S)?[..._,{...S,...pe.getBoundTextElementPosition(T,S,t)}]:_},[]);h=Sr(f.map(({orig:_})=>_).concat(C))}const{minX:m,minY:p,maxX:U,maxY:b,midX:y,midY:w}=h,v=U-m,I=b-p;if(u===void 0&&c===void 0&&(u=v,c=I),r&&(u===void 0?u=c*(v/I):c===void 0?c=u*(I/v):Math.abs(u/c-v/I)>.001&&(u=c*(v/I))),u&&c){let C=n.includes("e")||n.includes("w")?Math.abs(u)/v:1,_=n.includes("n")||n.includes("s")?Math.abs(c)/I:1,T;n.length===1?T=n.includes("e")||n.includes("w")?C:_:T=Math.max(Math.abs(u)/v||0,Math.abs(c)/I||0);const k={ne:[m,b],se:[m,p],sw:[U,p],nw:[U,b],e:[m,p+I/2],w:[U,p+I/2],n:[m+v/2,b],s:[m+v/2,p]},[S,R]=o?[y,w]:k[n],P=r||f.some(V=>V.latest.angle!==0||de(V.latest)||Hh(V.latest));P&&(C=T,_=T);const[L,X]=[a?-1:1,l?-1:1],G=[];for(const{orig:V,latest:$}of f){if(de(V)&&zt(V))continue;const j=V.width*C,W=V.height*_,Q=eo(V.angle*L*X),oe=Se(V)||Zi(V),me=V.x-S,he=V.y-R,Me=a&&!oe?j:0,mt=l&&!oe?W:0,We=S+L*(me*C+Me),Ht=R+X*(he*_+mt),fn=T_(V,j*L,W*X,!1),je={x:We,y:Ht,width:j,height:W,angle:Q,...fn};if(ge(V)&&(V.startBinding&&(je.startBinding={...V.startBinding,fixedPoint:[a?-V.startBinding.fixedPoint[0]+1:V.startBinding.fixedPoint[0],l?-V.startBinding.fixedPoint[1]+1:V.startBinding.fixedPoint[1]]}),V.endBinding&&(je.endBinding={...V.endBinding,fixedPoint:[a?-V.endBinding.fixedPoint[0]+1:V.endBinding.fixedPoint[0],l?-V.endBinding.fixedPoint[1]+1:V.endBinding.fixedPoint[1]]}),V.fixedSegments&&fn.points&&(je.fixedSegments=V.fixedSegments.map(Vt=>({...Vt,start:fn.points[Vt.index-1],end:fn.points[Vt.index]})))),yt(V)&&(je.scale=[V.scale[0]*L,V.scale[1]*X]),de(V)){const Vt=I_(V,t,j);if(!Vt)return;je.fontSize=Vt.size}const lt=s.get(Qo(V)??"");if(lt)if(P){const Vt=lt.fontSize*T;if(Vt<S9)return;je.boundTextFontSize=Vt}else je.boundTextFontSize=lt.fontSize;G.push({element:$,update:je})}const z=G.map(({element:V})=>V);for(const{element:V,update:{boundTextFontSize:$,...j}}of G){const{width:W,height:Q,angle:oe}=j;i.mutateElement(V,j),Is(V,i,{simultaneouslyUpdated:z,newSize:{width:W,height:Q}});const me=Re(V,t);me&&$&&(i.mutateElement(me,{fontSize:$,angle:Se(V)?void 0:oe}),Ep(V,i,n,!0))}i.triggerUpdate()}},_M={mouse:8,pen:16,touch:28},pue=16,rH={e:!0,s:!0,n:!0,w:!0},TM={e:!0,s:!0,n:!0,w:!0,nw:!0,se:!0},O8={e:!0,s:!0,n:!0,w:!0},Ua=(e,t,n,i,s,r,o)=>{const[a,l]=q(x(e+n/2,t+i/2),x(s,r),o);return[a-n/2,l-i/2,n,i]},S_=e=>!(e.viewport.isMobile||e.isTouchScreen&&(QF||I9)),w0=e=>S_(e)?rH:{},x_=([e,t,n,i,s,r],o,a,l,c={},u=4,d=fd)=>{const f=_M[l],h=f/a.value,m=f/a.value,p=f/a.value,U=f/a.value,b=n-e,y=i-t,w=u/a.value,v=(f-d*2)/(2*a.value),I={nw:c.nw?void 0:Ua(e-w-p+v,t-w-U+v,h,m,s,r,o),ne:c.ne?void 0:Ua(n+w-v,t-w-U+v,h,m,s,r,o),sw:c.sw?void 0:Ua(e-w-p+v,i+w-v,h,m,s,r,o),se:c.se?void 0:Ua(n+w-v,i+w-v,h,m,s,r,o),rotation:c.rotation?void 0:Ua(e+b/2-h/2,t-w-U+v-pue/a.value,h,m,s,r,o)},C=5*_M.mouse/a.value;return Math.abs(b)>C&&(c.n||(I.n=Ua(e+b/2-h/2,t-w-U+v,h,m,s,r,o)),c.s||(I.s=Ua(e+b/2-h/2,i+w-v,h,m,s,r,o))),Math.abs(y)>C&&(c.w||(I.w=Ua(e-w-p+v,t+y/2-m/2,h,m,s,r,o)),c.e||(I.e=Ua(n+w-v,t+y/2-m/2,h,m,s,r,o))),I},oH=(e,t,n,i="mouse",s=rH)=>{if(e.locked||ge(e))return{};if(e.type==="freedraw"||Se(e)){if(e.points.length===2){const[,o]=e.points;o[0]===0||o[1]===0?s=O8:o[0]>0&&o[1]<0?s=TM:o[0]>0&&o[1]>0?s=O8:o[0]<0&&o[1]>0?s=TM:o[0]<0&&o[1]<0&&(s=O8)}}else Ee(e)&&(s={...s,rotation:!0});const r=Se(e)?fd+8:yt(e)?0:fd;return x_(ze(e,n,!0),e.angle,t,i,s,r,yt(e)?0:void 0)},aH=(e,t)=>{var i;if((i=t.selectedLinearElement)!=null&&i.isEditing)return!1;if(e.length>1)return!0;const n=e[0];return ge(n)?!1:Se(n)?n.points.length>2&&!vo():!0},H4=(e,t,n)=>t>=e[0]&&t<=e[0]+e[2]&&n>=e[1]&&n<=e[1]+e[3],Uue=(e,t,n,i,s,r,o,a)=>{if(!n.selectedElementIds[e.id])return!1;const{rotation:l,...c}=oH(e,r,t,o,w0(a));if(l&&H4(l,i,s))return"rotation";const u=Object.keys(c).filter(d=>{const f=c[d];return f?H4(f,i,s):!1});if(u.length>0)return u[0];if(S_(a)){const[d,f,h,m,p,U]=ze(e,t);if(!(Se(e)&&e.points.length<=2)){const b=yt(e)?0:Hb/r.value,y=Hb/r.value,w=lH(x(d-b,f-b),x(h+b,m+b),x(p,U),e.angle);for(const[v,I]of Object.entries(w))if(Wb(x(i,s),I,y))return v}}return!1},IM=(e,t,n,i,s,r,o,a)=>e.reduce((l,c)=>{if(l)return l;const u=Uue(c,o,t,n,i,s,r,a);return u?{element:c,transformHandleType:u}:null},null),SM=([e,t,n,i],s,r,o,a,l)=>{const c=x_([e,t,n,i,(e+n)/2,(t+i)/2],0,o,a,w0(l)),u=Object.keys(c).find(d=>{const f=c[d];return f&&H4(f,s,r)});if(u)return u;if(S_(l)){const d=(e+n)/2,f=(t+i)/2,h=Hb/o.value,m=lH(x(e-h,t-h),x(n+h,i+h),x(d,f),0);for(const[p,U]of Object.entries(m))if(Wb(x(s,r),U,h))return p}return!1},P8=["ns","nesw","ew","nwse"],bue=(e,t)=>{const n=P8.indexOf(e);if(n>=0){const i=Math.round(t/(Math.PI/4));e=P8[(n+i)%P8.length]}return e},xM=e=>{const{element:t,transformHandleType:n}=e,i=t&&Math.sign(t.height)*Math.sign(t.width)===-1;let s=null;switch(n){case"n":case"s":s="ns";break;case"w":case"e":s="ew";break;case"nw":case"se":i?s="nesw":s="nwse";break;case"ne":case"sw":i?s="nwse":s="nesw";break;case"rotation":return"grab"}return s&&t&&(s=bue(s,t.angle)),s?`${s}-resize`:""},lH=([e,t],[n,i],s,r)=>{const o=q(x(e,t),s,r),a=q(x(n,t),s,r),l=q(x(e,i),s,r),c=q(x(n,i),s,r);return{n:[o,a],e:[a,c],s:[c,l],w:[l,o]}},yue=(e,t)=>{var n;return!!(!e.viewModeEnabled&&((n=e.openDialog)==null?void 0:n.name)!=="elementLinkSelector"&&(e.activeTool.type!=="custom"&&(e.editingTextElement||e.activeTool.type!=="selection"&&e.activeTool.type!=="lasso"&&e.activeTool.type!=="eraser"&&e.activeTool.type!=="hand"&&e.activeTool.type!=="laser")||Ve(t,e).length))},V4=(e,t)=>e.frameId===t||e.id===t,cH=(e,t,n)=>{let i=[],s=[],r=null,o=-1;const a=ve(n||Ve(e,t,{includeBoundTextElement:!0,includeElementsInFrames:!0}));for(;++o<e.length;){const l=e[o];a.get(l.id)?(s.length&&(i=i.concat(s),s=[]),i.push(o),r=o+1):l.isDeleted&&r===o?(r=o+1,s.push(o)):s=[]}return i},Eue=e=>{let t=0;return e.reduce((n,i,s)=>(s>0&&e[s-1]!==i-1&&(t=++t),(n[t]||(n[t]=[])).push(i),n),[])},CM=(e,t,n,i)=>{var s,r;if("containerId"in e&&e.containerId){const o=i.getElement(e.containerId);if(o)return n==="left"?Math.min(t.indexOf(o),t.indexOf(e)):Math.max(t.indexOf(o),t.indexOf(e))}else{const o=(r=(s=e.boundElements)==null?void 0:s.find(a=>a.type!=="arrow"))==null?void 0:r.id;if(o){const a=i.getElement(o);if(a)return n==="left"?Math.min(t.indexOf(a),t.indexOf(e)):Math.max(t.indexOf(a),t.indexOf(e))}}},vue=(e,t)=>{let n=-1,i=-1;return e.forEach((s,r)=>{V4(s,t)&&(n===-1&&(n=r),i=r)}),n===-1?[]:e.slice(n,i+1)},wue=(e,t,n,i,s,r)=>{const o=t[n],a=f=>f.isDeleted?!1:s?f.frameId===s:e.editingGroupId?f.groupIds.includes(e.editingGroupId):!0,l=i==="left"?Su(t,f=>a(f),Math.max(0,n-1)):xB(t,f=>a(f),n+1),c=t[l];if(!c)return-1;if(e.editingGroupId){if((o==null?void 0:o.groupIds.join(""))===(c==null?void 0:c.groupIds.join("")))return CM(c,t,i,r)??l;if(!(c!=null&&c.groupIds.includes(e.editingGroupId)))return-1}if(!s&&(c.frameId||Ee(c))){const f=vue(t,c.frameId||c.id);return i==="left"?t.indexOf(f[0]):t.indexOf(f[f.length-1])}if(!c.groupIds.length)return CM(c,t,i,r)??l;const u=e.editingGroupId?c.groupIds[c.groupIds.indexOf(e.editingGroupId)-1]:c.groupIds[c.groupIds.length-1],d=Ct(t,u);return d.length?i==="left"?t.indexOf(d[0]):t.indexOf(d[d.length-1]):l},uH=(e,t)=>t.reduce((n,i)=>{const s=e[i];return n.set(s.id,s),n},new Map),dH=(e,t,n,i)=>{const s=cH(e,t),r=uH(e,s);let o=Eue(s);n==="right"&&(o=o.reverse());const a=new Set(s.filter(l=>Ee(e[l])).map(l=>e[l].id));return o.forEach((l,c)=>{var w;const u=l[0],d=l[l.length-1],f=n==="left"?u:d,h=l.some(v=>{const I=e[v];return I.frameId&&a.has(I.frameId)})?null:(w=e[f])==null?void 0:w.frameId,m=wue(t,e,f,n,h,i);if(m===-1||f===m)return;const p=n==="left"?e.slice(0,m):e.slice(0,u),U=e.slice(u,d+1),b=n==="left"?e.slice(m,u):e.slice(d+1,m+1),y=n==="left"?e.slice(d+1):e.slice(m+1);e=n==="left"?[...p,...U,...b,...y]:[...p,...b,...U,...y]}),oo(e,r),e},fH=(e,t,n,i,s)=>{const r=cH(e,t,s),o=uH(e,r),a=[];let l,c;if(n==="left"){if(i)l=xB(e,m=>V4(m,i));else if(t.editingGroupId){const m=Ct(e,t.editingGroupId);if(!m.length)return e;l=e.indexOf(m[0])}else l=0;c=r[r.length-1]}else{if(i)c=Su(e,m=>V4(m,i));else if(t.editingGroupId){const m=Ct(e,t.editingGroupId);if(!m.length)return e;c=e.indexOf(m[m.length-1])}else c=e.length-1;l=r[0]}l===-1&&(l=0);for(let m=l;m<c+1;m++)r.includes(m)||a.push(e[m]);const u=Array.from(o.values()),d=e.slice(0,l),f=e.slice(c+1),h=n==="left"?[...d,...u,...a,...f]:[...d,...a,...u,...f];return oo(h,o),h};function hH(e,t,n,i){const s=ve(Ve(e,t,{includeBoundTextElement:!0,includeElementsInFrames:!0})),r={regularElements:[],frameChildren:new Map},o=new Set;for(const c of e)s.has(c.id)&&Ee(c)&&o.add(c.id);for(const c of e)if(s.has(c.id))if(Ee(c)||c.frameId&&o.has(c.frameId))r.regularElements.push(c);else if(!c.frameId)r.regularElements.push(c);else{const u=r.frameChildren.get(c.frameId)||[];u.push(c),r.frameChildren.set(c.frameId,u)}let a=e;const l=Array.from(r.frameChildren.entries());for(const[c,u]of l)a=i(e,t,n,c,u);return i(a,t,n,null,r.regularElements)}const _ue=(e,t,n)=>dH(e,t,"left",n),Tue=(e,t,n)=>dH(e,t,"right",n),Iue=(e,t)=>hH(e,t,"left",fH),Sue=(e,t)=>hH(e,t,"right",fH),Jl=e=>e.reduce((t,n)=>t+n.version,0),gH=e=>{let t=5381;for(const n of Xl(e))t=(t<<5)+t+n.versionNonce;return t>>>0},C_=e=>{let t=5381;for(let n=0;n<e.length;n++){const i=e.charCodeAt(n);t=(t<<5)+t+i}return t>>>0},xue=e=>e.filter(t=>!t.isDeleted&&!qa(t)),jt=e=>e.filter(t=>!t.isDeleted),$4=e=>!e.isDeleted,A_=e=>jt(e).map(t=>W9(t.type)?{...t,lastCommittedPoint:null}:t),Cue=e=>A_(e),mH=e=>A_(e),pH=e=>A_(e),Aue=(e,t)=>{const n=e[t];return n?typeof n=="function"?n():Promise.resolve(n):new Promise((i,s)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(s.bind(null,new Error("Unknown variable dynamic import: "+t)))})};var ll={};let Mue=0;function Yt(e,t){const n=`atom${++Mue}`,i={toString(){return(ll?"production":void 0)!=="production"&&this.debugLabel?n+":"+this.debugLabel:n}};return typeof e=="function"?i.read=e:(i.init=e,i.read=kue,i.write=Rue),i}function kue(e){return e(this)}function Rue(e,t,n){return t(this,typeof n=="function"?n(e(this)):n)}const AM=(e,t)=>e.unstable_is?e.unstable_is(t):t===e,G4=e=>"init"in e,F8=e=>!!e.write,I6=new WeakMap,X4=e=>{var t;return j4(e)&&!((t=I6.get(e))!=null&&t[1])},Due=(e,t)=>{const n=I6.get(e);if(n)n[1]=!0,n[0].forEach(i=>i(t));else if((ll?"production":void 0)!=="production")throw new Error("[Bug] cancelable promise not found")},Lue=e=>{if(I6.has(e))return;const t=[new Set,!1];I6.set(e,t);const n=()=>{t[1]=!0};e.then(n,n),e.onCancel=i=>{t[0].add(i)}},j4=e=>typeof(e==null?void 0:e.then)=="function",MM=e=>"v"in e||"e"in e,FU=e=>{if("e"in e)throw e.e;if((ll?"production":void 0)!=="production"&&!("v"in e))throw new Error("[Bug] atom state is not initialized");return e.v},UH=(e,t,n)=>{n.p.has(e)||(n.p.add(e),t.then(()=>{n.p.delete(e)},()=>{n.p.delete(e)}))},kM=(e,t,n,i,s)=>{var r;if((ll?"production":void 0)!=="production"&&i===t)throw new Error("[Bug] atom cannot depend on itself");n.d.set(i,s.n),X4(n.v)&&UH(t,n.v,s),(r=s.m)==null||r.t.add(t),e&&Nue(e,i,t)},d1=()=>({D:new Map,H:new Set,M:new Set,L:new Set}),_0=(e,t,n)=>{e[t].add(n)},RM=(e,t,n)=>{e.D.has(t)||(e.D.set(t,new Set),_0(e,"M",()=>{var i;(i=n.m)==null||i.l.forEach(s=>_0(e,"M",s))}))},Nue=(e,t,n)=>{const i=e.D.get(t);i&&i.add(n)},Oue=(e,t)=>e.D.get(t),mu=e=>{let t,n=!1;const i=s=>{try{s()}catch(r){n||(t=r,n=!0)}};for(;e.H.size||e.M.size||e.L.size;)e.D.clear(),e.H.forEach(i),e.H.clear(),e.M.forEach(i),e.M.clear(),e.L.forEach(i),e.L.clear();if(n)throw t},bH=(...[e,t,n,i])=>{const s=(b,y,w)=>{const v="v"in y,I=y.v,C=X4(y.v)?y.v:null;if(j4(w)){Lue(w);for(const _ of y.d.keys())UH(b,w,e(_));y.v=w}else y.v=w;delete y.e,delete y.x,(!v||!Object.is(I,y.v))&&(++y.n,C&&Due(C,w))},r=(b,y)=>{var w;const v=e(y);if(MM(v)&&(v.m&&!v.x||Array.from(v.d).every(([S,R])=>r(b,S).n===R)))return v;v.d.clear();let I=!0;const C=S=>{if(AM(y,S)){const P=e(S);if(!MM(P))if(G4(S))s(S,P,S.init);else throw new Error("no atom init");return FU(P)}const R=r(b,S);try{return FU(R)}finally{if(I)kM(b,y,v,S,R);else{const P=d1();kM(P,y,v,S,R),d(P,y,v),mu(P)}}};let _,T;const k={get signal(){return _||(_=new AbortController),_.signal},get setSelf(){return(ll?"production":void 0)!=="production"&&!F8(y)&&console.warn("setSelf function cannot be used with read-only atom"),!T&&F8(y)&&(T=(...S)=>{if((ll?"production":void 0)!=="production"&&I&&console.warn("setSelf function cannot be called in sync"),!I)return u(y,...S)}),T}};try{const S=t(y,C,k);if(s(y,v,S),j4(S)){(w=S.onCancel)==null||w.call(S,()=>_==null?void 0:_.abort());const R=()=>{if(v.m){const P=d1();d(P,y,v),mu(P)}};S.then(R,R)}return v}catch(S){return delete v.v,v.e=S,delete v.x,++v.n,v}finally{I=!1}},o=b=>FU(r(void 0,b)),a=(b,y,w)=>{var v,I;const C=new Map;for(const _ of((v=w.m)==null?void 0:v.t)||[]){const T=e(_);T.m&&C.set(_,T)}for(const _ of w.p)C.set(_,e(_));return(I=Oue(b,y))==null||I.forEach(_=>{C.set(_,e(_))}),C},l=(b,y,w)=>{const v=[],I=new Set,C=new Set,_=[[y,w]];for(;_.length>0;){const[T,k]=_[_.length-1];if(C.has(T)){_.pop();continue}if(I.has(T)){v.push([T,k,k.n]),C.add(T),k.x=!0,_.pop();continue}I.add(T);for(const[S,R]of a(b,T,k))T!==S&&!I.has(S)&&_.push([S,R])}_0(b,"H",()=>{const T=new Set([y]);for(let k=v.length-1;k>=0;--k){const[S,R,P]=v[k];let L=!1;for(const X of R.d.keys())if(X!==S&&T.has(X)){L=!0;break}L&&(r(b,S),d(b,S,R),P!==R.n&&(RM(b,S,R),T.add(S))),delete R.x}})},c=(b,y,...w)=>{let v=!0;const I=_=>FU(r(b,_)),C=(_,...T)=>{const k=e(_);try{if(AM(y,_)){if(!G4(_))throw new Error("atom not writable");const S=k.n,R=T[0];s(_,k,R),d(b,_,k),S!==k.n&&(RM(b,_,k),l(b,_,k));return}else return c(b,_,...T)}finally{v||mu(b)}};try{return n(y,I,C,...w)}finally{v=!1}},u=(b,...y)=>{const w=d1();try{return c(w,b,...y)}finally{mu(w)}},d=(b,y,w)=>{if(w.m&&!X4(w.v)){for(const v of w.d.keys())w.m.d.has(v)||(f(b,v,e(v)).t.add(y),w.m.d.add(v));for(const v of w.m.d||[])if(!w.d.has(v)){w.m.d.delete(v);const I=h(b,v,e(v));I==null||I.t.delete(y)}}},f=(b,y,w)=>{if(!w.m){r(b,y);for(const v of w.d.keys())f(b,v,e(v)).t.add(y);if(w.m={l:new Set,d:new Set(w.d.keys()),t:new Set},F8(y)){const v=w.m;let I;const C=(_,T)=>{let k=!0;I=(...S)=>{try{return c(_,y,...S)}finally{k||mu(_)}};try{return T()}finally{k=!1}};_0(b,"L",()=>{const _=C(b,()=>i(y,(...T)=>I(...T)));_&&(v.u=T=>C(T,_))})}}return w.m},h=(b,y,w)=>{if(w.m&&!w.m.l.size&&!Array.from(w.m.t).some(v=>{var I;return(I=e(v).m)==null?void 0:I.d.has(y)})){const v=w.m.u;v&&_0(b,"L",()=>v(b)),delete w.m;for(const I of w.d.keys()){const C=h(b,I,e(I));C==null||C.t.delete(y)}return}return w.m};return{get:o,set:u,sub:(b,y)=>{const w=d1(),v=e(b),C=f(w,b,v).l;return C.add(y),mu(w),()=>{C.delete(y);const _=d1();h(_,b,v),mu(_)}},unstable_derive:b=>bH(...b(e,t,n,i))}},Pue=e=>{const t=new WeakMap,n=new Set;let i,s=0;const r=e.unstable_derive((l,c,u,d)=>(i=l,[f=>{let h=t.get(f);if(!h){const m=l(f);h=new Proxy(m,{set(p,U,b){return U==="m"&&n.add(f),Reflect.set(p,U,b)},deleteProperty(p,U){return U==="m"&&n.delete(f),Reflect.deleteProperty(p,U)}}),t.set(f,h)}return h},c,(f,h,m,...p)=>s?m(f,...p):u(f,h,m,...p),d])),o=r.set;return Object.assign(r,{dev4_get_internal_weak_map:()=>({get:l=>{const c=i(l);if(c.n!==0)return c}}),dev4_get_mounted_atoms:()=>n,dev4_restore_atoms:l=>{o({read:()=>null,write:(u,d)=>{++s;try{for(const[f,h]of l)G4(f)&&d(f,h)}finally{--s}}})}})},Ip=()=>{const e=new WeakMap,n=bH(i=>{if((ll?"production":void 0)!=="production"&&!i)throw new Error("Atom is undefined or null");let s=e.get(i);return s||(s={d:new Map,p:new Set,n:0},e.set(i,s)),s},(i,...s)=>i.read(...s),(i,...s)=>i.write(...s),(i,...s)=>{var r;return(r=i.onMount)==null?void 0:r.call(i,...s)});return(ll?"production":void 0)!=="production"?Pue(n):n};let f1;const Fue=()=>(f1||(f1=Ip(),(ll?"production":void 0)!=="production"&&(globalThis.__JOTAI_DEFAULT_STORE__||(globalThis.__JOTAI_DEFAULT_STORE__=f1),globalThis.__JOTAI_DEFAULT_STORE__!==f1&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044"))),f1);var yH={};const EH=D.createContext(void 0),sy=e=>{const t=D.useContext(EH);return(e==null?void 0:e.store)||t||Fue()},Bue=({children:e,store:t})=>{const n=D.useRef(void 0);return!t&&!n.current&&(n.current=Ip()),D.createElement(EH.Provider,{value:t||n.current},e)},Y4=e=>typeof(e==null?void 0:e.then)=="function",vH=e=>{e.status="pending",e.then(t=>{e.status="fulfilled",e.value=t},t=>{e.status="rejected",e.reason=t})},zue=ae.use||(e=>{if(e.status==="pending")throw e;if(e.status==="fulfilled")return e.value;throw e.status==="rejected"?e.reason:(vH(e),e)}),B8=new WeakMap,DM=e=>{let t=B8.get(e);return t||(t=new Promise((n,i)=>{let s=e;const r=l=>c=>{s===l&&n(c)},o=l=>c=>{s===l&&i(c)},a=l=>{"onCancel"in l&&typeof l.onCancel=="function"&&l.onCancel(c=>{if((yH?"production":void 0)!=="production"&&c===l)throw new Error("[Bug] p is not updated even after cancelation");Y4(c)?(B8.set(c,t),s=c,c.then(r(c),o(c)),a(c)):n(c)})};e.then(r(e),o(e)),a(e)}),B8.set(e,t)),t};function fh(e,t){const n=sy(t),[[i,s,r],o]=D.useReducer(c=>{const u=n.get(e);return Object.is(c[0],u)&&c[1]===n&&c[2]===e?c:[u,n,e]},void 0,()=>[n.get(e),n,e]);let a=i;(s!==n||r!==e)&&(o(),a=n.get(e));const l=t==null?void 0:t.delay;if(D.useEffect(()=>{const c=n.sub(e,()=>{if(typeof l=="number"){const u=n.get(e);Y4(u)&&vH(DM(u)),setTimeout(o,l);return}o()});return o(),c},[n,e,l]),D.useDebugValue(a),Y4(a)){const c=DM(a);return zue(c)}return a}function M_(e,t){const n=sy(t);return D.useCallback((...s)=>{if((yH?"production":void 0)!=="production"&&!("write"in e))throw new Error("not writable atom");return n.set(e,...s)},[n,e])}function $h(e,t){return[fh(e,t),M_(e,t)]}const LM=new WeakMap;function Hue(e,t){const n=sy(t),i=Vue(n);for(const[s,r]of e)(!i.has(s)||t!=null&&t.dangerouslyForceHydrate)&&(i.add(s),n.set(s,r))}const Vue=e=>{let t=LM.get(e);return t||(t=new WeakSet,LM.set(e,t)),t};function Yf(){return Yf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Yf.apply(this,arguments)}function wH(){const e=D.createContext(null);function t({store:o,initialValues:a=[],children:l}){const c=D.useRef(o);return c.current||(c.current=Ip()),Hue(a,{store:c.current}),g(e.Provider,{value:c.current,children:l})}const n=o=>{const a=D.useContext(e);if(!a)throw new Error("Missing Provider from createIsolation");return sy(Yf({store:a},o))};return{Provider:t,useStore:n,useAtom:(o,a)=>{const l=n();return $h(o,Yf({store:l},a))},useAtomValue:(o,a)=>{const l=n();return fh(o,Yf({store:l},a))},useSetAtom:(o,a)=>{const l=n();return M_(o,Yf({store:l},a))}}}const{read:LCe,write:NCe}=Yt(null);D.createContext({scope:void 0,baseStore:void 0});const _H=wH(),{useAtom:un,useSetAtom:ry,useAtomValue:TH,useStore:OCe}=_H,$ue=_H.Provider,Hs=Ip(),IH={paste:"Paste",pasteAsPlaintext:"Paste as plaintext",pasteCharts:"Paste charts",selectAll:"Select all",multiSelect:"Add element to selection",moveCanvas:"Move canvas",cut:"Cut",copy:"Copy",copyAsPng:"Copy to clipboard as PNG",copyAsSvg:"Copy to clipboard as SVG",copyText:"Copy to clipboard as text",copySource:"Copy source to clipboard",convertToCode:"Convert to code",bringForward:"Bring forward",sendToBack:"Send to back",bringToFront:"Bring to front",sendBackward:"Send backward",delete:"Delete",copyStyles:"Copy styles",pasteStyles:"Paste styles",stroke:"Stroke",changeStroke:"Change stroke color",background:"Background",changeBackground:"Change background color",fill:"Fill",strokeWidth:"Stroke width",strokeStyle:"Stroke style",strokeStyle_solid:"Solid",strokeStyle_dashed:"Dashed",strokeStyle_dotted:"Dotted",sloppiness:"Sloppiness",opacity:"Opacity",textAlign:"Text align",edges:"Edges",sharp:"Sharp",round:"Round",arrowheads:"Arrowheads",arrowhead_none:"None",arrowhead_arrow:"Arrow",arrowhead_bar:"Bar",arrowhead_circle:"Circle",arrowhead_circle_outline:"Circle (outline)",arrowhead_triangle:"Triangle",arrowhead_triangle_outline:"Triangle (outline)",arrowhead_diamond:"Diamond",arrowhead_diamond_outline:"Diamond (outline)",arrowhead_crowfoot_many:"Crow's foot (many)",arrowhead_crowfoot_one:"Crow's foot (one)",arrowhead_crowfoot_one_or_many:"Crow's foot (one or many)",more_options:"More options",arrowtypes:"Arrow type",arrowtype_sharp:"Sharp arrow",arrowtype_round:"Curved arrow",arrowtype_elbowed:"Elbow arrow",fontSize:"Font size",fontFamily:"Font family",addWatermark:'Add "Made with Excalidraw"',handDrawn:"Hand-drawn",normal:"Normal",code:"Code",small:"Small",medium:"Medium",large:"Large",veryLarge:"Very large",solid:"Solid",hachure:"Hachure",zigzag:"Zigzag",crossHatch:"Cross-hatch",thin:"Thin",bold:"Bold",left:"Left",center:"Center",right:"Right",extraBold:"Extra bold",architect:"Architect",artist:"Artist",cartoonist:"Cartoonist",fileTitle:"File name",colorPicker:"Color picker",canvasColors:"Used on canvas",canvasBackground:"Canvas background",drawingCanvas:"Drawing canvas",clearCanvas:"Clear canvas",layers:"Layers",actions:"Actions",language:"Language",liveCollaboration:"Live collaboration...",duplicateSelection:"Duplicate",untitled:"Untitled",name:"Name",yourName:"Your name",madeWithExcalidraw:"Made with Excalidraw",group:"Group selection",ungroup:"Ungroup selection",collaborators:"Collaborators",toggleGrid:"Toggle grid",addToLibrary:"Add to library",removeFromLibrary:"Remove from library",libraryLoadingMessage:"Loading library",libraries:"Browse libraries",loadingScene:"Loading scene",loadScene:"Load scene from file",align:"Align",alignTop:"Align top",alignBottom:"Align bottom",alignLeft:"Align left",alignRight:"Align right",centerVertically:"Center vertically",centerHorizontally:"Center horizontally",distributeHorizontally:"Distribute horizontally",distributeVertically:"Distribute vertically",flipHorizontal:"Flip horizontal",flipVertical:"Flip vertical",viewMode:"View mode",share:"Share",showStroke:"Show stroke color picker",showBackground:"Show background color picker",showFonts:"Show font picker",toggleTheme:"Toggle light/dark theme",theme:"Theme",personalLib:"Personal Library",excalidrawLib:"Excalidraw Library",decreaseFontSize:"Decrease font size",increaseFontSize:"Increase font size",unbindText:"Unbind text",bindText:"Bind text to the container",createContainerFromText:"Wrap text in a container",link:{edit:"Edit link",editEmbed:"Edit embeddable link",create:"Add link",label:"Link",labelEmbed:"Link & embed",empty:"No link is set",hint:"Type or paste your link here",goToElement:"Go to target element"},lineEditor:{edit:"Edit line",editArrow:"Edit arrow"},polygon:{breakPolygon:"Break polygon",convertToPolygon:"Convert to polygon"},elementLock:{lock:"Lock",unlock:"Unlock",lockAll:"Lock all",unlockAll:"Unlock all"},statusPublished:"Published",sidebarLock:"Keep sidebar open",selectAllElementsInFrame:"Select all elements in frame",removeAllElementsFromFrame:"Remove all elements from frame",eyeDropper:"Pick color from canvas",textToDiagram:"Text to diagram",prompt:"Prompt",followUs:"Follow us",discordChat:"Discord chat",zoomToFitViewport:"Zoom to fit in viewport",zoomToFitSelection:"Zoom to fit selection",zoomToFit:"Zoom to fit all elements",installPWA:"Install Excalidraw locally (PWA)",autoResize:"Enable text auto-resizing",imageCropping:"Image cropping",unCroppedDimension:"Uncropped dimension",copyElementLink:"Copy link to object",linkToElement:"Link to object",wrapSelectionInFrame:"Wrap selection in frame",tab:"Tab",shapeSwitch:"Switch shape"},SH={title:"Link to object",desc:"Click on a shape on canvas or paste a link.",notFound:"Linked object wasn't found on canvas."},xH={noItems:"No items added yet...",hint_emptyLibrary:"Select an item on canvas to add it here, or install a library from the public repository, below.",hint_emptyPrivateLibrary:"Select an item on canvas to add it here.",search:{inputPlaceholder:"Search library",heading:"Library matches",noResults:"No matching items found...",clearSearch:"Clear search"}},CH={title:"Find on canvas",noMatch:"No matches found...",singleResult:"result",multipleResults:"results",placeholder:"Find text on canvas...",frames:"Frames",texts:"Texts"},AH={clearReset:"Reset the canvas",exportJSON:"Export to file",exportImage:"Export image...",export:"Save to...",copyToClipboard:"Copy to clipboard",copyLink:"Copy link",save:"Save to current file",saveAs:"Save as",load:"Open",getShareableLink:"Get shareable link",close:"Close",selectLanguage:"Select language",scrollBackToContent:"Scroll back to content",zoomIn:"Zoom in",zoomOut:"Zoom out",resetZoom:"Reset zoom",menu:"Menu",done:"Done",edit:"Edit",undo:"Undo",redo:"Redo",resetLibrary:"Reset library",createNewRoom:"Create new room",fullScreen:"Full screen",darkMode:"Dark mode",lightMode:"Light mode",systemMode:"System mode",zenMode:"Zen mode",objectsSnapMode:"Snap to objects",exitZenMode:"Exit zen mode",cancel:"Cancel",saveLibNames:"Save name(s) and exit",clear:"Clear",remove:"Remove",embed:"Toggle embedding",publishLibrary:"Rename or publish",submit:"Submit",confirm:"Confirm",embeddableInteractionButton:"Click to interact"},MH={clearReset:"This will clear the whole canvas. Are you sure?",couldNotCreateShareableLink:"Couldn't create shareable link.",couldNotCreateShareableLinkTooBig:"Couldn't create shareable link: the scene is too big",couldNotLoadInvalidFile:"Couldn't load invalid file",importBackendFailed:"Importing from backend failed.",cannotExportEmptyCanvas:"Cannot export empty canvas.",couldNotCopyToClipboard:"Couldn't copy to clipboard.",decryptFailed:"Couldn't decrypt data.",uploadedSecurly:"The upload has been secured with end-to-end encryption, which means that Excalidraw server and third parties can't read the content.",loadSceneOverridePrompt:"Loading external drawing will replace your existing content. Do you wish to continue?",collabStopOverridePrompt:`Stopping the session will overwrite your previous, locally stored drawing. Are you sure?

(If you want to keep your local drawing, simply close the browser tab instead.)`,errorAddingToLibrary:"Couldn't add item to the library",errorRemovingFromLibrary:"Couldn't remove item from the library",confirmAddLibrary:"This will add {{numShapes}} shape(s) to your library. Are you sure?",imageDoesNotContainScene:"This image does not seem to contain any scene data. Have you enabled scene embedding during export?",cannotRestoreFromImage:"Scene couldn't be restored from this image file",invalidSceneUrl:"Couldn't import scene from the supplied URL. It's either malformed, or doesn't contain valid Excalidraw JSON data.",resetLibrary:"This will clear your library. Are you sure?",removeItemsFromsLibrary:"Delete {{count}} item(s) from library?",invalidEncryptionKey:"Encryption key must be of 22 characters. Live collaboration is disabled.",collabOfflineWarning:`No internet connection available.
Your changes will not be saved!`,localStorageQuotaExceeded:"Browser storage quota exceeded. Changes will not be saved."},kH={unsupportedFileType:"Unsupported file type.",imageInsertError:"Couldn't insert image. Try again later...",fileTooBig:"File is too big. Maximum allowed size is {{maxSize}}.",svgImageInsertError:"Couldn't insert SVG image. The SVG markup looks invalid.",failedToFetchImage:"Failed to fetch image.",cannotResolveCollabServer:"Couldn't connect to the collab server. Please reload the page and try again.",importLibraryError:"Couldn't load library",saveLibraryError:"Couldn't save library to storage. Please save your library to a file locally to make sure you don't lose changes.",collabSaveFailed:"Couldn't save to the backend database. If problems persist, you should save your file locally to ensure you don't lose your work.",collabSaveFailed_sizeExceeded:"Couldn't save to the backend database, the canvas seems to be too big. You should save the file locally to ensure you don't lose your work.",imageToolNotSupported:"Images are disabled.",brave_measure_text_error:{line1:"Looks like you are using Brave browser with the <bold>Aggressively Block Fingerprinting</bold> setting enabled.",line2:"This could result in breaking the <bold>Text Elements</bold> in your drawings.",line3:"We strongly recommend disabling this setting. You can follow <link>these steps</link> on how to do so.",line4:"If disabling this setting doesn't fix the display of text elements, please open an <issueLink>issue</issueLink> on our GitHub, or write us on <discordLink>Discord</discordLink>"},libraryElementTypeError:{embeddable:"Embeddable elements cannot be added to the library.",iframe:"IFrame elements cannot be added to the library.",image:"Support for adding images to the library coming soon!"},asyncPasteFailedOnRead:"Couldn't paste (couldn't read from system clipboard).",asyncPasteFailedOnParse:"Couldn't paste.",copyToSystemClipboardFailed:"Couldn't copy to clipboard."},RH={selection:"Selection",lasso:"Lasso selection",image:"Insert image",rectangle:"Rectangle",diamond:"Diamond",ellipse:"Ellipse",arrow:"Arrow",line:"Line",freedraw:"Draw",text:"Text",library:"Library",lock:"Keep selected tool active after drawing",penMode:"Pen mode - prevent touch",link:"Add / Update link for a selected shape",eraser:"Eraser",frame:"Frame tool",magicframe:"Wireframe to code",embeddable:"Web Embed",laser:"Laser pointer",hand:"Hand (panning tool)",extraTools:"More tools",mermaidToExcalidraw:"Mermaid to Excalidraw",convertElementType:"Toggle shape type"},DH={rectangle:"Rectangle",diamond:"Diamond",ellipse:"Ellipse",arrow:"Arrow",line:"Line",freedraw:"Freedraw",text:"Text",image:"Image",group:"Group",frame:"Frame",magicframe:"Wireframe to code",embeddable:"Web Embed",selection:"Selection",iframe:"IFrame"},LH={canvasActions:"Canvas actions",selectedShapeActions:"Selected shape actions",shapes:"Shapes"},NH={dismissSearch:"{{shortcut}} to dismiss search",canvasPanning:"To move canvas, hold {{shortcut_1}} or {{shortcut_2}} while dragging, or use the hand tool",linearElement:"Click to start multiple points, drag for single line",arrowTool:"Click to start multiple points, drag for single line. Press {{shortcut}} again to change arrow type.",freeDraw:"Click and drag, release when you're finished",text:"Tip: you can also add text by double-clicking anywhere with the selection tool",embeddable:"Click-drag to create a website embed",text_selected:"Double-click or press {{shortcut}} to edit text",text_editing:"Press {{shortcut_1}} or {{shortcut_2}} to finish editing",linearElementMulti:"Click on last point or press {{shortcut_1}} or {{shortcut_2}} to finish",lockAngle:"You can constrain angle by holding {{shortcut}}",resize:`You can constrain proportions by holding {{shortcut_1}} while resizing,
hold {{shortcut_2}} to resize from the center`,resizeImage:`You can resize freely by holding {{shortcut_1}},
hold {{shortcut_2}} to resize from the center`,rotate:"You can constrain angles by holding {{shortcut}} while rotating",lineEditor_info:"Hold {{shortcut_1}} and Double-click or press {{shortcut_2}} to edit points",lineEditor_line_info:"Double-click or press {{shortcut}} to edit points",lineEditor_pointSelected:`Press {{shortcut_1}} to remove point(s),
{{shortcut_2}} to duplicate, or drag to move`,lineEditor_nothingSelected:`Select a point to edit (hold {{shortcut_1}} to select multiple),
or hold {{shortcut_2}} and click to add new points`,publishLibrary:"Publish your own library",bindTextToElement:"{{shortcut}} to add text",createFlowchart:"{{shortcut}} to create a flowchart",deepBoxSelect:"Hold {{shortcut}} to deep select, and to prevent dragging",eraserRevert:"Hold {{shortcut}} to revert the elements marked for deletion",firefox_clipboard_write:'This feature can likely be enabled by setting the "dom.events.asyncClipboard.clipboardItem" flag to "true". To change the browser flags in Firefox, visit the "about:config" page.',disableSnapping:"Hold {{shortcut}} to disable snapping",enterCropEditor:"Double click the image or press {{shortcut}} to crop the image",leaveCropEditor:"Click outside the image or press {{shortcut_1}} or {{shortcut_2}} to finish cropping"},OH={cannotShowPreview:"Cannot show preview",canvasTooBig:"The canvas may be too big.",canvasTooBigTip:"Tip: try moving the farthest elements a bit closer together."},PH={headingMain:"Encountered an error. Try <button>reloading the page</button>.",clearCanvasMessage:"If reloading doesn't work, try <button>clearing the canvas</button>.",clearCanvasCaveat:" This will result in loss of work ",trackedToSentry:"The error with identifier {{eventId}} was tracked on our system.",openIssueMessage:"We were very cautious not to include your scene information on the error. If your scene is not private, please consider following up on our <button>bug tracker</button>. Please include information below by copying and pasting into the GitHub issue.",sceneContent:"Scene content:"},FH={or:"Or"},BH={desc_intro:"Invite people to collaborate on your drawing.",desc_privacy:"Don't worry, the session is end-to-end encrypted, and fully private. Not even our server can see what you draw.",button_startSession:"Start session",button_stopSession:"Stop session",desc_inProgressIntro:"Live-collaboration session is now in progress.",desc_shareLink:"Share this link with anyone you want to collaborate with:",desc_exitSession:"Stopping the session will disconnect you from the room, but you'll be able to continue working with the scene, locally. Note that this won't affect other people, and they'll still be able to collaborate on their version.",shareTitle:"Join a live collaboration session on Excalidraw"},zH={title:"Error"},HH={disk_title:"Save to disk",disk_details:"Export the scene data to a file from which you can import later.",disk_button:"Save to file",link_title:"Shareable link",link_details:"Export as a read-only link.",link_button:"Export to Link",excalidrawplus_description:"Save the scene to your Excalidraw+ workspace.",excalidrawplus_button:"Export",excalidrawplus_exportError:"Couldn't export to Excalidraw+ at this moment..."},VH={blog:"Read our blog",click:"click",deepSelect:"Deep select",deepBoxSelect:"Deep select within box, and prevent dragging",createFlowchart:"Create a flowchart from a generic element",navigateFlowchart:"Navigate a flowchart",curvedArrow:"Curved arrow",curvedLine:"Curved line",documentation:"Documentation",doubleClick:"double-click",drag:"drag",editor:"Editor",editLineArrowPoints:"Edit line/arrow points",editText:"Edit text / add label",github:"Found an issue? Submit",howto:"Follow our guides",or:"or",preventBinding:"Prevent arrow binding",tools:"Tools",shortcuts:"Keyboard shortcuts",textFinish:"Finish editing (text editor)",textNewLine:"Add new line (text editor)",title:"Help",view:"View",zoomToFit:"Zoom to fit all elements",zoomToSelection:"Zoom to selection",toggleElementLock:"Lock/unlock selection",movePageUpDown:"Move page up/down",movePageLeftRight:"Move page left/right",cropStart:"Crop image",cropFinish:"Finish image cropping"},$H={title:"Clear canvas"},GH={title:"Publish library",itemName:"Item name",authorName:"Author name",githubUsername:"GitHub username",twitterUsername:"Twitter username",libraryName:"Library name",libraryDesc:"Library description",website:"Website",placeholder:{authorName:"Your name or username",libraryName:"Name of your library",libraryDesc:"Description of your library to help people understand its usage",githubHandle:"GitHub handle (optional), so you can edit the library once submitted for review",twitterHandle:"Twitter username (optional), so we know who to credit when promoting over Twitter",website:"Link to your personal website or elsewhere (optional)"},errors:{required:"Required",website:"Enter a valid URL"},noteDescription:"Submit your library to be included in the <link>public library repository</link> for other people to use in their drawings.",noteGuidelines:"The library needs to be manually approved first. Please read the <link>guidelines</link> before submitting. You will need a GitHub account to communicate and make changes if requested, but it is not strictly required.",noteLicense:"By submitting, you agree the library will be published under the <link>MIT License</link>, which in short means anyone can use them without restrictions.",noteItems:"Each library item must have its own name so it's filterable. The following library items will be included:",atleastOneLibItem:"Please select at least one library item to get started",republishWarning:"Note: some of the selected items are marked as already published/submitted. You should only resubmit items when updating an existing library or submission."},XH={title:"Library submitted",content:"Thank you {{authorName}}. Your library has been submitted for review. You can track the status <link>here</link>"},jH={resetLibrary:"Reset library",removeItemsFromLib:"Remove selected items from library"},YH={header:"Export image",label:{withBackground:"Background",onlySelected:"Only selected",darkMode:"Dark mode",embedScene:"Embed scene",scale:"Scale",padding:"Padding"},tooltip:{embedScene:`Scene data will be saved into the exported PNG/SVG file so that the scene can be restored from it.
Will increase exported file size.`},title:{exportToPng:"Export to PNG",exportToSvg:"Export to SVG",copyPngToClipboard:"Copy PNG to clipboard"},button:{exportToPng:"PNG",exportToSvg:"SVG",copyPngToClipboard:"Copy to clipboard"}},WH={tooltip:"Your drawings are end-to-end encrypted so Excalidraw's servers will never see them.",link:"Blog post on end-to-end encryption in Excalidraw"},KH={angle:"Angle",shapes:"Shapes",height:"Height",scene:"Scene",selected:"Selected",storage:"Storage",fullTitle:"Canvas & Shape properties",title:"Properties",generalStats:"General",elementProperties:"Shape properties",total:"Total",version:"Version",versionCopy:"Click to copy",versionNotAvailable:"Version not available",width:"Width"},ZH={addedToLibrary:"Added to library",copyStyles:"Copied styles.",copyToClipboard:"Copied to clipboard.",copyToClipboardAsPng:`Copied {{exportSelection}} to clipboard as PNG
({{exportColorScheme}})`,copyToClipboardAsSvg:`Copied {{exportSelection}} to clipboard as SVG
({{exportColorScheme}})`,fileSaved:"File saved.",fileSavedToFilename:"Saved to {filename}",canvas:"canvas",selection:"selection",pasteAsSingleElement:`Use {{shortcut}} to paste as a single element,
or paste into an existing text editor`,unableToEmbed:"Embedding this url is currently not allowed. Raise an issue on GitHub to request the url whitelisted",unrecognizedLinkFormat:"The link you embedded does not match the expected format. Please try to paste the 'embed' string provided by the source site",elementLinkCopied:"Link copied to clipboard"},qH={transparent:"Transparent",black:"Black",white:"White",red:"Red",pink:"Pink",grape:"Grape",violet:"Violet",gray:"Gray",blue:"Blue",cyan:"Cyan",teal:"Teal",green:"Green",yellow:"Yellow",orange:"Orange",bronze:"Bronze"},QH={app:{center_heading:"All your data is saved locally in your browser.",center_heading_plus:"Did you want to go to the Excalidraw+ instead?",menuHint:"Export, preferences, languages, ..."},defaults:{menuHint:"Export, preferences, and more...",center_heading:"Diagrams. Made. Simple.",toolbarHint:"Pick a tool & Start drawing!",helpHint:"Shortcuts & help"}},JH={color:"Color",mostUsedCustomColors:"Most used custom colors",colors:"Colors",shades:"Shades",hexCode:"Hex code",noShades:"No shades available for this color"},eV={action:{exportToImage:{title:"Export as image",button:"Export as image",description:"Export the scene data as an image from which you can import later."},saveToDisk:{title:"Save to disk",button:"Save to disk",description:"Export the scene data to a file from which you can import later."},excalidrawPlus:{title:"Excalidraw+",button:"Export to Excalidraw+",description:"Save the scene to your Excalidraw+ workspace."}},modal:{loadFromFile:{title:"Load from file",button:"Load from file",description:"Loading from a file will <bold>replace your existing content</bold>.<br></br>You can back up your drawing first using one of the options below."},shareableLink:{title:"Load from link",button:"Replace my content",description:"Loading external drawing will <bold>replace your existing content</bold>.<br></br>You can back up your drawing first by using one of the options below."}}},tV={title:"Mermaid to Excalidraw",button:"Insert",description:"Currently only <flowchartLink>Flowchart</flowchartLink>,<sequenceLink> Sequence, </sequenceLink> and <classLink>Class </classLink>Diagrams are supported. The other types will be rendered as image in Excalidraw.",syntax:"Mermaid Syntax",preview:"Preview"},nV={placeholder:"Quick search"},iV={badge:{old:"old"},sceneFonts:"In this scene",availableFonts:"Available fonts",empty:"No fonts found"},sV={empty:"No users found",hint:{text:"Click on user to follow",followStatus:"You're currently following this user",inCall:"User is in a voice call",micMuted:"User's microphone is muted",isSpeaking:"User is speaking"}},rV={title:"Command palette",shortcuts:{select:"Select",confirm:"Confirm",close:"Close"},recents:"Recently used",search:{placeholder:"Search menus, commands, and discover hidden gems",noMatch:"No matching commands..."},itemNotAvailable:"Command is not available...",shortcutHint:"For Command palette, use {{shortcut}}"},oV={ctrl:"Ctrl",option:"Option",cmd:"Cmd",alt:"Alt",escape:"Esc",enter:"Enter",shift:"Shift",spacebar:"Space",delete:"Delete",mmb:"Scroll wheel"},k_={labels:IH,elementLink:SH,library:xH,search:CH,buttons:AH,alerts:MH,errors:kH,toolBar:RH,element:DH,headings:LH,hints:NH,canvasError:OH,errorSplash:PH,shareDialog:FH,roomDialog:BH,errorDialog:zH,exportDialog:HH,helpDialog:VH,clearCanvasDialog:$H,publishDialog:GH,publishSuccessDialog:XH,confirmDialog:jH,imageExportDialog:YH,encrypted:WH,stats:KH,toast:ZH,colors:qH,welcomeScreen:QH,colorPicker:JH,overwriteConfirm:eV,mermaid:tV,quickSearch:nV,fontList:iV,userList:sV,commandPalette:rV,keys:oV},Gue=Object.freeze(Object.defineProperty({__proto__:null,alerts:MH,buttons:AH,canvasError:OH,clearCanvasDialog:$H,colorPicker:JH,colors:qH,commandPalette:rV,confirmDialog:jH,default:k_,element:DH,elementLink:SH,encrypted:WH,errorDialog:zH,errorSplash:PH,errors:kH,exportDialog:HH,fontList:iV,headings:LH,helpDialog:VH,hints:NH,imageExportDialog:YH,keys:oV,labels:IH,library:xH,mermaid:tV,overwriteConfirm:eV,publishDialog:GH,publishSuccessDialog:XH,quickSearch:nV,roomDialog:BH,search:CH,shareDialog:FH,stats:KH,toast:ZH,toolBar:RH,userList:sV,welcomeScreen:QH},Symbol.toStringTag,{value:"Module"})),aV=100,lV=36,cV={"ar-SA":94,"az-AZ":17,"bg-BG":71,"bn-BD":52,"ca-ES":83,"cs-CZ":86,"da-DK":61,"de-DE":100,"el-GR":80,en:aV,"es-ES":96,"eu-ES":97,"fa-IR":84,"fi-FI":76,"fr-FR":99,"gl-ES":86,"he-IL":77,"hi-IN":76,"hu-HU":76,"id-ID":91,"it-IT":98,"ja-JP":90,kaa:lV,"kab-KAB":76,"kk-KZ":18,"km-KH":83,"ko-KR":100,"ku-TR":87,"lt-LT":48,"lv-LV":77,"mr-IN":98,"my-MM":35,"nb-NO":93,"nl-NL":75,"nn-NO":67,"oc-FR":92,"pa-IN":78,"pl-PL":99,"pt-BR":91,"pt-PT":83,"ro-RO":99,"ru-RU":92,"si-LK":7,"sk-SK":100,"sl-SI":100,"sv-SE":100,"ta-IN":81,"th-TH":44,"tr-TR":87,"uk-UA":93,"vi-VN":49,"zh-CN":100,"zh-HK":22,"zh-TW":100},Xue=Object.freeze(Object.defineProperty({__proto__:null,default:cV,en:aV,kaa:lV},Symbol.toStringTag,{value:"Module"})),jue=85,Hd={code:"en",label:"English"},oy=[Hd,...[{code:"ar-SA",label:"",rtl:!0},{code:"bg-BG",label:""},{code:"ca-ES",label:"Catal"},{code:"cs-CZ",label:"esky"},{code:"de-DE",label:"Deutsch"},{code:"el-GR",label:""},{code:"es-ES",label:"Espaol"},{code:"eu-ES",label:"Euskara"},{code:"fa-IR",label:"",rtl:!0},{code:"fi-FI",label:"Suomi"},{code:"fr-FR",label:"Franais"},{code:"gl-ES",label:"Galego"},{code:"he-IL",label:"",rtl:!0},{code:"hi-IN",label:""},{code:"hu-HU",label:"Magyar"},{code:"id-ID",label:"Bahasa Indonesia"},{code:"it-IT",label:"Italiano"},{code:"ja-JP",label:""},{code:"kab-KAB",label:"Taqbaylit"},{code:"kk-KZ",label:" "},{code:"ko-KR",label:""},{code:"ku-TR",label:"Kurd"},{code:"lt-LT",label:"Lietuvi"},{code:"lv-LV",label:"Latvieu"},{code:"my-MM",label:"Burmese"},{code:"nb-NO",label:"Norsk bokml"},{code:"nl-NL",label:"Nederlands"},{code:"nn-NO",label:"Norsk nynorsk"},{code:"oc-FR",label:"Occitan"},{code:"pa-IN",label:""},{code:"pl-PL",label:"Polski"},{code:"pt-BR",label:"Portugus Brasileiro"},{code:"pt-PT",label:"Portugus"},{code:"ro-RO",label:"Romn"},{code:"ru-RU",label:""},{code:"sk-SK",label:"Slovenina"},{code:"sv-SE",label:"Svenska"},{code:"sl-SI",label:"Slovenina"},{code:"tr-TR",label:"Trke"},{code:"uk-UA",label:""},{code:"zh-CN",label:""},{code:"zh-TW",label:""},{code:"vi-VN",label:"Ting Vit"},{code:"mr-IN",label:""}].filter(e=>cV[e.code]>=jue).sort((e,t)=>e.label>t.label?1:-1)],uV="__test__";let Wf=Hd,P2={};const dV=async e=>{if(Wf=e,document.documentElement.dir=Wf.rtl?"rtl":"ltr",document.documentElement.lang=Wf.code,e.code.startsWith(uV))P2={};else try{P2=await Aue(Object.assign({"./locales/ar-SA.json":()=>ye(()=>import("./locales/ar-SA.json-D_jDFH8k.js"),__vite__mapDeps([])),"./locales/az-AZ.json":()=>ye(()=>import("./locales/az-AZ.json-BV3iXazI.js"),__vite__mapDeps([])),"./locales/bg-BG.json":()=>ye(()=>import("./locales/bg-BG.json-CFqJeJis.js"),__vite__mapDeps([])),"./locales/bn-BD.json":()=>ye(()=>import("./locales/bn-BD.json-Dg0jTBuU.js"),__vite__mapDeps([])),"./locales/ca-ES.json":()=>ye(()=>import("./locales/ca-ES.json-B_rqfBtq.js"),__vite__mapDeps([])),"./locales/cs-CZ.json":()=>ye(()=>import("./locales/cs-CZ.json-Cd3Jrse6.js"),__vite__mapDeps([])),"./locales/da-DK.json":()=>ye(()=>import("./locales/da-DK.json-DIUMM5f1.js"),__vite__mapDeps([])),"./locales/de-DE.json":()=>ye(()=>import("./locales/de-DE.json-BF0RlQMn.js"),__vite__mapDeps([])),"./locales/el-GR.json":()=>ye(()=>import("./locales/el-GR.json-DU1ye1AH.js"),__vite__mapDeps([])),"./locales/en.json":()=>ye(()=>Promise.resolve().then(()=>Gue),void 0),"./locales/es-ES.json":()=>ye(()=>import("./locales/es-ES.json-xlQfaHzf.js"),__vite__mapDeps([])),"./locales/eu-ES.json":()=>ye(()=>import("./locales/eu-ES.json-DHzY6Edt.js"),__vite__mapDeps([])),"./locales/fa-IR.json":()=>ye(()=>import("./locales/fa-IR.json-dG0Oexeb.js"),__vite__mapDeps([])),"./locales/fi-FI.json":()=>ye(()=>import("./locales/fi-FI.json-Bujb5Dw7.js"),__vite__mapDeps([])),"./locales/fr-FR.json":()=>ye(()=>import("./locales/fr-FR.json-XQSU67Np.js"),__vite__mapDeps([])),"./locales/gl-ES.json":()=>ye(()=>import("./locales/gl-ES.json-DtDal_zw.js"),__vite__mapDeps([])),"./locales/he-IL.json":()=>ye(()=>import("./locales/he-IL.json-DVcgm2lM.js"),__vite__mapDeps([])),"./locales/hi-IN.json":()=>ye(()=>import("./locales/hi-IN.json-C8kzCSp9.js"),__vite__mapDeps([])),"./locales/hu-HU.json":()=>ye(()=>import("./locales/hu-HU.json-DAfvrv_C.js"),__vite__mapDeps([])),"./locales/id-ID.json":()=>ye(()=>import("./locales/id-ID.json-CBiVsIt-.js"),__vite__mapDeps([])),"./locales/it-IT.json":()=>ye(()=>import("./locales/it-IT.json-WpaAwjln.js"),__vite__mapDeps([])),"./locales/ja-JP.json":()=>ye(()=>import("./locales/ja-JP.json-lTAhYhc8.js"),__vite__mapDeps([])),"./locales/kaa.json":()=>ye(()=>import("./locales/kaa.json-FVrrRyw0.js"),__vite__mapDeps([])),"./locales/kab-KAB.json":()=>ye(()=>import("./locales/kab-KAB.json-BrNis2fB.js"),__vite__mapDeps([])),"./locales/kk-KZ.json":()=>ye(()=>import("./locales/kk-KZ.json-D22q2uZy.js"),__vite__mapDeps([])),"./locales/km-KH.json":()=>ye(()=>import("./locales/km-KH.json-c8LT4rcW.js"),__vite__mapDeps([])),"./locales/ko-KR.json":()=>ye(()=>import("./locales/ko-KR.json-Be74AxMq.js"),__vite__mapDeps([])),"./locales/ku-TR.json":()=>ye(()=>import("./locales/ku-TR.json-DnNoknS4.js"),__vite__mapDeps([])),"./locales/lt-LT.json":()=>ye(()=>import("./locales/lt-LT.json-Bezae7cb.js"),__vite__mapDeps([])),"./locales/lv-LV.json":()=>ye(()=>import("./locales/lv-LV.json-DjX28ylN.js"),__vite__mapDeps([])),"./locales/mr-IN.json":()=>ye(()=>import("./locales/mr-IN.json-oZ81g7ZD.js"),__vite__mapDeps([])),"./locales/my-MM.json":()=>ye(()=>import("./locales/my-MM.json-DYr6nfRL.js"),__vite__mapDeps([])),"./locales/nb-NO.json":()=>ye(()=>import("./locales/nb-NO.json-KO5Ap4Cw.js"),__vite__mapDeps([])),"./locales/nl-NL.json":()=>ye(()=>import("./locales/nl-NL.json-CF-IsFrk.js"),__vite__mapDeps([])),"./locales/nn-NO.json":()=>ye(()=>import("./locales/nn-NO.json-BUxdfyBP.js"),__vite__mapDeps([])),"./locales/oc-FR.json":()=>ye(()=>import("./locales/oc-FR.json-DJSOwdjr.js"),__vite__mapDeps([])),"./locales/pa-IN.json":()=>ye(()=>import("./locales/pa-IN.json-CWeXowf0.js"),__vite__mapDeps([])),"./locales/percentages.json":()=>ye(()=>Promise.resolve().then(()=>Xue),void 0),"./locales/pl-PL.json":()=>ye(()=>import("./locales/pl-PL.json-DC_Gtqyg.js"),__vite__mapDeps([])),"./locales/pt-BR.json":()=>ye(()=>import("./locales/pt-BR.json-BP870iwO.js"),__vite__mapDeps([])),"./locales/pt-PT.json":()=>ye(()=>import("./locales/pt-PT.json-BCiUoe7O.js"),__vite__mapDeps([])),"./locales/ro-RO.json":()=>ye(()=>import("./locales/ro-RO.json-DDtEzs-o.js"),__vite__mapDeps([])),"./locales/ru-RU.json":()=>ye(()=>import("./locales/ru-RU.json-Cu66rc7c.js"),__vite__mapDeps([])),"./locales/si-LK.json":()=>ye(()=>import("./locales/si-LK.json-D8rbKfZA.js"),__vite__mapDeps([])),"./locales/sk-SK.json":()=>ye(()=>import("./locales/sk-SK.json-B-lk308q.js"),__vite__mapDeps([])),"./locales/sl-SI.json":()=>ye(()=>import("./locales/sl-SI.json-C9l50axt.js"),__vite__mapDeps([])),"./locales/sv-SE.json":()=>ye(()=>import("./locales/sv-SE.json-S0z3nuUO.js"),__vite__mapDeps([])),"./locales/ta-IN.json":()=>ye(()=>import("./locales/ta-IN.json-Bb4XJg6y.js"),__vite__mapDeps([])),"./locales/th-TH.json":()=>ye(()=>import("./locales/th-TH.json-D-2txP3v.js"),__vite__mapDeps([])),"./locales/tr-TR.json":()=>ye(()=>import("./locales/tr-TR.json-C8iTlMZv.js"),__vite__mapDeps([])),"./locales/uk-UA.json":()=>ye(()=>import("./locales/uk-UA.json-BmimCNFT.js"),__vite__mapDeps([])),"./locales/vi-VN.json":()=>ye(()=>import("./locales/vi-VN.json-Cs9mO6qO.js"),__vite__mapDeps([])),"./locales/zh-CN.json":()=>ye(()=>import("./locales/zh-CN.json-D5rso2fJ.js"),__vite__mapDeps([])),"./locales/zh-HK.json":()=>ye(()=>import("./locales/zh-HK.json-Cr1Xzg-X.js"),__vite__mapDeps([])),"./locales/zh-TW.json":()=>ye(()=>import("./locales/zh-TW.json-BhXss3zf.js"),__vite__mapDeps([]))}),`./locales/${Wf.code}.json`)}catch(t){console.error(`Failed to load language ${e.code}:`,t.message),P2=k_}Hs.set(fV,e.code)},gm=()=>Wf,NM=(e,t)=>{for(let n=0;n<t.length;++n){const i=t[n];if(e[i]===void 0)return;e=e[i]}if(typeof e=="string")return e},M=(e,t,n)=>{if(Wf.code.startsWith(uV))return`[[${t?`${e}(${JSON.stringify(t).slice(1,-1)})`:e}]]`;const i=e.split(".");let s=NM(P2,i)||NM(k_,i)||n;if(s===void 0){const r=`Can't find translation for ${e}`;return console.warn(r),""}if(t)for(const r in t)s=s.replace(`{{${r}}}`,String(t[r]));return s},fV=Yt(Hd.code),dn=()=>{const e=TH(fV);return{t:M,langCode:e}},Yue=(e,t)=>{const[n,i,s,r]=t,{x:o,y:a}=Xs({sceneX:n,sceneY:i},e),{x:l,y:c}=Xs({sceneX:s,sceneY:r},e);return l-o>e.width||c-a>e.height},hV=({scenePoint:e,viewportDimensions:t,zoom:n,offsets:i})=>{let s=(t.width-((i==null?void 0:i.right)??0))/2/n.value-e.x;s+=((i==null?void 0:i.left)??0)/2/n.value;let r=(t.height-((i==null?void 0:i.bottom)??0))/2/n.value-e.y;return r+=((i==null?void 0:i.top)??0)/2/n.value,{scrollX:s,scrollY:r}},mm=(e,t)=>{if(e=xue(e),!e.length)return{scrollX:0,scrollY:0};let[n,i,s,r]=ft(e);Yue(t,[n,i,s,r])&&([n,i,s,r]=mce(e,Dt({clientX:t.scrollX,clientY:t.scrollY},t)));const o=(n+s)/2,a=(i+r)/2;return hV({scenePoint:{x:o,y:a},viewportDimensions:{width:t.width,height:t.height},zoom:t.zoom})},Ha=e=>Ke(ja(e,6),C9,A9),Wue=e=>Ke(Math.round(e),1,100),gV=e=>Ke(Math.round(e),1,100),Zr=e=>"var(--icon-fill-color)",mV=e=>e===ke.LIGHT?Ui.white:"#1e1e1e",Y=(e,t=512)=>{const{width:n=512,height:i=n,mirror:s,style:r,...o}=typeof t=="number"?{width:t}:t;return g("svg",{"aria-hidden":"true",focusable:"false",role:"img",viewBox:`0 0 ${n} ${i}`,className:re({"rtl-mirror":s}),style:r,...o,children:typeof e=="string"?g("path",{fill:"currentColor",d:e}):e})},le={width:24,height:24,fill:"none",strokeWidth:2,stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"},Fe={width:20,height:20,fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"};Y(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("rect",{x:3,y:8,width:18,height:4,rx:1}),g("line",{x1:12,y1:8,x2:12,y2:21}),g("path",{d:"M19 12v7a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-7"}),g("path",{d:"M7.5 8a2.5 2.5 0 0 1 0 -5a4.8 8 0 0 1 4.5 5a4.8 8 0 0 1 4.5 -5a2.5 2.5 0 0 1 0 5"})]}),le);const R_=Y(N("g",{strokeWidth:"1.25",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 19a9 9 0 0 1 9 0a9 9 0 0 1 9 0"}),g("path",{d:"M3 6a9 9 0 0 1 9 0a9 9 0 0 1 9 0"}),g("line",{x1:"3",y1:"6",x2:"3",y2:"19"}),g("line",{x1:"12",y1:"6",x2:"12",y2:"19"}),g("line",{x1:"21",y1:"6",x2:"21",y2:"19"})]}),le),Kue=Y(N("svg",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),g("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),le),Zue=Y(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("circle",{cx:"12",cy:"12",r:"1"}),g("circle",{cx:"12",cy:"19",r:"1"}),g("circle",{cx:"12",cy:"5",r:"1"})]}),le),que=Y(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M5 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"}),g("path",{d:"M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"}),g("path",{d:"M19 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"})]}),le),Que=Y(N("svg",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M9 4v6l-2 4v2h10v-2l-2 -4v-6"}),g("line",{x1:"12",y1:"16",x2:"12",y2:"21"}),g("line",{x1:"8",y1:"4",x2:"16",y2:"4"})]}),le),OM=Y(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M12 5m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M19 8m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M5 11m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M15 19m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M6.5 9.5l3.5 -3"}),g("path",{d:"M14 5.5l3 1.5"}),g("path",{d:"M18.5 10l-2.5 7"}),g("path",{d:"M13.5 17.5l-7 -5"})]}),le),ay=Y(N("g",{children:[g("path",{d:"M13.542 8.542H6.458a2.5 2.5 0 0 0-2.5 2.5v3.75a2.5 2.5 0 0 0 2.5 2.5h7.084a2.5 2.5 0 0 0 2.5-2.5v-3.75a2.5 2.5 0 0 0-2.5-2.5Z",stroke:"currentColor",strokeWidth:"1.25"}),g("path",{d:"M10 13.958a1.042 1.042 0 1 0 0-2.083 1.042 1.042 0 0 0 0 2.083Z",stroke:"currentColor",strokeWidth:"1.25"}),g("mask",{id:"UnlockedIcon",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:6,y:1,width:9,height:9,children:g("path",{stroke:"none",d:"M6.399 9.561V5.175c0-.93.401-1.823 1.116-2.48a3.981 3.981 0 0 1 2.693-1.028c1.01 0 1.98.37 2.694 1.027.715.658 1.116 1.55 1.116 2.481",fill:"#fff"})}),g("g",{mask:"url(#UnlockedIcon)",children:g("path",{stroke:"none",d:"M5.149 9.561v1.25h2.5v-1.25h-2.5Zm5.06-7.894V.417v1.25Zm2.559 3.508v1.25h2.5v-1.25h-2.5ZM7.648 8.51V5.175h-2.5V8.51h2.5Zm0-3.334c0-.564.243-1.128.713-1.561L6.668 1.775c-.959.883-1.52 2.104-1.52 3.4h2.5Zm.713-1.561a2.732 2.732 0 0 1 1.847-.697v-2.5c-1.31 0-2.585.478-3.54 1.358L8.36 3.614Zm1.847-.697c.71 0 1.374.26 1.847.697l1.694-1.839a5.231 5.231 0 0 0-3.54-1.358v2.5Zm1.847.697c.47.433.713.997.713 1.561h2.5c0-1.296-.56-2.517-1.52-3.4l-1.693 1.839Z",fill:"currentColor"})})]}),Fe),D_=Y(N("g",{strokeWidth:"1.25",children:[g("path",{d:"M13.542 8.542H6.458a2.5 2.5 0 0 0-2.5 2.5v3.75a2.5 2.5 0 0 0 2.5 2.5h7.084a2.5 2.5 0 0 0 2.5-2.5v-3.75a2.5 2.5 0 0 0-2.5-2.5Z"}),g("path",{d:"M10 13.958a1.042 1.042 0 1 0 0-2.083 1.042 1.042 0 0 0 0 2.083Z"}),g("path",{d:"M6.667 8.333V5.417C6.667 3.806 8.159 2.5 10 2.5c1.841 0 3.333 1.306 3.333 2.917v2.916"})]}),Fe),Jue=Y(g("g",{fill:"currentColor",children:g("path",{d:"M12 2a5 5 0 0 1 5 5v3a3 3 0 0 1 3 3v6a3 3 0 0 1 -3 3h-10a3 3 0 0 1 -3 -3v-6a3 3 0 0 1 3 -3v-3a5 5 0 0 1 5 -5m0 12a2 2 0 0 0 -1.995 1.85l-.005 .15a2 2 0 1 0 2 -2m0 -10a3 3 0 0 0 -3 3v3h6v-3a3 3 0 0 0 -3 -3"})}),{width:24,height:24}),ede=Y(N(fe,{children:[g("path",{d:"M38.5 83.5c-14-2-17.833-10.473-21-22.5C14.333 48.984 12 22 12 12.5",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"}),g("path",{fillRule:"evenodd",clipRule:"evenodd",d:"m12.005 10.478 7.905 14.423L6 25.75l6.005-15.273Z",fill:"currentColor"}),g("path",{d:"M12.005 10.478c1.92 3.495 3.838 7 7.905 14.423m-7.905-14.423c3.11 5.683 6.23 11.368 7.905 14.423m0 0c-3.68.226-7.35.455-13.91.85m13.91-.85c-5.279.33-10.566.647-13.91.85m0 0c1.936-4.931 3.882-9.86 6.005-15.273M6 25.75c2.069-5.257 4.135-10.505 6.005-15.272",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"})]}),{width:41,height:94,fill:"none"}),tde=Y(N(fe,{children:[g("path",{d:"M18.026 1.232c-5.268 13.125-5.548 33.555 3.285 42.311 8.823 8.75 33.31 12.304 42.422 13.523",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"}),g("path",{fillRule:"evenodd",clipRule:"evenodd",d:"m72.181 59.247-13.058-10-2.948 13.62 16.006-3.62Z",fill:"currentColor"}),g("path",{d:"M72.181 59.247c-3.163-2.429-6.337-4.856-13.058-10m13.058 10c-5.145-3.936-10.292-7.882-13.058-10m0 0c-.78 3.603-1.563 7.196-2.948 13.62m2.948-13.62c-1.126 5.168-2.24 10.346-2.948 13.62m0 0c5.168-1.166 10.334-2.343 16.006-3.62m-16.006 3.62c5.51-1.248 11.01-2.495 16.006-3.62",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"})]}),{width:85,height:71,fill:"none"}),nde=Y(N(fe,{children:[g("path",{d:"M1 77c14-2 31.833-11.973 35-24 3.167-12.016-6-35-9.5-43.5",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"}),g("path",{fillRule:"evenodd",clipRule:"evenodd",d:"m24.165 1.093-2.132 16.309 13.27-4.258-11.138-12.05Z",fill:"currentColor"}),g("path",{d:"M24.165 1.093c-.522 3.953-1.037 7.916-2.132 16.309m2.131-16.309c-.835 6.424-1.68 12.854-2.13 16.308m0 0c3.51-1.125 7.013-2.243 13.27-4.257m-13.27 4.257c5.038-1.608 10.08-3.232 13.27-4.257m0 0c-3.595-3.892-7.197-7.777-11.14-12.05m11.14 12.05c-3.837-4.148-7.667-8.287-11.14-12.05",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round"})]}),{width:38,height:78,fill:"none"}),W4=Y(g("g",{fill:"currentColor",children:g("path",{d:"M39.9 32.889a.326.326 0 0 0-.279-.056c-2.094-3.083-4.774-6-7.343-8.833l-.419-.472a.212.212 0 0 0-.056-.139.586.586 0 0 0-.167-.111l-.084-.083-.056-.056c-.084-.167-.28-.278-.475-.167-.782.39-1.507.973-2.206 1.528-.92.722-1.842 1.445-2.708 2.25a8.405 8.405 0 0 0-.977 1.028c-.14.194-.028.361.14.444-.615.611-1.23 1.223-1.843 1.861a.315.315 0 0 0-.084.223c0 .083.056.166.111.194l1.09.833v.028c1.535 1.528 4.244 3.611 7.12 5.861.418.334.865.667 1.284 1 .195.223.39.473.558.695.084.11.28.139.391.055.056.056.14.111.196.167a.398.398 0 0 0 .167.056.255.255 0 0 0 .224-.111.394.394 0 0 0 .055-.167c.029 0 .028.028.056.028a.318.318 0 0 0 .224-.084l5.082-5.528a.309.309 0 0 0 0-.444Zm-14.63-1.917a.485.485 0 0 0 .111.14c.586.5 1.2 1 1.843 1.555l-2.569-1.945-.251-.166c-.056-.028-.112-.084-.168-.111l-.195-.167.056-.056.055-.055.112-.111c.866-.861 2.346-2.306 3.1-3.028-.81.805-2.43 3.167-2.095 3.944Zm8.767 6.89-2.122-1.612a44.713 44.713 0 0 0-2.625-2.5c1.145.861 2.122 1.611 2.262 1.75 1.117.972 1.06.806 1.815 1.445l.921.666a1.06 1.06 0 0 1-.251.25Zm.558.416-.056-.028c.084-.055.168-.111.252-.194l-.196.222ZM1.089 5.75c.055.361.14.722.195 1.056.335 1.833.67 3.5 1.284 4.75l.252.944c.084.361.223.806.363.917 1.424 1.25 3.602 3.11 5.947 4.889a.295.295 0 0 0 .363 0s0 .027.028.027a.254.254 0 0 0 .196.084.318.318 0 0 0 .223-.084c2.988-3.305 5.221-6.027 6.813-8.305.112-.111.14-.278.14-.417.111-.111.195-.25.307-.333.111-.111.111-.306 0-.39l-.028-.027c0-.055-.028-.139-.084-.167-.698-.666-1.2-1.138-1.731-1.638-.922-.862-1.871-1.75-3.881-3.75l-.028-.028c-.028-.028-.056-.056-.112-.056-.558-.194-1.703-.389-3.127-.639C6.087 2.223 3.21 1.723.614.944c0 0-.168 0-.196.028l-.083.084c-.028.027-.056.055-.224.11h.056-.056c.028.167.028.278.084.473 0 .055.112.5.112.555l.782 3.556Zm15.496 3.278-.335-.334c.084.112.196.195.335.334Zm-3.546 4.666-.056.056c0-.028.028-.056.056-.056Zm-2.038-10c.168.167.866.834 1.033.973-.726-.334-2.54-1.167-3.379-1.445.838.167 1.983.334 2.346.472ZM1.424 2.306c.419.722.754 3.222 1.089 5.666-.196-.778-.335-1.555-.503-2.278-.251-1.277-.503-2.416-.838-3.416.056 0 .14 0 .252.028Zm-.168-.584c-.112 0-.223-.028-.307-.028 0-.027 0-.055-.028-.055.14 0 .223.028.335.083Zm-1.089.222c0-.027 0-.027 0 0ZM39.453 1.333c.028-.11-.558-.61-.363-.639.42-.027.42-.666 0-.666-.558.028-1.144.166-1.675.25-.977.194-1.982.389-2.96.61-2.205.473-4.383.973-6.561 1.557-.67.194-1.424.333-2.066.666-.224.111-.196.333-.084.472-.056.028-.084.028-.14.056-.195.028-.363.056-.558.083-.168.028-.252.167-.224.334 0 .027.028.083.028.11-1.173 1.556-2.485 3.195-3.909 4.945-1.396 1.611-2.876 3.306-4.356 5.056-4.719 5.5-10.052 11.75-15.943 17.25a.268.268 0 0 0 0 .389c.028.027.056.055.084.055-.084.084-.168.14-.252.222-.056.056-.084.111-.084.167a.605.605 0 0 0-.111.139c-.112.111-.112.305.028.389.111.11.307.11.39-.028.029-.028.029-.056.056-.056a.44.44 0 0 1 .615 0c.335.362.67.723.977 1.028l-.698-.583c-.112-.111-.307-.083-.39.028-.113.11-.085.305.027.389l7.427 6.194c.056.056.112.056.196.056s.14-.028.195-.084l.168-.166c.028.027.083.027.111.027.084 0 .14-.027.196-.083 10.052-10.055 18.15-17.639 27.42-24.417.083-.055.111-.166.111-.25.112 0 .196-.083.251-.194 1.704-5.194 2.039-9.806 2.15-12.083v-.028c0-.028.028-.056.028-.083.028-.056.028-.084.028-.084a1.626 1.626 0 0 0-.111-1.028ZM21.472 9.5c.446-.5.893-1.028 1.34-1.5-2.876 3.778-7.65 9.583-14.408 16.5 4.607-5.083 9.242-10.333 13.068-15ZM5.193 35.778h.084-.084Zm3.462 3.194c-.027-.028-.027-.028 0-.028v.028Zm4.16-3.583c.224-.25.448-.472.699-.722 0 0 0 .027.028.027-.252.223-.475.445-.726.695Zm1.146-1.111c.14-.14.279-.334.446-.5l.028-.028c1.648-1.694 3.351-3.389 5.082-5.111l.028-.028c.419-.333.921-.694 1.368-1.028a379.003 379.003 0 0 0-6.952 6.695ZM24.794 6.472c-.921 1.195-1.954 2.778-2.82 4.028-2.736 3.944-11.532 13.583-11.727 13.75a1976.983 1976.983 0 0 1-8.042 7.639l-.167.167c-.14-.167-.14-.417.028-.556C14.49 19.861 22.03 10.167 25.074 5.917c-.084.194-.14.36-.28.555Zm4.83 5.695c-1.116-.64-1.646-1.64-1.34-2.611l.084-.334c.028-.083.084-.194.14-.277.307-.5.754-.917 1.257-1.167.027 0 .055 0 .083-.028-.028-.056-.028-.139-.028-.222.028-.167.14-.278.335-.278.335 0 1.369.306 1.76.639.111.083.223.194.335.305.14.167.363.445.474.667.056.028.112.306.196.445.056.222.111.472.084.694-.028.028 0 .194-.028.194a2.668 2.668 0 0 1-.363 1.028c-.028.028-.028.056-.056.084l-.028.027c-.14.223-.335.417-.53.556-.643.444-1.369.583-2.095.389 0 0-.195-.084-.28-.111Zm8.154-.834a39.098 39.098 0 0 1-.893 3.167c0 .028-.028.083 0 .111-.056 0-.084.028-.14.056-2.206 1.61-4.356 3.305-6.506 5.028 1.843-1.64 3.686-3.306 5.613-4.945.558-.5.949-1.139 1.06-1.861l.28-1.667v-.055c.14-.334.67-.195.586.166Z",fill:"currentColor"})}),{width:40,height:40,fill:"none"}),ly=Y(N("g",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M6 6l4.153 11.793a0.365 .365 0 0 0 .331 .207a0.366 .366 0 0 0 .332 -.207l2.184 -4.793l4.787 -1.994a0.355 .355 0 0 0 .213 -.323a0.355 .355 0 0 0 -.213 -.323l-11.787 -4.36z"}),g("path",{d:"M13.5 13.5l4.5 4.5"})]}),{fill:"none",width:22,height:22,strokeWidth:1.25}),T0=Y(N("g",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,children:[g("path",{d:"M4.028 13.252c-.657 -.972 -1.028 -2.078 -1.028 -3.252c0 -3.866 4.03 -7 9 -7s9 3.134 9 7s-4.03 7 -9 7c-1.913 0 -3.686 -.464 -5.144 -1.255"}),g("path",{d:"M5 15m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M5 17c0 1.42 .316 2.805 1 4"})]}),{fill:"none",width:22,height:22,strokeWidth:1.25}),L_=Y(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})]}),le),N_=Y(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M10.5 20.4l-6.9 -6.9c-.781 -.781 -.781 -2.219 0 -3l6.9 -6.9c.781 -.781 2.219 -.781 3 0l6.9 6.9c.781 .781 .781 2.219 0 3l-6.9 6.9c-.781 .781 -2.219 .781 -3 0z"})]}),le),O_=Y(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("circle",{cx:"12",cy:"12",r:"9"})]}),le),pV=Y(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"5",y1:"12",x2:"19",y2:"12"}),g("line",{x1:"15",y1:"16",x2:"19",y2:"12"}),g("line",{x1:"15",y1:"8",x2:"19",y2:"12"})]}),le),P_=Y(g("path",{d:"M4.167 10h11.666",strokeWidth:"1.5"}),Fe),ide=Y(N("g",{strokeWidth:"1.25",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M20 17v-12c0 -1.121 -.879 -2 -2 -2s-2 .879 -2 2v12l2 2l2 -2z"}),g("path",{d:"M16 7h4"}),g("path",{d:"M18 19h-13a2 2 0 1 1 0 -4h4a2 2 0 1 0 0 -4h-3"})]}),le),Sp=Y(N("g",{strokeWidth:"1.25",children:[g("path",{clipRule:"evenodd",d:"m7.643 15.69 7.774-7.773a2.357 2.357 0 1 0-3.334-3.334L4.31 12.357a3.333 3.333 0 0 0-.977 2.357v1.953h1.953c.884 0 1.732-.352 2.357-.977Z"}),g("path",{d:"m11.25 5.417 3.333 3.333"})]}),Fe),hh=Y(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"20",x2:"7",y2:"20"}),g("line",{x1:"14",y1:"20",x2:"21",y2:"20"}),g("line",{x1:"6.9",y1:"15",x2:"13.8",y2:"15"}),g("line",{x1:"10.2",y1:"6.3",x2:"16",y2:"20"}),g("polyline",{points:"5 20 11 4 13 4 20 20"})]}),le),sde=Y(N("g",{stroke:"currentColor",strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 7v-2h13v2"}),g("path",{d:"M10 5v14"}),g("path",{d:"M12 19h-4"}),g("path",{d:"M15 13v-1h6v1"}),g("path",{d:"M18 12v7"}),g("path",{d:"M17 19h2"})]}),le),K4=Y(N("g",{strokeWidth:"1.25",children:[g("path",{d:"M12.5 6.667h.01"}),g("path",{d:"M4.91 2.625h10.18a2.284 2.284 0 0 1 2.285 2.284v10.182a2.284 2.284 0 0 1-2.284 2.284H4.909a2.284 2.284 0 0 1-2.284-2.284V4.909a2.284 2.284 0 0 1 2.284-2.284Z"}),g("path",{d:"m3.333 12.5 3.334-3.333c.773-.745 1.726-.745 2.5 0l4.166 4.166"}),g("path",{d:"m11.667 11.667.833-.834c.774-.744 1.726-.744 2.5 0l1.667 1.667"})]}),Fe),UV=Y(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M19 20h-10.5l-4.21 -4.3a1 1 0 0 1 0 -1.41l10 -10a1 1 0 0 1 1.41 0l5 5a1 1 0 0 1 0 1.41l-9.2 9.3"}),g("path",{d:"M18 13.3l-6.3 -6.3"})]}),le),PM=Y(g("path",{strokeWidth:"1.25",d:"M10 4.167v11.666M4.167 10h11.666"}),Fe),FM=Y(g("path",{d:"M5 10h10",strokeWidth:"1.25"}),Fe),rde=Y(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M21 21l-6 -6"}),g("path",{d:"M3.268 12.043a7.017 7.017 0 0 0 6.634 4.957a7.012 7.012 0 0 0 7.043 -6.131a7 7 0 0 0 -5.314 -7.672a7.021 7.021 0 0 0 -8.241 4.403"}),g("path",{d:"M3 4v4h4"})]}),le),Hc=Y(g("path",{strokeWidth:"1.25",d:"M3.333 5.833h13.334M8.333 9.167v5M11.667 9.167v5M4.167 5.833l.833 10c0 .92.746 1.667 1.667 1.667h6.666c.92 0 1.667-.746 1.667-1.667l.833-10M7.5 5.833v-2.5c0-.46.373-.833.833-.833h3.334c.46 0 .833.373.833.833v2.5"}),Fe),S6=Y(N("g",{strokeWidth:"1.5",children:[g("polyline",{points:"12 16 18 10 12 4"}),g("polyline",{points:"8 4 2 10 8 16"})]}),Fe),Z4=Y(N("g",{strokeWidth:"1.25",children:[g("path",{d:"M14.375 6.458H8.958a2.5 2.5 0 0 0-2.5 2.5v5.417a2.5 2.5 0 0 0 2.5 2.5h5.417a2.5 2.5 0 0 0 2.5-2.5V8.958a2.5 2.5 0 0 0-2.5-2.5Z"}),g("path",{clipRule:"evenodd",d:"M11.667 3.125c.517 0 .986.21 1.325.55.34.338.55.807.55 1.325v1.458H8.333c-.485 0-.927.185-1.26.487-.343.312-.57.75-.609 1.24l-.005 5.357H5a1.87 1.87 0 0 1-1.326-.55 1.87 1.87 0 0 1-.549-1.325V5c0-.518.21-.987.55-1.326.338-.34.807-.549 1.325-.549h6.667Z"})]}),Fe),q4=Y(g("path",{clipRule:"evenodd",d:"M10 2.5h.328a6.25 6.25 0 0 0 6.6 10.372A7.5 7.5 0 1 1 10 2.493V2.5Z",stroke:"currentColor"}),Fe),Q4=Y(g("g",{stroke:"currentColor",strokeLinejoin:"round",children:g("path",{d:"M10 12.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5ZM10 4.167V2.5M14.167 5.833l1.166-1.166M15.833 10H17.5M14.167 14.167l1.166 1.166M10 15.833V17.5M5.833 14.167l-1.166 1.166M5 10H3.333M5.833 5.833 4.667 4.667"})}),{...Fe,strokeWidth:1.5}),ode=Y(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"6",x2:"20",y2:"6"}),g("line",{x1:"4",y1:"12",x2:"20",y2:"12"}),g("line",{x1:"4",y1:"18",x2:"20",y2:"18"})]}),le),cy=Y(g("path",{strokeWidth:"1.25",d:"M3.333 14.167v1.666c0 .92.747 1.667 1.667 1.667h10c.92 0 1.667-.746 1.667-1.667v-1.666M5.833 9.167 10 13.333l4.167-4.166M10 3.333v10"}),Fe),F_=Y(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("circle",{cx:"12",cy:"12",r:"9"}),g("line",{x1:"12",y1:"17",x2:"12",y2:"17.01"}),g("path",{d:"M12 13.5a1.5 1.5 0 0 1 1 -1.5a2.6 2.6 0 1 0 -3 -4"})]}),le),ade=Y(N("g",{strokeWidth:"1.25",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("circle",{cx:"12",cy:"12",r:"9"}),g("line",{x1:"12",y1:"17",x2:"12",y2:"17.01"}),g("path",{d:"M12 13.5a1.5 1.5 0 0 1 1 -1.5a2.6 2.6 0 1 0 -3 -4"})]}),le),BM=Y(g("path",{strokeWidth:"1.25",d:"M9.167 5.833H5.833c-1.254 0-2.5 1.282-2.5 2.5v5.834c0 1.283 1.252 2.5 2.5 2.5h5.834c1.251 0 2.5-1.25 2.5-2.5v-3.334M8.333 11.667l8.334-8.334M12.5 3.333h4.167V7.5"}),Fe),B_=Y(g("path",{d:"M7.5 15.833c-3.583 1.167-3.583-2.083-5-2.5m10 4.167v-2.917c0-.833.083-1.166-.417-1.666 2.334-.25 4.584-1.167 4.584-5a3.833 3.833 0 0 0-1.084-2.667 3.5 3.5 0 0 0-.083-2.667s-.917-.25-2.917 1.084a10.25 10.25 0 0 0-5.166 0C5.417 2.333 4.5 2.583 4.5 2.583a3.5 3.5 0 0 0-.083 2.667 3.833 3.833 0 0 0-1.084 2.667c0 3.833 2.25 4.75 4.584 5-.5.5-.5 1-.417 1.666V17.5",strokeWidth:"1.25"}),Fe),bV=Y(N("g",{strokeWidth:"1.25",children:[g("path",{d:"M7.5 10.833a.833.833 0 1 0 0-1.666.833.833 0 0 0 0 1.666ZM12.5 10.833a.833.833 0 1 0 0-1.666.833.833 0 0 0 0 1.666ZM6.25 6.25c2.917-.833 4.583-.833 7.5 0M5.833 13.75c2.917.833 5.417.833 8.334 0"}),g("path",{d:"M12.917 14.167c0 .833 1.25 2.5 1.666 2.5 1.25 0 2.361-1.39 2.917-2.5.556-1.39.417-4.861-1.25-9.584-1.214-.846-2.5-1.116-3.75-1.25l-.833 2.084M7.083 14.167c0 .833-1.13 2.5-1.526 2.5-1.191 0-2.249-1.39-2.778-2.5-.529-1.39-.397-4.861 1.19-9.584 1.157-.846 2.318-1.116 3.531-1.25l.833 2.084"})]}),Fe),yV=Y(N("g",{strokeWidth:"1.25",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 4l11.733 16h4.267l-11.733 -16z"}),g("path",{d:"M4 20l6.768 -6.768m2.46 -2.46l6.772 -6.772"})]}),le),lde=Y(g("polyline",{fill:"none",stroke:"currentColor",points:"20 6 9 17 4 12"}),{width:24,height:24}),x6=Y(N("g",{strokeWidth:"1.25",children:[g("path",{d:"M8.333 11.667a2.917 2.917 0 0 0 4.167 0l3.333-3.334a2.946 2.946 0 1 0-4.166-4.166l-.417.416"}),g("path",{d:"M11.667 8.333a2.917 2.917 0 0 0-4.167 0l-3.333 3.334a2.946 2.946 0 0 0 4.166 4.166l.417-.416"})]}),Fe),cde=Y("M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z",{width:448,height:512}),ude=Y("M252 54L203 8a28 27 0 00-20-8H28C12 0 0 12 0 27v195c0 15 12 26 28 26h204c15 0 28-11 28-26V73a28 27 0 00-8-19zM130 213c-21 0-37-16-37-36 0-19 16-35 37-35 20 0 37 16 37 35 0 20-17 36-37 36zm56-169v56c0 4-4 6-7 6H44c-4 0-7-2-7-6V42c0-4 3-7 7-7h133l4 2 3 2a7 7 0 012 5z M296 201l87 95-188 205-78 9c-10 1-19-8-18-20l9-84zm141-14l-41-44a31 31 0 00-46 0l-38 41 87 95 38-42c13-14 13-36 0-50z",{width:448,height:512}),z_=Y(g("path",{d:"m9.257 6.351.183.183H15.819c.34 0 .727.182 1.051.506.323.323.505.708.505 1.05v5.819c0 .316-.183.7-.52 1.035-.337.338-.723.522-1.037.522H4.182c-.352 0-.74-.181-1.058-.5-.318-.318-.499-.705-.499-1.057V5.182c0-.351.181-.736.5-1.054.32-.321.71-.503 1.057-.503H6.53l2.726 2.726Z",strokeWidth:"1.25"}),Fe);Y("M384 112v352c0 26.51-21.49 48-48 48H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h80c0-35.29 28.71-64 64-64s64 28.71 64 64h80c26.51 0 48 21.49 48 48zM192 40c-13.255 0-24 10.745-24 24s10.745 24 24 24 24-10.745 24-24-10.745-24-24-24m96 114v-20a6 6 0 0 0-6-6H102a6 6 0 0 0-6 6v20a6 6 0 0 0 6 6h180a6 6 0 0 0 6-6z",{width:384,height:512});Y("M204.3 5C104.9 24.4 24.8 104.3 5.2 203.4c-37 187 131.7 326.4 258.8 306.7 41.2-6.4 61.4-54.6 42.5-91.7-23.1-45.4 9.9-98.4 60.9-98.4h79.7c35.8 0 64.8-29.6 64.9-65.3C511.5 97.1 368.1-26.9 204.3 5zM96 320c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm32-128c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128-64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z");const z8=Y(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M5 16l1.465 1.638a2 2 0 1 1 -3.015 .099l1.55 -1.737z"}),g("path",{d:"M13.737 9.737c2.299 -2.3 3.23 -5.095 2.081 -6.245c-1.15 -1.15 -3.945 -.217 -6.244 2.082c-2.3 2.299 -3.231 5.095 -2.082 6.244c1.15 1.15 3.946 .218 6.245 -2.081z"}),g("path",{d:"M7.492 11.818c.362 .362 .768 .676 1.208 .934l6.895 4.047c1.078 .557 2.255 -.075 3.692 -1.512c1.437 -1.437 2.07 -2.614 1.512 -3.692c-.372 -.718 -1.72 -3.017 -4.047 -6.895a6.015 6.015 0 0 0 -.934 -1.208"})]}),le),dde=Y(g("g",{strokeWidth:1.5,children:g("path",{d:"M6 18l12 -12"})}),le),EV=Y(N("g",{strokeWidth:"1.25",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M15 8h.01"}),g("path",{d:"M12 20h-5a3 3 0 0 1 -3 -3v-10a3 3 0 0 1 3 -3h10a3 3 0 0 1 3 3v5"}),g("path",{d:"M4 15l4 -4c.928 -.893 2.072 -.893 3 0l4 4"}),g("path",{d:"M14 14l1 -1c.617 -.593 1.328 -.793 2.009 -.598"}),g("path",{d:"M19 16v6"}),g("path",{d:"M22 19l-3 3l-3 -3"})]}),le),fde=Y("M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z",{width:512,height:512});Y("M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z",{width:448,height:512});Y("M416 208H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h384c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z",{width:448,height:512});const hde=Y("M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z");Y("M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z");const zM=Y(g("path",{d:"M7.5 10.833 4.167 7.5 7.5 4.167M4.167 7.5h9.166a3.333 3.333 0 0 1 0 6.667H12.5",strokeWidth:"1.25"}),Fe),HM=Y(g("path",{d:"M12.5 10.833 15.833 7.5 12.5 4.167M15.833 7.5H6.667a3.333 3.333 0 1 0 0 6.667H7.5",strokeWidth:"1.25"}),Fe),gde=Y("M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zM262.655 90c-54.497 0-89.255 22.957-116.549 63.758-3.536 5.286-2.353 12.415 2.715 16.258l34.699 26.31c5.205 3.947 12.621 3.008 16.665-2.122 17.864-22.658 30.113-35.797 57.303-35.797 20.429 0 45.698 13.148 45.698 32.958 0 14.976-12.363 22.667-32.534 33.976C247.128 238.528 216 254.941 216 296v4c0 6.627 5.373 12 12 12h56c6.627 0 12-5.373 12-12v-1.333c0-28.462 83.186-29.647 83.186-106.667 0-58.002-60.165-102-116.531-102zM256 338c-25.365 0-46 20.635-46 46 0 25.364 20.635 46 46 46s46-20.636 46-46c0-25.365-20.635-46-46-46z",{mirror:!0}),H_=Y(g("path",{d:"M5 12.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5ZM15 7.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5ZM15 17.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5ZM7.25 8.917l5.5-2.834M7.25 11.083l5.5 2.834",strokeWidth:"1.5"}),Fe),mde=Y("M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7 .2 40.1S486.3 480 472 480H40c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8 .2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24V296c0 13.3 10.7 24 24 24s24-10.7 24-24V184c0-13.3-10.7-24-24-24zm32 224a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"),pde=Y("M16 5l-1.42 1.42-1.59-1.59V16h-1.98V4.83L9.42 6.42 8 5l4-4 4 4zm4 5v11c0 1.1-.9 2-2 2H6c-1.11 0-2-.9-2-2V10c0-1.11.89-2 2-2h3v2H6v11h12V10h-3V8h3c1.1 0 2 .89 2 2z",{width:24,height:24}),Ude=Y(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M8 9h-1a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-8a2 2 0 0 0 -2 -2h-1"}),g("path",{d:"M12 14v-11"}),g("path",{d:"M9 6l3 -3l3 3"})]}),le),bde=Y(N(fe,{children:[g("path",{fill:"currentColor",d:"M40 5.6v6.1l-4.1.7c-8.9 1.4-16.5 6.9-20.6 15C13 32 10.9 43 12.4 43c.4 0 2.4-1.3 4.4-3 5-3.9 12.1-7 18.2-7.7l5-.6v12.8l11.2-11.3L62.5 22 51.2 10.8 40-.5v6.1zm10.2 22.6L44 34.5v-6.8l-6.9.6c-3.9.3-9.8 1.7-13.2 3.1-3.5 1.4-6.5 2.4-6.7 2.2-.9-1 3-7.5 6.4-10.8C28 18.6 34.4 16 40.1 16c3.7 0 3.9-.1 3.9-3.2V9.5l6.2 6.3 6.3 6.2-6.3 6.2z"}),g("path",{stroke:"currentColor",fill:"currentColor",d:"M0 36v20h48v-6.2c0-6 0-6.1-2-4.3-1.1 1-2 2.9-2 4.2V52H4V34c0-17.3-.1-18-2-18s-2 .7-2 20z"})]}),{width:64,height:64});Y(g("path",{stroke:"currentColor",strokeWidth:"40",fill:"currentColor",d:"M148 560a318 318 0 0 0 522 110 316 316 0 0 0 0-450 316 316 0 0 0-450 0c-11 11-21 22-30 34v4h47c25 0 46 21 46 46s-21 45-46 45H90c-13 0-25-6-33-14-9-9-14-20-14-33V156c0-25 20-45 45-45s45 20 45 45v32l1 1a401 401 0 0 1 623 509l212 212a42 42 0 0 1-59 59L698 757A401 401 0 0 1 65 570a42 42 0 0 1 83-10z"}),{width:1024});const vV=N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M12 10l0 10"}),g("path",{d:"M12 10l4 4"}),g("path",{d:"M12 10l-4 4"}),g("path",{d:"M4 4l16 0"})]}),wV=N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M12 5l0 14"}),g("path",{d:"M16 9l-4 -4"}),g("path",{d:"M8 9l4 -4"})]}),VM=Y(wV,le),$M=Y(wV,{...le,style:{transform:"rotate(180deg)"}}),GM=Y(vV,le),XM=Y(vV,{...le,style:{transform:"rotate(180deg)"}}),jM=Y(N(fe,{children:[N("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M3.333 3.333h13.334",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M13.542 6.458h-.417c-.92 0-1.667.747-1.667 1.667v7.083c0 .92.746 1.667 1.667 1.667h.417c.92 0 1.666-.746 1.666-1.667V8.125c0-.92-.746-1.667-1.666-1.667ZM6.875 6.458h-.417c-.92 0-1.666.747-1.666 1.667v3.75c0 .92.746 1.667 1.666 1.667h.417c.92 0 1.667-.746 1.667-1.667v-3.75c0-.92-.747-1.667-1.667-1.667Z"})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Fe),YM=Y(N(fe,{children:[N("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M3.333 16.667h13.334",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M6.875 3.125h-.417c-.92 0-1.666.746-1.666 1.667v7.083c0 .92.746 1.667 1.666 1.667h.417c.92 0 1.667-.746 1.667-1.667V4.792c0-.92-.747-1.667-1.667-1.667ZM13.542 5.817h-.417c-.92 0-1.667.747-1.667 1.667v4.391c0 .92.746 1.667 1.667 1.667h.417c.92 0 1.666-.746 1.666-1.667V7.484c0-.92-.746-1.667-1.666-1.667Z"})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Fe),WM=Y(N(fe,{children:[N("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M3.333 3.333v13.334",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M15.208 4.792H8.125c-.92 0-1.667.746-1.667 1.666v.417c0 .92.747 1.667 1.667 1.667h7.083c.92 0 1.667-.747 1.667-1.667v-.417c0-.92-.746-1.666-1.667-1.666ZM12.516 11.458H8.125c-.92 0-1.667.746-1.667 1.667v.417c0 .92.747 1.666 1.667 1.666h4.391c.92 0 1.667-.746 1.667-1.666v-.417c0-.92-.746-1.667-1.667-1.667Z"})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Fe),KM=Y(N(fe,{children:[N("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M16.667 3.333v13.334",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M11.875 4.792H4.792c-.92 0-1.667.746-1.667 1.666v.417c0 .92.746 1.667 1.667 1.667h7.083c.92 0 1.667-.747 1.667-1.667v-.417c0-.92-.746-1.666-1.667-1.666ZM11.683 11.458H7.292c-.92 0-1.667.746-1.667 1.667v.417c0 .92.746 1.666 1.667 1.666h4.39c.921 0 1.667-.746 1.667-1.666v-.417c0-.92-.746-1.667-1.666-1.667Z"})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Fe),yde=Y(N(fe,{children:[N("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M16.667 3.333v13.334M3.333 3.333v13.334",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M14.375 10.208v-.416c0-.92-.746-1.667-1.667-1.667H7.292c-.92 0-1.667.746-1.667 1.667v.416c0 .92.746 1.667 1.667 1.667h5.416c.92 0 1.667-.746 1.667-1.667Z"})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Fe),Ede=Y(N(fe,{children:[N("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M3.333 3.333h13.334M3.333 16.667h13.334",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M10.208 5.625h-.416c-.92 0-1.667.746-1.667 1.667v5.416c0 .92.746 1.667 1.667 1.667h.416c.92 0 1.667-.746 1.667-1.667V7.292c0-.92-.746-1.667-1.667-1.667Z"})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Fe),ZM=Y(N("g",{stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M1.667 10h2.916",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M8.333 10h3.334",strokeLinejoin:"round"}),g("path",{d:"M15.417 10h2.916",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M6.875 4.792h-.417c-.92 0-1.666.746-1.666 1.666v7.084c0 .92.746 1.666 1.666 1.666h.417c.92 0 1.667-.746 1.667-1.666V6.458c0-.92-.747-1.666-1.667-1.666ZM13.542 6.458h-.417c-.92 0-1.667.747-1.667 1.667v3.75c0 .92.746 1.667 1.667 1.667h.417c.92 0 1.666-.746 1.666-1.667v-3.75c0-.92-.746-1.667-1.666-1.667Z"})]}),Fe),qM=Y(N("g",{stroke:"currentColor",strokeWidth:"1.25",children:[g("path",{d:"M10 18.333v-2.916",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M10 11.667V8.333",strokeLinejoin:"round"}),g("path",{d:"M10 4.583V1.667",strokeLinecap:"round",strokeLinejoin:"round"}),g("path",{d:"M4.792 13.125v.417c0 .92.746 1.666 1.666 1.666h7.084c.92 0 1.666-.746 1.666-1.666v-.417c0-.92-.746-1.667-1.666-1.667H6.458c-.92 0-1.666.746-1.666 1.667ZM6.458 6.458v.417c0 .92.747 1.667 1.667 1.667h3.75c.92 0 1.667-.747 1.667-1.667v-.417c0-.92-.746-1.666-1.667-1.666h-3.75c-.92 0-1.667.746-1.667 1.666Z"})]}),Fe),V_=Y(N("g",{strokeWidth:"1.5",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("circle",{cx:"9",cy:"7",r:"4"}),g("path",{d:"M3 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2"}),g("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"}),g("path",{d:"M21 21v-2a4 4 0 0 0 -3 -3.85"})]}),le);Y("M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm115.7 272l-176 101c-15.8 8.8-35.7-2.5-35.7-21V152c0-18.4 19.8-29.8 35.7-21l176 107c16.4 9.2 16.4 32.9 0 42z");Y("M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm96 328c0 8.8-7.2 16-16 16H176c-8.8 0-16-7.2-16-16V176c0-8.8 7.2-16 16-16h160c8.8 0 16 7.2 16 16v160z");const Vd=Y(N(fe,{children:[g("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round",children:g("path",{d:"M15 5 5 15M5 5l10 10"})}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Fe);Y("M464 0c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48H176c-26.51 0-48-21.49-48-48V48c0-26.51 21.49-48 48-48h288M176 416c-44.112 0-80-35.888-80-80V128H48c-26.51 0-48 21.49-48 48v288c0 26.51 21.49 48 48 48h288c26.51 0 48-21.49 48-48v-48H176z",{mirror:!0});const vde=Y("M11.553 22.894a.998.998 0 00.894 0s3.037-1.516 5.465-4.097C19.616 16.987 21 14.663 21 12V5a1 1 0 00-.649-.936l-8-3a.998.998 0 00-.702 0l-8 3A1 1 0 003 5v7c0 2.663 1.384 4.987 3.088 6.797 2.428 2.581 5.465 4.097 5.465 4.097zm-1.303-8.481l6.644-6.644a.856.856 0 111.212 1.212l-7.25 7.25a.856.856 0 01-1.212 0l-3.75-3.75a.856.856 0 111.212-1.212l3.144 3.144z",{width:24});Y("M369.9 97.9L286 14C277 5 264.8-.1 252.1-.1H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V131.9c0-12.7-5.1-25-14.1-34zM332.1 128H256V51.9l76.1 76.1zM48 464V48h160v104c0 13.3 10.7 24 24 24h104v288H48zm32-48h224V288l-23.5-23.5c-4.7-4.7-12.3-4.7-17 0L176 352l-39.5-39.5c-4.7-4.7-12.3-4.7-17 0L80 352v64zm48-240c-26.5 0-48 21.5-48 48s21.5 48 48 48 48-21.5 48-48-21.5-48-48-48z",{width:384,height:512});const QM=ae.memo(({theme:e})=>Y(N(fe,{children:[g("path",{d:"M25 26H111V111H25",fill:Zr()}),g("path",{d:"M25 111C25 80.2068 25 49.4135 25 26M25 26C48.6174 26 72.2348 26 111 26H25ZM25 26C53.3671 26 81.7343 26 111 26H25ZM111 26C111 52.303 111 78.606 111 111V26ZM111 26C111 51.2947 111 76.5893 111 111V26ZM111 111C87.0792 111 63.1585 111 25 111H111ZM111 111C87.4646 111 63.9293 111 25 111H111ZM25 111C25 81.1514 25 51.3028 25 26V111Z",stroke:Zr(),strokeWidth:"2"}),g("path",{d:"M100 100H160V160H100",fill:Zr()}),g("path",{d:"M100 160C100 144.106 100 128.211 100 100M100 100C117.706 100 135.412 100 160 100H100ZM100 100C114.214 100 128.428 100 160 100H100ZM160 100C160 120.184 160 140.369 160 160V100ZM160 100C160 113.219 160 126.437 160 160V100ZM160 160C145.534 160 131.068 160 100 160H160ZM160 160C143.467 160 126.934 160 100 160H160ZM100 160C100 143.661 100 127.321 100 100V160Z",stroke:Zr(),strokeWidth:"2"}),N("g",{fill:mV(e),stroke:Zr(),strokeWidth:"6",children:[g("rect",{x:"2.5",y:"2.5",width:"30",height:"30"}),g("rect",{x:"2.5",y:"149.5",width:"30",height:"30"}),g("rect",{x:"147.5",y:"149.5",width:"30",height:"30"}),g("rect",{x:"147.5",y:"2.5",width:"30",height:"30"})]})]}),{width:182,height:182,mirror:!0})),JM=ae.memo(({theme:e})=>Y(N(fe,{children:[g("path",{d:"M25 26H111V111H25",fill:Zr()}),g("path",{d:"M25 111C25 80.2068 25 49.4135 25 26M25 26C48.6174 26 72.2348 26 111 26H25ZM25 26C53.3671 26 81.7343 26 111 26H25ZM111 26C111 52.303 111 78.606 111 111V26ZM111 26C111 51.2947 111 76.5893 111 111V26ZM111 111C87.0792 111 63.1585 111 25 111H111ZM111 111C87.4646 111 63.9293 111 25 111H111ZM25 111C25 81.1514 25 51.3028 25 26V111Z",stroke:Zr(),strokeWidth:"2"}),g("path",{d:"M100 100H160V160H100",fill:Zr()}),g("path",{d:"M100 160C100 144.106 100 128.211 100 100M100 100C117.706 100 135.412 100 160 100H100ZM100 100C114.214 100 128.428 100 160 100H100ZM160 100C160 120.184 160 140.369 160 160V100ZM160 100C160 113.219 160 126.437 160 160V100ZM160 160C145.534 160 131.068 160 100 160H160ZM160 160C143.467 160 126.934 160 100 160H160ZM100 160C100 143.661 100 127.321 100 100V160Z",stroke:Zr(),strokeWidth:"2"}),N("g",{fill:mV(e),stroke:Zr(),strokeWidth:"6",children:[g("rect",{x:"2.5",y:"2.5",width:"30",height:"30"}),g("rect",{x:"78.5",y:"149.5",width:"30",height:"30"}),g("rect",{x:"147.5",y:"149.5",width:"30",height:"30"}),g("rect",{x:"147.5",y:"78.5",width:"30",height:"30"}),g("rect",{x:"105.5",y:"2.5",width:"30",height:"30"}),g("rect",{x:"2.5",y:"102.5",width:"30",height:"30"})]})]}),{width:182,height:182,mirror:!0})),wde=Y(g("g",{strokeWidth:1.25,children:g("path",{d:"M5.879 2.625h8.242a3.27 3.27 0 0 1 3.254 3.254v8.242a3.27 3.27 0 0 1-3.254 3.254H5.88a3.27 3.27 0 0 1-3.254-3.254V5.88A3.27 3.27 0 0 1 5.88 2.626l-.001-.001ZM4.518 16.118l7.608-12.83m.198 13.934 5.051-9.897M2.778 9.675l9.348-6.387m-7.608 12.83 12.857-8.793"})}),Fe),_de=Y(N(fe,{children:[g("path",{d:"M5.879 2.625h8.242a3.254 3.254 0 0 1 3.254 3.254v8.242a3.254 3.254 0 0 1-3.254 3.254H5.88a3.254 3.254 0 0 1-3.254-3.254V5.88a3.254 3.254 0 0 1 3.254-3.254Z",stroke:"currentColor",strokeWidth:"1.25"}),g("mask",{id:"FillHachureIcon",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:2,y:2,width:16,height:16,children:g("path",{d:"M5.879 2.625h8.242a3.254 3.254 0 0 1 3.254 3.254v8.242a3.254 3.254 0 0 1-3.254 3.254H5.88a3.254 3.254 0 0 1-3.254-3.254V5.88a3.254 3.254 0 0 1 3.254-3.254Z",fill:"currentColor",stroke:"currentColor",strokeWidth:"1.25"})}),g("g",{mask:"url(#FillHachureIcon)",children:g("path",{d:"M2.258 15.156 15.156 2.258M7.324 20.222 20.222 7.325m-20.444 5.35L12.675-.222m-8.157 18.34L17.416 5.22",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})})]}),Fe),Tde=Y(N(fe,{children:[N("g",{clipPath:"url(#a)",children:[g("path",{d:"M5.879 2.625h8.242a3.254 3.254 0 0 1 3.254 3.254v8.242a3.254 3.254 0 0 1-3.254 3.254H5.88a3.254 3.254 0 0 1-3.254-3.254V5.88a3.254 3.254 0 0 1 3.254-3.254Z",stroke:"currentColor",strokeWidth:"1.25"}),g("mask",{id:"FillCrossHatchIcon",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:-1,y:-1,width:22,height:22,children:g("path",{d:"M2.426 15.044 15.044 2.426M7.383 20 20 7.383M0 12.617 12.617 0m-7.98 17.941L17.256 5.324m-2.211 12.25L2.426 4.956M20 12.617 7.383 0m5.234 20L0 7.383m17.941 7.98L5.324 2.745",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),g("g",{mask:"url(#FillCrossHatchIcon)",children:g("path",{d:"M14.121 2H5.88A3.879 3.879 0 0 0 2 5.879v8.242A3.879 3.879 0 0 0 5.879 18h8.242A3.879 3.879 0 0 0 18 14.121V5.88A3.879 3.879 0 0 0 14.121 2Z",fill:"currentColor"})})]}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Fe),Ide=Y(N(fe,{children:[g("g",{clipPath:"url(#a)",children:g("path",{d:"M4.91 2.625h10.18a2.284 2.284 0 0 1 2.285 2.284v10.182a2.284 2.284 0 0 1-2.284 2.284H4.909a2.284 2.284 0 0 1-2.284-2.284V4.909a2.284 2.284 0 0 1 2.284-2.284Z",stroke:"currentColor",strokeWidth:"1.25"})}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),{...Fe,fill:"currentColor"}),_V=Y(g(fe,{children:g("path",{d:"M4.167 10h11.666",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),Fe),Sde=Y(g("path",{d:"M5 10h10",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),Fe),xde=Y(g("path",{d:"M5 10h10",stroke:"currentColor",strokeWidth:"3.75",strokeLinecap:"round",strokeLinejoin:"round"}),Fe);ae.memo(({theme:e})=>Y(g("path",{d:"M6 10H34",stroke:Zr(),strokeWidth:2,fill:"none",strokeLinecap:"round"}),{width:40,height:20}));const Cde=Y(N("g",{strokeWidth:"2",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M5 12h2"}),g("path",{d:"M17 12h2"}),g("path",{d:"M11 12h2"})]}),le),Ade=Y(N("g",{strokeWidth:"2",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 12v.01"}),g("path",{d:"M8 12v.01"}),g("path",{d:"M12 12v.01"}),g("path",{d:"M16 12v.01"}),g("path",{d:"M20 12v.01"})]}),le),Mde=Y(g("path",{d:"M2.5 12.038c1.655-.885 5.9-3.292 8.568-4.354 2.668-1.063.101 2.821 1.32 3.104 1.218.283 5.112-1.814 5.112-1.814",strokeWidth:"1.25"}),Fe),kde=Y(g("path",{d:"M2.5 12.563c1.655-.886 5.9-3.293 8.568-4.355 2.668-1.062.101 2.822 1.32 3.105 1.218.283 5.112-1.814 5.112-1.814m-13.469 2.23c2.963-1.586 6.13-5.62 7.468-4.998 1.338.623-1.153 4.11-.132 5.595 1.02 1.487 6.133-1.43 6.133-1.43",strokeWidth:"1.25"}),Fe),Rde=Y(g("path",{d:"M2.5 11.936c1.737-.879 8.627-5.346 10.42-5.268 1.795.078-.418 5.138.345 5.736.763.598 3.53-1.789 4.235-2.147M2.929 9.788c1.164-.519 5.47-3.28 6.987-3.114 1.519.165 1 3.827 2.121 4.109 1.122.281 3.839-2.016 4.606-2.42",strokeWidth:"1.25"}),Fe),Dde=Y(N("svg",{strokeWidth:"1.5",children:[g("path",{d:"M3.33334 9.99998V6.66665C3.33334 6.04326 3.33403 4.9332 3.33539 3.33646C4.95233 3.33436 6.06276 3.33331 6.66668 3.33331H10"}),g("path",{d:"M13.3333 3.33331V3.34331"}),g("path",{d:"M16.6667 3.33331V3.34331"}),g("path",{d:"M16.6667 6.66669V6.67669"}),g("path",{d:"M16.6667 10V10.01"}),g("path",{d:"M3.33334 13.3333V13.3433"}),g("path",{d:"M16.6667 13.3333V13.3433"}),g("path",{d:"M3.33334 16.6667V16.6767"}),g("path",{d:"M6.66666 16.6667V16.6767"}),g("path",{d:"M10 16.6667V16.6767"}),g("path",{d:"M13.3333 16.6667V16.6767"}),g("path",{d:"M16.6667 16.6667V16.6767"})]}),Fe),Lde=Y(N("g",{strokeWidth:"1.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 12v-4a4 4 0 0 1 4 -4h4"}),g("line",{x1:"16",y1:"4",x2:"16",y2:"4.01"}),g("line",{x1:"20",y1:"4",x2:"20",y2:"4.01"}),g("line",{x1:"20",y1:"8",x2:"20",y2:"8.01"}),g("line",{x1:"20",y1:"12",x2:"20",y2:"12.01"}),g("line",{x1:"4",y1:"16",x2:"4",y2:"16.01"}),g("line",{x1:"20",y1:"16",x2:"20",y2:"16.01"}),g("line",{x1:"4",y1:"20",x2:"4",y2:"20.01"}),g("line",{x1:"8",y1:"20",x2:"8",y2:"20.01"}),g("line",{x1:"12",y1:"20",x2:"12",y2:"20.01"}),g("line",{x1:"16",y1:"20",x2:"16",y2:"20.01"}),g("line",{x1:"20",y1:"20",x2:"20",y2:"20.01"})]}),le),Nde=Y(N("g",{stroke:"currentColor",opacity:.3,strokeWidth:2,children:[g("path",{d:"M12 12l9 0"}),g("path",{d:"M3 9l6 6"}),g("path",{d:"M3 15l6 -6"})]}),le),J4=ae.memo(({flip:e=!1})=>Y(N("g",{transform:e?"translate(40, 0) scale(-1, 1)":"",stroke:"currentColor",strokeWidth:2,fill:"none",children:[g("path",{d:"M34 10H6M34 10L27 5M34 10L27 15"}),g("path",{d:"M27.5 5L34.5 10L27.5 15"})]}),{width:40,height:20})),Ode=ae.memo(({flip:e=!1})=>Y(N("g",{stroke:"currentColor",fill:"currentColor",transform:e?"translate(40, 0) scale(-1, 1)":"",children:[g("path",{d:"M32 10L6 10",strokeWidth:2}),g("circle",{r:"4",transform:"matrix(-1 0 0 1 30 10)"})]}),{width:40,height:20})),Pde=ae.memo(({flip:e=!1})=>Y(N("g",{stroke:"currentColor",fill:"none",transform:e?"translate(40, 0) scale(-1, 1)":"",strokeWidth:2,children:[g("path",{d:"M26 10L6 10"}),g("circle",{r:"4",transform:"matrix(-1 0 0 1 30 10)"})]}),{width:40,height:20})),Fde=ae.memo(({flip:e=!1})=>Y(g("g",{transform:e?"translate(40, 0) scale(-1, 1)":"",children:g("path",{d:"M34 10H5.99996M34 10L34 5M34 10L34 15",stroke:"currentColor",strokeWidth:2,fill:"none"})}),{width:40,height:20})),Bde=ae.memo(({flip:e=!1})=>Y(N("g",{stroke:"currentColor",fill:"currentColor",transform:e?"translate(40, 0) scale(-1, 1)":"",children:[g("path",{d:"M32 10L6 10",strokeWidth:2}),g("path",{d:"M27.5 5.5L34.5 10L27.5 14.5L27.5 5.5"})]}),{width:40,height:20})),zde=ae.memo(({flip:e=!1})=>Y(N("g",{stroke:"currentColor",fill:"none",transform:e?"translate(40, 0) scale(-1, 1)":"",strokeWidth:2,strokeLinejoin:"round",children:[g("path",{d:"M6,9.5H27"}),g("path",{d:"M27,5L34,10L27,14Z",fill:"none"})]}),{width:40,height:20})),Hde=ae.memo(({flip:e=!1})=>Y(N("g",{stroke:"currentColor",fill:"currentColor",transform:e?"translate(40, 0) scale(-1, 1)":"",strokeLinejoin:"round",strokeWidth:2,children:[g("path",{d:"M6,9.5H20"}),g("path",{d:"M27,5L34,10L27,14L20,9.5Z"})]}),{width:40,height:20})),Vde=ae.memo(({flip:e=!1})=>Y(N("g",{stroke:"currentColor",fill:"none",transform:e?"translate(40, 0) scale(-1, 1)":"",strokeLinejoin:"round",strokeWidth:2,children:[g("path",{d:"M6,9.5H20"}),g("path",{d:"M27,5L34,10L27,14L20,9.5Z"})]}),{width:40,height:20})),$de=ae.memo(({flip:e=!1})=>Y(g("g",{stroke:"currentColor",fill:"none",transform:e?"":"translate(40, 0) scale(-1, 1)",strokeLinejoin:"round",strokeWidth:2,children:g("path",{d:"M34,10 H6 M15,10 L7,5 M15,10 L7,15"})}),{width:40,height:20})),Gde=ae.memo(({flip:e=!1})=>Y(g("g",{stroke:"currentColor",fill:"none",transform:e?"":"translate(40, 0) scale(-1, 1)",strokeLinejoin:"round",strokeWidth:2,children:g("path",{d:"M34,10 H6 M15,10 L15,15 L15,5"})}),{width:40,height:20})),Xde=ae.memo(({flip:e=!1})=>Y(g("g",{stroke:"currentColor",fill:"none",transform:e?"":"translate(40, 0) scale(-1, 1)",strokeLinejoin:"round",strokeWidth:2,children:g("path",{d:"M34,10 H6 M15,10 L15,16 L15,4 M15,10 L7,5 M15,10 L7,15"})}),{width:40,height:20})),jde=Y(N(fe,{children:[g("g",{clipPath:"url(#a)",children:g("path",{d:"M14.167 6.667a3.333 3.333 0 0 0-3.334-3.334H9.167a3.333 3.333 0 0 0 0 6.667h1.666a3.333 3.333 0 0 1 0 6.667H9.167a3.333 3.333 0 0 1-3.334-3.334",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Fe),Yde=Y(N(fe,{children:[g("g",{clipPath:"url(#a)",children:g("path",{d:"M5 16.667V3.333L10 15l5-11.667v13.334",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Fe),Wde=Y(N(fe,{children:[g("g",{clipPath:"url(#a)",children:g("path",{d:"M5.833 3.333v13.334h8.334",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Fe),Kde=Y(g(fe,{children:g("path",{d:"m1.667 3.333 6.666 13.334M8.333 3.333 1.667 16.667M11.667 3.333v13.334h6.666",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})}),Fe),uy=Y(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 7v-2h13v2"}),g("path",{d:"M10 5v14"}),g("path",{d:"M12 19h-4"}),g("path",{d:"M15 13v-1h6v1"}),g("path",{d:"M18 12v7"}),g("path",{d:"M17 19h2"})]}),le),Zde=Y(g(fe,{children:N("g",{stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M7 12h10"}),g("path",{d:"M7 5v14"}),g("path",{d:"M17 5v14"}),g("path",{d:"M15 19h4"}),g("path",{d:"M15 5h4"}),g("path",{d:"M5 19h4"}),g("path",{d:"M5 5h4"})]})}),le),ev=Y(g(fe,{children:g("g",{stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round",children:g("path",{d:"M5.833 16.667v-10a3.333 3.333 0 0 1 3.334-3.334h1.666a3.333 3.333 0 0 1 3.334 3.334v10M5.833 10.833h8.334"})})}),Fe),TV=Y(N(fe,{children:[g("g",{clipPath:"url(#a)",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round",children:g("path",{d:"M5.833 6.667 2.5 10l3.333 3.333M14.167 6.667 17.5 10l-3.333 3.333M11.667 3.333 8.333 16.667"})}),g("defs",{children:g("clipPath",{id:"a",children:g("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]}),Fe),qde=Y(N("g",{stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"8",x2:"20",y2:"8"}),g("line",{x1:"4",y1:"12",x2:"12",y2:"12"}),g("line",{x1:"4",y1:"16",x2:"16",y2:"16"})]}),le),Qde=Y(N("g",{stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"8",x2:"20",y2:"8"}),g("line",{x1:"8",y1:"12",x2:"16",y2:"12"}),g("line",{x1:"6",y1:"16",x2:"18",y2:"16"})]}),le),Jde=Y(N("g",{stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"8",x2:"20",y2:"8"}),g("line",{x1:"10",y1:"12",x2:"20",y2:"12"}),g("line",{x1:"8",y1:"16",x2:"20",y2:"16"})]}),le),efe=ae.memo(({theme:e})=>Y(N("g",{strokeWidth:"1.5",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"4",x2:"20",y2:"4"}),g("rect",{x:"9",y:"8",width:"6",height:"12",rx:"2"})]}),le)),tfe=ae.memo(({theme:e})=>Y(N("g",{strokeWidth:"2",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"20",x2:"20",y2:"20"}),g("rect",{x:"9",y:"4",width:"6",height:"12",rx:"2"})]}),le)),nfe=ae.memo(({theme:e})=>Y(N("g",{strokeWidth:"1.5",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("line",{x1:"4",y1:"12",x2:"9",y2:"12"}),g("line",{x1:"15",y1:"12",x2:"20",y2:"12"}),g("rect",{x:"9",y:"6",width:"6",height:"12",rx:"2"})]}),le)),IV=Y(N("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M21 19h-18l9 -15"}),g("path",{d:"M20.615 15.171h.015"}),g("path",{d:"M19.515 11.771h.015"}),g("path",{d:"M17.715 8.671h.015"}),g("path",{d:"M15.415 5.971h.015"})]}),le),ife=Y(g("path",{d:"M537.6 226.6c4.1-10.7 6.4-22.4 6.4-34.6 0-53-43-96-96-96-19.7 0-38.1 6-53.3 16.2C367 64.2 315.3 32 256 32c-88.4 0-160 71.6-160 160 0 2.7.1 5.4.2 8.1C40.2 219.8 0 273.2 0 336c0 79.5 64.5 144 144 144h368c70.7 0 128-57.3 128-128 0-61.9-44-113.6-102.4-125.4zM393.4 288H328v112c0 8.8-7.2 16-16 16h-48c-8.8 0-16-7.2-16-16V288h-65.4c-14.3 0-21.4-17.2-11.3-27.3l105.4-105.4c6.2-6.2 16.4-6.2 22.6 0l105.4 105.4c10.1 10.1 2.9 27.3-11.3 27.3z",fill:"currentColor"}),{width:640,height:512});Y(g("path",{d:"M480 416C497.7 416 512 430.3 512 448C512 465.7 497.7 480 480 480H150.6C133.7 480 117.4 473.3 105.4 461.3L25.37 381.3C.3786 356.3 .3786 315.7 25.37 290.7L258.7 57.37C283.7 32.38 324.3 32.38 349.3 57.37L486.6 194.7C511.6 219.7 511.6 260.3 486.6 285.3L355.9 416H480zM265.4 416L332.7 348.7L195.3 211.3L70.63 336L150.6 416L265.4 416z"}));const SV=Y(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M8 13v-7.5a1.5 1.5 0 0 1 3 0v6.5"}),g("path",{d:"M11 5.5v-2a1.5 1.5 0 1 1 3 0v8.5"}),g("path",{d:"M14 5.5a1.5 1.5 0 0 1 3 0v6.5"}),g("path",{d:"M17 7.5a1.5 1.5 0 0 1 3 0v8.5a6 6 0 0 1 -6 6h-2h.208a6 6 0 0 1 -5.012 -2.7a69.74 69.74 0 0 1 -.196 -.3c-.312 -.479 -1.407 -2.388 -3.286 -5.728a1.5 1.5 0 0 1 .536 -2.022a1.867 1.867 0 0 1 2.28 .28l1.47 1.47"})]}),le),ek=Y(N(fe,{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2"}),g("path",{d:"M7 11l5 5l5 -5"}),g("path",{d:"M12 4l0 12"})]}),le),xp=Y(N(fe,{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"}),g("path",{d:"M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"})]}),le),sfe=Y(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M7 17m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"}),g("path",{d:"M17 17m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"}),g("path",{d:"M9.15 14.85l8.85 -10.85"}),g("path",{d:"M6 4l8.85 10.85"})]}),le),rfe=Y(N(fe,{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"}),g("path",{d:"M12 17l0 .01"}),g("path",{d:"M12 13.5a1.5 1.5 0 0 1 1 -1.5a2.6 2.6 0 1 0 -3 -4"})]}),le),ofe=Y(N(fe,{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M7 4v16l13 -8z"})]}),le),afe=Y(N(fe,{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M17 4h-10a3 3 0 0 0 -3 3v10a3 3 0 0 0 3 3h10a3 3 0 0 0 3 -3v-10a3 3 0 0 0 -3 -3z",strokeWidth:"0",fill:"currentColor"})]}),le),lfe=Y(N(fe,{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M5 12l5 5l10 -10"})]}),le),cfe=Y(N(fe,{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M10.24 3.957l-8.422 14.06a1.989 1.989 0 0 0 1.7 2.983h16.845a1.989 1.989 0 0 0 1.7 -2.983l-8.423 -14.06a1.989 1.989 0 0 0 -3.4 0z"}),g("path",{d:"M12 9v4"}),g("path",{d:"M12 17h.01"})]}),le),ufe=Y(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M11 7l6 6"}),g("path",{d:"M4 16l11.7 -11.7a1 1 0 0 1 1.4 0l2.6 2.6a1 1 0 0 1 0 1.4l-11.7 11.7h-4v-4z"})]}),le),tv=Y(N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M12 3l-4 7h8z"}),g("path",{d:"M17 17m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"}),g("path",{d:"M4 14m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z"})]}),le),Qu=Y(N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 7l16 0"}),g("path",{d:"M4 17l16 0"}),g("path",{d:"M7 4l0 16"}),g("path",{d:"M17 4l0 16"})]}),le),$_=Y(g("path",{fill:"currentColor",d:"M407.48,111.18C335.587,108.103 269.573,152.338 245.08,220C220.587,152.338 154.573,108.103 82.68,111.18C80.285,168.229 107.577,222.632 154.74,254.82C178.908,271.419 193.35,298.951 193.27,328.27L193.27,379.13L296.9,379.13L296.9,328.27C296.816,298.953 311.255,271.42 335.42,254.82C382.596,222.644 409.892,168.233 407.48,111.18Z"})),F2=Y(N("g",{strokeWidth:"1.25",children:[g("path",{d:"M4.16602 10H15.8327"}),g("path",{d:"M12.5 13.3333L15.8333 10"}),g("path",{d:"M12.5 6.66666L15.8333 9.99999"})]}),Fe),pm=Y(N("g",{fill:"none",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round",transform:"rotate(90 10 10)",children:[g("path",{clipRule:"evenodd",d:"m9.644 13.69 7.774-7.773a2.357 2.357 0 0 0-3.334-3.334l-7.773 7.774L8 12l1.643 1.69Z"}),g("path",{d:"m13.25 3.417 3.333 3.333M10 10l2-2M5 15l3-3M2.156 17.894l1-1M5.453 19.029l-.144-1.407M2.377 11.887l.866 1.118M8.354 17.273l-1.194-.758M.953 14.652l1.408.13"})]}),20),C6=Y(N("g",{stroke:"currentColor",fill:"none",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z"}),g("path",{d:"M6 21l15 -15l-3 -3l-15 15l3 3"}),g("path",{d:"M15 6l3 3"}),g("path",{d:"M9 3a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"}),g("path",{d:"M19 13a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"})]}),le);Y(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z"}),g("path",{d:"M6 21l15 -15l-3 -3l-15 15l3 3"}),g("path",{d:"M15 6l3 3"}),g("path",{d:"M9 3a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"}),g("path",{d:"M19 13a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"})]}),le);Y(N("g",{stroke:"currentColor",fill:"none",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M11.217 19.384a3.501 3.501 0 0 0 6.783 -1.217v-5.167l-6 -3.35"}),g("path",{d:"M5.214 15.014a3.501 3.501 0 0 0 4.446 5.266l4.34 -2.534v-6.946"}),g("path",{d:"M6 7.63c-1.391 -.236 -2.787 .395 -3.534 1.689a3.474 3.474 0 0 0 1.271 4.745l4.263 2.514l6 -3.348"}),g("path",{d:"M12.783 4.616a3.501 3.501 0 0 0 -6.783 1.217v5.067l6 3.45"}),g("path",{d:"M18.786 8.986a3.501 3.501 0 0 0 -4.446 -5.266l-4.34 2.534v6.946"}),g("path",{d:"M18 16.302c1.391 .236 2.787 -.395 3.534 -1.689a3.474 3.474 0 0 0 -1.271 -4.745l-4.308 -2.514l-5.955 3.42"})]}),le);const dfe=Y(N("g",{stroke:"currentColor",fill:"none",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 8v-2a2 2 0 0 1 2 -2h2"}),g("path",{d:"M4 16v2a2 2 0 0 0 2 2h2"}),g("path",{d:"M16 4h2a2 2 0 0 1 2 2v2"}),g("path",{d:"M16 20h2a2 2 0 0 0 2 -2v-2"})]}),le),G_=Y(N("g",{stroke:"currentColor",fill:"none",strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0"}),g("path",{d:"M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6"})]}),le),ffe=Y(N("g",{stroke:"currentColor",fill:"none",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M10.585 10.587a2 2 0 0 0 2.829 2.828"}),g("path",{d:"M16.681 16.673a8.717 8.717 0 0 1 -4.681 1.327c-3.6 0 -6.6 -2 -9 -6c1.272 -2.12 2.712 -3.678 4.32 -4.674m2.86 -1.146a9.055 9.055 0 0 1 1.82 -.18c3.6 0 6.6 2 9 6c-.666 1.11 -1.379 2.067 -2.138 2.87"}),g("path",{d:"M3 3l18 18"})]}),le),hfe=Y(N("g",{stroke:"currentColor",fill:"none",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M15.5 13a3.5 3.5 0 0 0 -3.5 3.5v1a3.5 3.5 0 0 0 7 0v-1.8"}),g("path",{d:"M8.5 13a3.5 3.5 0 0 1 3.5 3.5v1a3.5 3.5 0 0 1 -7 0v-1.8"}),g("path",{d:"M17.5 16a3.5 3.5 0 0 0 0 -7h-.5"}),g("path",{d:"M19 9.3v-2.8a3.5 3.5 0 0 0 -7 0"}),g("path",{d:"M6.5 16a3.5 3.5 0 0 1 0 -7h.5"}),g("path",{d:"M5 9.3v-2.8a3.5 3.5 0 0 1 7 0v10"})]}),le),gfe=Y(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M15.5 13a3.5 3.5 0 0 0 -3.5 3.5v1a3.5 3.5 0 0 0 7 0v-1.8"}),g("path",{d:"M8.5 13a3.5 3.5 0 0 1 3.5 3.5v1a3.5 3.5 0 0 1 -7 0v-1.8"}),g("path",{d:"M17.5 16a3.5 3.5 0 0 0 0 -7h-.5"}),g("path",{d:"M19 9.3v-2.8a3.5 3.5 0 0 0 -7 0"}),g("path",{d:"M6.5 16a3.5 3.5 0 0 1 0 -7h.5"}),g("path",{d:"M5 9.3v-2.8a3.5 3.5 0 0 1 7 0v10"})]}),le),pd=Y(N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0"}),g("path",{d:"M21 21l-6 -6"})]}),le),mfe=Y(N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M20.984 12.53a9 9 0 1 0 -7.552 8.355"}),g("path",{d:"M12 7v5l3 3"}),g("path",{d:"M19 16l-2 3h4l-2 3"})]}),le),pfe=Y(N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M9 2m0 3a3 3 0 0 1 3 -3h0a3 3 0 0 1 3 3v5a3 3 0 0 1 -3 3h0a3 3 0 0 1 -3 -3z"}),g("path",{d:"M5 10a7 7 0 0 0 14 0"}),g("path",{d:"M8 21l8 0"}),g("path",{d:"M12 17l0 4"})]}),le),Ufe=Y(N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 3l18 18"}),g("path",{d:"M9 5a3 3 0 0 1 6 0v5a3 3 0 0 1 -.13 .874m-2 2a3 3 0 0 1 -3.87 -2.872v-1"}),g("path",{d:"M5 10a7 7 0 0 0 10.846 5.85m2 -2a6.967 6.967 0 0 0 1.152 -3.85"}),g("path",{d:"M8 21l8 0"}),g("path",{d:"M12 17l0 4"})]}),le),nv=Y(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M13 3l0 7l6 0l-8 11l0 -7l-6 0l8 -11"})]}),le),bfe=Y(N("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M8 8m0 1a1 1 0 0 1 1 -1h6a1 1 0 0 1 1 1v6a1 1 0 0 1 -1 1h-6a1 1 0 0 1 -1 -1z"}),g("path",{d:"M12 20v.01"}),g("path",{d:"M16 20v.01"}),g("path",{d:"M8 20v.01"}),g("path",{d:"M4 20v.01"}),g("path",{d:"M4 16v.01"}),g("path",{d:"M4 12v.01"}),g("path",{d:"M4 8v.01"}),g("path",{d:"M4 4v.01"}),g("path",{d:"M8 4v.01"}),g("path",{d:"M12 4v.01"}),g("path",{d:"M16 4v.01"}),g("path",{d:"M20 4v.01"}),g("path",{d:"M20 8v.01"}),g("path",{d:"M20 12v.01"}),g("path",{d:"M20 16v.01"}),g("path",{d:"M20 20v.01"})]}),le),yfe=Y(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M5 3v18"}),g("path",{d:"M19 21v-18"}),g("path",{d:"M5 7h14"}),g("path",{d:"M5 15h14"}),g("path",{d:"M8 13v4"}),g("path",{d:"M11 13v4"}),g("path",{d:"M16 13v4"}),g("path",{d:"M14 5v4"}),g("path",{d:"M11 5v4"}),g("path",{d:"M8 5v4"}),g("path",{d:"M3 21h18"})]}),le),Efe=Y(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 12l18 0"}),g("path",{d:"M7 16l10 0l-10 5l0 -5"}),g("path",{d:"M7 8l10 0l-10 -5l0 5"})]}),le),vfe=Y(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M12 3l0 18"}),g("path",{d:"M16 7l0 10l5 0l-5 -10"}),g("path",{d:"M8 7l0 10l-5 0l5 -10"})]}),le),xV=Y(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z"}),g("path",{d:"M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2"}),g("path",{d:"M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z"})]}),le),X_=Y(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M15 15m-5 0a5 5 0 1 0 10 0a5 5 0 1 0 -10 0"}),g("path",{d:"M22 22l-3 -3"}),g("path",{d:"M6 18h-1a2 2 0 0 1 -2 -2v-1"}),g("path",{d:"M3 11v-1"}),g("path",{d:"M3 6v-1a2 2 0 0 1 2 -2h1"}),g("path",{d:"M10 3h1"}),g("path",{d:"M15 3h1a2 2 0 0 1 2 2v1"})]}),le),wfe=Y(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M14 3v4a1 1 0 0 0 1 1h4"}),g("path",{d:"M5 12v-7a2 2 0 0 1 2 -2h7l5 5v4"}),g("path",{d:"M4 20.25c0 .414 .336 .75 .75 .75h1.25a1 1 0 0 0 1 -1v-1a1 1 0 0 0 -1 -1h-1a1 1 0 0 1 -1 -1v-1a1 1 0 0 1 1 -1h1.25a.75 .75 0 0 1 .75 .75"}),g("path",{d:"M10 15l2 6l2 -6"}),g("path",{d:"M20 15h-1a2 2 0 0 0 -2 2v2a2 2 0 0 0 2 2h1v-3"})]}),le),_fe=Y(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M14 3v4a1 1 0 0 0 1 1h4"}),g("path",{d:"M5 12v-7a2 2 0 0 1 2 -2h7l5 5v4"}),g("path",{d:"M20 15h-1a2 2 0 0 0 -2 2v2a2 2 0 0 0 2 2h1v-3"}),g("path",{d:"M5 18h1.5a1.5 1.5 0 0 0 0 -3h-1.5v6"}),g("path",{d:"M11 21v-6l3 6v-6"})]}),le),Tfe=Y(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 13v-8a2 2 0 0 1 2 -2h1a2 2 0 0 1 2 2v8a2 2 0 0 0 6 0v-8a2 2 0 0 1 2 -2h1a2 2 0 0 1 2 2v8a8 8 0 0 1 -16 0"}),g("path",{d:"M4 8l5 0"}),g("path",{d:"M15 8l4 0"})]}),le),Ife=Y(N("g",{strokeWidth:1.25,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 14c.83 .642 2.077 1.017 3.5 1c1.423 .017 2.67 -.358 3.5 -1c.83 -.642 2.077 -1.017 3.5 -1c1.423 -.017 2.67 .358 3.5 1"}),g("path",{d:"M8 3a2.4 2.4 0 0 0 -1 2a2.4 2.4 0 0 0 1 2"}),g("path",{d:"M12 3a2.4 2.4 0 0 0 -1 2a2.4 2.4 0 0 0 1 2"}),g("path",{d:"M3 10h14v5a6 6 0 0 1 -6 6h-2a6 6 0 0 1 -6 -6v-5z"}),g("path",{d:"M16.746 16.726a3 3 0 1 0 .252 -5.555"})]}),le),Sfe=Y(N("g",{stroke:"currentColor",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 5a1 1 0 0 1 1-1h16a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1h-16a1 1 0 0 1-1-1v-10zM7 20h10M9 16v4M15 16v4"})]}),{...le,strokeWidth:1.5}),CV=Y(N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M15 8v-2a2 2 0 0 0 -2 -2h-7a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h7a2 2 0 0 0 2 -2v-2"}),g("path",{d:"M21 12h-13l3 -3"}),g("path",{d:"M11 15l-3 -3"})]}),le),AV=Y(N("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M2 8a4 4 0 0 1 4 -4h12a4 4 0 0 1 4 4v8a4 4 0 0 1 -4 4h-12a4 4 0 0 1 -4 -4v-8z"}),g("path",{d:"M10 9l5 3l-5 3z"})]}),le),xfe=Y(N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M3 6h18"}),g("path",{d:"M3 12h18"}),g("path",{d:"M3 18h18"}),g("path",{d:"M6 3v18"}),g("path",{d:"M12 3v18"}),g("path",{d:"M18 3v18"})]}),le),Cfe=Y(N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M17 3m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z"}),g("path",{d:"M3 17m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z"}),g("path",{d:"M17 5c-6.627 0 -12 5.373 -12 12"})]}),le),j_=Y(N("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M6 18l12 -12"}),g("path",{d:"M18 10v-4h-4"})]}),le),Y_=Y(N("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4,19L10,19C11.097,19 12,18.097 12,17L12,9C12,7.903 12.903,7 14,7L21,7"}),g("path",{d:"M18 4l3 3l-3 3"})]}),le),W_=Y(N("g",{children:[g("path",{d:"M16,12L20,9L16,6"}),g("path",{d:"M6 20c0 -6.075 4.925 -11 11 -11h3"})]}),le),MV=Y(N("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M6 9l6 6l6 -6"})]}),le),Afe=Y(N("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M6 15l6 -6l6 6"})]}),le),Mfe=Y(N("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M6 15l6 -6l6 6"})]}),le),tk=Y(N("g",{strokeWidth:"1.25",children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M8 5v10a1 1 0 0 0 1 1h10"}),g("path",{d:"M5 8h10a1 1 0 0 1 1 1v10"})]}),le),kV=Y(N("g",{children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M5 5m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M19 5m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M5 19m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M19 19m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M5 7l0 10"}),g("path",{d:"M7 5l10 0"}),g("path",{d:"M7 19l10 0"}),g("path",{d:"M19 7l0 10"})]}),le);Y(N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M4 11v8a1 1 0 0 0 1 1h8m-9 -14v-1a1 1 0 0 1 1 -1h1m5 0h2m5 0h1a1 1 0 0 1 1 1v1m0 5v2m0 5v1a1 1 0 0 1 -1 1h-1"}),g("path",{d:"M4 12h7a1 1 0 0 1 1 1v7"})]}),le);const kfe=Y(N("g",{strokeWidth:1.5,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M14 6m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M4 6l8 0"}),g("path",{d:"M16 6l4 0"}),g("path",{d:"M8 12m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M4 12l2 0"}),g("path",{d:"M10 12l10 0"}),g("path",{d:"M17 18m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}),g("path",{d:"M4 18l11 0"}),g("path",{d:"M19 18l1 0"})]}),le),Rfe=Y(N("g",{strokeWidth:1,children:[g("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),g("path",{d:"M6 10l4 -4 L6 14l8 -8 L6 18l12 -12 L10 18l8 -8 L14 18l4 -4"})]}),le);class Dfe extends Error{constructor(t="Couldn't export canvas.",n="CANVAS_ERROR"){super(),this.name=n,this.message=t}}class Gh extends DOMException{constructor(t="Request Aborted"){super(t,"AbortError")}}class Lu extends Error{constructor(n="Image Scene Data Error",i="IMAGE_SCENE_DATA_ERROR"){super(n);F(this,"code");this.name="EncodingError",this.code=i}}class RV extends Error{constructor(n="Worker URL is not defined!",i="WORKER_URL_NOT_DEFINED"){super(n);F(this,"code");this.name="WorkerUrlNotDefinedError",this.code=i}}class DV extends Error{constructor(n="Worker has to be in a separate chunk!",i="WORKER_IN_THE_MAIN_CHUNK"){super(n);F(this,"code");this.name="WorkerInTheMainChunkError",this.code=i}}class qr extends Error{constructor(t){super(t),this.name="ExcalidrawError"}}const cl=({size:e="1em",circleWidth:t=8,synchronized:n=!1,className:i=""})=>{const r=-(ae.useRef(Date.now()).current%1600);return g("div",{className:`Spinner ${i}`,children:g("svg",{viewBox:"0 0 100 100",style:{width:e,height:e,"--spinner-delay":n?`${r}ms`:0},children:g("circle",{cx:"50",cy:"50",r:50-t/2,strokeWidth:t,fill:"none",strokeMiterlimit:"10"})})})},$e=ae.forwardRef(({size:e="medium",visible:t=!0,className:n="",...i},s)=>{const{id:r}=Lr(),o=ae.useRef(null);ae.useImperativeHandle(s,()=>o.current);const a=`ToolIcon_size_${e}`,[l,c]=D.useState(!1),u=D.useRef(!0),d=async h=>{var p;const m="onClick"in i&&((p=i.onClick)==null?void 0:p.call(i,h));if(mp(m))try{c(!0),await m}catch(U){if(U instanceof Gh)console.warn(U);else throw U}finally{u.current&&c(!1)}};D.useEffect(()=>(u.current=!0,()=>{u.current=!1}),[]);const f=D.useRef(null);if(i.type==="button"||i.type==="icon"||i.type==="submit"){const h=i.type==="icon"?"button":i.type;return N("button",{className:re("ToolIcon_type_button",a,n,t&&!i.hidden?"ToolIcon_type_button--show":"ToolIcon_type_button--hide",{ToolIcon:!i.hidden,"ToolIcon--selected":i.selected,"ToolIcon--plain":i.type==="icon"}),style:i.style,"data-testid":i["data-testid"],hidden:i.hidden,title:i.title,"aria-label":i["aria-label"],type:h,onClick:d,ref:o,disabled:l||i.isLoading||!!i.disabled,children:[(i.icon||i.label)&&N("div",{className:"ToolIcon__icon","aria-hidden":"true","aria-disabled":!!i.disabled,children:[i.icon||i.label,i.keyBindingLabel&&g("span",{className:"ToolIcon__keybinding",children:i.keyBindingLabel}),i.isLoading&&g(cl,{})]}),i.showAriaLabel&&N("div",{className:"ToolIcon__label",children:[i["aria-label"]," ",l&&g(cl,{})]}),i.children]})}return N("label",{className:re("ToolIcon",n),title:i.title,onPointerDown:h=>{var m;f.current=h.pointerType||null,(m=i.onPointerDown)==null||m.call(i,{pointerType:h.pointerType||null})},onPointerUp:()=>{requestAnimationFrame(()=>{f.current=null})},children:[g("input",{className:`ToolIcon_type_radio ${a}`,type:"radio",name:i.name,"aria-label":i["aria-label"],"aria-keyshortcuts":i["aria-keyshortcuts"],"data-testid":i["data-testid"],id:`${r}-${i.id}`,onChange:()=>{var h;(h=i.onChange)==null||h.call(i,{pointerType:f.current})},checked:i.checked,ref:o}),N("div",{className:"ToolIcon__icon",children:[i.icon,i.keyBindingLabel&&g("span",{className:"ToolIcon__keybinding",children:i.keyBindingLabel})]})]})});$e.displayName="ToolButton";let iv=[];const ce=e=>(iv=iv.concat(e),e),Lfe=(e,t,n)=>{const i=new Set(Ve(e.filter(u=>Ee(u)),t).map(u=>u.id)),s={},r=n.scene.getNonDeletedElementsMap(),o=new Set;for(const u of i){const d=Js(e,u);for(const f of d)if(!o.has(f.id)){if(zt(f)){const h=jn(f,r);h&&(s[h.id]=!0)}else s[f.id]=!0;o.add(f.id)}}let a=!0;const l=e.map(u=>{if(t.selectedElementIds[u.id]){const d=zt(u)?jn(u,r):null;return u.frameId&&i.has(u.frameId)?(a=!1,s[u.id]=!0,u):d!=null&&d.frameId&&i.has(d==null?void 0:d.frameId)?u:(u.boundElements&&u.boundElements.forEach(f=>{var m,p;const h=n.scene.getNonDeletedElementsMap().get(f.id);h&&ge(h)&&n.scene.mutateElement(h,{startBinding:u.id===((m=h.startBinding)==null?void 0:m.elementId)?null:h.startBinding,endBinding:u.id===((p=h.endBinding)==null?void 0:p.elementId)?null:h.endBinding})}),Te(u,{isDeleted:!0}))}return u.frameId&&i.has(u.frameId)?(a=!1,zt(u)||(s[u.id]=!0),Te(u,{frameId:null})):zt(u)&&t.selectedElementIds[u.containerId]?Te(u,{isDeleted:!0}):u});let c=t.editingGroupId;if(a&&t.editingGroupId){const u=Ct(l,t.editingGroupId).filter(d=>!d.isDeleted);if(u.length>1)u[0]&&(s[u[0].id]=!0);else{c=null,u[0]&&(s[u[0].id]=!0);const d=u[0];if(d){const f=d.groupIds.findIndex(m=>m===t.editingGroupId),h=d.groupIds[f+1];if(h){const m=Ct(l,h).filter(p=>!p.isDeleted);m.length>1&&(c=h,m.forEach(p=>{s[p.id]=!0}))}}}}return{elements:l,appState:{...t,...Ii({selectedElementIds:s,editingGroupId:c},l,t,null)}}},nk=(e,t)=>{if(e.editingGroupId){const n=Ct(jt(t),e.editingGroupId);if(n.length)return{...e,selectedElementIds:{[n[0].id]:!0}}}return e},LV=ce({name:"deleteSelectedElements",label:"labels.delete",icon:Hc,trackEvent:{category:"element",action:"delete"},perform:(e,t,n,i)=>{var o;if((o=t.selectedLinearElement)!=null&&o.isEditing){const{elementId:a,selectedPointsIndices:l,startBindingElement:c,endBindingElement:u}=t.selectedLinearElement,d=i.scene.getNonDeletedElementsMap(),f=pe.getElement(a,d);if(!f||l==null)return!1;if(l.length>=f.points.length){const m=e.map(U=>U.id===f.id?Te(U,{isDeleted:!0}):U),p=nk(t,m);return{elements:m,appState:{...p,selectedLinearElement:null},captureUpdate:K.IMMEDIATELY}}const h={startBindingElement:l!=null&&l.includes(0)?null:c,endBindingElement:l!=null&&l.includes(f.points.length-1)?null:u};return pe.deletePoints(f,i,l),{elements:e,appState:{...t,selectedLinearElement:{...t.selectedLinearElement,...h,selectedPointsIndices:(l==null?void 0:l[0])>0?[l[0]-1]:[0]}},captureUpdate:K.IMMEDIATELY}}let{elements:s,appState:r}=Lfe(e,t,i);return Uz(s,s.filter(a=>a.isDeleted)),r=nk(r,s),{elements:s,appState:{...r,activeTool:en(t,{type:i.state.preferredSelectionTool.type}),multiElement:null,activeEmbeddable:null,selectedLinearElement:null},captureUpdate:Yn(jt(e),t)?K.IMMEDIATELY:K.EVENTUALLY}},keyTest:(e,t,n)=>(e.key===H.BACKSPACE||e.key===H.DELETE)&&!e[H.CTRL_OR_CMD],PanelComponent:({elements:e,appState:t,updateData:n})=>g($e,{type:"button",icon:Hc,title:M("labels.delete"),"aria-label":M("labels.delete"),onClick:()=>n(null),disabled:!Yn(jt(e),t),style:{...t.stylesPanelMode==="mobile"&&t.openPopup!=="compactOtherProperties"?dp:{}}})}),J=e=>e.replace(/\b(Opt(?:ion)?|Alt)\b/i,M(so?"keys.option":"keys.alt")).replace(/\bShift\b/i,M("keys.shift")).replace(/\b(Enter|Return)\b/i,M("keys.enter")).replace(/\b(Ctrl|Cmd|Command|CtrlOrCmd)\b/gi,M(so?"keys.cmd":"keys.ctrl")).replace(/\b(Esc(?:ape)?)\b/i,M("keys.escape")).replace(/\b(Space(?:bar)?)\b/i,M("keys.spacebar")).replace(/\b(Del(?:ete)?)\b/i,M("keys.delete")),Nfe=ce({name:"sendBackward",label:"labels.sendBackward",keywords:["move down","zindex","layer"],icon:$M,trackEvent:{category:"element"},perform:(e,t,n,i)=>({elements:_ue(e,t,i.scene),appState:t,captureUpdate:K.IMMEDIATELY}),keyPriority:40,keyTest:e=>e[H.CTRL_OR_CMD]&&!e.shiftKey&&e.code===tt.BRACKET_LEFT,PanelComponent:({updateData:e,appState:t})=>g("button",{type:"button",className:"zIndexButton",onClick:()=>e(null),title:`${M("labels.sendBackward")}  ${J("CtrlOrCmd+[")}`,children:$M})}),Ofe=ce({name:"bringForward",label:"labels.bringForward",keywords:["move up","zindex","layer"],icon:VM,trackEvent:{category:"element"},perform:(e,t,n,i)=>({elements:Tue(e,t,i.scene),appState:t,captureUpdate:K.IMMEDIATELY}),keyPriority:40,keyTest:e=>e[H.CTRL_OR_CMD]&&!e.shiftKey&&e.code===tt.BRACKET_RIGHT,PanelComponent:({updateData:e,appState:t})=>g("button",{type:"button",className:"zIndexButton",onClick:()=>e(null),title:`${M("labels.bringForward")}  ${J("CtrlOrCmd+]")}`,children:VM})}),Pfe=ce({name:"sendToBack",label:"labels.sendToBack",keywords:["move down","zindex","layer"],icon:XM,trackEvent:{category:"element"},perform:(e,t)=>({elements:Iue(e,t),appState:t,captureUpdate:K.IMMEDIATELY}),keyTest:e=>so?e[H.CTRL_OR_CMD]&&e.altKey&&e.code===tt.BRACKET_LEFT:e[H.CTRL_OR_CMD]&&e.shiftKey&&e.code===tt.BRACKET_LEFT,PanelComponent:({updateData:e,appState:t})=>g("button",{type:"button",className:"zIndexButton",onClick:()=>e(null),title:`${M("labels.sendToBack")}  ${J(so?"CtrlOrCmd+Alt+[":"CtrlOrCmd+Shift+[")}`,children:XM})}),Ffe=ce({name:"bringToFront",label:"labels.bringToFront",keywords:["move up","zindex","layer"],icon:GM,trackEvent:{category:"element"},perform:(e,t)=>({elements:Sue(e,t),appState:t,captureUpdate:K.IMMEDIATELY}),keyTest:e=>so?e[H.CTRL_OR_CMD]&&e.altKey&&e.code===tt.BRACKET_RIGHT:e[H.CTRL_OR_CMD]&&e.shiftKey&&e.code===tt.BRACKET_RIGHT,PanelComponent:({updateData:e,appState:t})=>g("button",{type:"button",className:"zIndexButton",onClick:n=>e(null),title:`${M("labels.bringToFront")}  ${J(so?"CtrlOrCmd+Alt+]":"CtrlOrCmd+Shift+]")}`,children:GM})}),Bfe=ce({name:"selectAll",label:"labels.selectAll",icon:bfe,trackEvent:{category:"canvas"},viewMode:!1,perform:(e,t,n,i)=>{var r;if((r=t.selectedLinearElement)!=null&&r.isEditing)return!1;const s=e.filter(o=>!o.isDeleted&&!(de(o)&&o.containerId)&&!o.locked).reduce((o,a)=>(o[a.id]=!0,o),{});return{appState:{...t,...Ii({editingGroupId:null,selectedElementIds:s},jt(e),t,i),selectedLinearElement:Object.keys(s).length===1&&Se(e[0])?new pe(e[0],ve(e)):null},captureUpdate:K.IMMEDIATELY}},keyTest:e=>e[H.CTRL_OR_CMD]&&e.key===H.A}),zfe=ce({name:"duplicateSelection",label:"labels.duplicateSelection",icon:Z4,trackEvent:{category:"element"},perform:(e,t,n,i)=>{var o;if(t.selectedElementsAreBeingDragged)return!1;if((o=t.selectedLinearElement)!=null&&o.isEditing)try{const a=pe.duplicateSelectedPoints(t,i.scene);return{elements:e,appState:a,captureUpdate:K.IMMEDIATELY}}catch{return!1}let{duplicatedElements:s,elementsWithDuplicates:r}=E0({type:"in-place",elements:e,idsOfElementsToDuplicate:ve(Ve(e,t,{includeBoundTextElement:!0,includeElementsInFrames:!0})),appState:t,randomizeSeed:!0,overrides:({origElement:a,origIdToDuplicateId:l})=>{const c=a.frameId&&l.get(a.frameId);return{x:a.x+Vb/2,y:a.y+Vb/2,frameId:c??a.frameId}}});if(i.props.onDuplicate&&r){const a=i.props.onDuplicate(r,e);a&&(r=a)}return{elements:oo(r,ve(s)),appState:{...t,..._z(s,jt(r),t)},captureUpdate:K.IMMEDIATELY}},keyTest:e=>e[H.CTRL_OR_CMD]&&e.key===H.D,PanelComponent:({elements:e,appState:t,updateData:n})=>g($e,{type:"button",icon:Z4,title:`${M("labels.duplicateSelection")}  ${J("CtrlOrCmd+D")}`,"aria-label":M("labels.duplicateSelection"),onClick:()=>n(null),disabled:!Yn(jt(e),t),style:{...t.stylesPanelMode==="mobile"&&t.openPopup!=="compactOtherProperties"?dp:{}}})});var Hfe={VITE_APP_BACKEND_V2_GET_URL:"https://json.excalidraw.com/api/v2/",VITE_APP_BACKEND_V2_POST_URL:"https://json.excalidraw.com/api/v2/post/",VITE_APP_LIBRARY_URL:"https://libraries.excalidraw.com",VITE_APP_LIBRARY_BACKEND:"https://us-central1-excalidraw-room-persistence.cloudfunctions.net/libraries",VITE_APP_PLUS_LP:"https://plus.excalidraw.com",VITE_APP_PLUS_APP:"https://app.excalidraw.com",VITE_APP_AI_BACKEND:"https://oss-ai.excalidraw.com",VITE_APP_WS_SERVER_URL:"https://oss-collab.excalidraw.com",VITE_APP_FIREBASE_CONFIG:'{"apiKey":"AIzaSyAd15pYlMci_xIp9ko6wkEsDzAAA0Dn0RU","authDomain":"excalidraw-room-persistence.firebaseapp.com","databaseURL":"https://excalidraw-room-persistence.firebaseio.com","projectId":"excalidraw-room-persistence","storageBucket":"excalidraw-room-persistence.appspot.com","messagingSenderId":"654800341332","appId":"1:654800341332:web:4a692de832b55bd57ce0c1"}',VITE_APP_ENABLE_TRACKING:"true",VITE_APP_PLUS_EXPORT_PUBLIC_KEY:`MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEApQ0jM9Qz8TdFLzcuAZZX
/WvuKSOJxiw6AR/ZcE3eFQWM/mbFdhQgyK8eHGkKQifKzH1xUZjCxyXcxW6ZO02t
kPOPxhz+nxUrIoWCD/V4NGmUA1lxwHuO21HN1gzKrN3xHg5EGjyouR9vibT9VDGF
gq6+4Ic/kJX+AD2MM7Yre2+FsOdysrmuW2Fu3ahuC1uQE7pOe1j0k7auNP0y1q53
PrB8Ts2LUpepWC1l7zIXFm4ViDULuyWXTEpUcHSsEH8vpd1tckjypxCwkipfZsXx
iPszy0o0Dx2iArPfWMXlFAI9mvyFCyFC3+nSvfyAUb2C4uZgCwAuyFh/ydPF4DEE
PQIDAQAB`,VITE_APP_DEBUG_ENABLE_TEXT_CONTAINER_BOUNDING_BOX:"false",VITE_APP_COLLAPSE_OVERLAY:"false",VITE_APP_ENABLE_ESLINT:"false",VITE_APP_GIT_SHA:"4e0441eeb413ad7234f65cbb8fbb397bc715ff46",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const Vfe=new Set(["command_palette","export"]),Qe=(e,t,n,i)=>{try{if(typeof window>"u"||Hfe.VITE_WORKER_ID||!Vfe.has(e))return;F9(),window.sa_event&&window.sa_event(t,{category:e,label:n,value:i})}catch(s){console.error("error during analytics",s)}},K_=D.forwardRef((e,t)=>{const{title:n,className:i,testId:s,active:r,standalone:o,icon:a,onClick:l}=e;return g("button",{type:"button",ref:t,title:n,"data-testid":s,className:re(i,{standalone:o,active:r}),onClick:l,style:e.style,children:a},n)}),la=e=>g(fe,{children:e.options.map(t=>e.type==="button"?g(K_,{icon:t.icon,title:t.text,testId:t.testId,active:t.active??e.value===t.value,onClick:n=>e.onClick(t.value,n)},t.text):N("label",{className:re({active:e.value===t.value}),title:t.text,children:[g("input",{type:"radio",name:e.group,onChange:()=>e.onChange(t.value),checked:e.value===t.value,"data-testid":t.testId}),t.icon]},t.text))});function Ri(e,t,{checkForDefaultPrevented:n=!0}={}){return function(s){if(e==null||e(s),n===!1||!s.defaultPrevented)return t==null?void 0:t(s)}}function ik(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function NV(...e){return t=>{let n=!1;const i=e.map(s=>{const r=ik(s,t);return!n&&typeof r=="function"&&(n=!0),r});if(n)return()=>{for(let s=0;s<i.length;s++){const r=i[s];typeof r=="function"?r():ik(e[s],null)}}}}function lo(...e){return D.useCallback(NV(...e),e)}function Cp(e,t=[]){let n=[];function i(r,o){const a=D.createContext(o),l=n.length;n=[...n,o];const c=d=>{var b;const{scope:f,children:h,...m}=d,p=((b=f==null?void 0:f[e])==null?void 0:b[l])||a,U=D.useMemo(()=>m,Object.values(m));return g(p.Provider,{value:U,children:h})};c.displayName=r+"Provider";function u(d,f){var p;const h=((p=f==null?void 0:f[e])==null?void 0:p[l])||a,m=D.useContext(h);if(m)return m;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${r}\``)}return[c,u]}const s=()=>{const r=n.map(o=>D.createContext(o));return function(a){const l=(a==null?void 0:a[e])||r;return D.useMemo(()=>({[`__scope${e}`]:{...a,[e]:l}}),[a,l])}};return s.scopeName=e,[i,$fe(s,...t)]}function $fe(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const i=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(r){const o=i.reduce((a,{useScope:l,scopeName:c})=>{const d=l(r)[`__scope${c}`];return{...a,...d}},{});return D.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return n.scopeName=t.scopeName,n}var Um=D.forwardRef((e,t)=>{const{children:n,...i}=e,s=D.Children.toArray(n),r=s.find(Xfe);if(r){const o=r.props.children,a=s.map(l=>l===r?D.Children.count(o)>1?D.Children.only(null):D.isValidElement(o)?o.props.children:null:l);return g(sv,{...i,ref:t,children:D.isValidElement(o)?D.cloneElement(o,void 0,a):null})}return g(sv,{...i,ref:t,children:n})});Um.displayName="Slot";var sv=D.forwardRef((e,t)=>{const{children:n,...i}=e;if(D.isValidElement(n)){const s=Yfe(n),r=jfe(i,n.props);return n.type!==D.Fragment&&(r.ref=t?NV(t,s):s),D.cloneElement(n,r)}return D.Children.count(n)>1?D.Children.only(null):null});sv.displayName="SlotClone";var Gfe=({children:e})=>g(fe,{children:e});function Xfe(e){return D.isValidElement(e)&&e.type===Gfe}function jfe(e,t){const n={...t};for(const i in t){const s=e[i],r=t[i];/^on[A-Z]/.test(i)?s&&r?n[i]=(...a)=>{r(...a),s(...a)}:s&&(n[i]=s):i==="style"?n[i]={...s,...r}:i==="className"&&(n[i]=[s,r].filter(Boolean).join(" "))}return{...e,...n}}function Yfe(e){var i,s;let t=(i=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:i.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var Wfe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],ps=Wfe.reduce((e,t)=>{const n=D.forwardRef((i,s)=>{const{asChild:r,...o}=i,a=r?Um:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),g(a,{...o,ref:s})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function Kfe(e,t){e&&hi.flushSync(()=>e.dispatchEvent(t))}function ul(e){const t=D.useRef(e);return D.useEffect(()=>{t.current=e}),D.useMemo(()=>(...n)=>{var i;return(i=t.current)==null?void 0:i.call(t,...n)},[])}function Zfe(e,t=globalThis==null?void 0:globalThis.document){const n=ul(e);D.useEffect(()=>{const i=s=>{s.key==="Escape"&&n(s)};return t.addEventListener("keydown",i,{capture:!0}),()=>t.removeEventListener("keydown",i,{capture:!0})},[n,t])}var qfe="DismissableLayer",rv="dismissableLayer.update",Qfe="dismissableLayer.pointerDownOutside",Jfe="dismissableLayer.focusOutside",sk,OV=D.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),PV=D.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:i,onPointerDownOutside:s,onFocusOutside:r,onInteractOutside:o,onDismiss:a,...l}=e,c=D.useContext(OV),[u,d]=D.useState(null),f=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,h]=D.useState({}),m=lo(t,_=>d(_)),p=Array.from(c.layers),[U]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),b=p.indexOf(U),y=u?p.indexOf(u):-1,w=c.layersWithOutsidePointerEventsDisabled.size>0,v=y>=b,I=nhe(_=>{const T=_.target,k=[...c.branches].some(S=>S.contains(T));!v||k||(s==null||s(_),o==null||o(_),_.defaultPrevented||a==null||a())},f),C=ihe(_=>{const T=_.target;[...c.branches].some(S=>S.contains(T))||(r==null||r(_),o==null||o(_),_.defaultPrevented||a==null||a())},f);return Zfe(_=>{y===c.layers.size-1&&(i==null||i(_),!_.defaultPrevented&&a&&(_.preventDefault(),a()))},f),D.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(sk=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),rk(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=sk)}},[u,f,n,c]),D.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),rk())},[u,c]),D.useEffect(()=>{const _=()=>h({});return document.addEventListener(rv,_),()=>document.removeEventListener(rv,_)},[]),g(ps.div,{...l,ref:m,style:{pointerEvents:w?v?"auto":"none":void 0,...e.style},onFocusCapture:Ri(e.onFocusCapture,C.onFocusCapture),onBlurCapture:Ri(e.onBlurCapture,C.onBlurCapture),onPointerDownCapture:Ri(e.onPointerDownCapture,I.onPointerDownCapture)})});PV.displayName=qfe;var ehe="DismissableLayerBranch",the=D.forwardRef((e,t)=>{const n=D.useContext(OV),i=D.useRef(null),s=lo(t,i);return D.useEffect(()=>{const r=i.current;if(r)return n.branches.add(r),()=>{n.branches.delete(r)}},[n.branches]),g(ps.div,{...e,ref:s})});the.displayName=ehe;function nhe(e,t=globalThis==null?void 0:globalThis.document){const n=ul(e),i=D.useRef(!1),s=D.useRef(()=>{});return D.useEffect(()=>{const r=a=>{if(a.target&&!i.current){let l=function(){FV(Qfe,n,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=l,t.addEventListener("click",s.current,{once:!0})):l()}else t.removeEventListener("click",s.current);i.current=!1},o=window.setTimeout(()=>{t.addEventListener("pointerdown",r)},0);return()=>{window.clearTimeout(o),t.removeEventListener("pointerdown",r),t.removeEventListener("click",s.current)}},[t,n]),{onPointerDownCapture:()=>i.current=!0}}function ihe(e,t=globalThis==null?void 0:globalThis.document){const n=ul(e),i=D.useRef(!1);return D.useEffect(()=>{const s=r=>{r.target&&!i.current&&FV(Jfe,n,{originalEvent:r},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,n]),{onFocusCapture:()=>i.current=!0,onBlurCapture:()=>i.current=!1}}function rk(){const e=new CustomEvent(rv);document.dispatchEvent(e)}function FV(e,t,n,{discrete:i}){const s=n.originalEvent.target,r=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),i?Kfe(s,r):s.dispatchEvent(r)}var H8=0;function she(){D.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??ok()),document.body.insertAdjacentElement("beforeend",e[1]??ok()),H8++,()=>{H8===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),H8--}},[])}function ok(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var V8="focusScope.autoFocusOnMount",$8="focusScope.autoFocusOnUnmount",ak={bubbles:!1,cancelable:!0},rhe="FocusScope",BV=D.forwardRef((e,t)=>{const{loop:n=!1,trapped:i=!1,onMountAutoFocus:s,onUnmountAutoFocus:r,...o}=e,[a,l]=D.useState(null),c=ul(s),u=ul(r),d=D.useRef(null),f=lo(t,p=>l(p)),h=D.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;D.useEffect(()=>{if(i){let p=function(w){if(h.paused||!a)return;const v=w.target;a.contains(v)?d.current=v:Bl(d.current,{select:!0})},U=function(w){if(h.paused||!a)return;const v=w.relatedTarget;v!==null&&(a.contains(v)||Bl(d.current,{select:!0}))},b=function(w){if(document.activeElement===document.body)for(const I of w)I.removedNodes.length>0&&Bl(a)};document.addEventListener("focusin",p),document.addEventListener("focusout",U);const y=new MutationObserver(b);return a&&y.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",p),document.removeEventListener("focusout",U),y.disconnect()}}},[i,a,h.paused]),D.useEffect(()=>{if(a){ck.add(h);const p=document.activeElement;if(!a.contains(p)){const b=new CustomEvent(V8,ak);a.addEventListener(V8,c),a.dispatchEvent(b),b.defaultPrevented||(ohe(dhe(zV(a)),{select:!0}),document.activeElement===p&&Bl(a))}return()=>{a.removeEventListener(V8,c),setTimeout(()=>{const b=new CustomEvent($8,ak);a.addEventListener($8,u),a.dispatchEvent(b),b.defaultPrevented||Bl(p??document.body,{select:!0}),a.removeEventListener($8,u),ck.remove(h)},0)}}},[a,c,u,h]);const m=D.useCallback(p=>{if(!n&&!i||h.paused)return;const U=p.key==="Tab"&&!p.altKey&&!p.ctrlKey&&!p.metaKey,b=document.activeElement;if(U&&b){const y=p.currentTarget,[w,v]=ahe(y);w&&v?!p.shiftKey&&b===v?(p.preventDefault(),n&&Bl(w,{select:!0})):p.shiftKey&&b===w&&(p.preventDefault(),n&&Bl(v,{select:!0})):b===y&&p.preventDefault()}},[n,i,h.paused]);return g(ps.div,{tabIndex:-1,...o,ref:f,onKeyDown:m})});BV.displayName=rhe;function ohe(e,{select:t=!1}={}){const n=document.activeElement;for(const i of e)if(Bl(i,{select:t}),document.activeElement!==n)return}function ahe(e){const t=zV(e),n=lk(t,e),i=lk(t.reverse(),e);return[n,i]}function zV(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:i=>{const s=i.tagName==="INPUT"&&i.type==="hidden";return i.disabled||i.hidden||s?NodeFilter.FILTER_SKIP:i.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function lk(e,t){for(const n of e)if(!lhe(n,{upTo:t}))return n}function lhe(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function che(e){return e instanceof HTMLInputElement&&"select"in e}function Bl(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&che(e)&&t&&e.select()}}var ck=uhe();function uhe(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=uk(e,t),e.unshift(t)},remove(t){var n;e=uk(e,t),(n=e[0])==null||n.resume()}}}function uk(e,t){const n=[...e],i=n.indexOf(t);return i!==-1&&n.splice(i,1),n}function dhe(e){return e.filter(t=>t.tagName!=="A")}var Ud=globalThis!=null&&globalThis.document?D.useLayoutEffect:()=>{},fhe=HZ.useId||(()=>{}),hhe=0;function Z_(e){const[t,n]=D.useState(fhe());return Ud(()=>{n(i=>i??String(hhe++))},[e]),e||(t?`radix-${t}`:"")}const ghe=["top","right","bottom","left"],Vc=Math.min,Bs=Math.max,A6=Math.round,BU=Math.floor,Xo=e=>({x:e,y:e}),mhe={left:"right",right:"left",bottom:"top",top:"bottom"},phe={start:"end",end:"start"};function ov(e,t,n){return Bs(e,Vc(t,n))}function dl(e,t){return typeof e=="function"?e(t):e}function fl(e){return e.split("-")[0]}function _g(e){return e.split("-")[1]}function q_(e){return e==="x"?"y":"x"}function Q_(e){return e==="y"?"height":"width"}function $c(e){return["top","bottom"].includes(fl(e))?"y":"x"}function J_(e){return q_($c(e))}function Uhe(e,t,n){n===void 0&&(n=!1);const i=_g(e),s=J_(e),r=Q_(s);let o=s==="x"?i===(n?"end":"start")?"right":"left":i==="start"?"bottom":"top";return t.reference[r]>t.floating[r]&&(o=M6(o)),[o,M6(o)]}function bhe(e){const t=M6(e);return[av(e),t,av(t)]}function av(e){return e.replace(/start|end/g,t=>phe[t])}function yhe(e,t,n){const i=["left","right"],s=["right","left"],r=["top","bottom"],o=["bottom","top"];switch(e){case"top":case"bottom":return n?t?s:i:t?i:s;case"left":case"right":return t?r:o;default:return[]}}function Ehe(e,t,n,i){const s=_g(e);let r=yhe(fl(e),n==="start",i);return s&&(r=r.map(o=>o+"-"+s),t&&(r=r.concat(r.map(av)))),r}function M6(e){return e.replace(/left|right|bottom|top/g,t=>mhe[t])}function vhe(e){return{top:0,right:0,bottom:0,left:0,...e}}function HV(e){return typeof e!="number"?vhe(e):{top:e,right:e,bottom:e,left:e}}function k6(e){const{x:t,y:n,width:i,height:s}=e;return{width:i,height:s,top:n,left:t,right:t+i,bottom:n+s,x:t,y:n}}function dk(e,t,n){let{reference:i,floating:s}=e;const r=$c(t),o=J_(t),a=Q_(o),l=fl(t),c=r==="y",u=i.x+i.width/2-s.width/2,d=i.y+i.height/2-s.height/2,f=i[a]/2-s[a]/2;let h;switch(l){case"top":h={x:u,y:i.y-s.height};break;case"bottom":h={x:u,y:i.y+i.height};break;case"right":h={x:i.x+i.width,y:d};break;case"left":h={x:i.x-s.width,y:d};break;default:h={x:i.x,y:i.y}}switch(_g(t)){case"start":h[o]-=f*(n&&c?-1:1);break;case"end":h[o]+=f*(n&&c?-1:1);break}return h}const whe=async(e,t,n)=>{const{placement:i="bottom",strategy:s="absolute",middleware:r=[],platform:o}=n,a=r.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(t));let c=await o.getElementRects({reference:e,floating:t,strategy:s}),{x:u,y:d}=dk(c,i,l),f=i,h={},m=0;for(let p=0;p<a.length;p++){const{name:U,fn:b}=a[p],{x:y,y:w,data:v,reset:I}=await b({x:u,y:d,initialPlacement:i,placement:f,strategy:s,middlewareData:h,rects:c,platform:o,elements:{reference:e,floating:t}});u=y??u,d=w??d,h={...h,[U]:{...h[U],...v}},I&&m<=50&&(m++,typeof I=="object"&&(I.placement&&(f=I.placement),I.rects&&(c=I.rects===!0?await o.getElementRects({reference:e,floating:t,strategy:s}):I.rects),{x:u,y:d}=dk(c,f,l)),p=-1)}return{x:u,y:d,placement:f,strategy:s,middlewareData:h}};async function bm(e,t){var n;t===void 0&&(t={});const{x:i,y:s,platform:r,rects:o,elements:a,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:f=!1,padding:h=0}=dl(t,e),m=HV(h),U=a[f?d==="floating"?"reference":"floating":d],b=k6(await r.getClippingRect({element:(n=await(r.isElement==null?void 0:r.isElement(U)))==null||n?U:U.contextElement||await(r.getDocumentElement==null?void 0:r.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),y=d==="floating"?{x:i,y:s,width:o.floating.width,height:o.floating.height}:o.reference,w=await(r.getOffsetParent==null?void 0:r.getOffsetParent(a.floating)),v=await(r.isElement==null?void 0:r.isElement(w))?await(r.getScale==null?void 0:r.getScale(w))||{x:1,y:1}:{x:1,y:1},I=k6(r.convertOffsetParentRelativeRectToViewportRelativeRect?await r.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:y,offsetParent:w,strategy:l}):y);return{top:(b.top-I.top+m.top)/v.y,bottom:(I.bottom-b.bottom+m.bottom)/v.y,left:(b.left-I.left+m.left)/v.x,right:(I.right-b.right+m.right)/v.x}}const _he=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:i,placement:s,rects:r,platform:o,elements:a,middlewareData:l}=t,{element:c,padding:u=0}=dl(e,t)||{};if(c==null)return{};const d=HV(u),f={x:n,y:i},h=J_(s),m=Q_(h),p=await o.getDimensions(c),U=h==="y",b=U?"top":"left",y=U?"bottom":"right",w=U?"clientHeight":"clientWidth",v=r.reference[m]+r.reference[h]-f[h]-r.floating[m],I=f[h]-r.reference[h],C=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let _=C?C[w]:0;(!_||!await(o.isElement==null?void 0:o.isElement(C)))&&(_=a.floating[w]||r.floating[m]);const T=v/2-I/2,k=_/2-p[m]/2-1,S=Vc(d[b],k),R=Vc(d[y],k),P=S,L=_-p[m]-R,X=_/2-p[m]/2+T,G=ov(P,X,L),z=!l.arrow&&_g(s)!=null&&X!==G&&r.reference[m]/2-(X<P?S:R)-p[m]/2<0,V=z?X<P?X-P:X-L:0;return{[h]:f[h]+V,data:{[h]:G,centerOffset:X-G-V,...z&&{alignmentOffset:V}},reset:z}}}),The=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,i;const{placement:s,middlewareData:r,rects:o,initialPlacement:a,platform:l,elements:c}=t,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:f,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:p=!0,...U}=dl(e,t);if((n=r.arrow)!=null&&n.alignmentOffset)return{};const b=fl(s),y=$c(a),w=fl(a)===a,v=await(l.isRTL==null?void 0:l.isRTL(c.floating)),I=f||(w||!p?[M6(a)]:bhe(a)),C=m!=="none";!f&&C&&I.push(...Ehe(a,p,m,v));const _=[a,...I],T=await bm(t,U),k=[];let S=((i=r.flip)==null?void 0:i.overflows)||[];if(u&&k.push(T[b]),d){const X=Uhe(s,o,v);k.push(T[X[0]],T[X[1]])}if(S=[...S,{placement:s,overflows:k}],!k.every(X=>X<=0)){var R,P;const X=(((R=r.flip)==null?void 0:R.index)||0)+1,G=_[X];if(G)return{data:{index:X,overflows:S},reset:{placement:G}};let z=(P=S.filter(V=>V.overflows[0]<=0).sort((V,$)=>V.overflows[1]-$.overflows[1])[0])==null?void 0:P.placement;if(!z)switch(h){case"bestFit":{var L;const V=(L=S.filter($=>{if(C){const j=$c($.placement);return j===y||j==="y"}return!0}).map($=>[$.placement,$.overflows.filter(j=>j>0).reduce((j,W)=>j+W,0)]).sort(($,j)=>$[1]-j[1])[0])==null?void 0:L[0];V&&(z=V);break}case"initialPlacement":z=a;break}if(s!==z)return{reset:{placement:z}}}return{}}}};function fk(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function hk(e){return ghe.some(t=>e[t]>=0)}const Ihe=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:i="referenceHidden",...s}=dl(e,t);switch(i){case"referenceHidden":{const r=await bm(t,{...s,elementContext:"reference"}),o=fk(r,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:hk(o)}}}case"escaped":{const r=await bm(t,{...s,altBoundary:!0}),o=fk(r,n.floating);return{data:{escapedOffsets:o,escaped:hk(o)}}}default:return{}}}}};async function She(e,t){const{placement:n,platform:i,elements:s}=e,r=await(i.isRTL==null?void 0:i.isRTL(s.floating)),o=fl(n),a=_g(n),l=$c(n)==="y",c=["left","top"].includes(o)?-1:1,u=r&&l?-1:1,d=dl(t,e);let{mainAxis:f,crossAxis:h,alignmentAxis:m}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return a&&typeof m=="number"&&(h=a==="end"?m*-1:m),l?{x:h*u,y:f*c}:{x:f*c,y:h*u}}const xhe=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,i;const{x:s,y:r,placement:o,middlewareData:a}=t,l=await She(t,e);return o===((n=a.offset)==null?void 0:n.placement)&&(i=a.arrow)!=null&&i.alignmentOffset?{}:{x:s+l.x,y:r+l.y,data:{...l,placement:o}}}}},Che=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:i,placement:s}=t,{mainAxis:r=!0,crossAxis:o=!1,limiter:a={fn:U=>{let{x:b,y}=U;return{x:b,y}}},...l}=dl(e,t),c={x:n,y:i},u=await bm(t,l),d=$c(fl(s)),f=q_(d);let h=c[f],m=c[d];if(r){const U=f==="y"?"top":"left",b=f==="y"?"bottom":"right",y=h+u[U],w=h-u[b];h=ov(y,h,w)}if(o){const U=d==="y"?"top":"left",b=d==="y"?"bottom":"right",y=m+u[U],w=m-u[b];m=ov(y,m,w)}const p=a.fn({...t,[f]:h,[d]:m});return{...p,data:{x:p.x-n,y:p.y-i,enabled:{[f]:r,[d]:o}}}}}},Ahe=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:i,placement:s,rects:r,middlewareData:o}=t,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=dl(e,t),u={x:n,y:i},d=$c(s),f=q_(d);let h=u[f],m=u[d];const p=dl(a,t),U=typeof p=="number"?{mainAxis:p,crossAxis:0}:{mainAxis:0,crossAxis:0,...p};if(l){const w=f==="y"?"height":"width",v=r.reference[f]-r.floating[w]+U.mainAxis,I=r.reference[f]+r.reference[w]-U.mainAxis;h<v?h=v:h>I&&(h=I)}if(c){var b,y;const w=f==="y"?"width":"height",v=["top","left"].includes(fl(s)),I=r.reference[d]-r.floating[w]+(v&&((b=o.offset)==null?void 0:b[d])||0)+(v?0:U.crossAxis),C=r.reference[d]+r.reference[w]+(v?0:((y=o.offset)==null?void 0:y[d])||0)-(v?U.crossAxis:0);m<I?m=I:m>C&&(m=C)}return{[f]:h,[d]:m}}}},Mhe=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,i;const{placement:s,rects:r,platform:o,elements:a}=t,{apply:l=()=>{},...c}=dl(e,t),u=await bm(t,c),d=fl(s),f=_g(s),h=$c(s)==="y",{width:m,height:p}=r.floating;let U,b;d==="top"||d==="bottom"?(U=d,b=f===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(b=d,U=f==="end"?"top":"bottom");const y=p-u.top-u.bottom,w=m-u.left-u.right,v=Vc(p-u[U],y),I=Vc(m-u[b],w),C=!t.middlewareData.shift;let _=v,T=I;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(T=w),(i=t.middlewareData.shift)!=null&&i.enabled.y&&(_=y),C&&!f){const S=Bs(u.left,0),R=Bs(u.right,0),P=Bs(u.top,0),L=Bs(u.bottom,0);h?T=m-2*(S!==0||R!==0?S+R:Bs(u.left,u.right)):_=p-2*(P!==0||L!==0?P+L:Bs(u.top,u.bottom))}await l({...t,availableWidth:T,availableHeight:_});const k=await o.getDimensions(a.floating);return m!==k.width||p!==k.height?{reset:{rects:!0}}:{}}}};function dy(){return typeof window<"u"}function Tg(e){return VV(e)?(e.nodeName||"").toLowerCase():"#document"}function er(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function ca(e){var t;return(t=(VV(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function VV(e){return dy()?e instanceof Node||e instanceof er(e).Node:!1}function co(e){return dy()?e instanceof Element||e instanceof er(e).Element:!1}function na(e){return dy()?e instanceof HTMLElement||e instanceof er(e).HTMLElement:!1}function gk(e){return!dy()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof er(e).ShadowRoot}function Ap(e){const{overflow:t,overflowX:n,overflowY:i,display:s}=uo(e);return/auto|scroll|overlay|hidden|clip/.test(t+i+n)&&!["inline","contents"].includes(s)}function khe(e){return["table","td","th"].includes(Tg(e))}function fy(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function eT(e){const t=tT(),n=co(e)?uo(e):e;return["transform","translate","scale","rotate","perspective"].some(i=>n[i]?n[i]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(i=>(n.willChange||"").includes(i))||["paint","layout","strict","content"].some(i=>(n.contain||"").includes(i))}function Rhe(e){let t=Gc(e);for(;na(t)&&!Xh(t);){if(eT(t))return t;if(fy(t))return null;t=Gc(t)}return null}function tT(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Xh(e){return["html","body","#document"].includes(Tg(e))}function uo(e){return er(e).getComputedStyle(e)}function hy(e){return co(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Gc(e){if(Tg(e)==="html")return e;const t=e.assignedSlot||e.parentNode||gk(e)&&e.host||ca(e);return gk(t)?t.host:t}function $V(e){const t=Gc(e);return Xh(t)?e.ownerDocument?e.ownerDocument.body:e.body:na(t)&&Ap(t)?t:$V(t)}function ym(e,t,n){var i;t===void 0&&(t=[]),n===void 0&&(n=!0);const s=$V(e),r=s===((i=e.ownerDocument)==null?void 0:i.body),o=er(s);if(r){const a=lv(o);return t.concat(o,o.visualViewport||[],Ap(s)?s:[],a&&n?ym(a):[])}return t.concat(s,ym(s,[],n))}function lv(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function GV(e){const t=uo(e);let n=parseFloat(t.width)||0,i=parseFloat(t.height)||0;const s=na(e),r=s?e.offsetWidth:n,o=s?e.offsetHeight:i,a=A6(n)!==r||A6(i)!==o;return a&&(n=r,i=o),{width:n,height:i,$:a}}function nT(e){return co(e)?e:e.contextElement}function gh(e){const t=nT(e);if(!na(t))return Xo(1);const n=t.getBoundingClientRect(),{width:i,height:s,$:r}=GV(t);let o=(r?A6(n.width):n.width)/i,a=(r?A6(n.height):n.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const Dhe=Xo(0);function XV(e){const t=er(e);return!tT()||!t.visualViewport?Dhe:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function Lhe(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==er(e)?!1:t}function bd(e,t,n,i){t===void 0&&(t=!1),n===void 0&&(n=!1);const s=e.getBoundingClientRect(),r=nT(e);let o=Xo(1);t&&(i?co(i)&&(o=gh(i)):o=gh(e));const a=Lhe(r,n,i)?XV(r):Xo(0);let l=(s.left+a.x)/o.x,c=(s.top+a.y)/o.y,u=s.width/o.x,d=s.height/o.y;if(r){const f=er(r),h=i&&co(i)?er(i):i;let m=f,p=lv(m);for(;p&&i&&h!==m;){const U=gh(p),b=p.getBoundingClientRect(),y=uo(p),w=b.left+(p.clientLeft+parseFloat(y.paddingLeft))*U.x,v=b.top+(p.clientTop+parseFloat(y.paddingTop))*U.y;l*=U.x,c*=U.y,u*=U.x,d*=U.y,l+=w,c+=v,m=er(p),p=lv(m)}}return k6({width:u,height:d,x:l,y:c})}function iT(e,t){const n=hy(e).scrollLeft;return t?t.left+n:bd(ca(e)).left+n}function jV(e,t,n){n===void 0&&(n=!1);const i=e.getBoundingClientRect(),s=i.left+t.scrollLeft-(n?0:iT(e,i)),r=i.top+t.scrollTop;return{x:s,y:r}}function Nhe(e){let{elements:t,rect:n,offsetParent:i,strategy:s}=e;const r=s==="fixed",o=ca(i),a=t?fy(t.floating):!1;if(i===o||a&&r)return n;let l={scrollLeft:0,scrollTop:0},c=Xo(1);const u=Xo(0),d=na(i);if((d||!d&&!r)&&((Tg(i)!=="body"||Ap(o))&&(l=hy(i)),na(i))){const h=bd(i);c=gh(i),u.x=h.x+i.clientLeft,u.y=h.y+i.clientTop}const f=o&&!d&&!r?jV(o,l,!0):Xo(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+f.x,y:n.y*c.y-l.scrollTop*c.y+u.y+f.y}}function Ohe(e){return Array.from(e.getClientRects())}function Phe(e){const t=ca(e),n=hy(e),i=e.ownerDocument.body,s=Bs(t.scrollWidth,t.clientWidth,i.scrollWidth,i.clientWidth),r=Bs(t.scrollHeight,t.clientHeight,i.scrollHeight,i.clientHeight);let o=-n.scrollLeft+iT(e);const a=-n.scrollTop;return uo(i).direction==="rtl"&&(o+=Bs(t.clientWidth,i.clientWidth)-s),{width:s,height:r,x:o,y:a}}function Fhe(e,t){const n=er(e),i=ca(e),s=n.visualViewport;let r=i.clientWidth,o=i.clientHeight,a=0,l=0;if(s){r=s.width,o=s.height;const c=tT();(!c||c&&t==="fixed")&&(a=s.offsetLeft,l=s.offsetTop)}return{width:r,height:o,x:a,y:l}}function Bhe(e,t){const n=bd(e,!0,t==="fixed"),i=n.top+e.clientTop,s=n.left+e.clientLeft,r=na(e)?gh(e):Xo(1),o=e.clientWidth*r.x,a=e.clientHeight*r.y,l=s*r.x,c=i*r.y;return{width:o,height:a,x:l,y:c}}function mk(e,t,n){let i;if(t==="viewport")i=Fhe(e,n);else if(t==="document")i=Phe(ca(e));else if(co(t))i=Bhe(t,n);else{const s=XV(e);i={x:t.x-s.x,y:t.y-s.y,width:t.width,height:t.height}}return k6(i)}function YV(e,t){const n=Gc(e);return n===t||!co(n)||Xh(n)?!1:uo(n).position==="fixed"||YV(n,t)}function zhe(e,t){const n=t.get(e);if(n)return n;let i=ym(e,[],!1).filter(a=>co(a)&&Tg(a)!=="body"),s=null;const r=uo(e).position==="fixed";let o=r?Gc(e):e;for(;co(o)&&!Xh(o);){const a=uo(o),l=eT(o);!l&&a.position==="fixed"&&(s=null),(r?!l&&!s:!l&&a.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||Ap(o)&&!l&&YV(e,o))?i=i.filter(u=>u!==o):s=a,o=Gc(o)}return t.set(e,i),i}function Hhe(e){let{element:t,boundary:n,rootBoundary:i,strategy:s}=e;const o=[...n==="clippingAncestors"?fy(t)?[]:zhe(t,this._c):[].concat(n),i],a=o[0],l=o.reduce((c,u)=>{const d=mk(t,u,s);return c.top=Bs(d.top,c.top),c.right=Vc(d.right,c.right),c.bottom=Vc(d.bottom,c.bottom),c.left=Bs(d.left,c.left),c},mk(t,a,s));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function Vhe(e){const{width:t,height:n}=GV(e);return{width:t,height:n}}function $he(e,t,n){const i=na(t),s=ca(t),r=n==="fixed",o=bd(e,!0,r,t);let a={scrollLeft:0,scrollTop:0};const l=Xo(0);if(i||!i&&!r)if((Tg(t)!=="body"||Ap(s))&&(a=hy(t)),i){const f=bd(t,!0,r,t);l.x=f.x+t.clientLeft,l.y=f.y+t.clientTop}else s&&(l.x=iT(s));const c=s&&!i&&!r?jV(s,a):Xo(0),u=o.left+a.scrollLeft-l.x-c.x,d=o.top+a.scrollTop-l.y-c.y;return{x:u,y:d,width:o.width,height:o.height}}function G8(e){return uo(e).position==="static"}function pk(e,t){if(!na(e)||uo(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return ca(e)===n&&(n=n.ownerDocument.body),n}function WV(e,t){const n=er(e);if(fy(e))return n;if(!na(e)){let s=Gc(e);for(;s&&!Xh(s);){if(co(s)&&!G8(s))return s;s=Gc(s)}return n}let i=pk(e,t);for(;i&&khe(i)&&G8(i);)i=pk(i,t);return i&&Xh(i)&&G8(i)&&!eT(i)?n:i||Rhe(e)||n}const Ghe=async function(e){const t=this.getOffsetParent||WV,n=this.getDimensions,i=await n(e.floating);return{reference:$he(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}};function Xhe(e){return uo(e).direction==="rtl"}const jhe={convertOffsetParentRelativeRectToViewportRelativeRect:Nhe,getDocumentElement:ca,getClippingRect:Hhe,getOffsetParent:WV,getElementRects:Ghe,getClientRects:Ohe,getDimensions:Vhe,getScale:gh,isElement:co,isRTL:Xhe};function KV(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function Yhe(e,t){let n=null,i;const s=ca(e);function r(){var a;clearTimeout(i),(a=n)==null||a.disconnect(),n=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),r();const c=e.getBoundingClientRect(),{left:u,top:d,width:f,height:h}=c;if(a||t(),!f||!h)return;const m=BU(d),p=BU(s.clientWidth-(u+f)),U=BU(s.clientHeight-(d+h)),b=BU(u),w={rootMargin:-m+"px "+-p+"px "+-U+"px "+-b+"px",threshold:Bs(0,Vc(1,l))||1};let v=!0;function I(C){const _=C[0].intersectionRatio;if(_!==l){if(!v)return o();_?o(!1,_):i=setTimeout(()=>{o(!1,1e-7)},1e3)}_===1&&!KV(c,e.getBoundingClientRect())&&o(),v=!1}try{n=new IntersectionObserver(I,{...w,root:s.ownerDocument})}catch{n=new IntersectionObserver(I,w)}n.observe(e)}return o(!0),r}function Whe(e,t,n,i){i===void 0&&(i={});const{ancestorScroll:s=!0,ancestorResize:r=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=i,c=nT(e),u=s||r?[...c?ym(c):[],...ym(t)]:[];u.forEach(b=>{s&&b.addEventListener("scroll",n,{passive:!0}),r&&b.addEventListener("resize",n)});const d=c&&a?Yhe(c,n):null;let f=-1,h=null;o&&(h=new ResizeObserver(b=>{let[y]=b;y&&y.target===c&&h&&(h.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var w;(w=h)==null||w.observe(t)})),n()}),c&&!l&&h.observe(c),h.observe(t));let m,p=l?bd(e):null;l&&U();function U(){const b=bd(e);p&&!KV(p,b)&&n(),p=b,m=requestAnimationFrame(U)}return n(),()=>{var b;u.forEach(y=>{s&&y.removeEventListener("scroll",n),r&&y.removeEventListener("resize",n)}),d==null||d(),(b=h)==null||b.disconnect(),h=null,l&&cancelAnimationFrame(m)}}const Khe=xhe,Zhe=Che,qhe=The,Qhe=Mhe,Jhe=Ihe,Uk=_he,ege=Ahe,tge=(e,t,n)=>{const i=new Map,s={platform:jhe,...n},r={...s.platform,_c:i};return whe(e,t,{...s,platform:r})};var B2=typeof document<"u"?D.useLayoutEffect:D.useEffect;function R6(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,i,s;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(i=n;i--!==0;)if(!R6(e[i],t[i]))return!1;return!0}if(s=Object.keys(e),n=s.length,n!==Object.keys(t).length)return!1;for(i=n;i--!==0;)if(!{}.hasOwnProperty.call(t,s[i]))return!1;for(i=n;i--!==0;){const r=s[i];if(!(r==="_owner"&&e.$$typeof)&&!R6(e[r],t[r]))return!1}return!0}return e!==e&&t!==t}function ZV(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function bk(e,t){const n=ZV(e);return Math.round(t*n)/n}function X8(e){const t=D.useRef(e);return B2(()=>{t.current=e}),t}function nge(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:i=[],platform:s,elements:{reference:r,floating:o}={},transform:a=!0,whileElementsMounted:l,open:c}=e,[u,d]=D.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[f,h]=D.useState(i);R6(f,i)||h(i);const[m,p]=D.useState(null),[U,b]=D.useState(null),y=D.useCallback($=>{$!==C.current&&(C.current=$,p($))},[]),w=D.useCallback($=>{$!==_.current&&(_.current=$,b($))},[]),v=r||m,I=o||U,C=D.useRef(null),_=D.useRef(null),T=D.useRef(u),k=l!=null,S=X8(l),R=X8(s),P=X8(c),L=D.useCallback(()=>{if(!C.current||!_.current)return;const $={placement:t,strategy:n,middleware:f};R.current&&($.platform=R.current),tge(C.current,_.current,$).then(j=>{const W={...j,isPositioned:P.current!==!1};X.current&&!R6(T.current,W)&&(T.current=W,hi.flushSync(()=>{d(W)}))})},[f,t,n,R,P]);B2(()=>{c===!1&&T.current.isPositioned&&(T.current.isPositioned=!1,d($=>({...$,isPositioned:!1})))},[c]);const X=D.useRef(!1);B2(()=>(X.current=!0,()=>{X.current=!1}),[]),B2(()=>{if(v&&(C.current=v),I&&(_.current=I),v&&I){if(S.current)return S.current(v,I,L);L()}},[v,I,L,S,k]);const G=D.useMemo(()=>({reference:C,floating:_,setReference:y,setFloating:w}),[y,w]),z=D.useMemo(()=>({reference:v,floating:I}),[v,I]),V=D.useMemo(()=>{const $={position:n,left:0,top:0};if(!z.floating)return $;const j=bk(z.floating,u.x),W=bk(z.floating,u.y);return a?{...$,transform:"translate("+j+"px, "+W+"px)",...ZV(z.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:j,top:W}},[n,a,z.floating,u.x,u.y]);return D.useMemo(()=>({...u,update:L,refs:G,elements:z,floatingStyles:V}),[u,L,G,z,V])}const ige=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:i,padding:s}=typeof e=="function"?e(n):e;return i&&t(i)?i.current!=null?Uk({element:i.current,padding:s}).fn(n):{}:i?Uk({element:i,padding:s}).fn(n):{}}}},sge=(e,t)=>({...Khe(e),options:[e,t]}),rge=(e,t)=>({...Zhe(e),options:[e,t]}),oge=(e,t)=>({...ege(e),options:[e,t]}),age=(e,t)=>({...qhe(e),options:[e,t]}),lge=(e,t)=>({...Qhe(e),options:[e,t]}),cge=(e,t)=>({...Jhe(e),options:[e,t]}),uge=(e,t)=>({...ige(e),options:[e,t]});var dge="Arrow",qV=D.forwardRef((e,t)=>{const{children:n,width:i=10,height:s=5,...r}=e;return g(ps.svg,{...r,ref:t,width:i,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:g("polygon",{points:"0,0 30,0 15,10"})})});qV.displayName=dge;var fge=qV;function hge(e){const[t,n]=D.useState(void 0);return Ud(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const i=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const r=s[0];let o,a;if("borderBoxSize"in r){const l=r.borderBoxSize,c=Array.isArray(l)?l[0]:l;o=c.inlineSize,a=c.blockSize}else o=e.offsetWidth,a=e.offsetHeight;n({width:o,height:a})});return i.observe(e,{box:"border-box"}),()=>i.unobserve(e)}else n(void 0)},[e]),t}var sT="Popper",[QV,JV]=Cp(sT),[gge,e$]=QV(sT),t$=e=>{const{__scopePopper:t,children:n}=e,[i,s]=D.useState(null);return g(gge,{scope:t,anchor:i,onAnchorChange:s,children:n})};t$.displayName=sT;var n$="PopperAnchor",i$=D.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:i,...s}=e,r=e$(n$,n),o=D.useRef(null),a=lo(t,o);return D.useEffect(()=>{r.onAnchorChange((i==null?void 0:i.current)||o.current)}),i?null:g(ps.div,{...s,ref:a})});i$.displayName=n$;var rT="PopperContent",[mge,pge]=QV(rT),s$=D.forwardRef((e,t)=>{var We,Ht,fn,je,lt,Vt;const{__scopePopper:n,side:i="bottom",sideOffset:s=0,align:r="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:f=!1,updatePositionStrategy:h="optimized",onPlaced:m,...p}=e,U=e$(rT,n),[b,y]=D.useState(null),w=lo(t,ai=>y(ai)),[v,I]=D.useState(null),C=hge(v),_=(C==null?void 0:C.width)??0,T=(C==null?void 0:C.height)??0,k=i+(r!=="center"?"-"+r:""),S=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},R=Array.isArray(c)?c:[c],P=R.length>0,L={padding:S,boundary:R.filter(bge),altBoundary:P},{refs:X,floatingStyles:G,placement:z,isPositioned:V,middlewareData:$}=nge({strategy:"fixed",placement:k,whileElementsMounted:(...ai)=>Whe(...ai,{animationFrame:h==="always"}),elements:{reference:U.anchor},middleware:[sge({mainAxis:s+T,alignmentAxis:o}),l&&rge({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?oge():void 0,...L}),l&&age({...L}),lge({...L,apply:({elements:ai,rects:Il,availableWidth:Ng,availableHeight:$p})=>{const{width:cE,height:uE}=Il.reference,lu=ai.floating.style;lu.setProperty("--radix-popper-available-width",`${Ng}px`),lu.setProperty("--radix-popper-available-height",`${$p}px`),lu.setProperty("--radix-popper-anchor-width",`${cE}px`),lu.setProperty("--radix-popper-anchor-height",`${uE}px`)}}),v&&uge({element:v,padding:a}),yge({arrowWidth:_,arrowHeight:T}),f&&cge({strategy:"referenceHidden",...L})]}),[j,W]=a$(z),Q=ul(m);Ud(()=>{V&&(Q==null||Q())},[V,Q]);const oe=(We=$.arrow)==null?void 0:We.x,me=(Ht=$.arrow)==null?void 0:Ht.y,he=((fn=$.arrow)==null?void 0:fn.centerOffset)!==0,[Me,mt]=D.useState();return Ud(()=>{b&&mt(window.getComputedStyle(b).zIndex)},[b]),g("div",{ref:X.setFloating,"data-radix-popper-content-wrapper":"",style:{...G,transform:V?G.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Me,"--radix-popper-transform-origin":[(je=$.transformOrigin)==null?void 0:je.x,(lt=$.transformOrigin)==null?void 0:lt.y].join(" "),...((Vt=$.hide)==null?void 0:Vt.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:g(mge,{scope:n,placedSide:j,onArrowChange:I,arrowX:oe,arrowY:me,shouldHideArrow:he,children:g(ps.div,{"data-side":j,"data-align":W,...p,ref:w,style:{...p.style,animation:V?void 0:"none"}})})})});s$.displayName=rT;var r$="PopperArrow",Uge={top:"bottom",right:"left",bottom:"top",left:"right"},o$=D.forwardRef(function(t,n){const{__scopePopper:i,...s}=t,r=pge(r$,i),o=Uge[r.placedSide];return g("span",{ref:r.onArrowChange,style:{position:"absolute",left:r.arrowX,top:r.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[r.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[r.placedSide],visibility:r.shouldHideArrow?"hidden":void 0},children:g(fge,{...s,ref:n,style:{...s.style,display:"block"}})})});o$.displayName=r$;function bge(e){return e!==null}var yge=e=>({name:"transformOrigin",options:e,fn(t){var U,b,y;const{placement:n,rects:i,middlewareData:s}=t,o=((U=s.arrow)==null?void 0:U.centerOffset)!==0,a=o?0:e.arrowWidth,l=o?0:e.arrowHeight,[c,u]=a$(n),d={start:"0%",center:"50%",end:"100%"}[u],f=(((b=s.arrow)==null?void 0:b.x)??0)+a/2,h=(((y=s.arrow)==null?void 0:y.y)??0)+l/2;let m="",p="";return c==="bottom"?(m=o?d:`${f}px`,p=`${-l}px`):c==="top"?(m=o?d:`${f}px`,p=`${i.floating.height+l}px`):c==="right"?(m=`${-l}px`,p=o?d:`${h}px`):c==="left"&&(m=`${i.floating.width+l}px`,p=o?d:`${h}px`),{data:{x:m,y:p}}}});function a$(e){const[t,n="center"]=e.split("-");return[t,n]}var Ege=t$,l$=i$,vge=s$,wge=o$,_ge="Portal",c$=D.forwardRef((e,t)=>{var a;const{container:n,...i}=e,[s,r]=D.useState(!1);Ud(()=>r(!0),[]);const o=n||s&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return o?jZ.createPortal(g(ps.div,{...i,ref:t}),o):null});c$.displayName=_ge;function Tge(e,t){return D.useReducer((n,i)=>t[n][i]??n,e)}var gy=e=>{const{present:t,children:n}=e,i=Ige(t),s=typeof n=="function"?n({present:i.isPresent}):D.Children.only(n),r=lo(i.ref,Sge(s));return typeof n=="function"||i.isPresent?D.cloneElement(s,{ref:r}):null};gy.displayName="Presence";function Ige(e){const[t,n]=D.useState(),i=D.useRef({}),s=D.useRef(e),r=D.useRef("none"),o=e?"mounted":"unmounted",[a,l]=Tge(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return D.useEffect(()=>{const c=zU(i.current);r.current=a==="mounted"?c:"none"},[a]),Ud(()=>{const c=i.current,u=s.current;if(u!==e){const f=r.current,h=zU(c);e?l("MOUNT"):h==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&f!==h?"ANIMATION_OUT":"UNMOUNT"),s.current=e}},[e,l]),Ud(()=>{if(t){let c;const u=t.ownerDocument.defaultView??window,d=h=>{const p=zU(i.current).includes(h.animationName);if(h.target===t&&p&&(l("ANIMATION_END"),!s.current)){const U=t.style.animationFillMode;t.style.animationFillMode="forwards",c=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=U)})}},f=h=>{h.target===t&&(r.current=zU(i.current))};return t.addEventListener("animationstart",f),t.addEventListener("animationcancel",d),t.addEventListener("animationend",d),()=>{u.clearTimeout(c),t.removeEventListener("animationstart",f),t.removeEventListener("animationcancel",d),t.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[t,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:D.useCallback(c=>{c&&(i.current=getComputedStyle(c)),n(c)},[])}}function zU(e){return(e==null?void 0:e.animationName)||"none"}function Sge(e){var i,s;let t=(i=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:i.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function oT({prop:e,defaultProp:t,onChange:n=()=>{}}){const[i,s]=xge({defaultProp:t,onChange:n}),r=e!==void 0,o=r?e:i,a=ul(n),l=D.useCallback(c=>{if(r){const d=typeof c=="function"?c(e):c;d!==e&&a(d)}else s(c)},[r,e,s,a]);return[o,l]}function xge({defaultProp:e,onChange:t}){const n=D.useState(e),[i]=n,s=D.useRef(i),r=ul(t);return D.useEffect(()=>{s.current!==i&&(r(i),s.current=i)},[i,s,r]),n}var Cge=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},rf=new WeakMap,HU=new WeakMap,VU={},j8=0,u$=function(e){return e&&(e.host||u$(e.parentNode))},Age=function(e,t){return t.map(function(n){if(e.contains(n))return n;var i=u$(n);return i&&e.contains(i)?i:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},Mge=function(e,t,n,i){var s=Age(t,Array.isArray(e)?e:[e]);VU[n]||(VU[n]=new WeakMap);var r=VU[n],o=[],a=new Set,l=new Set(s),c=function(d){!d||a.has(d)||(a.add(d),c(d.parentNode))};s.forEach(c);var u=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(f){if(a.has(f))u(f);else try{var h=f.getAttribute(i),m=h!==null&&h!=="false",p=(rf.get(f)||0)+1,U=(r.get(f)||0)+1;rf.set(f,p),r.set(f,U),o.push(f),p===1&&m&&HU.set(f,!0),U===1&&f.setAttribute(n,"true"),m||f.setAttribute(i,"true")}catch(b){console.error("aria-hidden: cannot operate on ",f,b)}})};return u(t),a.clear(),j8++,function(){o.forEach(function(d){var f=rf.get(d)-1,h=r.get(d)-1;rf.set(d,f),r.set(d,h),f||(HU.has(d)||d.removeAttribute(i),HU.delete(d)),h||d.removeAttribute(n)}),j8--,j8||(rf=new WeakMap,rf=new WeakMap,HU=new WeakMap,VU={})}},kge=function(e,t,n){n===void 0&&(n="data-aria-hidden");var i=Array.from(Array.isArray(e)?e:[e]),s=Cge(e);return s?(i.push.apply(i,Array.from(s.querySelectorAll("[aria-live]"))),Mge(i,s,n,"aria-hidden")):function(){return null}},Do=function(){return Do=Object.assign||function(t){for(var n,i=1,s=arguments.length;i<s;i++){n=arguments[i];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Do.apply(this,arguments)};function d$(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]]);return n}function Rge(e,t,n){if(n||arguments.length===2)for(var i=0,s=t.length,r;i<s;i++)(r||!(i in t))&&(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}var z2="right-scroll-bar-position",H2="width-before-scroll-bar",Dge="with-scroll-bars-hidden",Lge="--removed-body-scroll-bar-size";function Y8(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function Nge(e,t){var n=D.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(i){var s=n.value;s!==i&&(n.value=i,n.callback(i,s))}}}})[0];return n.callback=t,n.facade}var Oge=typeof window<"u"?D.useLayoutEffect:D.useEffect,yk=new WeakMap;function Pge(e,t){var n=Nge(null,function(i){return e.forEach(function(s){return Y8(s,i)})});return Oge(function(){var i=yk.get(n);if(i){var s=new Set(i),r=new Set(e),o=n.current;s.forEach(function(a){r.has(a)||Y8(a,null)}),r.forEach(function(a){s.has(a)||Y8(a,o)})}yk.set(n,e)},[e]),n}function Fge(e){return e}function Bge(e,t){t===void 0&&(t=Fge);var n=[],i=!1,s={read:function(){if(i)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(r){var o=t(r,i);return n.push(o),function(){n=n.filter(function(a){return a!==o})}},assignSyncMedium:function(r){for(i=!0;n.length;){var o=n;n=[],o.forEach(r)}n={push:function(a){return r(a)},filter:function(){return n}}},assignMedium:function(r){i=!0;var o=[];if(n.length){var a=n;n=[],a.forEach(r),o=n}var l=function(){var u=o;o=[],u.forEach(r)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){o.push(u),c()},filter:function(u){return o=o.filter(u),n}}}};return s}function zge(e){e===void 0&&(e={});var t=Bge(null);return t.options=Do({async:!0,ssr:!1},e),t}var f$=function(e){var t=e.sideCar,n=d$(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var i=t.read();if(!i)throw new Error("Sidecar medium not found");return D.createElement(i,Do({},n))};f$.isSideCarExport=!0;function Hge(e,t){return e.useMedium(t),f$}var h$=zge(),W8=function(){},my=D.forwardRef(function(e,t){var n=D.useRef(null),i=D.useState({onScrollCapture:W8,onWheelCapture:W8,onTouchMoveCapture:W8}),s=i[0],r=i[1],o=e.forwardProps,a=e.children,l=e.className,c=e.removeScrollBar,u=e.enabled,d=e.shards,f=e.sideCar,h=e.noIsolation,m=e.inert,p=e.allowPinchZoom,U=e.as,b=U===void 0?"div":U,y=e.gapMode,w=d$(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),v=f,I=Pge([n,t]),C=Do(Do({},w),s);return D.createElement(D.Fragment,null,u&&D.createElement(v,{sideCar:h$,removeScrollBar:c,shards:d,noIsolation:h,inert:m,setCallbacks:r,allowPinchZoom:!!p,lockRef:n,gapMode:y}),o?D.cloneElement(D.Children.only(a),Do(Do({},C),{ref:I})):D.createElement(b,Do({},C,{className:l,ref:I}),a))});my.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};my.classNames={fullWidth:H2,zeroRight:z2};var Vge=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function $ge(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=Vge();return t&&e.setAttribute("nonce",t),e}function Gge(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function Xge(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var jge=function(){var e=0,t=null;return{add:function(n){e==0&&(t=$ge())&&(Gge(t,n),Xge(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},Yge=function(){var e=jge();return function(t,n){D.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},g$=function(){var e=Yge(),t=function(n){var i=n.styles,s=n.dynamic;return e(i,s),null};return t},Wge={left:0,top:0,right:0,gap:0},K8=function(e){return parseInt(e||"",10)||0},Kge=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],i=t[e==="padding"?"paddingTop":"marginTop"],s=t[e==="padding"?"paddingRight":"marginRight"];return[K8(n),K8(i),K8(s)]},Zge=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return Wge;var t=Kge(e),n=document.documentElement.clientWidth,i=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,i-n+t[2]-t[0])}},qge=g$(),mh="data-scroll-locked",Qge=function(e,t,n,i){var s=e.left,r=e.top,o=e.right,a=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(Dge,` {
   overflow: hidden `).concat(i,`;
   padding-right: `).concat(a,"px ").concat(i,`;
  }
  body[`).concat(mh,`] {
    overflow: hidden `).concat(i,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(i,";"),n==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(r,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(i,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(i,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(z2,` {
    right: `).concat(a,"px ").concat(i,`;
  }
  
  .`).concat(H2,` {
    margin-right: `).concat(a,"px ").concat(i,`;
  }
  
  .`).concat(z2," .").concat(z2,` {
    right: 0 `).concat(i,`;
  }
  
  .`).concat(H2," .").concat(H2,` {
    margin-right: 0 `).concat(i,`;
  }
  
  body[`).concat(mh,`] {
    `).concat(Lge,": ").concat(a,`px;
  }
`)},Ek=function(){var e=parseInt(document.body.getAttribute(mh)||"0",10);return isFinite(e)?e:0},Jge=function(){D.useEffect(function(){return document.body.setAttribute(mh,(Ek()+1).toString()),function(){var e=Ek()-1;e<=0?document.body.removeAttribute(mh):document.body.setAttribute(mh,e.toString())}},[])},e1e=function(e){var t=e.noRelative,n=e.noImportant,i=e.gapMode,s=i===void 0?"margin":i;Jge();var r=D.useMemo(function(){return Zge(s)},[s]);return D.createElement(qge,{styles:Qge(r,!t,s,n?"":"!important")})},cv=!1;if(typeof window<"u")try{var $U=Object.defineProperty({},"passive",{get:function(){return cv=!0,!0}});window.addEventListener("test",$U,$U),window.removeEventListener("test",$U,$U)}catch{cv=!1}var of=cv?{passive:!1}:!1,t1e=function(e){return e.tagName==="TEXTAREA"},m$=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!t1e(e)&&n[t]==="visible")},n1e=function(e){return m$(e,"overflowY")},i1e=function(e){return m$(e,"overflowX")},vk=function(e,t){var n=t.ownerDocument,i=t;do{typeof ShadowRoot<"u"&&i instanceof ShadowRoot&&(i=i.host);var s=p$(e,i);if(s){var r=U$(e,i),o=r[1],a=r[2];if(o>a)return!0}i=i.parentNode}while(i&&i!==n.body);return!1},s1e=function(e){var t=e.scrollTop,n=e.scrollHeight,i=e.clientHeight;return[t,n,i]},r1e=function(e){var t=e.scrollLeft,n=e.scrollWidth,i=e.clientWidth;return[t,n,i]},p$=function(e,t){return e==="v"?n1e(t):i1e(t)},U$=function(e,t){return e==="v"?s1e(t):r1e(t)},o1e=function(e,t){return e==="h"&&t==="rtl"?-1:1},a1e=function(e,t,n,i,s){var r=o1e(e,window.getComputedStyle(t).direction),o=r*i,a=n.target,l=t.contains(a),c=!1,u=o>0,d=0,f=0;do{var h=U$(e,a),m=h[0],p=h[1],U=h[2],b=p-U-r*m;(m||b)&&p$(e,a)&&(d+=b,f+=m),a instanceof ShadowRoot?a=a.host:a=a.parentNode}while(!l&&a!==document.body||l&&(t.contains(a)||t===a));return(u&&Math.abs(d)<1||!u&&Math.abs(f)<1)&&(c=!0),c},GU=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},wk=function(e){return[e.deltaX,e.deltaY]},_k=function(e){return e&&"current"in e?e.current:e},l1e=function(e,t){return e[0]===t[0]&&e[1]===t[1]},c1e=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},u1e=0,af=[];function d1e(e){var t=D.useRef([]),n=D.useRef([0,0]),i=D.useRef(),s=D.useState(u1e++)[0],r=D.useState(g$)[0],o=D.useRef(e);D.useEffect(function(){o.current=e},[e]),D.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(s));var p=Rge([e.lockRef.current],(e.shards||[]).map(_k),!0).filter(Boolean);return p.forEach(function(U){return U.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),p.forEach(function(U){return U.classList.remove("allow-interactivity-".concat(s))})}}},[e.inert,e.lockRef.current,e.shards]);var a=D.useCallback(function(p,U){if("touches"in p&&p.touches.length===2||p.type==="wheel"&&p.ctrlKey)return!o.current.allowPinchZoom;var b=GU(p),y=n.current,w="deltaX"in p?p.deltaX:y[0]-b[0],v="deltaY"in p?p.deltaY:y[1]-b[1],I,C=p.target,_=Math.abs(w)>Math.abs(v)?"h":"v";if("touches"in p&&_==="h"&&C.type==="range")return!1;var T=vk(_,C);if(!T)return!0;if(T?I=_:(I=_==="v"?"h":"v",T=vk(_,C)),!T)return!1;if(!i.current&&"changedTouches"in p&&(w||v)&&(i.current=I),!I)return!0;var k=i.current||I;return a1e(k,U,p,k==="h"?w:v)},[]),l=D.useCallback(function(p){var U=p;if(!(!af.length||af[af.length-1]!==r)){var b="deltaY"in U?wk(U):GU(U),y=t.current.filter(function(I){return I.name===U.type&&(I.target===U.target||U.target===I.shadowParent)&&l1e(I.delta,b)})[0];if(y&&y.should){U.cancelable&&U.preventDefault();return}if(!y){var w=(o.current.shards||[]).map(_k).filter(Boolean).filter(function(I){return I.contains(U.target)}),v=w.length>0?a(U,w[0]):!o.current.noIsolation;v&&U.cancelable&&U.preventDefault()}}},[]),c=D.useCallback(function(p,U,b,y){var w={name:p,delta:U,target:b,should:y,shadowParent:f1e(b)};t.current.push(w),setTimeout(function(){t.current=t.current.filter(function(v){return v!==w})},1)},[]),u=D.useCallback(function(p){n.current=GU(p),i.current=void 0},[]),d=D.useCallback(function(p){c(p.type,wk(p),p.target,a(p,e.lockRef.current))},[]),f=D.useCallback(function(p){c(p.type,GU(p),p.target,a(p,e.lockRef.current))},[]);D.useEffect(function(){return af.push(r),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:f}),document.addEventListener("wheel",l,of),document.addEventListener("touchmove",l,of),document.addEventListener("touchstart",u,of),function(){af=af.filter(function(p){return p!==r}),document.removeEventListener("wheel",l,of),document.removeEventListener("touchmove",l,of),document.removeEventListener("touchstart",u,of)}},[]);var h=e.removeScrollBar,m=e.inert;return D.createElement(D.Fragment,null,m?D.createElement(r,{styles:c1e(s)}):null,h?D.createElement(e1e,{gapMode:e.gapMode}):null)}function f1e(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const h1e=Hge(h$,d1e);var b$=D.forwardRef(function(e,t){return D.createElement(my,Do({},e,{ref:t,sideCar:h1e}))});b$.classNames=my.classNames;var aT="Popover",[y$,PCe]=Cp(aT,[JV]),Mp=JV(),[g1e,ou]=y$(aT),E$=e=>{const{__scopePopover:t,children:n,open:i,defaultOpen:s,onOpenChange:r,modal:o=!1}=e,a=Mp(t),l=D.useRef(null),[c,u]=D.useState(!1),[d=!1,f]=oT({prop:i,defaultProp:s,onChange:r});return g(Ege,{...a,children:g(g1e,{scope:t,contentId:Z_(),triggerRef:l,open:d,onOpenChange:f,onOpenToggle:D.useCallback(()=>f(h=>!h),[f]),hasCustomAnchor:c,onCustomAnchorAdd:D.useCallback(()=>u(!0),[]),onCustomAnchorRemove:D.useCallback(()=>u(!1),[]),modal:o,children:n})})};E$.displayName=aT;var v$="PopoverAnchor",m1e=D.forwardRef((e,t)=>{const{__scopePopover:n,...i}=e,s=ou(v$,n),r=Mp(n),{onCustomAnchorAdd:o,onCustomAnchorRemove:a}=s;return D.useEffect(()=>(o(),()=>a()),[o,a]),g(l$,{...r,...i,ref:t})});m1e.displayName=v$;var w$="PopoverTrigger",_$=D.forwardRef((e,t)=>{const{__scopePopover:n,...i}=e,s=ou(w$,n),r=Mp(n),o=lo(t,s.triggerRef),a=g(ps.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":A$(s.open),...i,ref:o,onClick:Ri(e.onClick,s.onOpenToggle)});return s.hasCustomAnchor?a:g(l$,{asChild:!0,...r,children:a})});_$.displayName=w$;var lT="PopoverPortal",[p1e,U1e]=y$(lT,{forceMount:void 0}),T$=e=>{const{__scopePopover:t,forceMount:n,children:i,container:s}=e,r=ou(lT,t);return g(p1e,{scope:t,forceMount:n,children:g(gy,{present:n||r.open,children:g(c$,{asChild:!0,container:s,children:i})})})};T$.displayName=lT;var jh="PopoverContent",I$=D.forwardRef((e,t)=>{const n=U1e(jh,e.__scopePopover),{forceMount:i=n.forceMount,...s}=e,r=ou(jh,e.__scopePopover);return g(gy,{present:i||r.open,children:r.modal?g(b1e,{...s,ref:t}):g(y1e,{...s,ref:t})})});I$.displayName=jh;var b1e=D.forwardRef((e,t)=>{const n=ou(jh,e.__scopePopover),i=D.useRef(null),s=lo(t,i),r=D.useRef(!1);return D.useEffect(()=>{const o=i.current;if(o)return kge(o)},[]),g(b$,{as:Um,allowPinchZoom:!0,children:g(S$,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Ri(e.onCloseAutoFocus,o=>{var a;o.preventDefault(),r.current||(a=n.triggerRef.current)==null||a.focus()}),onPointerDownOutside:Ri(e.onPointerDownOutside,o=>{const a=o.detail.originalEvent,l=a.button===0&&a.ctrlKey===!0,c=a.button===2||l;r.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:Ri(e.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),y1e=D.forwardRef((e,t)=>{const n=ou(jh,e.__scopePopover),i=D.useRef(!1),s=D.useRef(!1);return g(S$,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:r=>{var o,a;(o=e.onCloseAutoFocus)==null||o.call(e,r),r.defaultPrevented||(i.current||(a=n.triggerRef.current)==null||a.focus(),r.preventDefault()),i.current=!1,s.current=!1},onInteractOutside:r=>{var l,c;(l=e.onInteractOutside)==null||l.call(e,r),r.defaultPrevented||(i.current=!0,r.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=r.target;((c=n.triggerRef.current)==null?void 0:c.contains(o))&&r.preventDefault(),r.detail.originalEvent.type==="focusin"&&s.current&&r.preventDefault()}})}),S$=D.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:i,onOpenAutoFocus:s,onCloseAutoFocus:r,disableOutsidePointerEvents:o,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:u,...d}=e,f=ou(jh,n),h=Mp(n);return she(),g(BV,{asChild:!0,loop:!0,trapped:i,onMountAutoFocus:s,onUnmountAutoFocus:r,children:g(PV,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:u,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>f.onOpenChange(!1),children:g(vge,{"data-state":A$(f.open),role:"dialog",id:f.contentId,...h,...d,ref:t,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),x$="PopoverClose",E1e=D.forwardRef((e,t)=>{const{__scopePopover:n,...i}=e,s=ou(x$,n);return g(ps.button,{type:"button",...i,ref:t,onClick:Ri(e.onClick,()=>s.onOpenChange(!1))})});E1e.displayName=x$;var v1e="PopoverArrow",C$=D.forwardRef((e,t)=>{const{__scopePopover:n,...i}=e,s=Mp(n);return g(wge,{...s,...i,ref:t})});C$.displayName=v1e;function A$(e){return e?"open":"closed"}var wl=E$,_l=_$,w1e=T$,py=I$,M$=C$;const k$=()=>g("div",{style:{width:1,height:"1rem",backgroundColor:"var(--default-border-color)",margin:"0 auto"}}),R$=ae.createContext(null),wi=()=>ae.useContext(R$),D$=e=>{const[t,n]=D.useState(null),i=oi(),{theme:s}=wi(),{container:r}=Lr();return D.useLayoutEffect(()=>{var o;t&&(t.className="",t.classList.add("excalidraw",...((o=e==null?void 0:e.className)==null?void 0:o.split(/\s+/))||[]),t.classList.toggle("excalidraw--mobile",i.editor.isMobile),t.classList.toggle("theme--dark",s===ke.DARK))},[t,s,i.editor.isMobile,e==null?void 0:e.className]),D.useLayoutEffect(()=>{const o=e!=null&&e.parentSelector?r==null?void 0:r.querySelector(e.parentSelector):document.body;if(!o)return;const a=document.createElement("div");return o.appendChild(a),n(a),()=>{o.removeChild(a)}},[r,e==null?void 0:e.parentSelector]),t};function cT(e,t,n){D.useEffect(()=>{function i(s){const r=s;if(!e.current)return;const o=n==null?void 0:n(r,e.current);if(o===!0)return;if(o===!1)return t(r);e.current.contains(r.target)||!document.documentElement.contains(r.target)||r.target.closest("[data-radix-portal]")||r.target===document.documentElement&&document.body.style.pointerEvents==="none"||r.target.closest("[data-prevent-outside-click]")||t(r)}return document.addEventListener(te.POINTER_DOWN,i),document.addEventListener(te.TOUCH_START,i),()=>{document.removeEventListener(te.POINTER_DOWN,i),document.removeEventListener(te.TOUCH_START,i)}},[e,t,n])}const Uy=e=>{const t=D.useRef(e);return Object.assign(t.current,e),t.current},by=Yt(null),_1e=({onCancel:e,onChange:t,onSelect:n,colorPickerType:i})=>{const s=D$({className:"excalidraw-eye-dropper-backdrop",parentSelector:".excalidraw-eye-dropper-container"}),r=wi(),o=Wy(),a=go(),l=Ve(o,r),c=Uy({app:a,onCancel:e,onChange:t,onSelect:n,selectedElements:l}),{container:u}=Lr();D.useEffect(()=>{const f=d.current;if(!f||!a.canvas||!s)return;let h=!1;const m=a.canvas.getContext("2d"),p=({clientX:C,clientY:_})=>{const T=m.getImageData((C-r.offsetLeft)*window.devicePixelRatio,(_-r.offsetTop)*window.devicePixelRatio,1,1).data;return hse(T[0],T[1],T[2])},U=({clientX:C,clientY:_,altKey:T})=>{f.style.top=`${_+20}px`,f.style.left=`${C+20}px`;const k=p({clientX:C,clientY:_});h&&c.onChange(i,k,c.selectedElements,{altKey:T}),f.style.background=k},b=()=>{c.onCancel()},y=(C,_)=>{c.onSelect(C,_)},w=C=>{h=!0,C.stopImmediatePropagation()},v=C=>{h=!1,u==null||u.focus(),C.stopImmediatePropagation(),C.preventDefault(),y(p(C),C)},I=C=>{C.key===H.ESCAPE&&(C.preventDefault(),C.stopImmediatePropagation(),b())};return s.tabIndex=-1,s.focus(),U({clientX:c.app.lastViewportPosition.x,clientY:c.app.lastViewportPosition.y,altKey:!1}),s.addEventListener(te.KEYDOWN,I),s.addEventListener(te.POINTER_DOWN,w),s.addEventListener(te.POINTER_UP,v),window.addEventListener("pointermove",U,{passive:!0}),window.addEventListener(te.BLUR,b),()=>{h=!1,s.removeEventListener(te.KEYDOWN,I),s.removeEventListener(te.POINTER_DOWN,w),s.removeEventListener(te.POINTER_UP,v),window.removeEventListener("pointermove",U),window.removeEventListener(te.BLUR,b)}},[c,a.canvas,s,i,u,r.offsetLeft,r.offsetTop]);const d=D.useRef(null);return cT(d,()=>{e()},f=>!!f.target.closest(".excalidraw-eye-dropper-trigger, .excalidraw-eye-dropper-backdrop")),s?hi.createPortal(g("div",{ref:d,className:"excalidraw-eye-dropper-preview"}),s):null},vr=ae.forwardRef(({children:e,padding:t,className:n,style:i},s)=>g("div",{className:re("Island",n),style:{"--padding":t,...i},ref:s,children:e})),Ig=ae.forwardRef(({className:e,container:t,children:n,style:i,onClose:s,onKeyDown:r,onFocusOutside:o,onPointerLeave:a,onPointerDownOutside:l,preventAutoFocusOnTouch:c=!1},u)=>{const d=oi();return g(w1e,{container:t,children:N(py,{ref:u,className:re("focus-visible-none",e),"data-prevent-outside-click":!0,side:d.editor.isMobile&&!d.viewport.isLandscape?"bottom":"right",align:d.editor.isMobile&&!d.viewport.isLandscape?"center":"start",alignOffset:-16,sideOffset:20,style:{zIndex:"var(--zIndex-ui-styles-popup)",marginLeft:d.editor.isMobile?"0.5rem":void 0},onPointerLeave:a,onKeyDown:r,onFocusOutside:o,onPointerDownOutside:l,onOpenAutoFocus:f=>{c&&d.isTouchScreen&&f.preventDefault()},onCloseAutoFocus:f=>{f.stopPropagation(),f.preventDefault(),t&&!Ure(document.activeElement)&&t.focus(),s()},children:[g(vr,{padding:3,style:i,children:n}),g(M$,{width:20,height:10,style:{fill:"var(--popup-bg-color)",filter:"drop-shadow(rgba(0, 0, 0, 0.05) 0px 3px 2px)"}})]})})}),yy=()=>document.querySelector(".excalidraw-wysiwyg"),uT=()=>{const e=yy();return e?{start:e.selectionStart,end:e.selectionEnd}:null},dT=e=>{setTimeout(()=>{const t=yy();t&&(t.focus(),e&&(t.selectionStart=e.start,t.selectionEnd=e.end))},0)},Ey=(e,t,n,i)=>{t&&i&&i();const s=t&&n?uT():null;e(),t&&n&&dT(s)},T1e=()=>{const[e,t]=D.useState(null),n=D.useCallback(()=>{const r=uT();t(r)},[]),i=D.useCallback(()=>{setTimeout(()=>{const r=yy();r&&(r.focus(),e&&(r.selectionStart=e.start,r.selectionEnd=e.end,t(null)))},0)},[e]),s=D.useCallback(()=>{t(null)},[]);return{saveCaretPosition:n,restoreCaretPosition:i,clearSavedPosition:s,hasSavedPosition:!!e}},I1e=(e=100)=>{const t=yy();if(t){const n=t.onblur;t.onblur=null,setTimeout(()=>{t.onblur=n},e)}},vy=({palette:e,color:t})=>{if(!t)return null;for(const[n,i]of Object.entries(e))if(Array.isArray(i)){const s=i.indexOf(t);if(s>-1)return{colorName:n,shade:s}}else if(i===t)return{colorName:n,shade:null};return null},uv=[["q","w","e","r","t"],["a","s","d","f","g"],["z","x","c","v","b"]].flat(),L$=({color:e,palette:t})=>!Object.values(t).flat().includes(e),S1e=(e,t,n)=>{const i={elementBackground:"backgroundColor",elementStroke:"strokeColor"},s=e.filter(o=>{if(o.isDeleted)return!1;const a=o[i[t]];return L$({color:a,palette:n})}),r=new Map;return s.forEach(o=>{const a=o[i[t]];r.has(a)?r.set(a,r.get(a)+1):r.set(a,1)}),[...r.entries()].sort((o,a)=>a[1]-o[1]).map(o=>o[0]).slice(0,lse)},Sg=Yt(null),Tk=(e,t,n)=>(e*299+t*587+n*114)/1e3,D6=(e,t=160)=>{if(!e)return!0;if(e==="transparent")return!1;if(!e.startsWith("#")){const r=document.createElement("div");if(r.style.color=e,r.style.color){r.style.position="absolute",r.style.visibility="hidden",r.style.width="0",r.style.height="0",document.body.appendChild(r);const o=getComputedStyle(r).color;document.body.removeChild(r);const a=o.replace(/^(rgb|rgba)\(/,"").replace(/\)$/,"").replace(/\s/g,"").split(","),l=parseInt(a[0]),c=parseInt(a[1]),u=parseInt(a[2]);return Tk(l,c,u)<t}return!0}const n=parseInt(e.slice(1,3),16),i=parseInt(e.slice(3,5),16),s=parseInt(e.slice(5,7),16);return Tk(n,i,s)<t},x1e=({color:e,onChange:t,label:n,colorPickerType:i,placeholder:s})=>{const r=oi(),[o,a]=D.useState(e),[l,c]=un(Sg);D.useEffect(()=>{a(e)},[e]);const u=D.useCallback(p=>{const U=p.toLowerCase(),b=N1e(U);b&&t(b),a(U)},[t]),d=D.useRef(null),f=D.useRef(null);D.useEffect(()=>{d.current&&d.current.focus()},[l]);const[h,m]=un(by);return D.useEffect(()=>()=>{m(null)},[m]),N("div",{className:"color-picker__input-label",children:[g("div",{className:"color-picker__input-hash",children:"#"}),g("input",{ref:l==="hex"?d:void 0,style:{border:0,padding:0},spellCheck:!1,className:"color-picker-input","aria-label":n,onChange:p=>{u(p.target.value)},value:(o||"").replace(/^#/,""),onBlur:()=>{a(e)},tabIndex:-1,onFocus:()=>c("hex"),onKeyDown:p=>{var U;p.key!==H.TAB&&(p.key===H.ESCAPE&&((U=f.current)==null||U.focus()),p.stopPropagation())},placeholder:s}),!r.editor.isMobile&&N(fe,{children:[g("div",{style:{width:"1px",height:"1.25rem",backgroundColor:"var(--default-border-color)"}}),g("div",{ref:f,className:re("excalidraw-eye-dropper-trigger",{selected:h}),onClick:()=>m(p=>p?null:{keepOpenOnAlt:!1,onSelect:U=>t(U),colorPickerType:i}),title:`${M("labels.eyeDropper")}  ${H.I.toLocaleUpperCase()} or ${J("Alt")} `,children:ufe})]})]})},fT=({color:e,keyLabel:t,isShade:n=!1})=>N("div",{className:"color-picker__button__hotkey-label",style:{color:D6(e)?"#fff":"#000"},children:[n&&"",t]}),C1e=({colors:e,color:t,onChange:n,label:i})=>{const[s,r]=un(Sg),o=D.useRef(null);return D.useEffect(()=>{o.current&&o.current.focus()},[t,s]),g("div",{className:"color-picker-content--default",children:e.map((a,l)=>N("button",{ref:t===a?o:void 0,tabIndex:-1,type:"button",className:re("color-picker__button color-picker__button--large has-outline",{active:t===a,"is-transparent":a==="transparent"||!a}),onClick:()=>{n(a),r("custom")},title:a,"aria-label":i,style:{"--swatch-color":a},children:[g("div",{className:"color-picker__button-outline"}),g(fT,{color:a,keyLabel:l+1})]},l))})},A1e=({palette:e,color:t,onChange:n,activeShade:i,showHotKey:s=!0})=>{const r=vy({color:t,palette:e}),[o,a]=un(Sg),l=D.useRef(null);return D.useEffect(()=>{l.current&&o==="baseColors"&&l.current.focus()},[r==null?void 0:r.colorName,o]),g("div",{className:"color-picker-content--default",children:Object.entries(e).map(([c,u],d)=>{const f=(Array.isArray(u)?u[i]:u)||"transparent",h=uv[d],m=M(`colors.${c.replace(/\d+/,"")}`,null,"");return N("button",{ref:(r==null?void 0:r.colorName)===c?l:void 0,tabIndex:-1,type:"button",className:re("color-picker__button color-picker__button--large has-outline",{active:(r==null?void 0:r.colorName)===c,"is-transparent":f==="transparent"||!1}),onClick:()=>{n(f),a("baseColors")},title:`${m}${f.startsWith("#")?` ${f}`:""}  ${h}`,"aria-label":`${m}  ${h}`,style:{"--swatch-color":f},"data-testid":`color-${c}`,children:[g("div",{className:"color-picker__button-outline"}),s&&g(fT,{color:f,keyLabel:h})]},c)})})},V2=({children:e})=>g("div",{className:"color-picker__heading",children:e}),M1e=({color:e,onChange:t,palette:n,showHotKey:i})=>{const s=vy({color:e||"transparent",palette:n}),[r,o]=un(Sg),a=D.useRef(null);if(D.useEffect(()=>{a.current&&r==="shades"&&a.current.focus()},[s,r]),s){const{colorName:l,shade:c}=s,u=n[l];if(Array.isArray(u))return g("div",{className:"color-picker-content--default shades",children:u.map((d,f)=>N("button",{ref:f===c&&r==="shades"?a:void 0,tabIndex:-1,type:"button",className:re("color-picker__button color-picker__button--large has-outline",{active:f===c}),"aria-label":"Shade",title:`${l} - ${f+1}`,style:d?{"--swatch-color":d}:void 0,onClick:()=>{t(d),o("shades")},children:[g("div",{className:"color-picker__button-outline"}),i&&g(fT,{color:d,keyLabel:f+1,isShade:!0})]},f))})}return N("div",{className:"color-picker-content--default",style:{position:"relative"},tabIndex:-1,children:[g("button",{type:"button",tabIndex:-1,className:"color-picker__button color-picker__button--large color-picker__button--no-focus-visible"}),g("div",{tabIndex:-1,style:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",fontSize:"0.75rem"},children:M("colorPicker.noShades")})]})},Z8=(e,t,n)=>{const i=Math.ceil(n/bf);switch(t=t??-1,e){case"ArrowLeft":{const s=t-1;return s<0?n-1:s}case"ArrowRight":return(t+1)%n;case"ArrowDown":{const s=t+bf;return s>=n?t%bf:s}case"ArrowUp":{const s=t-bf,r=s<0?bf*i+s:s;return r>=n?void 0:r}}},k1e=({e,colorObj:t,onChange:n,palette:i,customColors:s,setActiveColorPickerSection:r,activeShade:o})=>{if((t==null?void 0:t.shade)!=null&&["Digit1","Digit2","Digit3","Digit4","Digit5"].includes(e.code)&&e.shiftKey){const a=Number(e.code.slice(-1))-1;return n(i[t.colorName][a]),r("shades"),!0}if(["1","2","3","4","5"].includes(e.key)&&s[Number(e.key)-1])return n(s[Number(e.key)-1]),r("custom"),!0;if(uv.includes(e.key)){const a=uv.indexOf(e.key),l=Object.keys(i)[a],c=i[l],u=Array.isArray(c)?c[o]:c;return n(u),r("baseColors"),!0}return!1},R1e=({event:e,activeColorPickerSection:t,palette:n,color:i,onChange:s,customColors:r,setActiveColorPickerSection:o,updateData:a,activeShade:l,onEyeDropperToggle:c,onEscape:u})=>{if(e[H.CTRL_OR_CMD])return!1;if(e.key===H.ESCAPE)return u(e),!0;if(e.key===H.ALT)return c(!0),!0;if(e.key===H.I)return c(),!0;const d=vy({color:i,palette:n});if(e.key===H.TAB){const f={custom:!!r.length,baseColors:!0,shades:(d==null?void 0:d.shade)!=null,hex:!0},h=Object.entries(f).reduce((y,[w,v])=>(v&&y.push(w),y),[]),m=h.indexOf(t),p=e.shiftKey?-1:1,U=m+p>h.length-1?0:m+p<0?h.length-1:m+p,b=h[U];return b&&o(b),b==="custom"?s(r[0]):b==="baseColors"&&(Object.entries(n).find(([w,v])=>Array.isArray(v)?v.includes(i):v===i?w:null)||s(Ge.black)),e.preventDefault(),e.stopPropagation(),!0}if(k1e({e,colorObj:d,onChange:s,palette:n,customColors:r,setActiveColorPickerSection:o,activeShade:l}))return!0;if(t==="shades"&&d){const{shade:f}=d,h=Z8(e.key,f,bf);if(h!==void 0)return s(n[d.colorName][h]),!0}if(t==="baseColors"&&d){const{colorName:f}=d,h=Object.keys(n),m=h.indexOf(f),p=Z8(e.key,m,h.length);if(p!==void 0){const U=h[p],b=n[U];return s(Array.isArray(b)?b[l]:b),!0}}if(t==="custom"){const f=i!=null?r.indexOf(i):0,h=Z8(e.key,f,r.length);if(h!==void 0){const m=r[h];return s(m),!0}}return!1},D1e=ae.forwardRef(({color:e,onChange:t,type:n,elements:i,palette:s,updateData:r,children:o,showTitle:a,onEyeDropperToggle:l,onEscape:c,showHotKey:u=!0},d)=>{const f=a?n==="elementStroke"?M("labels.stroke"):n==="elementBackground"?M("labels.background"):null:null,[h]=ae.useState(()=>n==="canvasBackground"?[]:S1e(i,n,s)),[m,p]=un(Sg),U=vy({color:e,palette:s});D.useEffect(()=>{if(!m){const v=!!e&&L$({color:e,palette:s}),I=v&&!h.includes(e);p(I?null:v?"custom":(U==null?void 0:U.shade)!=null?"shades":"baseColors")}},[m,e,s,p,U,h]);const[b,y]=D.useState((U==null?void 0:U.shade)??(n==="elementBackground"?D1:R1));D.useEffect(()=>{(U==null?void 0:U.shade)!=null&&y(U.shade);const v=I=>{I.key===H.ALT&&l(!1)};return document.addEventListener(te.KEYUP,v,{capture:!0}),()=>{document.removeEventListener(te.KEYUP,v,{capture:!0})}},[U,l]);const w=ae.useRef(null);return D.useImperativeHandle(d,()=>w.current),D.useEffect(()=>{var v;(v=w==null?void 0:w.current)==null||v.focus()},[]),g("div",{role:"dialog","aria-modal":"true","aria-label":M("labels.colorPicker"),children:N("div",{ref:w,onKeyDown:v=>{R1e({event:v,activeColorPickerSection:m,palette:s,color:e,onChange:t,onEyeDropperToggle:l,customColors:h,setActiveColorPickerSection:p,updateData:r,activeShade:b,onEscape:c})&&(v.preventDefault(),v.stopPropagation())},className:"color-picker-content properties-content",tabIndex:-1,children:[f&&g("div",{className:"color-picker__title",children:f}),!!h.length&&N("div",{children:[g(V2,{children:M("colorPicker.mostUsedCustomColors")}),g(C1e,{colors:h,color:e,label:M("colorPicker.mostUsedCustomColors"),onChange:t})]}),N("div",{children:[g(V2,{children:M("colorPicker.colors")}),g(A1e,{color:e,palette:s,onChange:t,activeShade:b,showHotKey:u})]}),N("div",{children:[g(V2,{children:M("colorPicker.shades")}),g(M1e,{color:e,onChange:t,palette:s,showHotKey:u})]}),o]})})}),L1e=({onChange:e,type:t,activeColor:n,topPicks:i})=>{let s;return t==="elementStroke"&&(s=WF),t==="elementBackground"&&(s=KF),t==="canvasBackground"&&(s=ZF),i&&(s=i),s?g("div",{className:"color-picker__top-picks",children:s.map(r=>g("button",{className:re("color-picker__button",{active:r===n,"is-transparent":r==="transparent"||!r,"has-outline":!D6(r,c4)}),style:{"--swatch-color":r},type:"button",title:r,onClick:()=>e(r),"data-testid":`color-top-pick-${r}`,children:g("div",{className:"color-picker__button-outline"})},r))}):(console.error("Invalid type for TopPicks"),null)},Ik=e=>{const t=new Option().style;return t.color=e,!!t.color},N1e=e=>ws(e)?e:Ik(`#${e}`)?`#${e}`:Ik(e)?e:null,O1e=({type:e,color:t,onChange:n,label:i,elements:s,palette:r=Ge,updateData:o,getOpenPopup:a,appState:l})=>{const{container:c}=Lr(),[,u]=un(Sg),[d,f]=un(by),h=N("div",{children:[g(V2,{children:M("colorPicker.hexCode")}),g(x1e,{color:t||"",label:i,onChange:U=>{n(U)},colorPickerType:e,placeholder:M("colorPicker.color")})]}),m=D.useRef(null),p=()=>{var U;(U=m.current)==null||U.focus()};return g(Ig,{container:c,style:{maxWidth:"13rem"},preventAutoFocusOnTouch:!!l.editingTextElement,onFocusOutside:U=>{ka(U.target)||p(),U.preventDefault()},onPointerDownOutside:U=>{d&&U.preventDefault()},onClose:()=>{a()===e&&o({openPopup:null}),u(null),l.editingTextElement&&setTimeout(()=>{const U=document.querySelector(".excalidraw-wysiwyg");U&&U.focus()},0)},children:r?g(D1e,{ref:m,palette:r,color:t,onChange:U=>{const b=l.editingTextElement?uT():null;n(U),l.editingTextElement&&b&&dT(b)},onEyeDropperToggle:U=>{f(b=>U?(b=b||{keepOpenOnAlt:!0,onSelect:n,colorPickerType:e},b.keepOpenOnAlt=!0,b):U===!1||b?null:{keepOpenOnAlt:!1,onSelect:n,colorPickerType:e})},onEscape:U=>{d?f(null):o({openPopup:null})},type:e,elements:s,updateData:o,showTitle:l.stylesPanelMode==="compact"||l.stylesPanelMode==="mobile",showHotKey:l.stylesPanelMode!=="mobile",children:h}):h})},P1e=({label:e,color:t,type:n,stylesPanelMode:i,mode:s="background",onToggle:r,editingTextElement:o})=>{const a=l=>{l.preventDefault(),l.stopPropagation(),o&&I1e(),r()};return N(_l,{type:"button",className:re("color-picker__button active-color properties-trigger",{"is-transparent":!t||t==="transparent","has-outline":!t||!D6(t,c4),"compact-sizing":i==="compact"||i==="mobile","mobile-border":i==="mobile"}),"aria-label":e,style:t?{"--swatch-color":t}:void 0,title:M(n==="elementStroke"?"labels.showStroke":"labels.showBackground"),"data-openpopup":n,onClick:a,children:[g("div",{className:"color-picker__button-outline",children:!t&&dde}),(i==="compact"||i==="mobile")&&t&&s==="stroke"&&g("div",{className:"color-picker__button-background",children:g("span",{style:{color:t&&D6(t,c4)?"#fff":"#111"},children:Rfe})})]})},hT=({type:e,color:t,onChange:n,label:i,elements:s,palette:r=Ge,topPicks:o,updateData:a,appState:l})=>{const c=D.useRef(l.openPopup);D.useEffect(()=>{c.current=l.openPopup},[l.openPopup]);const u=e!=="canvasBackground"&&(l.stylesPanelMode==="compact"||l.stylesPanelMode==="mobile");return g("div",{children:N("div",{role:"dialog","aria-modal":"true",className:re("color-picker-container",{"color-picker-container--no-top-picks":u}),children:[!u&&g(L1e,{activeColor:t,onChange:n,type:e,topPicks:o}),!u&&g(k$,{}),N(wl,{open:l.openPopup===e,onOpenChange:d=>{d&&a({openPopup:e})},children:[g(P1e,{color:t,label:i,type:e,stylesPanelMode:l.stylesPanelMode,mode:e==="elementStroke"?"stroke":"background",editingTextElement:!!l.editingTextElement,onToggle:()=>{l.openPopup===e?a({openPopup:null}):l.openPopup?a({openPopup:e}):a({openPopup:e})}}),l.openPopup===e&&g(O1e,{type:e,color:t,onChange:n,label:i,elements:s,palette:r,updateData:a,getOpenPopup:()=>c.current,appState:l})]})]})})},F1e="/fonts/CascadiaCode/CascadiaCode-Regular.woff2",B1e=[{uri:F1e}],z1e="/fonts/ComicShanns/ComicShanns-Regular-279a7b317d12eb88de06167bd672b4b4.woff2",H1e="/fonts/ComicShanns/ComicShanns-Regular-6e066e8de2ac57ea9283adb9c24d7f0c.woff2",V1e="/fonts/ComicShanns/ComicShanns-Regular-dc6a8806fa96795d7b3be5026f989a17.woff2",$1e="/fonts/ComicShanns/ComicShanns-Regular-fcb0fc02dcbee4c9846b3e2508668039.woff2",G1e=[{uri:z1e,descriptors:{unicodeRange:"U+20-7e,U+a1-a6,U+a8,U+ab-ac,U+af-b1,U+b4,U+b8,U+bb-bc,U+bf-cf,U+d1-d7,U+d9-de,U+e0-ef,U+f1-f7,U+f9-ff,U+131,U+152-153,U+2c6,U+2da,U+2dc,U+2013-2014,U+2018-201a,U+201c-201d,U+2020-2022,U+2026,U+2039-203a,U+2044,U+20ac,U+2191,U+2193,U+2212"}},{uri:$1e,descriptors:{unicodeRange:"U+100-10f,U+112-125,U+128-130,U+134-137,U+139-13c,U+141-148,U+14c-151,U+154-161,U+164-165,U+168-17f,U+1bf,U+1f7,U+218-21b,U+237,U+1e80-1e85,U+1ef2-1ef3,U+a75b"}},{uri:V1e,descriptors:{unicodeRange:"U+2c7,U+2d8-2d9,U+2db,U+2dd,U+315,U+2190,U+2192,U+2200,U+2203-2204,U+2264-2265,U+f6c3"}},{uri:H1e,descriptors:{unicodeRange:"U+3bb"}}],X1e=[{uri:R9}];class j1e{constructor(t){F(this,"instance");F(this,"debounceTerminate");this.instance=new Worker(t,{type:"module"})}}class gT{constructor(t,n){F(this,"idleWorkers",new Set);F(this,"workerUrl");F(this,"workerTTL");this.workerUrl=t,this.workerTTL=n.ttl||1e3}static create(t,n={}){if(!t)throw new RV;if(!import.meta.url||t.toString()===import.meta.url)throw new DV;return new gT(t,n)}async postMessage(t,n){let i;const s=Array.from(this.idleWorkers).shift();return s?(this.idleWorkers.delete(s),i=s):i=await this.createWorker(),new Promise((r,o)=>{i.instance.onmessage=this.onMessageHandler(i,r),i.instance.onerror=this.onErrorHandler(i,o),i.instance.postMessage(t,n),i.debounceTerminate(()=>o(new Error(`Active worker did not respond for ${this.workerTTL}ms!`)))})}async clear(){for(const t of this.idleWorkers)t.debounceTerminate.cancel(),t.instance.terminate();this.idleWorkers.clear()}async createWorker(){const t=new j1e(this.workerUrl);return t.debounceTerminate=sl(n=>{t.instance.terminate(),this.idleWorkers.has(t)?(this.idleWorkers.delete(t),console.debug("Job finished! Idle worker has been released from the pool.")):n?n():console.error("Worker has been terminated!")},this.workerTTL),t}onMessageHandler(t,n){return i=>{t.debounceTerminate(),this.idleWorkers.add(t),n(i.data)}}onErrorHandler(t,n){return i=>{t.debounceTerminate(()=>n(i)),t.debounceTerminate.flush(),this.clear()}}}let Sk=typeof Worker<"u";const Y1e=async(e,t)=>{const{Commands:n,subsetToBase64:i,toBase64:s}=await K1e();return Sk?Pc(async()=>{try{const r=await Z1e(),o=e.slice(0),a=await r.postMessage({command:n.Subset,arrayBuffer:o,codePoints:t},{transfer:[o]});return s(a)}catch(r){return Sk=!1,kre()&&(r instanceof RV||r instanceof DV)||console.error("Failed to use workers for subsetting, falling back to the main thread.",r),i(e,t)}}):i(e,t)};let q8=null,Q8=null;const W1e=async()=>(q8||(q8=ye(()=>import("./subset-worker.chunk-CVR6pt27.js"),__vite__mapDeps([0,1]))),q8),K1e=async()=>(Q8||(Q8=ye(()=>import("./subset-shared.chunk-D3ioWSie.js"),__vite__mapDeps([]))),Q8);let J8=null;const Z1e=()=>(J8||(J8=Pc(async()=>{const{WorkerUrl:e}=await W1e();return gT.create(e)})),J8);var e3={};const Kf=class Kf{constructor(t,n,i){F(this,"urls");F(this,"fontFace");this.urls=Kf.createUrls(n);const s=this.urls.map(r=>`url(${r}) ${Kf.getFormat(r)}`).join(", ");this.fontFace=new FontFace(t,s,{display:"swap",style:"normal",weight:"400",...i})}toCSS(t){if(!this.getUnicodeRangeRegex().test(t))return;const n=Array.from(t).map(i=>i.codePointAt(0));return this.getContent(n).then(i=>`@font-face { font-family: ${this.fontFace.family}; src: url(${i}); }`)}async getContent(t){let n=0;const i=[];for(;n<this.urls.length;){const s=this.urls[n];try{const r=await this.fetchFont(s);return await Y1e(r,t)}catch(r){i.push(`"${s.toString()}" returned error "${r}"`)}n++}return console.error(`Failed to fetch font family "${this.fontFace.family}"`,JSON.stringify(i,void 0,2)),this.urls.length?this.urls[this.urls.length-1].toString():""}fetchFont(t){return Pc(async()=>{const n=await fetch(t,{cache:"force-cache",headers:{Accept:"font/woff2"}});if(!n.ok){const s=t instanceof URL?t.toString():"dataurl";throw new Error(`Failed to fetch "${s}": ${n.statusText}`)}return await n.arrayBuffer()})}getUnicodeRangeRegex(){const t=this.fontFace.unicodeRange.split(/,\s*/).map(n=>{const[i,s]=n.replace("U+","").split("-");return s?`\\u{${i}}-\\u{${s}}`:`\\u{${i}}`}).join("");return new RegExp(`[${t}]`,"u")}static createUrls(t){if(t.startsWith("data"))return[t];if(t.startsWith(R9))return[];if(t.startsWith("http"))return[new URL(t)];const n=t.replace(/^\/+/,""),i=[];if(typeof window.EXCALIDRAW_ASSET_PATH=="string"){const s=this.normalizeBaseUrl(window.EXCALIDRAW_ASSET_PATH);i.push(new URL(n,s))}else Array.isArray(window.EXCALIDRAW_ASSET_PATH)&&window.EXCALIDRAW_ASSET_PATH.forEach(s=>{const r=this.normalizeBaseUrl(s);i.push(new URL(n,r))});return i.push(new URL(n,Kf.ASSETS_FALLBACK_URL)),i}static getFormat(t){if(!(t instanceof URL))return"";try{const n=new URL(t).pathname.split(".");return n.length===1?"":`format('${n.pop()}')`}catch{return""}}static normalizeBaseUrl(t){var i;let n=t;return/^\.?\//.test(n)&&(n=new URL(n.replace(/^\.?\/+/,""),(i=window==null?void 0:window.location)==null?void 0:i.origin).toString()),n=`${n.replace(/\/+$/,"")}/`,n}};F(Kf,"ASSETS_FALLBACK_URL",`https://esm.sh/${e3.PKG_NAME?`${e3.PKG_NAME}@${e3.PKG_VERSION}`:"@excalidraw/excalidraw"}/dist/prod/`);let dv=Kf;const q1e="/fonts/Excalifont/Excalifont-Regular-349fac6ca4700ffec595a7150a0d1e1d.woff2",Q1e="/fonts/Excalifont/Excalifont-Regular-3f2c5db56cc93c5a6873b1361d730c16.woff2",J1e="/fonts/Excalifont/Excalifont-Regular-41b173a47b57366892116a575a43e2b6.woff2",e0e="/fonts/Excalifont/Excalifont-Regular-623ccf21b21ef6b3a0d87738f77eb071.woff2",t0e="/fonts/Excalifont/Excalifont-Regular-a88b72a24fb54c9f94e3b5fdaa7481c9.woff2",n0e="/fonts/Excalifont/Excalifont-Regular-b9dcf9d2e50a1eaf42fc664b50a3fd0d.woff2",i0e="/fonts/Excalifont/Excalifont-Regular-be310b9bcd4f1a43f571c46df7809174.woff2",s0e=[{uri:t0e,descriptors:{unicodeRange:"U+20-7e,U+a0-a3,U+a5-a6,U+a8-ab,U+ad-b1,U+b4,U+b6-b8,U+ba-ff,U+131,U+152-153,U+2bc,U+2c6,U+2da,U+2dc,U+304,U+308,U+2013-2014,U+2018-201a,U+201c-201e,U+2020,U+2022,U+2024-2026,U+2030,U+2039-203a,U+20ac,U+2122,U+2212"}},{uri:i0e,descriptors:{unicodeRange:"U+100-130,U+132-137,U+139-149,U+14c-151,U+154-17e,U+192,U+1fc-1ff,U+218-21b,U+237,U+1e80-1e85,U+1ef2-1ef3,U+2113"}},{uri:n0e,descriptors:{unicodeRange:"U+400-45f,U+490-491,U+2116"}},{uri:J1e,descriptors:{unicodeRange:"U+37e,U+384-38a,U+38c,U+38e-393,U+395-3a1,U+3a3-3a8,U+3aa-3cf,U+3d7"}},{uri:Q1e,descriptors:{unicodeRange:"U+2c7,U+2d8-2d9,U+2db,U+2dd,U+302,U+306-307,U+30a-30c,U+326-328,U+212e,U+2211,U+fb01-fb02"}},{uri:q1e,descriptors:{unicodeRange:"U+462-463,U+472-475,U+4d8-4d9,U+4e2-4e3,U+4e6-4e9,U+4ee-4ef"}},{uri:e0e,descriptors:{unicodeRange:"U+300-301,U+303"}}],r0e=[{uri:R9}],o0e="/fonts/LiberationSans/LiberationSans-Regular.woff2",a0e=[{uri:o0e}],l0e="/fonts/Lilita/Lilita-Regular-i7dPIFZ9Zz-WBtRtedDbYE98RXi4EwSsbg.woff2",c0e="/fonts/Lilita/Lilita-Regular-i7dPIFZ9Zz-WBtRtedDbYEF8RXi4EwQ.woff2",u0e=[{uri:l0e,descriptors:{unicodeRange:Iu.LATIN_EXT}},{uri:c0e,descriptors:{unicodeRange:Iu.LATIN}}],d0e="/fonts/Nunito/Nunito-Regular-XRXI3I6Li01BKofiOc5wtlZ2di8HDIkhdTA3j6zbXWjgevT5.woff2",f0e="/fonts/Nunito/Nunito-Regular-XRXI3I6Li01BKofiOc5wtlZ2di8HDIkhdTQ3j6zbXWjgeg.woff2",h0e="/fonts/Nunito/Nunito-Regular-XRXI3I6Li01BKofiOc5wtlZ2di8HDIkhdTk3j6zbXWjgevT5.woff2",g0e="/fonts/Nunito/Nunito-Regular-XRXI3I6Li01BKofiOc5wtlZ2di8HDIkhdTo3j6zbXWjgevT5.woff2",m0e="/fonts/Nunito/Nunito-Regular-XRXI3I6Li01BKofiOc5wtlZ2di8HDIkhdTs3j6zbXWjgevT5.woff2",p0e=[{uri:h0e,descriptors:{unicodeRange:Iu.CYRILIC_EXT,weight:"500"}},{uri:d0e,descriptors:{unicodeRange:Iu.CYRILIC,weight:"500"}},{uri:m0e,descriptors:{unicodeRange:Iu.VIETNAMESE,weight:"500"}},{uri:g0e,descriptors:{unicodeRange:Iu.LATIN_EXT,weight:"500"}},{uri:f0e,descriptors:{unicodeRange:Iu.LATIN,weight:"500"}}],U0e="/fonts/Virgil/Virgil-Regular.woff2",b0e=[{uri:U0e}],y0e="/fonts/Xiaolai/Xiaolai-Regular-019d66dcad46dc156b162d267f981c20.woff2",E0e="/fonts/Xiaolai/Xiaolai-Regular-04b718e5623574919c8b0dea5f301444.woff2",v0e="/fonts/Xiaolai/Xiaolai-Regular-069e77aac84590e2e991d0a0176d34f2.woff2",w0e="/fonts/Xiaolai/Xiaolai-Regular-06c77b8c66e51ed6c63ccb502dd8b8af.woff2",_0e="/fonts/Xiaolai/Xiaolai-Regular-08e0dc436ad0ad61ba5558db0674d762.woff2",T0e="/fonts/Xiaolai/Xiaolai-Regular-093b9ef39a46ceae95a1df18a0a3a326.woff2",I0e="/fonts/Xiaolai/Xiaolai-Regular-095c169f3314805276f603a362766abd.woff2",S0e="/fonts/Xiaolai/Xiaolai-Regular-09850c4077f3fffe707905872e0e2460.woff2",x0e="/fonts/Xiaolai/Xiaolai-Regular-41521fade99856108931b4768b1b2648.woff2",C0e="/fonts/Xiaolai/Xiaolai-Regular-544fc28abe2c5c30e62383fd4dac255f.woff2",A0e="/fonts/Xiaolai/Xiaolai-Regular-60a3089806700d379f11827ee9843b6b.woff2",M0e="/fonts/Xiaolai/Xiaolai-Regular-7eb9fffd1aa890d07d0f88cc82e6cfe4.woff2",k0e="/fonts/Xiaolai/Xiaolai-Regular-6fe5c5973cc06f74b2387a631ea36b88.woff2",R0e="/fonts/Xiaolai/Xiaolai-Regular-a4c34be6d42152e64b0df90bc4607f64.woff2",D0e="/fonts/Xiaolai/Xiaolai-Regular-b96d9226ce77ec94ceca043d712182e6.woff2",L0e="/fonts/Xiaolai/Xiaolai-Regular-6ae5b42180ad70b971c91e7eefb8eba2.woff2",N0e="/fonts/Xiaolai/Xiaolai-Regular-c69f61a4ab18d0488c8d1fc12e7028e8.woff2",O0e="/fonts/Xiaolai/Xiaolai-Regular-cb17fc3db95f6d139afc9d31a8e93293.woff2",P0e="/fonts/Xiaolai/Xiaolai-Regular-e3fcf5180fd466c8915c4e8069491054.woff2",F0e="/fonts/Xiaolai/Xiaolai-Regular-c1f94158256bb1f3bf665b053d895af9.woff2",B0e="/fonts/Xiaolai/Xiaolai-Regular-7197d6fda6cba7c3874c53d6381ca239.woff2",z0e="/fonts/Xiaolai/Xiaolai-Regular-70c2eb8d64e71a42a834eb857ea9df51.woff2",H0e="/fonts/Xiaolai/Xiaolai-Regular-a004ddfcb26e67bd6e678c8ed19e25ce.woff2",V0e="/fonts/Xiaolai/Xiaolai-Regular-7e4bde7e9c7f84cd34d8a845e384c746.woff2",$0e="/fonts/Xiaolai/Xiaolai-Regular-23686f7f29da6e8008c36dd3a80c83d6.woff2",G0e="/fonts/Xiaolai/Xiaolai-Regular-69c09cc5fa3e55c74fc4821f76909cc3.woff2",X0e="/fonts/Xiaolai/Xiaolai-Regular-25b7f38e18f035f96cb5e547bd2bd08c.woff2",j0e="/fonts/Xiaolai/Xiaolai-Regular-ba3de316d63c7e339987b16f41a0b879.woff2",Y0e="/fonts/Xiaolai/Xiaolai-Regular-12b52b58eb3df36804b9a654ec9ee194.woff2",W0e="/fonts/Xiaolai/Xiaolai-Regular-b1220a3c61f85cc0408deedb4c5f57a2.woff2",K0e="/fonts/Xiaolai/Xiaolai-Regular-4535823663ad81405188a528d8f2b1a2.woff2",Z0e="/fonts/Xiaolai/Xiaolai-Regular-3eaa538115d76932653c21d8dc28f207.woff2",q0e="/fonts/Xiaolai/Xiaolai-Regular-7e929f262f30c8ee78bf398150b1a7cd.woff2",Q0e="/fonts/Xiaolai/Xiaolai-Regular-73e309718fd16cea44b4d54a33581811.woff2",J0e="/fonts/Xiaolai/Xiaolai-Regular-9eb5a99df4e76ac3363453ac9ca288b1.woff2",eme="/fonts/Xiaolai/Xiaolai-Regular-3e63ed8162808a9e425ed80a8bc79114.woff2",tme="/fonts/Xiaolai/Xiaolai-Regular-c8b71798409ccc126ee264a00aadcf21.woff2",nme="/fonts/Xiaolai/Xiaolai-Regular-11c345711937f0ba4b8f7b6b919c8440.woff2",ime="/fonts/Xiaolai/Xiaolai-Regular-e480d9c614742d05f0e78f274f1e69e6.woff2",sme="/fonts/Xiaolai/Xiaolai-Regular-95429962233afd82db1c27df1500a28c.woff2",rme="/fonts/Xiaolai/Xiaolai-Regular-2cf96d082d35ea3d8106851223ad0d16.woff2",ome="/fonts/Xiaolai/Xiaolai-Regular-2d43040e86ff03ba677f6f9c04cd0805.woff2",ame="/fonts/Xiaolai/Xiaolai-Regular-2a26d20a23b00898ce82f09d2ee47c3f.woff2",lme="/fonts/Xiaolai/Xiaolai-Regular-a365e82ed54697a52f27adcea1315fe8.woff2",cme="/fonts/Xiaolai/Xiaolai-Regular-e4bca6cfa53e499cae0a6be4894a90e9.woff2",ume="/fonts/Xiaolai/Xiaolai-Regular-e51ef413167c6e14e0c0fdcc585f2fc9.woff2",dme="/fonts/Xiaolai/Xiaolai-Regular-e5f453bb04da18eed01675eeebd88bf8.woff2",fme="/fonts/Xiaolai/Xiaolai-Regular-e656f091b9dc4709722c9f4b84d3c797.woff2",hme="/fonts/Xiaolai/Xiaolai-Regular-f0f13b5c60e0af5553bd359f5513be1b.woff2",gme="/fonts/Xiaolai/Xiaolai-Regular-f5d079153c99a25b9be5b8583c4cc8a7.woff2",mme="/fonts/Xiaolai/Xiaolai-Regular-10a7ae9a371830a80c3d844acf1c02d7.woff2",pme="/fonts/Xiaolai/Xiaolai-Regular-60a41c7e1c68f22424e6d22df544bc82.woff2",Ume="/fonts/Xiaolai/Xiaolai-Regular-7ab2bed91166a9dca83a5ebfbe2a7f38.woff2",bme="/fonts/Xiaolai/Xiaolai-Regular-670ba603758d94268e8606f240a42e12.woff2",yme="/fonts/Xiaolai/Xiaolai-Regular-15dc6d811c9cd078f9086a740d5a1038.woff2",Eme="/fonts/Xiaolai/Xiaolai-Regular-8c2f33cee3993174f7e87c28e4bf42ee.woff2",vme="/fonts/Xiaolai/Xiaolai-Regular-761d05e3cd968cf574166867998ef06a.woff2",wme="/fonts/Xiaolai/Xiaolai-Regular-642b26e2e5f5fb780b51b593dbc8c851.woff2",_me="/fonts/Xiaolai/Xiaolai-Regular-5572b3513ba8df57a3d5d7303ee6b11b.woff2",Tme="/fonts/Xiaolai/Xiaolai-Regular-3c9de2ae0ea4bc91a510942dfa4be8d2.woff2",Ime="/fonts/Xiaolai/Xiaolai-Regular-671a2c20b1eb9e4ef8a192833940e319.woff2",Sme="/fonts/Xiaolai/Xiaolai-Regular-4dc6d5f188d5c96d44815cd1e81aa885.woff2",xme="/fonts/Xiaolai/Xiaolai-Regular-ce4884f96f11589608b76b726a755803.woff2",Cme="/fonts/Xiaolai/Xiaolai-Regular-8f476c4c99813d57cbe6eca4727388ad.woff2",Ame="/fonts/Xiaolai/Xiaolai-Regular-5935a5775af3d5c6307ac667bd9ae74e.woff2",Mme="/fonts/Xiaolai/Xiaolai-Regular-79f007c1c6d07557120982951ea67998.woff2",kme="/fonts/Xiaolai/Xiaolai-Regular-bafff7a14c27403dcc6cf1432e8ea836.woff2",Rme="/fonts/Xiaolai/Xiaolai-Regular-543fa46ace099a7099dad69123399400.woff2",Dme="/fonts/Xiaolai/Xiaolai-Regular-4ddc14ed3eb0c3e46364317dfc0144a3.woff2",Lme="/fonts/Xiaolai/Xiaolai-Regular-0fa55a080fcd0f9dc2e0b0058b793df8.woff2",Nme="/fonts/Xiaolai/Xiaolai-Regular-66493ba5a8367f2928812f446f47b56a.woff2",Ome="/fonts/Xiaolai/Xiaolai-Regular-57862b464a55b18c7bf234ce22907d73.woff2",Pme="/fonts/Xiaolai/Xiaolai-Regular-8d3bcabb847b56243b16afe62adaaf21.woff2",Fme="/fonts/Xiaolai/Xiaolai-Regular-2b77e8ebfb2367ab2662396a60e7d320.woff2",Bme="/fonts/Xiaolai/Xiaolai-Regular-0b5d723fdc4e249c140f0909e87d03b4.woff2",zme="/fonts/Xiaolai/Xiaolai-Regular-cdbce89e82cc1ab53a2decbf5819278f.woff2",Hme="/fonts/Xiaolai/Xiaolai-Regular-739bc1a567439c7cffcd1614644593d2.woff2",Vme="/fonts/Xiaolai/Xiaolai-Regular-72252d73220fa3cd856677888cee1635.woff2",$me="/fonts/Xiaolai/Xiaolai-Regular-cf6ff4e0f491ca0cf3038187a997b9b4.woff2",Gme="/fonts/Xiaolai/Xiaolai-Regular-9cfb2a77a4e45025105ad29a1748b90d.woff2",Xme="/fonts/Xiaolai/Xiaolai-Regular-450da755d5bcb70906e1295e559b9602.woff2",jme="/fonts/Xiaolai/Xiaolai-Regular-0986d134c05864f5025962eef9f994a0.woff2",Yme="/fonts/Xiaolai/Xiaolai-Regular-1ee544f0f1dac422545c505baa788992.woff2",Wme="/fonts/Xiaolai/Xiaolai-Regular-4806e761d750087c2d734fc64596eaff.woff2",Kme="/fonts/Xiaolai/Xiaolai-Regular-33432927cd87d40cfe393c7482bf221f.woff2",Zme="/fonts/Xiaolai/Xiaolai-Regular-be549ab72f0719d606a5c01e2c0219b6.woff2",qme="/fonts/Xiaolai/Xiaolai-Regular-b5c1596551c256e0e9cf02028595b092.woff2",Qme="/fonts/Xiaolai/Xiaolai-Regular-cf2cc71752631e579e35b0e423bf2638.woff2",Jme="/fonts/Xiaolai/Xiaolai-Regular-6f3256af8454371776bc46670d33cc65.woff2",epe="/fonts/Xiaolai/Xiaolai-Regular-23f228f3999c01983860012330e4be08.woff2",tpe="/fonts/Xiaolai/Xiaolai-Regular-21430ee05a1248901da8d0de08744d47.woff2",npe="/fonts/Xiaolai/Xiaolai-Regular-5330a2119a716e4e7224ed108b085dac.woff2",ipe="/fonts/Xiaolai/Xiaolai-Regular-cd145ce4a0ea18469358df53c207bc1b.woff2",spe="/fonts/Xiaolai/Xiaolai-Regular-36925dfe329a45086cbb7fc5c20d45ac.woff2",rpe="/fonts/Xiaolai/Xiaolai-Regular-4bfaa8ffa64c5ee560aa2daba7c9cbd3.woff2",ope="/fonts/Xiaolai/Xiaolai-Regular-112c051027b2d766c19a519f6ee1f4f7.woff2",ape="/fonts/Xiaolai/Xiaolai-Regular-5b0ed6971aaab9c8ad563230bd5471a7.woff2",lpe="/fonts/Xiaolai/Xiaolai-Regular-98f2ad84457de7f3740d9920b8fa8667.woff2",cpe="/fonts/Xiaolai/Xiaolai-Regular-733171b4ffcd17ea1fe1c0ba627173bf.woff2",upe="/fonts/Xiaolai/Xiaolai-Regular-684d65f1793cac449dde5d59cb3c47fb.woff2",dpe="/fonts/Xiaolai/Xiaolai-Regular-cbaaefaaf326668277aa24dfa93c4d28.woff2",fpe="/fonts/Xiaolai/Xiaolai-Regular-58fd02350d0bc52cf1ca3bb32ce9766e.woff2",hpe="/fonts/Xiaolai/Xiaolai-Regular-7ccce86603f80a099ddb0cb21d4ae3e3.woff2",gpe="/fonts/Xiaolai/Xiaolai-Regular-3717077e38f98d89eae729b6c14e56dc.woff2",mpe="/fonts/Xiaolai/Xiaolai-Regular-dbea1af6dcd9860be40c3d18254338f5.woff2",ppe="/fonts/Xiaolai/Xiaolai-Regular-4a0fdb40036e87b40aa08dd30584cb85.woff2",Upe="/fonts/Xiaolai/Xiaolai-Regular-0f626226ba1272e832aea87bafd9720e.woff2",bpe="/fonts/Xiaolai/Xiaolai-Regular-938d90c10ff8c20386af7f242c05d6b0.woff2",ype="/fonts/Xiaolai/Xiaolai-Regular-b6d128682ee29e471486354d486a1b90.woff2",Epe="/fonts/Xiaolai/Xiaolai-Regular-9d81066dd2b337c938df6e90380a00dc.woff2",vpe="/fonts/Xiaolai/Xiaolai-Regular-20e7bf72fa05de9adf7dbcc7bf51dde6.woff2",wpe="/fonts/Xiaolai/Xiaolai-Regular-4095eb84ef3874e2600247bee0b04026.woff2",_pe="/fonts/Xiaolai/Xiaolai-Regular-4ee10ae43505e2e0bc62656ced49c0fa.woff2",Tpe="/fonts/Xiaolai/Xiaolai-Regular-7494dc504ae00ee9cd0505f990f88c5d.woff2",Ipe="/fonts/Xiaolai/Xiaolai-Regular-8de5b863cb50dfefdd07cb11c774d579.woff2",Spe="/fonts/Xiaolai/Xiaolai-Regular-3e1f8f654357353bf0e04ba5c34b5f7f.woff2",xpe="/fonts/Xiaolai/Xiaolai-Regular-2e33e8dc771ef5e1d9127d60a6b73679.woff2",Cpe="/fonts/Xiaolai/Xiaolai-Regular-173945821411c09f70c95f98d590e697.woff2",Ape="/fonts/Xiaolai/Xiaolai-Regular-b358f7a51ece39a3247942b1feabdb29.woff2",Mpe="/fonts/Xiaolai/Xiaolai-Regular-23ad2d71b280f00b1363b95b7bea94eb.woff2",kpe="/fonts/Xiaolai/Xiaolai-Regular-5882ffa04f32584d26109137e2da4352.woff2",Rpe="/fonts/Xiaolai/Xiaolai-Regular-a203b91dad570bf05a58c3c3ddb529bf.woff2",Dpe="/fonts/Xiaolai/Xiaolai-Regular-bd77e3c7f9e0b072d96af37f73d1aa32.woff2",Lpe="/fonts/Xiaolai/Xiaolai-Regular-5a45d991244d4c7140217e1e5f5ca4f4.woff2",Npe="/fonts/Xiaolai/Xiaolai-Regular-f56414bf9bced67990def8660e306759.woff2",Ope="/fonts/Xiaolai/Xiaolai-Regular-583d166e56ba0de4b77eabb47ef67839.woff2",Ppe="/fonts/Xiaolai/Xiaolai-Regular-7f855356ab893b0d2b9c1c83b8116f0e.woff2",Fpe="/fonts/Xiaolai/Xiaolai-Regular-b57aaedfd8ebdf3931f25119dc6a5eb2.woff2",Bpe="/fonts/Xiaolai/Xiaolai-Regular-b6fd38ca30869792244804b04bc058da.woff2",zpe="/fonts/Xiaolai/Xiaolai-Regular-452225341522a7942f0f6aab1a5c91a3.woff2",Hpe="/fonts/Xiaolai/Xiaolai-Regular-866fa7613df6b3fd272bcfd4530c0bb9.woff2",Vpe="/fonts/Xiaolai/Xiaolai-Regular-52a84a22fd1369bffeaf21da2d6158dc.woff2",$pe="/fonts/Xiaolai/Xiaolai-Regular-829615148e6357d826b9242eb7fbbd1e.woff2",Gpe="/fonts/Xiaolai/Xiaolai-Regular-c99eda15fc26a2941579560f76c3a5cf.woff2",Xpe="/fonts/Xiaolai/Xiaolai-Regular-395c35dd584b56b0789f58a0559beaf1.woff2",jpe="/fonts/Xiaolai/Xiaolai-Regular-203b0e569e3b14aac86a003dc3fa523e.woff2",Ype="/fonts/Xiaolai/Xiaolai-Regular-51a0e808bbc8361236ac521a119758a3.woff2",Wpe="/fonts/Xiaolai/Xiaolai-Regular-6e092f71c1e634059ada0e52abadce67.woff2",Kpe="/fonts/Xiaolai/Xiaolai-Regular-0f7fb1e0d5015bb1371343153ecf7ce3.woff2",Zpe="/fonts/Xiaolai/Xiaolai-Regular-d0cf73942fea1c74edbdf0b3011f4656.woff2",qpe="/fonts/Xiaolai/Xiaolai-Regular-968cffdc8ee679da094e77ebf50f58ef.woff2",Qpe="/fonts/Xiaolai/Xiaolai-Regular-7a07ddc0f0c0f5f4a9bad6ee3dda66b5.woff2",Jpe="/fonts/Xiaolai/Xiaolai-Regular-ec181b795ac1fb5a50d700b6e996d745.woff2",eUe="/fonts/Xiaolai/Xiaolai-Regular-cfb211578629b7e8153b37240de6a9d5.woff2",tUe="/fonts/Xiaolai/Xiaolai-Regular-59e9ff77b0efaf684bc09274fb6908c9.woff2",nUe="/fonts/Xiaolai/Xiaolai-Regular-2adbc89c11e65905393d3dfc468b9d5b.woff2",iUe="/fonts/Xiaolai/Xiaolai-Regular-70e811fd7994e61f408c923de6ddd078.woff2",sUe="/fonts/Xiaolai/Xiaolai-Regular-c4a687ac4f0c2766eefc9f77ed99cddf.woff2",rUe="/fonts/Xiaolai/Xiaolai-Regular-51502f1206be09c565f1547c406e9558.woff2",oUe="/fonts/Xiaolai/Xiaolai-Regular-1fdc0c67ed57263a80fd108c1f6ccf24.woff2",aUe="/fonts/Xiaolai/Xiaolai-Regular-e11567fd2accf9957cd0d3c2be937d87.woff2",lUe="/fonts/Xiaolai/Xiaolai-Regular-20cc1bbf50e7efb442756cb605672c1f.woff2",cUe="/fonts/Xiaolai/Xiaolai-Regular-5d2898fbc097a7e24c6f38d80587621e.woff2",uUe="/fonts/Xiaolai/Xiaolai-Regular-ac9ceb44437becc3e9c4dbfebab7fc2d.woff2",dUe="/fonts/Xiaolai/Xiaolai-Regular-c16ed9740b85badf16e86ea782a3062f.woff2",fUe="/fonts/Xiaolai/Xiaolai-Regular-aa0d470430e6391eca720c7cfa44446f.woff2",hUe="/fonts/Xiaolai/Xiaolai-Regular-f2b54d4e7be0eaefe1c2c56836fa5368.woff2",gUe="/fonts/Xiaolai/Xiaolai-Regular-99a16ef6a64934d5781933dbd9c46b2e.woff2",mUe="/fonts/Xiaolai/Xiaolai-Regular-c40533fdf4cc57177b12803598af7e59.woff2",pUe="/fonts/Xiaolai/Xiaolai-Regular-91ddb2969bf2d31ba02ad82998d1314c.woff2",UUe="/fonts/Xiaolai/Xiaolai-Regular-774d4f764a1299da5d28ec2f2ffe0d69.woff2",bUe="/fonts/Xiaolai/Xiaolai-Regular-7718fe60986d8b42b1be9c5ace5ccf25.woff2",yUe="/fonts/Xiaolai/Xiaolai-Regular-aa5c9ca6cf4fba00433b7aa3fa10671a.woff2",EUe="/fonts/Xiaolai/Xiaolai-Regular-4f50e5136e136527280bc902c5817561.woff2",vUe="/fonts/Xiaolai/Xiaolai-Regular-a0ca5df4258213d7fc9fce80f65ce760.woff2",wUe="/fonts/Xiaolai/Xiaolai-Regular-d2666cbed13462c5dc36fa2f15c202ca.woff2",_Ue="/fonts/Xiaolai/Xiaolai-Regular-1e6fd68f1f3902ce48ce8c69df385622.woff2",TUe="/fonts/Xiaolai/Xiaolai-Regular-87599f94b6cc129d505b375798d0d751.woff2",IUe="/fonts/Xiaolai/Xiaolai-Regular-13ae07ed2e272d26d59bc0691cd7117a.woff2",SUe="/fonts/Xiaolai/Xiaolai-Regular-353f33792a8f60dc69323ddf635a269e.woff2",xUe="/fonts/Xiaolai/Xiaolai-Regular-0facdf1ea213ba40261022f5d5ed4493.woff2",CUe="/fonts/Xiaolai/Xiaolai-Regular-f6032fc06eb20480f096199713f70885.woff2",AUe="/fonts/Xiaolai/Xiaolai-Regular-f8ee5d36068a42b51d0e4a1116cfcec1.woff2",MUe="/fonts/Xiaolai/Xiaolai-Regular-79d494361ae093b69e74ee9dbe65bfd4.woff2",kUe="/fonts/Xiaolai/Xiaolai-Regular-74e2263a91439c25b91d5132ce9f4d62.woff2",RUe="/fonts/Xiaolai/Xiaolai-Regular-ee8bae97908d5147b423f77ad0d3c1bb.woff2",DUe="/fonts/Xiaolai/Xiaolai-Regular-56467a5c8840c4d23a60b2f935114848.woff2",LUe="/fonts/Xiaolai/Xiaolai-Regular-145aa02cdd91946e67dc934e1acffe75.woff2",NUe="/fonts/Xiaolai/Xiaolai-Regular-54acdfc2166ad7fcbd074f75fd4a56ba.woff2",OUe="/fonts/Xiaolai/Xiaolai-Regular-29cec36cd205b211da97acabaa62f055.woff2",PUe="/fonts/Xiaolai/Xiaolai-Regular-3756e81d3e149cf6099163ee79944fec.woff2",FUe="/fonts/Xiaolai/Xiaolai-Regular-8e9f97f01034820170065b2921b4fb5e.woff2",BUe="/fonts/Xiaolai/Xiaolai-Regular-13d2887ec8ee73c43acdabc52a05af7b.woff2",zUe="/fonts/Xiaolai/Xiaolai-Regular-72536a3d71b694a0d53dd90ddceae41e.woff2",HUe="/fonts/Xiaolai/Xiaolai-Regular-603aefd23e350ba7eb124273e3c9bcf1.woff2",VUe="/fonts/Xiaolai/Xiaolai-Regular-9544732d2e62d1a429674f8ee41b5d3a.woff2",$Ue="/fonts/Xiaolai/Xiaolai-Regular-d3716376641d615e2995605b29bca7b6.woff2",GUe="/fonts/Xiaolai/Xiaolai-Regular-5a1ce3117cfe90c48e8fb4a9a00f694d.woff2",XUe="/fonts/Xiaolai/Xiaolai-Regular-b7d203b051eff504ff59ddca7576b6a9.woff2",jUe="/fonts/Xiaolai/Xiaolai-Regular-4a38cc3e9cf104e69ba246d37f8cf135.woff2",YUe="/fonts/Xiaolai/Xiaolai-Regular-982b630266d87db93d2539affb1275c6.woff2",WUe="/fonts/Xiaolai/Xiaolai-Regular-9592bfc861f07bcb8d75c196b370e548.woff2",KUe="/fonts/Xiaolai/Xiaolai-Regular-a7accba310e821da5505f71c03b76bdb.woff2",ZUe="/fonts/Xiaolai/Xiaolai-Regular-dac48066b5883d8b4551fc584f0c2a3e.woff2",qUe="/fonts/Xiaolai/Xiaolai-Regular-a1f916d6039285c4ffb900cd654e418f.woff2",QUe="/fonts/Xiaolai/Xiaolai-Regular-95bfd249da4902577b4b7d76ebdd0b44.woff2",JUe="/fonts/Xiaolai/Xiaolai-Regular-93fc8f28a33234bcadf1527cafabd502.woff2",e2e="/fonts/Xiaolai/Xiaolai-Regular-903bb6865f3452e2fda42e3a25547bc5.woff2",t2e="/fonts/Xiaolai/Xiaolai-Regular-4aca6a43e59aceee2166b0c7e4e85ef1.woff2",n2e="/fonts/Xiaolai/Xiaolai-Regular-24476a126f129212beb33f66853ea151.woff2",i2e="/fonts/Xiaolai/Xiaolai-Regular-1b611157cd46bb184d4fa4dae2d6a2b8.woff2",s2e="/fonts/Xiaolai/Xiaolai-Regular-56a32a7689abd0326e57c10c6c069bb4.woff2",r2e="/fonts/Xiaolai/Xiaolai-Regular-3cc70dbb64df5b21f1326cc24dee2195.woff2",o2e="/fonts/Xiaolai/Xiaolai-Regular-e2ead7ea7da0437f085f42ffc05f8d13.woff2",a2e="/fonts/Xiaolai/Xiaolai-Regular-97f7f48ce90c9429bf32ae51469db74d.woff2",l2e="/fonts/Xiaolai/Xiaolai-Regular-24a21c1e4449222e8d1898d69ff3a404.woff2",c2e="/fonts/Xiaolai/Xiaolai-Regular-726303e0774b4e678bff8c2deb6ca603.woff2",u2e="/fonts/Xiaolai/Xiaolai-Regular-5a7fac4b8b23a6e4e5ba0c9bf1756c91.woff2",d2e="/fonts/Xiaolai/Xiaolai-Regular-2b7441d46298788ac94e610ffcc709b6.woff2",f2e=[{uri:S0e,descriptors:{unicodeRange:"U+f9b8-fa6d,U+fe32,U+fe45-fe4f,U+ff02-ff0b,U+ff0d-ff1e,U+ff20-ff2a"}},{uri:M0e,descriptors:{unicodeRange:"U+20dd-20de,U+25ef,U+ff2b-ffbe,U+ffc2-ffc7,U+ffca-ffcf,U+ffd2-ffd7,U+ffda-ffdc,U+ffe0-ffe6,U+ffe8-ffee"}},{uri:A0e,descriptors:{unicodeRange:"U+d7eb-d7fb,U+f900-f9b7"}},{uri:k0e,descriptors:{unicodeRange:"U+d6f2-d7a3,U+d7b0-d7c6,U+d7cb-d7ea"}},{uri:D0e,descriptors:{unicodeRange:"U+d609-d6f1"}},{uri:L0e,descriptors:{unicodeRange:"U+d520-d608"}},{uri:R0e,descriptors:{unicodeRange:"U+d437-d51f"}},{uri:N0e,descriptors:{unicodeRange:"U+d34e-d436"}},{uri:P0e,descriptors:{unicodeRange:"U+d265-d34d"}},{uri:F0e,descriptors:{unicodeRange:"U+d17c-d264"}},{uri:C0e,descriptors:{unicodeRange:"U+d093-d17b"}},{uri:B0e,descriptors:{unicodeRange:"U+cfaa-d092"}},{uri:z0e,descriptors:{unicodeRange:"U+cec1-cfa9"}},{uri:v0e,descriptors:{unicodeRange:"U+cdd8-cec0"}},{uri:x0e,descriptors:{unicodeRange:"U+ccf1-cdd7"}},{uri:H0e,descriptors:{unicodeRange:"U+cc08-ccf0"}},{uri:E0e,descriptors:{unicodeRange:"U+cb43-cc07"}},{uri:V0e,descriptors:{unicodeRange:"U+ca83-cb42"}},{uri:$0e,descriptors:{unicodeRange:"U+c9a1-ca82"}},{uri:G0e,descriptors:{unicodeRange:"U+c8b8-c9a0"}},{uri:X0e,descriptors:{unicodeRange:"U+c7cf-c8b7"}},{uri:j0e,descriptors:{unicodeRange:"U+c6e6-c7ce"}},{uri:Y0e,descriptors:{unicodeRange:"U+c5fd-c6e5"}},{uri:W0e,descriptors:{unicodeRange:"U+c514-c5fc"}},{uri:K0e,descriptors:{unicodeRange:"U+c42b-c513"}},{uri:Z0e,descriptors:{unicodeRange:"U+c341-c34e,U+c350-c42a"}},{uri:q0e,descriptors:{unicodeRange:"U+c258-c340"}},{uri:Q0e,descriptors:{unicodeRange:"U+c16f-c257"}},{uri:J0e,descriptors:{unicodeRange:"U+c086-c16e"}},{uri:eme,descriptors:{unicodeRange:"U+bf9d-c085"}},{uri:O0e,descriptors:{unicodeRange:"U+beb4-bf9c"}},{uri:tme,descriptors:{unicodeRange:"U+bdcb-beb3"}},{uri:nme,descriptors:{unicodeRange:"U+bce2-bdca"}},{uri:ime,descriptors:{unicodeRange:"U+bbf9-bce1"}},{uri:sme,descriptors:{unicodeRange:"U+bb10-bbf8"}},{uri:rme,descriptors:{unicodeRange:"U+ba27-bb0f"}},{uri:ome,descriptors:{unicodeRange:"U+b93e-ba26"}},{uri:ame,descriptors:{unicodeRange:"U+b855-b93d"}},{uri:lme,descriptors:{unicodeRange:"U+b76c-b854"}},{uri:gme,descriptors:{unicodeRange:"U+b683-b76b"}},{uri:mme,descriptors:{unicodeRange:"U+b59a-b682"}},{uri:cme,descriptors:{unicodeRange:"U+b4b1-b599"}},{uri:pme,descriptors:{unicodeRange:"U+11fb-11ff,U+b3cd-b4b0"}},{uri:Ume,descriptors:{unicodeRange:"U+11e6-11fa,U+b2f9-b3cc"}},{uri:bme,descriptors:{unicodeRange:"U+11d1-11e5,U+b225-b2f8"}},{uri:fme,descriptors:{unicodeRange:"U+11bc-11d0,U+b151-b224"}},{uri:yme,descriptors:{unicodeRange:"U+11a7-11bb,U+b07d-b150"}},{uri:hme,descriptors:{unicodeRange:"U+1191-11a6,U+afaa-b07c"}},{uri:Eme,descriptors:{unicodeRange:"U+117c-1190,U+aed6-afa9"}},{uri:vme,descriptors:{unicodeRange:"U+1167-117b,U+ae02-aed5"}},{uri:wme,descriptors:{unicodeRange:"U+1152-115e,U+1160-1166,U+ad2d-ae01"}},{uri:_me,descriptors:{unicodeRange:"U+113d-1151,U+ac59-ad2c"}},{uri:Tme,descriptors:{unicodeRange:"U+1100-113c,U+9f95-9f98,U+9f9c-9f9e,U+9fa1-9fce,U+9fd0,U+a960-a97c,U+ac00-ac58"}},{uri:Ime,descriptors:{unicodeRange:"U+9771-9772,U+9775,U+9777-977b,U+977d-9784,U+9786-978a,U+978c,U+978e-9790,U+9793,U+9795-9797,U+9799-979f,U+97a1-97a2,U+97a4-97aa,U+97ac,U+97ae,U+97b0-97b1,U+97b3,U+97b5-97e5,U+97e8,U+97ee-97f2,U+97f4,U+97f7-982d"}},{uri:Sme,descriptors:{unicodeRange:"U+9491,U+9496,U+9498,U+94c7,U+94cf,U+94d3-94d4,U+94da,U+94e6,U+94fb,U+951c,U+9520,U+9527,U+9533,U+953d,U+9543,U+9548,U+954b,U+9555,U+955a,U+9560,U+956e,U+9574-9575,U+9577-957e,U+9580-95e7,U+95ec,U+95ff,U+9607,U+9613,U+9618,U+961b,U+961e,U+9620,U+9623-9629,U+962b-962d,U+962f-9630,U+9637-963a,U+963e,U+9641,U+9643,U+964a,U+964e-964f,U+9651-9653,U+9656-965a,U+965c-965e,U+9660,U+9663,U+9665-9666,U+966b,U+966d-9671,U+9673,U+9678-9684,U+9687,U+9689-968a,U+968c,U+968e,U+9691-9693"}},{uri:xme,descriptors:{unicodeRange:"U+923c-9273,U+9275-928d,U+928f-92ad,U+92af-92c7,U+92c9-92ee"}},{uri:Cme,descriptors:{unicodeRange:"U+9159,U+915b-915c,U+915f-9160,U+9166-9168,U+916b,U+916d,U+9173,U+917a-917c,U+9180-9184,U+9186,U+9188,U+918a,U+918e-918f,U+9193-9199,U+919c-91a1,U+91a4-91a9,U+91ab-91ac,U+91b0-91b3,U+91b6-91b9,U+91bb-91c6,U+91c8,U+91cb,U+91d0,U+91d2-91db,U+91dd-923b"}},{uri:Ame,descriptors:{unicodeRange:"U+902b-902c,U+9030-9034,U+9037,U+9039-903a,U+903d,U+903f-9040,U+9043,U+9045-9046,U+9048-904c,U+904e,U+9054-9056,U+9059-905a,U+905c-9061,U+9064,U+9066-9067,U+9069-906c,U+906f-9073,U+9076-907c,U+907e,U+9081,U+9084-9087,U+9089-908a,U+908c-9090,U+9092,U+9094,U+9096,U+9098,U+909a,U+909c,U+909e-90a0,U+90a4-90a5,U+90a7-90a9,U+90ab,U+90ad,U+90b2,U+90b7,U+90bc-90bd,U+90bf-90c0,U+90c2-90c3,U+90c6,U+90c8-90c9,U+90cb-90cd,U+90d2,U+90d4-90d6,U+90d8-90da,U+90de-90e0,U+90e3-90e5,U+90e9-90ea,U+90ec,U+90ee,U+90f0-90f3,U+90f5-90f7,U+90f9-90fc,U+90ff-9101,U+9103,U+9105-9118,U+911a-911d,U+911f-9121,U+9124-912e,U+9130,U+9132-9138,U+913a-9142,U+9144-9145,U+9147-9148,U+9151,U+9153-9156,U+9158"}},{uri:Mme,descriptors:{unicodeRange:"U+8f03-8f65,U+8f6a,U+8f80,U+8f8c,U+8f92,U+8f9d,U+8fa0-8fa2,U+8fa4-8fa7,U+8faa,U+8fac-8faf,U+8fb2-8fb5,U+8fb7-8fb8,U+8fba-8fbc,U+8fbf-8fc0,U+8fc3,U+8fc6,U+8fc9-8fcd,U+8fcf,U+8fd2,U+8fd6-8fd7,U+8fda,U+8fe0-8fe1,U+8fe3,U+8fe7,U+8fec,U+8fef,U+8ff1-8ff2,U+8ff4-8ff6,U+8ffa-8ffc,U+8ffe-8fff,U+9007-9008,U+900c,U+900e,U+9013,U+9015,U+9018-9019,U+901c,U+9023-9025,U+9027-902a"}},{uri:kme,descriptors:{unicodeRange:"U+8d03-8d1c,U+8d20,U+8d51-8d52,U+8d57,U+8d5f,U+8d65,U+8d68-8d6a,U+8d6c,U+8d6e-8d6f,U+8d71-8d72,U+8d78-8d80,U+8d82-8d83,U+8d86-8d89,U+8d8c-8d90,U+8d92-8d93,U+8d95-8d9e,U+8da0-8da2,U+8da4-8db0,U+8db2,U+8db6-8db7,U+8db9,U+8dbb,U+8dbd,U+8dc0-8dc2,U+8dc5,U+8dc7-8dca,U+8dcd,U+8dd0,U+8dd2-8dd5,U+8dd8-8dd9,U+8ddc,U+8de0-8de2,U+8de5-8de7,U+8de9,U+8ded-8dee,U+8df0-8df2,U+8df4,U+8df6,U+8dfc,U+8dfe-8e04,U+8e06-8e08,U+8e0b,U+8e0d-8e0e,U+8e10-8e13,U+8e15-8e1c,U+8e20-8e21,U+8e24-8e28,U+8e2b,U+8e2d,U+8e30,U+8e32-8e34,U+8e36-8e38,U+8e3b-8e3c,U+8e3e-8e3f,U+8e43,U+8e45-8e46"}},{uri:Rme,descriptors:{unicodeRange:"U+8bea,U+8c09,U+8c1e,U+8c38-8c40,U+8c42-8c45,U+8c48,U+8c4a-8c4b,U+8c4d-8c54,U+8c56-8c59,U+8c5b-8c60,U+8c63-8c69,U+8c6c-8c72,U+8c74-8c77,U+8c7b-8c81,U+8c83-8c84,U+8c86-8c88,U+8c8b,U+8c8d-8c93,U+8c95-8c97,U+8c99-8d02"}},{uri:Dme,descriptors:{unicodeRange:"U+8a64-8a78,U+8a7a-8a88,U+8a8b-8a92,U+8a94-8b06,U+8b08-8b1b"}},{uri:Lme,descriptors:{unicodeRange:"U+8987-89c0,U+89c3,U+89cd,U+89d3-89d5,U+89d7-89d9,U+89db,U+89dd,U+89df-89e2,U+89e4,U+89e7-89ea,U+89ec-89ee,U+89f0-89f2,U+89f4-89ff,U+8a01-8a06,U+8a08-8a3d,U+8a3f-8a47,U+8a49-8a63"}},{uri:Nme,descriptors:{unicodeRange:"U+87e3-87e4,U+87e6-87e9,U+87eb-87ed,U+87ef-87f8,U+87fa-87fd,U+87ff-8802,U+8804-8809,U+880b-8812,U+8814,U+8817-881a,U+881c-8820,U+8823-8831,U+8833-8838,U+883a-883b,U+883d-883f,U+8841-8843,U+8846-884b,U+884e-8853,U+8855-8856,U+8858,U+885a-8860,U+8866-8867,U+886a,U+886d,U+886f,U+8871,U+8873-8876,U+8878-887c,U+8880,U+8883,U+8886-8887,U+8889-888a,U+888c,U+888e-8891,U+8893-8895,U+8897-889b,U+889d-88a1,U+88a3,U+88a5-88aa,U+88ac,U+88ae-88b0,U+88b2-88b6,U+88b8-88bb"}},{uri:Ome,descriptors:{unicodeRange:"U+86e7-86e8,U+86ea-86ec,U+86ef,U+86f5-86f7,U+86fa-86fd,U+86ff,U+8701,U+8704-8706,U+870b-870c,U+870e-8711,U+8714,U+8716,U+8719,U+871b,U+871d,U+871f-8720,U+8724,U+8726-8728,U+872a-872d,U+872f-8730,U+8732-8733,U+8735-8736,U+8738-873a,U+873c-873d,U+8740-8746,U+874a-874b,U+874d,U+874f-8752,U+8754-8756,U+8758,U+875a-875f,U+8761-8762,U+8766-876d,U+876f,U+8771-8773,U+8775,U+8777-877a,U+877f-8781,U+8784,U+8786-8787,U+8789-878a,U+878c,U+878e-8792,U+8794-8796,U+8798-879e,U+87a0-87a7,U+87a9-87aa,U+87ae,U+87b0-87b2,U+87b4,U+87b6-87b9,U+87bb-87bc,U+87be-87bf,U+87c1-87c5,U+87c7-87c9,U+87cc-87d0,U+87d4-87da,U+87dc-87df,U+87e1-87e2"}},{uri:Pme,descriptors:{unicodeRange:"U+8604,U+8606-8610,U+8612-8615,U+8617-8626,U+8628,U+862a-8637,U+8639-863b,U+863d-864c,U+8652-8653,U+8655-8659,U+865b-865d,U+865f-8661,U+8663-866a,U+866d,U+866f-8670,U+8672-8678,U+8683-8689,U+868e-8692,U+8694,U+8696-869b,U+869e-86a2,U+86a5-86a6,U+86ab,U+86ad-86ae,U+86b2-86b3,U+86b7-86b9,U+86bb-86bf,U+86c1-86c3,U+86c5,U+86c8,U+86cc-86cd,U+86d2-86d3,U+86d5-86d7,U+86da,U+86dc-86dd,U+86e0-86e3,U+86e5-86e6"}},{uri:Fme,descriptors:{unicodeRange:"U+8456,U+8458,U+845d-8460,U+8462,U+8464-8468,U+846a,U+846e-8470,U+8472,U+8474,U+8477,U+8479,U+847b-8481,U+8483-8486,U+848a,U+848d,U+848f-8496,U+8498,U+849a-849b,U+849d-84a0,U+84a2-84ae,U+84b0-84b1,U+84b3,U+84b5-84b7,U+84bb-84bc,U+84be,U+84c0,U+84c2-84c3,U+84c5-84c8,U+84cb-84cc,U+84ce-84cf,U+84d2,U+84d4-84d5,U+84d7-84dc,U+84de,U+84e1-84e2,U+84e4,U+84e7-84eb,U+84ed-84ef,U+84f1-84fb,U+84fd-84fe,U+8500-850b,U+850d-8510,U+8512,U+8514-8516,U+8518-8519,U+851b-851e,U+8520,U+8522-852a,U+852d-8536,U+853e-8542,U+8544-8547,U+854b-854f"}},{uri:Bme,descriptors:{unicodeRange:"U+82c2-82c3,U+82c5-82c6,U+82c9,U+82d0,U+82d6,U+82d9-82da,U+82dd,U+82e2,U+82e7-82ea,U+82ec-82ee,U+82f0,U+82f2-82f3,U+82f5-82f6,U+82f8,U+82fa,U+82fc-8300,U+830a-830b,U+830d,U+8310,U+8312-8313,U+8316,U+8318-8319,U+831d-8326,U+8329-832a,U+832e,U+8330,U+8332,U+8337,U+833b,U+833d-833f,U+8341-8342,U+8344-8345,U+8348,U+834a-834e,U+8353,U+8355-8359,U+835d,U+8362,U+8370-8376,U+8379-837a,U+837e-8384,U+8387-8388,U+838a-838d,U+838f-8391,U+8394-8397,U+8399-839a,U+839d,U+839f,U+83a1-83a7,U+83ac-83af,U+83b5,U+83bb,U+83be-83bf,U+83c2-83c4,U+83c6,U+83c8-83c9,U+83cb,U+83cd-83ce,U+83d0-83d3,U+83d5,U+83d7,U+83d9-83db,U+83de,U+83e2-83e4,U+83e6-83e8,U+83eb-83ef,U+83f3-83f7,U+83fa-83fc,U+83fe-8400,U+8402,U+8405,U+8407-840a,U+8410,U+8412-8417,U+8419-841b,U+841e-8423,U+8429-8430,U+8432-8437,U+8439-843b,U+843e-8445,U+8447-8450,U+8452-8455"}},{uri:zme,descriptors:{unicodeRange:"U+81a4-81a5,U+81a7,U+81a9,U+81ab-81b2,U+81b4-81b9,U+81bc-81bf,U+81c4-81c5,U+81c7-81c9,U+81cb,U+81cd-81e2,U+81e4-81e6,U+81e8-81e9,U+81eb,U+81ee-81f2,U+81f5-81fa,U+81fd,U+81ff,U+8203,U+8207-820b,U+820e-820f,U+8211,U+8213,U+8215-821a,U+821d,U+8220,U+8224-8227,U+8229,U+822e,U+8232,U+823a,U+823c-823d,U+823f-8243,U+8245-8246,U+8248,U+824a,U+824c-824e,U+8250-8257,U+8259,U+825b-825e,U+8260-8267,U+8269-826d,U+8271,U+8275-8278,U+827b-827c,U+8280-8281,U+8283,U+8285-8287,U+8289,U+828c,U+8290,U+8293-8296,U+829a-829b,U+829e,U+82a0,U+82a2-82a3,U+82a7,U+82b2,U+82b5-82b6,U+82ba-82bc,U+82bf-82c0"}},{uri:Hme,descriptors:{unicodeRange:"U+8059,U+805b-8068,U+806b-8070,U+8072-807e,U+8081-8082,U+8085,U+8088,U+808a,U+808d-8092,U+8094-8095,U+8097,U+8099,U+809e,U+80a3,U+80a6-80a8,U+80ac,U+80b0,U+80b3,U+80b5-80b6,U+80b8-80b9,U+80bb,U+80c5,U+80c7-80cb,U+80cf-80d5,U+80d8,U+80df-80e0,U+80e2-80e3,U+80e6,U+80ee,U+80f5,U+80f7,U+80f9,U+80fb,U+80fe-8101,U+8103-8105,U+8107-8108,U+810b-810c,U+8115,U+8117,U+8119,U+811b-811d,U+811f-812b,U+812d-812e,U+8130,U+8133-8135,U+8137,U+8139-813d,U+813f-8145,U+8147,U+8149,U+814d-814f,U+8152,U+8156-8158,U+815b-815f,U+8161-8164,U+8166,U+8168,U+816a-816c,U+816f,U+8172-8173,U+8175-8178,U+8181,U+8183-8187,U+8189,U+818b-818e,U+8190,U+8192-8197,U+8199-819a,U+819e-81a2"}},{uri:Vme,descriptors:{unicodeRange:"U+7f3c-7f41,U+7f43,U+7f46-7f4f,U+7f52-7f53,U+7f56,U+7f59,U+7f5b-7f5e,U+7f60,U+7f63-7f67,U+7f6b-7f6d,U+7f6f-7f70,U+7f73,U+7f75-7f78,U+7f7a-7f7d,U+7f7f-7f80,U+7f82-7f89,U+7f8b,U+7f8d,U+7f8f-7f93,U+7f95-7f99,U+7f9b-7f9c,U+7fa0,U+7fa2-7fa3,U+7fa5-7fa6,U+7fa8-7fae,U+7fb1,U+7fb3-7fb7,U+7fba-7fbb,U+7fbe,U+7fc0,U+7fc2-7fc4,U+7fc6-7fc9,U+7fcb,U+7fcd,U+7fcf-7fd3,U+7fd6-7fd7,U+7fd9-7fde,U+7fe2-7fe4,U+7fe7-7fe8,U+7fea-7fed,U+7fef,U+7ff2,U+7ff4-7ffa,U+7ffd-7fff,U+8002,U+8007-800a,U+800e-800f,U+8011,U+8013,U+801a-801b,U+801d-801f,U+8021,U+8023-8024,U+802b-8030,U+8032,U+8034,U+8039-803a,U+803c,U+803e,U+8040-8041,U+8044-8045,U+8047-8049,U+804e-8051,U+8053,U+8055-8057"}},{uri:_0e,descriptors:{unicodeRange:"U+7cd8,U+7cda-7cdb,U+7cdd-7cde,U+7ce1-7ce7,U+7ce9-7cee,U+7cf0-7cf7,U+7cf9-7cfa,U+7cfc-7d09,U+7d0b-7d1f,U+7d21,U+7d23-7d26,U+7d28-7d2a,U+7d2c-7d2e,U+7d30-7d6d,U+7d6f-7d76,U+7d78-7d94"}},{uri:$me,descriptors:{unicodeRange:"U+7afe,U+7b00-7b02,U+7b05,U+7b07,U+7b09,U+7b0c-7b0e,U+7b10,U+7b12-7b13,U+7b16-7b18,U+7b1a,U+7b1c-7b1d,U+7b1f,U+7b21-7b23,U+7b27,U+7b29,U+7b2d,U+7b2f-7b30,U+7b32,U+7b34-7b37,U+7b39,U+7b3b,U+7b3d,U+7b3f-7b44,U+7b46,U+7b48,U+7b4a,U+7b4d-7b4e,U+7b53,U+7b55,U+7b57,U+7b59,U+7b5c,U+7b5e-7b5f,U+7b61,U+7b63-7b6d,U+7b6f-7b70,U+7b73-7b74,U+7b76,U+7b78,U+7b7a,U+7b7c-7b7d,U+7b7f,U+7b81-7b84,U+7b86-7b8c,U+7b8e-7b8f,U+7b91-7b93,U+7b96,U+7b98-7b9b,U+7b9e-7ba0,U+7ba3-7ba5,U+7bae-7bb0,U+7bb2-7bb3,U+7bb5-7bb7,U+7bb9-7bc0,U+7bc2-7bc5,U+7bc8-7bcb,U+7bcd-7bd0,U+7bd2,U+7bd4-7bd8,U+7bdb-7bdc,U+7bde-7be0,U+7be2-7be4,U+7be7-7be9,U+7beb-7bed,U+7bef-7bf0,U+7bf2-7bf6,U+7bf8-7bfb,U+7bfd,U+7bff-7c06,U+7c08-7c0a,U+7c0d-7c0e,U+7c10-7c13"}},{uri:Gme,descriptors:{unicodeRange:"U+7a10-7a13,U+7a15-7a16,U+7a18-7a19,U+7a1b-7a1d,U+7a1f,U+7a21-7a22,U+7a24-7a32,U+7a34-7a36,U+7a38,U+7a3a,U+7a3e,U+7a40-7a45,U+7a47-7a50,U+7a52-7a56,U+7a58-7a6f,U+7a71-7a73,U+7a75,U+7a7b-7a7e,U+7a82,U+7a85,U+7a87,U+7a89-7a8c,U+7a8e-7a90,U+7a93-7a94,U+7a99-7a9b,U+7a9e,U+7aa1-7aa4,U+7aa7,U+7aa9-7aab,U+7aae-7ab2,U+7ab4-7abe,U+7ac0-7aca,U+7acc-7ad5,U+7ad7-7ad8,U+7ada-7add,U+7ae1-7ae2,U+7ae4,U+7ae7-7aec,U+7aee,U+7af0-7af8,U+7afb-7afc"}},{uri:Xme,descriptors:{unicodeRange:"U+790d-7912,U+7914-791d,U+791f-7923,U+7925-7933,U+7935-7939,U+793d,U+793f,U+7942-7945,U+7947,U+794a-7952,U+7954-7955,U+7958-7959,U+7961,U+7963-7964,U+7966,U+7969-796c,U+796e,U+7970-7976,U+7979,U+797b-797f,U+7982-7983,U+7986-7989,U+798b-798e,U+7990-7999,U+799b-79a6,U+79a8-79b2,U+79b4-79b8,U+79bc,U+79bf,U+79c2,U+79c4-79c5,U+79c7-79c8,U+79ca,U+79cc,U+79ce-79d0,U+79d3-79d4,U+79d6-79d7,U+79d9-79de,U+79e0-79e2,U+79e5,U+79e8,U+79ea,U+79ec,U+79ee,U+79f1-79f7,U+79f9-79fa,U+79fc,U+79fe-79ff,U+7a01,U+7a04-7a05,U+7a07-7a0a,U+7a0c,U+7a0f"}},{uri:jme,descriptors:{unicodeRange:"U+77d8-77da,U+77dd-77e1,U+77e4,U+77e6,U+77e8,U+77ea,U+77ef-77f2,U+77f4-77f5,U+77f7,U+77f9-77fc,U+7803-7808,U+780a-780b,U+780e-7810,U+7813,U+7815,U+7819,U+781b,U+781e,U+7820-7822,U+7824,U+7828,U+782a-782b,U+782e-782f,U+7831-7833,U+7835-7836,U+783d,U+783f,U+7841-7844,U+7846,U+7848-784b,U+784d,U+784f,U+7851,U+7853-7854,U+7858-785c,U+785e-7869,U+786f-7876,U+7878-787b,U+787d-7886,U+7888,U+788a-788b,U+788f-7890,U+7892,U+7894-7896,U+7899,U+789d-789e,U+78a0,U+78a2,U+78a4,U+78a6,U+78a8-78af,U+78b5-78b8,U+78ba-78bd,U+78bf-78c0,U+78c2-78c4,U+78c6-78c8,U+78cc-78cf,U+78d1-78d3,U+78d6-78d8,U+78da-78e7,U+78e9-78eb,U+78ed-78f1,U+78f3,U+78f5-78f6,U+78f8-78f9,U+78fb-7900,U+7902-7904,U+7906-790c"}},{uri:Yme,descriptors:{unicodeRange:"U+76af-76b0,U+76b3,U+76b5-76be,U+76c0-76c1,U+76c3-76c4,U+76c7,U+76c9,U+76cb-76cc,U+76d3,U+76d5,U+76d9-76da,U+76dc-76de,U+76e0-76e4,U+76e6-76ed,U+76f0,U+76f3,U+76f5-76f7,U+76fa-76fb,U+76fd,U+76ff-7703,U+7705-7706,U+770a,U+770c,U+770e-7718,U+771b-771e,U+7721,U+7723-7725,U+7727,U+772a-772c,U+772e,U+7730-7734,U+7739,U+773b,U+773d-773f,U+7742,U+7744-7746,U+7748-774f,U+7752-7759,U+775c-7760,U+7764,U+7767,U+7769-776a,U+776d-7778,U+777a-777c,U+7781-7783,U+7786-778b,U+778f-7790,U+7793-779e,U+77a1,U+77a3-77a4,U+77a6,U+77a8,U+77ab,U+77ad-77af,U+77b1-77b2,U+77b4,U+77b6-77ba,U+77bc,U+77be,U+77c0-77cc,U+77ce-77d6"}},{uri:Wme,descriptors:{unicodeRange:"U+7589-758a,U+758c-758e,U+7590,U+7593,U+7595,U+7598,U+759b-759c,U+759e,U+75a2,U+75a6-75aa,U+75ad,U+75b6-75b7,U+75ba-75bb,U+75bf-75c1,U+75c6,U+75cb-75cc,U+75ce-75d1,U+75d3,U+75d7,U+75d9-75da,U+75dc-75dd,U+75df-75e1,U+75e5,U+75e9,U+75ec-75ef,U+75f2-75f3,U+75f5-75f8,U+75fa-75fb,U+75fd-75fe,U+7602,U+7604,U+7606-7609,U+760b,U+760d-760f,U+7611-7614,U+7616,U+761a,U+761c-761e,U+7621,U+7623,U+7627-7628,U+762c,U+762e-762f,U+7631-7632,U+7636-7637,U+7639-763b,U+763d,U+7641-7642,U+7644-764b,U+764e-7653,U+7655,U+7657-765b,U+765d,U+765f-7662,U+7664-766a,U+766c-766e,U+7670-7677,U+7679-767a,U+767c,U+767f-7681,U+7683,U+7685,U+7689-768a,U+768c-768d,U+768f-7690,U+7692,U+7694-7695,U+7697-7698,U+769a-76a3,U+76a5-76ad"}},{uri:Kme,descriptors:{unicodeRange:"U+7492-749b,U+749d,U+749f-74a6,U+74aa-74b9,U+74bb-74d1,U+74d3-74db,U+74dd,U+74df,U+74e1,U+74e5,U+74e7-74ed,U+74f0-74f3,U+74f5,U+74f8-74fe,U+7500-7503,U+7505-750c,U+750e,U+7510,U+7512,U+7514-7517,U+751b,U+751d-751e,U+7520-7524,U+7526-7527,U+752a,U+752e,U+7534,U+7536,U+7539,U+753c-753d,U+753f,U+7541-7544,U+7546-7547,U+7549-754a,U+754d,U+7550-7553,U+7555-7558,U+755d-7564,U+7567-7569,U+756b-7571,U+7573,U+7575-7577,U+757a-757e,U+7580-7582,U+7584-7585,U+7587-7588"}},{uri:Zme,descriptors:{unicodeRange:"U+7372-737d,U+737f-7383,U+7385-7386,U+7388,U+738a,U+738c-738d,U+738f-7390,U+7392-7395,U+7397-739a,U+739c-739e,U+73a0-73a1,U+73a3-73a8,U+73aa,U+73ac-73ad,U+73b1,U+73b4-73b6,U+73b8-73b9,U+73bc-73bf,U+73c1,U+73c3-73c7,U+73cb-73cc,U+73ce,U+73d2-73d8,U+73da-73dd,U+73df,U+73e1-73e4,U+73e6,U+73e8,U+73ea-73ec,U+73ee-73f1,U+73f3-7402,U+7404,U+7407-7408,U+740b-740e,U+7411-7419,U+741c-7421,U+7423-7424,U+7427,U+7429,U+742b,U+742d,U+742f,U+7431-7432,U+7437-743b,U+743d-7440,U+7442-7454,U+7456,U+7458,U+745d,U+7460-746c,U+746e-746f,U+7471-7475,U+7478-747d,U+747f,U+7482,U+7484-7486,U+7488-748a,U+748c-748d,U+748f,U+7491"}},{uri:y0e,descriptors:{unicodeRange:"U+7054-705d,U+705f-706a,U+706e,U+7071-7074,U+7077,U+7079-707b,U+707d,U+7081-7084,U+7086-7088,U+708b-708d,U+708f-7091,U+7093,U+7097-7098,U+709a-709b,U+709e-70aa,U+70b0,U+70b2,U+70b4-70b6,U+70ba,U+70be-70bf,U+70c4-70c7,U+70c9,U+70cb-70d7,U+70da,U+70dc-70de,U+70e0-70e3,U+70e5,U+70ea,U+70ee,U+70f0-70f6,U+70f8,U+70fa-70fc,U+70fe-7108,U+710b-710f,U+7111-7112,U+7114,U+7117,U+711b-7125,U+7127-712e,U+7132-7135,U+7137-7144,U+7146-7149,U+714b,U+714d,U+714f-715b,U+715d,U+715f-7163,U+7165,U+7169-716d,U+716f-7171,U+7174-7177"}},{uri:qme,descriptors:{unicodeRange:"U+722e-722f,U+7232-7234,U+723a,U+723c,U+723e,U+7240-7246,U+7249-724b,U+724e-7251,U+7253-7255,U+7257-7258,U+725a,U+725c,U+725e,U+7260,U+7263-7265,U+7268,U+726a-726d,U+7270-7271,U+7273-7274,U+7276-7278,U+727b-727d,U+7282-7283,U+7285-7289,U+728c,U+728e,U+7290-7291,U+7293-729e,U+72a0-72ab,U+72ae,U+72b1-72b3,U+72b5,U+72ba-72c0,U+72c5-72c7,U+72c9-72cc,U+72cf,U+72d1,U+72d3-72d6,U+72d8,U+72da-72dd,U+72df,U+72e2-72e7,U+72ea-72eb,U+72f5-72f6,U+72f9,U+72fd-7300,U+7302,U+7304-7309,U+730b-730d,U+730f-7312,U+7314,U+7318-731a,U+731f-7320,U+7323-7324,U+7326-7328,U+732d,U+732f-7330,U+7332-7333,U+7335-7336,U+733a-733d,U+7340-734c,U+734e-734f,U+7351,U+7353-7356,U+7358-735f,U+7361-736b,U+736e,U+7370-7371"}},{uri:dme,descriptors:{unicodeRange:"U+6ec5-6ec6,U+6ec8-6eca,U+6ecc-6ece,U+6ed0,U+6ed2,U+6ed6,U+6ed8-6ed9,U+6edb-6edd,U+6ee3,U+6ee7,U+6eea-6ef3,U+6ef5-6ef8,U+6efa-6f01,U+6f03-6f05,U+6f07-6f08,U+6f0a-6f0e,U+6f10-6f12,U+6f16-6f1f,U+6f21-6f23,U+6f25-6f28,U+6f2c,U+6f2e,U+6f30,U+6f32,U+6f34-6f35,U+6f37-6f3d,U+6f3f-6f45,U+6f48-6f4a,U+6f4c,U+6f4e-6f57,U+6f59-6f5b,U+6f5d,U+6f5f-6f61,U+6f63-6f65,U+6f67-6f6c,U+6f6f-6f71,U+6f73,U+6f75-6f77,U+6f79,U+6f7b,U+6f7d-6f83,U+6f85-6f87,U+6f8a-6f8b,U+6f8f-6f9b,U+6f9d-6fa0,U+6fa2-6fa6,U+6fa8-6fb1"}},{uri:Qme,descriptors:{unicodeRange:"U+6d73,U+6d75-6d76,U+6d79-6d7b,U+6d7d-6d81,U+6d83-6d84,U+6d86-6d87,U+6d8a-6d8b,U+6d8d,U+6d8f-6d90,U+6d92,U+6d96-6d9a,U+6d9c,U+6da2,U+6da5,U+6dac-6dad,U+6db0-6db1,U+6db3-6db4,U+6db6-6db7,U+6db9-6dbe,U+6dc1-6dc3,U+6dc8-6dca,U+6dcd-6dd0,U+6dd2-6dd5,U+6dd7,U+6dda-6ddc,U+6ddf,U+6de2-6de3,U+6de5,U+6de7-6dea,U+6ded,U+6def-6df0,U+6df2,U+6df4-6df6,U+6df8,U+6dfa,U+6dfd-6e04,U+6e06-6e09,U+6e0b,U+6e0f,U+6e12-6e13,U+6e15,U+6e18-6e19,U+6e1b-6e1c,U+6e1e-6e1f,U+6e22,U+6e26-6e28,U+6e2a,U+6e2c,U+6e2e,U+6e30-6e31,U+6e33,U+6e35-6e37,U+6e39,U+6e3b-6e42,U+6e45-6e4c,U+6e4f-6e52,U+6e55,U+6e57,U+6e59-6e5a,U+6e5c-6e5e,U+6e60-6e6a,U+6e6c-6e6d,U+6e6f-6e7d,U+6e80-6e82,U+6e84,U+6e87-6e88,U+6e8a-6e8e,U+6e91-6e97,U+6e99-6e9b,U+6e9d-6e9e,U+6ea0-6ea1,U+6ea3-6ea4,U+6ea6,U+6ea8-6ea9,U+6eab-6eae,U+6eb0,U+6eb3,U+6eb5,U+6eb8-6eb9,U+6ebc,U+6ebe-6ec0,U+6ec3-6ec4"}},{uri:Jme,descriptors:{unicodeRange:"U+6bbb-6bbe,U+6bc0,U+6bc3-6bc4,U+6bc6-6bca,U+6bcc,U+6bce,U+6bd0-6bd1,U+6bd8,U+6bda,U+6bdc-6be0,U+6be2-6be9,U+6bec-6bee,U+6bf0-6bf2,U+6bf4,U+6bf6-6bf8,U+6bfa-6bfc,U+6bfe-6c04,U+6c08-6c0c,U+6c0e,U+6c12,U+6c17,U+6c1c-6c1e,U+6c20,U+6c23,U+6c25,U+6c2b-6c2d,U+6c31,U+6c33,U+6c36-6c37,U+6c39-6c3c,U+6c3e-6c3f,U+6c43-6c45,U+6c48,U+6c4b-6c4f,U+6c51-6c53,U+6c56,U+6c58-6c5a,U+6c62-6c63,U+6c65-6c67,U+6c6b-6c6f,U+6c71,U+6c73,U+6c75,U+6c77-6c78,U+6c7a-6c7c,U+6c7f-6c80,U+6c84,U+6c87,U+6c8a-6c8b,U+6c8d-6c8e,U+6c91-6c92,U+6c95-6c98,U+6c9a,U+6c9c-6c9e,U+6ca0,U+6ca2,U+6ca8,U+6cac,U+6caf-6cb0,U+6cb4-6cb7,U+6cba,U+6cc0-6cc3,U+6cc6-6cc8,U+6ccb,U+6ccd-6ccf,U+6cd1-6cd2,U+6cd8-6cda,U+6cdc-6cdd,U+6cdf,U+6ce4,U+6ce6-6ce7,U+6ce9,U+6cec-6ced,U+6cf2,U+6cf4,U+6cf9,U+6cff-6d00,U+6d02-6d03,U+6d05-6d06,U+6d08-6d0a,U+6d0d,U+6d0f-6d11,U+6d13-6d16,U+6d18,U+6d1c-6d1d,U+6d1f-6d24,U+6d26,U+6d28-6d29,U+6d2c-6d2d,U+6d2f-6d30,U+6d34,U+6d36-6d38,U+6d3a,U+6d3f-6d40,U+6d42,U+6d44,U+6d49,U+6d4c,U+6d50,U+6d55-6d58,U+6d5b,U+6d5d,U+6d5f,U+6d61-6d62,U+6d64-6d65,U+6d67-6d68,U+6d6b-6d6d,U+6d70-6d72"}},{uri:epe,descriptors:{unicodeRange:"U+6967-696a,U+696c-696d,U+696f-6970,U+6972-6976,U+697a-697b,U+697d-697f,U+6981,U+6983,U+6985,U+698a-698c,U+698e-6993,U+6996-6997,U+6999-699a,U+699d-69a6,U+69a9-69aa,U+69ac,U+69ae-69b0,U+69b2-69b3,U+69b5-69b6,U+69b8-69ba,U+69bc-69c0,U+69c2-69c9,U+69cb,U+69cd,U+69cf,U+69d1-69d3,U+69d5-69da,U+69dc-69de,U+69e1-69ec,U+69ee-69f1,U+69f3-69fc,U+69fe,U+6a00-6a09,U+6a0b-6a16,U+6a19-6a1e,U+6a20,U+6a22-6a27,U+6a29,U+6a2b-6a2e,U+6a30,U+6a32-6a34,U+6a36-6a3c,U+6a3f-6a43,U+6a45-6a46,U+6a48-6a4a"}},{uri:tpe,descriptors:{unicodeRange:"U+6830-6831,U+6834-6836,U+683a-683b,U+683f,U+6847,U+684b,U+684d,U+684f,U+6852,U+6856-685f,U+686a,U+686c-6873,U+6875,U+6878-6880,U+6882,U+6884,U+6887-688e,U+6890-6892,U+6894-6896,U+6898-68a1,U+68a3-68a5,U+68a9-68ac,U+68ae,U+68b1-68b2,U+68b4,U+68b6-68bf,U+68c1,U+68c3-68c8,U+68ca,U+68cc,U+68ce-68d1,U+68d3-68d4,U+68d6-68d7,U+68d9,U+68db-68df,U+68e1-68e2,U+68e4-68ed,U+68ef,U+68f2-68f4,U+68f6-68f8,U+68fb,U+68fd-6900,U+6902-6904,U+6906-690a,U+690c,U+690f,U+6911,U+6913-691e,U+6921-6923,U+6925-692c,U+692e-692f,U+6931-6933,U+6935-6938,U+693a-693c,U+693e,U+6940-6941,U+6943-6953,U+6955-6956,U+6958-6959,U+695b-695c,U+695f,U+6961-6962,U+6964-6965"}},{uri:npe,descriptors:{unicodeRange:"U+66b8,U+66ba-66bd,U+66bf-66d8,U+66da,U+66de-66e5,U+66e7-66e8,U+66ea-66ef,U+66f1,U+66f5-66f6,U+66f8,U+66fa-66fb,U+66fd,U+6701-6707,U+670c,U+670e-670f,U+6711-6713,U+6716,U+6718-671a,U+671c,U+671e,U+6720-6725,U+6727,U+6729,U+672e,U+6730,U+6732-6733,U+6736-6739,U+673b-673c,U+673e-673f,U+6741,U+6744-6745,U+6747,U+674a-674b,U+674d,U+6752,U+6754-6755,U+6757-675b,U+675d,U+6762-6764,U+6766-6767,U+676b-676c,U+676e,U+6771,U+6774,U+6776,U+6778-677b,U+677d,U+6780,U+6782-6783,U+6785-6786,U+6788,U+678a,U+678c-678f,U+6791-6794,U+6796,U+6799,U+679b,U+679f-67a1,U+67a4,U+67a6,U+67a9,U+67ac,U+67ae,U+67b1-67b2,U+67b4,U+67b9-67c0,U+67c2,U+67c5-67ce,U+67d5-67d7,U+67db,U+67df,U+67e1,U+67e3-67e4,U+67e6-67e8,U+67ea-67eb,U+67ed-67ee,U+67f2,U+67f5-67fc,U+67fe,U+6801-6804,U+6806,U+680d,U+6810,U+6812,U+6814-6815,U+6818-681c,U+681e-6820,U+6822-6828,U+682b-682f"}},{uri:ipe,descriptors:{unicodeRange:"U+6569-656a,U+656d-656f,U+6571,U+6573,U+6575-6576,U+6578-6586,U+6588-658a,U+658d-658f,U+6592,U+6594-6596,U+6598,U+659a,U+659d-659e,U+65a0,U+65a2-65a3,U+65a6,U+65a8,U+65aa,U+65ac,U+65ae,U+65b1-65b8,U+65ba-65bb,U+65be-65c0,U+65c2,U+65c7-65ca,U+65cd,U+65d0-65d1,U+65d3-65d5,U+65d8-65df,U+65e1,U+65e3-65e4,U+65ea-65eb,U+65f2-65f5,U+65f8-65f9,U+65fb-65ff,U+6601,U+6604-6605,U+6607-6609,U+660b,U+660d,U+6610-6612,U+6616-6618,U+661a-661c,U+661e,U+6621-6624,U+6626,U+6629-662c,U+662e,U+6630,U+6632-6633,U+6637-663b,U+663d,U+663f-6640,U+6642,U+6644-664a,U+664d-664e,U+6650-6651,U+6658-6659,U+665b-665e,U+6660,U+6662-6663,U+6665,U+6667,U+6669-666d,U+6671-6673,U+6675,U+6678-6679,U+667b-667d,U+667f-6681,U+6683,U+6685-6686,U+6688-668b,U+668d-6690,U+6692-6695,U+6698-669c,U+669e-66a6,U+66a9-66ad,U+66af-66b3,U+66b5-66b7"}},{uri:spe,descriptors:{unicodeRange:"U+5f30,U+5f32-5f38,U+5f3b,U+5f3d-5f3f,U+5f41-5f4f,U+5f51,U+5f54,U+5f59-5f5c,U+5f5e-5f60,U+5f63,U+5f65,U+5f67-5f68,U+5f6b,U+5f6e-5f6f,U+5f72,U+5f74-5f76,U+5f78,U+5f7a,U+5f7d-5f7f,U+5f83,U+5f86,U+5f8d-5f8f,U+5f91,U+5f93-5f94,U+5f96,U+5f9a-5f9b,U+5f9d-5fa0,U+5fa2-5fa7,U+5fa9,U+5fab-5fac,U+5faf-5fb4,U+5fb6,U+5fb8-5fbb,U+5fbe-5fc2,U+5fc7-5fc8,U+5fca-5fcb,U+5fce,U+5fd3-5fd5,U+5fda-5fdc,U+5fde-5fdf,U+5fe2-5fe3,U+5fe5-5fe6,U+5fe8-5fe9,U+5fec,U+5fef-5ff0,U+5ff2-5ff4,U+5ff6-5ff7,U+5ff9-5ffa,U+5ffc,U+6007-6009,U+600b-600c,U+6010-6011,U+6013,U+6017-6018,U+601a,U+601e-601f,U+6022-6024,U+602c-602e,U+6030-6034,U+6036-603a,U+603d-603e,U+6040,U+6044-604a,U+604c,U+604e-604f,U+6051,U+6053-6054,U+6056-6058,U+605b-605c,U+605e-6061,U+6065-6066,U+606e,U+6071-6072,U+6074-6075,U+6077,U+607e,U+6080-6082,U+6085-6088,U+608a-608b,U+608e-6091,U+6093,U+6095,U+6097-6099,U+609c,U+609e,U+60a1-60a2,U+60a4-60a5,U+60a7,U+60a9-60aa,U+60ae,U+60b0,U+60b3,U+60b5-60b7,U+60b9-60ba,U+60bd-60c4,U+60c7-60c9,U+60cc"}},{uri:rpe,descriptors:{unicodeRange:"U+635a-635d,U+6360,U+6364-6366,U+6368,U+636a-636c,U+636f-6370,U+6372-6375,U+6378-6379,U+637c-637f,U+6381,U+6383-6386,U+638b,U+638d,U+6391,U+6393-6395,U+6397,U+6399-639f,U+63a1,U+63a4,U+63a6,U+63ab,U+63af,U+63b1-63b2,U+63b5-63b6,U+63b9,U+63bb,U+63bd,U+63bf-63c3,U+63c5,U+63c7-63c8,U+63ca-63cc,U+63d1,U+63d3-63d5,U+63d7-63dd,U+63df,U+63e2,U+63e4-63e8,U+63eb-63ec,U+63ee-63f1,U+63f3,U+63f5,U+63f7,U+63f9-63fc,U+63fe,U+6403-6404,U+6406-640a,U+640d-640e,U+6411-6412,U+6415-641a,U+641d,U+641f,U+6422-6425,U+6427-6429,U+642b,U+642e-6433,U+6435-6439,U+643b-643c,U+643e,U+6440,U+6442-6443,U+6449,U+644b-6451,U+6453,U+6455-6457,U+6459-645d,U+645f-6466,U+6468,U+646a-646c,U+646e-6477,U+647b-6481,U+6483,U+6486,U+6488-648f"}},{uri:ope,descriptors:{unicodeRange:"U+61c5-61c7,U+61c9,U+61cc-61d0,U+61d3,U+61d5-61e5,U+61e7-61f4,U+61f6-61fe,U+6200-6205,U+6207,U+6209,U+6213-6214,U+6219,U+621c-621e,U+6220,U+6223,U+6226-6229,U+622b,U+622d,U+622f-6232,U+6235-6236,U+6238-623c,U+6242,U+6244-6246,U+624a,U+624f-6250,U+6255-6257,U+6259-625a,U+625c-6262,U+6264-6265,U+6268,U+6271-6272,U+6274-6275,U+6277-6278,U+627a-627b,U+627d,U+6281-6283,U+6285-6288,U+628b-6290,U+6294,U+6299,U+629c-629e,U+62a3,U+62a6-62a7,U+62a9-62aa,U+62ad-62b0,U+62b2-62b4,U+62b6-62b8,U+62ba,U+62be,U+62c0-62c1,U+62c3,U+62cb,U+62cf,U+62d1,U+62d5,U+62dd-62de,U+62e0-62e1,U+62e4,U+62ea-62eb,U+62f0,U+62f2,U+62f5,U+62f8-62fb,U+6300,U+6303-6306,U+630a-630d,U+630f-6310,U+6312-6315,U+6317-6319,U+631c,U+6326-6327,U+6329,U+632c-632e,U+6330-6331,U+6333-6338,U+633b-633c,U+633e-6341,U+6344,U+6347-6348,U+634a,U+6351-6354,U+6356-6359"}},{uri:ape,descriptors:{unicodeRange:"U+5dd0-5dda,U+5ddc,U+5ddf-5de0,U+5de3-5de4,U+5dea,U+5dec-5ded,U+5df0,U+5df5-5df6,U+5df8-5dfc,U+5dff-5e00,U+5e04,U+5e07,U+5e09-5e0b,U+5e0d-5e0e,U+5e12-5e13,U+5e17,U+5e1e-5e25,U+5e28-5e2c,U+5e2f-5e30,U+5e32-5e36,U+5e39-5e3a,U+5e3e-5e41,U+5e43,U+5e46-5e4b,U+5e4d-5e53,U+5e56-5e5a,U+5e5c-5e5d,U+5e5f-5e60,U+5e63-5e71,U+5e75,U+5e77,U+5e79,U+5e7e,U+5e81-5e83,U+5e85,U+5e88-5e89,U+5e8c-5e8e,U+5e92,U+5e98,U+5e9b,U+5e9d,U+5ea1-5ea4,U+5ea8-5eac,U+5eae-5eb2,U+5eb4,U+5eba-5ebd,U+5ebf-5ec8,U+5ecb-5ed0,U+5ed4-5ed5,U+5ed7-5eda,U+5edc-5ee7,U+5ee9,U+5eeb-5ef3,U+5ef5,U+5ef8-5ef9,U+5efb-5efd,U+5f05-5f07,U+5f09,U+5f0c-5f0e,U+5f10,U+5f12,U+5f14,U+5f16,U+5f19-5f1a,U+5f1c-5f1e,U+5f21-5f24,U+5f28,U+5f2b-5f2c,U+5f2e"}},{uri:lpe,descriptors:{unicodeRange:"U+60cd-60d0,U+60d2-60d4,U+60d6-60d7,U+60d9,U+60db,U+60de,U+60e1-60e5,U+60ea,U+60f1-60f2,U+60f5,U+60f7-60f8,U+60fb-60ff,U+6102-6105,U+6107,U+610a-610c,U+6110-6114,U+6116-6119,U+611b-611e,U+6121-6122,U+6125,U+6128-612a,U+612c-613e,U+6140-6147,U+6149,U+614b,U+614d,U+614f-6150,U+6152-6154,U+6156-615c,U+615e-6161,U+6163-6166,U+6169-616f,U+6171-6174,U+6176,U+6178-618a,U+618c-618d,U+618f-6193,U+6195-619c,U+619e-61a6,U+61aa-61ab,U+61ad-61b6,U+61b8-61bd,U+61bf-61c1,U+61c3-61c4"}},{uri:cpe,descriptors:{unicodeRange:"U+5cf4-5cfa,U+5cfc-5d01,U+5d04-5d05,U+5d08-5d0d,U+5d0f-5d13,U+5d15,U+5d17-5d1a,U+5d1c-5d1d,U+5d1f-5d23,U+5d25,U+5d28,U+5d2a-5d2c,U+5d2f-5d33,U+5d35-5d3c,U+5d3f-5d46,U+5d48-5d49,U+5d4d-5d57,U+5d59-5d5a,U+5d5c,U+5d5e-5d68,U+5d6a,U+5d6d-5d6e,U+5d70-5d73,U+5d75-5d81,U+5d83-5d98,U+5d9a-5d9c,U+5d9e-5db6,U+5db8-5dc4,U+5dc6-5dcc,U+5dce-5dcf"}},{uri:upe,descriptors:{unicodeRange:"U+5b52,U+5b56,U+5b5e,U+5b60-5b61,U+5b67-5b68,U+5b6b,U+5b6d-5b6f,U+5b72,U+5b74,U+5b76-5b79,U+5b7b-5b7c,U+5b7e-5b7f,U+5b82,U+5b86,U+5b8a,U+5b8d-5b8e,U+5b90-5b92,U+5b94,U+5b96,U+5b9f,U+5ba7-5ba9,U+5bac-5baf,U+5bb1-5bb2,U+5bb7,U+5bba-5bbc,U+5bc0-5bc1,U+5bc3,U+5bc8-5bcb,U+5bcd-5bcf,U+5bd1,U+5bd4-5bdc,U+5be0,U+5be2-5be3,U+5be6-5be7,U+5be9-5bed,U+5bef,U+5bf1-5bf7,U+5bfd-5bfe,U+5c00,U+5c02-5c03,U+5c05,U+5c07-5c08,U+5c0b-5c0e,U+5c10,U+5c12-5c13,U+5c17,U+5c19,U+5c1b,U+5c1e-5c21,U+5c23,U+5c26,U+5c28-5c2b,U+5c2d-5c30,U+5c32-5c33,U+5c35-5c37,U+5c43-5c44,U+5c46-5c47,U+5c4c-5c4d,U+5c52-5c54,U+5c56-5c58,U+5c5a-5c5d,U+5c5f,U+5c62,U+5c64,U+5c67-5c6d,U+5c70,U+5c72-5c78,U+5c7b-5c7e,U+5c80,U+5c83-5c87,U+5c89-5c8b,U+5c8e-5c8f,U+5c92-5c93,U+5c95,U+5c9d-5ca1,U+5ca4-5ca8,U+5caa,U+5cae-5cb0,U+5cb2,U+5cb4,U+5cb6,U+5cb9-5cbc,U+5cbe,U+5cc0,U+5cc2-5cc3,U+5cc5-5cca,U+5ccc-5cd1,U+5cd3-5cd8,U+5cda-5ce0,U+5ce2-5ce3,U+5ce7,U+5ce9,U+5ceb-5cec,U+5cee-5cef,U+5cf1-5cf3"}},{uri:dpe,descriptors:{unicodeRange:"U+593b,U+593d-5940,U+5943,U+5945-5946,U+594a,U+594c-594d,U+5950,U+5952-5953,U+5959,U+595b-595f,U+5961,U+5963-5964,U+5966-5972,U+5975,U+5977,U+597a-597c,U+597e-5980,U+5985,U+5989,U+598b-598c,U+598e-5991,U+5994-5995,U+5998,U+599a-599d,U+599f-59a2,U+59a6-59a7,U+59ac-59ad,U+59b0-59b1,U+59b3-59b8,U+59ba,U+59bc-59bd,U+59bf-59c5,U+59c7-59c9,U+59cc-59cf,U+59d5-59d6,U+59d9,U+59db,U+59de-59e2,U+59e4,U+59e6-59e7,U+59e9-59eb,U+59ed-59f8,U+59fa,U+59fc-59fe,U+5a00,U+5a02,U+5a0a-5a0b,U+5a0d-5a10,U+5a12,U+5a14-5a17,U+5a19-5a1b,U+5a1d-5a1e,U+5a21-5a22,U+5a24,U+5a26-5a28,U+5a2a-5a30,U+5a33,U+5a35,U+5a37-5a3b,U+5a3d-5a3f,U+5a41-5a45,U+5a47-5a48,U+5a4b-5a54,U+5a56-5a59,U+5a5b-5a61,U+5a63-5a66,U+5a68-5a69,U+5a6b-5a73,U+5a78-5a79,U+5a7b-5a7e,U+5a80-5a90"}},{uri:fpe,descriptors:{unicodeRange:"U+5a91,U+5a93-5a99,U+5a9c-5aa9,U+5aab-5ab1,U+5ab4,U+5ab6-5ab7,U+5ab9-5abd,U+5abf-5ac0,U+5ac3-5ac8,U+5aca-5acb,U+5acd-5ad1,U+5ad3,U+5ad5,U+5ad7,U+5ad9-5adb,U+5add-5adf,U+5ae2,U+5ae4-5ae5,U+5ae7-5ae8,U+5aea,U+5aec-5af0,U+5af2-5b08,U+5b0a-5b15,U+5b18-5b31,U+5b33,U+5b35-5b36,U+5b38-5b3f,U+5b41-5b4f"}},{uri:hpe,descriptors:{unicodeRange:"U+5843,U+5845-584b,U+584e-5850,U+5852-5853,U+5855-5857,U+5859-585d,U+585f-5864,U+5866-586a,U+586d-587d,U+587f,U+5882,U+5884,U+5886-5888,U+588a-5891,U+5894-5898,U+589b-589d,U+58a0-58a7,U+58aa-58bb,U+58bd-58c0,U+58c2-58c4,U+58c6-58d0,U+58d2-58d4,U+58d6-58e3,U+58e5-58ea,U+58ed,U+58ef,U+58f1-58f2,U+58f4-58f5,U+58f7-58f8,U+58fa-5901,U+5903,U+5905-5906,U+5908-590c,U+590e,U+5910-5913,U+5917-5918,U+591b,U+591d-591e,U+5920-5923,U+5926,U+5928,U+592c,U+5930,U+5932-5933,U+5935-5936"}},{uri:gpe,descriptors:{unicodeRange:"U+56d0-56d3,U+56d5-56d6,U+56d8-56d9,U+56dc,U+56e3,U+56e5-56ea,U+56ec,U+56ee-56ef,U+56f2-56f3,U+56f6-56f8,U+56fb-56fc,U+5700-5702,U+5705,U+5707,U+570b-571b,U+571d-571e,U+5720-5722,U+5724-5727,U+572b,U+5731-5732,U+5734-5738,U+573c-573d,U+573f,U+5741,U+5743-5746,U+5748-5749,U+574b,U+5752-5756,U+5758-5759,U+5762-5763,U+5765,U+5767,U+576c,U+576e,U+5770-5772,U+5774-5775,U+5778-577a,U+577d-5781,U+5787-578a,U+578d-5791,U+5794-579a,U+579c-579f,U+57a5,U+57a8,U+57aa,U+57ac,U+57af-57b1,U+57b3,U+57b5-57b7,U+57b9-57c1,U+57c4-57ca,U+57cc-57cd,U+57d0-57d1,U+57d3,U+57d6-57d7,U+57db-57dc,U+57de,U+57e1-57e3,U+57e5-57ec,U+57ee,U+57f0-57f3,U+57f5-57f7,U+57fb-57fc,U+57fe-57ff,U+5801,U+5803-5805,U+5808-580a,U+580c,U+580e-5810,U+5812-5814,U+5816-5818,U+581a-581d,U+581f,U+5822-5823,U+5825-5829,U+582b-582f,U+5831-5834,U+5836-5842"}},{uri:mpe,descriptors:{unicodeRange:"U+55f9-55fc,U+55ff,U+5602-5607,U+560a-560b,U+560d,U+5610-5617,U+5619-561a,U+561c-561d,U+5620-5622,U+5625-5626,U+5628-562b,U+562e-5630,U+5633,U+5635,U+5637-5638,U+563a,U+563c-563e,U+5640-564b,U+564f-5653,U+5655-5656,U+565a-565b,U+565d-5661,U+5663,U+5665-5667,U+566d-5670,U+5672-5675,U+5677-567a,U+567d-5684,U+5687-568d,U+5690-5692,U+5694-56a2,U+56a4-56ae,U+56b0-56b6,U+56b8-56bb,U+56bd-56c9,U+56cb-56cf"}},{uri:ppe,descriptors:{unicodeRange:"U+5286-5287,U+5289-528f,U+5291-5292,U+5294-529a,U+529c,U+52a4-52a7,U+52ae-52b0,U+52b4-52bd,U+52c0-52c2,U+52c4-52c6,U+52c8,U+52ca,U+52cc-52cf,U+52d1,U+52d3-52d5,U+52d7,U+52d9-52de,U+52e0-52e3,U+52e5-52ef,U+52f1-52f8,U+52fb-52fd,U+5301-5304,U+5307,U+5309-530c,U+530e,U+5311-5314,U+5318,U+531b-531c,U+531e-531f,U+5322,U+5324-5325,U+5327-5329,U+532b-532d,U+532f-5338,U+533c-533d,U+5340,U+5342,U+5344,U+5346,U+534b-534d,U+5350,U+5354,U+5358-5359,U+535b,U+535d,U+5365,U+5368,U+536a,U+536c-536d,U+5372,U+5376,U+5379,U+537b-537e,U+5380-5381,U+5383,U+5387-5388,U+538a,U+538e-5394,U+5396-5397,U+5399,U+539b-539c,U+539e,U+53a0-53a1,U+53a4,U+53a7,U+53aa-53ad,U+53af-53b5,U+53b7-53ba,U+53bc-53be,U+53c0,U+53c3-53c7,U+53ce-53d0,U+53d2-53d3,U+53d5,U+53da,U+53dc-53de,U+53e1-53e2,U+53e7,U+53f4,U+53fa,U+53fe-5400,U+5402,U+5405,U+5407,U+540b,U+5414,U+5418-541a,U+541c,U+5422,U+5424-5425,U+542a,U+5430,U+5433,U+5436-5437,U+543a"}},{uri:Upe,descriptors:{unicodeRange:"U+5101-5105,U+5108-510a,U+510c-5111,U+5113-5120,U+5122-513e,U+5142,U+5147,U+514a,U+514c,U+514e-5150,U+5152-5153,U+5157-5159,U+515b,U+515d-5161,U+5163-5164,U+5166-5167,U+5169-516a,U+516f,U+5172,U+517a,U+517e-517f,U+5183-5184,U+5186-5187,U+518a-518b,U+518e-5191,U+5193-5194,U+5198,U+519a,U+519d-519f,U+51a1,U+51a3,U+51a6-51aa,U+51ad-51ae,U+51b4,U+51b8-51ba,U+51be-51bf,U+51c1-51c3,U+51c5,U+51c8,U+51ca,U+51cd-51ce,U+51d0,U+51d2-51da,U+51dc,U+51de-51df,U+51e2-51e3,U+51e5-51ea,U+51ec,U+51ee,U+51f1-51f2,U+51f4,U+51f7,U+51fe,U+5204-5205,U+5209,U+520b-520c,U+520f-5210,U+5213-5215,U+521c,U+521e-521f,U+5221-5223,U+5225-5227,U+522a,U+522c,U+522f,U+5231-5232,U+5234-5235,U+523c,U+523e,U+5244-5249,U+524b,U+524e-524f,U+5252-5253,U+5255,U+5257-525b,U+525d,U+525f-5260,U+5262-5264,U+5266,U+5268,U+526b-526e,U+5270-5271,U+5273-527c,U+527e,U+5280,U+5283-5285"}},{uri:bpe,descriptors:{unicodeRange:"U+543d,U+543f,U+5441-5442,U+5444-5445,U+5447,U+5449,U+544c-544f,U+5451,U+545a,U+545d-5461,U+5463,U+5465,U+5467,U+5469-5470,U+5474,U+5479-547a,U+547e-547f,U+5481,U+5483,U+5485,U+5487-548a,U+548d,U+5491,U+5493,U+5497-5498,U+549c,U+549e-54a2,U+54a5,U+54ae,U+54b0,U+54b2,U+54b5-54b7,U+54b9-54ba,U+54bc,U+54be,U+54c3,U+54c5,U+54ca-54cb,U+54d6,U+54d8,U+54db,U+54e0-54e4,U+54eb-54ec,U+54ef-54f1,U+54f4-54f9,U+54fb,U+54fe,U+5500,U+5502-5505,U+5508,U+550a-550e,U+5512-5513,U+5515-551a,U+551c-551f,U+5521,U+5525-5526,U+5528-5529,U+552b,U+552d,U+5532,U+5534-5536,U+5538-553b,U+553d,U+5540,U+5542,U+5545,U+5547-5548,U+554b-554f,U+5551-5554,U+5557-555b,U+555d-5560,U+5562-5563,U+5568-5569,U+556b,U+556f-5574,U+5579-557a,U+557d,U+557f,U+5585-5586,U+558c-558e,U+5590,U+5592-5593,U+5595-5597,U+559a-559b,U+559e,U+55a0-55a6,U+55a8-55b0,U+55b2,U+55b4,U+55b6,U+55b8,U+55ba,U+55bc,U+55bf-55c3,U+55c6-55c8,U+55ca-55cb,U+55ce-55d0,U+55d5,U+55d7-55db,U+55de,U+55e0,U+55e2,U+55e7,U+55e9,U+55ed-55ee,U+55f0-55f1,U+55f4,U+55f6,U+55f8"}},{uri:ype,descriptors:{unicodeRange:"U+4fe0,U+4fe2,U+4fe4-4fe5,U+4fe7,U+4feb-4fec,U+4ff0,U+4ff2,U+4ff4-4ff7,U+4ff9,U+4ffb-4ffd,U+4fff-500b,U+500e,U+5010-5011,U+5013,U+5015-5017,U+501b,U+501d-501e,U+5020,U+5022-5024,U+5027,U+502b,U+502f-5039,U+503b,U+503d,U+503f-5042,U+5044-5046,U+5049-504b,U+504d,U+5050-5054,U+5056-5059,U+505b,U+505d-5064,U+5066-506b,U+506d-5075,U+5078-507a,U+507c-507d,U+5081-5084,U+5086-5087,U+5089-508c,U+508e-50a2,U+50a4,U+50a6,U+50aa-50ab,U+50ad-50b1,U+50b3-50b9,U+50bc-50ce,U+50d0-50d5,U+50d7-50d9,U+50db-50e5,U+50e8-50eb,U+50ef-50f2,U+50f4,U+50f6-50fa,U+50fc-5100"}},{uri:ume,descriptors:{unicodeRange:"U+49d5-4a77"}},{uri:Epe,descriptors:{unicodeRange:"U+4dac-4dad,U+4daf-4db5,U+4e02,U+4e04-4e06,U+4e0f,U+4e12,U+4e17,U+4e1f-4e21,U+4e23,U+4e26,U+4e29,U+4e2e-4e2f,U+4e31,U+4e33,U+4e35,U+4e37,U+4e3c,U+4e40-4e42,U+4e44,U+4e46,U+4e4a,U+4e51,U+4e55,U+4e57,U+4e5a-4e5b,U+4e62-4e65,U+4e67-4e68,U+4e6a-4e6f,U+4e72,U+4e74-4e7d,U+4e7f-4e85,U+4e87,U+4e8a,U+4e90,U+4e96-4e97,U+4e99,U+4e9c-4e9e,U+4ea3,U+4eaa,U+4eaf-4eb1,U+4eb4,U+4eb6-4eb9,U+4ebc-4ebe,U+4ec8,U+4ecc,U+4ecf-4ed0,U+4ed2,U+4eda-4edc,U+4ee0,U+4ee2,U+4ee6-4ee7,U+4ee9,U+4eed-4eef,U+4ef1,U+4ef4,U+4ef8-4efa,U+4efc,U+4efe,U+4f00,U+4f02-4f08,U+4f0b-4f0c,U+4f12-4f16,U+4f1c-4f1d,U+4f21,U+4f23,U+4f28-4f29,U+4f2c-4f2e,U+4f31,U+4f33,U+4f35,U+4f37,U+4f39,U+4f3b,U+4f3e-4f42,U+4f44-4f45,U+4f47-4f4c,U+4f52,U+4f54,U+4f56,U+4f61-4f62,U+4f66,U+4f68,U+4f6a-4f6b,U+4f6d-4f6e,U+4f71-4f72,U+4f75,U+4f77-4f7a,U+4f7d,U+4f80-4f82,U+4f85-4f87,U+4f8a,U+4f8c,U+4f8e,U+4f90,U+4f92-4f93,U+4f95-4f96,U+4f98-4f9a,U+4f9c,U+4f9e-4f9f,U+4fa1-4fa2,U+4fa4,U+4fab,U+4fad,U+4fb0-4fb4,U+4fb6-4fbe,U+4fc0-4fc2,U+4fc6-4fc9,U+4fcb-4fcd,U+4fd2-4fd6,U+4fd9,U+4fdb"}},{uri:vpe,descriptors:{unicodeRange:"U+4933-49d4"}},{uri:wpe,descriptors:{unicodeRange:"U+487a-4932"}},{uri:_pe,descriptors:{unicodeRange:"U+47d2-4879,U+2ce7c,U+2ce88,U+2ce93"}},{uri:Tpe,descriptors:{unicodeRange:"U+4756-47d1,U+2ca02,U+2ca0e,U+2ca7d,U+2caa9,U+2cb29,U+2cb2e,U+2cb31,U+2cb38-2cb39,U+2cb3f,U+2cb41,U+2cb4e,U+2cb5a,U+2cb64,U+2cb69,U+2cb6c,U+2cb6f,U+2cb76,U+2cb78,U+2cb7c,U+2cbb1,U+2cbbf-2cbc0,U+2cbce,U+2cc5f,U+2ccf5-2ccf6,U+2ccfd,U+2ccff,U+2cd02-2cd03,U+2cd0a,U+2cd8b,U+2cd8d,U+2cd8f-2cd90,U+2cd9f-2cda0,U+2cda8,U+2cdad-2cdae,U+2cdd5,U+2ce18,U+2ce1a,U+2ce23,U+2ce26,U+2ce2a"}},{uri:Ipe,descriptors:{unicodeRange:"U+46c3-4755,U+2c488,U+2c494,U+2c497,U+2c542,U+2c613,U+2c618,U+2c621,U+2c629,U+2c62b-2c62d,U+2c62f,U+2c642,U+2c64a-2c64b,U+2c72c,U+2c72f,U+2c79f,U+2c7c1,U+2c7fd,U+2c8d9,U+2c8de,U+2c8e1,U+2c8f3,U+2c907,U+2c90a,U+2c91d"}},{uri:Spe,descriptors:{unicodeRange:"U+4629-46c2,U+2bdf7,U+2be29,U+2c029-2c02a,U+2c0a9,U+2c0ca,U+2c1d5,U+2c1d9,U+2c1f9,U+2c27c,U+2c288,U+2c2a4,U+2c317,U+2c35b,U+2c361,U+2c364"}},{uri:xpe,descriptors:{unicodeRange:"U+458e-4628,U+2b7a9,U+2b7c5,U+2b7e6,U+2b7f9,U+2b806,U+2b80a,U+2b81c,U+2b8b8,U+2bac7,U+2bb5f,U+2bb62,U+2bb7c,U+2bb83,U+2bc1b,U+2bd77,U+2bd87"}},{uri:Cpe,descriptors:{unicodeRange:"U+4449-4511,U+2afa2,U+2b127-2b128,U+2b137-2b138,U+2b1ed"}},{uri:Ape,descriptors:{unicodeRange:"U+439b-4448,U+2a437,U+2a5f1,U+2a602,U+2a61a,U+2a6b2,U+2a7dd,U+2a8fb,U+2a917,U+2aa30,U+2aa36,U+2aa58"}},{uri:Mpe,descriptors:{unicodeRange:"U+4275-430d,U+298c6,U+29a72,U+29d98,U+29ddb,U+29e15,U+29e3d,U+29e49"}},{uri:kpe,descriptors:{unicodeRange:"U+4132-41de,U+28bef,U+28c47,U+28c4f,U+28c51,U+28c54,U+28d10,U+28d71,U+28dfb,U+28e1f,U+28e36,U+28e89,U+28e99,U+28eeb,U+28f32,U+28ff8,U+292a0"}},{uri:Rpe,descriptors:{unicodeRange:"U+41df-4274,U+292b1,U+29490,U+295cf,U+2967f,U+296f0,U+29719,U+29750"}},{uri:Dpe,descriptors:{unicodeRange:"U+408e-4131,U+285c8-285c9,U+28678,U+28695,U+286d7,U+286fa,U+287e0,U+28946,U+28949,U+2896b,U+28987-28988,U+289ba-289bb,U+28a1e,U+28a29,U+28a43,U+28a71,U+28a99,U+28acd,U+28add,U+28ae4,U+28b49,U+28bc1"}},{uri:Lpe,descriptors:{unicodeRange:"U+3e83-3f2f,U+27139,U+273da-273db,U+273fe,U+27410,U+27449,U+27614-27615,U+27631,U+27684,U+27693,U+2770e,U+27723,U+27752"}},{uri:Npe,descriptors:{unicodeRange:"U+3f30-3fdb,U+27985,U+27a84,U+27bb3,U+27bbe,U+27bc7,U+27cb8,U+27da0,U+27e10"}},{uri:Ope,descriptors:{unicodeRange:"U+3fdc-408d,U+27fb7,U+27ff9,U+2808a,U+280bb,U+2815d,U+28277,U+28282,U+282e2,U+282f3,U+283cd,U+28408,U+2840c,U+28455,U+28468,U+2856b"}},{uri:Ppe,descriptors:{unicodeRange:"U+3dd2-3e82,U+26a58,U+26a8c,U+26ab7,U+26aff,U+26b5c,U+26c21,U+26c29,U+26c73,U+26cdd,U+26e40,U+26e65,U+26f94,U+26ff6-26ff8,U+270f4,U+2710d"}},{uri:Fpe,descriptors:{unicodeRange:"U+3d34-3dd1,U+2648d,U+26676,U+2667e,U+266b0,U+2671d,U+2677c,U+267cc,U+268dd,U+268ea,U+26951,U+2696f,U+269dd,U+269fa,U+26a1e"}},{uri:Bpe,descriptors:{unicodeRange:"U+3c76-3d33,U+25d0a,U+25da1,U+25e2e,U+25e56,U+25e62,U+25e65,U+25ec2,U+25ed7-25ed8,U+25ee8,U+25f23,U+25f5c,U+25fd4,U+25fe0,U+25ffb,U+2600c,U+26017,U+26060,U+260ed,U+26221,U+26270,U+26286,U+2634c,U+26402"}},{uri:zpe,descriptors:{unicodeRange:"U+3bda-3c75,U+25771,U+257a9,U+257b4,U+259c4,U+259d4,U+25ae3-25ae4,U+25af1,U+25bb2,U+25c14,U+25c4b,U+25c64"}},{uri:Hpe,descriptors:{unicodeRange:"U+3b25-3bd9,U+2504a,U+25055,U+25122,U+2512b,U+251a9,U+251cd,U+251e5,U+2521e,U+2524c,U+2542e,U+2548e,U+254d9,U+2550e,U+25532,U+25562,U+255a7-255a8"}},{uri:Vpe,descriptors:{unicodeRange:"U+3a6b-3b24,U+24896,U+249db,U+24a4d,U+24a7d,U+24ac9,U+24b56,U+24b6f,U+24c16,U+24d14,U+24dea,U+24e0e,U+24e37,U+24e6a,U+24e8b,U+24eaa"}},{uri:$pe,descriptors:{unicodeRange:"U+39a9-3a6a,U+24096,U+24103,U+241ac,U+241c6,U+241fe,U+243bc,U+243f8,U+244d3,U+24629,U+246a5,U+247f1"}},{uri:Gpe,descriptors:{unicodeRange:"U+38e3-39a8,U+23a98,U+23c7f,U+23c97-23c98,U+23cfe,U+23d00,U+23d0e,U+23d40,U+23dd3,U+23df9-23dfa,U+23e23,U+23f7e"}},{uri:Xpe,descriptors:{unicodeRange:"U+3760-382a,U+22ab8,U+22b43,U+22b46,U+22b4f-22b50,U+22ba6,U+22bca,U+22c1d,U+22c24,U+22c55,U+22d4c,U+22de1"}},{uri:jpe,descriptors:{unicodeRange:"U+382b-38e2,U+231b6,U+231c3-231c4,U+231f5,U+23350,U+23372,U+233d0,U+233d2-233d3,U+233d5,U+233da,U+233df,U+233e4,U+2344a-2344b,U+23451,U+23465,U+234e4,U+2355a,U+23594,U+235c4,U+235cb,U+23638-2363a,U+23647,U+2370c,U+2371c,U+2373f,U+23763-23764,U+237e7,U+237ff,U+23824,U+2383d"}},{uri:Ype,descriptors:{unicodeRange:"U+3698-375f,U+22218,U+2231e,U+223ad,U+224dc,U+226f3,U+2285b,U+228ab,U+2298f"}},{uri:Wpe,descriptors:{unicodeRange:"U+35e6-3697,U+21c56,U+21cde,U+21d2d,U+21d45,U+21d62,U+21d78,U+21d92,U+21d9c,U+21da1,U+21db7,U+21de0,U+21e33-21e34,U+21f1e,U+21f76,U+21ffa,U+2217b"}},{uri:Kpe,descriptors:{unicodeRange:"U+3444-350e,U+20ad3,U+20b1d,U+20b9f,U+20c41,U+20cbf,U+20cd0,U+20d45,U+20de1,U+20e64,U+20e6d,U+20e95,U+20e9d,U+20ea2,U+20f5f,U+210c1,U+21201,U+2123d,U+21255,U+21274,U+2127b"}},{uri:Zpe,descriptors:{unicodeRange:"U+350f-35e5,U+212d7,U+212e4,U+212fd,U+2131b,U+21336,U+21344,U+2139a,U+213c4,U+21413,U+2146d-2146e,U+215d7,U+21647,U+216b4,U+21706,U+21742,U+218bd,U+219c3"}},{uri:qpe,descriptors:{unicodeRange:"U+336d-3443,U+2032b,U+20371,U+20381,U+203f9,U+2044a,U+20509,U+20547,U+205d6,U+20628,U+20676,U+2074f,U+20779,U+20807,U+2083a,U+20895,U+208b9,U+2097c,U+2099d"}},{uri:Qpe,descriptors:{unicodeRange:"U+328b-336c,U+2000b,U+20089,U+200a2,U+200a4,U+20164,U+201a2,U+20213"}},{uri:Jpe,descriptors:{unicodeRange:"U+3192-31ba,U+31c0-31e3,U+31f0-321e,U+3220-328a,U+1f250-1f251"}},{uri:eUe,descriptors:{unicodeRange:"U+2f74-2fd5,U+3000,U+3003-3007,U+3012-3013,U+3018-301c,U+3020-3029,U+302f-303f,U+3041-3096,U+3099-30a1"}},{uri:tUe,descriptors:{unicodeRange:"U+30a2-30ff,U+3105-312f,U+3131-318e,U+3190-3191"}},{uri:nUe,descriptors:{unicodeRange:"U+4e36,U+4ea0,U+4f74,U+4f91,U+4f94,U+4fc5,U+507e,U+50ed,U+5182,U+51f5,U+525e,U+5282,U+52f9,U+5326,U+537a,U+53a3,U+5423,U+5459,U+54b4,U+54d9,U+55c9,U+57f4,U+580b,U+5902,U+5925,U+5a08,U+5ab5,U+5b84,U+5be4,U+5c22,U+5cb5,U+5cbd,U+5d3e,U+5e31,U+5e5e,U+5e80,U+5ee8,U+5f82,U+5fc9,U+5fed,U+600a,U+605d,U+609b,U+609d,U+60dd,U+6243,U+6322,U+63ce,U+640c,U+643f,U+6445,U+64d7,U+6534,U+6549,U+656b,U+6603,U+674c,U+680a,U+6864,U+69d4,U+6a65,U+6c2a,U+6c46,U+6c5c,U+6d0e,U+6d48,U+6e2b,U+6eb2,U+6eb7,U+6f89,U+706c,U+70b1,U+7113,U+71d4,U+727f,U+72f3,U+7303,U+7321,U+736c,U+736f,U+74a9,U+74de,U+750d,U+7513,U+7592,U+75c4,U+7605,U+760a,U+761b,U+7625,U+762d,U+7643,U+7707,U+7747,U+77b5,U+7839,U+784e,U+78a5,U+7924,U+793b,U+798a,U+7a03,U+7a06,U+7a78,U+7a80,U+7aad,U+7ba8,U+7be5,U+7cc8,U+7ec1,U+7f0b,U+7f0f,U+7f12,U+7f68,U+7f9d,U+8025,U+809c,U+80ad,U+80b7,U+80e8,U+811e,U+8204,U+8223,U+822d,U+823b,U+824b,U+825a,U+827d,U+827f,U+828f,U+82c8,U+8307,U+831b,U+8347,U+837d,U+839b,U+83a9,U+83f9,U+84b9,U+8579,U+864d,U+867f,U+86b0,U+86d1,U+86d8,U+86f2,U+8764,U+8770,U+8788,U+8797,U+87ac-87ad,U+87b5,U+881b,U+8844,U+88bc,U+88fc,U+8930,U+89cf,U+89d6,U+8ba0,U+8bd4,U+8c02,U+8c2b,U+8c85,U+8e23,U+8f81-8f82,U+8fd5,U+90b6,U+90db,U+914e,U+9164,U+91ad,U+943e,U+94b7-94b8,U+94eb,U+950d,U+9514,U+9516,U+9518,U+9529,U+9538,U+953f,U+954e,U+955f,U+95fc,U+9667,U+96b3,U+9792,U+97b2,U+98a1,U+9969,U+9987,U+9998,U+9a80,U+9a92,U+9a96,U+9adf,U+9cb4,U+9cbd,U+9cd0,U+9cd4,U+9e31,U+9e3a,U+9e71,U+9ee5,U+9eea,U+9ef9,U+9fa0"}},{uri:iUe,descriptors:{unicodeRange:"U+4e0c,U+4e28,U+4e3f,U+4ec2,U+502e,U+50ba,U+5155,U+5181,U+522d,U+5281,U+5290,U+5369,U+53b6,U+54d5,U+54dc,U+54ff,U+552a,U+553c,U+5588,U+55b5,U+5686,U+570a,U+5776,U+5786,U+57a4,U+5820,U+5865,U+58bc,U+5b32,U+5b65,U+5c1c,U+5c66,U+5c6e,U+5c8d,U+5ddb,U+5f2a,U+5f50,U+5f61,U+6067,U+614a,U+615d,U+619d,U+61d4,U+620b,U+6224-6225,U+6343,U+63ad,U+63f2,U+640b,U+6420,U+6434,U+6496,U+64d0,U+6509,U+652e,U+67a8,U+6833,U+6844,U+684a,U+6920,U+6957,U+6971,U+6a8e,U+6a91,U+6aa0,U+6b43,U+6bea,U+6bf5,U+6c15,U+6cd0,U+6ee0,U+6f24,U+6f2d,U+70c0,U+721d,U+728b,U+72c3,U+72e8,U+730a,U+7338-7339,U+734d,U+746d,U+752f,U+754e,U+770d,U+7735,U+778d,U+77a2,U+77e7,U+7857,U+786d,U+78c9,U+78f2,U+791e,U+7953,U+7b58,U+7b9d,U+7bda,U+7cd7,U+7f32-7f33,U+8022,U+8028-8029,U+8035,U+804d,U+8080,U+80c2,U+80e9,U+80ec,U+80f2,U+810e,U+8221,U+8274,U+82b0,U+82e0,U+83b0,U+8487-8488,U+848e,U+84cd,U+84d0,U+8539,U+857a,U+85a8,U+85b7,U+867c,U+871e,U+8723,U+877e,U+878b,U+8793,U+8803,U+88d2,U+8966,U+89cc,U+89eb,U+8b26,U+8c8a,U+8c98,U+8d33,U+8d47,U+8d55,U+8dbc,U+8e40,U+8e94,U+8f77,U+8f79,U+9058,U+91a2,U+91b5,U+928e,U+9494,U+94b6,U+94de,U+94f4,U+94f9,U+950a,U+950e,U+951e,U+952b,U+953c,U+953e,U+9544,U+9561,U+9564,U+9569,U+95f6,U+9603,U+960d,U+963d,U+9674,U+9794,U+97ab,U+98a5,U+9a9f,U+9ab1,U+9ad1,U+9b0f,U+9b2f,U+9c92,U+9c95,U+9cba,U+9cbc,U+9cc6,U+9ccb,U+9cd8,U+9e32,U+9e38,U+9e5b,U+9e7e,U+9eb4,U+9efb-9efc,U+9f3d"}},{uri:sUe,descriptors:{unicodeRange:"U+2e3b,U+2e80-2e99,U+2e9b-2ef3,U+2f00-2f73,U+ffffd"}},{uri:rUe,descriptors:{unicodeRange:"U+4e69,U+4f1b,U+4f67,U+4f7e,U+4fdc,U+50e6,U+5196,U+5202,U+5233,U+523f,U+52a2,U+536e,U+5476,U+54ad,U+54cf,U+5537,U+561e,U+56dd,U+56df,U+5709,U+572c,U+57cf,U+57f8,U+580d,U+5881,U+589a,U+5941,U+59b2,U+5c25,U+5d24,U+5d74,U+5e42,U+5e8b,U+5eb3,U+5ed2,U+5fad,U+6003,U+603c,U+6083,U+6100,U+6126,U+6206,U+62ca,U+638e,U+63b4,U+6426,U+646d,U+6535,U+65c4,U+66db,U+6715,U+6769,U+6798,U+67c3,U+6861,U+698d,U+69ca,U+69ed,U+69f2,U+69ff,U+6a18,U+6b39,U+6bb3,U+6c0d,U+6cb2,U+6cd6,U+6cf7,U+6cfa,U+6d33,U+6e16,U+6e53-6e54,U+6ebb,U+6fb6,U+709d,U+72ad,U+72f7,U+72fb,U+7313,U+739f,U+74ba,U+754b,U+755b,U+758b,U+75ac,U+75d6,U+7617,U+7635,U+7640,U+76a4,U+76b2,U+775a,U+77bd,U+781f,U+79b3,U+7b2b,U+7b31,U+7b3e,U+7b6e,U+7b9c,U+7c0b,U+7c9e,U+7cc1,U+7ce8,U+7ea5,U+7f21,U+7f27,U+7f74,U+7fb0,U+8031,U+8071,U+80ea,U+8114,U+8160,U+81a6,U+81c1,U+829f,U+82a4,U+82fb,U+831a,U+8333,U+836c,U+83b6,U+83f8,U+8411,U+841c,U+8489,U+848c,U+85a4,U+8627,U+8629,U+866e,U+86b5,U+872e,U+8731,U+877b,U+877d,U+87ea,U+8813,U+8816,U+8864,U+88ce,U+88e5,U+897b,U+89cb,U+89f3,U+8bfc,U+8c35,U+8d46,U+8d4d,U+8dba,U+8e3a,U+8f75,U+8f7e,U+8fd3,U+9161,U+9179,U+917e,U+91a3,U+94ac,U+94d7,U+94e5,U+952a,U+952c,U+9545,U+9565,U+9568,U+956a,U+961d,U+96e0,U+972a,U+9730,U+989f,U+98e7,U+990d,U+9967,U+9993,U+9aa3,U+9ac0,U+9ae1,U+9aeb,U+9af9,U+9c86,U+9c8b,U+9ca0-9ca1,U+9ca3,U+9ce2,U+9e48,U+9e6a,U+9e87,U+9ee2,U+9ee9,U+9f17,U+9f19,U+9f2c,U+9f80"}},{uri:oUe,descriptors:{unicodeRange:"U+4ef3,U+50d6,U+50ec,U+51ab,U+51b1,U+52d6,U+54a9,U+54da,U+55be,U+55cd,U+564d,U+572f,U+574c,U+576b,U+57d8,U+57fd,U+5844,U+59d2,U+5ae0,U+5b16,U+5b37,U+5b5b,U+5b80,U+5d1e,U+5d6b,U+5efe,U+5f11,U+5f56,U+5f58,U+5f73,U+5f8c,U+5fc4,U+5fe4,U+602b,U+6106,U+610d,U+63de,U+63f8,U+641b,U+64e4,U+6634,U+676a,U+67b5,U+681d,U+6883,U+69b1,U+69e0,U+6b37,U+6b9b,U+6d7c,U+6ed7,U+6f36,U+6f72,U+6f8c,U+7035,U+7039,U+7173,U+7178,U+7228,U+728f,U+72b4,U+72ef,U+72f4,U+7331,U+7481,U+74e0,U+7540,U+75c3,U+75e6,U+763c,U+764d,U+76cd,U+7704,U+7743,U+7780,U+7847,U+786a,U+78b9,U+7962,U+7a02,U+7aac,U+7ab3,U+7b0a,U+7b4c,U+7b7b,U+7bfc,U+7c0f,U+7c16,U+7c40,U+7ca2,U+7cc7,U+7cf8,U+7d77,U+7e3b,U+7ea1,U+7ea9,U+7ef2,U+7f02,U+7f07,U+7f0c,U+7f23,U+7f2f,U+7fbc,U+8016,U+8020,U+812c,U+8136,U+8182,U+822f,U+8233,U+825f,U+8268,U+8284,U+8288,U+8291,U+8308,U+8311,U+835b,U+836d,U+83dd,U+8406,U+840f,U+845c,U+84b4,U+84e3,U+850c,U+855e,U+863c,U+86ba,U+86c4,U+86de,U+86f1,U+873e,U+87bd,U+87db,U+880a,U+883c,U+887f,U+88f0,U+890a,U+892b,U+895e,U+89ef,U+8a48,U+8bdc,U+8c18,U+8c33,U+8c94,U+8db1,U+8dcf,U+8dd6,U+8de3,U+8e6f,U+8e90,U+8f7a,U+8fb6,U+902d,U+90be,U+91af,U+936a,U+948b,U+94d8,U+9513,U+953a,U+956c,U+963c,U+9654,U+966c,U+9688,U+97b4,U+996b,U+9a75,U+9a7a,U+9aba,U+9aed,U+9b08,U+9b43,U+9c8e,U+9c94,U+9c9a,U+9e2b,U+9e36,U+9e4b,U+9e4e,U+9e55,U+9e63,U+9e68-9e69,U+9ebd,U+9ec9,U+9f0d,U+9f37,U+9f51"}},{uri:aUe,descriptors:{unicodeRange:"U+50a7,U+5240,U+5261,U+52ac,U+531a,U+5363,U+5432,U+5452,U+5456,U+5472,U+5478,U+553f,U+5575,U+5581,U+55cc,U+55fe,U+5601,U+572e,U+57d2,U+57ef,U+581e,U+5924,U+5981,U+5997,U+59a3,U+5aaa,U+5ab8,U+5b34,U+5d5d,U+5def,U+5e11,U+5e91,U+5ed1,U+5ef4,U+5f40,U+600d,U+6019,U+601b,U+605a,U+6092,U+60ab,U+6217,U+623d,U+6369,U+65d2,U+6661,U+670a,U+6753,U+67a7,U+6855,U+68f9,U+6939,U+696e,U+6980,U+6a7c,U+6aab,U+6b82,U+6bf3,U+6bf9,U+6c05,U+6c19-6c1a,U+6ca9,U+6cf6,U+6d1a,U+6dab,U+6f74,U+7085,U+7198,U+71b5,U+7256,U+725d,U+727e,U+72fa,U+7322,U+738e,U+73e5,U+750f,U+755a,U+7594,U+75b3,U+760c,U+7615,U+7630,U+763f,U+77ec,U+7817,U+78a1,U+78d9,U+7905,U+7b2a,U+7b2e,U+7b62,U+7b85,U+7bcc,U+7bea,U+7c26,U+7c74,U+7c9c-7c9d,U+7e47,U+7e9b,U+7e9f,U+7ee0,U+7ee8,U+7ef1,U+7f01,U+7f11,U+7f17,U+7f36,U+7f7e,U+7fee,U+802a,U+80cd,U+8112,U+8169,U+8234,U+8279,U+8298,U+82ca,U+82d8,U+82e1,U+83c0,U+83d4,U+83df,U+8401,U+8451,U+845a,U+8476,U+8478,U+84ba,U+84bd,U+84e0,U+851f,U+8548,U+8556,U+8585,U+868d,U+86e9,U+86f4,U+86f8,U+8765,U+8785,U+87ab,U+87ee,U+8832,U+8872,U+88b7,U+88e2-88e3,U+89da,U+8bce,U+8bd3,U+8bd6,U+8bf9,U+8c16,U+8c73,U+8d5c,U+8dde,U+8f6d,U+8f94,U+8fe8,U+9011,U+915e,U+9185,U+918c,U+94ab,U+94d1,U+94f3,U+9515,U+951d,U+9558,U+9567,U+96ce,U+96e9,U+9785,U+9878,U+987c,U+9883,U+98d1,U+9954,U+9963,U+9a93,U+9ac1,U+9acc,U+9b1f,U+9b49,U+9b4d,U+9b51,U+9ca7,U+9cae,U+9cce,U+9cd3,U+9e37,U+9e39,U+9e41,U+9e46,U+9f22,U+9f2f,U+9f39,U+9f85"}},{uri:lUe,descriptors:{unicodeRange:"U+4e5c,U+4edf,U+4f25,U+4f32,U+4f5e,U+4f76,U+4faa,U+4fe6,U+5028,U+5048,U+5250,U+535f,U+538d,U+53c1,U+5412,U+5443,U+54d4,U+54dd,U+5541,U+5550,U+5577,U+55dd,U+55f3,U+560f,U+562c,U+5657-5658,U+5664,U+56af,U+575c,U+577c,U+57b2,U+57da,U+5800,U+5a62,U+5aeb,U+5c3b,U+5ca3,U+5d26,U+5d9d,U+5f01,U+5fb5,U+5fdd,U+5ff8,U+6029,U+6041,U+6079,U+60b1,U+6222,U+629f,U+6332,U+63bc,U+63e0,U+6485,U+65ab,U+65c3,U+65c6,U+668c,U+669d,U+66be,U+67fd,U+6800,U+68fc,U+690b,U+6924,U+6978,U+69a7,U+6a3e,U+6a50,U+6a5b,U+6a97,U+6b24,U+6b8d,U+6baa,U+6c10,U+6c54,U+6ceb,U+6d04,U+6d4d,U+6eb1,U+6ebd,U+7110,U+71b3,U+71f9,U+7230,U+728d,U+7292,U+72b8,U+72d2,U+7360,U+73a2,U+7511,U+75a0,U+75c8,U+779f,U+7826,U+7877,U+7a39,U+7aa8,U+7ae6,U+7b04,U+7b0f,U+7baa,U+7bac,U+7c1f,U+7ccd,U+7ecb,U+7ed4,U+7ed7,U+7efb,U+7f0d,U+7f5f,U+7faf,U+7fd5,U+7fe5,U+8027,U+80bc,U+80dd,U+80fc,U+8132,U+815a,U+8167,U+816d,U+81ca,U+8228,U+82a1,U+82a9,U+82ab,U+82cc,U+8351,U+8368,U+83b8,U+83d8,U+83ea,U+83f0,U+8497,U+84c1,U+858f,U+85ff,U+867b,U+86a8-86a9,U+870a,U+8722,U+876e,U+877c,U+87e5,U+8888,U+88df,U+8919,U+8bcc,U+8bdf,U+8be8,U+8bee,U+8c20,U+8c2f,U+8d36,U+8df8,U+8e05,U+8e2f,U+8f9a,U+9021,U+908b,U+90b4,U+90ba,U+90d0,U+90eb,U+90fe,U+91aa,U+933e,U+9486-9487,U+948d,U+9490,U+94ad,U+94bd,U+94d6,U+94d9,U+9507,U+9546,U+955e,U+956b,U+95e9,U+9604,U+960b,U+9612,U+9615,U+9617,U+96b9,U+989a-989b,U+989e,U+9a78,U+9a7d,U+9aa0,U+9aa2,U+9ac2,U+9b23,U+9b3b,U+9c82,U+9cca,U+9cd9,U+9e28,U+9e5a,U+9e5e,U+9e6c,U+9efe,U+9f0b"}},{uri:cUe,descriptors:{unicodeRange:"U+4e47,U+4e8d,U+4f65,U+4f89,U+50ee,U+520e,U+5416,U+5454,U+54bb,U+54c2,U+54d3,U+54de,U+5591,U+55e5,U+560c,U+566b,U+5769,U+578c,U+5793,U+57e4,U+5889,U+593c,U+59ab,U+5ad4,U+5ad8,U+5af1,U+5b53,U+5ba5,U+5c59,U+5c63,U+5d5b,U+5e0f,U+5e14,U+5edb,U+5fbc,U+6004,U+60ad,U+610e,U+61b7,U+624c,U+634c,U+647a,U+64ba,U+65f0,U+6600,U+66f7,U+67e2,U+67f0,U+680c,U+686b,U+6874,U+691f,U+6989,U+6a17,U+6b81,U+6b84,U+6c06-6c07,U+6c3d,U+6d07,U+6d27,U+6d2b,U+6d91,U+6e6b,U+6e8f,U+6fde,U+70bb,U+723b,U+726e,U+72b0,U+72ce,U+72f2,U+7301,U+731e,U+737e,U+7477,U+748e,U+74ff,U+7633,U+7654,U+771a,U+7726,U+7765,U+7768,U+781c,U+7829,U+78d4,U+7913,U+7957,U+79d5,U+79eb,U+7a70,U+7a86,U+7b25,U+7b38,U+7b47,U+7b72,U+7ba6-7ba7,U+7dae,U+7ee1,U+7efe,U+7f26,U+7f31,U+7f35,U+801c,U+8043,U+809f,U+80ab,U+80d7,U+8118,U+8188,U+81cc,U+823e,U+8244,U+824f,U+82b4,U+82c1,U+82e4,U+82f4,U+8306,U+833a,U+835c,U+839c,U+83b3,U+83bc,U+846d,U+867a,U+868b,U+8734,U+87ca,U+886e,U+887e,U+88a2,U+88c9,U+8921,U+8bb5,U+8bf3,U+8c04,U+8c17,U+8c1d,U+8c25,U+8c36,U+8c55,U+8c78,U+8d3d,U+8d40,U+8d59,U+8d67,U+8d91,U+8dbf,U+8deb-8dec,U+8dfd,U+8e14,U+8e41,U+8f8e,U+900b,U+9044,U+9062,U+90cf,U+9123,U+9146,U+9162,U+9172,U+918d,U+9190,U+92c8,U+93ca,U+948c,U+94aa,U+94b2,U+94c8,U+94ca,U+94d5,U+94df,U+94e9-94ea,U+94f7,U+94fc-94fd,U+951b,U+954f,U+9554,U+9559,U+9566,U+9571-9572,U+95f1,U+9608,U+960f,U+97af,U+988f,U+98d5,U+992e,U+9955,U+9ab0,U+9b32,U+9c90,U+9c9e,U+9ca5,U+9ca9,U+9cad,U+9cb1,U+9cc3,U+9e47,U+9ee7,U+9f87"}},{uri:uUe,descriptors:{unicodeRange:"U+4e93,U+4ec4,U+4ef5,U+4f27,U+4f7b,U+4fe3,U+5080,U+5121,U+51eb,U+5208,U+52f0,U+53f5,U+5453,U+5466,U+54a6,U+54bf,U+54d0,U+5533,U+5549,U+5556,U+556d,U+558f,U+55f2,U+55f5,U+5627,U+567b,U+56d4,U+571c,U+5739,U+57b4,U+5807,U+58c5,U+59a4,U+59af,U+59d8,U+5a09,U+5a0c,U+5a4a,U+5ad2,U+5b6c,U+5ca2,U+5cac,U+5d03,U+5d6c,U+5db7,U+5ebe,U+5f2d,U+5fea,U+6042,U+6120,U+6175,U+6221,U+623e,U+6339,U+638a,U+643d,U+64b8,U+64e2,U+66e9,U+67b3,U+67c1,U+67d2,U+6832,U+6877,U+68f0,U+6934,U+6966,U+6987,U+6998,U+69c1,U+69ce,U+6a3d,U+6a84,U+6aa9,U+6b87,U+6bd6,U+6c16,U+6c18,U+6cd4,U+6cee,U+6de0,U+6e0c,U+6ecf,U+6f4b,U+70b7,U+7168,U+72d9,U+7352,U+73b3,U+73d0,U+7441,U+74d2,U+75a5,U+75e7-75e8,U+7610,U+7619,U+765e,U+772d,U+7812,U+782c,U+784c,U+7850,U+7856,U+789b,U+78f4,U+7a51,U+7b15,U+7b1e,U+7b24,U+7b5a,U+7bb8,U+7bc1,U+7bd9,U+7ed0,U+7ee6,U+7efa,U+7f1b,U+7f1f,U+7f22,U+7f45,U+7f71,U+7fa7,U+7fbf,U+7ff3,U+8052,U+80b1,U+80db,U+80f4,U+81bb,U+81ec,U+8202,U+8210,U+8249,U+828a,U+828e,U+82e3,U+8315,U+8369,U+8378,U+83a8,U+83aa,U+83b4,U+83e1,U+84fc,U+8538,U+853b,U+859c,U+85ae,U+86b4,U+86c9,U+86cf,U+8725,U+879f,U+87b3,U+887d,U+88fe,U+8a8a,U+8ba7,U+8c07,U+8c14,U+8c30,U+8c47,U+8db5,U+8dd7,U+8e1f,U+8e69,U+8e70,U+8e85,U+8f78,U+8f87,U+8f8b,U+8f8f,U+90c4,U+9143,U+917d,U+948f,U+94cd,U+94d2,U+94ef,U+954a,U+9609-960a,U+96d2,U+9708,U+9765,U+97ea,U+9880,U+98a7,U+996c,U+9980,U+9991,U+9a88,U+9ab6,U+9afb,U+9b47,U+9c87,U+9c9b,U+9cb5,U+9cc7,U+9e2c,U+9e42,U+9e58,U+9ecd,U+9ecf,U+9f8a,U+9f8c"}},{uri:dUe,descriptors:{unicodeRange:"U+4ebb,U+4edd,U+4fa9,U+502c,U+50a5,U+51c7,U+51fc,U+523d,U+5241,U+530f,U+5464,U+549d,U+54a3,U+5514,U+5527,U+555c,U+556e,U+5576,U+55b1,U+55b9,U+55eb,U+5624,U+564c,U+5671,U+5685,U+568f,U+56d7,U+56e1,U+57a1,U+57d9,U+5942,U+5a67,U+5c50,U+5c7a,U+5c98,U+5d06,U+5d27,U+5d6f,U+5df3,U+5dfd,U+5e19,U+5ea0,U+5eb9,U+5eea,U+5ffe,U+600f,U+606b,U+6215,U+622c,U+6266,U+62bb,U+62bf,U+6308,U+6387,U+63b8,U+63c4,U+63c6,U+63f6,U+6441,U+6555,U+659b,U+6677,U+66a7,U+6775,U+678b,U+679e,U+6840,U+6849,U+6860,U+68c2,U+6910,U+6a28,U+6a2f,U+6a79,U+6b92-6b93,U+6bc2,U+6bfd,U+6c29,U+6c32,U+6c86,U+6cc5,U+6d0c,U+6d60,U+6da0,U+6ddd,U+6e86,U+6ed3,U+6edf,U+6fb9,U+6fd1,U+6fef,U+7023,U+7080,U+70ca,U+712f,U+7145,U+7284,U+732c,U+73c8,U+73d9,U+740a,U+7457,U+7596,U+759d,U+75a3,U+75d8,U+75e3-75e4,U+75ff,U+7622,U+7688,U+76b4,U+76e5,U+7818,U+7887,U+789a,U+78b2,U+7b08,U+7b33,U+7c2a,U+7ccc,U+7ea8,U+7ec0,U+7fe6,U+8012,U+8084,U+8093,U+80e4,U+80ef,U+8297,U+82a8,U+82be,U+8331,U+8366,U+83c5,U+83fd,U+8473,U+84a1,U+84ca,U+84d1,U+857b,U+85c1,U+85d3,U+8605,U+8662,U+86aa,U+86b1,U+86d4,U+86ed,U+86f3,U+8709,U+8748,U+874c,U+8763,U+89c7,U+89de,U+89e5,U+8a3e,U+8ba6,U+8c00,U+8c21,U+8c49,U+8c7a,U+8d30,U+8df9,U+8e51,U+8e59,U+8f6b,U+8f73,U+8ff3,U+9016,U+9026,U+902f,U+9099,U+909b,U+90c7,U+914a,U+91ae,U+91ba,U+9495,U+94a3,U+94af,U+94ba,U+94bf,U+94cc,U+94e1,U+94f0,U+9531,U+955d,U+95f3,U+9697,U+96bc,U+975b,U+977c,U+98a2,U+998a,U+9994-9995,U+9a9b,U+9ab7,U+9ac5,U+9c91,U+9ccf,U+9cd5,U+9e29,U+9edc,U+9edf,U+9f83,U+9f88-9f89"}},{uri:fUe,descriptors:{unicodeRange:"U+4ee8,U+4f22,U+4f43,U+4f57,U+4f5d,U+4f6f,U+4ff8,U+502d,U+507b,U+5345,U+53df,U+53fb,U+544b,U+5482,U+54a7,U+54cc,U+550f,U+5544,U+5555,U+5594,U+55e8,U+55ec,U+55ef,U+564e,U+56f9,U+5704,U+576d,U+5785,U+57ad,U+5914,U+5958,U+599e,U+59aa,U+59be,U+5a06,U+5abe,U+5ae1,U+5b40,U+5bee,U+5cbf,U+5cc4,U+5ccb,U+5d47,U+603f,U+6078,U+607d,U+607f,U+608c,U+609a,U+60fa,U+61ff,U+621b,U+622e,U+626a,U+6371,U+63ae,U+63cd,U+63d6,U+6410,U+6414,U+6421,U+6448,U+64d8,U+6710,U+6748,U+6772,U+680e,U+6954,U+69ab,U+6c68,U+6c8f,U+6ca4,U+6d2e,U+6e4e,U+6e98,U+6fe0,U+7094,U+70e9,U+7116,U+7119,U+723f,U+73c9,U+74e4,U+753e,U+7548,U+75bd,U+75cd,U+7618,U+7634,U+76c5,U+76f1,U+7708,U+7719,U+777e,U+7791,U+77b3,U+7823,U+7827,U+7830,U+7889,U+7893,U+7949,U+795c,U+79e3,U+7a14,U+7a88,U+7a95,U+7aa0,U+7afd,U+7b90,U+7bd1,U+7bfe,U+7da6,U+7ec2,U+7eef,U+7f03-7f04,U+7f08,U+7f58,U+7f61,U+7f9f,U+8174,U+8200,U+828d,U+82c4,U+82d5,U+82dc,U+82f7,U+832d,U+835a,U+840b,U+8438,U+852b,U+869d,U+86ac,U+86d0,U+86f0,U+8782,U+87a8,U+87d1-87d2,U+87e0,U+8839,U+8913,U+891b,U+8934,U+8941,U+89ca,U+89ce,U+8a07,U+8ba3,U+8bc5,U+8bcb,U+8bdb,U+8c11,U+8c15,U+8c29,U+8c32,U+8dc4,U+8dce,U+8ddb,U+8dfa,U+8e09,U+8e1d,U+8e39,U+8e42,U+8e49,U+8e4b,U+8e8f,U+8f71-8f72,U+9004,U+9036,U+9097,U+90dc,U+90e2,U+90e6,U+90ef,U+9104,U+919a,U+91b4,U+938f,U+9497,U+950f,U+9557,U+9562-9563,U+9573,U+9606,U+9649,U+972d,U+973e,U+97a3,U+97eb,U+988c,U+9894,U+98a6,U+9974,U+9977,U+997d,U+9a90,U+9a9d,U+9aef,U+9ca2,U+9ccd,U+9cdf,U+9e20,U+9e4c,U+9e6b,U+9f3e"}},{uri:hUe,descriptors:{unicodeRange:"U+4ede,U+4ee1,U+4eeb,U+4fda,U+4ffe,U+5025,U+506c,U+50f3,U+5106,U+520d,U+525c,U+52ad,U+530d,U+5310,U+539d,U+53a9,U+53fc,U+5421,U+5477,U+54e7,U+551b,U+5530,U+557e,U+5599,U+55c4,U+55d1,U+55d4,U+55df,U+55e4,U+55ea,U+5623,U+562d,U+5654,U+56eb,U+56f5,U+57a7,U+57d5,U+57dd,U+584d,U+5880,U+58ec,U+59dd,U+5a32,U+5a55,U+5a75,U+5b51,U+5b71,U+5b73,U+5cd2,U+5ce4,U+5e5b,U+5e96,U+5fd2,U+607b,U+61d1,U+634b,U+636d,U+63b3,U+63ff,U+64c0,U+661d,U+6657,U+66dc,U+67a5,U+6841,U+6867,U+6901,U+699b,U+6a47,U+6b46,U+6c21,U+6c24,U+6c35,U+6c4a,U+6c94,U+6ca3,U+6d39,U+6d63,U+6d6f,U+6d94,U+705e,U+71e7,U+726f,U+72cd,U+72de,U+72f0,U+7325,U+7350,U+7391,U+741a,U+757f,U+7583,U+75b1,U+75b4,U+75b8,U+75c2,U+75f1,U+766f,U+7699,U+7751,U+789c,U+7a17,U+7be6,U+7cb2,U+7ea3,U+7eb0,U+7ebe,U+7eeb,U+7f25,U+7f2c,U+7fb8,U+8026,U+8037,U+8153,U+8171,U+8191,U+8214,U+821b,U+8222,U+826e,U+82eb,U+830c,U+8314,U+8334,U+83d6,U+8418,U+843c,U+84ff,U+8564,U+8572,U+8616,U+866c,U+8693,U+86a3,U+86a7,U+86af,U+86b6,U+86c6,U+86ca,U+8708,U+870d,U+8759,U+8760,U+87af,U+87c6,U+8869,U+88c6,U+89d0,U+8b07,U+8baa-8bab,U+8bc2,U+8be4,U+8bf0,U+8c2a,U+8c62,U+8c89,U+8d49,U+8d6d,U+8d84,U+8d94,U+8db8,U+8dc6,U+8e2e,U+8e3d,U+8e47,U+8e7f,U+9005,U+9051,U+907d,U+9082,U+9088,U+90b0,U+90d3,U+9150,U+949c,U+94a4,U+94b9,U+94cb,U+94e0,U+9509,U+9512,U+951f,U+9534,U+9552-9553,U+965f,U+96b0,U+9791,U+9889,U+9990,U+9a9c,U+9aa7,U+9c88,U+9cb2-9cb3,U+9cb6-9cb7,U+9cc5,U+9cdc,U+9e22,U+9e2a,U+9e57,U+9e67,U+9e73,U+9e82,U+9eb8,U+9ee0,U+9f9b"}},{uri:gUe,descriptors:{unicodeRange:"U+4eb5,U+4f09,U+4f5a,U+4f8f,U+4fce,U+4fdf,U+4fea,U+4ff3,U+500c,U+500f,U+504e,U+5088,U+52be,U+5420,U+5457,U+5499,U+549b,U+54c6,U+54d2,U+558b,U+559f,U+55bd,U+55d6,U+565c,U+567c,U+568e,U+5768,U+577b,U+57a9,U+57ed,U+59f9,U+5a11,U+5a40,U+5ae6,U+5b6a,U+5b93,U+5bb8,U+5c15,U+5c99,U+5c9c,U+5cc1,U+5d2e,U+5d4b,U+5d99,U+5e54,U+5e61,U+5fcf-5fd1,U+6002,U+6006,U+6014,U+60af,U+60c6,U+60da,U+60f4,U+621f,U+62c8,U+631b,U+631e,U+63e9,U+64b5,U+655d,U+6619,U+6635,U+6641,U+67ad,U+67b0,U+67b7,U+67e9,U+684e,U+688f,U+695d,U+696b,U+69b7,U+6a58,U+6c26,U+6d35,U+6d43,U+6d9e,U+6dd9,U+6dec,U+6e11,U+6e6e,U+6e9f,U+6ec2,U+6ee2,U+6ef9,U+6f09,U+6f66,U+6f8d,U+6fc2,U+6fc9,U+729f,U+72c8,U+73de,U+7430,U+7566,U+7579,U+75c9,U+75e2,U+75fc,U+762a,U+7638,U+7678,U+76c2,U+76f9,U+778c,U+77cd,U+77dc,U+7800,U+781d,U+782d,U+783b-783c,U+78a3,U+78ec,U+7980,U+7a23,U+7b95,U+7bdd,U+7c0c,U+7c41,U+7c91,U+7cb3,U+7cc5,U+7ecc,U+7f19,U+7fca,U+8006,U+8069,U+807f,U+80bd,U+80ed,U+814b,U+8198,U+82cb,U+82d2,U+834f,U+8360,U+847a,U+84d6,U+84e5,U+8537,U+85d0,U+8671,U+86a4,U+86ce,U+86f9,U+8703,U+8707,U+8737,U+873b,U+8815,U+8936,U+8bc3,U+8bcf,U+8bd2,U+8bd8,U+8be9,U+8c0c,U+8c0f,U+8c4c,U+8d45,U+8d5d,U+8d73,U+8e31,U+8e6d,U+8e76,U+8fe4,U+9041,U+90d7,U+9169,U+92ae,U+94a1,U+94c4,U+94c9,U+94db,U+94e7,U+9503,U+9506,U+9517,U+9528,U+9537,U+9542,U+9549,U+95fe,U+9616,U+961a,U+96c9,U+96f3,U+9701,U+970e,U+9739,U+9753,U+9798,U+98d2-98d3,U+98d9-98da,U+9968,U+996f,U+9984,U+9997,U+9acb,U+9b03,U+9c85,U+9ca8,U+9cab,U+9e49,U+9e51,U+9e66,U+9f10"}},{uri:mUe,descriptors:{unicodeRange:"U+4e15,U+4e1e,U+4e2b,U+4eb3,U+4ec9,U+4f0e,U+4f64,U+501c,U+50a9,U+510b,U+51a2,U+51bc,U+527d,U+52d0,U+53fd,U+5429,U+542e,U+5486,U+54af,U+5506,U+5511,U+5522,U+552c,U+556c,U+55b3,U+55d2,U+55e6,U+55fd,U+561f,U+5639,U+5659,U+5662,U+5693,U+572a,U+5892,U+598a,U+5992,U+59a9,U+5a20,U+5ae3,U+5b17,U+5b7d,U+5d34,U+5d3d,U+5d4a,U+5d82,U+5e1a-5e1b,U+5ea5,U+5f0b,U+5f77,U+5fd6,U+5fff,U+6026,U+6035,U+6063,U+60b4,U+60bb,U+60ee,U+612b,U+6194,U+61ca,U+61e6,U+61f5,U+620a,U+6248,U+62a1,U+62d7,U+6376,U+637b,U+652b,U+65bc,U+65cc,U+65ce,U+65d6,U+664c,U+665f,U+6666,U+6684,U+66b9,U+6773,U+6777,U+6787,U+67de,U+6845,U+693d,U+6994,U+6a35,U+6d54,U+6d5c,U+6d8e,U+6dd6,U+6eb4,U+6f2a,U+6f78,U+704f,U+70ec,U+7118,U+714a,U+7172,U+71b9,U+724d,U+728a,U+7337,U+733e,U+7396,U+73b7,U+73cf,U+7428,U+742c,U+742e,U+74ee,U+74f4,U+7525,U+753a,U+7572,U+75d4,U+765c,U+768e,U+7762,U+777d,U+77fd,U+7825,U+7837,U+78b4,U+795f,U+79ed,U+7a1e,U+7b06,U+7b20,U+7ba9,U+7bab,U+7c7c,U+7cbd,U+7cdc,U+7ec9,U+7ef6,U+7f30,U+7f42,U+7f44,U+7f54,U+7f94,U+8004,U+800b,U+8019,U+809b,U+80ae,U+80c4,U+80f1,U+8146,U+816e,U+817c,U+81c0,U+81fc,U+81fe,U+822b,U+830f,U+832f,U+8340,U+8365,U+8385,U+8392,U+83a0,U+8424,U+84af,U+869c,U+8713,U+8717-8718,U+87c0,U+87cb,U+87fe,U+8821,U+8902,U+89d1,U+8bb9,U+8c12,U+8d32,U+8d53,U+8df7,U+8e7c,U+8f7c,U+8f95,U+8fab,U+9052,U+905b,U+9095,U+909d,U+90c5,U+911e,U+9122,U+916a,U+919b,U+948e,U+9492,U+949a,U+94b5,U+94bc,U+94c6,U+94f1,U+9502,U+9511,U+9536,U+956f-9570,U+9602,U+9621,U+9631,U+998b,U+99a5,U+9a81,U+9a9e,U+9ebe,U+9f8b"}},{uri:pUe,descriptors:{unicodeRange:"U+4f2b,U+4f3d,U+4fac,U+5043,U+5055,U+5140,U+5156,U+51cb,U+5243,U+531d,U+536f,U+53a5,U+53ae,U+53f1,U+541d,U+5431,U+547b,U+5492,U+5494,U+54a4,U+54aa,U+54ce,U+54fd,U+5509,U+5520,U+553e,U+557b,U+55c5,U+55e1,U+55f7,U+5608,U+5636,U+563b,U+5773,U+57a0,U+5811,U+587e,U+58d5,U+59e3,U+5a29,U+5a6a,U+5a76,U+5a7a,U+5ac9,U+5b62,U+5b95,U+5c49,U+5c8c,U+5cab,U+5cb7,U+5d02,U+5d58,U+5e44,U+5e7a,U+5eff,U+5f29,U+5f89,U+5f9c,U+5fa8,U+6005,U+6043,U+60b8,U+60d8,U+60ec,U+60f0,U+6115,U+618e,U+630e,U+637a,U+6390,U+63ac,U+63b0,U+64de,U+6525,U+6538,U+65ee-65ef,U+6631,U+6636,U+6654,U+677c,U+67b8,U+67d8,U+683e,U+6886,U+68b5,U+692d,U+6963,U+6979,U+6988,U+6b59,U+6b9a,U+6c69,U+6c74,U+6cae,U+6ce0,U+6cef,U+6d95,U+6dc5,U+6dde,U+6de6,U+6dfc,U+6ea7,U+6f15,U+6f29,U+7096,U+70c3,U+7131,U+715c,U+7166,U+7266,U+7317,U+731d,U+7329,U+73e9,U+7425,U+7455,U+7490,U+74ef,U+7519,U+75b5,U+75b9,U+75de,U+7656,U+7663,U+7691,U+7729,U+77fe,U+783e,U+787c,U+795a,U+7a79,U+7abf,U+7b3a,U+7b4f,U+7b60,U+7b75,U+7b8d,U+7bb4,U+7bd3,U+7be1,U+7cbc,U+7edb,U+7f1c,U+7f8c,U+7fb2,U+7fb9,U+7fce,U+7ff1,U+810d,U+81c6,U+82a5,U+82aa,U+82de,U+8317,U+8343,U+835e,U+8364,U+836a,U+853a,U+8543,U+854a,U+8559,U+8568,U+85b0,U+85b9,U+864f,U+86e4,U+8715,U+8845,U+8884,U+88e8,U+88f1,U+8983,U+8be1,U+8c1f,U+8c27,U+8c5a,U+8c82,U+8d58,U+8dbe,U+8f98,U+9035,U+9074,U+90a1,U+9149,U+9157,U+93d6,U+949d,U+94c2,U+94e3-94e4,U+95eb,U+95f0,U+9611,U+9619,U+9642,U+968d,U+9706,U+970f,U+97ed,U+988a,U+9893,U+98e8,U+9a77,U+9a87,U+9aa1,U+9abc,U+9cdd,U+9e2f,U+9e33,U+9e44,U+9e5c,U+9e9d,U+9edd"}},{uri:UUe,descriptors:{unicodeRange:"U+4f58,U+4f6c,U+4f70,U+4fd0,U+5014,U+51bd,U+524c,U+5315,U+5323,U+535e,U+540f,U+542d,U+545b,U+548e,U+549a,U+54ab,U+54fc,U+5567,U+556a,U+5600,U+5618,U+563f,U+5669,U+56f1,U+56ff,U+573b,U+574d,U+579b,U+57b8,U+57c2,U+586c,U+58f9,U+595a,U+598d,U+5993,U+5996,U+59d7,U+5b7a,U+5ba6,U+5c4e,U+5c96,U+5ce5,U+5eb6,U+5f08,U+5f99,U+602f,U+6059,U+606c,U+607a,U+60ed,U+61a9,U+620c,U+6249,U+62a8,U+62c4,U+62ed,U+62fd,U+6342,U+6345,U+6396,U+63a3,U+6402,U+6413,U+642a,U+6487,U+64a9,U+64ac,U+64ae,U+64b7,U+659f,U+65a1,U+667e,U+66f3,U+67e0,U+69db,U+69df,U+6aac,U+6b86,U+6c50,U+6c5e,U+6c76,U+6c85,U+6c8c,U+6cde,U+6d19,U+6d52,U+6da7,U+6db8,U+6e1a,U+6e25,U+6e4d,U+6e5f,U+6ec1,U+6f31,U+6f7a,U+6fa7,U+6fe1,U+701b,U+70ab,U+70f7,U+717d,U+71a8,U+7252,U+72c4,U+72e1,U+7315,U+736d,U+73ae,U+73c0,U+73c2,U+740f,U+75a4,U+7600-7601,U+768b,U+76bf,U+76d4,U+7728,U+772f,U+776c,U+77a0,U+77b0,U+77f8,U+783a,U+78d0,U+78fa,U+7977,U+7a37,U+7a92,U+7afa,U+7b71,U+7b94,U+7cef,U+7f28,U+7fe1,U+808b,U+80e5,U+80eb,U+8110,U+8113,U+812f,U+814c,U+81c3,U+8235,U+82d4,U+8309,U+83c1,U+8431,U+8469,U+84bf,U+84d3,U+84df,U+84e6,U+8511,U+8638,U+86c0,U+86db,U+86fe,U+8757,U+8822,U+8882,U+8885,U+8892,U+88f3,U+892a,U+8ba5,U+8bd9,U+8be0,U+8be7,U+8bfd,U+8c1a,U+8d4a,U+8d4e,U+8d66,U+8dda,U+8e0c,U+8e52,U+8e74,U+8e87,U+8f76,U+8fc2,U+8fe6,U+900d,U+9068,U+90ac,U+90b3,U+90b8,U+90e7,U+9119,U+9131,U+915a,U+916e,U+94b4,U+94d0,U+94e2,U+94ec,U+94ff,U+9522,U+9535,U+9556,U+965b,U+96f9,U+9774,U+9981,U+998d,U+998f,U+9a6e,U+9a7f,U+9a8a,U+9b13,U+9c9f,U+9e3e,U+9e43,U+9e6d,U+9e8b,U+9e92,U+9edb,U+9eef"}},{uri:bUe,descriptors:{unicodeRange:"U+4e10,U+4e56,U+4e98,U+4ec3,U+4f3a,U+4f5f,U+4f88,U+4f97,U+4fa5,U+4fe8,U+504c,U+5197,U+52fa,U+5364,U+53e8,U+5406,U+543c,U+545c,U+5471,U+5480,U+5495,U+54b3,U+54df,U+54e6,U+54ee,U+557c,U+5583,U+55dc,U+55e3,U+566c,U+592f,U+5944,U+5983,U+59ca,U+59e5,U+5a13,U+5a7f,U+5b09,U+5bd0,U+5e4c,U+5eb5,U+5f1b,U+5f3c,U+608d,U+60cb,U+61a7,U+61ac,U+61cb,U+6233,U+62a0,U+62e7,U+62ee,U+62f4,U+62f7,U+634e,U+6382,U+63c9,U+63ea,U+6400,U+645e,U+6482,U+6556,U+6593,U+6615,U+664f,U+66e6,U+672d,U+675e,U+67da,U+6805,U+6808,U+6868,U+68a2,U+695e,U+69ad,U+6a80,U+6a90,U+6b83,U+6be1,U+6c30,U+6cad,U+6cb1,U+6cf1,U+6d31,U+6d93,U+6dae,U+6dbf,U+6dc6-6dc7,U+6e0d,U+6e32,U+6e3a,U+6e85,U+6eba,U+6f3e,U+6f5e,U+6f7c,U+6fee,U+71ee,U+722a,U+72b7,U+72e9,U+73ba,U+73d1,U+7409,U+7435-7436,U+7459-745a,U+747e,U+7487,U+74e2,U+7504,U+752c-752d,U+7599,U+759f,U+75a1,U+75ca,U+75f0,U+761f,U+7629,U+777f,U+7785,U+77a5,U+77bf,U+78d5,U+7934,U+7940,U+79a7,U+7b19,U+7c38,U+7c95,U+7cb1,U+7ce0,U+7eca,U+7ef7,U+7f2b,U+7f81,U+7fcc,U+8046,U+8148,U+8165,U+819b,U+81ba,U+828b,U+82ae,U+82b7,U+82d3,U+8301,U+830e,U+831c,U+8338,U+837c,U+8393,U+8398,U+83ba,U+83e0,U+83e9,U+853c,U+8654,U+86df,U+8712,U+873f,U+874e,U+8783,U+8859,U+88a4,U+8925,U+8bb7,U+8bff,U+8c19,U+8c1b,U+8c24,U+8c2c,U+8d61,U+8db4,U+8e6c,U+8f8a,U+8fe5,U+8ff8,U+901e,U+90f4,U+912f,U+9163,U+9170,U+91dc,U+949b,U+94a8,U+94b3,U+94c0,U+94e8,U+9525,U+9530,U+9539,U+954c-954d,U+9550,U+955b,U+962a,U+9685,U+96cc,U+9776,U+988d,U+9975,U+9985,U+9a6f,U+9aa5,U+9ab8,U+9c7f,U+9ca4,U+9cb8,U+9e25,U+9e35,U+9e4a"}},{uri:yUe,descriptors:{unicodeRange:"U+4ea2,U+4ea5,U+4f36,U+4f84,U+4f8d,U+501a,U+5029,U+516e,U+51a5,U+51c4,U+51f8,U+5201,U+527f,U+5321,U+5352,U+5366,U+53e9,U+54c7,U+5632,U+5676,U+56b7,U+56bc,U+56da,U+56e4,U+5703,U+5729,U+5742,U+57a2-57a3,U+5815,U+58d1,U+5919,U+592d,U+5955,U+5a05,U+5a25,U+5a34,U+5b70,U+5b75,U+5bdd,U+5bf0,U+5c41,U+5c79,U+5c91,U+5c94,U+5ce6,U+5ced,U+5d69,U+5dc5,U+5e16,U+5e27,U+5f27,U+5f95,U+5ffb,U+6020,U+604d,U+6055,U+60e6,U+60eb,U+6123,U+618b,U+61a8,U+620d,U+62c7,U+62ce,U+62d9,U+631f,U+634d,U+6452,U+6479,U+64ce,U+64d2,U+655b,U+660a,U+6726,U+67c4,U+6809,U+6853,U+68e3,U+68f1,U+68fa,U+693f,U+6942,U+6995,U+69a8,U+69b4,U+6a71,U+6b89,U+6bcb,U+6bd3,U+6bd9,U+6c40,U+6cf8,U+6cfe,U+6d85,U+6da3,U+6daa,U+6e0e,U+6e43-6e44,U+6f88,U+7078,U+7099,U+70bd,U+70d9,U+70fd,U+7109,U+7184,U+7239,U+733f,U+73f2,U+748b,U+749c,U+749e,U+759a,U+75d2,U+75eb,U+7620,U+766b,U+7693,U+76cf,U+7738,U+773a,U+776b,U+778e,U+77aa,U+7852,U+78be,U+7948,U+795b,U+7960,U+796f,U+79ba,U+7a20,U+7a96,U+7aa5,U+7b03,U+7b28,U+7b50,U+7b77,U+7bc6,U+7bf1,U+7c27,U+7d0a,U+7ead,U+7ec5,U+7ee2,U+7ef0,U+7efd,U+7f0e,U+7f2e,U+7f79,U+7f9a,U+8098,U+80da,U+80e7,U+80f0,U+80f3,U+80fa,U+818a,U+81e7,U+8237-8238,U+8299,U+82b8,U+82ce,U+837b,U+83bd,U+83cf,U+8426,U+8475,U+85c9,U+85d5,U+85dc,U+85e9,U+871a,U+8747,U+8749,U+888d,U+8910,U+891a,U+8bb4,U+8be3,U+8bec,U+8bf2,U+8c06,U+8c0d,U+8d31,U+8d48,U+8de4,U+8e1e,U+8e4a,U+8e66,U+8f84,U+8f97,U+9083,U+90e1,U+9165,U+91c9,U+94b0,U+94f5,U+9504,U+9532,U+956d,U+95f5,U+95fa,U+9668,U+9698,U+96bd,U+9704,U+9773,U+9890,U+996a,U+997a,U+9a74,U+9a8b,U+9cc4,U+9ccc"}},{uri:EUe,descriptors:{unicodeRange:"U+4ea8,U+4f1e,U+4f51,U+4f63,U+4f7c,U+4f83,U+4fa0,U+4fd1,U+4ffa,U+5018,U+5026,U+508d,U+50bb,U+50f5,U+50fb,U+5162,U+5319,U+5320,U+538c,U+5413,U+541f,U+5475,U+54bd,U+54d1,U+5589,U+5598,U+575f,U+57ae,U+57e0,U+5937,U+5974,U+5978,U+59ae,U+5a1f,U+5a49,U+5ab3,U+5b99,U+5b9b,U+5ba0,U+5be1,U+5be5,U+5c09,U+5c27,U+5de2,U+5e9a,U+5f26,U+5f8a,U+5f98,U+6021,U+606d,U+60bc,U+60d5,U+60e7,U+611a,U+614c,U+6254,U+626f,U+6292,U+6296,U+62b9,U+62e2,U+631a,U+631d,U+6320,U+6346,U+63ba,U+6467,U+64bc,U+658b,U+663c,U+6643,U+6652,U+6656,U+6687,U+66d9,U+66dd,U+66f0,U+673d,U+67ab,U+6816-6817,U+68a7,U+68ad,U+68cd,U+68e0,U+6986,U+69fd,U+6b47,U+6bd7,U+6c1f,U+6c2e-6c2f,U+6cbe,U+6de4,U+6e1d,U+6e83,U+6e9c,U+6ed4-6ed5,U+6f4d,U+70f9,U+7130,U+716e,U+718f,U+71ac,U+71e5,U+72fc,U+731c,U+7334,U+73ca,U+7422,U+7426,U+745f,U+7470,U+75af,U+75f4,U+762b,U+763e,U+7696,U+7737,U+7741,U+77a7,U+77bb,U+77ee,U+785d,U+788c,U+78ca,U+7901,U+796d,U+7985,U+79fd,U+7a3c,U+7a57,U+7a74,U+7b5b,U+7caa,U+7cb9,U+7cd5,U+7eac,U+7eb6,U+7ed1,U+7ee5,U+7f20,U+7f2a,U+7f38,U+7f69,U+7fa1,U+8018,U+8038,U+803f,U+804b,U+80a2,U+80be,U+80d6,U+817a,U+81fb,U+820c,U+82ad,U+82af,U+82bd,U+8327,U+8354,U+835f,U+8367,U+836b,U+840c,U+841d,U+8471,U+849c,U+84b2,U+84c9,U+8517,U+851a,U+8549,U+8681,U+8721,U+8776,U+88d9,U+88f9,U+89c5,U+8c1c,U+8c34,U+8d81,U+8d9f,U+8e0a,U+8e72,U+8eb2,U+8fed,U+901b,U+902e,U+906e,U+9091,U+90aa,U+90af,U+915d,U+9171,U+946b,U+9489,U+9499,U+94a5,U+9508,U+9524,U+952d,U+9551,U+9576,U+95f7,U+9600,U+96b6,U+96c0,U+9756,U+97f6,U+98a0,U+98a4,U+997f,U+9a73,U+9a86,U+9ad3,U+9e3d,U+9ed4"}},{uri:T0e,descriptors:{unicodeRange:"U+4e4d,U+4e5e,U+4ec7,U+4ed5,U+50da,U+50e7,U+515c,U+51a4,U+51ff,U+5203,U+5254,U+5300,U+533e,U+5375,U+53ee,U+5435,U+543b,U+5455,U+548b,U+548f,U+54d7,U+54fa,U+5578,U+5587,U+55a7,U+560e,U+5760,U+576f,U+5777,U+5830,U+58a9,U+5962,U+59e8,U+5a07,U+5a23,U+5a3c,U+5b5a,U+5bb5,U+5bc5,U+5bde,U+5c7f,U+5cb1,U+5ce8,U+5cea,U+5d29,U+5d4c,U+5e18,U+5f57,U+5f5d,U+5f87,U+5ff1,U+6016,U+601c,U+6064,U+6177,U+61d2,U+625b,U+62e3,U+62f1,U+634f,U+63a0,U+6401,U+6405,U+6495,U+64c2,U+6512,U+6577,U+6590,U+65a7,U+65a9,U+65f7,U+6627,U+6655,U+6714,U+6795,U+67d1,U+67ff,U+68b3,U+68d5,U+68d8,U+6930,U+6960,U+6977,U+69bb,U+69d0,U+6a31,U+6b7c,U+6bb4,U+6c22,U+6c72,U+6c79,U+6c7e,U+6c81,U+6c93,U+6ca5,U+6cbc,U+6ce3,U+6cfb,U+6d3c,U+6da9,U+6df3,U+6e2d,U+6eaf,U+6ec7,U+6f13,U+6f33,U+6f62,U+6fa1,U+7011,U+707c,U+708a,U+70c1,U+70d8,U+70eb,U+711a,U+7194,U+7281,U+7316,U+7357,U+7384,U+7405,U+742a,U+745b,U+7574,U+7578,U+75ea,U+7682,U+7792,U+77d7,U+77e9,U+77eb,U+77f6,U+780c,U+78c5,U+7941,U+79e4,U+7a1a,U+7a9c,U+7ad6,U+7b5d,U+7bf7,U+7c07,U+7c3f,U+7c9f,U+7ca5,U+7cdf,U+7e82,U+7eab,U+7ece,U+7eda,U+7f09,U+7f15,U+7f9e,U+7fdf,U+7fe9,U+803b,U+803d,U+80aa,U+80b4,U+813e,U+8155,U+817b,U+819d,U+821c,U+82b9,U+82df,U+82ef,U+8304,U+83b9,U+8446,U+853d,U+85af,U+85fb,U+8650,U+865e,U+86d9,U+86ee,U+8700,U+8862,U+889c,U+88d4,U+88f8,U+895f,U+8a79,U+8bb3,U+8bb6,U+8bc0,U+8beb,U+8bf5,U+8c23,U+8c79,U+8d1e,U+8dcb,U+8e29,U+8e44,U+8e81,U+8eac,U+8eaf,U+8f8d,U+9050,U+90f8,U+914b,U+948a,U+94be,U+94ee,U+950c,U+9540,U+962e,U+9647,U+9661,U+9699,U+96cf,U+9716,U+9761,U+97a0,U+97e7,U+9a7c,U+9a8f,U+9ae6,U+9cd6,U+9e26"}},{uri:vUe,descriptors:{unicodeRange:"U+4fa3,U+4fae,U+4fd8,U+4fef,U+50a3,U+5189,U+5195,U+51db,U+51f3,U+51f9,U+5220,U+5228,U+5288,U+52ff,U+532e,U+533f,U+5351,U+53db,U+53ed,U+5450,U+5484,U+5490,U+54c9,U+54e9,U+5501,U+5507,U+5543,U+55d3,U+56a3,U+575e,U+589f,U+5984,U+59ec,U+5a04,U+5a36,U+5a77,U+5a9a-5a9b,U+5ab2,U+5ac2,U+5ad6,U+5bc7,U+5c2c,U+5c34,U+5c51,U+5cd9,U+5d0e,U+5deb,U+5e3c,U+5e87,U+5ed3,U+5f13,U+5f64,U+5fe1,U+606a,U+6096,U+60df,U+60f6,U+60f9,U+6151,U+620e,U+6241,U+6252,U+6273,U+627c,U+6289,U+62c2,U+62cc,U+62ef,U+6361,U+6363,U+63b7,U+63e3,U+6518,U+66ae,U+6756,U+6789,U+6813,U+6829,U+6862,U+6866,U+6893,U+6897,U+690e,U+6984,U+69cc,U+6a1f,U+6a44,U+6a59,U+6ba1,U+6c13,U+6c90,U+6ca6,U+6cbd,U+6ccc,U+6cd3,U+6cd7,U+6d4a,U+6d4f,U+6d5a,U+6d9f,U+6da1,U+6dcc,U+6ea5,U+6ee4,U+6ee6,U+6f2f,U+6f8e,U+701a,U+7095,U+709c,U+70af,U+70db,U+70e8,U+714e,U+715e,U+71a0,U+71ce,U+7235,U+7280,U+72d0,U+72f8,U+73ab,U+7410,U+745c,U+7480,U+74a7-74a8,U+74e3,U+75ae,U+75f9,U+76b1,U+76ce,U+7736,U+77e2-77e3,U+781a,U+789f,U+797a,U+79be,U+79c3,U+79c6,U+79f8,U+7a8d,U+7a98,U+7aa6,U+7aff,U+7b1b,U+7cd9,U+7d6e,U+7ede,U+7eee,U+7f00,U+7f24,U+7f2d,U+7fd8,U+800d,U+8116,U+8151,U+81b3,U+8205,U+82c7,U+82db,U+832c,U+8335,U+8339,U+8386,U+846b,U+8587,U+8611,U+8682,U+868a,U+868c,U+8774,U+88d8,U+88f4,U+8912,U+8b6c,U+8bbd,U+8c0e,U+8c41,U+8d26,U+8d3b-8d3c,U+8d50,U+8dea,U+8e35,U+8f99,U+8fe2,U+8fe9,U+9017,U+914c,U+916f,U+9175-9176,U+918b,U+94a0,U+94ae,U+94ce,U+94f2,U+951a,U+952f,U+9541,U+9640,U+9672,U+968b,U+96cd,U+96ef,U+9713,U+97ec,U+9885,U+9992,U+9a6d,U+9a79,U+9a85,U+9cbb,U+9cd7,U+9cde,U+9e93,U+9f9f"}},{uri:wUe,descriptors:{unicodeRange:"U+4e11,U+4ed7,U+4fcf,U+4fe9,U+4fed,U+50ac,U+50b2,U+5112,U+5180,U+5188,U+51f6,U+522e,U+5265,U+52cb,U+52df,U+5349,U+5367,U+5378,U+537f,U+5395,U+5398,U+53d4,U+543e,U+5440,U+5446,U+54b8,U+5565-5566,U+5580,U+55bb,U+56ca,U+572d,U+573e,U+574e,U+5782-5784,U+58f3,U+5938-5939,U+5948,U+594e,U+5a1c,U+5a74,U+5ae9,U+5b55,U+5b5c,U+5bb0,U+5bd3,U+5bf8,U+5c3f,U+5d14,U+5d2d,U+5df7,U+5dfe,U+5e05-5e06,U+5e1c,U+5e62,U+5e7b,U+5e7d,U+5ed6,U+5f2f,U+5f66,U+5f6c,U+5fa1,U+604b,U+609f,U+60a6,U+60e8,U+6101,U+6124,U+6127,U+6148,U+61be,U+6247,U+62d8,U+62da,U+633d,U+635e,U+6367,U+6380,U+638f,U+63a9,U+63fd,U+641c,U+64e6,U+655e,U+6572,U+6591,U+65a5,U+6691,U+6735,U+67a2-67a3,U+67ef,U+680b,U+6876,U+6905,U+6a0a,U+6a61,U+6b79,U+6bb7,U+6bbf,U+6c41,U+6c55,U+6c83,U+6c9b,U+6ca7,U+6cfc,U+6d46,U+6d51,U+6d74,U+6d9d,U+6daf,U+6dc0,U+6deb,U+6e17,U+6e24,U+6e89,U+6ea2,U+6ef4,U+6f6d,U+707f,U+70b3,U+70e4,U+70ef,U+710a,U+722c,U+725f,U+7261,U+72ee,U+72f1,U+730e,U+732b,U+7433,U+7538,U+75bc,U+7624,U+7709,U+7750,U+7779,U+7802,U+7898,U+78a7,U+78b1,U+78cb,U+78f7,U+7984,U+7a83,U+7aed,U+7b3c,U+7b4b,U+7c92,U+7c98,U+7ca4,U+7eb9,U+7ee3,U+7ef3,U+7ef5,U+7f05,U+7f55,U+7f62,U+7fc1,U+7fd4,U+7fe0,U+8042,U+806a,U+80a0,U+80a4,U+80c3,U+8102,U+8106,U+814a,U+8154,U+8247,U+8258,U+82cd,U+8328,U+832b,U+8389,U+83ca,U+845b,U+846c,U+84b8,U+8574,U+859b,U+8680,U+8695,U+86c7,U+8702,U+886c,U+8896,U+88b1,U+88e4,U+8bc8,U+8c10,U+8c26,U+8c28,U+8c2d,U+8d4c,U+8d63,U+8f67,U+8f74,U+8fc4,U+9006,U+9063,U+90a2,U+90b1,U+90c1,U+9177,U+9189,U+9493,U+949e,U+94fe,U+9610,U+961c,U+96a7,U+96fe,U+978d,U+97f5,U+9888,U+997c,U+9a84,U+9b3c,U+9b44-9b45,U+9b54,U+9e64,U+9f0e,U+9f9a"}},{uri:_Ue,descriptors:{unicodeRange:"U+4e19,U+4e38,U+4e53,U+4e7e,U+4e9f,U+4ec6,U+4f50,U+4fde,U+502a,U+5154,U+517d,U+51d1,U+51f0,U+5239,U+5256,U+52c9,U+52fe,U+5308,U+532a,U+535c,U+5384,U+53a2,U+53a8,U+53c9,U+53e0,U+5496,U+54ac,U+54c0,U+54c4,U+54e8,U+5561,U+5582,U+561b,U+5631,U+566a,U+5764,U+576a,U+5792,U+57ab,U+584c,U+5885,U+58f6,U+59a8,U+5acc,U+5bc2,U+5c38-5c39,U+5c60,U+5c6f,U+5c82,U+5c90,U+5d16,U+5dcd,U+5e37,U+5e90,U+5eb8,U+5f6a,U+5fcc,U+6012,U+6068,U+6073,U+607c,U+6094,U+6109,U+621a,U+626e,U+6284,U+62d0,U+62e6,U+62fe,U+6321,U+6328,U+632b,U+6349,U+6454,U+65ed,U+660f,U+6674,U+66a8,U+6749,U+674f,U+6760,U+67af,U+6850,U+6854,U+6869,U+68a8,U+68d2,U+68f5,U+6912,U+6b49,U+6b6a,U+6bef,U+6c28,U+6c5d,U+6c82,U+6cab,U+6cb8,U+6cc4,U+6cf5,U+6d47,U+6d78,U+6da4,U+6dc4,U+6dcb,U+6df9,U+6e0a,U+6e23,U+6e5b,U+6eb6,U+6f06,U+6f47,U+6f84,U+6f9c,U+6fd2,U+7076,U+70ac,U+7199,U+723d,U+72ac,U+72ed,U+7476,U+7529,U+752b,U+754f,U+7554,U+75d5,U+7626,U+76ef,U+7720,U+7766,U+7784,U+77ac,U+780d,U+7838,U+7845,U+786b,U+78b3,U+7978,U+79b9,U+79c9,U+79e7,U+7a3d,U+7a84,U+7a9f,U+7b0b,U+7b52,U+7c7d,U+7f1a,U+7fc5,U+7ff0,U+804a,U+8086-8087,U+808c,U+809a,U+80ba,U+810a,U+8180,U+818f,U+81c2,U+81ed,U+8231,U+8292,U+829c,U+82a6,U+82d1,U+8346,U+838e,U+839e,U+83c7,U+83f1,U+8403,U+840e,U+8513,U+857e,U+85e4,U+867e,U+871c,U+87ba,U+87f9,U+884d,U+8944,U+8a93,U+8c05,U+8d2c,U+8d2e,U+8d42-8d43,U+8dfb,U+8e22,U+8eba,U+8f69,U+8f9c,U+8fa3,U+8fa8,U+8fb1,U+900a,U+9038,U+903b,U+9042,U+904f,U+90b5,U+90dd,U+9102,U+9187,U+94a7,U+94c5,U+9523,U+95f8,U+95fd,U+960e,U+964b-964c,U+96c1,U+9709,U+971c,U+97ad,U+9882,U+9965,U+9976,U+9988,U+99a8,U+9a82,U+9a9a,U+9b41,U+9c8d,U+9e45,U+9e70,U+9e9f,U+9f3b,U+9f7f"}},{uri:TUe,descriptors:{unicodeRange:"U+4e08,U+4e18,U+4e1b,U+4e22,U+4e27,U+4e32,U+4e52,U+4e73,U+4ead,U+4ed4,U+4ed9,U+4ef0,U+4fa6,U+5076,U+5179,U+51bb,U+51c9,U+51ef,U+51fd,U+524a,U+526a,U+529d,U+52ab,U+5306,U+5339,U+53d9,U+540a,U+5410,U+541e,U+5439,U+54b1,U+54ed,U+5564,U+558a,U+55b7,U+5634,U+574a,U+5751,U+57a6,U+57cb,U+57d4,U+5824,U+582a,U+5835,U+5858,U+5893,U+58e4,U+5951,U+5986,U+59da,U+59fb,U+59ff,U+5a03,U+5a46,U+5ac1,U+5b5d,U+5bfa,U+5c18,U+5c3a,U+5c48,U+5c4f,U+5c61,U+5cb3,U+5d1b,U+5e15,U+5e3d,U+5e99,U+5e9e,U+5eca,U+5f0a,U+5f17-5f18,U+5f25,U+5f7c,U+5fcd,U+6028,U+60a0,U+60ac,U+60d1,U+614e,U+6155,U+6168,U+61c8,U+6208,U+6212,U+6251,U+629a-629b,U+62ab-62ac,U+62fc,U+6323,U+632a,U+63d2,U+643a,U+6491-6492,U+649e,U+64b0,U+64c5,U+659c,U+6614,U+662d,U+6664,U+6670,U+6676,U+6746,U+67cf,U+67d4,U+682a,U+6843,U+6846,U+68da,U+6b3a,U+6b67,U+6c27,U+6c5b,U+6c64,U+6c70,U+6caa,U+6cca,U+6ce1,U+6d12,U+6d45,U+6dd1,U+6dd8,U+6e34,U+6e7f,U+6ee5,U+6f02,U+7092,U+70c2,U+70e6,U+7115,U+7237,U+7272,U+727a,U+72c2,U+739b,U+73b2,U+743c,U+751c,U+758f,U+75b2,U+7686,U+76c6,U+76d2,U+76fc,U+775b,U+77a9,U+7816,U+788e,U+7897,U+78b0,U+79bd,U+7a0d,U+7a91,U+7a9d,U+7ae3,U+7bad,U+7cca,U+7d2b,U+7eb1,U+7f06,U+7f14,U+7f1d,U+7f50,U+7ffc,U+8036,U+80bf,U+80c1,U+80ce,U+80f8,U+8109,U+810f,U+8170,U+8179,U+819c,U+821f,U+8230,U+8236,U+8273,U+829d,U+82f9,U+8305,U+8350,U+83b2,U+83cc,U+8404,U+840d,U+8427,U+8482,U+8679,U+8854,U+886b,U+8bbc,U+8be6,U+8c31,U+8c6b,U+8d4b,U+8dcc,U+8e2a,U+8e48,U+8f90,U+8fb0,U+9022,U+903c,U+903e,U+9065,U+916c,U+917f,U+94a9,U+94c3,U+94dd,U+94ed,U+9510,U+953b,U+96c7,U+970d,U+9738,U+9877,U+987d,U+989c,U+98d8,U+9a70,U+9a91,U+9aa4,U+9b42,U+9b4f,U+9e2d,U+9e3f,U+9e7f,U+9f20"}},{uri:w0e,descriptors:{unicodeRange:"U+4e59,U+4ed3,U+4f0f,U+4f38,U+4f69,U+4fa7,U+4faf,U+4ff1,U+5077,U+5085,U+5144,U+5151,U+51af,U+51b6,U+51cc,U+523a,U+5251,U+5269,U+5272,U+52d8,U+5353,U+5389,U+53f9,U+5401,U+5415,U+541b,U+54f2,U+5524,U+554a,U+559d,U+5609,U+5740,U+575d,U+5806,U+5821,U+586b,U+5915,U+594f,U+5960,U+5999,U+59a5,U+59b9,U+59c6,U+59d1,U+59dc,U+5b5f,U+5b64,U+5b87,U+5bb4,U+5bbf,U+5c16,U+5c1d,U+5c3e,U+5c9a,U+5ca9,U+5cad,U+5cfb,U+5de1,U+5de7,U+5de9,U+5ef7,U+5f04,U+5f70,U+5f79,U+5fc6,U+602a,U+6050,U+6052,U+6070,U+6084,U+60b2,U+60dc,U+60e9,U+6167,U+6170,U+61c2,U+6270,U+6291,U+62b1,U+62bc,U+62dc,U+62df,U+62f3,U+6324,U+633a,U+6377,U+6398,U+63cf,U+640f,U+642c-642d,U+6458,U+6478,U+6500,U+654c,U+6566,U+658c,U+65c1,U+65cb,U+65e8,U+65ec,U+6696-6697,U+6734,U+679a,U+679d,U+67dc,U+67f3-67f4,U+680f,U+683d,U+684c,U+68af,U+699c,U+6bc1,U+6c0f,U+6c1b,U+6c57,U+6c6a,U+6d3d,U+6d6e,U+6d82,U+6db5,U+6dee,U+6e58,U+6eaa,U+6ecb,U+6ede,U+6ee9,U+6f0f,U+6f20,U+6f58,U+704c,U+7070,U+70b8,U+718a,U+7238,U+7262,U+7275,U+72b9,U+72d7,U+72e0,U+741b,U+7434,U+7483,U+74f6-74f7,U+75ab,U+764c,U+7761,U+7855,U+7891,U+78c1,U+79d2,U+7a00,U+7a3b,U+7c97,U+7ea4,U+7eb2,U+7ed2,U+7eea,U+7ef8,U+7f18,U+7fbd,U+8000,U+8010,U+8096,U+809d,U+80a9,U+817f,U+81e3,U+8206,U+8212,U+82ac,U+8302,U+8361,U+8377,U+83f2,U+8461,U+848b,U+84ec,U+8521,U+85aa,U+8870,U+8877,U+8881,U+888b,U+88ad,U+88c2,U+8986,U+8bd1,U+8bf1,U+8d24,U+8d2a,U+8d3e-8d3f,U+8d41,U+8d56,U+8d64,U+8d6b,U+8e0f,U+8f70,U+8f85,U+8f88,U+8fa9,U+9003,U+901d,U+90b9,U+90ce,U+94a6,U+94f8,U+9505,U+95ea,U+95ef,U+95f2,U+95f9,U+9601,U+9605,U+9634,U+966a,U+9677,U+9690,U+9694,U+96d5,U+971e,U+9896-9897,U+9972,U+9a71,U+9a76,U+9a7e,U+9e1f,U+9e23"}},{uri:IUe,descriptors:{unicodeRange:"U+4e01,U+4e43,U+4ea6,U+4ef2,U+4eff,U+4f26,U+4f2a,U+4f2f,U+4f5b,U+4fa8,U+4fca,U+4fd7,U+5021,U+504f,U+5141,U+51c0,U+51dd,U+51e4,U+51ed,U+5200,U+5237,U+5427,U+5448,U+54a8,U+5706,U+5708,U+5723,U+575b,U+57c3,U+5899,U+58a8,U+58c1,U+5976,U+5988,U+59bb,U+59d0,U+59d3,U+5a18,U+5a31,U+5a92,U+5b54,U+5b85,U+5baa-5bab,U+5bc4,U+5bd2,U+5be8,U+5bff,U+5c65,U+5d07,U+5e1d,U+5e78,U+5e7c,U+5f03,U+5f1f,U+5f39,U+5f6d,U+5f92,U+5faa,U+5fbd,U+5fe7,U+5ffd,U+60a8,U+60ef,U+6108,U+6162,U+622a,U+6234,U+626b,U+626d,U+62c6,U+62d2,U+62d4,U+62d6,U+62e8,U+6316,U+6355,U+63ed,U+6447,U+64a4,U+65f1,U+6606,U+6628,U+664b,U+6668,U+6682,U+66f9,U+66fc,U+66ff,U+6717,U+6740,U+676d,U+67aa,U+67ec,U+67f1,U+6842,U+6851,U+695a,U+6982,U+6a2a,U+6b20,U+6b23,U+6b32,U+6b96,U+6bc5,U+6beb,U+6c60,U+6c9f,U+6cea,U+6cf3,U+6d1e,U+6d53,U+6d66,U+6d69,U+6d8c,U+6d9b,U+6db2,U+6de1,U+6dfb,U+6e14,U+6ed1,U+6eda,U+6ee8,U+6f2b,U+706d,U+7089,U+708e,U+70ad-70ae,U+70e7,U+7126,U+714c,U+71c3,U+71d5,U+7206,U+7259,U+731b,U+73a9,U+73bb,U+74dc,U+7532,U+7545,U+755c,U+75c7,U+7687,U+76d7,U+76f2,U+788d,U+78e8,U+79e6,U+79e9,U+7a3f,U+7a46,U+7a97,U+7af9,U+7bee,U+7c4d,U+7c89,U+7cd6,U+7eb5,U+7ebd,U+7ed8,U+8017,U+8033,U+80c0,U+80de,U+80f6,U+8138,U+817e,U+81a8,U+820d,U+827e,U+82b3,U+82d7,U+83b1,U+84c4,U+84dd,U+8584,U+864e,U+865a,U+866b,U+86cb,U+88d5,U+89e6,U+8bca,U+8bde,U+8bfa,U+8c0a,U+8c37,U+8c46,U+8c6a,U+8c8c,U+8d1d,U+8d29,U+8d4f,U+8d54,U+8d5a,U+8d60,U+8d62,U+8f7f,U+8f96,U+8f9e-8f9f,U+8fc1,U+8fdf,U+8fea,U+8ff7,U+9012,U+906d,U+9075,U+90a6,U+90bb,U+90ca,U+9178,U+9192,U+91ca,U+94bb,U+94dc,U+94fa,U+9501,U+950b,U+9521,U+955c,U+963b,U+9655,U+9675-9676,U+9887,U+9891,U+9971,U+9a97,U+9ece,U+9ed8"}},{uri:SUe,descriptors:{unicodeRange:"U+4e1d,U+4e39,U+4e4c,U+4e4f,U+4e54,U+4e58,U+4e95,U+4ea1,U+4eab,U+4eae,U+4ec1,U+4f10,U+4f19,U+4f30,U+4f34,U+4fb5,U+503e,U+518c,U+5192,U+51a0,U+51ac,U+51b0,U+51e1,U+5211,U+5242,U+52a3,U+52b2,U+52c3,U+52c7,U+52d2,U+52e4,U+5377,U+539a,U+53a6,U+53e5,U+5417,U+5510,U+552f,U+5531,U+574f-5750,U+5761,U+5851,U+5854,U+58ee,U+593a,U+5949,U+5954,U+5a5a,U+5b8b,U+5bbd,U+5c04,U+5c0a,U+5c4b,U+5ce1,U+5cf0,U+5e10,U+5e8a,U+5e9f,U+5ec9,U+5f31,U+5f84,U+5fd8-5fd9,U+5fe0,U+6015,U+6062,U+6069,U+6076,U+6089,U+60a3,U+60ca,U+620f,U+624e,U+6263,U+6298,U+62a2,U+62bd,U+6311,U+6350,U+6389,U+638c,U+63f4,U+6446,U+644a,U+6469,U+64cd,U+654f,U+6562,U+656c,U+65d7,U+65e6,U+65fa,U+660c,U+6653,U+66b4,U+670b,U+672b,U+676f-6770,U+6881,U+6885,U+68a6,U+68cb,U+68ee,U+6b8a,U+6c88-6c89,U+6cc9,U+6ce5,U+6d01,U+6d17,U+6d1b,U+6d59,U+6d6a,U+6da8,U+6df7,U+6e10,U+6e20-6e21,U+6f5c,U+706f,U+70bc,U+719f,U+7267,U+732a,U+73cd,U+7518,U+756a,U+7586,U+7591,U+75db,U+76c8,U+76d0,U+76d6,U+76d8,U+76df,U+76fe,U+77db,U+7801,U+786c,U+795d,U+7965,U+79cb,U+7a77,U+7a7f,U+7aef,U+7b11,U+7bb1,U+7bc7,U+7ea0,U+7eaf,U+7ed5,U+7edc,U+7f13,U+7f29,U+7f34,U+7f8a,U+7ffb,U+8015,U+8058,U+805a,U+8083,U+80af,U+80c6,U+80cc,U+811a,U+8150,U+82e5,U+8336,U+8352,U+83ab,U+8428,U+8463,U+852c,U+8861,U+89c8,U+8bcd,U+8bd7,U+8bda,U+8be2,U+8bef,U+8bf8,U+8c0b,U+8c13,U+8d34,U+8d3a,U+8d74,U+8d76,U+8da3,U+8dd1,U+8ddd,U+8ddf,U+8df3,U+8f68,U+8f6f,U+8f7d,U+8f91,U+8f9b,U+8fbd,U+8fc8,U+8fd4,U+8feb,U+8ff9,U+900f,U+9057,U+907f-9080,U+90d1,U+90ed,U+91ce,U+9519,U+9526,U+95ed,U+9614,U+9635,U+9644,U+9686,U+96c5,U+96ea,U+9707,U+9732,U+9759,U+978b,U+9876,U+9881,U+9910,U+996e,U+9970,U+9c81,U+9e21,U+9ebb,U+9f84"}},{uri:xUe,descriptors:{unicodeRange:"U+4e3d,U+4e4e,U+4e71,U+4e8f,U+4ed8,U+4eea,U+4f0a,U+4f0d,U+4f11,U+4f1f,U+4f24,U+4f3c,U+4f73,U+4fc4,U+500d,U+5012,U+501f,U+503a,U+505c,U+507f,U+50a8,U+514d,U+5178,U+517c,U+51b2,U+51b7,U+520a,U+5238,U+523b,U+52b1,U+535a,U+5371,U+5385,U+53eb-53ec,U+53f3,U+53f6,U+5409,U+542b,U+542f,U+5434,U+5462,U+5473,U+547c,U+54c8,U+54ea,U+56fa,U+5733,U+5757,U+5766,U+5802,U+585e,U+590f,U+591c,U+591f,U+5947,U+594b,U+5987,U+5a01,U+5b59,U+5b63,U+5b88,U+5b97,U+5b9c,U+5bbe,U+5bfb,U+5c01,U+5c1a,U+5c24,U+5c3c,U+5c97,U+5c9b,U+5cb8,U+5de6,U+5e01,U+5e2e,U+5e45,U+5e55,U+5e84,U+5ef6,U+5f02,U+5f52,U+5f69,U+5f7b,U+5f90,U+5fae,U+6000,U+600e,U+6025,U+60e0,U+6276,U+6297,U+62b5,U+62cd,U+62d3,U+62e5,U+62e9,U+62ff,U+6302,U+632f,U+63e1,U+6444,U+64ad,U+653b,U+6551,U+6563,U+65a4,U+65e7,U+6620,U+667a,U+66f2,U+671d,U+6731,U+6742,U+675f,U+6768,U+677e-677f,U+6790,U+67b6,U+67d3,U+6863,U+68b0,U+68c9,U+690d,U+6b8b,U+6bcd,U+6bd2,U+6bd5,U+6c38,U+6c61,U+6cbf,U+6cdb,U+6cf0,U+6d2a,U+6d89,U+6da6,U+6f6e,U+6fb3,U+7075,U+707e,U+70df,U+7164,U+7236,U+725b,U+7389,U+73e0,U+745e,U+74e6,U+751a,U+7537,U+75be,U+76ae,U+76db,U+793c,U+7956,U+7981,U+79d8,U+79df,U+79fb,U+7adf,U+7ae5,U+7b14,U+7b26,U+7b54,U+7b79,U+7d2f,U+7eb8,U+7eba,U+7ec6,U+7ee9,U+7eff,U+7f5a,U+7f6a,U+7f72,U+8089,U+80a5,U+80e1,U+8111,U+8131,U+821e,U+822c,U+8270,U+8499,U+8651,U+867d,U+8840,U+8857,U+8863,U+88c1,U+89c9,U+89d2,U+8a89,U+8bed,U+8bfe,U+8c01,U+8c22,U+8d21,U+8d25,U+8d2f,U+8d5e,U+8d75,U+8d8b,U+8dc3,U+8de8,U+8df5,U+8f6e,U+8f86,U+8f89,U+8fc5,U+8ff0,U+8ffd,U+9014,U+904d,U+90ae,U+9274,U+949f,U+952e,U+969c,U+96c4,U+96e8,U+96f6-96f7,U+97e9,U+987f,U+996d,U+9a7b,U+9aa8,U+9c7c,U+9c9c,U+9e4f,U+9f13,U+9f50"}},{uri:AUe,descriptors:{unicodeRange:"U+4e13,U+4e16,U+4e1c,U+4e24,U+4e3e,U+4e49,U+4e61,U+4e66,U+4e89,U+4e8c,U+4e94,U+4e9b,U+4ea4,U+4eac,U+4ebf,U+4eca,U+4ef6-4ef7,U+4efb,U+4f18,U+4f20,U+4f46,U+4f7f,U+4fe1,U+503c,U+505a,U+5146,U+5148,U+515a,U+5171,U+5177,U+519b,U+51b3,U+51c6,U+51e0,U+5212,U+521b,U+522b,U+529e,U+52bf,U+534e-534f,U+5355,U+5357,U+5382,U+539f,U+53bb,U+53bf,U+53c2,U+53c8,U+53ca,U+53d6-53d8,U+53e3,U+53ea,U+53f0,U+540d,U+5411,U+56db,U+56de,U+56e0,U+56e2,U+578b,U+57ce,U+57fa,U+589e,U+5904,U+5934,U+5982,U+5b89,U+5b8c,U+5bfc,U+5c06,U+5c11,U+5c40,U+5c71,U+5e38,U+5e72,U+5e76,U+5e7f,U+5e94,U+5e9c,U+5f0f,U+5f15,U+5f20,U+5f3a,U+5f62,U+5f88,U+5fc5,U+5fd7,U+5feb,U+601d,U+6027,U+60c5,U+60f3,U+610f,U+6216,U+6218,U+624b,U+624d,U+6279,U+628a,U+6295,U+6301,U+6307,U+636e,U+63a5,U+63a8,U+652f,U+6536,U+653e,U+6548,U+6559,U+6570,U+65bd,U+65e0,U+6602,U+660e,U+6613,U+66f4,U+6700,U+670d,U+671f,U+672f,U+6743,U+674e,U+6751,U+6761,U+6784,U+6797,U+679c,U+67e5,U+6807,U+6837,U+683c,U+6b21,U+6b63-6b65,U+6bcf,U+6bd4,U+6c42,U+6c5f,U+6ca1,U+6cbb,U+6d3b,U+6d41,U+6d88,U+6df1,U+70b9,U+7136,U+7269,U+7279,U+7531,U+754c,U+767e,U+76ca,U+76f8,U+770b,U+7740,U+7814,U+79ef,U+7a0b,U+7a0e,U+7a76,U+7b80,U+7cbe,U+7cfb,U+7e41,U+7ea7,U+7ec4,U+7ec7,U+7ed3,U+7ed9,U+7edf,U+7f8e,U+8001,U+804c,U+8054,U+80b2,U+81f3,U+8425,U+8868,U+88ab,U+897f,U+89c1-89c2,U+89c4,U+89c6,U+89e3,U+8ba1,U+8ba4,U+8bae,U+8bb0,U+8bba,U+8bc1,U+8c03,U+8d28,U+8d39,U+8def,U+8f66,U+8f6c,U+8fd0-8fd1,U+9020,U+9053,U+90a3,U+90fd,U+91cc,U+9500,U+9547,U+95e8,U+95f4,U+961f,U+9645,U+9662,U+96be,U+96c6,U+9700,U+9769,U+97e6,U+9875,U+9879,U+9886,U+9898,U+98ce,U+9996,U+2b5af,U+2cc56,U+2e9f5,U+30edd-30ede"}},{uri:MUe,descriptors:{unicodeRange:"U+4e03,U+4e30,U+4e34,U+4e45,U+4e60,U+4e70,U+4e88,U+4e91-4e92,U+4ea9,U+4eb2,U+4ec0,U+4ecb,U+4ecd,U+4ee4,U+4fee,U+5019,U+5047,U+50cf,U+5145,U+516d,U+5170,U+5175,U+5199,U+51cf,U+51fb,U+521a,U+5224,U+5267,U+52aa,U+5347-5348,U+534a,U+5356,U+5361,U+536b,U+5370,U+538b,U+53e4,U+53e6,U+5403,U+5426,U+5428,U+542c,U+5438,U+5668,U+56ed,U+56f4,U+56fe,U+57df,U+592a,U+5957,U+5b69,U+5b81,U+5b8f,U+5b98,U+5b9d,U+5ba1,U+5ba4,U+5bb3,U+5bc6,U+5bdf,U+5c3d,U+5c5e,U+5c81,U+5ddd,U+5de8,U+5dee,U+5e0c,U+5e86,U+5e8f,U+5e93,U+5e95,U+5e97,U+5ea7,U+5ead,U+5eb7,U+5f55,U+5f81,U+5f85,U+5ff5,U+6001,U+613f,U+6258,U+6267,U+6269,U+626c,U+627e,U+62db,U+62ec,U+6325,U+635f,U+6362,U+6388,U+6392,U+63a2,U+63a7,U+63aa,U+641e,U+6545,U+6597,U+65e2,U+65e9,U+661f,U+665a,U+666e-666f,U+66fe,U+6728,U+67d0,U+6811,U+6838,U+6865,U+697c,U+6b22,U+6b27,U+6b4c,U+6b62,U+6b66,U+6b7b,U+6bdb,U+6c47,U+6c49,U+6c7d,U+6c99,U+6cfd,U+6d0b,U+6d25,U+6d32,U+6d3e,U+6d4b,U+6e29,U+6e56,U+6e7e,U+6f14,U+6fc0,U+706b,U+70c8,U+7247,U+72af,U+72b6,U+72ec,U+732e,U+73ed,U+7403,U+7533,U+753b,U+7559,U+7565,U+7597,U+767b,U+773c,U+7763,U+77ed,U+77ff,U+7968,U+798f,U+79bb,U+79c0-79c1,U+7ad9,U+7ae0,U+7b51,U+7b7e,U+7cae,U+7d22,U+7ea2,U+7eb3,U+7eb7,U+7ec3,U+7ec8,U+7ecd,U+7edd,U+7efc,U+7f16,U+7f3a,U+7f51,U+7f57,U+7f6e,U+80dc,U+822a,U+8239,U+826f,U+82cf,U+82e6,U+8349,U+8363,U+83dc,U+8457,U+85cf,U+878d,U+8865,U+8a00,U+8b66,U+8ba2,U+8ba8,U+8bad,U+8bb2,U+8bc9,U+8bd5,U+8bfb,U+8d2b,U+8d35,U+8d37,U+8f7b,U+8f93,U+8fce,U+8fdd,U+9000-9002,U+9010,U+9047,U+9093,U+9152,U+9488,U+94a2,U+9633,U+9636,U+963f,U+9646,U+9648,U+964d,U+9664,U+9669,U+9760,U+97f3,U+987a,U+987e,U+9884,U+98de,U+9986,U+9ed1"}},{uri:kUe,descriptors:{unicodeRange:"U+4e14,U+4e25,U+4e48,U+4e50,U+4e5d,U+4e9a,U+4ec5,U+4efd,U+4f17,U+4f4e-4f4f,U+4f55,U+4f59,U+4f60,U+4f8b,U+4f9b,U+4f9d,U+4fbf,U+4fc3,U+5065,U+513f,U+5149,U+514b,U+516b,U+5174,U+517b,U+518d,U+51b5,U+5207,U+5217-5219,U+521d,U+526f,U+529f,U+52a9,U+52b3,U+5305,U+533b,U+5343,U+5360,U+5373-5374,U+5386,U+53cb-53cd,U+53f2,U+53f7,U+544a,U+5468,U+547d,U+54cd,U+552e,U+5584,U+56f0,U+571f,U+5747,U+575a,U+57f9,U+5883,U+58eb,U+58f0,U+5907,U+590d,U+592e,U+5931,U+5956,U+5965,U+5973,U+5979,U+59cb,U+5b57-5b58,U+5b83,U+5ba2-5ba3,U+5bb9,U+5bcc,U+5c42,U+5c45,U+5c4a,U+5dde,U+5df1,U+5df4,U+5e03,U+5e08,U+5e26,U+5e2d,U+5f71,U+5f80,U+5f8b,U+5fb7,U+606f,U+611f,U+6237,U+623f,U+6253,U+627f,U+6293,U+62a4,U+62c5,U+62c9,U+6309,U+6574,U+6599,U+65ad,U+65af,U+65c5,U+65cf,U+6625,U+663e,U+671b,U+672a,U+6750,U+6781,U+6821,U+6839,U+6848,U+68c0,U+6a21,U+6b3e,U+6bb5,U+6c14,U+6cb3,U+6cb9,U+6ce8,U+6e05,U+6e2f,U+6e38,U+6e90,U+6ee1,U+70ed,U+7167,U+7231,U+7248,U+724c,U+7387,U+738b,U+73af,U+7530,U+75c5,U+767d,U+76d1,U+76f4,U+771f,U+77e5,U+77f3,U+7834,U+7840,U+786e,U+793a,U+795e,U+79f0,U+7a33,U+7a7a,U+7a81,U+7ade,U+7b56,U+7b97,U+7c73,U+7c7b,U+7d20,U+7d27,U+7ea6,U+7eaa,U+7ebf,U+7ee7,U+7eed,U+7ef4,U+7fa4,U+8003,U+80a1,U+81f4,U+8272,U+827a,U+8282,U+82b1,U+82f1,U+8303,U+836f,U+83b7,U+843d,U+88c5,U+8ba9,U+8baf,U+8bb8,U+8bbf,U+8bc4,U+8bc6,U+8bdd,U+8be5,U+8bf7,U+8c08,U+8c61,U+8d1f,U+8d22-8d23,U+8d27,U+8d2d,U+8d38,U+8d5b,U+8d70,U+8d85,U+8d8a,U+8db3,U+8eab,U+8f83,U+8fb9,U+8fdc,U+8fde,U+9009,U+901f,U+914d,U+91c7,U+94b1,U+94c1,U+94f6,U+95fb,U+9632,U+9650,U+968f,U+9752,U+975e,U+987b,U+989d,U+98df,U+9999,U+9a6c,U+9a8c,U+9ec4,U+9feb-9fec"}},{uri:RUe,descriptors:{unicodeRange:"U+98fb-990c,U+990e-990f,U+9911-992d,U+992f-9953,U+9956-9962,U+9964,U+9966,U+9973,U+9978-9979,U+997b,U+997e,U+9982-9983,U+9989,U+998c,U+998e,U+999a-99a4,U+99a6-99a7,U+99a9-99c8"}},{uri:DUe,descriptors:{unicodeRange:"U+8e4c-8e50,U+8e53-8e58,U+8e5a-8e65,U+8e67-8e68,U+8e6a-8e6b,U+8e6e,U+8e71,U+8e73,U+8e75,U+8e77-8e7b,U+8e7d-8e7e,U+8e80,U+8e82-8e84,U+8e86,U+8e88-8e8e,U+8e91-8e93,U+8e95-8e9b,U+8e9d,U+8e9f-8eaa,U+8ead-8eae,U+8eb0-8eb1,U+8eb3-8eb9,U+8ebb-8ecd,U+8ecf-8f02"}},{uri:LUe,descriptors:{unicodeRange:"U+2e3a,U+3001-3002,U+3008-3011,U+3014-3017,U+301d-301f,U+4dae,U+4e00,U+4e07,U+4e09-4e0b,U+4e0d-4e0e,U+4e1a,U+4e2a,U+4e2d,U+4e3a-4e3b,U+4e4b,U+4e5f,U+4e86,U+4e8b,U+4e8e,U+4ea7,U+4eba,U+4ece,U+4ed1,U+4ed6,U+4ee3,U+4ee5,U+4eec,U+4f01,U+4f1a,U+4f4d,U+4f53,U+4f5c,U+4fdd,U+5143,U+5165,U+5168,U+516c,U+5173,U+5176,U+5185,U+519c,U+51fa,U+5206,U+5229,U+5230,U+5236,U+524d,U+529b,U+52a0-52a1,U+52a8,U+5316-5317,U+533a,U+5341,U+5362,U+53d1,U+53ef,U+53f8,U+5404,U+5408,U+540c,U+540e,U+5458,U+548c,U+54c1,U+54e5,U+5546,U+559c,U+56fd,U+5728,U+5730,U+573a,U+5916,U+591a,U+5927,U+5929,U+592b,U+597d,U+59d4,U+5b50,U+5b66,U+5b9a,U+5b9e,U+5bb6,U+5bf9,U+5c0f,U+5c14,U+5c31,U+5c55,U+5de5,U+5df2,U+5e02,U+5e73-5e74,U+5ea6,U+5efa,U+5f00,U+5f53,U+5f97,U+5fc3,U+603b,U+6210-6211,U+6240,U+6280,U+62a5,U+63d0,U+6539,U+653f,U+6587,U+65b0,U+65b9,U+65e5,U+65f6,U+662f,U+6708-6709,U+672c,U+673a,U+675c,U+6765,U+6c11,U+6c34,U+6cd5,U+6ce2,U+6d4e,U+6d77,U+73b0,U+7406,U+751f,U+7528,U+7535,U+7684,U+76ee,U+793e,U+79cd,U+79d1,U+7acb,U+7b2c,U+7b49,U+7ba1,U+7ecf,U+8005,U+800c,U+80fd,U+81ea,U+884c,U+8981,U+8bbe,U+8bf4,U+8d44,U+8d77,U+8fbe,U+8fc7,U+8fd8-8fd9,U+8fdb,U+901a,U+90e8,U+91cd,U+91cf,U+91d1,U+9485,U+957f,U+95ee,U+9762,U+9ad8,U+9ea6,U+9f99,U+9fcf,U+9fd4,U+9fed,U+fe10-fe19,U+fe30-fe31,U+fe33-fe44,U+ff01,U+ff0c,U+ff1f,U+2b4e7,U+2b7f7,U+2b7fc,U+2cb2d,U+2cb3b,U+2cb4a,U+2cb5b,U+2cb73"}},{uri:NUe,descriptors:{unicodeRange:"U+6490,U+6493-6494,U+6497-6498,U+649a-649d,U+649f-64a3,U+64a5-64a8,U+64aa-64ab,U+64af,U+64b1-64b4,U+64b6,U+64b9,U+64bb,U+64bd-64bf,U+64c1,U+64c3-64c4,U+64c6-64cc,U+64cf,U+64d1,U+64d3-64d6,U+64d9-64dd,U+64df-64e1,U+64e3,U+64e5,U+64e7-64ff,U+6501-6508,U+650a-6511,U+6513-6517,U+6519-6524,U+6526-652a,U+652c-652d,U+6530-6533,U+6537,U+653a,U+653c-653d,U+6540-6544,U+6546-6547,U+654a-654b,U+654d-654e,U+6550,U+6552-6554,U+6557-6558,U+655a,U+655c,U+655f-6561,U+6564-6565,U+6567-6568"}},{uri:OUe,descriptors:{unicodeRange:"U+9695-9696,U+969a-969b,U+969d-96a6,U+96a8-96af,U+96b1-96b2,U+96b4-96b5,U+96b7-96b8,U+96ba-96bb,U+96bf,U+96c2-96c3,U+96c8,U+96ca-96cb,U+96d0-96d1,U+96d3-96d4,U+96d6-96df,U+96e1-96e7,U+96eb-96ee,U+96f0-96f2,U+96f4-96f5,U+96f8,U+96fa-96fd,U+96ff,U+9702-9703,U+9705,U+970a-970c,U+9710-9712,U+9714-9715,U+9717-971b,U+971d,U+971f-9729,U+972b-972c,U+972e-972f,U+9731,U+9733-9737,U+973a-973d,U+973f-9751,U+9754-9755,U+9757-9758,U+975a,U+975c-975d,U+975f,U+9763-9764,U+9766-9768,U+976a-9770"}},{uri:PUe,descriptors:{unicodeRange:"U+6af0-6b1f,U+6b25-6b26,U+6b28-6b31,U+6b33-6b36,U+6b38,U+6b3b-6b3d,U+6b3f-6b42,U+6b44-6b45,U+6b48,U+6b4a-6b4b,U+6b4d-6b58,U+6b5a-6b61,U+6b68-6b69,U+6b6b-6b78,U+6b7a,U+6b7d-6b80,U+6b85,U+6b88,U+6b8c,U+6b8e-6b91,U+6b94-6b95,U+6b97-6b99,U+6b9c-6ba0,U+6ba2-6ba9,U+6bab-6bb2,U+6bb6,U+6bb8-6bba"}},{uri:FUe,descriptors:{unicodeRange:"U+430e-439a,U+29e8a,U+29ec4,U+29edb,U+29ee9,U+29f7e,U+29f83,U+29f8c,U+29fce,U+2a01a,U+2a02f,U+2a082,U+2a0f9,U+2a190,U+2a38c"}},{uri:BUe,descriptors:{unicodeRange:"U+92ef-933d,U+933f-9369,U+936b-9388"}},{uri:zUe,descriptors:{unicodeRange:"U+4512-458d,U+2b300,U+2b363,U+2b36f,U+2b372,U+2b37d,U+2b404,U+2b410,U+2b413,U+2b461,U+2b4ef,U+2b4f6,U+2b4f9,U+2b50d-2b50e,U+2b536,U+2b5ae,U+2b5b3,U+2b5e7,U+2b5f4,U+2b61c-2b61d,U+2b626-2b628,U+2b62a,U+2b62c,U+2b695-2b696,U+2b6ad,U+2b6ed"}},{uri:HUe,descriptors:{unicodeRange:"U+88bd-88c0,U+88c3-88c4,U+88c7-88c8,U+88ca-88cd,U+88cf-88d1,U+88d3,U+88d6-88d7,U+88da-88de,U+88e0-88e1,U+88e6-88e7,U+88e9-88ef,U+88f2,U+88f5-88f7,U+88fa-88fb,U+88fd,U+88ff-8901,U+8903-8909,U+890b-890f,U+8911,U+8914-8918,U+891c-8920,U+8922-8924,U+8926-8929,U+892c-892f,U+8931-8933,U+8935,U+8937-8940,U+8942-8943,U+8945-895d,U+8960-8965,U+8967-897a,U+897c-897e,U+8980,U+8982,U+8984-8985"}},{uri:I0e,descriptors:{unicodeRange:"U+4b0b-4ba0"}},{uri:VUe,descriptors:{unicodeRange:"U+7179,U+717b-717c,U+717e-7183,U+7185-7189,U+718b-718e,U+7190-7193,U+7195-7197,U+719a-719e,U+71a1-71a7,U+71a9-71ab,U+71ad-71b2,U+71b4,U+71b6-71b8,U+71ba-71c2,U+71c4-71cd,U+71cf-71d3,U+71d6-71df,U+71e1-71e4,U+71e6,U+71e8-71ed,U+71ef-71f8,U+71fa-7205,U+7207-721c,U+721e-7227,U+7229,U+722b,U+722d"}},{uri:$Ue,descriptors:{unicodeRange:"U+982e-9874,U+988b,U+988e,U+9892,U+9895,U+9899,U+98a3,U+98a8-98cd,U+98cf-98d0,U+98d4,U+98d6-98d7,U+98db-98dd,U+98e0-98e6,U+98e9-98fa"}},{uri:GUe,descriptors:{unicodeRange:"U+7c14-7c15,U+7c17-7c1e,U+7c20-7c25,U+7c28-7c29,U+7c2b-7c37,U+7c39-7c3e,U+7c42-7c4c,U+7c4e-7c72,U+7c75-7c7a,U+7c7e-7c88,U+7c8a-7c90,U+7c93-7c94,U+7c96,U+7c99-7c9b,U+7ca0-7ca1,U+7ca3,U+7ca6-7ca9,U+7cab-7cad,U+7caf-7cb0,U+7cb4-7cb8,U+7cba-7cbb,U+7cbf-7cc0,U+7cc2-7cc4,U+7cc6,U+7cc9,U+7ccb,U+7cce-7cd4"}},{uri:XUe,descriptors:{unicodeRange:"U+7d95-7da5,U+7da7-7dad,U+7daf-7e2a"}},{uri:jUe,descriptors:{unicodeRange:"U+4a78-4b0a"}},{uri:YUe,descriptors:{unicodeRange:"U+9b30-9b31,U+9b33-9b3a,U+9b3d-9b40,U+9b46,U+9b4a-9b4c,U+9b4e,U+9b50,U+9b52-9b53,U+9b55-9bcf"}},{uri:WUe,descriptors:{unicodeRange:"U+6a4b-6a4f,U+6a51-6a57,U+6a5a,U+6a5c-6a60,U+6a62-6a64,U+6a66-6a70,U+6a72-6a78,U+6a7a-6a7b,U+6a7d-6a7f,U+6a81-6a83,U+6a85-6a8d,U+6a8f,U+6a92-6a96,U+6a98-6a9f,U+6aa1-6aa8,U+6aaa,U+6aad-6aef"}},{uri:KUe,descriptors:{unicodeRange:"U+99c9-9a53"}},{uri:ZUe,descriptors:{unicodeRange:"U+8550-8555,U+8557-8558,U+855a-855d,U+855f-8563,U+8565-8567,U+8569-8571,U+8573,U+8575-8578,U+857c-857d,U+857f-8583,U+8586,U+8588-858e,U+8590-859a,U+859d-85a3,U+85a5-85a7,U+85a9,U+85ab-85ad,U+85b1-85b6,U+85b8,U+85ba-85c0,U+85c2-85c8,U+85ca-85ce,U+85d1-85d2,U+85d4,U+85d6-85db,U+85dd-85e3,U+85e5-85e8,U+85ea-85fa,U+85fc-85fe,U+8600-8603"}},{uri:qUe,descriptors:{unicodeRange:"U+6fb2,U+6fb4-6fb5,U+6fb7-6fb8,U+6fba-6fbf,U+6fc1,U+6fc3-6fc8,U+6fca-6fd0,U+6fd3-6fdd,U+6fdf,U+6fe2-6fed,U+6ff0-7010,U+7012-7019,U+701c-7022,U+7024-7034,U+7036-7038,U+703a-704b,U+704d-704e,U+7050-7053"}},{uri:QUe,descriptors:{unicodeRange:"U+4ba1-4c2c"}},{uri:JUe,descriptors:{unicodeRange:"U+9a54-9a6b,U+9a72,U+9a83,U+9a89,U+9a8d-9a8e,U+9a94-9a95,U+9a99,U+9aa6,U+9aa9-9aaf,U+9ab2-9ab5,U+9ab9,U+9abb,U+9abd-9abf,U+9ac3-9ac4,U+9ac6-9aca,U+9acd-9ad0,U+9ad2,U+9ad4-9ad7,U+9ad9-9ade,U+9ae0,U+9ae2-9ae5,U+9ae7-9aea,U+9aec,U+9aee,U+9af0-9af8,U+9afa,U+9afc-9b02,U+9b04-9b07,U+9b09-9b0e,U+9b10-9b12,U+9b14-9b1e,U+9b20-9b22,U+9b24-9b2e"}},{uri:e2e,descriptors:{unicodeRange:"U+9d1a-9da1"}},{uri:t2e,descriptors:{unicodeRange:"U+9e13-9e1e,U+9e24,U+9e27,U+9e2e,U+9e30,U+9e34,U+9e3b-9e3c,U+9e40,U+9e4d,U+9e50,U+9e52-9e54,U+9e56,U+9e59,U+9e5d,U+9e5f-9e62,U+9e65,U+9e6e-9e6f,U+9e72,U+9e74-9e7d,U+9e80-9e81,U+9e83-9e86,U+9e89-9e8a,U+9e8c-9e91,U+9e94-9e9c,U+9e9e,U+9ea0-9ea5,U+9ea7-9eb3,U+9eb5-9eb7,U+9eb9-9eba,U+9ebc,U+9ebf-9ec3,U+9ec5-9ec8,U+9eca-9ecc,U+9ed0,U+9ed2-9ed3,U+9ed5-9ed7,U+9ed9-9eda,U+9ede,U+9ee1,U+9ee3-9ee4,U+9ee6,U+9ee8,U+9eeb-9eee,U+9ef0-9ef8"}},{uri:n2e,descriptors:{unicodeRange:"U+8b1c-8b25,U+8b27-8b65,U+8b67-8b6b,U+8b6d-8b9f,U+8bac,U+8bb1,U+8bbb,U+8bc7,U+8bd0"}},{uri:i2e,descriptors:{unicodeRange:"U+4cad-4d2f"}},{uri:s2e,descriptors:{unicodeRange:"U+9c4b-9c7b,U+9c7d-9c7e,U+9c80,U+9c83-9c84,U+9c89-9c8a,U+9c8c,U+9c8f,U+9c93,U+9c96-9c99,U+9c9d,U+9caa,U+9cac,U+9caf,U+9cb9,U+9cbe-9cc2,U+9cc8-9cc9,U+9cd1-9cd2,U+9cda-9cdb,U+9ce0-9ce1,U+9ce3-9d19"}},{uri:r2e,descriptors:{unicodeRange:"U+9389-938e,U+9390-93c9,U+93cb-93d5,U+93d7-9410"}},{uri:CUe,descriptors:{unicodeRange:"U+20a0-20b5,U+20b9-20ba,U+20bc-20bd,U+4e2c,U+5107,U+5216,U+5293,U+54f3,U+5523,U+5819,U+5adc,U+5c88,U+5e3b,U+5fee,U+62f6,U+63be,U+6484,U+6499,U+67d9,U+67dd,U+6d5e,U+6f46,U+717a,U+71e0,U+72c1,U+73e7,U+75b0,U+7603,U+7722,U+7809,U+7811,U+7946,U+7967,U+799a,U+7b45,U+7ba2,U+8014,U+80d9,U+8159,U+817d,U+81a3,U+81aa,U+8201,U+833c,U+836e,U+83e5,U+8459,U+84f0,U+8729,U+8753,U+87d3,U+89dc,U+8bf6,U+8c2e,U+8e2c,U+8e9c,U+8e9e,U+8ece,U+8fee,U+9139,U+914f,U+9174,U+9191,U+960c,U+9622,U+9a98,U+9b48,U+9ca6,U+9cb0,U+9da2-9e12,U+9e88,U+9f44,U+9f86"}},{uri:o2e,descriptors:{unicodeRange:"U+9bd0-9c4a"}},{uri:a2e,descriptors:{unicodeRange:"U+4c2d-4cac"}},{uri:l2e,descriptors:{unicodeRange:"U+4d30-4dab"}},{uri:c2e,descriptors:{unicodeRange:"U+9411-943d,U+943f-946a,U+946c-9484"}},{uri:u2e,descriptors:{unicodeRange:"U+9efa,U+9efd,U+9eff-9f0a,U+9f0c,U+9f0f,U+9f11-9f12,U+9f14-9f16,U+9f18,U+9f1a-9f1f,U+9f21,U+9f23-9f2b,U+9f2d-9f2e,U+9f30-9f36,U+9f38,U+9f3a,U+9f3c,U+9f3f-9f43,U+9f45-9f4f,U+9f52-9f7e,U+9f81-9f82,U+9f8d-9f94"}},{uri:d2e,descriptors:{unicodeRange:"U+7e2b-7e3a,U+7e3c-7e40,U+7e42-7e46,U+7e48-7e81,U+7e83-7e9a,U+7e9c-7e9e,U+7eae,U+7eb4,U+7ebb-7ebc,U+7ed6,U+7ee4,U+7eec,U+7ef9,U+7f0a,U+7f10,U+7f1e,U+7f37,U+7f39,U+7f3b"}}],qe=class qe{constructor(t){F(this,"scene");F(this,"getSceneFamilies",()=>qe.getUniqueFamilies(this.scene.getNonDeletedElements()));F(this,"onLoaded",t=>{let n=!0;for(const r of t){const o=`${r.family}-${r.style}-${r.weight}-${r.unicodeRange}`;qe.loadedFontsCache.has(o)||(qe.loadedFontsCache.add(o),n=!1)}if(n)return;let i=!1;const s=this.scene.getNonDeletedElementsMap();for(const r of this.scene.getNonDeletedElements())if(de(r)){i=!0,Zt.delete(r),yp.clearCache(gt(r));const o=jn(r,s);o&&Zt.delete(o)}i&&this.scene.triggerUpdate()});F(this,"loadSceneFonts",async()=>{const t=this.getSceneFamilies(),n=qe.getCharsPerFamily(this.scene.getNonDeletedElements());return qe.loadFontFaces(t,n)});this.scene=t}static get registered(){return qe._registered?qe._initialized||(qe._registered=new Map([...qe.init().entries(),...qe._registered.entries()])):qe._registered=qe.init(),qe._registered}get registered(){return qe.registered}static async generateFontFaceDeclarations(t){const n=qe.getUniqueFamilies(t),i=qe.getCharsPerFamily(t),s=n.find(l=>iB(l).includes(Ff));if(s){const l=qe.getCharacters(i,s);if(wae(l)){const c=Bf[Ff];i[c]=new Set(l),n.unshift(Bf[Ff])}}const r=qe.fontFacesStylesGenerator(n,i),o=3,a=await new bA(r,o).all();return Array.from(new Set(a))}static async loadFontFaces(t,n){for(const{fontFaces:o,metadata:a}of qe.registered.values())if(!a.local)for(const{fontFace:l}of o)window.document.fonts.has(l)||window.document.fonts.add(l);const i=qe.fontFacesLoader(t,n),s=10;return(await new bA(i,s).all()).flat().filter(Boolean)}static*fontFacesLoader(t,n){for(const[i,s]of t.entries()){const r=gt({fontFamily:s,fontSize:16}),o=qe.getCharacters(n,s);window.document.fonts.check(r,o)||(yield Pc(async()=>{var a;try{const l=await window.document.fonts.load(r,o);return[i,l]}catch(l){console.error(`Failed to load font "${r}" from urls "${(a=qe.registered.get(s))==null?void 0:a.fontFaces.map(c=>c.urls)}"`,l)}}))}}static*fontFacesStylesGenerator(t,n){for(const[i,s]of t.entries()){const{fontFaces:r,metadata:o}=qe.registered.get(s)??{};if(!Array.isArray(r)){console.error(`Couldn't find registered fonts for font-family "${s}"`,qe.registered);continue}if(!(o!=null&&o.local))for(const[a,l]of r.entries())yield Pc(async()=>{try{const c=qe.getCharacters(n,s),u=await l.toCSS(c);return u?[i*1e4+a,u]:void 0}catch(c){console.error(`Couldn't transform font-face to css for family "${l.fontFace.family}"`,c)}})}}static register(t,n,...i){const s=et[t]??Bf[t];return this.registered.get(s)||this.registered.set(s,{metadata:n,fontFaces:i.map(({uri:o,descriptors:a})=>new dv(t,o,a))}),this.registered}static init(){const t={registered:new Map},n=(i,...s)=>{const r=et[i]??Bf[i],o=Nh[r]??Nh[et.Excalifont];qe.register.call(t,i,o,...s)};return n("Cascadia",...B1e),n("Comic Shanns",...G1e),n("Excalifont",...s0e),n("Helvetica",...r0e),n("Liberation Sans",...a0e),n("Lilita One",...u0e),n("Nunito",...p0e),n("Virgil",...b0e),n(Ff,...f2e),n(sm,...X1e),qe._initialized=!0,t.registered}static getUniqueFamilies(t){return Array.from(t.reduce((n,i)=>(de(i)&&n.add(i.fontFamily),n),new Set))}static getCharsPerFamily(t){const n={};for(const i of t)if(de(i))for(const s of i.originalText)n[i.fontFamily]||(n[i.fontFamily]=new Set),n[i.fontFamily].add(s);return n}static getCharacters(t,n){return t[n]?Array.from(t[n]).join(""):""}static getAllFamilies(){return Array.from(qe.registered.keys())}};F(qe,"loadedFontsCache",new Set),F(qe,"_registered"),F(qe,"_initialized",!1),F(qe,"loadElementsFonts",async t=>{const n=qe.getUniqueFamilies(t),i=qe.getCharsPerFamily(t);return qe.loadFontFaces(n,i)});let Qa=qe;const N$=ae.forwardRef(({className:e,placeholder:t,onChange:n},i)=>N("div",{className:re("QuickSearch__wrapper",e),children:[pd,g("input",{ref:i,className:"QuickSearch__input",type:"text",placeholder:t,onChange:s=>n(s.target.value.trim().toLowerCase())})]})),O$=({className:e,placeholder:t,children:n})=>{const i=!D.Children.count(n);return g("div",{className:re("ScrollableList__wrapper",e),role:"menu",children:i?g("div",{className:"empty",children:t}):n})},L6=({children:e,className:t="",style:n,title:i})=>N("div",{className:`dropdown-menu-group ${t}`,style:n,children:[i&&g("p",{className:"dropdown-menu-group-title",children:i}),e]});L6.displayName="DropdownMenuGroup";const P$=({children:e,...t})=>g("span",{...t,style:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",...t.style},children:e}),F$=({textStyle:e,icon:t,shortcut:n,children:i})=>{const s=oi();return N(fe,{children:[t&&g("div",{className:"dropdown-menu-item__icon",children:t}),g("div",{style:e,className:"dropdown-menu-item__text",children:g(P$,{children:i})}),n&&!s.editor.isMobile&&g("div",{className:"dropdown-menu-item__shortcut",children:n})]})},B$=ae.createContext({}),z$=(e="",t=!1,n=!1)=>`dropdown-menu-item dropdown-menu-item-base ${e}
  ${t?"dropdown-menu-item--selected":""} ${n?"dropdown-menu-item--hovered":""}`.trim(),H$=(e,t)=>{const n=D.useContext(B$);return Y5(e,i=>{var r;const s=new CustomEvent(te.MENU_ITEM_SELECT,{bubbles:!0,cancelable:!0});t==null||t(s),s.defaultPrevented||(r=n.onSelect)==null||r.call(n,s)})},Ms=({icon:e,value:t,order:n,children:i,shortcut:s,className:r,hovered:o,selected:a,textStyle:l,onSelect:c,onClick:u,...d})=>{const f=H$(u,c),h=D.useRef(null);return D.useEffect(()=>{var m,p;o&&(n===0?(m=h.current)==null||m.scrollIntoView({block:"end"}):(p=h.current)==null||p.scrollIntoView({block:"nearest"}))},[o,n]),g("button",{...d,ref:h,value:t,onClick:f,className:z$(r,a,o),title:d.title??d["aria-label"],children:g(F$,{textStyle:l,icon:e,shortcut:s,children:i})})};Ms.displayName="DropdownMenuItem";const F1={GREEN:"green",RED:"red",BLUE:"blue"},mT=({type:e=F1.BLUE,children:t})=>{const{theme:n}=Op(),i={display:"inline-flex",marginLeft:"auto",padding:"2px 4px",borderRadius:6,fontSize:9,fontFamily:"Cascadia, monospace",border:n===ke.LIGHT?"1.5px solid white":"none"};switch(e){case F1.GREEN:Object.assign(i,{backgroundColor:"var(--background-color-badge)",color:"var(--color-badge)"});break;case F1.RED:Object.assign(i,{backgroundColor:"pink",color:"darkred"});break;case F1.BLUE:default:Object.assign(i,{background:"var(--color-promo)",color:"var(--color-surface-lowest)"})}return g("div",{className:"DropDownMenuItemBadge",style:i,children:t})};mT.displayName="DropdownMenuItemBadge";Ms.Badge=mT;const h2e=({event:e,inputRef:t,hoveredFont:n,filteredFonts:i,onClose:s,onSelect:r,onHover:o})=>{var a,l,c;if(!e[H.CTRL_OR_CMD]&&e.shiftKey&&e.key.toLowerCase()===H.F)return(a=t.current)==null||a.focus(),!0;if(e.key===H.ESCAPE)return s(),!0;if(e.key===H.ENTER)return n!=null&&n.value&&r(n.value),!0;if(e.key===H.ARROW_DOWN)return n!=null&&n.next?o(n.next.value):(l=i[0])!=null&&l.value&&o(i[0].value),!0;if(e.key===H.ARROW_UP)return n!=null&&n.prev?o(n.prev.value):(c=i[i.length-1])!=null&&c.value&&o(i[i.length-1].value),!0},g2e=e=>{switch(e){case et.Excalifont:case et.Virgil:return Sp;case et.Nunito:case et.Helvetica:return ev;case et["Lilita One"]:return Zde;case et["Comic Shanns"]:case et.Cascadia:return TV;default:return ev}},m2e=ae.memo(({selectedFontFamily:e,hoveredFontFamily:t,onSelect:n,onHover:i,onLeave:s,onOpen:r,onClose:o})=>{const{container:a}=Lr(),l=go(),{fonts:c}=l,{showDeprecatedFonts:u}=Np(),[d,f]=D.useState(""),h=D.useRef(null),m=D.useMemo(()=>Array.from(Qa.registered.entries()).filter(([S,{metadata:R}])=>!R.private&&!R.fallback).map(([S,{metadata:R,fontFaces:P}])=>{var X,G;const L={value:S,icon:g2e(S),text:((G=(X=P[0])==null?void 0:X.fontFace)==null?void 0:G.family)??"Unknown"};return R.deprecated&&Object.assign(L,{deprecated:R.deprecated,badge:{type:F1.RED,placeholder:M("fontList.badge.old")}}),L}).sort((S,R)=>S.text.toLowerCase()>R.text.toLowerCase()?1:-1),[]),p=D.useMemo(()=>new Set(c.getSceneFamilies()),[e]),U=D.useMemo(()=>m.filter(S=>p.has(S.value)),[m,p]),b=D.useMemo(()=>m.filter(S=>!p.has(S.value)&&(u||!S.deprecated)),[m,p,u]),y=D.useMemo(()=>Cre([...U,...b].filter(S=>{var R;return(R=S.text)==null?void 0:R.toLowerCase().includes(d)})),[U,b,d]),w=D.useMemo(()=>{var R;let S;return t?S=y.find(P=>P.value===t):e&&(S=y.find(P=>P.value===e)),!S&&d&&((R=y[0])!=null&&R.value?i(y[0].value):s()),S},[t,e,d,y,i,s]),v=D.useCallback(S=>{let R=null;if(l.state.editingTextElement){const P=document.querySelector(".excalidraw-wysiwyg");P&&(R={start:P.selectionStart,end:P.selectionEnd})}n(S),l.state.editingTextElement&&R&&setTimeout(()=>{const P=document.querySelector(".excalidraw-wysiwyg");P&&R&&(P.focus(),P.selectionStart=R.start,P.selectionEnd=R.end)},0)},[n,l.state.editingTextElement]),I=D.useCallback(S=>{h2e({event:S,inputRef:h,hoveredFont:w,filteredFonts:y,onSelect:v,onHover:i,onClose:o})&&(S.preventDefault(),S.stopPropagation())},[w,y,v,i,o]);D.useEffect(()=>(r(),()=>{o()}),[]);const C=D.useMemo(()=>y.filter(S=>p.has(S.value)),[y,p]),_=D.useMemo(()=>y.filter(S=>!p.has(S.value)),[y,p]),T=(S,R)=>N(Ms,{icon:S.icon,value:S.value,order:R,textStyle:{fontFamily:hp({fontFamily:S.value})},hovered:S.value===(w==null?void 0:w.value),selected:S.value===e,tabIndex:S.value===e?0:-1,onClick:P=>{v(Number(P.currentTarget.value))},onMouseMove:()=>{(w==null?void 0:w.value)!==S.value&&i(S.value)},children:[S.text,S.badge&&g(mT,{type:S.badge.type,children:S.badge.placeholder})]},S.value),k=[];return C.length&&k.push(g(L6,{title:M("fontList.sceneFonts"),children:C.map(T)},"group_1")),_.length&&k.push(g(L6,{title:M("fontList.availableFonts"),children:_.map((S,R)=>T(S,R+C.length))},"group_2")),N(Ig,{className:"properties-content",container:a,style:{width:"15rem"},onClose:()=>{o(),l.state.editingTextElement&&setTimeout(()=>{const S=document.querySelector(".excalidraw-wysiwyg");S&&S.focus()},0)},onPointerLeave:s,onKeyDown:I,preventAutoFocusOnTouch:!!l.state.editingTextElement,children:[l.state.stylesPanelMode==="full"&&g(N$,{ref:h,placeholder:M("quickSearch.placeholder"),onChange:sl(f,20)}),g(O$,{className:"dropdown-menu fonts manual-hover",placeholder:M("fontList.empty"),children:k.length?k:null})]})},(e,t)=>e.selectedFontFamily===t.selectedFontFamily&&e.hoveredFontFamily===t.hoveredFontFamily),p2e=({selectedFontFamily:e,isOpened:t=!1,compactMode:n=!1})=>{const i=xn(),s=n?{...dp,width:"2rem",height:"2rem"}:{};return g(_l,{asChild:!0,children:g("div",{"data-openpopup":"fontFamily",className:"properties-trigger",children:g(K_,{standalone:!0,icon:hh,title:M("labels.showFonts"),className:"properties-trigger",testId:"font-family-show-fonts",active:t,onClick:()=>{i(r=>({openPopup:r.openPopup==="fontFamily"?null:r.openPopup}))},style:{border:"none",...s}})})})},V$=[{value:et.Excalifont,icon:Sp,text:M("labels.handDrawn"),testId:"font-family-hand-drawn"},{value:et.Nunito,icon:ev,text:M("labels.normal"),testId:"font-family-normal"},{value:et["Comic Shanns"],icon:TV,text:M("labels.code"),testId:"font-family-code"}];new Set(V$.map(e=>e.value));const U2e=ae.memo(({isOpened:e,selectedFontFamily:t,hoveredFontFamily:n,onSelect:i,onHover:s,onLeave:r,onPopupChange:o,compactMode:a=!1})=>{const l=D.useMemo(()=>V$,[]),c=D.useCallback(u=>{u&&i(u)},[i]);return N("div",{role:"dialog","aria-modal":"true",className:re("FontPicker__container",{"FontPicker__container--compact":a}),children:[!a&&g("div",{className:"buttonList",children:g(la,{type:"button",options:l,value:t,onClick:c})}),!a&&g(k$,{}),N(wl,{open:e,onOpenChange:o,children:[g(p2e,{selectedFontFamily:t,isOpened:e,compactMode:a}),e&&g(m2e,{selectedFontFamily:t,hoveredFontFamily:n,onSelect:c,onHover:s,onLeave:r,onOpen:()=>o(!0),onClose:()=>o(!1)})]})]})},(e,t)=>e.isOpened===t.isOpened&&e.selectedFontFamily===t.selectedFontFamily&&e.hoveredFontFamily===t.hoveredFontFamily),wy=({className:e,icon:t,size:n="1em"})=>g("span",{className:e,style:{width:n,height:"100%",margin:"0 0.5ex 0 0.5ex",display:"inline-flex",lineHeight:0,verticalAlign:"middle",flex:"0 0 auto"},children:t}),fv=({label:e,open:t,openTrigger:n,children:i,className:s,showCollapsedIcon:r=!0})=>N(fe,{children:[N("div",{style:{cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center"},className:s,onClick:n,children:[e,r&&g(wy,{icon:t?Afe:MV})]}),t&&g("div",{style:{display:"flex",flexDirection:"column"},children:i})]}),b2e=Yt(!1);function y2e({options:e,value:t,label:n,onChange:i,onClose:s,numberOfOptionsToAlwaysShow:r=e.length}){const o=oi(),a=m=>{const p=e.find(U=>U.keyBinding===m.key.toLowerCase());if(!(m.metaKey||m.altKey||m.ctrlKey)&&p)i(p.value),m.preventDefault();else if(m.key===H.TAB){const U=e.findIndex(y=>y.value===t),b=m.shiftKey?(e.length+U-1)%e.length:(U+1)%e.length;i(e[b].value)}else if(L1(m.key)){const U=gm().rtl,b=e.findIndex(y=>y.value===t);if(b!==-1){const y=e.length;let w=b;switch(m.key){case(U?H.ARROW_LEFT:H.ARROW_RIGHT):w=(b+1)%y;break;case(U?H.ARROW_RIGHT:H.ARROW_LEFT):w=(y+b-1)%y;break;case H.ARROW_DOWN:{w=(b+(r??1))%y;break}case H.ARROW_UP:{w=(y+b-(r??1))%y;break}}i(e[w].value)}m.preventDefault()}else(m.key===H.ESCAPE||m.key===H.ENTER)&&(m.preventDefault(),s());m.nativeEvent.stopImmediatePropagation(),m.stopPropagation()},[l,c]=un(b2e),u=ae.useMemo(()=>e.slice(0,r),[e,r]),d=ae.useMemo(()=>e.slice(r),[e,r]);D.useEffect(()=>{u.some(m=>m.value===t)||c(!0)},[t,u,c]);const f=m=>g("div",{className:"picker-content",children:m.map((p,U)=>N("button",{type:"button",className:re("picker-option",{active:t===p.value}),onClick:b=>{i(p.value)},title:`${p.text} ${p.keyBinding&&` ${p.keyBinding.toUpperCase()}`}`,"aria-label":p.text||"none","aria-keyshortcuts":p.keyBinding||void 0,ref:b=>{t===p.value&&setTimeout(()=>{b==null||b.focus()},0)},children:[p.icon,p.keyBinding&&g("span",{className:"picker-keybinding",children:p.keyBinding})]},p.text))}),h=o.editor.isMobile;return g(py,{side:h?"right":"bottom",align:"start",sideOffset:h?8:12,style:{zIndex:"var(--zIndex-ui-styles-popup)"},onKeyDown:a,children:N("div",{className:"picker",role:"dialog","aria-modal":"true","aria-label":n,children:[f(u),d.length>0&&g(fv,{label:M("labels.more_options"),open:l,openTrigger:()=>{c(m=>!m)},className:"picker-collapsible",children:f(d)})]})})}function xk({value:e,label:t,options:n,onChange:i,group:s="",numberOfOptionsToAlwaysShow:r}){var c;const[o,a]=ae.useState(!1),l=ae.useRef(null);return g("div",{children:N(wl,{open:o,onOpenChange:u=>a(u),children:[g(_l,{name:s,type:"button","aria-label":t,onClick:()=>a(!o),ref:l,className:o?"active":"",children:(c=n.find(u=>u.value===e))==null?void 0:c.icon}),o&&g(y2e,{options:n,value:e,label:t,onChange:i,onClose:()=>{a(!1)},numberOfOptionsToAlwaysShow:r})]})})}const E2e=({updateData:e,app:t,testId:n})=>{const i=ae.useRef(null),s=ae.useRef(null),r=t.scene.getSelectedElements(t.state);let o=!0;const a=r.at(0),c=r.reduce((u,d)=>(u!=null&&u!==d.opacity&&(o=!1),u==null||u>d.opacity?d.opacity:u),(a==null?void 0:a.opacity)??null)??t.state.currentItemOpacity;return D.useEffect(()=>{if(i.current&&s.current){const u=i.current,d=s.current,f=u.offsetWidth,h=15,m=c/100*(f-h)+h/2;d.style.left=`${m}px`,u.style.background=`linear-gradient(to right, var(--color-slider-track) 0%, var(--color-slider-track) ${c}%, var(--button-bg) ${c}%, var(--button-bg) 100%)`}},[c]),N("label",{className:"control-label",children:[M("labels.opacity"),N("div",{className:"range-wrapper",children:[g("input",{style:{"--color-slider-track":o?void 0:"var(--button-bg)"},ref:i,type:"range",min:"0",max:"100",step:"10",onChange:u=>{e(+u.target.value)},value:c,className:"range-input","data-testid":n}),g("div",{className:"value-bubble",ref:s,children:c!==0?c:null}),g("div",{className:"zero-label",children:"0"})]})]})},$$=.1,hs=(e,t,n,i=!1)=>{const s=ve(Ve(e,t,{includeBoundTextElement:i}));return e.map(r=>{var o;return s.get(r.id)||r.id===((o=t.editingTextElement)==null?void 0:o.id)?n(r):r})},gs=function(e,t,n,i,s){const r=t.state.editingTextElement,o=jt(e);let a=null;if(r&&(a=n(r)),!a)if(Yn(o,t.state)){const c=t.scene.getSelectedElements(t.state),u=i===!0?c:c.filter(d=>i(d));a=DB(u,n)??(typeof s=="function"?s(!0):s)}else a=typeof s=="function"?s(!1):s;return a},v2e=(e,t,n)=>zt(t)||!t.autoResize?t:n.mutateElement(t,{x:e.textAlign==="left"?e.x:e.x+(e.width-t.width)/(e.textAlign==="center"?2:1),y:e.y+(e.height-t.height)/2}),pT=(e,t,n,i,s)=>{const r=new Set,o=hs(e,t,a=>{if(de(a)){const l=i(a);r.add(l);let c=Te(a,{fontSize:l});return qi(c,n.scene.getContainerElement(a),n.scene),c=v2e(a,c,n.scene),c}return a},!0);return Ve(e,t,{includeBoundTextElement:!0}).forEach(a=>{de(a)&&Is(a,n.scene)}),{elements:o,appState:{...t,currentItemFontSize:r.size===1?[...r][0]:s??t.currentItemFontSize},captureUpdate:K.IMMEDIATELY}};ce({name:"changeStrokeColor",label:"labels.stroke",trackEvent:!1,perform:(e,t,n)=>({...n.currentItemStrokeColor&&{elements:hs(e,t,i=>A4(i.type)?Te(i,{strokeColor:n.currentItemStrokeColor}):i,!0)},appState:{...t,...n},captureUpdate:n.currentItemStrokeColor?K.IMMEDIATELY:K.EVENTUALLY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i,data:s})=>N(fe,{children:[t.stylesPanelMode==="full"&&g("h3",{"aria-hidden":"true",children:M("labels.stroke")}),g(hT,{topPicks:WF,palette:use,type:"elementStroke",label:M("labels.stroke"),color:gs(e,i,r=>r.strokeColor,!0,r=>r?null:t.currentItemStrokeColor),onChange:r=>n({currentItemStrokeColor:r}),elements:e,appState:t,updateData:n,compactMode:t.stylesPanelMode==="compact"||t.stylesPanelMode==="mobile"})]})});ce({name:"changeBackgroundColor",label:"labels.changeBackground",trackEvent:!1,perform:(e,t,n,i)=>{if(!n.currentItemBackgroundColor)return{appState:{...t,...n},captureUpdate:K.EVENTUALLY};let s;const r=i.scene.getSelectedElements(t);if(!ws(n.currentItemBackgroundColor)&&r.every(a=>tn(a)&&qB(a.points))){const a=ve(r);s=e.map(l=>a.has(l.id)&&tn(l)?Te(l,{backgroundColor:n.currentItemBackgroundColor,...p_(l,!0)}):l)}else s=hs(e,t,a=>Te(a,{backgroundColor:n.currentItemBackgroundColor}));return{elements:s,appState:{...t,...n},captureUpdate:K.IMMEDIATELY}},PanelComponent:({elements:e,appState:t,updateData:n,app:i,data:s})=>N(fe,{children:[t.stylesPanelMode==="full"&&g("h3",{"aria-hidden":"true",children:M("labels.background")}),g(hT,{topPicks:KF,palette:dse,type:"elementBackground",label:M("labels.background"),color:gs(e,i,r=>r.backgroundColor,!0,r=>r?null:t.currentItemBackgroundColor),onChange:r=>n({currentItemBackgroundColor:r}),elements:e,appState:t,updateData:n,compactMode:t.stylesPanelMode==="compact"||t.stylesPanelMode==="mobile"})]})});ce({name:"changeFillStyle",label:"labels.fill",trackEvent:!1,perform:(e,t,n,i)=>(Qe("element","changeFillStyle",`${n} (${i.device.editor.isMobile?"mobile":"desktop"})`),{elements:hs(e,t,s=>Te(s,{fillStyle:n})),appState:{...t,currentItemFillStyle:n},captureUpdate:K.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>{const s=Ve(e,t),r=s.length>0&&s.every(o=>o.fillStyle==="zigzag");return N("fieldset",{children:[g("legend",{children:M("labels.fill")}),g("div",{className:"buttonList",children:g(la,{type:"button",options:[{value:"hachure",text:`${M(r?"labels.zigzag":"labels.hachure")} (${J("Alt-Click")})`,icon:r?wde:_de,active:r?!0:void 0,testId:"fill-hachure"},{value:"cross-hatch",text:M("labels.crossHatch"),icon:Tde,testId:"fill-cross-hatch"},{value:"solid",text:M("labels.solid"),icon:Ide,testId:"fill-solid"}],value:gs(e,i,o=>o.fillStyle,o=>o.hasOwnProperty("fillStyle"),o=>o?null:t.currentItemFillStyle),onClick:(o,a)=>{const l=a.altKey&&o==="hachure"&&s.every(c=>c.fillStyle==="hachure")?"zigzag":o;n(l)}})})]})}});ce({name:"changeStrokeWidth",label:"labels.strokeWidth",trackEvent:!1,perform:(e,t,n)=>({elements:hs(e,t,i=>Te(i,{strokeWidth:n})),appState:{...t,currentItemStrokeWidth:n},captureUpdate:K.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i,data:s})=>N("fieldset",{children:[g("legend",{children:M("labels.strokeWidth")}),g("div",{className:"buttonList",children:g(la,{group:"stroke-width",options:[{value:y8.thin,text:M("labels.thin"),icon:_V,testId:"strokeWidth-thin"},{value:y8.bold,text:M("labels.bold"),icon:Sde,testId:"strokeWidth-bold"},{value:y8.extraBold,text:M("labels.extraBold"),icon:xde,testId:"strokeWidth-extraBold"}],value:gs(e,i,r=>r.strokeWidth,r=>r.hasOwnProperty("strokeWidth"),r=>r?null:t.currentItemStrokeWidth),onChange:r=>n(r)})})]})});ce({name:"changeSloppiness",label:"labels.sloppiness",trackEvent:!1,perform:(e,t,n)=>({elements:hs(e,t,i=>Te(i,{seed:Rr(),roughness:n})),appState:{...t,currentItemRoughness:n},captureUpdate:K.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i,data:s})=>N("fieldset",{children:[g("legend",{children:M("labels.sloppiness")}),g("div",{className:"buttonList",children:g(la,{group:"sloppiness",options:[{value:0,text:M("labels.architect"),icon:Mde},{value:1,text:M("labels.artist"),icon:kde},{value:2,text:M("labels.cartoonist"),icon:Rde}],value:gs(e,i,r=>r.roughness,r=>r.hasOwnProperty("roughness"),r=>r?null:t.currentItemRoughness),onChange:r=>n(r)})})]})});ce({name:"changeStrokeStyle",label:"labels.strokeStyle",trackEvent:!1,perform:(e,t,n)=>({elements:hs(e,t,i=>Te(i,{strokeStyle:n})),appState:{...t,currentItemStrokeStyle:n},captureUpdate:K.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i,data:s})=>N("fieldset",{children:[g("legend",{children:M("labels.strokeStyle")}),g("div",{className:"buttonList",children:g(la,{group:"strokeStyle",options:[{value:"solid",text:M("labels.strokeStyle_solid"),icon:_V},{value:"dashed",text:M("labels.strokeStyle_dashed"),icon:Cde},{value:"dotted",text:M("labels.strokeStyle_dotted"),icon:Ade}],value:gs(e,i,r=>r.strokeStyle,r=>r.hasOwnProperty("strokeStyle"),r=>r?null:t.currentItemStrokeStyle),onChange:r=>n(r)})})]})});ce({name:"changeOpacity",label:"labels.opacity",trackEvent:!1,perform:(e,t,n)=>({elements:hs(e,t,i=>Te(i,{opacity:n}),!0),appState:{...t,currentItemOpacity:n},captureUpdate:K.IMMEDIATELY}),PanelComponent:({app:e,updateData:t})=>g(E2e,{updateData:t,app:e,testId:"opacity"})});ce({name:"changeFontSize",label:"labels.fontSize",trackEvent:!1,perform:(e,t,n,i)=>pT(e,t,i,()=>n,n),PanelComponent:({elements:e,appState:t,updateData:n,app:i,data:s})=>N("fieldset",{children:[g("legend",{children:M("labels.fontSize")}),g("div",{className:"buttonList",children:g(la,{group:"font-size",options:[{value:16,text:M("labels.small"),icon:jde,testId:"fontSize-small"},{value:20,text:M("labels.medium"),icon:Yde,testId:"fontSize-medium"},{value:28,text:M("labels.large"),icon:Wde,testId:"fontSize-large"},{value:36,text:M("labels.veryLarge"),icon:Kde,testId:"fontSize-veryLarge"}],value:gs(e,i,r=>{if(de(r))return r.fontSize;const o=Re(r,i.scene.getNonDeletedElementsMap());return o?o.fontSize:null},r=>de(r)||Re(r,i.scene.getNonDeletedElementsMap())!==null,r=>r?null:t.currentItemFontSize||vl),onChange:r=>{Ey(()=>n(r),t.stylesPanelMode==="compact"||t.stylesPanelMode==="mobile",!!t.editingTextElement,s==null?void 0:s.onPreventClose)}})})]})});const Ck=ce({name:"decreaseFontSize",label:"labels.decreaseFontSize",icon:uy,trackEvent:!1,perform:(e,t,n,i)=>pT(e,t,i,s=>Math.round(1/(1+$$)*s.fontSize)),keyTest:e=>e[H.CTRL_OR_CMD]&&e.shiftKey&&(e.key===H.CHEVRON_LEFT||e.key===H.COMMA)}),Ak=ce({name:"increaseFontSize",label:"labels.increaseFontSize",icon:uy,trackEvent:!1,perform:(e,t,n,i)=>pT(e,t,i,s=>Math.round(s.fontSize*(1+$$))),keyTest:e=>e[H.CTRL_OR_CMD]&&e.shiftKey&&(e.key===H.CHEVRON_RIGHT||e.key===H.PERIOD)});ce({name:"changeFontFamily",label:"labels.fontFamily",trackEvent:!1,perform:(e,t,n,i)=>{var m;const{cachedElements:s,resetAll:r,resetContainers:o,...a}=n;if(r)return{elements:hs(e,t,U=>{const b=s==null?void 0:s.get(U.id);return b?Te(U,{...b}):U},!0),appState:{...t,...a},captureUpdate:K.NEVER};const{currentItemFontFamily:l,currentHoveredFontFamily:c}=n;let u=K.EVENTUALLY,d,f=!1;if(l)d=l,u=K.IMMEDIATELY;else if(c){d=c,u=K.EVENTUALLY;const p=Ve(e,t,{includeBoundTextElement:!0}).filter(U=>de(U));if(p.length>200)f=!0;else{let U=0,b=0;for(;U<p.length&&b<5e3;){const y=p[U];b+=(y==null?void 0:y.originalText.length)||0,U++}b>5e3&&(f=!0)}}const h={appState:{...t,...a},captureUpdate:u};if(d&&!f){const p=new Map;let U=new Set,b=!1;const y=Array.from(Qa.loadedFontsCache.values()),w=(m=Object.entries(et).find(([C,_])=>_===d))==null?void 0:m[0];c&&w&&y.some(C=>C.startsWith(w))&&(b=!0),Object.assign(h,{elements:hs(e,t,C=>{if(de(C)&&(C.fontFamily!==d||l)){const _=Te(C,{fontFamily:d,lineHeight:Oc(d)}),T=(s==null?void 0:s.get(C.containerId||""))||{},k=i.scene.getContainerElement(C);return o&&k&&T&&i.scene.mutateElement(k,{...T}),b||(U=new Set([...U,...Array.from(_.originalText)])),p.set(_,k),_}return C},!0)});const v=`10px ${hp({fontFamily:d})}`,I=Array.from(U.values()).join();if(b||window.document.fonts.check(v,I))for(const[C,_]of p)qi(C,_,i.scene);else window.document.fonts.load(v,I).then(C=>{for(const[_,T]of p){const k=i.scene.getElement(_.id),S=T?i.scene.getElement(T.id):null;k&&qi(k,S,i.scene)}i.fonts.onLoaded(C)})}return h},PanelComponent:({elements:e,appState:t,app:n,updateData:i})=>{const s=D.useRef(new Map),r=D.useRef(null),[o,a]=D.useState({}),l=D.useRef(!0),c=D.useMemo(()=>{var d;const u=(f,h)=>gs(f,n,m=>{if(de(m))return m.fontFamily;const p=Re(m,h);return p?p.fontFamily:null},m=>de(m)||Re(m,h)!==null,m=>m?null:t.currentItemFontFamily||tu);return o.openPopup==="fontFamily"&&t.openPopup==="fontFamily"?u(Array.from(((d=s.current)==null?void 0:d.values())??[]),s.current):!o.openPopup&&t.openPopup!=="fontFamily"?u(e,n.scene.getNonDeletedElementsMap()):r.current},[o.openPopup,t,e,n]);return D.useEffect(()=>{r.current=c},[c]),D.useEffect(()=>{Object.keys(o).length&&(i(o),a({}))},[o]),D.useEffect(()=>(l.current=!1,()=>{l.current=!0}),[]),N(fe,{children:[t.stylesPanelMode==="full"&&g("legend",{children:M("labels.fontFamily")}),g(U2e,{isOpened:t.openPopup==="fontFamily",selectedFontFamily:c,hoveredFontFamily:t.currentHoveredFontFamily,compactMode:t.stylesPanelMode!=="full",onSelect:u=>{Ey(()=>{a({openPopup:null,currentHoveredFontFamily:null,currentItemFontFamily:u}),s.current.clear()},t.stylesPanelMode==="compact"||t.stylesPanelMode==="mobile",!!t.editingTextElement)},onHover:u=>{a({currentHoveredFontFamily:u,cachedElements:new Map(s.current),resetContainers:!0})},onLeave:()=>{a({currentHoveredFontFamily:null,cachedElements:new Map(s.current),resetAll:!0})},onPopupChange:u=>{if(u){s.current.clear();const{editingTextElement:d}=t;if((d==null?void 0:d.type)==="text"){const f=n.scene.getElement(d.id);s.current.set(d.id,Te(f||d,{},!0))}else{const f=Ve(e,t,{includeBoundTextElement:!0});for(const h of f)s.current.set(h.id,Te(h,{},!0))}a({...o,openPopup:"fontFamily"})}else{const d={currentHoveredFontFamily:null,cachedElements:new Map(s.current),resetAll:!0};a({...d}),s.current.clear(),(t.stylesPanelMode==="compact"||t.stylesPanelMode==="mobile")&&t.editingTextElement&&dT(null)}}})]})}});ce({name:"changeTextAlign",label:"Change text alignment",trackEvent:!1,perform:(e,t,n,i)=>({elements:hs(e,t,s=>{if(de(s)){const r=Te(s,{textAlign:n});return qi(r,i.scene.getContainerElement(s),i.scene),r}return s},!0),appState:{...t,currentItemTextAlign:n},captureUpdate:K.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i,data:s})=>{const r=i.scene.getNonDeletedElementsMap();return N("fieldset",{children:[g("legend",{children:M("labels.textAlign")}),g("div",{className:"buttonList",children:g(la,{group:"text-align",options:[{value:"left",text:M("labels.left"),icon:qde,testId:"align-left"},{value:"center",text:M("labels.center"),icon:Qde,testId:"align-horizontal-center"},{value:"right",text:M("labels.right"),icon:Jde,testId:"align-right"}],value:gs(e,i,o=>{if(de(o))return o.textAlign;const a=Re(o,r);return a?a.textAlign:null},o=>de(o)||Re(o,r)!==null,o=>o?null:t.currentItemTextAlign),onChange:o=>{Ey(()=>n(o),t.stylesPanelMode==="compact"||t.stylesPanelMode==="mobile",!!t.editingTextElement,s==null?void 0:s.onPreventClose)}})})]})}});ce({name:"changeVerticalAlign",label:"Change vertical alignment",trackEvent:{category:"element"},perform:(e,t,n,i)=>({elements:hs(e,t,s=>{if(de(s)){const r=Te(s,{verticalAlign:n});return qi(r,i.scene.getContainerElement(s),i.scene),r}return s},!0),appState:{...t},captureUpdate:K.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i,data:s})=>g("fieldset",{children:g("div",{className:"buttonList",children:g(la,{group:"text-align",options:[{value:Gs.TOP,text:M("labels.alignTop"),icon:g(efe,{theme:t.theme}),testId:"align-top"},{value:Gs.MIDDLE,text:M("labels.centerVertically"),icon:g(nfe,{theme:t.theme}),testId:"align-middle"},{value:Gs.BOTTOM,text:M("labels.alignBottom"),icon:g(tfe,{theme:t.theme}),testId:"align-bottom"}],value:gs(e,i,r=>{if(de(r)&&r.containerId)return r.verticalAlign;const o=Re(r,i.scene.getNonDeletedElementsMap());return o?o.verticalAlign:null},r=>de(r)||Re(r,i.scene.getNonDeletedElementsMap())!==null,r=>r?null:Gs.MIDDLE),onChange:r=>{Ey(()=>n(r),t.stylesPanelMode==="compact"||t.stylesPanelMode==="mobile",!!t.editingTextElement,s==null?void 0:s.onPreventClose)}})})})});ce({name:"changeRoundness",label:"Change edge roundness",trackEvent:!1,perform:(e,t,n)=>({elements:hs(e,t,i=>ge(i)?i:Te(i,{roundness:n==="round"?{type:Bd(i.type)?yn.ADAPTIVE_RADIUS:yn.PROPORTIONAL_RADIUS}:null})),appState:{...t,currentItemRoundness:n},captureUpdate:K.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i,renderAction:s})=>{const o=J5(jt(e),t).some(a=>{var l;return((l=a.roundness)==null?void 0:l.type)===yn.LEGACY});return N("fieldset",{children:[g("legend",{children:M("labels.edges")}),N("div",{className:"buttonList",children:[g(la,{group:"edges",options:[{value:"sharp",text:M("labels.sharp"),icon:Dde},{value:"round",text:M("labels.round"),icon:Lde}],value:gs(e,i,a=>o?null:a.roundness?"round":"sharp",a=>!xe(a)&&a.hasOwnProperty("roundness"),a=>a?null:t.currentItemRoundness),onChange:a=>n(a)}),s("togglePolygon")]})]})}});const Mk=e=>[{value:null,text:M("labels.arrowhead_none"),keyBinding:"q",icon:Nde},{value:"arrow",text:M("labels.arrowhead_arrow"),keyBinding:"w",icon:g(J4,{flip:e})},{value:"triangle",text:M("labels.arrowhead_triangle"),icon:g(Bde,{flip:e}),keyBinding:"e"},{value:"triangle_outline",text:M("labels.arrowhead_triangle_outline"),icon:g(zde,{flip:e}),keyBinding:"r"},{value:"circle",text:M("labels.arrowhead_circle"),keyBinding:"a",icon:g(Ode,{flip:e})},{value:"circle_outline",text:M("labels.arrowhead_circle_outline"),keyBinding:"s",icon:g(Pde,{flip:e})},{value:"diamond",text:M("labels.arrowhead_diamond"),icon:g(Hde,{flip:e}),keyBinding:"d"},{value:"diamond_outline",text:M("labels.arrowhead_diamond_outline"),icon:g(Vde,{flip:e}),keyBinding:"f"},{value:"bar",text:M("labels.arrowhead_bar"),keyBinding:"z",icon:g(Fde,{flip:e})},{value:"crowfoot_one",text:M("labels.arrowhead_crowfoot_one"),icon:g(Gde,{flip:e}),keyBinding:"x"},{value:"crowfoot_many",text:M("labels.arrowhead_crowfoot_many"),icon:g($de,{flip:e}),keyBinding:"c"},{value:"crowfoot_one_or_many",text:M("labels.arrowhead_crowfoot_one_or_many"),icon:g(Xde,{flip:e}),keyBinding:"v"}];ce({name:"changeArrowhead",label:"Change arrowheads",trackEvent:!1,perform:(e,t,n)=>({elements:hs(e,t,i=>{if(Se(i)){const{position:s,type:r}=n;if(s==="start")return Te(i,{startArrowhead:r});if(s==="end")return Te(i,{endArrowhead:r})}return i}),appState:{...t,[n.position==="start"?"currentItemStartArrowhead":"currentItemEndArrowhead"]:n.type},captureUpdate:K.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>{const s=gm().rtl;return N("fieldset",{children:[g("legend",{children:M("labels.arrowheads")}),N("div",{className:"iconSelectList buttonList",children:[g(xk,{label:"arrowhead_start",options:Mk(!s),value:gs(e,i,r=>Se(r)&&y6(r.type)?r.startArrowhead:t.currentItemStartArrowhead,!0,t.currentItemStartArrowhead),onChange:r=>n({position:"start",type:r}),numberOfOptionsToAlwaysShow:4}),g(xk,{label:"arrowhead_end",group:"arrowheads",options:Mk(!!s),value:gs(e,i,r=>Se(r)&&y6(r.type)?r.endArrowhead:t.currentItemEndArrowhead,!0,t.currentItemEndArrowhead),onChange:r=>n({position:"end",type:r}),numberOfOptionsToAlwaysShow:4})]})]})}});ce({name:"changeArrowProperties",label:"Change arrow properties",trackEvent:!1,perform:(e,t,n,i)=>!1,PanelComponent:({elements:e,appState:t,updateData:n,app:i,renderAction:s})=>N("div",{className:"selected-shape-actions",children:[s("changeArrowhead"),s("changeArrowType")]})});ce({name:"changeArrowType",label:"Change arrow types",trackEvent:!1,perform:(e,t,n,i)=>{var a;const s=hs(e,t,l=>{if(!xe(l))return l;let c=Te(l,{roundness:n===ui.round?{type:yn.PROPORTIONAL_RADIUS}:null,elbowed:n===ui.elbow,points:n===ui.elbow||l.elbowed?[l.points[0],l.points[l.points.length-1]]:l.points});if(ge(c)){c.fixedSegments=null;const u=i.scene.getNonDeletedElementsMap();i.dismissLinearEditor();const d=pe.getPointAtIndexGlobalCoordinates(c,0,u),f=pe.getPointAtIndexGlobalCoordinates(c,-1,u),h=c.startBinding&&u.get(c.startBinding.elementId),m=c.endBinding&&u.get(c.endBinding.elementId),p=h&&c.startBinding?{...c.startBinding,...u6(c,h,"start",u)}:null,U=m&&c.endBinding?{...c.endBinding,...u6(c,m,"end",u)}:null;c={...c,startBinding:p,endBinding:U,...yg(c,u,{points:[d,f].map(b=>x(b[0]-c.x,b[1]-c.y)),startBinding:p,endBinding:U,fixedSegments:null})}}else{const u=i.scene.getNonDeletedElementsMap();if(c.startBinding){const d=u.get(c.startBinding.elementId);d&&ea(c,d,"start",i.scene)}if(c.endBinding){const d=u.get(c.endBinding.elementId);d&&ea(c,d,"end",i.scene)}}return c}),r={...t,currentItemArrowType:n},o=(a=t.selectedLinearElement)==null?void 0:a.elementId;if(o){const l=s.find(c=>c.id===o);l&&(r.selectedLinearElement=new pe(l,ve(e)))}return{elements:s,appState:r,captureUpdate:K.IMMEDIATELY}},PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>N("fieldset",{children:[g("legend",{children:M("labels.arrowtypes")}),g("div",{className:"buttonList",children:g(la,{group:"arrowtypes",options:[{value:ui.sharp,text:M("labels.arrowtype_sharp"),icon:j_,testId:"sharp-arrow"},{value:ui.round,text:M("labels.arrowtype_round"),icon:W_,testId:"round-arrow"},{value:ui.elbow,text:M("labels.arrowtype_elbowed"),icon:Y_,testId:"elbow-arrow"}],value:gs(e,i,s=>xe(s)?s.elbowed?ui.elbow:s.roundness?ui.round:ui.sharp:null,s=>xe(s),s=>s?null:t.currentItemArrowType),onChange:s=>n(s)})})]})});const w2e=k9.includes(devicePixelRatio)?devicePixelRatio:1,ia=()=>({showWelcomeScreen:!1,theme:ke.LIGHT,collaborators:new Map,currentChartType:"bar",currentItemBackgroundColor:mn.backgroundColor,currentItemEndArrowhead:"arrow",currentItemFillStyle:mn.fillStyle,currentItemFontFamily:tu,currentItemFontSize:vl,currentItemOpacity:mn.opacity,currentItemRoughness:mn.roughness,currentItemStartArrowhead:null,currentItemStrokeColor:mn.strokeColor,currentItemRoundness:"round",currentItemArrowType:ui.round,currentItemStrokeStyle:mn.strokeStyle,currentItemStrokeWidth:mn.strokeWidth,currentItemTextAlign:up,currentHoveredFontFamily:null,cursorButton:"up",activeEmbeddable:null,newElement:null,editingTextElement:null,editingGroupId:null,activeTool:{type:"selection",customType:null,locked:mn.locked,fromSelection:!1,lastActiveTool:null},preferredSelectionTool:{type:"selection",initialized:!1},penMode:!1,penDetected:!1,errorMessage:null,exportBackground:!0,exportScale:w2e,exportEmbedScene:!1,exportWithDarkMode:!1,fileHandle:null,gridSize:Vb,gridStep:rB,gridModeEnabled:!1,isBindingEnabled:!0,defaultSidebarDockedPreference:!1,isLoading:!1,isResizing:!1,isRotating:!1,lastPointerDownWith:"mouse",multiElement:null,name:null,contextMenu:null,openMenu:null,openPopup:null,openSidebar:null,openDialog:null,pasteDialog:{shown:!1,data:null},previousSelectedElementIds:{},resizingElement:null,scrolledOutside:!1,scrollX:0,scrollY:0,selectedElementIds:{},hoveredElementIds:{},selectedGroupIds:{},selectedElementsAreBeingDragged:!1,selectionElement:null,shouldCacheIgnoreZoom:!1,stats:{open:!1,panels:zf.generalStats|zf.elementProperties},startBoundElement:null,suggestedBindings:[],frameRendering:{enabled:!0,clip:!0,name:!0,outline:!0},frameToHighlight:null,editingFrame:null,elementsToHighlight:null,toast:null,viewBackgroundColor:Ge.white,zenModeEnabled:!1,zoom:{value:1},viewModeEnabled:!1,showHyperlinkPopup:!1,selectedLinearElement:null,snapLines:[],originSnapOffset:{x:0,y:0},objectsSnapModeEnabled:!1,userToFollow:null,followedBy:new Set,isCropping:!1,croppingElementId:null,searchMatches:null,lockedMultiSelections:{},activeLockedId:null,stylesPanelMode:"full"}),_2e=(e=>e)({showWelcomeScreen:{browser:!0,export:!1,server:!1},theme:{browser:!0,export:!1,server:!1},collaborators:{browser:!1,export:!1,server:!1},currentChartType:{browser:!0,export:!1,server:!1},currentItemBackgroundColor:{browser:!0,export:!1,server:!1},currentItemEndArrowhead:{browser:!0,export:!1,server:!1},currentItemFillStyle:{browser:!0,export:!1,server:!1},currentItemFontFamily:{browser:!0,export:!1,server:!1},currentItemFontSize:{browser:!0,export:!1,server:!1},currentItemRoundness:{browser:!0,export:!1,server:!1},currentItemArrowType:{browser:!0,export:!1,server:!1},currentItemOpacity:{browser:!0,export:!1,server:!1},currentItemRoughness:{browser:!0,export:!1,server:!1},currentItemStartArrowhead:{browser:!0,export:!1,server:!1},currentItemStrokeColor:{browser:!0,export:!1,server:!1},currentItemStrokeStyle:{browser:!0,export:!1,server:!1},currentItemStrokeWidth:{browser:!0,export:!1,server:!1},currentItemTextAlign:{browser:!0,export:!1,server:!1},currentHoveredFontFamily:{browser:!1,export:!1,server:!1},cursorButton:{browser:!0,export:!1,server:!1},activeEmbeddable:{browser:!1,export:!1,server:!1},newElement:{browser:!1,export:!1,server:!1},editingTextElement:{browser:!1,export:!1,server:!1},editingGroupId:{browser:!0,export:!1,server:!1},activeTool:{browser:!0,export:!1,server:!1},preferredSelectionTool:{browser:!0,export:!1,server:!1},penMode:{browser:!0,export:!1,server:!1},penDetected:{browser:!0,export:!1,server:!1},errorMessage:{browser:!1,export:!1,server:!1},exportBackground:{browser:!0,export:!1,server:!1},exportEmbedScene:{browser:!0,export:!1,server:!1},exportScale:{browser:!0,export:!1,server:!1},exportWithDarkMode:{browser:!0,export:!1,server:!1},fileHandle:{browser:!1,export:!1,server:!1},gridSize:{browser:!0,export:!0,server:!0},gridStep:{browser:!0,export:!0,server:!0},gridModeEnabled:{browser:!0,export:!0,server:!0},height:{browser:!1,export:!1,server:!1},isBindingEnabled:{browser:!1,export:!1,server:!1},defaultSidebarDockedPreference:{browser:!0,export:!1,server:!1},isLoading:{browser:!1,export:!1,server:!1},isResizing:{browser:!1,export:!1,server:!1},isRotating:{browser:!1,export:!1,server:!1},lastPointerDownWith:{browser:!0,export:!1,server:!1},multiElement:{browser:!1,export:!1,server:!1},name:{browser:!0,export:!1,server:!1},offsetLeft:{browser:!1,export:!1,server:!1},offsetTop:{browser:!1,export:!1,server:!1},contextMenu:{browser:!1,export:!1,server:!1},openMenu:{browser:!0,export:!1,server:!1},openPopup:{browser:!1,export:!1,server:!1},openSidebar:{browser:!0,export:!1,server:!1},openDialog:{browser:!1,export:!1,server:!1},pasteDialog:{browser:!1,export:!1,server:!1},previousSelectedElementIds:{browser:!0,export:!1,server:!1},resizingElement:{browser:!1,export:!1,server:!1},scrolledOutside:{browser:!0,export:!1,server:!1},scrollX:{browser:!0,export:!1,server:!1},scrollY:{browser:!0,export:!1,server:!1},selectedElementIds:{browser:!0,export:!1,server:!1},hoveredElementIds:{browser:!1,export:!1,server:!1},selectedGroupIds:{browser:!0,export:!1,server:!1},selectedElementsAreBeingDragged:{browser:!1,export:!1,server:!1},selectionElement:{browser:!1,export:!1,server:!1},shouldCacheIgnoreZoom:{browser:!0,export:!1,server:!1},stats:{browser:!0,export:!1,server:!1},startBoundElement:{browser:!1,export:!1,server:!1},suggestedBindings:{browser:!1,export:!1,server:!1},frameRendering:{browser:!1,export:!1,server:!1},frameToHighlight:{browser:!1,export:!1,server:!1},editingFrame:{browser:!1,export:!1,server:!1},elementsToHighlight:{browser:!1,export:!1,server:!1},toast:{browser:!1,export:!1,server:!1},viewBackgroundColor:{browser:!0,export:!0,server:!0},width:{browser:!1,export:!1,server:!1},zenModeEnabled:{browser:!0,export:!1,server:!1},zoom:{browser:!0,export:!1,server:!1},viewModeEnabled:{browser:!1,export:!1,server:!1},showHyperlinkPopup:{browser:!1,export:!1,server:!1},selectedLinearElement:{browser:!0,export:!1,server:!1},snapLines:{browser:!1,export:!1,server:!1},originSnapOffset:{browser:!1,export:!1,server:!1},objectsSnapModeEnabled:{browser:!0,export:!1,server:!1},userToFollow:{browser:!1,export:!1,server:!1},followedBy:{browser:!1,export:!1,server:!1},isCropping:{browser:!1,export:!1,server:!1},croppingElementId:{browser:!1,export:!1,server:!1},searchMatches:{browser:!1,export:!1,server:!1},lockedMultiSelections:{browser:!0,export:!0,server:!0},activeLockedId:{browser:!1,export:!1,server:!1},stylesPanelMode:{browser:!1,export:!1,server:!1}}),UT=(e,t)=>{const n={};for(const i of Object.keys(e)){const s=_2e[i];if(s!=null&&s[t]){const r=e[i];n[i]=r}}return n},G$=e=>UT(e,"browser"),X$=e=>UT(e,"export"),T2e=e=>UT(e,"server"),Ao=({activeTool:e})=>e.type==="eraser",Yh=({activeTool:e})=>e.type==="hand",I0=()=>{const e=document.querySelector(".excalidraw-tooltip");if(e)return e;const t=document.createElement("div");return document.body.appendChild(t),t.classList.add("excalidraw-tooltip"),t},j$=(e,t,n="bottom")=>{const i=e.getBoundingClientRect(),s=window.innerWidth,r=window.innerHeight,o=5;let a=t.left+t.width/2-i.width/2;a<0?a=o:a+i.width>=s&&(a=s-i.width-o);let l;n==="bottom"?(l=t.top+t.height+o,l+i.height>=r&&(l=t.top-i.height-o)):(l=t.top-i.height-o,l<0&&(l=t.top+t.height+o)),Object.assign(e.style,{top:`${l}px`,left:`${a}px`})},I2e=(e,t,n,i)=>{t.classList.add("excalidraw-tooltip--visible"),t.style.minWidth=i?"50ch":"10ch",t.style.maxWidth=i?"50ch":"15ch",t.textContent=n;const s=e.getBoundingClientRect();j$(t,s)},hl=({children:e,label:t,long:n=!1,style:i,disabled:s})=>(D.useEffect(()=>()=>I0().classList.remove("excalidraw-tooltip--visible"),[]),s?null:g("div",{className:"excalidraw-tooltip-wrapper",onPointerEnter:r=>I2e(r.currentTarget,I0(),t,n),onPointerLeave:()=>I0().classList.remove("excalidraw-tooltip--visible"),style:i,children:e})),Y$='<svg viewBox="0 0 24 24" stroke-width="1" width="28" height="28" xmlns="http://www.w3.org/2000/svg">',S2e='<path d="M6.164 11.755a5.314 5.314 0 0 1-4.932-5.298 5.314 5.314 0 0 1 5.311-5.311 5.314 5.314 0 0 1 5.307 5.113l8.773 8.773a3.322 3.322 0 0 1 0 4.696l-.895.895a3.322 3.322 0 0 1-4.696 0l-8.868-8.868Z" style="fill:#fff"/>',W$='<path stroke="#1b1b1f" fill="#fff" d="m7.868 11.113 7.773 7.774a2.359 2.359 0 0 0 1.667.691 2.368 2.368 0 0 0 2.357-2.358c0-.625-.248-1.225-.69-1.667L11.201 7.78 9.558 9.469l-1.69 1.643v.001Zm10.273 3.606-3.333 3.333m-3.25-6.583 2 2m-7-7 3 3M3.664 3.625l1 1M2.529 6.922l1.407-.144m5.735-2.932-1.118.866M4.285 9.823l.758-1.194m1.863-6.207-.13 1.408"/>',x2e=`data:${_e.svg},${encodeURIComponent(`${Y$}${W$}</svg>`)}`,C2e=`data:${_e.svg},${encodeURIComponent(`${Y$}${S2e}${W$}</svg>`)}`,wo=e=>{e&&(e.style.cursor="")},Rt=(e,t)=>{e&&(e.style.cursor=t)};let Uo,kk;const K$=(e,t)=>{const i=()=>{const s=t===ke.DARK;Uo=document.createElement("canvas"),Uo.theme=t,Uo.height=20,Uo.width=20;const r=Uo.getContext("2d");r.lineWidth=1,r.beginPath(),r.arc(Uo.width/2,Uo.height/2,5,0,2*Math.PI),r.fillStyle=s?Ui.black:Ui.white,r.fill(),r.strokeStyle=s?Ui.white:Ui.black,r.stroke(),kk=Uo.toDataURL(_e.svg)};(!Uo||Uo.theme!==t)&&i(),Rt(e,`url(${kk}) ${20/2} ${20/2}, auto`)},_o=(e,t)=>{if(e)if(t.activeTool.type==="selection")wo(e);else if(Yh(t))e.style.cursor=xt.GRAB;else if(Ao(t))K$(e,t.theme);else if(t.activeTool.type==="laser"){const n=t.theme===ke.LIGHT?x2e:C2e;e.style.cursor=`url(${n}), auto`}else["image","custom"].includes(t.activeTool.type)?t.activeTool.type!=="image"&&(e.style.cursor=xt.AUTO):e.style.cursor=xt.CROSSHAIR},Nu=({viewportX:e,viewportY:t,nextZoom:n},i)=>{const s=e-i.offsetLeft,r=t-i.offsetTop,o=i.zoom.value,a=i.scrollX+(s-s/o),l=i.scrollY+(r-r/o),c=-(s-s/n),u=-(r-r/n);return{scrollX:a+c,scrollY:l+u,zoom:{value:n}}};ce({name:"changeViewBackgroundColor",label:"labels.canvasBackground",trackEvent:!1,predicate:(e,t,n,i)=>!!i.props.UIOptions.canvasActions.changeViewBackgroundColor&&!t.viewModeEnabled,perform:(e,t,n)=>({appState:{...t,...n},captureUpdate:n.viewBackgroundColor?K.IMMEDIATELY:K.EVENTUALLY}),PanelComponent:({elements:e,appState:t,updateData:n,appProps:i,data:s})=>g(hT,{palette:null,topPicks:ZF,label:M("labels.canvasBackground"),type:"canvasBackground",color:t.viewBackgroundColor,onChange:r=>n({viewBackgroundColor:r}),"data-testid":"canvas-background-picker",elements:e,appState:t,updateData:n,compactMode:t.stylesPanelMode==="compact"})});const S0=ce({name:"clearCanvas",label:"labels.clearCanvas",icon:Hc,trackEvent:{category:"canvas"},predicate:(e,t,n,i)=>{var s;return!!i.props.UIOptions.canvasActions.clearCanvas&&!t.viewModeEnabled&&((s=t.openDialog)==null?void 0:s.name)!=="elementLinkSelector"},perform:(e,t,n,i)=>(i.imageCache.clear(),{elements:e.map(s=>Te(s,{isDeleted:!0})),appState:{...ia(),files:{},theme:t.theme,penMode:t.penMode,penDetected:t.penDetected,exportBackground:t.exportBackground,exportEmbedScene:t.exportEmbedScene,gridSize:t.gridSize,gridStep:t.gridStep,gridModeEnabled:t.gridModeEnabled,stats:t.stats,pasteDialog:t.pasteDialog,activeTool:t.activeTool.type==="image"?{...t.activeTool,type:i.state.preferredSelectionTool.type}:t.activeTool},captureUpdate:K.IMMEDIATELY})}),Rk=ce({name:"zoomIn",label:"buttons.zoomIn",viewMode:!0,icon:PM,trackEvent:{category:"canvas"},perform:(e,t,n,i)=>({appState:{...t,...Nu({viewportX:t.width/2+t.offsetLeft,viewportY:t.height/2+t.offsetTop,nextZoom:Ha(t.zoom.value+V5)},t),userToFollow:null},captureUpdate:K.EVENTUALLY}),PanelComponent:({updateData:e,appState:t})=>g($e,{type:"button",className:"zoom-in-button zoom-button",icon:PM,title:`${M("buttons.zoomIn")}  ${J("CtrlOrCmd++")}`,"aria-label":M("buttons.zoomIn"),disabled:t.zoom.value>=A9,onClick:()=>{e(null)}}),keyTest:e=>(e.code===tt.EQUAL||e.code===tt.NUM_ADD)&&(e[H.CTRL_OR_CMD]||e.shiftKey)}),Dk=ce({name:"zoomOut",label:"buttons.zoomOut",icon:FM,viewMode:!0,trackEvent:{category:"canvas"},perform:(e,t,n,i)=>({appState:{...t,...Nu({viewportX:t.width/2+t.offsetLeft,viewportY:t.height/2+t.offsetTop,nextZoom:Ha(t.zoom.value-V5)},t),userToFollow:null},captureUpdate:K.EVENTUALLY}),PanelComponent:({updateData:e,appState:t})=>g($e,{type:"button",className:"zoom-out-button zoom-button",icon:FM,title:`${M("buttons.zoomOut")}  ${J("CtrlOrCmd+-")}`,"aria-label":M("buttons.zoomOut"),disabled:t.zoom.value<=C9,onClick:()=>{e(null)}}),keyTest:e=>(e.code===tt.MINUS||e.code===tt.NUM_SUBTRACT)&&(e[H.CTRL_OR_CMD]||e.shiftKey)}),Lk=ce({name:"resetZoom",label:"buttons.resetZoom",icon:rde,viewMode:!0,trackEvent:{category:"canvas"},perform:(e,t,n,i)=>({appState:{...t,...Nu({viewportX:t.width/2+t.offsetLeft,viewportY:t.height/2+t.offsetTop,nextZoom:Ha(1)},t),userToFollow:null},captureUpdate:K.EVENTUALLY}),PanelComponent:({updateData:e,appState:t})=>g(hl,{label:M("buttons.resetZoom"),style:{height:"100%"},children:N($e,{type:"button",className:"reset-zoom-button zoom-button",title:M("buttons.resetZoom"),"aria-label":M("buttons.resetZoom"),onClick:()=>{e(null)},children:[(t.zoom.value*100).toFixed(0),"%"]})}),keyTest:e=>(e.code===tt.ZERO||e.code===tt.NUM_ZERO)&&(e[H.CTRL_OR_CMD]||e.shiftKey)}),A2e=(e,t,n=1)=>{const[i,s,r,o]=e,a=r-i,l=t.width/a,c=o-s,u=t.height/c,f=Math.min(l,u)*Ke(n,.1,1);return Math.min(f,1)},Z$=({bounds:e,appState:t,canvasOffsets:n,fitToViewport:i=!1,viewportZoomFactor:s=1,minZoom:r=-1/0,maxZoom:o=1/0})=>{s=Ke(s,C9,A9);const[a,l,c,u]=e,d=(a+c)/2,f=(l+u)/2,h=(n==null?void 0:n.left)??0,m=(n==null?void 0:n.top)??0,p=(n==null?void 0:n.right)??0,U=(n==null?void 0:n.bottom)??0,b=t.width-h-p,y=t.height-m-U;let w;if(i){const C=c-a,_=u-l;w=Math.min(b/C,y/_)*s}else w=A2e(e,{width:b,height:y},s);const v=Ha(Ke(Zse(w,V5,"floor"),r,o)),I=hV({scenePoint:{x:d,y:f},viewportDimensions:{width:t.width,height:t.height},offsets:n,zoom:{value:v}});return{appState:{...t,scrollX:I.scrollX,scrollY:I.scrollY,zoom:{value:v}},captureUpdate:K.EVENTUALLY}},_y=({canvasOffsets:e,targetElements:t,appState:n,fitToViewport:i,viewportZoomFactor:s,minZoom:r,maxZoom:o})=>{const a=ft(jt(t));return Z$({canvasOffsets:e,bounds:a,appState:n,fitToViewport:i,viewportZoomFactor:s,minZoom:r,maxZoom:o})};ce({name:"zoomToFitSelectionInViewport",label:"labels.zoomToFitViewport",icon:X_,trackEvent:{category:"canvas"},perform:(e,t,n,i)=>{const s=i.scene.getSelectedElements(t);return _y({targetElements:s.length?s:e,appState:{...t,userToFollow:null},fitToViewport:!1,canvasOffsets:i.getEditorUIOffsets()})},keyTest:e=>e.code===tt.TWO&&e.shiftKey&&!e.altKey&&!e[H.CTRL_OR_CMD]});ce({name:"zoomToFitSelection",label:"helpDialog.zoomToSelection",icon:X_,trackEvent:{category:"canvas"},perform:(e,t,n,i)=>{const s=i.scene.getSelectedElements(t);return _y({targetElements:s.length?s:e,appState:{...t,userToFollow:null},fitToViewport:!0,canvasOffsets:i.getEditorUIOffsets()})},keyTest:e=>e.code===tt.THREE&&e.shiftKey&&!e.altKey&&!e[H.CTRL_OR_CMD]});ce({name:"zoomToFit",label:"helpDialog.zoomToFit",icon:X_,viewMode:!0,trackEvent:{category:"canvas"},perform:(e,t,n,i)=>_y({targetElements:e,appState:{...t,userToFollow:null},fitToViewport:!1,canvasOffsets:i.getEditorUIOffsets()}),keyTest:e=>e.code===tt.ONE&&e.shiftKey&&!e.altKey&&!e[H.CTRL_OR_CMD]});const N6=ce({name:"toggleTheme",label:(e,t)=>t.theme===ke.DARK?"buttons.lightMode":"buttons.darkMode",keywords:["toggle","dark","light","mode","theme"],icon:e=>e.theme===ke.LIGHT?q4:Q4,viewMode:!0,trackEvent:{category:"canvas"},perform:(e,t,n)=>({appState:{...t,theme:n||(t.theme===ke.LIGHT?ke.DARK:ke.LIGHT)},captureUpdate:K.EVENTUALLY}),keyTest:e=>e.altKey&&e.shiftKey&&e.code===tt.D,predicate:(e,t,n,i)=>!!i.props.UIOptions.canvasActions.toggleTheme});ce({name:"toggleEraserTool",label:"toolBar.eraser",trackEvent:{category:"toolbar"},perform:(e,t,n,i)=>{let s;return Ao(t)?s=en(t,{...t.activeTool.lastActiveTool||{type:i.state.preferredSelectionTool.type},lastActiveToolBeforeEraser:null}):s=en(t,{type:"eraser",lastActiveToolBeforeEraser:t.activeTool}),{appState:{...t,selectedElementIds:{},selectedGroupIds:{},activeEmbeddable:null,activeTool:s},captureUpdate:K.IMMEDIATELY}},keyTest:e=>e.key===H.E});ce({name:"toggleLassoTool",label:"toolBar.lasso",icon:T0,trackEvent:{category:"toolbar"},predicate:(e,t,n,i)=>i.state.preferredSelectionTool.type!=="lasso",perform:(e,t,n,i)=>{let s;return t.activeTool.type!=="lasso"?(s=en(t,{type:"lasso",fromSelection:!1}),Rt(i.interactiveCanvas,xt.CROSSHAIR)):s=en(t,{type:"selection"}),{appState:{...t,selectedElementIds:{},selectedGroupIds:{},activeEmbeddable:null,activeTool:s},captureUpdate:K.NEVER}}});const M2e=ce({name:"toggleHandTool",label:"toolBar.hand",trackEvent:{category:"toolbar"},icon:SV,viewMode:!1,perform:(e,t,n,i)=>{let s;return Yh(t)?s=en(t,{...t.activeTool.lastActiveTool||{type:"selection"},lastActiveToolBeforeEraser:null}):(s=en(t,{type:"hand",lastActiveToolBeforeEraser:t.activeTool}),Rt(i.interactiveCanvas,xt.GRAB)),{appState:{...t,selectedElementIds:{},selectedGroupIds:{},activeEmbeddable:null,activeTool:s},captureUpdate:K.IMMEDIATELY}},keyTest:e=>!e.altKey&&!e[H.CTRL_OR_CMD]&&e.key===H.H});ce({name:"setEmbeddableAsActiveTool",trackEvent:{category:"toolbar"},target:"Tool",label:"toolBar.embeddable",perform:(e,t,n,i)=>{const s=en(t,{type:"embeddable"});return _o(i.canvas,{...t,activeTool:s}),{elements:e,appState:{...t,activeTool:en(t,{type:"embeddable"})},captureUpdate:K.EVENTUALLY}}});const Fr=ce({name:"finalize",label:"",trackEvent:!1,perform:(e,t,n,i)=>{var h,m;const{interactiveCanvas:s,focusContainer:r,scene:o}=i,{event:a,sceneCoords:l}=n??{},c=o.getNonDeletedElementsMap();if(a&&t.selectedLinearElement){const p=pe.handlePointerUp(a,t.selectedLinearElement,t,i.scene),{startBindingElement:U,endBindingElement:b}=p,y=i.scene.getElement(p.elementId);if(za(y)&&l6(y,U,b,i.scene),p!==t.selectedLinearElement){let w=e;return y&&qa(y)&&(w=w.map(v=>v.id===y.id?Te(v,{isDeleted:!0}):v)),{elements:w,appState:{selectedLinearElement:{...p,selectedPointsIndices:null},suggestedBindings:[]},captureUpdate:K.IMMEDIATELY}}}if((h=t.selectedLinearElement)!=null&&h.isEditing){const{elementId:p,startBindingElement:U,endBindingElement:b}=t.selectedLinearElement,y=pe.getElement(p,c);if(y)return za(y)&&l6(y,U,b,o),tn(y)&&!T4(y.points)&&o.mutateElement(y,{polygon:!1}),{elements:y.points.length<2||qa(y)?e.map(w=>w.id===y.id?Te(w,{isDeleted:!0}):w):void 0,appState:{...t,cursorButton:"up",selectedLinearElement:new pe(y,ve(c),!1)},captureUpdate:K.IMMEDIATELY}}let u=e;window.document.activeElement instanceof HTMLElement&&r();let d=null;if(t.multiElement)d=t.multiElement;else if(((m=t.newElement)==null?void 0:m.type)==="freedraw"||za(t.newElement))d=t.newElement;else if(Object.keys(t.selectedElementIds).length===1){const p=c.get(Object.keys(t.selectedElementIds)[0]);p&&(d=p)}if(d){if(t.multiElement&&d.type!=="freedraw"){const{points:p,lastCommittedPoint:U}=d;(!U||p[p.length-1]!==U)&&o.mutateElement(d,{points:d.points.slice(0,-1)})}if(d&&qa(d)&&(u=u.map(p=>p.id===(d==null?void 0:d.id)?Te(p,{isDeleted:!0}):p)),Se(d)||Zi(d)){const p=qo(d.points,t.zoom.value);if(p&&(tn(d)||Zi(d))){const U=d.points,b=U[0],y=U.map((w,v)=>v===U.length-1?x(b[0],b[1]):w);tn(d)?o.mutateElement(d,{points:y,polygon:!0}):o.mutateElement(d,{points:y})}if(tn(d)&&!T4(d.points)&&o.mutateElement(d,{polygon:!1}),za(d)&&!p&&d.points.length>1&&qu(t)){const U=l??Ya(pe.getPointAtIndexGlobalCoordinates(d,-1,ve(e)));lle(d,t,U,o)}}}(!t.activeTool.locked&&t.activeTool.type!=="freedraw"||!d)&&wo(s);let f;return t.activeTool.type==="eraser"?f=en(t,{...t.activeTool.lastActiveTool||{type:i.state.preferredSelectionTool.type},lastActiveToolBeforeEraser:null}):f=en(t,{type:i.state.preferredSelectionTool.type}),{elements:u,appState:{...t,cursorButton:"up",activeTool:(t.activeTool.locked||t.activeTool.type==="freedraw")&&d?t.activeTool:f,activeEmbeddable:null,newElement:null,selectionElement:null,multiElement:null,editingTextElement:null,startBoundElement:null,suggestedBindings:[],selectedElementIds:d&&!t.activeTool.locked&&t.activeTool.type!=="freedraw"?{...t.selectedElementIds,[d.id]:!0}:t.selectedElementIds,selectedLinearElement:d&&Se(d)?new pe(d,ve(u)):t.selectedLinearElement},captureUpdate:K.IMMEDIATELY}},keyTest:(e,t)=>{var n;return e.key===H.ESCAPE&&(((n=t.selectedLinearElement)==null?void 0:n.isEditing)||!t.newElement&&t.multiElement===null)||(e.key===H.ESCAPE||e.key===H.ENTER)&&t.multiElement!==null},PanelComponent:({appState:e,updateData:t,data:n})=>g($e,{type:"button",icon:hde,title:M("buttons.done"),"aria-label":M("buttons.done"),onClick:t,visible:e.multiElement!=null,size:(n==null?void 0:n.size)||"medium",style:{pointerEvents:"all"}})}),bT=({children:e,checked:t,onChange:n,className:i})=>N("div",{className:re("Checkbox",i,{"is-checked":t}),onClick:s=>{n(!t,s),s.currentTarget.querySelector(".Checkbox-box").focus()},children:[g("button",{type:"button",className:"Checkbox-box",role:"checkbox","aria-checked":t,children:lde}),g("div",{className:"Checkbox-label",children:e})]}),k2e=e=>{const t=e.title||(e.value===ke.DARK?M("buttons.lightMode"):M("buttons.darkMode"));return g($e,{type:"icon",icon:e.value===ke.LIGHT?Nk.MOON:Nk.SUN,title:t,"aria-label":t,onClick:()=>e.onChange(e.value===ke.DARK?ke.LIGHT:ke.DARK),"data-testid":"toggle-dark-mode"})},Nk={SUN:g("svg",{width:"512",height:"512",className:"rtl-mirror",viewBox:"0 0 512 512",children:g("path",{fill:"currentColor",d:"M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96 96-43.1 96-96-43.1-96-96-96zm246.4 80.5l-94.7-47.3 33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5-47.4-94.8c-6.4-12.8-24.6-12.8-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4-94.7 47.4c-12.8 6.4-12.8 24.6 0 31l94.7 47.3-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.4-33.5 47.3 94.7c6.4 12.8 24.6 12.8 31 0l47.3-94.7 100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4 94.7-47.3c13-6.5 13-24.7.2-31.1zm-155.9 106c-49.9 49.9-131.1 49.9-181 0-49.9-49.9-49.9-131.1 0-181 49.9-49.9 131.1-49.9 181 0 49.9 49.9 49.9 131.1 0 181z"})}),MOON:g("svg",{width:"512",height:"512",className:"rtl-mirror",viewBox:"0 0 512 512",children:g("path",{fill:"currentColor",d:"M283.211 512c78.962 0 151.079-35.925 198.857-94.792 7.068-8.708-.639-21.43-11.562-19.35-124.203 23.654-238.262-71.576-238.262-196.954 0-72.222 38.662-138.635 101.498-174.394 9.686-5.512 7.25-20.197-3.756-22.23A258.156 258.156 0 0 0 283.211 0c-141.309 0-256 114.511-256 256 0 141.309 114.511 256 256 256z"})})},R2e=e=>{const{id:t}=Lr(),[n,i]=D.useState(e.value),s=o=>{e.ignoreFocus||Sre(o.target);const a=o.target.value;a!==e.value&&e.onChange(a)},r=o=>{if(o.key===H.ENTER){if(o.preventDefault(),o.nativeEvent.isComposing||o.keyCode===229)return;o.currentTarget.blur()}};return N("div",{className:"ProjectName",children:[g("label",{className:"ProjectName-label",htmlFor:"filename",children:`${e.label}:`}),g("input",{type:"text",className:"TextInput",onBlur:s,onKeyDown:r,id:`${t}-filename`,value:n,onChange:o=>i(o.target.value)})]})};/*! pako 2.0.3 https://github.com/nodeca/pako @license (MIT AND Zlib) */const D2e=4,Ok=0,Pk=1,L2e=2;function xg(e){let t=e.length;for(;--t>=0;)e[t]=0}const N2e=0,q$=1,O2e=2,P2e=3,F2e=258,yT=29,kp=256,Em=kp+1+yT,ph=30,ET=19,Q$=2*Em+1,Ou=15,t3=16,B2e=7,vT=256,J$=16,eG=17,tG=18,hv=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),$2=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),z2e=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),nG=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),H2e=512,_a=new Array((Em+2)*2);xg(_a);const x0=new Array(ph*2);xg(x0);const vm=new Array(H2e);xg(vm);const wm=new Array(F2e-P2e+1);xg(wm);const wT=new Array(yT);xg(wT);const O6=new Array(ph);xg(O6);function n3(e,t,n,i,s){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=i,this.max_length=s,this.has_stree=e&&e.length}let iG,sG,rG;function i3(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}const oG=e=>e<256?vm[e]:vm[256+(e>>>7)],_m=(e,t)=>{e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255},_s=(e,t,n)=>{e.bi_valid>t3-n?(e.bi_buf|=t<<e.bi_valid&65535,_m(e,e.bi_buf),e.bi_buf=t>>t3-e.bi_valid,e.bi_valid+=n-t3):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},Lo=(e,t,n)=>{_s(e,n[t*2],n[t*2+1])},aG=(e,t)=>{let n=0;do n|=e&1,e>>>=1,n<<=1;while(--t>0);return n>>>1},V2e=e=>{e.bi_valid===16?(_m(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},$2e=(e,t)=>{const n=t.dyn_tree,i=t.max_code,s=t.stat_desc.static_tree,r=t.stat_desc.has_stree,o=t.stat_desc.extra_bits,a=t.stat_desc.extra_base,l=t.stat_desc.max_length;let c,u,d,f,h,m,p=0;for(f=0;f<=Ou;f++)e.bl_count[f]=0;for(n[e.heap[e.heap_max]*2+1]=0,c=e.heap_max+1;c<Q$;c++)u=e.heap[c],f=n[n[u*2+1]*2+1]+1,f>l&&(f=l,p++),n[u*2+1]=f,!(u>i)&&(e.bl_count[f]++,h=0,u>=a&&(h=o[u-a]),m=n[u*2],e.opt_len+=m*(f+h),r&&(e.static_len+=m*(s[u*2+1]+h)));if(p!==0){do{for(f=l-1;e.bl_count[f]===0;)f--;e.bl_count[f]--,e.bl_count[f+1]+=2,e.bl_count[l]--,p-=2}while(p>0);for(f=l;f!==0;f--)for(u=e.bl_count[f];u!==0;)d=e.heap[--c],!(d>i)&&(n[d*2+1]!==f&&(e.opt_len+=(f-n[d*2+1])*n[d*2],n[d*2+1]=f),u--)}},lG=(e,t,n)=>{const i=new Array(Ou+1);let s=0,r,o;for(r=1;r<=Ou;r++)i[r]=s=s+n[r-1]<<1;for(o=0;o<=t;o++){let a=e[o*2+1];a!==0&&(e[o*2]=aG(i[a]++,a))}},G2e=()=>{let e,t,n,i,s;const r=new Array(Ou+1);for(n=0,i=0;i<yT-1;i++)for(wT[i]=n,e=0;e<1<<hv[i];e++)wm[n++]=i;for(wm[n-1]=i,s=0,i=0;i<16;i++)for(O6[i]=s,e=0;e<1<<$2[i];e++)vm[s++]=i;for(s>>=7;i<ph;i++)for(O6[i]=s<<7,e=0;e<1<<$2[i]-7;e++)vm[256+s++]=i;for(t=0;t<=Ou;t++)r[t]=0;for(e=0;e<=143;)_a[e*2+1]=8,e++,r[8]++;for(;e<=255;)_a[e*2+1]=9,e++,r[9]++;for(;e<=279;)_a[e*2+1]=7,e++,r[7]++;for(;e<=287;)_a[e*2+1]=8,e++,r[8]++;for(lG(_a,Em+1,r),e=0;e<ph;e++)x0[e*2+1]=5,x0[e*2]=aG(e,5);iG=new n3(_a,hv,kp+1,Em,Ou),sG=new n3(x0,$2,0,ph,Ou),rG=new n3(new Array(0),z2e,0,ET,B2e)},cG=e=>{let t;for(t=0;t<Em;t++)e.dyn_ltree[t*2]=0;for(t=0;t<ph;t++)e.dyn_dtree[t*2]=0;for(t=0;t<ET;t++)e.bl_tree[t*2]=0;e.dyn_ltree[vT*2]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0},uG=e=>{e.bi_valid>8?_m(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},X2e=(e,t,n,i)=>{uG(e),_m(e,n),_m(e,~n),e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n},Fk=(e,t,n,i)=>{const s=t*2,r=n*2;return e[s]<e[r]||e[s]===e[r]&&i[t]<=i[n]},s3=(e,t,n)=>{const i=e.heap[n];let s=n<<1;for(;s<=e.heap_len&&(s<e.heap_len&&Fk(t,e.heap[s+1],e.heap[s],e.depth)&&s++,!Fk(t,i,e.heap[s],e.depth));)e.heap[n]=e.heap[s],n=s,s<<=1;e.heap[n]=i},Bk=(e,t,n)=>{let i,s,r=0,o,a;if(e.last_lit!==0)do i=e.pending_buf[e.d_buf+r*2]<<8|e.pending_buf[e.d_buf+r*2+1],s=e.pending_buf[e.l_buf+r],r++,i===0?Lo(e,s,t):(o=wm[s],Lo(e,o+kp+1,t),a=hv[o],a!==0&&(s-=wT[o],_s(e,s,a)),i--,o=oG(i),Lo(e,o,n),a=$2[o],a!==0&&(i-=O6[o],_s(e,i,a)));while(r<e.last_lit);Lo(e,vT,t)},gv=(e,t)=>{const n=t.dyn_tree,i=t.stat_desc.static_tree,s=t.stat_desc.has_stree,r=t.stat_desc.elems;let o,a,l=-1,c;for(e.heap_len=0,e.heap_max=Q$,o=0;o<r;o++)n[o*2]!==0?(e.heap[++e.heap_len]=l=o,e.depth[o]=0):n[o*2+1]=0;for(;e.heap_len<2;)c=e.heap[++e.heap_len]=l<2?++l:0,n[c*2]=1,e.depth[c]=0,e.opt_len--,s&&(e.static_len-=i[c*2+1]);for(t.max_code=l,o=e.heap_len>>1;o>=1;o--)s3(e,n,o);c=r;do o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],s3(e,n,1),a=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=a,n[c*2]=n[o*2]+n[a*2],e.depth[c]=(e.depth[o]>=e.depth[a]?e.depth[o]:e.depth[a])+1,n[o*2+1]=n[a*2+1]=c,e.heap[1]=c++,s3(e,n,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],$2e(e,t),lG(n,l,e.bl_count)},zk=(e,t,n)=>{let i,s=-1,r,o=t[0*2+1],a=0,l=7,c=4;for(o===0&&(l=138,c=3),t[(n+1)*2+1]=65535,i=0;i<=n;i++)r=o,o=t[(i+1)*2+1],!(++a<l&&r===o)&&(a<c?e.bl_tree[r*2]+=a:r!==0?(r!==s&&e.bl_tree[r*2]++,e.bl_tree[J$*2]++):a<=10?e.bl_tree[eG*2]++:e.bl_tree[tG*2]++,a=0,s=r,o===0?(l=138,c=3):r===o?(l=6,c=3):(l=7,c=4))},Hk=(e,t,n)=>{let i,s=-1,r,o=t[0*2+1],a=0,l=7,c=4;for(o===0&&(l=138,c=3),i=0;i<=n;i++)if(r=o,o=t[(i+1)*2+1],!(++a<l&&r===o)){if(a<c)do Lo(e,r,e.bl_tree);while(--a!==0);else r!==0?(r!==s&&(Lo(e,r,e.bl_tree),a--),Lo(e,J$,e.bl_tree),_s(e,a-3,2)):a<=10?(Lo(e,eG,e.bl_tree),_s(e,a-3,3)):(Lo(e,tG,e.bl_tree),_s(e,a-11,7));a=0,s=r,o===0?(l=138,c=3):r===o?(l=6,c=3):(l=7,c=4)}},j2e=e=>{let t;for(zk(e,e.dyn_ltree,e.l_desc.max_code),zk(e,e.dyn_dtree,e.d_desc.max_code),gv(e,e.bl_desc),t=ET-1;t>=3&&e.bl_tree[nG[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t},Y2e=(e,t,n,i)=>{let s;for(_s(e,t-257,5),_s(e,n-1,5),_s(e,i-4,4),s=0;s<i;s++)_s(e,e.bl_tree[nG[s]*2+1],3);Hk(e,e.dyn_ltree,t-1),Hk(e,e.dyn_dtree,n-1)},W2e=e=>{let t=4093624447,n;for(n=0;n<=31;n++,t>>>=1)if(t&1&&e.dyn_ltree[n*2]!==0)return Ok;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return Pk;for(n=32;n<kp;n++)if(e.dyn_ltree[n*2]!==0)return Pk;return Ok};let Vk=!1;const K2e=e=>{Vk||(G2e(),Vk=!0),e.l_desc=new i3(e.dyn_ltree,iG),e.d_desc=new i3(e.dyn_dtree,sG),e.bl_desc=new i3(e.bl_tree,rG),e.bi_buf=0,e.bi_valid=0,cG(e)},dG=(e,t,n,i)=>{_s(e,(N2e<<1)+(i?1:0),3),X2e(e,t,n)},Z2e=e=>{_s(e,q$<<1,3),Lo(e,vT,_a),V2e(e)},q2e=(e,t,n,i)=>{let s,r,o=0;e.level>0?(e.strm.data_type===L2e&&(e.strm.data_type=W2e(e)),gv(e,e.l_desc),gv(e,e.d_desc),o=j2e(e),s=e.opt_len+3+7>>>3,r=e.static_len+3+7>>>3,r<=s&&(s=r)):s=r=n+5,n+4<=s&&t!==-1?dG(e,t,n,i):e.strategy===D2e||r===s?(_s(e,(q$<<1)+(i?1:0),3),Bk(e,_a,x0)):(_s(e,(O2e<<1)+(i?1:0),3),Y2e(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),Bk(e,e.dyn_ltree,e.dyn_dtree)),cG(e),i&&uG(e)},Q2e=(e,t,n)=>(e.pending_buf[e.d_buf+e.last_lit*2]=t>>>8&255,e.pending_buf[e.d_buf+e.last_lit*2+1]=t&255,e.pending_buf[e.l_buf+e.last_lit]=n&255,e.last_lit++,t===0?e.dyn_ltree[n*2]++:(e.matches++,t--,e.dyn_ltree[(wm[n]+kp+1)*2]++,e.dyn_dtree[oG(t)*2]++),e.last_lit===e.lit_bufsize-1);var J2e=K2e,ebe=dG,tbe=q2e,nbe=Q2e,ibe=Z2e,sbe={_tr_init:J2e,_tr_stored_block:ebe,_tr_flush_block:tbe,_tr_tally:nbe,_tr_align:ibe};const rbe=(e,t,n,i)=>{let s=e&65535|0,r=e>>>16&65535|0,o=0;for(;n!==0;){o=n>2e3?2e3:n,n-=o;do s=s+t[i++]|0,r=r+s|0;while(--o);s%=65521,r%=65521}return s|r<<16|0};var Tm=rbe;const obe=()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=e&1?3988292384^e>>>1:e>>>1;t[n]=e}return t},abe=new Uint32Array(obe()),lbe=(e,t,n,i)=>{const s=abe,r=i+n;e^=-1;for(let o=i;o<r;o++)e=e>>>8^s[(e^t[o])&255];return e^-1};var ci=lbe,yd={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Ty={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:cbe,_tr_stored_block:ube,_tr_flush_block:dbe,_tr_tally:vc,_tr_align:fbe}=sbe,{Z_NO_FLUSH:$d,Z_PARTIAL_FLUSH:hbe,Z_FULL_FLUSH:gbe,Z_FINISH:wc,Z_BLOCK:$k,Z_OK:No,Z_STREAM_END:Gk,Z_STREAM_ERROR:xr,Z_DATA_ERROR:mbe,Z_BUF_ERROR:r3,Z_DEFAULT_COMPRESSION:pbe,Z_FILTERED:Ube,Z_HUFFMAN_ONLY:XU,Z_RLE:bbe,Z_FIXED:ybe,Z_DEFAULT_STRATEGY:Ebe,Z_UNKNOWN:vbe,Z_DEFLATED:Iy}=Ty,wbe=9,_be=15,Tbe=8,Ibe=29,Sbe=256,mv=Sbe+1+Ibe,xbe=30,Cbe=19,Abe=2*mv+1,Mbe=15,ot=3,rc=258,to=rc+ot+1,kbe=32,Sy=42,pv=69,G2=73,X2=91,j2=103,Pu=113,B1=666,ei=1,Rp=2,Ed=3,Cg=4,Rbe=3,oc=(e,t)=>(e.msg=yd[t],t),Xk=e=>(e<<1)-(e>4?9:0),ec=e=>{let t=e.length;for(;--t>=0;)e[t]=0};let Dbe=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask,_c=Dbe;const zl=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),n!==0&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,t.pending===0&&(t.pending_out=0))},ki=(e,t)=>{dbe(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,zl(e.strm)},wt=(e,t)=>{e.pending_buf[e.pending++]=t},h1=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255},Lbe=(e,t,n,i)=>{let s=e.avail_in;return s>i&&(s=i),s===0?0:(e.avail_in-=s,t.set(e.input.subarray(e.next_in,e.next_in+s),n),e.state.wrap===1?e.adler=Tm(e.adler,t,s,n):e.state.wrap===2&&(e.adler=ci(e.adler,t,s,n)),e.next_in+=s,e.total_in+=s,s)},fG=(e,t)=>{let n=e.max_chain_length,i=e.strstart,s,r,o=e.prev_length,a=e.nice_match;const l=e.strstart>e.w_size-to?e.strstart-(e.w_size-to):0,c=e.window,u=e.w_mask,d=e.prev,f=e.strstart+rc;let h=c[i+o-1],m=c[i+o];e.prev_length>=e.good_match&&(n>>=2),a>e.lookahead&&(a=e.lookahead);do if(s=t,!(c[s+o]!==m||c[s+o-1]!==h||c[s]!==c[i]||c[++s]!==c[i+1])){i+=2,s++;do;while(c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&i<f);if(r=rc-(f-i),i=f-rc,r>o){if(e.match_start=t,o=r,r>=a)break;h=c[i+o-1],m=c[i+o]}}while((t=d[t&u])>l&&--n!==0);return o<=e.lookahead?o:e.lookahead},vd=e=>{const t=e.w_size;let n,i,s,r,o;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-to)){e.window.set(e.window.subarray(t,t+t),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,i=e.hash_size,n=i;do s=e.head[--n],e.head[n]=s>=t?s-t:0;while(--i);i=t,n=i;do s=e.prev[--n],e.prev[n]=s>=t?s-t:0;while(--i);r+=t}if(e.strm.avail_in===0)break;if(i=Lbe(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=i,e.lookahead+e.insert>=ot)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=_c(e,e.ins_h,e.window[o+1]);e.insert&&(e.ins_h=_c(e,e.ins_h,e.window[o+ot-1]),e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<ot)););}while(e.lookahead<to&&e.strm.avail_in!==0)},Nbe=(e,t)=>{let n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(vd(e),e.lookahead===0&&t===$d)return ei;if(e.lookahead===0)break}e.strstart+=e.lookahead,e.lookahead=0;const i=e.block_start+n;if((e.strstart===0||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,ki(e,!1),e.strm.avail_out===0)||e.strstart-e.block_start>=e.w_size-to&&(ki(e,!1),e.strm.avail_out===0))return ei}return e.insert=0,t===wc?(ki(e,!0),e.strm.avail_out===0?Ed:Cg):(e.strstart>e.block_start&&(ki(e,!1),e.strm.avail_out===0),ei)},o3=(e,t)=>{let n,i;for(;;){if(e.lookahead<to){if(vd(e),e.lookahead<to&&t===$d)return ei;if(e.lookahead===0)break}if(n=0,e.lookahead>=ot&&(e.ins_h=_c(e,e.ins_h,e.window[e.strstart+ot-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),n!==0&&e.strstart-n<=e.w_size-to&&(e.match_length=fG(e,n)),e.match_length>=ot)if(i=vc(e,e.strstart-e.match_start,e.match_length-ot),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=ot){e.match_length--;do e.strstart++,e.ins_h=_c(e,e.ins_h,e.window[e.strstart+ot-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=_c(e,e.ins_h,e.window[e.strstart+1]);else i=vc(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(ki(e,!1),e.strm.avail_out===0))return ei}return e.insert=e.strstart<ot-1?e.strstart:ot-1,t===wc?(ki(e,!0),e.strm.avail_out===0?Ed:Cg):e.last_lit&&(ki(e,!1),e.strm.avail_out===0)?ei:Rp},lf=(e,t)=>{let n,i,s;for(;;){if(e.lookahead<to){if(vd(e),e.lookahead<to&&t===$d)return ei;if(e.lookahead===0)break}if(n=0,e.lookahead>=ot&&(e.ins_h=_c(e,e.ins_h,e.window[e.strstart+ot-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=ot-1,n!==0&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-to&&(e.match_length=fG(e,n),e.match_length<=5&&(e.strategy===Ube||e.match_length===ot&&e.strstart-e.match_start>4096)&&(e.match_length=ot-1)),e.prev_length>=ot&&e.match_length<=e.prev_length){s=e.strstart+e.lookahead-ot,i=vc(e,e.strstart-1-e.prev_match,e.prev_length-ot),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=s&&(e.ins_h=_c(e,e.ins_h,e.window[e.strstart+ot-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=ot-1,e.strstart++,i&&(ki(e,!1),e.strm.avail_out===0))return ei}else if(e.match_available){if(i=vc(e,0,e.window[e.strstart-1]),i&&ki(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return ei}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=vc(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<ot-1?e.strstart:ot-1,t===wc?(ki(e,!0),e.strm.avail_out===0?Ed:Cg):e.last_lit&&(ki(e,!1),e.strm.avail_out===0)?ei:Rp},Obe=(e,t)=>{let n,i,s,r;const o=e.window;for(;;){if(e.lookahead<=rc){if(vd(e),e.lookahead<=rc&&t===$d)return ei;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=ot&&e.strstart>0&&(s=e.strstart-1,i=o[s],i===o[++s]&&i===o[++s]&&i===o[++s])){r=e.strstart+rc;do;while(i===o[++s]&&i===o[++s]&&i===o[++s]&&i===o[++s]&&i===o[++s]&&i===o[++s]&&i===o[++s]&&i===o[++s]&&s<r);e.match_length=rc-(r-s),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=ot?(n=vc(e,1,e.match_length-ot),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=vc(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(ki(e,!1),e.strm.avail_out===0))return ei}return e.insert=0,t===wc?(ki(e,!0),e.strm.avail_out===0?Ed:Cg):e.last_lit&&(ki(e,!1),e.strm.avail_out===0)?ei:Rp},Pbe=(e,t)=>{let n;for(;;){if(e.lookahead===0&&(vd(e),e.lookahead===0)){if(t===$d)return ei;break}if(e.match_length=0,n=vc(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(ki(e,!1),e.strm.avail_out===0))return ei}return e.insert=0,t===wc?(ki(e,!0),e.strm.avail_out===0?Ed:Cg):e.last_lit&&(ki(e,!1),e.strm.avail_out===0)?ei:Rp};function bo(e,t,n,i,s){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=i,this.func=s}const z1=[new bo(0,0,0,0,Nbe),new bo(4,4,8,4,o3),new bo(4,5,16,8,o3),new bo(4,6,32,32,o3),new bo(4,4,16,16,lf),new bo(8,16,32,32,lf),new bo(8,16,128,128,lf),new bo(8,32,128,256,lf),new bo(32,128,258,1024,lf),new bo(32,258,258,4096,lf)],Fbe=e=>{e.window_size=2*e.w_size,ec(e.head),e.max_lazy_match=z1[e.level].max_lazy,e.good_match=z1[e.level].good_length,e.nice_match=z1[e.level].nice_length,e.max_chain_length=z1[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=ot-1,e.match_available=0,e.ins_h=0};function Bbe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Iy,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(Abe*2),this.dyn_dtree=new Uint16Array((2*xbe+1)*2),this.bl_tree=new Uint16Array((2*Cbe+1)*2),ec(this.dyn_ltree),ec(this.dyn_dtree),ec(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(Mbe+1),this.heap=new Uint16Array(2*mv+1),ec(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*mv+1),ec(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const hG=e=>{if(!e||!e.state)return oc(e,xr);e.total_in=e.total_out=0,e.data_type=vbe;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?Sy:Pu,e.adler=t.wrap===2?0:1,t.last_flush=$d,cbe(t),No},gG=e=>{const t=hG(e);return t===No&&Fbe(e.state),t},zbe=(e,t)=>!e||!e.state||e.state.wrap!==2?xr:(e.state.gzhead=t,No),mG=(e,t,n,i,s,r)=>{if(!e)return xr;let o=1;if(t===pbe&&(t=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),s<1||s>wbe||n!==Iy||i<8||i>15||t<0||t>9||r<0||r>ybe)return oc(e,xr);i===8&&(i=9);const a=new Bbe;return e.state=a,a.strm=e,a.wrap=o,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=s+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+ot-1)/ot),a.window=new Uint8Array(a.w_size*2),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<s+6,a.pending_buf_size=a.lit_bufsize*4,a.pending_buf=new Uint8Array(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=3*a.lit_bufsize,a.level=t,a.strategy=r,a.method=n,gG(e)},Hbe=(e,t)=>mG(e,t,Iy,_be,Tbe,Ebe),Vbe=(e,t)=>{let n,i;if(!e||!e.state||t>$k||t<0)return e?oc(e,xr):xr;const s=e.state;if(!e.output||!e.input&&e.avail_in!==0||s.status===B1&&t!==wc)return oc(e,e.avail_out===0?r3:xr);s.strm=e;const r=s.last_flush;if(s.last_flush=t,s.status===Sy)if(s.wrap===2)e.adler=0,wt(s,31),wt(s,139),wt(s,8),s.gzhead?(wt(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),wt(s,s.gzhead.time&255),wt(s,s.gzhead.time>>8&255),wt(s,s.gzhead.time>>16&255),wt(s,s.gzhead.time>>24&255),wt(s,s.level===9?2:s.strategy>=XU||s.level<2?4:0),wt(s,s.gzhead.os&255),s.gzhead.extra&&s.gzhead.extra.length&&(wt(s,s.gzhead.extra.length&255),wt(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(e.adler=ci(e.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=pv):(wt(s,0),wt(s,0),wt(s,0),wt(s,0),wt(s,0),wt(s,s.level===9?2:s.strategy>=XU||s.level<2?4:0),wt(s,Rbe),s.status=Pu);else{let o=Iy+(s.w_bits-8<<4)<<8,a=-1;s.strategy>=XU||s.level<2?a=0:s.level<6?a=1:s.level===6?a=2:a=3,o|=a<<6,s.strstart!==0&&(o|=kbe),o+=31-o%31,s.status=Pu,h1(s,o),s.strstart!==0&&(h1(s,e.adler>>>16),h1(s,e.adler&65535)),e.adler=1}if(s.status===pv)if(s.gzhead.extra){for(n=s.pending;s.gzindex<(s.gzhead.extra.length&65535)&&!(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>n&&(e.adler=ci(e.adler,s.pending_buf,s.pending-n,n)),zl(e),n=s.pending,s.pending===s.pending_buf_size));)wt(s,s.gzhead.extra[s.gzindex]&255),s.gzindex++;s.gzhead.hcrc&&s.pending>n&&(e.adler=ci(e.adler,s.pending_buf,s.pending-n,n)),s.gzindex===s.gzhead.extra.length&&(s.gzindex=0,s.status=G2)}else s.status=G2;if(s.status===G2)if(s.gzhead.name){n=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>n&&(e.adler=ci(e.adler,s.pending_buf,s.pending-n,n)),zl(e),n=s.pending,s.pending===s.pending_buf_size)){i=1;break}s.gzindex<s.gzhead.name.length?i=s.gzhead.name.charCodeAt(s.gzindex++)&255:i=0,wt(s,i)}while(i!==0);s.gzhead.hcrc&&s.pending>n&&(e.adler=ci(e.adler,s.pending_buf,s.pending-n,n)),i===0&&(s.gzindex=0,s.status=X2)}else s.status=X2;if(s.status===X2)if(s.gzhead.comment){n=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>n&&(e.adler=ci(e.adler,s.pending_buf,s.pending-n,n)),zl(e),n=s.pending,s.pending===s.pending_buf_size)){i=1;break}s.gzindex<s.gzhead.comment.length?i=s.gzhead.comment.charCodeAt(s.gzindex++)&255:i=0,wt(s,i)}while(i!==0);s.gzhead.hcrc&&s.pending>n&&(e.adler=ci(e.adler,s.pending_buf,s.pending-n,n)),i===0&&(s.status=j2)}else s.status=j2;if(s.status===j2&&(s.gzhead.hcrc?(s.pending+2>s.pending_buf_size&&zl(e),s.pending+2<=s.pending_buf_size&&(wt(s,e.adler&255),wt(s,e.adler>>8&255),e.adler=0,s.status=Pu)):s.status=Pu),s.pending!==0){if(zl(e),e.avail_out===0)return s.last_flush=-1,No}else if(e.avail_in===0&&Xk(t)<=Xk(r)&&t!==wc)return oc(e,r3);if(s.status===B1&&e.avail_in!==0)return oc(e,r3);if(e.avail_in!==0||s.lookahead!==0||t!==$d&&s.status!==B1){let o=s.strategy===XU?Pbe(s,t):s.strategy===bbe?Obe(s,t):z1[s.level].func(s,t);if((o===Ed||o===Cg)&&(s.status=B1),o===ei||o===Ed)return e.avail_out===0&&(s.last_flush=-1),No;if(o===Rp&&(t===hbe?fbe(s):t!==$k&&(ube(s,0,0,!1),t===gbe&&(ec(s.head),s.lookahead===0&&(s.strstart=0,s.block_start=0,s.insert=0))),zl(e),e.avail_out===0))return s.last_flush=-1,No}return t!==wc?No:s.wrap<=0?Gk:(s.wrap===2?(wt(s,e.adler&255),wt(s,e.adler>>8&255),wt(s,e.adler>>16&255),wt(s,e.adler>>24&255),wt(s,e.total_in&255),wt(s,e.total_in>>8&255),wt(s,e.total_in>>16&255),wt(s,e.total_in>>24&255)):(h1(s,e.adler>>>16),h1(s,e.adler&65535)),zl(e),s.wrap>0&&(s.wrap=-s.wrap),s.pending!==0?No:Gk)},$be=e=>{if(!e||!e.state)return xr;const t=e.state.status;return t!==Sy&&t!==pv&&t!==G2&&t!==X2&&t!==j2&&t!==Pu&&t!==B1?oc(e,xr):(e.state=null,t===Pu?oc(e,mbe):No)},Gbe=(e,t)=>{let n=t.length;if(!e||!e.state)return xr;const i=e.state,s=i.wrap;if(s===2||s===1&&i.status!==Sy||i.lookahead)return xr;if(s===1&&(e.adler=Tm(e.adler,t,n,0)),i.wrap=0,n>=i.w_size){s===0&&(ec(i.head),i.strstart=0,i.block_start=0,i.insert=0);let l=new Uint8Array(i.w_size);l.set(t.subarray(n-i.w_size,n),0),t=l,n=i.w_size}const r=e.avail_in,o=e.next_in,a=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,vd(i);i.lookahead>=ot;){let l=i.strstart,c=i.lookahead-(ot-1);do i.ins_h=_c(i,i.ins_h,i.window[l+ot-1]),i.prev[l&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=l,l++;while(--c);i.strstart=l,i.lookahead=ot-1,vd(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=ot-1,i.match_available=0,e.next_in=o,e.input=a,e.avail_in=r,i.wrap=s,No};var Xbe=Hbe,jbe=mG,Ybe=gG,Wbe=hG,Kbe=zbe,Zbe=Vbe,qbe=$be,Qbe=Gbe,Jbe="pako deflate (from Nodeca project)",C0={deflateInit:Xbe,deflateInit2:jbe,deflateReset:Ybe,deflateResetKeep:Wbe,deflateSetHeader:Kbe,deflate:Zbe,deflateEnd:qbe,deflateSetDictionary:Qbe,deflateInfo:Jbe};const e6e=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var t6e=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const i in n)e6e(n,i)&&(e[i]=n[i])}}return e},n6e=e=>{let t=0;for(let i=0,s=e.length;i<s;i++)t+=e[i].length;const n=new Uint8Array(t);for(let i=0,s=0,r=e.length;i<r;i++){let o=e[i];n.set(o,s),s+=o.length}return n},xy={assign:t6e,flattenChunks:n6e};let pG=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{pG=!1}const Im=new Uint8Array(256);for(let e=0;e<256;e++)Im[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Im[254]=Im[254]=1;var i6e=e=>{let t,n,i,s,r,o=e.length,a=0;for(s=0;s<o;s++)n=e.charCodeAt(s),(n&64512)===55296&&s+1<o&&(i=e.charCodeAt(s+1),(i&64512)===56320&&(n=65536+(n-55296<<10)+(i-56320),s++)),a+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(a),r=0,s=0;r<a;s++)n=e.charCodeAt(s),(n&64512)===55296&&s+1<o&&(i=e.charCodeAt(s+1),(i&64512)===56320&&(n=65536+(n-55296<<10)+(i-56320),s++)),n<128?t[r++]=n:n<2048?(t[r++]=192|n>>>6,t[r++]=128|n&63):n<65536?(t[r++]=224|n>>>12,t[r++]=128|n>>>6&63,t[r++]=128|n&63):(t[r++]=240|n>>>18,t[r++]=128|n>>>12&63,t[r++]=128|n>>>6&63,t[r++]=128|n&63);return t};const s6e=(e,t)=>{if(t<65534&&e.subarray&&pG)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let i=0;i<t;i++)n+=String.fromCharCode(e[i]);return n};var r6e=(e,t)=>{let n,i;const s=t||e.length,r=new Array(s*2);for(i=0,n=0;n<s;){let o=e[n++];if(o<128){r[i++]=o;continue}let a=Im[o];if(a>4){r[i++]=65533,n+=a-1;continue}for(o&=a===2?31:a===3?15:7;a>1&&n<s;)o=o<<6|e[n++]&63,a--;if(a>1){r[i++]=65533;continue}o<65536?r[i++]=o:(o-=65536,r[i++]=55296|o>>10&1023,r[i++]=56320|o&1023)}return s6e(r,i)},o6e=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let n=t-1;for(;n>=0&&(e[n]&192)===128;)n--;return n<0||n===0?t:n+Im[e[n]]>t?n:t},Sm={string2buf:i6e,buf2string:r6e,utf8border:o6e};function a6e(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var UG=a6e;const bG=Object.prototype.toString,{Z_NO_FLUSH:l6e,Z_SYNC_FLUSH:c6e,Z_FULL_FLUSH:u6e,Z_FINISH:d6e,Z_OK:P6,Z_STREAM_END:f6e,Z_DEFAULT_COMPRESSION:h6e,Z_DEFAULT_STRATEGY:g6e,Z_DEFLATED:m6e}=Ty;function Cy(e){this.options=xy.assign({level:h6e,method:m6e,chunkSize:16384,windowBits:15,memLevel:8,strategy:g6e},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new UG,this.strm.avail_out=0;let n=C0.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==P6)throw new Error(yd[n]);if(t.header&&C0.deflateSetHeader(this.strm,t.header),t.dictionary){let i;if(typeof t.dictionary=="string"?i=Sm.string2buf(t.dictionary):bG.call(t.dictionary)==="[object ArrayBuffer]"?i=new Uint8Array(t.dictionary):i=t.dictionary,n=C0.deflateSetDictionary(this.strm,i),n!==P6)throw new Error(yd[n]);this._dict_set=!0}}Cy.prototype.push=function(e,t){const n=this.strm,i=this.options.chunkSize;let s,r;if(this.ended)return!1;for(t===~~t?r=t:r=t===!0?d6e:l6e,typeof e=="string"?n.input=Sm.string2buf(e):bG.call(e)==="[object ArrayBuffer]"?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){if(n.avail_out===0&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),(r===c6e||r===u6e)&&n.avail_out<=6){this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;continue}if(s=C0.deflate(n,r),s===f6e)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),s=C0.deflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===P6;if(n.avail_out===0){this.onData(n.output);continue}if(r>0&&n.next_out>0){this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;continue}if(n.avail_in===0)break}return!0};Cy.prototype.onData=function(e){this.chunks.push(e)};Cy.prototype.onEnd=function(e){e===P6&&(this.result=xy.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function p6e(e,t){const n=new Cy(t);if(n.push(e,!0),n.err)throw n.msg||yd[n.err];return n.result}var U6e=p6e,b6e={deflate:U6e};const jU=30,y6e=12;var E6e=function(t,n){let i,s,r,o,a,l,c,u,d,f,h,m,p,U,b,y,w,v,I,C,_,T,k,S;const R=t.state;i=t.next_in,k=t.input,s=i+(t.avail_in-5),r=t.next_out,S=t.output,o=r-(n-t.avail_out),a=r+(t.avail_out-257),l=R.dmax,c=R.wsize,u=R.whave,d=R.wnext,f=R.window,h=R.hold,m=R.bits,p=R.lencode,U=R.distcode,b=(1<<R.lenbits)-1,y=(1<<R.distbits)-1;e:do{m<15&&(h+=k[i++]<<m,m+=8,h+=k[i++]<<m,m+=8),w=p[h&b];t:for(;;){if(v=w>>>24,h>>>=v,m-=v,v=w>>>16&255,v===0)S[r++]=w&65535;else if(v&16){I=w&65535,v&=15,v&&(m<v&&(h+=k[i++]<<m,m+=8),I+=h&(1<<v)-1,h>>>=v,m-=v),m<15&&(h+=k[i++]<<m,m+=8,h+=k[i++]<<m,m+=8),w=U[h&y];n:for(;;){if(v=w>>>24,h>>>=v,m-=v,v=w>>>16&255,v&16){if(C=w&65535,v&=15,m<v&&(h+=k[i++]<<m,m+=8,m<v&&(h+=k[i++]<<m,m+=8)),C+=h&(1<<v)-1,C>l){t.msg="invalid distance too far back",R.mode=jU;break e}if(h>>>=v,m-=v,v=r-o,C>v){if(v=C-v,v>u&&R.sane){t.msg="invalid distance too far back",R.mode=jU;break e}if(_=0,T=f,d===0){if(_+=c-v,v<I){I-=v;do S[r++]=f[_++];while(--v);_=r-C,T=S}}else if(d<v){if(_+=c+d-v,v-=d,v<I){I-=v;do S[r++]=f[_++];while(--v);if(_=0,d<I){v=d,I-=v;do S[r++]=f[_++];while(--v);_=r-C,T=S}}}else if(_+=d-v,v<I){I-=v;do S[r++]=f[_++];while(--v);_=r-C,T=S}for(;I>2;)S[r++]=T[_++],S[r++]=T[_++],S[r++]=T[_++],I-=3;I&&(S[r++]=T[_++],I>1&&(S[r++]=T[_++]))}else{_=r-C;do S[r++]=S[_++],S[r++]=S[_++],S[r++]=S[_++],I-=3;while(I>2);I&&(S[r++]=S[_++],I>1&&(S[r++]=S[_++]))}}else if(v&64){t.msg="invalid distance code",R.mode=jU;break e}else{w=U[(w&65535)+(h&(1<<v)-1)];continue n}break}}else if(v&64)if(v&32){R.mode=y6e;break e}else{t.msg="invalid literal/length code",R.mode=jU;break e}else{w=p[(w&65535)+(h&(1<<v)-1)];continue t}break}}while(i<s&&r<a);I=m>>3,i-=I,m-=I<<3,h&=(1<<m)-1,t.next_in=i,t.next_out=r,t.avail_in=i<s?5+(s-i):5-(i-s),t.avail_out=r<a?257+(a-r):257-(r-a),R.hold=h,R.bits=m};const cf=15,jk=852,Yk=592,Wk=0,a3=1,Kk=2,v6e=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),w6e=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),_6e=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),T6e=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),I6e=(e,t,n,i,s,r,o,a)=>{const l=a.bits;let c=0,u=0,d=0,f=0,h=0,m=0,p=0,U=0,b=0,y=0,w,v,I,C,_,T=null,k=0,S;const R=new Uint16Array(cf+1),P=new Uint16Array(cf+1);let L=null,X=0,G,z,V;for(c=0;c<=cf;c++)R[c]=0;for(u=0;u<i;u++)R[t[n+u]]++;for(h=l,f=cf;f>=1&&R[f]===0;f--);if(h>f&&(h=f),f===0)return s[r++]=1<<24|64<<16|0,s[r++]=1<<24|64<<16|0,a.bits=1,0;for(d=1;d<f&&R[d]===0;d++);for(h<d&&(h=d),U=1,c=1;c<=cf;c++)if(U<<=1,U-=R[c],U<0)return-1;if(U>0&&(e===Wk||f!==1))return-1;for(P[1]=0,c=1;c<cf;c++)P[c+1]=P[c]+R[c];for(u=0;u<i;u++)t[n+u]!==0&&(o[P[t[n+u]]++]=u);if(e===Wk?(T=L=o,S=19):e===a3?(T=v6e,k-=257,L=w6e,X-=257,S=256):(T=_6e,L=T6e,S=-1),y=0,u=0,c=d,_=r,m=h,p=0,I=-1,b=1<<h,C=b-1,e===a3&&b>jk||e===Kk&&b>Yk)return 1;for(;;){G=c-p,o[u]<S?(z=0,V=o[u]):o[u]>S?(z=L[X+o[u]],V=T[k+o[u]]):(z=96,V=0),w=1<<c-p,v=1<<m,d=v;do v-=w,s[_+(y>>p)+v]=G<<24|z<<16|V|0;while(v!==0);for(w=1<<c-1;y&w;)w>>=1;if(w!==0?(y&=w-1,y+=w):y=0,u++,--R[c]===0){if(c===f)break;c=t[n+o[u]]}if(c>h&&(y&C)!==I){for(p===0&&(p=h),_+=d,m=c-p,U=1<<m;m+p<f&&(U-=R[m+p],!(U<=0));)m++,U<<=1;if(b+=1<<m,e===a3&&b>jk||e===Kk&&b>Yk)return 1;I=y&C,s[I]=h<<24|m<<16|_-r|0}}return y!==0&&(s[_+y]=c-p<<24|64<<16|0),a.bits=h,0};var A0=I6e;const S6e=0,yG=1,EG=2,{Z_FINISH:Zk,Z_BLOCK:x6e,Z_TREES:YU,Z_OK:wd,Z_STREAM_END:C6e,Z_NEED_DICT:A6e,Z_STREAM_ERROR:Dr,Z_DATA_ERROR:vG,Z_MEM_ERROR:wG,Z_BUF_ERROR:M6e,Z_DEFLATED:qk}=Ty,_G=1,Qk=2,Jk=3,eR=4,tR=5,nR=6,iR=7,sR=8,rR=9,oR=10,F6=11,ba=12,l3=13,aR=14,c3=15,lR=16,cR=17,uR=18,dR=19,WU=20,KU=21,fR=22,hR=23,gR=24,mR=25,pR=26,u3=27,UR=28,bR=29,rn=30,TG=31,k6e=32,R6e=852,D6e=592,L6e=15,N6e=L6e,yR=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function O6e(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const IG=e=>{if(!e||!e.state)return Dr;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=_G,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(R6e),t.distcode=t.distdyn=new Int32Array(D6e),t.sane=1,t.back=-1,wd},SG=e=>{if(!e||!e.state)return Dr;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,IG(e)},xG=(e,t)=>{let n;if(!e||!e.state)return Dr;const i=e.state;return t<0?(n=0,t=-t):(n=(t>>4)+1,t<48&&(t&=15)),t&&(t<8||t>15)?Dr:(i.window!==null&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,SG(e))},CG=(e,t)=>{if(!e)return Dr;const n=new O6e;e.state=n,n.window=null;const i=xG(e,t);return i!==wd&&(e.state=null),i},P6e=e=>CG(e,N6e);let ER=!0,d3,f3;const F6e=e=>{if(ER){d3=new Int32Array(512),f3=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(A0(yG,e.lens,0,288,d3,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;A0(EG,e.lens,0,32,f3,0,e.work,{bits:5}),ER=!1}e.lencode=d3,e.lenbits=9,e.distcode=f3,e.distbits=5},AG=(e,t,n,i)=>{let s;const r=e.state;return r.window===null&&(r.wsize=1<<r.wbits,r.wnext=0,r.whave=0,r.window=new Uint8Array(r.wsize)),i>=r.wsize?(r.window.set(t.subarray(n-r.wsize,n),0),r.wnext=0,r.whave=r.wsize):(s=r.wsize-r.wnext,s>i&&(s=i),r.window.set(t.subarray(n-i,n-i+s),r.wnext),i-=s,i?(r.window.set(t.subarray(n-i,n),0),r.wnext=i,r.whave=r.wsize):(r.wnext+=s,r.wnext===r.wsize&&(r.wnext=0),r.whave<r.wsize&&(r.whave+=s))),0},B6e=(e,t)=>{let n,i,s,r,o,a,l,c,u,d,f,h,m,p,U=0,b,y,w,v,I,C,_,T;const k=new Uint8Array(4);let S,R;const P=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!e||!e.state||!e.output||!e.input&&e.avail_in!==0)return Dr;n=e.state,n.mode===ba&&(n.mode=l3),o=e.next_out,s=e.output,l=e.avail_out,r=e.next_in,i=e.input,a=e.avail_in,c=n.hold,u=n.bits,d=a,f=l,T=wd;e:for(;;)switch(n.mode){case _G:if(n.wrap===0){n.mode=l3;break}for(;u<16;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}if(n.wrap&2&&c===35615){n.check=0,k[0]=c&255,k[1]=c>>>8&255,n.check=ci(n.check,k,2,0),c=0,u=0,n.mode=Qk;break}if(n.flags=0,n.head&&(n.head.done=!1),!(n.wrap&1)||(((c&255)<<8)+(c>>8))%31){e.msg="incorrect header check",n.mode=rn;break}if((c&15)!==qk){e.msg="unknown compression method",n.mode=rn;break}if(c>>>=4,u-=4,_=(c&15)+8,n.wbits===0)n.wbits=_;else if(_>n.wbits){e.msg="invalid window size",n.mode=rn;break}n.dmax=1<<n.wbits,e.adler=n.check=1,n.mode=c&512?oR:ba,c=0,u=0;break;case Qk:for(;u<16;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}if(n.flags=c,(n.flags&255)!==qk){e.msg="unknown compression method",n.mode=rn;break}if(n.flags&57344){e.msg="unknown header flags set",n.mode=rn;break}n.head&&(n.head.text=c>>8&1),n.flags&512&&(k[0]=c&255,k[1]=c>>>8&255,n.check=ci(n.check,k,2,0)),c=0,u=0,n.mode=Jk;case Jk:for(;u<32;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}n.head&&(n.head.time=c),n.flags&512&&(k[0]=c&255,k[1]=c>>>8&255,k[2]=c>>>16&255,k[3]=c>>>24&255,n.check=ci(n.check,k,4,0)),c=0,u=0,n.mode=eR;case eR:for(;u<16;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}n.head&&(n.head.xflags=c&255,n.head.os=c>>8),n.flags&512&&(k[0]=c&255,k[1]=c>>>8&255,n.check=ci(n.check,k,2,0)),c=0,u=0,n.mode=tR;case tR:if(n.flags&1024){for(;u<16;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}n.length=c,n.head&&(n.head.extra_len=c),n.flags&512&&(k[0]=c&255,k[1]=c>>>8&255,n.check=ci(n.check,k,2,0)),c=0,u=0}else n.head&&(n.head.extra=null);n.mode=nR;case nR:if(n.flags&1024&&(h=n.length,h>a&&(h=a),h&&(n.head&&(_=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(i.subarray(r,r+h),_)),n.flags&512&&(n.check=ci(n.check,i,h,r)),a-=h,r+=h,n.length-=h),n.length))break e;n.length=0,n.mode=iR;case iR:if(n.flags&2048){if(a===0)break e;h=0;do _=i[r+h++],n.head&&_&&n.length<65536&&(n.head.name+=String.fromCharCode(_));while(_&&h<a);if(n.flags&512&&(n.check=ci(n.check,i,h,r)),a-=h,r+=h,_)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=sR;case sR:if(n.flags&4096){if(a===0)break e;h=0;do _=i[r+h++],n.head&&_&&n.length<65536&&(n.head.comment+=String.fromCharCode(_));while(_&&h<a);if(n.flags&512&&(n.check=ci(n.check,i,h,r)),a-=h,r+=h,_)break e}else n.head&&(n.head.comment=null);n.mode=rR;case rR:if(n.flags&512){for(;u<16;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}if(c!==(n.check&65535)){e.msg="header crc mismatch",n.mode=rn;break}c=0,u=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=ba;break;case oR:for(;u<32;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}e.adler=n.check=yR(c),c=0,u=0,n.mode=F6;case F6:if(n.havedict===0)return e.next_out=o,e.avail_out=l,e.next_in=r,e.avail_in=a,n.hold=c,n.bits=u,A6e;e.adler=n.check=1,n.mode=ba;case ba:if(t===x6e||t===YU)break e;case l3:if(n.last){c>>>=u&7,u-=u&7,n.mode=u3;break}for(;u<3;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}switch(n.last=c&1,c>>>=1,u-=1,c&3){case 0:n.mode=aR;break;case 1:if(F6e(n),n.mode=WU,t===YU){c>>>=2,u-=2;break e}break;case 2:n.mode=cR;break;case 3:e.msg="invalid block type",n.mode=rn}c>>>=2,u-=2;break;case aR:for(c>>>=u&7,u-=u&7;u<32;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}if((c&65535)!==(c>>>16^65535)){e.msg="invalid stored block lengths",n.mode=rn;break}if(n.length=c&65535,c=0,u=0,n.mode=c3,t===YU)break e;case c3:n.mode=lR;case lR:if(h=n.length,h){if(h>a&&(h=a),h>l&&(h=l),h===0)break e;s.set(i.subarray(r,r+h),o),a-=h,r+=h,l-=h,o+=h,n.length-=h;break}n.mode=ba;break;case cR:for(;u<14;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}if(n.nlen=(c&31)+257,c>>>=5,u-=5,n.ndist=(c&31)+1,c>>>=5,u-=5,n.ncode=(c&15)+4,c>>>=4,u-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=rn;break}n.have=0,n.mode=uR;case uR:for(;n.have<n.ncode;){for(;u<3;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}n.lens[P[n.have++]]=c&7,c>>>=3,u-=3}for(;n.have<19;)n.lens[P[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,S={bits:n.lenbits},T=A0(S6e,n.lens,0,19,n.lencode,0,n.work,S),n.lenbits=S.bits,T){e.msg="invalid code lengths set",n.mode=rn;break}n.have=0,n.mode=dR;case dR:for(;n.have<n.nlen+n.ndist;){for(;U=n.lencode[c&(1<<n.lenbits)-1],b=U>>>24,y=U>>>16&255,w=U&65535,!(b<=u);){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}if(w<16)c>>>=b,u-=b,n.lens[n.have++]=w;else{if(w===16){for(R=b+2;u<R;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}if(c>>>=b,u-=b,n.have===0){e.msg="invalid bit length repeat",n.mode=rn;break}_=n.lens[n.have-1],h=3+(c&3),c>>>=2,u-=2}else if(w===17){for(R=b+3;u<R;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}c>>>=b,u-=b,_=0,h=3+(c&7),c>>>=3,u-=3}else{for(R=b+7;u<R;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}c>>>=b,u-=b,_=0,h=11+(c&127),c>>>=7,u-=7}if(n.have+h>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=rn;break}for(;h--;)n.lens[n.have++]=_}}if(n.mode===rn)break;if(n.lens[256]===0){e.msg="invalid code -- missing end-of-block",n.mode=rn;break}if(n.lenbits=9,S={bits:n.lenbits},T=A0(yG,n.lens,0,n.nlen,n.lencode,0,n.work,S),n.lenbits=S.bits,T){e.msg="invalid literal/lengths set",n.mode=rn;break}if(n.distbits=6,n.distcode=n.distdyn,S={bits:n.distbits},T=A0(EG,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,S),n.distbits=S.bits,T){e.msg="invalid distances set",n.mode=rn;break}if(n.mode=WU,t===YU)break e;case WU:n.mode=KU;case KU:if(a>=6&&l>=258){e.next_out=o,e.avail_out=l,e.next_in=r,e.avail_in=a,n.hold=c,n.bits=u,E6e(e,f),o=e.next_out,s=e.output,l=e.avail_out,r=e.next_in,i=e.input,a=e.avail_in,c=n.hold,u=n.bits,n.mode===ba&&(n.back=-1);break}for(n.back=0;U=n.lencode[c&(1<<n.lenbits)-1],b=U>>>24,y=U>>>16&255,w=U&65535,!(b<=u);){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}if(y&&!(y&240)){for(v=b,I=y,C=w;U=n.lencode[C+((c&(1<<v+I)-1)>>v)],b=U>>>24,y=U>>>16&255,w=U&65535,!(v+b<=u);){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}c>>>=v,u-=v,n.back+=v}if(c>>>=b,u-=b,n.back+=b,n.length=w,y===0){n.mode=pR;break}if(y&32){n.back=-1,n.mode=ba;break}if(y&64){e.msg="invalid literal/length code",n.mode=rn;break}n.extra=y&15,n.mode=fR;case fR:if(n.extra){for(R=n.extra;u<R;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}n.length+=c&(1<<n.extra)-1,c>>>=n.extra,u-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=hR;case hR:for(;U=n.distcode[c&(1<<n.distbits)-1],b=U>>>24,y=U>>>16&255,w=U&65535,!(b<=u);){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}if(!(y&240)){for(v=b,I=y,C=w;U=n.distcode[C+((c&(1<<v+I)-1)>>v)],b=U>>>24,y=U>>>16&255,w=U&65535,!(v+b<=u);){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}c>>>=v,u-=v,n.back+=v}if(c>>>=b,u-=b,n.back+=b,y&64){e.msg="invalid distance code",n.mode=rn;break}n.offset=w,n.extra=y&15,n.mode=gR;case gR:if(n.extra){for(R=n.extra;u<R;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}n.offset+=c&(1<<n.extra)-1,c>>>=n.extra,u-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=rn;break}n.mode=mR;case mR:if(l===0)break e;if(h=f-l,n.offset>h){if(h=n.offset-h,h>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=rn;break}h>n.wnext?(h-=n.wnext,m=n.wsize-h):m=n.wnext-h,h>n.length&&(h=n.length),p=n.window}else p=s,m=o-n.offset,h=n.length;h>l&&(h=l),l-=h,n.length-=h;do s[o++]=p[m++];while(--h);n.length===0&&(n.mode=KU);break;case pR:if(l===0)break e;s[o++]=n.length,l--,n.mode=KU;break;case u3:if(n.wrap){for(;u<32;){if(a===0)break e;a--,c|=i[r++]<<u,u+=8}if(f-=l,e.total_out+=f,n.total+=f,f&&(e.adler=n.check=n.flags?ci(n.check,s,f,o-f):Tm(n.check,s,f,o-f)),f=l,(n.flags?c:yR(c))!==n.check){e.msg="incorrect data check",n.mode=rn;break}c=0,u=0}n.mode=UR;case UR:if(n.wrap&&n.flags){for(;u<32;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}if(c!==(n.total&4294967295)){e.msg="incorrect length check",n.mode=rn;break}c=0,u=0}n.mode=bR;case bR:T=C6e;break e;case rn:T=vG;break e;case TG:return wG;case k6e:default:return Dr}return e.next_out=o,e.avail_out=l,e.next_in=r,e.avail_in=a,n.hold=c,n.bits=u,(n.wsize||f!==e.avail_out&&n.mode<rn&&(n.mode<u3||t!==Zk))&&AG(e,e.output,e.next_out,f-e.avail_out),d-=e.avail_in,f-=e.avail_out,e.total_in+=d,e.total_out+=f,n.total+=f,n.wrap&&f&&(e.adler=n.check=n.flags?ci(n.check,s,f,e.next_out-f):Tm(n.check,s,f,e.next_out-f)),e.data_type=n.bits+(n.last?64:0)+(n.mode===ba?128:0)+(n.mode===WU||n.mode===c3?256:0),(d===0&&f===0||t===Zk)&&T===wd&&(T=M6e),T},z6e=e=>{if(!e||!e.state)return Dr;let t=e.state;return t.window&&(t.window=null),e.state=null,wd},H6e=(e,t)=>{if(!e||!e.state)return Dr;const n=e.state;return n.wrap&2?(n.head=t,t.done=!1,wd):Dr},V6e=(e,t)=>{const n=t.length;let i,s,r;return!e||!e.state||(i=e.state,i.wrap!==0&&i.mode!==F6)?Dr:i.mode===F6&&(s=1,s=Tm(s,t,n,0),s!==i.check)?vG:(r=AG(e,t,n,n),r?(i.mode=TG,wG):(i.havedict=1,wd))};var $6e=SG,G6e=xG,X6e=IG,j6e=P6e,Y6e=CG,W6e=B6e,K6e=z6e,Z6e=H6e,q6e=V6e,Q6e="pako inflate (from Nodeca project)",Ta={inflateReset:$6e,inflateReset2:G6e,inflateResetKeep:X6e,inflateInit:j6e,inflateInit2:Y6e,inflate:W6e,inflateEnd:K6e,inflateGetHeader:Z6e,inflateSetDictionary:q6e,inflateInfo:Q6e};function J6e(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var e5e=J6e;const MG=Object.prototype.toString,{Z_NO_FLUSH:t5e,Z_FINISH:n5e,Z_OK:xm,Z_STREAM_END:h3,Z_NEED_DICT:g3,Z_STREAM_ERROR:i5e,Z_DATA_ERROR:vR,Z_MEM_ERROR:s5e}=Ty;function Ay(e){this.options=xy.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new UG,this.strm.avail_out=0;let n=Ta.inflateInit2(this.strm,t.windowBits);if(n!==xm)throw new Error(yd[n]);if(this.header=new e5e,Ta.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=Sm.string2buf(t.dictionary):MG.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=Ta.inflateSetDictionary(this.strm,t.dictionary),n!==xm)))throw new Error(yd[n])}Ay.prototype.push=function(e,t){const n=this.strm,i=this.options.chunkSize,s=this.options.dictionary;let r,o,a;if(this.ended)return!1;for(t===~~t?o=t:o=t===!0?n5e:t5e,MG.call(e)==="[object ArrayBuffer]"?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),r=Ta.inflate(n,o),r===g3&&s&&(r=Ta.inflateSetDictionary(n,s),r===xm?r=Ta.inflate(n,o):r===vR&&(r=g3));n.avail_in>0&&r===h3&&n.state.wrap>0&&e[n.next_in]!==0;)Ta.inflateReset(n),r=Ta.inflate(n,o);switch(r){case i5e:case vR:case g3:case s5e:return this.onEnd(r),this.ended=!0,!1}if(a=n.avail_out,n.next_out&&(n.avail_out===0||r===h3))if(this.options.to==="string"){let l=Sm.utf8border(n.output,n.next_out),c=n.next_out-l,u=Sm.buf2string(n.output,l);n.next_out=c,n.avail_out=i-c,c&&n.output.set(n.output.subarray(l,l+c),0),this.onData(u)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(!(r===xm&&a===0)){if(r===h3)return r=Ta.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,!0;if(n.avail_in===0)break}}return!0};Ay.prototype.onData=function(e){this.chunks.push(e)};Ay.prototype.onEnd=function(e){e===xm&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=xy.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function r5e(e,t){const n=new Ay(t);if(n.push(e),n.err)throw n.msg||yd[n.err];return n.result}var o5e=r5e,a5e={inflate:o5e};const{deflate:l5e}=b6e,{inflate:c5e}=a5e;var kG=l5e,RG=c5e;const Y2=12,u5e=()=>{const e=new Uint8Array(Y2);return window.crypto.getRandomValues(e)},_T=async e=>{const t=await window.crypto.subtle.generateKey({name:"AES-GCM",length:lB},!0,["encrypt","decrypt"]);return e==="cryptoKey"?t:(await window.crypto.subtle.exportKey("jwk",t)).k},DG=(e,t)=>window.crypto.subtle.importKey("jwk",{alg:"A128GCM",ext:!0,k:e,key_ops:["encrypt","decrypt"],kty:"oct"},{name:"AES-GCM",length:lB},!1,[t]),My=async(e,t)=>{const n=typeof e=="string"?await DG(e,"encrypt"):e,i=u5e(),s=typeof t=="string"?new TextEncoder().encode(t):t instanceof Uint8Array?t:t instanceof Blob?await Dp(t):t;return{encryptedBuffer:await window.crypto.subtle.encrypt({name:"AES-GCM",iv:i},n,s),iv:i}},Cm=async(e,t,n)=>{const i=await DG(n,"decrypt");return window.crypto.subtle.decrypt({name:"AES-GCM",iv:e},i,t)},B6=e=>{const t=typeof e=="string"?new TextEncoder().encode(e):e instanceof Uint8Array?e:new Uint8Array(e);let n="";for(const i of t)n+=String.fromCharCode(i);return n},LG=e=>{const t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let i=0,s=e.length;i<s;i++)n[i]=e.charCodeAt(i);return t},NG=e=>new TextDecoder("utf-8").decode(LG(e)),OG=(e,t=!1)=>t?window.btoa(e):window.btoa(B6(e)),PG=(e,t=!1)=>t?window.atob(e):NG(window.atob(e)),wR=e=>window.atob(e.replace(/-/g,"+").replace(/_/g,"/").padEnd(e.length+(4-e.length%4)%4,"=")),FG=({text:e,compress:t})=>{let n;if(t!==!1)try{n=B6(kG(e))}catch(i){console.error("encode: cannot deflate",i)}return{version:"1",encoding:"bstring",compressed:!!n,encoded:n||B6(e)}},BG=e=>{let t;switch(e.encoding){case"bstring":t=e.compressed?e.encoded:NG(e.encoded);break;default:throw new Error(`decode: unknown encoding "${e.encoding}"`)}return e.compressed?RG(new Uint8Array(LG(t)),{to:"string"}):t},zG=1,W2=4,Uh=4,m3={1:8,2:16,4:32};function z6(e,t,n,i){if(i!=null){if(i>Math.pow(2,m3[t])-1)throw new Error(`attempting to set value higher than the allocated bytes (value: ${i}, bytes: ${t})`);const r=`setUint${m3[t]}`;return new DataView(e.buffer)[r](n,i),e}const s=`getUint${m3[t]}`;return new DataView(e.buffer)[s](n)}const _R=(...e)=>{const t=new Uint8Array(W2+Uh*e.length+e.reduce((i,s)=>i+s.byteLength,0));let n=0;z6(t,W2,n,zG),n+=W2;for(const i of e)z6(t,Uh,n,i.byteLength),n+=Uh,t.set(i,n),n+=i.byteLength;return t},TR=e=>{const t=[];let n=0;const i=z6(e,Uh,n);if(i>zG)throw new Error(`invalid version ${i}`);for(n+=W2;;){const s=z6(e,Uh,n);if(n+=Uh,t.push(e.slice(n,n+s)),n+=s,n>=e.byteLength)break}return t},d5e=async(e,t)=>{const{encryptedBuffer:n,iv:i}=await My(t,kG(e));return{iv:i,buffer:new Uint8Array(n)}},HG=async(e,t)=>{const n={version:2,compression:"pako@1",encryption:"AES-GCM"},i=new TextEncoder().encode(JSON.stringify(n)),s=new TextEncoder().encode(JSON.stringify(t.metadata||null)),{iv:r,buffer:o}=await d5e(_R(s,e),t.encryptionKey);return _R(i,r,o)},f5e=async(e,t,n,i)=>(t=new Uint8Array(await Cm(e,t,n)),i?RG(t):t),VG=async(e,t)=>{const[n,i,s]=TR(e),r=JSON.parse(new TextDecoder().decode(n));try{const[o,a]=TR(await f5e(i,s,t.decryptionKey,!!r.compression));return{metadata:JSON.parse(new TextDecoder().decode(o)),data:a}}catch(o){throw console.error("Error during decompressing and decrypting the file.",r),o}},Gd=(()=>{if(typeof self>"u")return!1;if("top"in self&&self!==top)try{}catch{return!1}else if("showOpenFilePicker"in self)return"showOpenFilePicker";return!1})(),h5e=ye(Gd?()=>import("./file-open-002ab408-DIuFHtCF.js"):()=>import("./file-open-7c801643-684qeFg4.js"),__vite__mapDeps([]));async function g5e(...e){return(await h5e).default(...e)}ye(Gd?()=>import("./directory-open-4ed118d0-BzWybGaI.js"):()=>import("./directory-open-01563666-DWU9wJ6I.js"),__vite__mapDeps([]));const m5e=ye(Gd?()=>import("./file-save-745eba88-Bb9F9Kg7.js"):()=>import("./file-save-3189631c-x92wctJd.js"),__vite__mapDeps([]));async function p5e(...e){return(await m5e).default(...e)}const IR=5e3,TT=async e=>{var s,r;const t=(s=e.extensions)==null?void 0:s.reduce((o,a)=>(o.push(_e[a]),o),[]),n=(r=e.extensions)==null?void 0:r.reduce((o,a)=>a==="jpg"?o.concat(".jpg",".jpeg"):o.concat(`.${a}`),[]),i=await g5e({description:e.description,extensions:n,mimeTypes:t,multiple:e.multiple??!1,legacySetup:(o,a,l)=>{const c=sl(a,IR),u=()=>{d(),document.addEventListener(te.KEYUP,c),document.addEventListener(te.POINTER_UP,c),c()},d=()=>{var h;if((h=l.files)!=null&&h.length){const m=e.multiple?[...l.files]:l.files[0];o(m)}};requestAnimationFrame(()=>{window.addEventListener(te.FOCUS,u)});const f=window.setInterval(()=>{d()},IR);return h=>{clearInterval(f),c.cancel(),window.removeEventListener(te.FOCUS,u),document.removeEventListener(te.KEYUP,c),document.removeEventListener(te.POINTER_UP,c),h&&(console.warn("Opening the file was canceled (legacy-fs)."),h(new Gh))}}});return Array.isArray(i)?await Promise.all(i.map(o=>km(o))):await km(i)},H6=(e,t)=>p5e(e,{fileName:`${t.name}.${t.extension}`,description:t.description,extensions:[`.${t.extension}`],mimeTypes:t.mimeTypes},t.fileHandle),U5e=(e,t)=>{const n={};for(const i of e)!i.isDeleted&&"fileId"in i&&i.fileId&&t[i.fileId]&&(n[i.fileId]=t[i.fileId]);return n},Ag=(e,t,n,i)=>{const s={type:Tr.excalidraw,version:$5.excalidraw,source:x9(),elements:i==="local"?mH(e):Cue(e),appState:i==="local"?X$(t):T2e(t),files:i==="local"?U5e(e,n):void 0};return JSON.stringify(s,null,2)},$G=async(e,t,n,i=t.name||dB)=>{const s=Ag(e,t,n,"local"),r=new Blob([s],{type:_e.excalidraw});return{fileHandle:await H6(r,{name:i,extension:"excalidraw",description:"Excalidraw file",fileHandle:CT(t.fileHandle)?null:t.fileHandle})}},b5e=async(e,t)=>{const n=await TT({description:"Excalidraw files"});return AT(n,e,t,n.handle)},y5e=e=>(e==null?void 0:e.type)===Tr.excalidraw&&(!e.elements||Array.isArray(e.elements)&&(!e.appState||typeof e.appState=="object")),GG=e=>typeof e=="object"&&e&&e.type===Tr.excalidrawLibrary&&(e.version===1||e.version===2),E5e=e=>{const t={type:Tr.excalidrawLibrary,version:$5.excalidrawLibrary,source:x9(),libraryItems:e};return JSON.stringify(t,null,2)},v5e=async e=>{const t=E5e(e);await H6(new Blob([t],{type:_e.excalidrawlib}),{name:"library",extension:"excalidrawlib",description:"Excalidraw library file"})},w5e=12,XG=document.createElement("img");XG.src=`data:${_e.svg}, ${encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#1971c2" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>')}`;const jG=document.createElement("img");jG.src=`data:${_e.svg}, ${encodeURIComponent('<svg  xmlns="http://www.w3.org/2000/svg"  width="16"  height="16"  viewBox="0 0 24 24"  fill="none"  stroke="#1971c2"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-arrow-big-right-line"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 9v-3.586a1 1 0 0 1 1.707 -.707l6.586 6.586a1 1 0 0 1 0 1.414l-6.586 6.586a1 1 0 0 1 -1.707 -.707v-3.586h-6v-6h6z" /><path d="M3 9v6" /></svg>')}`;const IT=([e,t,n,i],s,r)=>{const o=w5e,a=r.zoom.value>1?r.zoom.value:1,l=o/a,c=o/a,u=o/a,d=(e+n)/2,f=(t+i)/2,h=(o-8)/(2*a),m=4/a,p=n+m-h,U=t-m-u+h,[b,y]=q(x(p+l/2,U+c/2),x(d,f),s);return[b-l/2,y-c/2,l,c]},YG=(e,t,n,[i,s])=>{const r=4/n.zoom.value,[o,a,l,c]=ze(e,t),[u,d,f,h]=IT([o,a,l,c],e.angle,n);return i>u-r&&i<u+r+f&&s>d-r&&s<d+h+r},p3=(e,t,n,[i,s],r)=>!e.link||n.selectedElementIds[e.id]?!1:!r&&n.viewModeEnabled&&Z5(x(i,s),e,t)?!0:YG(e,t,n,x(i,s)),ky=(e,t,n,i,s,r=!0)=>{e.beginPath(),e.arc(t,n,i,0,Math.PI*2),r&&e.fill(),s&&e.stroke()},Ry=(e,t)=>[e.width/t,e.height/t],Dy=({canvas:e,scale:t,normalizedWidth:n,normalizedHeight:i,theme:s,isExporting:r,viewBackgroundColor:o})=>{const a=e.getContext("2d");return a.setTransform(1,0,0,1,0,0),a.scale(t,t),r&&s===ke.DARK&&(a.filter=M9),typeof o=="string"?((o==="transparent"||o.length===5||o.length===9||/(hsla|rgba)\(/.test(o))&&a.clearRect(0,0,n,i),a.save(),a.fillStyle=o,a.fillRect(0,0,n,i),a.restore()):a.clearRect(0,0,n,i),a};function Dl(e,t,n=.5){const i=sre(t,n);if(i)for(let s=0;s<i.length-1;s++){const[[r,o],[a,l]]=i[s];e.quadraticCurveTo(r,o,a,l)}}function Ll(e,t,n=.5){const i=N9(t,n);if(i)for(let s=0;s<i.length;s++){const[[r,o],[a,l],[c,u]]=i[s];e.bezierCurveTo(r,o,a,l,c,u)}}const _5e=(e,t,n,i)=>{const[s,r]=q(x(t.x,t.y),ri(t,n),t.angle);e.save(),e.translate(s,r),e.rotate(t.angle);let o=us(Math.min(t.width,t.height),t);o===0&&(o=.01),e.beginPath();{const a=kl(x(0,0+o),x(0,0),x(0+o,0),i),l=kl(x(t.width-o,0),x(t.width,0),x(t.width,o),i),c=kl(x(t.width,t.height-o),x(t.width,t.height),x(t.width-o,t.height),i),u=kl(x(o,t.height),x(0,t.height),x(0,t.height-o),i);e.moveTo(a[a.length-1][0],a[a.length-1][1]),e.lineTo(l[0][0],l[0][1]),Dl(e,l),e.lineTo(c[0][0],c[0][1]),Dl(e,c),e.lineTo(u[0][0],u[0][1]),Dl(e,u),e.lineTo(a[0][0],a[0][1]),Dl(e,a)}{const a=kl(x(0+o,0),x(0,0),x(0,0+o),-5),l=kl(x(t.width,o),x(t.width,0),x(t.width-o,0),-5),c=kl(x(t.width-o,t.height),x(t.width,t.height),x(t.width,t.height-o),-5),u=kl(x(0,t.height-o),x(0,t.height),x(o,t.height),-5);e.moveTo(a[a.length-1][0],a[a.length-1][1]),e.lineTo(u[0][0],u[0][1]),Dl(e,u),e.lineTo(c[0][0],c[0][1]),Dl(e,c),e.lineTo(l[0][0],l[0][1]),Dl(e,l),e.lineTo(a[0][0],a[0][1]),Dl(e,a)}e.closePath(),e.fill(),e.restore()},T5e=(e,t,n,i,s,r)=>{e.beginPath(),e.ellipse(i,s,t/2,n/2,r,0,Math.PI*2),e.stroke()},Ly=(e,t,n,i,s,r,o,a,l=!1,c=0)=>{e.save(),e.translate(r,o),e.rotate(a),l&&e.fillRect(t-r,n-o,i,s),c&&e.roundRect?(e.beginPath(),e.roundRect(t-r,n-o,i,s,c),e.stroke(),e.closePath()):e.strokeRect(t-r,n-o,i,s),e.restore()},I5e=(e,t,n,i)=>{const[s,r]=q(x(n.x,n.y),ri(n,i),n.angle);e.save(),e.translate(s,r),e.rotate(n.angle);{e.beginPath();const[o,a,l,c,u,d,f,h]=v6(n),m=n.roundness?us(Math.abs(o-f),n):(o-f)*.01,p=n.roundness?us(Math.abs(c-a),n):(c-a)*.01,U=Eo(zn(x(o-m,a+p),x(o,a),x(o,a),x(o+m,a+p)),t),b=Eo(zn(x(l-m,c-p),x(l,c),x(l,c),x(l-m,c+p)),t),y=Eo(zn(x(u+m,d-p),x(u,d),x(u,d),x(u-m,d-p)),t),w=Eo(zn(x(f+m,h+p),x(f,h),x(f,h),x(f+m,h-p)),t);e.moveTo(U[U.length-1][0],U[U.length-1][1]),e.lineTo(b[1][0],b[1][1]),Ll(e,b),e.lineTo(y[1][0],y[1][1]),Ll(e,y),e.lineTo(w[1][0],w[1][1]),Ll(e,w),e.lineTo(U[1][0],U[1][1]),Ll(e,U)}{const[o,a,l,c,u,d,f,h]=v6(n),m=n.roundness?us(Math.abs(o-f),n):(o-f)*.01,p=n.roundness?us(Math.abs(c-a),n):(c-a)*.01,U=Eo(zn(x(o+m,a+p),x(o,a),x(o,a),x(o-m,a+p)),-5),b=Eo(zn(x(l-m,c+p),x(l,c),x(l,c),x(l-m,c-p)),-5),y=Eo(zn(x(u-m,d-p),x(u,d),x(u,d),x(u+m,d-p)),-5),w=Eo(zn(x(f+m,h-p),x(f,h),x(f,h),x(f+m,h+p)),-5);e.moveTo(U[U.length-1][0],U[U.length-1][1]),e.lineTo(w[1][0],w[1][1]),Ll(e,w),e.lineTo(y[1][0],y[1][1]),Ll(e,y),e.lineTo(b[1][0],b[1][1]),Ll(e,b),e.lineTo(U[1][0],U[1][1]),Ll(e,U)}e.closePath(),e.fill(),e.restore()},ZU={Bold:"#dddddd",Regular:"#e5e5e5"},S5e=(e,t,n,i,s,r,o,a)=>{const l=i%t-t,c=s%t-t,u=t*r.value,d=1/r.value;e.save(),r.value===1&&e.translate(l%1?0:.5,c%1?0:.5);for(let f=l;f<l+o+t*2;f+=t){const h=n>1&&Math.round(f-i)%(n*t)===0;if(!h&&u<10)continue;const m=Math.min(1/r.value,h?4:1);e.lineWidth=m;const p=[m*3,d+(m+d)];e.beginPath(),e.setLineDash(h?[]:p),e.strokeStyle=h?ZU.Bold:ZU.Regular,e.moveTo(f,c-t),e.lineTo(f,Math.ceil(c+a+t*2)),e.stroke()}for(let f=c;f<c+a+t*2;f+=t){const h=n>1&&Math.round(f-s)%(n*t)===0;if(!h&&u<10)continue;const m=Math.min(1/r.value,h?4:1);e.lineWidth=m;const p=[m*3,d+(m+d)];e.beginPath(),e.setLineDash(h?[]:p),e.strokeStyle=h?ZU.Bold:ZU.Regular,e.moveTo(l-t,f),e.lineTo(Math.ceil(l+o+t*2),f),e.stroke()}e.restore()},Uv=(e,t,n,i)=>{t.translate(e.x+i.scrollX,e.y+i.scrollY),t.beginPath(),t.roundRect?t.roundRect(0,0,e.width,e.height,Ft.radius/i.zoom.value):t.rect(0,0,e.width,e.height),t.clip(),t.translate(-(e.x+i.scrollX),-(e.y+i.scrollY))},SR={regularLink:null,elementLink:null},xR=(e,t,n,i)=>{if(e.link&&!n.selectedElementIds[e.id]){const[s,r,o,a]=ze(e,i),[l,c,u,d]=IT([s,r,o,a],e.angle,n),f=l+u/2,h=c+d/2;t.save(),t.translate(n.scrollX+f,n.scrollY+h),t.rotate(e.angle);const m=ch(e.link)?"elementLink":"regularLink";let p=SR[m];if(!p||p.zoom!==n.zoom.value){p=Object.assign(document.createElement("canvas"),{zoom:n.zoom.value}),p.width=u*window.devicePixelRatio*n.zoom.value,p.height=d*window.devicePixelRatio*n.zoom.value,SR[m]=p;const U=p.getContext("2d");U.scale(window.devicePixelRatio*n.zoom.value,window.devicePixelRatio*n.zoom.value),U.fillStyle=n.viewBackgroundColor||"#fff",U.fillRect(0,0,u,d),m==="elementLink"?U.drawImage(jG,0,0,u,d):U.drawImage(XG,0,0,u,d),U.restore()}t.drawImage(p,l-f,c-h,u,d),t.restore()}},WG=({canvas:e,rc:t,elementsMap:n,allElementsMap:i,visibleElements:s,scale:r,appState:o,renderConfig:a})=>{var p;if(e===null)return;const{renderGrid:l=!0,isExporting:c}=a,[u,d]=Ry(e,r),f=Dy({canvas:e,scale:r,normalizedWidth:u,normalizedHeight:d,theme:o.theme,isExporting:c,viewBackgroundColor:o.viewBackgroundColor});f.scale(o.zoom.value,o.zoom.value),l&&S5e(f,o.gridSize,o.gridStep,o.scrollX,o.scrollY,o.zoom,u/o.zoom.value,d/o.zoom.value);const h=new Set;s.forEach(U=>{U.groupIds.length>0&&o.frameToHighlight&&o.selectedElementIds[U.id]&&(Fc(U,o.frameToHighlight,n)||U.groupIds.find(b=>h.has(b)))&&U.groupIds.forEach(b=>h.add(b))});const m=new Map;s.filter(U=>!pr(U)).forEach(U=>{var b;try{const y=U.frameId||((b=o.frameToHighlight)==null?void 0:b.id);if(de(U)&&U.containerId&&n.has(U.containerId))return;if(f.save(),y&&o.frameRendering.enabled&&o.frameRendering.clip){const v=g6(U,n,o);v&&x4(U,v,o,n,m)&&Uv(v,f,a,o),wu(U,n,i,t,f,a,o)}else wu(U,n,i,t,f,a,o);const w=Re(U,n);w&&wu(w,n,i,t,f,a,o),f.restore(),c||xR(U,f,o,n)}catch(y){console.error(y,U.id,U.x,U.y,U.width,U.height)}}),s.filter(U=>pr(U)).forEach(U=>{var b;try{const y=()=>{if(wu(U,n,i,t,f,a,o),pr(U)&&(c||rs(U)&&a.embedsValidationStatus.get(U.id)!==!0)&&U.width&&U.height){const v=Jz(U);wu(v,n,i,t,f,a,o)}c||xR(U,f,o,n)};if((U.frameId||((b=o.frameToHighlight)==null?void 0:b.id))&&o.frameRendering.enabled&&o.frameRendering.clip){f.save();const v=g6(U,n,o);v&&x4(U,v,o,n,m)&&Uv(v,f,a,o),y(),f.restore()}else y()}catch(y){console.error(y)}}),(p=a.pendingFlowchartNodes)==null||p.forEach(U=>{try{wu(U,n,i,t,f,a,o)}catch(b){console.error(b)}})},KG=Ug(e=>{WG(e)},{trailing:!0}),ZG=(e,t)=>{if(t){KG(e);return}WG(e)},g1=(e,t,n)=>{const i={sets:t.sets,shape:t.shape,options:{...t.options,fixedDecimalPlaceDigits:n}};return e.draw(i)},m1=(e,t,n,i,s)=>{if(!i.enabled||!i.clip)return null;const r=Ss(e,s);if(r){const o=t.ownerDocument.createElementNS(it,"g");return o.setAttributeNS(it,"clip-path",`url(#${r.id})`),n.forEach(a=>o.appendChild(a)),o}return null},K2=(e,t,n,i,s,r,o,a)=>{var w;const l={x:r,y:o},[c,u,d,f]=ze(e,t);let h=(d-c)/2-(e.x-c),m=(f-u)/2-(e.y-u);if(de(e)){const v=jn(e,t);if(xe(v)){const[I,C,_,T]=ze(v,t),k=pe.getBoundTextElementPosition(v,e,t);h=(_-I)/2-(k.x-I),m=(T-C)/2-(k.y-C),r=r+k.x-e.x,o=o+k.y-e.y}}const p=180*e.angle/Math.PI;let U=i;if(e.link){const v=i.ownerDocument.createElementNS(it,"a");v.setAttribute("href",Qs(e.link)),U.appendChild(v),U=v}const b=(v,I)=>{U.appendChild(v)},y=(((w=Ss(e,t))==null?void 0:w.opacity)??100)*e.opacity/1e4;switch(e.type){case"selection":throw new Error("Selection rendering is not supported for SVG");case"rectangle":case"diamond":case"ellipse":{const v=Zt.generateElementShape(e,null),I=g1(n,v,i1);y!==1&&(I.setAttribute("stroke-opacity",`${y}`),I.setAttribute("fill-opacity",`${y}`)),I.setAttribute("stroke-linecap","round"),I.setAttribute("transform",`translate(${r||0} ${o||0}) rotate(${p} ${h} ${m})`);const C=m1(e,U,[I],a.frameRendering,t);b(C||I);break}case"iframe":case"embeddable":{const v=Zt.generateElementShape(e,a),I=g1(n,v,i1),C=e.opacity/100;C!==1&&(I.setAttribute("stroke-opacity",`${C}`),I.setAttribute("fill-opacity",`${C}`)),I.setAttribute("stroke-linecap","round"),I.setAttribute("transform",`translate(${r||0} ${o||0}) rotate(${p} ${h} ${m})`),b(I);const _=Jz(e);K2(_,t,n,U,s,_.x+l.x-e.x,_.y+l.y-e.y,a);const T=g1(n,v,i1);for(T.setAttribute("stroke-linecap","round"),T.setAttribute("transform",`translate(${r||0} ${o||0}) rotate(${p} ${h} ${m})`);T.firstChild;)T.removeChild(T.firstChild);const k=us(Math.min(e.width,e.height),e),S=jf(z9(e.link||""));if(a.renderEmbeddables===!1||(S==null?void 0:S.type)==="document"){const R=i.ownerDocument.createElementNS(it,"a");R.setAttribute("href",Qs(e.link||"")),R.setAttribute("target","_blank"),R.setAttribute("rel","noopener noreferrer"),R.style.borderRadius=`${k}px`,T.appendChild(R)}else{const R=i.ownerDocument.createElementNS(it,"foreignObject");R.style.width=`${e.width}px`,R.style.height=`${e.height}px`,R.style.border="none";const P=R.ownerDocument.createElementNS(it,"div");P.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),P.style.width="100%",P.style.height="100%";const L=P.ownerDocument.createElement("iframe");L.src=(S==null?void 0:S.link)??"",L.style.width="100%",L.style.height="100%",L.style.border="none",L.style.borderRadius=`${k}px`,L.style.top="0",L.style.left="0",L.allowFullscreen=!0,P.appendChild(L),R.appendChild(P),T.appendChild(R)}b(T);break}case"line":case"arrow":{const v=Re(e,t),I=i.ownerDocument.createElementNS(it,"mask");if(v){I.setAttribute("id",`mask-${e.id}`);const k=i.ownerDocument.createElementNS(it,"rect");r=r||0,o=o||0,k.setAttribute("x","0"),k.setAttribute("y","0"),k.setAttribute("fill","#fff"),k.setAttribute("width",`${e.width+100+r}`),k.setAttribute("height",`${e.height+100+o}`),I.appendChild(k);const S=i.ownerDocument.createElementNS(it,"rect"),R=pe.getBoundTextElementPosition(e,v,t),P=r+R.x-e.x,L=o+R.y-e.y;S.setAttribute("x",P.toString()),S.setAttribute("y",L.toString()),S.setAttribute("fill","#000"),S.setAttribute("width",`${v.width}`),S.setAttribute("height",`${v.height}`),S.setAttribute("opacity","1"),I.appendChild(S)}const C=i.ownerDocument.createElementNS(it,"g");v&&C.setAttribute("mask",`url(#mask-${e.id})`),C.setAttribute("stroke-linecap","round"),Zt.generateElementShape(e,a).forEach(k=>{const S=g1(n,k,i1);y!==1&&(S.setAttribute("stroke-opacity",`${y}`),S.setAttribute("fill-opacity",`${y}`)),S.setAttribute("transform",`translate(${r||0} ${o||0}) rotate(${p} ${h} ${m})`),e.type==="line"&&qo(e.points)&&e.backgroundColor!=="transparent"&&S.setAttribute("fill-rule","evenodd"),C.appendChild(S)});const T=m1(e,U,[C,I],a.frameRendering,t);T?(b(T),U.appendChild(T)):(b(C),U.append(I));break}case"freedraw":{const v=Zt.generateElementShape(e,a),I=v?g1(n,v,i1):i.ownerDocument.createElementNS(it,"g");y!==1&&(I.setAttribute("stroke-opacity",`${y}`),I.setAttribute("fill-opacity",`${y}`)),I.setAttribute("transform",`translate(${r||0} ${o||0}) rotate(${p} ${h} ${m})`),I.setAttribute("stroke","none");const C=i.ownerDocument.createElementNS(it,"path");C.setAttribute("fill",e.strokeColor),C.setAttribute("d",Oz(e)),I.appendChild(C);const _=m1(e,U,[I],a.frameRendering,t);b(_||I);break}case"image":{const v=Math.round(e.width),I=Math.round(e.height),C=Dn(e)&&s[e.fileId];if(C){const{reuseImages:_=!0}=a;let T=`image-${C.id}`,k=e.width,S=e.height;e.crop&&({width:k,height:S}=al(e),T=`image-crop-${C.id}-${C_(`${k}x${S}`)}`),_||(T=`image-${e.id}`);let R=i.querySelector(`#${T}`);if(!R){R=i.ownerDocument.createElementNS(it,"symbol"),R.id=T;const j=i.ownerDocument.createElementNS(it,"image");j.setAttribute("href",C.dataURL),j.setAttribute("preserveAspectRatio","none"),e.crop||!_?(j.setAttribute("width",`${k}`),j.setAttribute("height",`${S}`)):(j.setAttribute("width","100%"),j.setAttribute("height","100%")),R.appendChild(j),(U.querySelector("defs")||U).prepend(R)}const P=i.ownerDocument.createElementNS(it,"use");P.setAttribute("href",`#${T}`),a.exportWithDarkMode&&C.mimeType!==_e.svg&&P.setAttribute("filter",Cz);let L=0,X=0;if(e.crop){const{width:j,height:W}=al(e);L=e.crop.x/(e.crop.naturalWidth/j),X=e.crop.y/(e.crop.naturalHeight/W)}const G=h+L,z=m+X;P.setAttribute("width",`${v+L}`),P.setAttribute("height",`${I+X}`),P.setAttribute("opacity",`${y}`),(e.scale[0]!==1||e.scale[1]!==1)&&P.setAttribute("transform",`translate(${G} ${z}) scale(${e.scale[0]} ${e.scale[1]}) translate(${-G} ${-z})`);const V=i.ownerDocument.createElementNS(it,"g");if(e.crop){const j=i.ownerDocument.createElementNS(it,"mask");j.setAttribute("id",`mask-image-crop-${e.id}`),j.setAttribute("fill","#fff");const W=i.ownerDocument.createElementNS(it,"rect");W.setAttribute("x",`${L}`),W.setAttribute("y",`${X}`),W.setAttribute("width",`${v}`),W.setAttribute("height",`${I}`),j.appendChild(W),U.appendChild(j),V.setAttribute("mask",`url(#${j.id})`)}if(V.appendChild(P),V.setAttribute("transform",`translate(${r-L} ${o-X}) rotate(${p} ${G} ${z})`),e.roundness){const j=i.ownerDocument.createElementNS(it,"clipPath");j.id=`image-clipPath-${e.id}`;const W=i.ownerDocument.createElementNS(it,"rect"),Q=us(Math.min(e.width,e.height),e);W.setAttribute("width",`${e.width}`),W.setAttribute("height",`${e.height}`),W.setAttribute("rx",`${Q}`),W.setAttribute("ry",`${Q}`),j.appendChild(W),b(j),V.setAttributeNS(it,"clip-path",`url(#${j.id})`)}const $=m1(e,U,[V],a.frameRendering,t);b($||V)}break}case"frame":case"magicframe":{if(a.frameRendering.enabled&&a.frameRendering.outline){const v=document.createElementNS(it,"rect");v.setAttribute("transform",`translate(${r||0} ${o||0}) rotate(${p} ${h} ${m})`),v.setAttribute("width",`${e.width}px`),v.setAttribute("height",`${e.height}px`),v.setAttribute("rx",Ft.radius.toString()),v.setAttribute("ry",Ft.radius.toString()),v.setAttribute("fill","none"),v.setAttribute("stroke",Ft.strokeColor),v.setAttribute("stroke-width",Ft.strokeWidth.toString()),b(v)}break}default:if(de(e)){const v=i.ownerDocument.createElementNS(it,"g");y!==1&&(v.setAttribute("stroke-opacity",`${y}`),v.setAttribute("fill-opacity",`${y}`)),v.setAttribute("transform",`translate(${r||0} ${o||0}) rotate(${p} ${h} ${m})`);const I=e.text.replace(/\r\n?/g,`
`).split(`
`),C=bp(e.fontSize,e.lineHeight),_=e.textAlign==="center"?e.width/2:e.textAlign==="right"?e.width:0,T=hB(e.fontFamily,e.fontSize,C),k=IB(e.text)?"rtl":"ltr",S=e.textAlign==="center"?"middle":e.textAlign==="right"||k==="rtl"?"end":"start";for(let P=0;P<I.length;P++){const L=i.ownerDocument.createElementNS(it,"text");L.textContent=I[P],L.setAttribute("x",`${_}`),L.setAttribute("y",`${P*C+T}`),L.setAttribute("font-family",hp(e)),L.setAttribute("font-size",`${e.fontSize}px`),L.setAttribute("fill",e.strokeColor),L.setAttribute("text-anchor",S),L.setAttribute("style","white-space: pre;"),L.setAttribute("direction",k),L.setAttribute("dominant-baseline","alphabetic"),v.appendChild(L)}const R=m1(e,U,[v],a.frameRendering,t);b(R||v)}else throw new Error(`Unimplemented type ${e.type}`)}},x5e=(e,t,n,i,s,r)=>{i&&(e.filter(o=>!pr(o)).forEach(o=>{if(!o.isDeleted){if(de(o)&&o.containerId&&t.has(o.containerId))return;try{K2(o,t,n,i,s,o.x+r.offsetX,o.y+r.offsetY,r);const a=Re(o,t);a&&K2(a,t,n,i,s,a.x+r.offsetX,a.y+r.offsetY,r)}catch(a){console.error(a)}}}),e.filter(o=>pr(o)).forEach(o=>{if(!o.isDeleted)try{K2(o,t,n,i,s,o.x+r.offsetX,o.y+r.offsetY,r)}catch(a){console.error(a)}}))},C5e=(e,t)=>{if(e.width<=t)return e;const i=document.createElement("canvas").getContext("2d");i.font=gt({fontFamily:e.fontFamily,fontSize:e.fontSize});let s=e.text;if(i.measureText(s).width>t)for(let o=s.length;o>0;o--){const a=`${s.slice(0,o)}...`;if(i.measureText(a).width<=t){s=a;break}}return Te(e,{text:s,width:t})},A5e=(e,t)=>{const n=[];for(const i of e){if(Ee(i)){let s=nr({x:i.x,y:i.y-Ft.nameOffsetY,fontFamily:et.Helvetica,fontSize:Ft.nameFontSize,lineHeight:Ft.nameLineHeight,strokeColor:t.exportWithDarkMode?Ft.nameColorDarkTheme:Ft.nameColorLightTheme,text:Sz(i)});s.y-=s.height,s=C5e(s,i.width),n.push(s)}n.push(i)}return n},qG=(e,t)=>(t=t||ia().frameRendering,{enabled:e?!0:t.enabled,outline:e?!1:t.outline,name:e?!1:t.name,clip:e?!0:t.clip}),QG=({elements:e,exportingFrame:t,frameRendering:n,exportWithDarkMode:i})=>{let s;return t?s=m_(e,t):n.enabled&&n.name?s=A5e(e,{exportWithDarkMode:i}):s=e,s},JG=async(e,t,n,{exportBackground:i,exportPadding:s=pg,viewBackgroundColor:r,exportingFrame:o},a=(c,u)=>{const d=document.createElement("canvas");return d.width=c*t.exportScale,d.height=u*t.exportScale,{canvas:d,scale:t.exportScale}},l=async()=>{await Qa.loadElementsFonts(e)})=>{await l();const c=qG(o??null,t.frameRendering??null);o&&(c.clip=!1);const u=QG({elements:e,exportingFrame:o,exportWithDarkMode:t.exportWithDarkMode,frameRendering:c});o&&(s=0);const[d,f,h,m]=xT(o?[o]:h_(u),s),{canvas:p,scale:U=1}=a(h,m),b=ia(),{imageCache:y}=await nH({imageCache:new Map,fileIds:iH(u).map(w=>w.fileId),files:n});return ZG({canvas:p,rc:nu.canvas(p),elementsMap:Zo(ve(u)),allElementsMap:Zo(ve(ru(e))),visibleElements:u,scale:U,appState:{...t,frameRendering:c,viewBackgroundColor:i?r:null,scrollX:-d+s,scrollY:-f+s,zoom:b.zoom,shouldCacheIgnoreZoom:!1,theme:t.exportWithDarkMode?ke.DARK:ke.LIGHT},renderConfig:{canvasBackgroundColor:r,imageCache:y,renderGrid:!1,isExporting:!0,embedsValidationStatus:new Map,elementsPendingErasure:new Set,pendingFlowchartNodes:null}}),p},H1=e=>document.createComment(` ${e} `),ST=async(e,t,n,i)=>{const s=qG((i==null?void 0:i.exportingFrame)??null,t.frameRendering??null);let{exportPadding:r=pg,exportWithDarkMode:o=!1,viewBackgroundColor:a,exportScale:l=1,exportEmbedScene:c}=t;const{exportingFrame:u=null}=i||{},d=QG({elements:e,exportingFrame:u,exportWithDarkMode:o,frameRendering:s});u&&(r=0);const[f,h,m,p]=xT(u?[u]:h_(d),r),U=-f+r,b=-h+r,y=document.createElementNS(it,"svg");y.setAttribute("version","1.1"),y.setAttribute("xmlns",it),y.setAttribute("viewBox",`0 0 ${m} ${p}`),y.setAttribute("width",`${m*l}`),y.setAttribute("height",`${p*l}`),o&&y.setAttribute("filter",M9);const w=y.ownerDocument.createElementNS(it,"defs"),v=y.ownerDocument.createElementNS(it,"metadata");if(y.appendChild(H1("svg-source:excalidraw")),y.appendChild(v),y.appendChild(w),c)try{M5e({metadataElement:v,payload:Ag(e,t,n||{},"local")})}catch(R){console.error(R)}const I=f_(e);if(I.length){const R=ve(e);for(const P of I){const L=y.ownerDocument.createElementNS(it,"clipPath");L.setAttribute("id",P.id);const[X,G,z,V]=ze(P,R),$=(z-X)/2-(P.x-X),j=(V-G)/2-(P.y-G),W=y.ownerDocument.createElementNS(it,"rect");W.setAttribute("transform",`translate(${P.x+U} ${P.y+b}) rotate(${P.angle} ${$} ${j})`),W.setAttribute("width",`${P.width}`),W.setAttribute("height",`${P.height}`),u||(W.setAttribute("rx",`${Ft.radius}`),W.setAttribute("ry",`${Ft.radius}`)),L.appendChild(W),w.appendChild(L)}}const C=i!=null&&i.skipInliningFonts?[]:await Qa.generateFontFaceDeclarations(e),_=`
      `,T=y.ownerDocument.createElementNS(it,"style");if(T.classList.add("style-fonts"),T.appendChild(document.createTextNode(`${_}${C.join(_)}`)),w.appendChild(T),t.exportBackground&&a){const R=y.ownerDocument.createElementNS(it,"rect");R.setAttribute("x","0"),R.setAttribute("y","0"),R.setAttribute("width",`${m}`),R.setAttribute("height",`${p}`),R.setAttribute("fill",a),y.appendChild(R)}const k=nu.svg(y),S=(i==null?void 0:i.renderEmbeddables)??!1;return x5e(d,Zo(ve(d)),k,y,n||{},{offsetX:U,offsetY:b,isExporting:!0,exportWithDarkMode:o,renderEmbeddables:S,frameRendering:s,canvasBackgroundColor:a,embedsValidationStatus:S?new Map(d.filter(R=>Ee(R)).map(R=>[R.id,!0])):new Map,reuseImages:(i==null?void 0:i.reuseImages)??!0}),y},M5e=({payload:e,metadataElement:t})=>{const n=OG(JSON.stringify(FG({text:e})),!0);t.appendChild(H1(`payload-type:${_e.excalidraw}`)),t.appendChild(H1("payload-version:2")),t.appendChild(H1("payload-start")),t.appendChild(document.createTextNode(n)),t.appendChild(H1("payload-end"))},k5e=({svg:e})=>{if(e.includes(`payload-type:${_e.excalidraw}`)){const t=e.match(/<!-- payload-start -->\s*(.+?)\s*<!-- payload-end -->/);if(!t)throw new Error("INVALID");const n=e.match(/<!-- payload-version:(\d+) -->/),s=((n==null?void 0:n[1])||"1")!=="1";try{const r=PG(t[1],s),o=JSON.parse(r);if(!("encoded"in o)){if("type"in o&&o.type===Tr.excalidraw)return r;throw new Error("FAILED")}return BG(o)}catch(r){throw console.error(r),new Error("FAILED")}}throw new Error("INVALID")},xT=(e,t)=>{const[n,i,s,r]=ft(e),o=$i(n,s)+t*2,a=$i(i,r)+t*2;return[n,i,o,a]},R5e=(e,t,n)=>{const[,,i,s]=xT(e,t).map(r=>Math.trunc(r*n));return[i,s]},D5e={selection:!0,lasso:!0,text:!0,rectangle:!0,diamond:!0,ellipse:!0,line:!0,image:!0,arrow:!0,freedraw:!0,eraser:!1,custom:!0,frame:!0,embeddable:!0,hand:!0,laser:!1,magicframe:!1},L5e=e=>Object.keys(et).includes(e)?et[e]:tu,uf=(e,t)=>{if(!t)return null;const n=t.focus||0;return ge(e)?s6(t)?{...t,focus:n,fixedPoint:q5(t.fixedPoint??[0,0])}:null:{...t,focus:n}},Nl=(e,t)=>{const n={type:t.type||e.type,version:e.version||1,versionNonce:e.versionNonce??0,index:e.index??null,isDeleted:e.isDeleted??!1,id:e.id||fs(),fillStyle:e.fillStyle||mn.fillStyle,strokeWidth:e.strokeWidth||mn.strokeWidth,strokeStyle:e.strokeStyle??mn.strokeStyle,roughness:e.roughness??mn.roughness,opacity:e.opacity==null?mn.opacity:e.opacity,angle:e.angle||0,x:t.x??e.x??0,y:t.y??e.y??0,strokeColor:e.strokeColor||mn.strokeColor,backgroundColor:e.backgroundColor||mn.backgroundColor,width:e.width||0,height:e.height||0,seed:e.seed??1,groupIds:e.groupIds??[],frameId:e.frameId??null,roundness:e.roundness?e.roundness:e.strokeSharpness==="round"?{type:Bd(e.type)?yn.LEGACY:yn.PROPORTIONAL_RADIUS}:null,boundElements:e.boundElementIds?e.boundElementIds.map(s=>({type:"arrow",id:s})):e.boundElements??[],updated:e.updated??bg(),link:e.link?Qs(e.link):null,locked:e.locked??!1};("customData"in e||"customData"in t)&&(n.customData="customData"in t?t.customData:e.customData);const i={...e,...n,...Hz(n),...t};return delete i.strokeSharpness,delete i.boundElementIds,i},N5e=(e,t)=>{var n;switch(e={...e},e.type){case"text":delete e.rawText;let i=e.fontSize,s=e.fontFamily;if("font"in e){const[f,h]=e.font.split(" ");i=parseFloat(f),s=L5e(h)}const r=typeof e.text=="string"&&e.text||"",o=e.lineHeight||(e.height?bae(e):Oc(e.fontFamily));return e=Nl(e,{fontSize:i,fontFamily:s,text:r,textAlign:e.textAlign||up,verticalAlign:e.verticalAlign||zb,containerId:e.containerId??null,originalText:e.originalText||r,autoResize:e.autoResize??!0,lineHeight:o}),t!=null&&t.deleteInvisibleElements&&!r&&!e.isDeleted&&(e={...e,originalText:r,isDeleted:!0},e=Da(e)),e;case"freedraw":return Nl(e,{points:e.points,lastCommittedPoint:null,simulatePressure:e.simulatePressure,pressures:e.pressures});case"image":return Nl(e,{status:e.status||"pending",fileId:e.fileId,scale:e.scale||[1,1],crop:e.crop??null});case"line":case"draw":const{startArrowhead:a=null,endArrowhead:l=null}=e;let c=e.x,u=e.y,d=!Array.isArray(e.points)||e.points.length<2?[x(0,0),x(e.width,e.height)]:e.points;return(d[0][0]!==0||d[0][1]!==0)&&({points:d,x:c,y:u}=pe.getNormalizeElementPointsAndCoords(e)),Nl(e,{type:e.type==="draw"?"line":e.type,startBinding:uf(e,e.startBinding),endBinding:uf(e,e.endBinding),lastCommittedPoint:null,startArrowhead:a,endArrowhead:l,points:d,x:c,y:u,...tn(e)?{polygon:T4(e.points)?e.polygon??!1:!1}:{},...Oh(d)});case"arrow":{const{startArrowhead:f=null,endArrowhead:h="arrow"}=e;let m=e.x,p=e.y,U=!Array.isArray(e.points)||e.points.length<2?[x(0,0),x(e.width,e.height)]:e.points;(U[0][0]!==0||U[0][1]!==0)&&({points:U,x:m,y:p}=pe.getNormalizeElementPointsAndCoords(e));const b={type:e.type,startBinding:uf(e,e.startBinding),endBinding:uf(e,e.endBinding),lastCommittedPoint:null,startArrowhead:f,endArrowhead:h,points:U,x:m,y:p,elbowed:e.elbowed,...Oh(U)};return ge(e)?Nl(e,{...b,elbowed:!0,startBinding:uf(e,e.startBinding),endBinding:uf(e,e.endBinding),fixedSegments:(n=e.fixedSegments)!=null&&n.length&&b.points.length>=4?e.fixedSegments:null,startIsSpecial:e.startIsSpecial,endIsSpecial:e.endIsSpecial}):Nl(e,b)}case"ellipse":case"rectangle":case"diamond":case"iframe":case"embeddable":return Nl(e,{});case"magicframe":case"frame":return Nl(e,{name:e.name??null})}return null},O5e=(e,t)=>{if(e.boundElements){const n=e.boundElements.slice(),i=new Set;e.boundElements=n.reduce((s,r)=>{const o=t.get(r.id);if(o&&!i.has(r.id)){if(i.add(r.id),o.isDeleted)return s;s.push(r),de(o)&&!o.containerId&&(o.containerId=e.id)}return s},[])}},P5e=(e,t)=>{const n=e.containerId?t.get(e.containerId):null;if(e.angle=xe(n)?0:(n==null?void 0:n.angle)??0,!n){e.containerId=null;return}if(!e.isDeleted&&n.boundElements&&!n.boundElements.find(i=>i.id===e.id)){const i=(n.boundElements||(n.boundElements=[])).slice();i.push({type:"text",id:e.id}),n.boundElements=i}},F5e=(e,t)=>{e.frameId&&(t.get(e.frameId)||(e.frameId=null))},_d=(e,t,n)=>{const i=new Set,s=t?ve(t):null,r=ru((e||[]).reduce((a,l)=>{if(l.type==="selection")return a;let c=N5e(l,{deleteInvisibleElements:n==null?void 0:n.deleteInvisibleElements});if(c){const u=s==null?void 0:s.get(l.id),d=(n==null?void 0:n.deleteInvisibleElements)&&qa(l);(d||u&&u.version>c.version)&&(c=Da(c,u==null?void 0:u.version)),d&&(c={...c,isDeleted:!0}),i.has(c.id)&&(c={...c,id:fs()}),i.add(c.id),a.push(c)}return a},[]));if(!(n!=null&&n.repairBindings))return r;const o=ve(r);for(const a of r)a.frameId&&F5e(a,o),de(a)&&a.containerId?P5e(a,o):a.boundElements&&O5e(a,o),n.refreshDimensions&&de(a)&&Object.assign(a,qz(a,jn(a,o),o)),Se(a)&&(a.startBinding&&(!o.has(a.startBinding.elementId)||!xe(a))&&(a.startBinding=null),a.endBinding&&(!o.has(a.endBinding.elementId)||!xe(a))&&(a.endBinding=null));return r.map(a=>{if(ge(a)&&!KB(a)&&!uz(a.points))return{...a,...yg(a,o,{points:[x(0,0),a.points[a.points.length-1]]}),index:a.index};if(ge(a)&&a.startBinding&&a.endBinding&&a.startBinding.elementId===a.endBinding.elementId&&a.points.length>1&&a.points.some(([l,c])=>Math.abs(l)>1e6||Math.abs(c)>1e6)){console.error("Fixing self-bound elbow arrow",a.id);const l=o.get(a.startBinding.elementId);return l?{...a,x:l.x+l.width/2,y:l.y-5,width:l.width,height:l.height,points:[x(0,0),x(0,-10),x(l.width/2+5,-10),x(l.width/2+5,l.height/2+5)]}:(console.error("Bound element not found",a.startBinding.elementId),a)}return a})},B5e=(e,t,n)=>{const i=t[e];return i!==void 0?i:n[e]},CR={isSidebarDocked:(e,t)=>["defaultSidebarDockedPreference",e.isSidebarDocked??B5e("defaultSidebarDockedPreference",e,t)]},eX=(e,t)=>{var s;e=e||{};const n=ia(),i={};for(const r of Object.keys(CR))if(r in e){const[o,a]=CR[r](e,n);i[o]=a}for(const[r,o]of Object.entries(n)){const a=e[r],l=t?t[r]:void 0;i[r]=a!==void 0?a:l!==void 0?l:o}return{...i,cursorButton:(t==null?void 0:t.cursorButton)||"up",penDetected:(t==null?void 0:t.penDetected)??(e.penMode?e.penDetected??!1:!1),activeTool:{...en(n,i.activeTool.type&&D5e[i.activeTool.type]?i.activeTool:{type:"selection"}),lastActiveTool:null,locked:i.activeTool.locked??!1},zoom:{value:Ha(m0(e.zoom)?e.zoom:((s=e.zoom)==null?void 0:s.value)??n.zoom.value)},openSidebar:typeof e.openSidebar=="string"?{name:Ir.name}:i.openSidebar,gridSize:Wue(m0(e.gridSize)?e.gridSize:Vb),gridStep:gV(m0(e.gridStep)?e.gridStep:rB),editingFrame:null}},Td=(e,t,n,i)=>({elements:_d(e==null?void 0:e.elements,n,i),appState:eX(e==null?void 0:e.appState,t||null),files:(e==null?void 0:e.files)||{}}),AR=e=>{const t=_d(jt(e.elements),null);return t.length?{...e,elements:t}:null},Ny=(e=[],t)=>{const n=[];for(const i of e)if(Array.isArray(i)){const s=AR({status:t,elements:i,id:fs(),created:Date.now()});s&&n.push(s)}else{const s=i,r=AR({...s,id:s.id||fs(),status:s.status||t,created:s.created||Date.now()});r&&n.push(r)}return n},tX=async e=>{let t;if(e.type===_e.png)try{return await(await ye(()=>Promise.resolve().then(()=>RX),void 0)).decodePngMetadata(e)}catch(n){throw n.message==="INVALID"?new Lu("Image doesn't contain scene","IMAGE_NOT_CONTAINS_SCENE_DATA"):new Lu("Error: cannot restore image")}else if("text"in Blob?t=await e.text():t=await new Promise(n=>{const i=new FileReader;i.readAsText(e,"utf8"),i.onloadend=()=>{i.readyState===FileReader.DONE&&n(i.result)}}),e.type===_e.svg)try{return k5e({svg:t})}catch(n){throw n.message==="INVALID"?new Lu("Image doesn't contain scene","IMAGE_NOT_CONTAINS_SCENE_DATA"):new Lu("Error: cannot restore image")}return t},nX=e=>{var t;return e&&((t=e.name.match(/\.(json|excalidraw|png|svg)$/))==null?void 0:t[1])||null},z5e=e=>e==="png"||e==="svg",CT=e=>{const t=nX(e);return t==="png"||t==="svg"},iX=e=>!!e&&Object.values(Lh).includes(e),Am=e=>{const{type:t}=e||{};return iX(t)},sX=async(e,t,n,i)=>{const s=await tX(e);let r;try{try{r=JSON.parse(s)}catch(o){throw Am(e)?new Lu("Image doesn't contain scene","IMAGE_NOT_CONTAINS_SCENE_DATA"):o}if(y5e(r))return{type:_e.excalidraw,data:Td({elements:mH(r.elements||[]),appState:{theme:t==null?void 0:t.theme,fileHandle:i||e.handle||null,...X$(r.appState||{}),...t?mm(r.elements||[],t):{}},files:r.files},t,n,{repairBindings:!0,refreshDimensions:!1,deleteInvisibleElements:!0})};if(GG(r))return{type:_e.excalidrawlib,data:r};throw new Error("Error: invalid file")}catch(o){throw o instanceof Lu?o:new Error("Error: invalid file")}},AT=async(e,t,n,i)=>{const s=await sX(e,t,n,i);if(s.type!==_e.excalidraw)throw new Error("Error: invalid file");return s.data},rX=(e,t="unpublished")=>{const n=JSON.parse(e);if(!GG(n))throw new Error("Invalid library");const i=n.libraryItems||n.library;return Ny(i,t)},H5e=async(e,t="unpublished")=>rX(await tX(e),t),Mm=async e=>new Promise(async(t,n)=>{try{mp(e)&&(e=await e),e.toBlob(i=>{if(!i)return n(new Dfe("Error: Canvas too big","CANVAS_POSSIBLY_TOO_BIG"));t(i)})}catch(i){n(i)}}),V5e=async e=>{try{const t=await window.crypto.subtle.digest("SHA-1",await Dp(e));return CB(new Uint8Array(t))}catch(t){return console.error(t),XB(40)}},oX=async e=>new Promise((t,n)=>{const i=new FileReader;i.onload=()=>{const s=i.result;t(s)},i.onerror=s=>n(s),i.readAsDataURL(e)}),$5e=(e,t)=>`data:${t};base64,${OG(B6(e),!0)}`,G5e=e=>PG(e.slice(e.indexOf(",")+1)),aX=async(e,t)=>{if(e.type===_e.svg)return e;const[n,i]=await Promise.all([ye(()=>import("./pica-CjMP7JXY.js").then(r=>r.p),__vite__mapDeps([2,3])).then(r=>r.default),ye(()=>import("./image-blob-reduce.esm-B6b2_-a4.js"),__vite__mapDeps([])).then(r=>r.default)]),s=i({pica:n({features:["js","wasm"]})});if(t.outputType){const{outputType:r}=t;s._create_blob=function(o){return this.pica.toBlob(o.out_canvas,r,.8).then(a=>(o.out_blob=a,o))}}if(!Am(e))throw new Error("Error: unsupported file type",{cause:"UNSUPPORTED"});return new File([await s.toBlob(e,{max:t.maxWidthOrHeight,alpha:!0})],e.name,{type:t.outputType||e.type})},MR=(e,t="")=>new File([new TextEncoder().encode(e)],t,{type:_e.svg}),X5e=async(e,t="")=>{let n;try{n=await fetch(e)}catch{throw new Error("Error: failed to fetch image",{cause:"FETCH_ERROR"})}if(!n.ok)throw new Error("Error: failed to fetch image",{cause:"FETCH_ERROR"});const i=await n.blob();if(i.type&&Am(i)){const s=t||i.name||"";return new File([i],s,{type:i.type})}throw new Error("Error: unsupported file type",{cause:"UNSUPPORTED"})},j5e=async e=>{var t,n;if(Gd)try{return await(e instanceof DataTransferItem?e:(n=(t=e.dataTransfer)==null?void 0:t.items)==null?void 0:n[0]).getAsFileSystemHandle()||null}catch(i){return console.warn(i.name,i.message),null}return null},Y5e=async e=>{let t=null;const n=[...new Uint8Array(await Dp(e.slice(0,15)))].join(" "),i={png:/^137 80 78 71 13 10 26 10\b/,jpg:/^255 216 255\b/,gif:/^71 73 70 56 57 97\b/,webp:/^82 73 70 70 \d+ \d+ \d+ \d+ 87 69 66 80 86 80 56\b/};for(const s of Object.keys(i))if(n.match(i[s])){t=_e[s];break}return t||e.type||null},Z2=(e,t,n)=>new File([e],n||"",{type:t}),kR=Symbol("fileNormalized"),km=async e=>{var t,n,i;if(e[kR])return e;if((t=e==null?void 0:e.name)!=null&&t.endsWith(".excalidrawlib"))e=Z2(e,_e.excalidrawlib,e.name);else if((n=e==null?void 0:e.name)!=null&&n.endsWith(".excalidraw"))e=Z2(e,_e.excalidraw,e.name);else if(!e.type||(i=e.type)!=null&&i.startsWith("image/")){const s=await Y5e(e);s&&s!==e.type&&(e=Z2(e,s,e.name))}return e[kR]=!0,e},Dp=e=>"arrayBuffer"in e?e.arrayBuffer():new Promise((t,n)=>{const i=new FileReader;i.onload=s=>{var r;if(!((r=s.target)!=null&&r.result))return n(new Error("Couldn't convert blob to ArrayBuffer"));t(s.target.result)},i.readAsArrayBuffer(e)}),Wr=32,Nt=12,Tc=256,lX=50,Cu="NOT_SPREADSHEET",Rm="VALID_SPREADSHEET",V1=e=>{const t=/^([-+]?)[$]?([-+]?)([\d.,]+)[%]?$/.exec(e);return t?parseFloat(`${(t[1]||t[2])+t[3]}`.replace(/,/g,"")):null},U3=(e,t)=>e.slice(1).every(n=>V1(n[t])!==null),RR=e=>{const t=e[0].length;if(t>2)return{type:Cu,reason:"More than 2 columns"};if(t===1){if(!U3(e,0))return{type:Cu,reason:"Value is not numeric"};const l=V1(e[0][0])===null,c=(l?e.slice(1):e).map(u=>V1(u[0]));return c.length<2?{type:Cu,reason:"Less than two rows"}:{type:Rm,spreadsheet:{title:l?e[0][0]:null,labels:null,values:c}}}const n=U3(e,0),i=U3(e,1);if(!n&&!i)return{type:Cu,reason:"Value is not numeric"};const[s,r]=i?[0,1]:[1,0],o=V1(e[0][r])===null,a=o?e.slice(1):e;return a.length<2?{type:Cu,reason:"Less than 2 rows"}:{type:Rm,spreadsheet:{title:o?e[0][r]:null,labels:a.map(l=>l[s]),values:a.map(l=>V1(l[r]))}}},W5e=e=>{const t=[];for(let n=0;n<e[0].length;n++){const i=[];for(let s=0;s<e.length;s++)i.push(e[s][n]);t.push(i)}return t},K5e=e=>{let t=e.trim().split(`
`).map(r=>r.trim().split("	"));if(t.length&&t[0].length!==2&&(t=e.trim().split(`
`).map(r=>r.trim().split(","))),t.length===0)return{type:Cu,reason:"No values"};const n=t[0].length;if(!t.every(r=>r.length===n))return{type:Cu,reason:"All rows don't have same number of columns"};const s=RR(t);if(s.type!==Rm){const r=RR(W5e(t));if(r.type===Rm)return r}return s},V6=fse(cse),no={fillStyle:"hachure",fontFamily:tu,fontSize:vl,opacity:100,roughness:1,strokeColor:Ge.black,roundness:null,strokeStyle:"solid",strokeWidth:1,verticalAlign:Gs.MIDDLE,locked:!1},cX=e=>{const t=(Wr+Nt)*e.values.length+Nt,n=Tc+Nt*2;return{chartWidth:t,chartHeight:n}},Z5e=(e,t,n,i,s)=>{var r;return((r=e.labels)==null?void 0:r.map((o,a)=>nr({groupIds:[i],backgroundColor:s,...no,text:o.length>8?`${o.slice(0,5)}...`:o,x:t+a*(Wr+Nt)+Nt*2,y:n+Nt/2,width:Wr,angle:5.87,fontSize:16,textAlign:"center",verticalAlign:"top"})))||[]},q5e=(e,t,n,i,s)=>{const r=nr({groupIds:[i],backgroundColor:s,...no,x:t-Nt,y:n-Nt,text:"0",textAlign:"right"}),o=nr({groupIds:[i],backgroundColor:s,...no,x:t-Nt,y:n-Tc-r.height/2,text:Math.max(...e.values).toLocaleString(),textAlign:"right"});return[r,o]},Q5e=(e,t,n,i,s)=>{const{chartWidth:r,chartHeight:o}=cX(e),a=Ec({backgroundColor:s,groupIds:[i],...no,type:"line",x:t,y:n,width:r,points:[x(0,0),x(r,0)]}),l=Ec({backgroundColor:s,groupIds:[i],...no,type:"line",x:t,y:n,height:o,points:[x(0,0),x(0,-280)]}),c=Ec({backgroundColor:s,groupIds:[i],...no,type:"line",x:t,y:n-Tc-Nt,strokeStyle:"dotted",width:r,opacity:lX,points:[x(0,0),x(r,0)]});return[a,l,c]},uX=(e,t,n,i,s,r)=>{const{chartWidth:o}=cX(e),a=e.title?nr({backgroundColor:s,groupIds:[i],...no,text:e.title,x:t+o/2,y:n-Tc-Nt*2-vl,roundness:null,textAlign:"center"}):null;return[...a?[a]:[],...Z5e(e,t,n,i,s),...q5e(e,t,n,i,s),...Q5e(e,t,n,i,s)]},J5e=(e,t,n)=>{const i=Math.max(...e.values),s=fs(),r=V6[Math.floor(Math.random()*V6.length)];return[...e.values.map((a,l)=>{const c=a/i*Tc;return ta({backgroundColor:r,groupIds:[s],...no,type:"rectangle",x:t+l*(Wr+Nt)+Nt,y:n-c-Nt,width:Wr,height:c})}),...uX(e,t,n,s,r)]},eye=(e,t,n)=>{const i=Math.max(...e.values),s=fs(),r=V6[Math.floor(Math.random()*V6.length)];let o=0;const a=[];for(const p of e.values){const U=o*(Wr+Nt),b=-(p/i)*Tc;a.push([U,b]),o++}const l=Math.max(...a.map(p=>p[0])),c=Math.max(...a.map(p=>p[1])),u=Math.min(...a.map(p=>p[0])),d=Math.min(...a.map(p=>p[1])),f=Ec({backgroundColor:r,groupIds:[s],...no,type:"line",x:t+Nt+Wr/2,y:n-Nt,height:c-d,width:l-u,strokeWidth:2,points:a}),h=e.values.map((p,U)=>{const b=U*(Wr+Nt)+Nt/2,y=-(p/i)*Tc+Nt/2;return ta({backgroundColor:r,groupIds:[s],...no,fillStyle:"solid",strokeWidth:2,type:"ellipse",x:t+b+Wr/2,y:n+y-Nt*2,width:Nt,height:Nt})}),m=e.values.map((p,U)=>{const b=U*(Wr+Nt)+Nt/2,y=p/i*Tc+Nt/2+Nt;return Ec({backgroundColor:r,groupIds:[s],...no,type:"line",x:t+b+Wr/2+Nt/2,y:n-y,height:y,strokeStyle:"dotted",opacity:lX,points:[x(0,0),x(0,y)]})});return[...uX(e,t,n,s,r),f,...m,...h]},tye=(e,t,n,i)=>e==="line"?eye(t,n,i):J5e(t,n,i),MT="clipboard"in navigator&&"writeText"in navigator.clipboard,kT="clipboard"in navigator&&"write"in navigator.clipboard&&"ClipboardItem"in window&&"toBlob"in HTMLCanvasElement.prototype,nye=e=>!!([Tr.excalidraw,Tr.excalidrawClipboard,Tr.excalidrawClipboardWithAPI].includes(e==null?void 0:e.type)&&Array.isArray(e.elements)),iye=({types:e,files:t})=>{var i,s,r,o,a;!e&&!t&&console.warn("createPasteEvent: no types or files provided");const n=new ClipboardEvent(te.PASTE,{clipboardData:new DataTransfer});if(e)for(const[l,c]of Object.entries(e)){if(typeof c!="string"){t=t||[],t.push(c),(i=n.clipboardData)==null||i.items.add(c);continue}try{if((s=n.clipboardData)==null||s.items.add(c,l),((r=n.clipboardData)==null?void 0:r.getData(l))!==c)throw new Error(`Failed to set "${l}" as clipboardData item`)}catch(u){throw new Error(u.message)}}if(t){let l=-1;for(const c of t){l++;try{if((o=n.clipboardData)==null||o.items.add(c),((a=n.clipboardData)==null?void 0:a.files[l])!==c)throw new Error(`Failed to set file "${c.name}" as clipboardData item`)}catch(u){throw new Error(u.message)}}}return n},sye=({elements:e,files:t})=>{const n=ve(e),i=new Set(e.filter(a=>Ee(a)));let s=!1;const r=e.reduce((a,l)=>(Dn(l)&&(s=!0,t&&t[l.fileId]&&(a[l.fileId]=t[l.fileId])),a),{});s&&!t&&console.warn("copyToClipboard: attempting to file element(s) without providing associated `files` object.");const o={type:Tr.excalidrawClipboard,elements:e.map(a=>{if(Ss(a,n)&&!i.has(Ss(a,n))){const l=zc(a);return vi(l,n,{frameId:null}),l}return a}),files:t?r:void 0};return JSON.stringify(o)},rye=async(e,t,n)=>{await au(sye({elements:e,files:t}),n)},oye=e=>{const t=K5e(e);return t.type===Rm?{spreadsheet:t.spreadsheet}:null};function dX(e){var n;let t=[];for(const i of e.childNodes)if(i.nodeType===3){const s=(n=i.textContent)==null?void 0:n.trim();s&&t.push({type:"text",value:s})}else if(i instanceof HTMLImageElement){const s=i.getAttribute("src");s&&s.startsWith("http")&&t.push({type:"imageUrl",value:s})}else t=t.concat(dX(i));return t}const aye=e=>{const t=e.value;try{const n=new DOMParser().parseFromString(t,_e.html),i=dX(n.body);if(i.length)return{type:"mixedContent",value:i}}catch(n){console.error(`error in parseHTMLFromPaste: ${n.message}`)}return null},lye=async()=>{var n,i,s,r;const e={};let t;try{t=await((n=navigator.clipboard)==null?void 0:n.read())}catch(o){try{if((i=navigator.clipboard)!=null&&i.readText){console.warn(`navigator.clipboard.readText() failed (${o.message}). Failling back to navigator.clipboard.read()`);const a=await((s=navigator.clipboard)==null?void 0:s.readText());if(a)return{[_e.text]:a}}}catch(a){if((r=navigator.clipboard)!=null&&r.read)console.warn(`navigator.clipboard.readText() failed (${a.message}). Failling back to navigator.clipboard.read()`);else{if(a.name==="DataError")return console.warn(`navigator.clipboard.read() error, clipboard is probably empty: ${a.message}`),e;throw a}}throw o}for(const o of t)for(const a of o.types)if(MB(xse,a))try{if(a===_e.text||a===_e.html)e[a]=await(await o.getType(a)).text();else if(iX(a)){const l=await o.getType(a),c=Z2(l,a,void 0);e[a]=c}else throw new qr(`Unsupported clipboard type: ${a}`)}catch(l){console.warn(l instanceof qr?l.message:`Cannot retrieve ${a} from clipboardItem: ${l.message}`)}return Object.keys(e).length===0&&console.warn("No clipboard data found from clipboard.read()."),e},cye=async(e,t=!1)=>{try{const n=e.findByType(_e.html),i=!t&&n&&aye(n);return i?i.value.every(s=>s.type==="text")?{type:"text",value:e.getData(_e.text)??i.value.map(s=>s.value).join(`
`).trim()}:i:{type:"text",value:(e.getData(_e.text)||"").trim()}}catch{return{type:"text",value:""}}},uye=function(e){return this.find(t=>t.type===e)||null},dye=function(e){const t=this.find(n=>n.type===e);return(t==null?void 0:t.value)??null},fye=function(){return this.filter(e=>e.kind==="file")},bv=async e=>{var i,s;let t;pye(e)?t=(i=e.clipboardData)==null?void 0:i.items:t=(s=e.dataTransfer)==null?void 0:s.items;const n=(await Promise.all(Array.from(t||[]).map(async r=>{var o;if(r.kind==="file"){let a=r.getAsFile();if(a){const l=await j5e(r);return a=await km(a),{type:a.type,kind:"file",file:a,fileHandle:l}}}else if(r.kind==="string"){const{type:a}=r;let l;return"clipboardData"in e&&e.clipboardData?l=(o=e.clipboardData)==null?void 0:o.getData(a):l=await new Promise(c=>{r.getAsString(u=>c(u))}),{type:a,kind:"string",value:l}}return null}))).filter(r=>r!=null);return Object.assign(n,{findByType:uye,getData:dye,getFiles:fye})},hye=async(e,t=!1)=>{const n=await cye(e,t);if(n.type==="mixedContent")return{mixedContent:n.value};try{const i=!t&&oye(n.value);if(i)return i}catch(i){console.error(i)}try{const i=JSON.parse(n.value),s=i.type===Tr.excalidrawClipboardWithAPI;if(nye(i))return{elements:i.elements,files:i.files,text:t?JSON.stringify(i.elements,null,2):void 0,programmaticAPI:s}}catch{}return{text:n.value}},gye=async e=>{try{await navigator.clipboard.write([new window.ClipboardItem({[_e.png]:e})])}catch(t){if(mp(e))await navigator.clipboard.write([new window.ClipboardItem({[_e.png]:await e})]);else throw t}},au=async(e,t)=>{var n,i;if(MT)try{await navigator.clipboard.writeText(e||"");return}catch(s){console.error(s)}try{if(t){if((n=t.clipboardData)==null||n.setData(_e.text,e||""),((i=t.clipboardData)==null?void 0:i.getData(_e.text))!==e)throw new Error("Failed to setData on clipboardEvent");return}}catch(s){console.error(s)}if(!mye(e))throw new Error("Error copying to clipboard.")},mye=e=>{e||(e=" ");const t=document.documentElement.getAttribute("dir")==="rtl",n=document.createElement("textarea");n.style.border="0",n.style.padding="0",n.style.margin="0",n.style.position="absolute",n.style[t?"right":"left"]="-9999px";const i=window.pageYOffset||document.documentElement.scrollTop;n.style.top=`${i}px`,n.style.fontSize="12pt",n.setAttribute("readonly",""),n.value=e,document.body.appendChild(n);let s=!1;try{n.select(),n.setSelectionRange(0,n.value.length),s=document.execCommand("copy")}catch(r){console.error(r)}return n.remove(),s},pye=e=>e.type===te.PASTE||e.type===te.COPY||e.type===te.CUT,Oy=(e,{selectedElementIds:t},n)=>{e=jt(e);const i=n&&Yn(e,{selectedElementIds:t});let s=null,r=i?Ve(e,{selectedElementIds:t},{includeBoundTextElement:!0}):e;return i&&(r.length===1&&Ee(r[0])?(s=r[0],r=m_(e,s)):r.length>1&&(r=Ve(e,{selectedElementIds:t},{includeBoundTextElement:!0,includeElementsInFrames:!0}))),{exportingFrame:s,exportedElements:Wa(r)}},Py=async(e,t,n,i,{exportBackground:s,exportPadding:r=pg,viewBackgroundColor:o,name:a=n.name||dB,fileHandle:l=null,exportingFrame:c=null})=>{if(t.length===0)throw new Error(M("alerts.cannotExportEmptyCanvas"));if(e==="svg"||e==="clipboard-svg"){const d=ST(t,{exportBackground:s,exportWithDarkMode:n.exportWithDarkMode,viewBackgroundColor:o,exportPadding:r,exportScale:n.exportScale,exportEmbedScene:n.exportEmbedScene&&e==="svg"},i,{exportingFrame:c});if(e==="svg")return H6(d.then(f=>new Blob([zse+f.outerHTML],{type:_e.svg})),{description:"Export to SVG",name:a,extension:n.exportEmbedScene?"excalidraw.svg":"svg",mimeTypes:[Lh.svg],fileHandle:l});if(e==="clipboard-svg"){const f=await d.then(h=>h.outerHTML);try{await au(f)}catch{throw new Error(M("errors.copyToSystemClipboardFailed"))}return}}const u=JG(t,n,i,{exportBackground:s,viewBackgroundColor:o,exportPadding:r,exportingFrame:c});if(e==="png"){let d=Mm(u);return n.exportEmbedScene&&(d=d.then(f=>ye(()=>Promise.resolve().then(()=>RX),void 0).then(({encodePngMetadata:h})=>h({blob:f,metadata:Ag(t,n,i,"local")})))),H6(d,{description:"Export to PNG",name:a,extension:n.exportEmbedScene?"excalidraw.png":"png",mimeTypes:[Lh.png],fileHandle:l})}else if(e==="clipboard")try{const d=Mm(u);await gye(d)}catch(d){throw console.warn(d),d.name==="CANVAS_POSSIBLY_TOO_BIG"?new Error(M("canvasError.canvasTooBig")):im&&d.name==="TypeError"?new Error(`${M("alerts.couldNotCopyToClipboard")}

${M("hints.firefox_clipboard_write")}`):new Error(M("alerts.couldNotCopyToClipboard"))}else throw new Error("Unsupported export type")},Uye=async(e,t,n,i)=>{const{exportBackground:s,viewBackgroundColor:r,fileHandle:o}=t,a=nX(o);if(!o||!z5e(a))throw new Error("fileHandle should exist and should be of type svg or png when resaving");t={...t,exportEmbedScene:!0};const{exportedElements:l,exportingFrame:c}=Oy(e,t,!1);return await Py(a,l,t,n,{exportBackground:s,viewBackgroundColor:r,name:i,fileHandle:o,exportingFrame:c}),{fileHandle:o}},bye=ce({name:"changeProjectName",label:"labels.fileTitle",trackEvent:!1,perform:(e,t,n)=>({appState:{...t,name:n},captureUpdate:K.EVENTUALLY}),PanelComponent:({appState:e,updateData:t,appProps:n,data:i,app:s})=>g(R2e,{label:M("labels.fileTitle"),value:s.getName(),onChange:r=>t(r),ignoreFocus:(i==null?void 0:i.ignoreFocus)??!1})}),yye=ce({name:"changeExportScale",label:"imageExportDialog.scale",trackEvent:{category:"export",action:"scale"},perform:(e,t,n)=>({appState:{...t,exportScale:n},captureUpdate:K.EVENTUALLY}),PanelComponent:({elements:e,appState:t,updateData:n})=>{const i=jt(e),r=Yn(i,t)?Ve(i,t):i;return g(fe,{children:k9.map(o=>{const[a,l]=R5e(r,pg,o),c=`${M("imageExportDialog.label.scale")} ${o}x (${a}x${l})`;return g($e,{size:"small",type:"radio",icon:`${o}x`,name:"export-canvas-scale",title:c,"aria-label":c,id:"export-canvas-scale",checked:o===t.exportScale,onChange:()=>n(o)},o)})})}}),Eye=ce({name:"changeExportBackground",label:"imageExportDialog.label.withBackground",trackEvent:{category:"export",action:"toggleBackground"},perform:(e,t,n)=>({appState:{...t,exportBackground:n},captureUpdate:K.EVENTUALLY}),PanelComponent:({appState:e,updateData:t})=>g(bT,{checked:e.exportBackground,onChange:n=>t(n),children:M("imageExportDialog.label.withBackground")})}),fX=ce({name:"changeExportEmbedScene",label:"imageExportDialog.tooltip.embedScene",trackEvent:{category:"export",action:"embedScene"},perform:(e,t,n)=>({appState:{...t,exportEmbedScene:n},captureUpdate:K.EVENTUALLY}),PanelComponent:({appState:e,updateData:t})=>N(bT,{checked:e.exportEmbedScene,onChange:n=>t(n),children:[M("imageExportDialog.label.embedScene"),g(hl,{label:M("imageExportDialog.tooltip.embedScene"),long:!0,children:g("div",{className:"excalidraw-tooltip-icon",children:gde})})]})}),$6=ce({name:"saveToActiveFile",label:"buttons.save",icon:cy,trackEvent:{category:"export"},predicate:(e,t,n,i)=>!!i.props.UIOptions.canvasActions.saveToActiveFile&&!!t.fileHandle&&!t.viewModeEnabled,perform:async(e,t,n,i)=>{const s=!!t.fileHandle;try{const{fileHandle:r}=CT(t.fileHandle)?await Uye(e,t,i.files,i.getName()):await $G(e,t,i.files,i.getName());return{captureUpdate:K.EVENTUALLY,appState:{...t,fileHandle:r,toast:s?{message:r!=null&&r.name?M("toast.fileSavedToFilename").replace("{filename}",`"${r.name}"`):M("toast.fileSaved")}:null}}}catch(r){return(r==null?void 0:r.name)!=="AbortError"?console.error(r):console.warn(r),{captureUpdate:K.EVENTUALLY}}},keyTest:e=>e.key===H.S&&e[H.CTRL_OR_CMD]&&!e.shiftKey}),hX=ce({name:"saveFileToDisk",label:"exportDialog.disk_title",icon:cy,viewMode:!0,trackEvent:{category:"export"},perform:async(e,t,n,i)=>{try{const{fileHandle:s}=await $G(e,{...t,fileHandle:null},i.files,i.getName());return{captureUpdate:K.EVENTUALLY,appState:{...t,openDialog:null,fileHandle:s,toast:{message:M("toast.fileSaved")}}}}catch(s){return(s==null?void 0:s.name)!=="AbortError"?console.error(s):console.warn(s),{captureUpdate:K.EVENTUALLY}}},keyTest:e=>e.key===H.S&&e.shiftKey&&e[H.CTRL_OR_CMD],PanelComponent:({updateData:e})=>g($e,{type:"button",icon:ude,title:M("buttons.saveAs"),"aria-label":M("buttons.saveAs"),showAriaLabel:oi().editor.isMobile,hidden:!Gd,onClick:()=>e(null),"data-testid":"save-as-button"})}),yv=ce({name:"loadScene",label:"buttons.load",trackEvent:{category:"export"},predicate:(e,t,n,i)=>!!i.props.UIOptions.canvasActions.loadScene&&!t.viewModeEnabled,perform:async(e,t,n,i)=>{try{const{elements:s,appState:r,files:o}=await b5e(t,e);return{elements:s,appState:r,files:o,captureUpdate:K.IMMEDIATELY}}catch(s){return(s==null?void 0:s.name)==="AbortError"?(console.warn(s),!1):{elements:e,appState:{...t,errorMessage:s.message},files:i.files,captureUpdate:K.EVENTUALLY}}},keyTest:e=>e[H.CTRL_OR_CMD]&&e.key===H.O}),vye=ce({name:"exportWithDarkMode",label:"imageExportDialog.label.darkMode",trackEvent:{category:"export",action:"toggleTheme"},perform:(e,t,n)=>({appState:{...t,exportWithDarkMode:n},captureUpdate:K.EVENTUALLY}),PanelComponent:({appState:e,updateData:t})=>g("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"-45px",marginBottom:"10px"},children:g(k2e,{value:e.exportWithDarkMode?ke.DARK:ke.LIGHT,onChange:n=>{t(n===ke.DARK)},title:M("imageExportDialog.label.darkMode")})})});let gX="{}";const wye=ce({name:"copyStyles",label:"labels.copyStyles",icon:xV,trackEvent:{category:"element"},perform:(e,t,n,i)=>{const s=[],r=e.find(o=>t.selectedElementIds[o.id]);if(s.push(r),r&&Di(r)){const o=Re(r,i.scene.getNonDeletedElementsMap());s.push(o)}return r&&(gX=JSON.stringify(s)),{appState:{...t,toast:{message:M("toast.copyStyles")}},captureUpdate:K.EVENTUALLY}},keyTest:e=>e[H.CTRL_OR_CMD]&&e.altKey&&e.code===tt.C}),_ye=ce({name:"pasteStyles",label:"labels.pasteStyles",icon:xV,trackEvent:{category:"element"},perform:(e,t,n,i)=>{const s=JSON.parse(gX),r=s[0],o=s[1];if(!WB(r))return{elements:e,captureUpdate:K.EVENTUALLY};const a=Ve(e,t,{includeBoundTextElement:!0}),l=a.map(c=>c.id);return{elements:e.map(c=>{if(l.includes(c.id)){let u=r;if(de(c)&&c.containerId&&(u=o),!u)return c;let d=Te(c,{backgroundColor:u==null?void 0:u.backgroundColor,strokeWidth:u==null?void 0:u.strokeWidth,strokeColor:u==null?void 0:u.strokeColor,strokeStyle:u==null?void 0:u.strokeStyle,fillStyle:u==null?void 0:u.fillStyle,opacity:u==null?void 0:u.opacity,roughness:u==null?void 0:u.roughness,roundness:u.roundness?gae(u.roundness.type,c)?u.roundness:mae(c):null});if(de(d)){const f=u.fontSize||vl,h=u.fontFamily||tu;d=Te(d,{fontSize:f,fontFamily:h,textAlign:u.textAlign||up,lineHeight:u.lineHeight||Oc(h)});let m=null;d.containerId&&(m=a.find(p=>de(d)&&p.id===d.containerId)||null),qi(d,m,i.scene)}return d.type==="arrow"&&xe(u)&&(d=Te(d,{startArrowhead:u.startArrowhead,endArrowhead:u.endArrowhead})),Ee(c)&&(d=Te(d,{roundness:null,backgroundColor:"transparent"})),d}return c}),captureUpdate:K.IMMEDIATELY}},keyTest:e=>e[H.CTRL_OR_CMD]&&e.altKey&&e.code===tt.V}),RT=ce({name:"toggleShortcuts",label:"welcomeScreen.defaults.helpHint",icon:ade,viewMode:!0,trackEvent:{category:"menu",action:"toggleHelpDialog"},perform:(e,t,n,{focusContainer:i})=>{var s,r;return((s=t.openDialog)==null?void 0:s.name)==="help"&&i(),{appState:{...t,openDialog:((r=t.openDialog)==null?void 0:r.name)==="help"?null:{name:"help"},openMenu:null,openPopup:null},captureUpdate:K.EVENTUALLY}},keyTest:e=>e.key===H.QUESTION_MARK}),Tye=e=>{if(e.length>=2){const t=e[0].groupIds;for(const n of t)if(e.reduce((i,s)=>i&&cm(s,n),!0))return!0}return!1},DR=(e,t,n)=>{const i=n.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0});return i.length>=2&&!Tye(i)&&!xz(i)},Iye=ce({name:"group",label:"labels.group",icon:e=>g(QM,{theme:e.theme}),trackEvent:{category:"element"},perform:(e,t,n,i)=>{const s=h_(i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0}));if(s.length<2)return{appState:t,elements:e,captureUpdate:K.EVENTUALLY};const r=yc(t);if(r.length===1){const U=r[0],b=new Set(Ct(e,U).map(v=>v.id)),y=new Set(s.map(v=>v.id));if(new Set([...Array.from(b),...Array.from(y)]).size===b.size)return{appState:t,elements:e,captureUpdate:K.EVENTUALLY}}let o=[...e];new Set(s.map(U=>U.frameId)).size>1&&$le(s).forEach((b,y)=>{ey(b,i.scene.getNonDeletedElementsMap())});const l=fs(),c=ve(s);o=o.map(U=>c.get(U.id)?Te(U,{groupIds:Ple(U.groupIds,l,t.editingGroupId)}):U);const u=Ct(o,l),d=u[u.length-1],f=o.lastIndexOf(d),h=o.slice(f+1),m=o.slice(0,f).filter(U=>!cm(U,l)),p=oo([...m,...u,...h],ve(u));return{appState:{...t,...bz(l,{...t,selectedGroupIds:{}},jt(o))},elements:p,captureUpdate:K.IMMEDIATELY}},predicate:(e,t,n,i)=>DR(e,t,i),keyTest:e=>!e.shiftKey&&e[H.CTRL_OR_CMD]&&e.key===H.G,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g($e,{hidden:!DR(e,t,i),type:"button",icon:g(QM,{theme:t.theme}),onClick:()=>n(null),title:`${M("labels.group")}  ${J("CtrlOrCmd+G")}`,"aria-label":M("labels.group"),visible:Yn(jt(e),t)})}),Sye=ce({name:"ungroup",label:"labels.ungroup",icon:e=>g(JM,{theme:e.theme}),trackEvent:{category:"element"},perform:(e,t,n,i)=>{const s=yc(t),r=ve(e);if(s.length===0)return{appState:t,elements:e,captureUpdate:K.EVENTUALLY};let o=[...e];const a=[];o=o.map(f=>{zt(f)&&a.push(f.id);const h=Fle(f.groupIds,t.selectedGroupIds);return h.length===f.groupIds.length?f:Te(f,{groupIds:h})});const l=Ii(t,jt(o),t,null),c=i.scene.getSelectedElements(t),u=new Set(c.filter(f=>f.frameId).map(f=>f.frameId));return f_(e).filter(f=>u.has(f.id)).forEach(f=>{f&&(o=vg(o,Go(o,f,t,r),f,i))}),l.selectedElementIds=Object.entries(l.selectedElementIds).reduce((f,[h,m])=>(m&&!a.includes(h)&&(f[h]=!0),f),{}),{appState:{...t,...l},elements:o,captureUpdate:K.IMMEDIATELY}},keyTest:e=>e.shiftKey&&e[H.CTRL_OR_CMD]&&e.key===H.G.toUpperCase(),predicate:(e,t)=>yc(t).length>0,PanelComponent:({elements:e,appState:t,updateData:n})=>g($e,{type:"button",hidden:yc(t).length===0,icon:g(JM,{theme:t.theme}),onClick:()=>n(null),title:`${M("labels.ungroup")}  ${J("CtrlOrCmd+Shift+G")}`,"aria-label":M("labels.ungroup"),visible:Yn(jt(e),t)})}),mX=(e,t,n,i,s,r,o)=>{e.beginPath(),e.moveTo(t+r,n),e.lineTo(t+i-r,n),e.quadraticCurveTo(t+i,n,t+i,n+r),e.lineTo(t+i,n+s-r),e.quadraticCurveTo(t+i,n+s,t+i-r,n+s),e.lineTo(t+r,n+s),e.quadraticCurveTo(t,n+s,t,n+s-r),e.lineTo(t,n+r),e.quadraticCurveTo(t,n,t+r,n),e.closePath(),e.fill(),o&&(e.strokeStyle=o),e.stroke()};function xye(e){let t=0;if(e.length===0)return t;for(let n=0;n<e.length;n++){const i=e.charCodeAt(n);t=(t<<5)-t+i}return t}const Fy=(e,t)=>`hsl(${Math.abs(xye((t==null?void 0:t.id)||e))%37*10}, 100%, 83%)`,Cye=e=>{var n;const t=(n=e==null?void 0:e.trim())==null?void 0:n.codePointAt(0);return(t?String.fromCodePoint(t):"?").toUpperCase()},Aye=({context:e,renderConfig:t,appState:n,normalizedWidth:i,normalizedHeight:s})=>{for(const[r,o]of t.remotePointerViewportCoords){let{x:a,y:l}=o;const c=n.collaborators.get(r);a-=n.offsetLeft,l-=n.offsetTop;const u=11,d=14,f=a<0||a>i-u||l<0||l>s-d;a=Math.max(a,0),a=Math.min(a,i-u),l=Math.max(l,0),l=Math.min(l,s-d);const h=Fy(r,c);e.save(),e.strokeStyle=h,e.fillStyle=h;const m=t.remotePointerUserStates.get(r),p=f||m===Ru.IDLE||m===Ru.AWAY;p&&(e.globalAlpha=.3),t.remotePointerButton.get(r)==="down"&&(e.beginPath(),e.arc(a,l,15,0,2*Math.PI,!1),e.lineWidth=3,e.strokeStyle="#ffffff88",e.stroke(),e.closePath(),e.beginPath(),e.arc(a,l,15,0,2*Math.PI,!1),e.lineWidth=1,e.strokeStyle=h,e.stroke(),e.closePath());const U=n.theme===ke.DARK?"#2f6330":Ise,b=c==null?void 0:c.isSpeaking;b&&(e.fillStyle=U,e.strokeStyle=U,e.lineWidth=10,e.lineJoin="round",e.beginPath(),e.moveTo(a,l),e.lineTo(a+0,l+14),e.lineTo(a+4,l+9),e.lineTo(a+11,l+8),e.closePath(),e.stroke(),e.fill()),e.fillStyle=AU,e.strokeStyle=AU,e.lineWidth=6,e.lineJoin="round",e.beginPath(),e.moveTo(a,l),e.lineTo(a+0,l+14),e.lineTo(a+4,l+9),e.lineTo(a+11,l+8),e.closePath(),e.stroke(),e.fill(),e.fillStyle=h,e.strokeStyle=h,e.lineWidth=2,e.lineJoin="round",e.beginPath(),p?(e.moveTo(a-1,l-1),e.lineTo(a-1,l+15),e.lineTo(a+5,l+10),e.lineTo(a+12,l+9),e.closePath(),e.fill()):(e.moveTo(a,l),e.lineTo(a+0,l+14),e.lineTo(a+4,l+9),e.lineTo(a+11,l+8),e.closePath(),e.fill(),e.stroke());const y=t.remotePointerUsernames.get(r)||"";if(!f&&y){e.font="600 12px sans-serif";const w=(b?a+0:a)+u/2,v=(b?l+0:l)+d+2,I=5,C=3,_=e.measureText(y),T=_.actualBoundingBoxDescent+_.actualBoundingBoxAscent,k=Math.max(T,12),S=w-1,R=v-1,P=_.width+2+I*2+2,L=k+2+C*2+2;if(e.roundRect?(e.beginPath(),e.roundRect(S,R,P,L,8),e.fillStyle=h,e.fill(),e.strokeStyle=AU,e.stroke(),b&&(e.beginPath(),e.roundRect(S-2,R-2,P+4,L+4,8),e.strokeStyle=U,e.stroke())):mX(e,S,R,P,L,8,AU),e.fillStyle=Tse,e.fillText(y,w+I+1,v+C+_.actualBoundingBoxAscent+Math.floor((k-T)/2)+2),b){e.fillStyle=U;const X=8,G=8,z=5;e.fillRect(S+P+G,R+(L/2-X/2),2,X),e.fillRect(S+P+G+z,R+(L/2-X*2/2),2,X*2),e.fillRect(S+P+G+z*2,R+(L/2-X/2),2,X)}}e.restore(),e.closePath()}},LR=({color:e,onClick:t,name:n,src:i,className:s})=>{const r=Cye(n),[o,a]=D.useState(!1),l=!o&&i,c=l?void 0:{background:e};return g("div",{className:re("Avatar",s),style:c,onClick:t,children:l?g("img",{className:"Avatar-img",src:i,alt:r,referrerPolicy:"no-referrer",onError:()=>a(!0)}):r})};ce({name:"goToCollaborator",label:"Go to a collaborator",viewMode:!0,trackEvent:{category:"collab"},perform:(e,t,n)=>{var i;return!n.socketId||((i=t.userToFollow)==null?void 0:i.socketId)===n.socketId||n.isCurrentUser?{appState:{...t,userToFollow:null},captureUpdate:K.EVENTUALLY}:{appState:{...t,userToFollow:{socketId:n.socketId,username:n.username||""},openMenu:t.openMenu==="canvas"?null:t.openMenu},captureUpdate:K.EVENTUALLY}},PanelComponent:({updateData:e,data:t,appState:n})=>{const{socketId:i,collaborator:s,withName:r,isBeingFollowed:o}=t,a=Fy(i,s),l=re({"is-followed":o,"is-current-user":s.isCurrentUser===!0,"is-speaking":s.isSpeaking,"is-in-call":s.isInCall,"is-muted":s.isMuted}),c=s.isInCall?s.isSpeaking?N("div",{className:"UserList__collaborator-status-icon-speaking-indicator",title:M("userList.hint.isSpeaking"),children:[g("div",{}),g("div",{}),g("div",{})]}):s.isMuted?g("div",{className:"UserList__collaborator-status-icon-microphone-muted",title:M("userList.hint.micMuted"),children:Ufe}):g("div",{title:M("userList.hint.inCall"),children:pfe}):null;return r?N("div",{className:`dropdown-menu-item dropdown-menu-item-base UserList__collaborator ${l}`,style:{"--avatar-size":"1.5rem"},onClick:()=>e(s),children:[g(LR,{color:a,onClick:()=>{},name:s.username||"",src:s.avatarUrl,className:l}),g("div",{className:"UserList__collaborator-name",children:s.username}),N("div",{className:"UserList__collaborator-status-icons","aria-hidden":!0,children:[o&&g("div",{className:"UserList__collaborator-status-icon-is-followed",title:M("userList.hint.followStatus"),children:G_}),c]})]}):N("div",{className:`UserList__collaborator UserList__collaborator--avatar-only ${l}`,children:[g(LR,{color:a,onClick:()=>{e(s)},name:s.username||"",src:s.avatarUrl,className:l}),c&&g("div",{className:"UserList__collaborator-status-icon",children:c})]})}});const Mye=ce({name:"addToLibrary",trackEvent:{category:"element"},perform:(e,t,n,i)=>{const s=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0});for(const r of uB)if(s.some(o=>o.type===r))return{captureUpdate:K.EVENTUALLY,appState:{...t,errorMessage:M(`errors.libraryElementTypeError.${r}`)}};return i.library.getLatestLibrary().then(r=>i.library.setLibrary([{id:fs(),status:"unpublished",elements:s.map(zc),created:Date.now()},...r])).then(()=>({captureUpdate:K.EVENTUALLY,appState:{...t,toast:{message:M("toast.addedToLibrary")}}})).catch(r=>({captureUpdate:K.EVENTUALLY,appState:{...t,errorMessage:r.message}}))},label:"labels.addToLibrary"}),Cs=(e,t)=>{const n=t.scene.getSelectedElements(e);return Q5(n,t.scene.getNonDeletedElementsMap(),e).length>1&&!n.some(i=>Ee(i))},Mg=(e,t,n,i)=>{const s=n.scene.getSelectedElements(t),r=Uce(s,i,n.scene,t),o=ve(r);return Vh(e.map(a=>o.get(a.id)||a),t,n)};ce({name:"alignTop",label:"labels.alignTop",icon:jM,trackEvent:{category:"element"},predicate:(e,t,n,i)=>Cs(t,i),perform:(e,t,n,i)=>({appState:t,elements:Mg(e,t,i,{position:"start",axis:"y"}),captureUpdate:K.IMMEDIATELY}),keyTest:e=>e[H.CTRL_OR_CMD]&&e.shiftKey&&e.key===H.ARROW_UP,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g($e,{hidden:!Cs(t,i),type:"button",icon:jM,onClick:()=>n(null),title:`${M("labels.alignTop")}  ${J("CtrlOrCmd+Shift+Up")}`,"aria-label":M("labels.alignTop"),visible:Yn(jt(e),t)})});ce({name:"alignBottom",label:"labels.alignBottom",icon:YM,trackEvent:{category:"element"},predicate:(e,t,n,i)=>Cs(t,i),perform:(e,t,n,i)=>({appState:t,elements:Mg(e,t,i,{position:"end",axis:"y"}),captureUpdate:K.IMMEDIATELY}),keyTest:e=>e[H.CTRL_OR_CMD]&&e.shiftKey&&e.key===H.ARROW_DOWN,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g($e,{hidden:!Cs(t,i),type:"button",icon:YM,onClick:()=>n(null),title:`${M("labels.alignBottom")}  ${J("CtrlOrCmd+Shift+Down")}`,"aria-label":M("labels.alignBottom"),visible:Yn(jt(e),t)})});ce({name:"alignLeft",label:"labels.alignLeft",icon:WM,trackEvent:{category:"element"},predicate:(e,t,n,i)=>Cs(t,i),perform:(e,t,n,i)=>({appState:t,elements:Mg(e,t,i,{position:"start",axis:"x"}),captureUpdate:K.IMMEDIATELY}),keyTest:e=>e[H.CTRL_OR_CMD]&&e.shiftKey&&e.key===H.ARROW_LEFT,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g($e,{hidden:!Cs(t,i),type:"button",icon:WM,onClick:()=>n(null),title:`${M("labels.alignLeft")}  ${J("CtrlOrCmd+Shift+Left")}`,"aria-label":M("labels.alignLeft"),visible:Yn(jt(e),t)})});ce({name:"alignRight",label:"labels.alignRight",icon:KM,trackEvent:{category:"element"},predicate:(e,t,n,i)=>Cs(t,i),perform:(e,t,n,i)=>({appState:t,elements:Mg(e,t,i,{position:"end",axis:"x"}),captureUpdate:K.IMMEDIATELY}),keyTest:e=>e[H.CTRL_OR_CMD]&&e.shiftKey&&e.key===H.ARROW_RIGHT,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g($e,{hidden:!Cs(t,i),type:"button",icon:KM,onClick:()=>n(null),title:`${M("labels.alignRight")}  ${J("CtrlOrCmd+Shift+Right")}`,"aria-label":M("labels.alignRight"),visible:Yn(jt(e),t)})});ce({name:"alignVerticallyCentered",label:"labels.centerVertically",icon:ZM,trackEvent:{category:"element"},predicate:(e,t,n,i)=>Cs(t,i),perform:(e,t,n,i)=>({appState:t,elements:Mg(e,t,i,{position:"center",axis:"y"}),captureUpdate:K.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g($e,{hidden:!Cs(t,i),type:"button",icon:ZM,onClick:()=>n(null),title:M("labels.centerVertically"),"aria-label":M("labels.centerVertically"),visible:Yn(jt(e),t)})});ce({name:"alignHorizontallyCentered",label:"labels.centerHorizontally",icon:qM,trackEvent:{category:"element"},predicate:(e,t,n,i)=>Cs(t,i),perform:(e,t,n,i)=>({appState:t,elements:Mg(e,t,i,{position:"center",axis:"x"}),captureUpdate:K.IMMEDIATELY}),PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g($e,{hidden:!Cs(t,i),type:"button",icon:qM,onClick:()=>n(null),title:M("labels.centerHorizontally"),"aria-label":M("labels.centerHorizontally"),visible:Yn(jt(e),t)})});const pX=(e,t)=>{const n=t.scene.getSelectedElements(e);return Q5(n,t.scene.getNonDeletedElementsMap(),e).length>2&&!n.some(i=>Ee(i))},UX=(e,t,n,i)=>{const s=n.scene.getSelectedElements(t),r=Dce(s,n.scene.getNonDeletedElementsMap(),i,t),o=ve(r);return Vh(e.map(a=>o.get(a.id)||a),t,n)};ce({name:"distributeHorizontally",label:"labels.distributeHorizontally",trackEvent:{category:"element"},perform:(e,t,n,i)=>({appState:t,elements:UX(e,t,i,{axis:"x"}),captureUpdate:K.IMMEDIATELY}),keyTest:e=>!e[H.CTRL_OR_CMD]&&e.altKey&&e.code===tt.H,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g($e,{hidden:!pX(t,i),type:"button",icon:yde,onClick:()=>n(null),title:`${M("labels.distributeHorizontally")}  ${J("Alt+H")}`,"aria-label":M("labels.distributeHorizontally"),visible:Yn(jt(e),t)})});ce({name:"distributeVertically",label:"labels.distributeVertically",trackEvent:{category:"element"},perform:(e,t,n,i)=>({appState:t,elements:UX(e,t,i,{axis:"y"}),captureUpdate:K.IMMEDIATELY}),keyTest:e=>!e[H.CTRL_OR_CMD]&&e.altKey&&e.code===tt.V,PanelComponent:({elements:e,appState:t,updateData:n,app:i})=>g($e,{hidden:!pX(t,i),type:"button",icon:Ede,onClick:()=>n(null),title:`${M("labels.distributeVertically")}  ${J("Alt+V")}`,"aria-label":M("labels.distributeVertically"),visible:Yn(jt(e),t)})});const kye=ce({name:"flipHorizontal",label:"labels.flipHorizontal",icon:vfe,trackEvent:{category:"element"},perform:(e,t,n,i)=>({elements:Vh(bX(e,i.scene.getNonDeletedElementsMap(),t,"horizontal",i),t,i),appState:t,captureUpdate:K.IMMEDIATELY}),keyTest:e=>e.shiftKey&&e.code===tt.H}),Rye=ce({name:"flipVertical",label:"labels.flipVertical",icon:Efe,trackEvent:{category:"element"},perform:(e,t,n,i)=>({elements:Vh(bX(e,i.scene.getNonDeletedElementsMap(),t,"vertical",i),t,i),appState:t,captureUpdate:K.IMMEDIATELY}),keyTest:e=>e.shiftKey&&e.code===tt.V&&!e[H.CTRL_OR_CMD]}),bX=(e,t,n,i,s)=>{const r=Ve(jt(e),n,{includeBoundTextElement:!0,includeElementsInFrames:!0}),o=Dye(r,t,n,i,s),a=ve(o);return e.map(l=>a.get(l.id)||l)},Dye=(e,t,n,i,s)=>{if(e.every(h=>xe(h)&&(h.startBinding||h.endBinding)))return e.map(h=>{const m=h;return Te(m,{startArrowhead:m.endArrowhead,endArrowhead:m.startArrowhead})});const{midX:r,midY:o}=Sr(e);sH(e,t,"nw",s.scene,new Map(Array.from(t.values()).map(h=>[h.id,zc(h)])),{flipByX:i==="horizontal",flipByY:i==="vertical",shouldResizeFromCenter:!0,shouldMaintainAspectRatio:!0}),c6(e.filter(Se),qu(n),[],s.scene,n.zoom);const{elbowArrows:a,otherElements:l}=e.reduce((h,m)=>ge(m)?{...h,elbowArrows:h.elbowArrows.concat(m)}:{...h,otherElements:h.otherElements.concat(m)},{elbowArrows:[],otherElements:[]}),{midX:c,midY:u}=Sr(e),[d,f]=[r-c,o-u];return l.forEach(h=>s.scene.mutateElement(h,{x:h.x+d,y:h.y+f})),a.forEach(h=>s.scene.mutateElement(h,{x:h.x+d,y:h.y+f})),e},q2=ce({name:"copy",label:"labels.copy",icon:Z4,trackEvent:{category:"element"},perform:async(e,t,n,i)=>{const s=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0});try{await rye(s,i.files,n)}catch(r){return{captureUpdate:K.EVENTUALLY,appState:{...t,errorMessage:r.message}}}return{captureUpdate:K.EVENTUALLY}},keyTest:void 0}),NR=ce({name:"paste",label:"labels.paste",trackEvent:{category:"element"},perform:async(e,t,n,i)=>{let s;try{s=await lye()}catch(r){return r.name==="AbortError"||r.name==="NotAllowedError"?!1:(console.error(`actionPaste ${r.name}: ${r.message}`),im?{captureUpdate:K.EVENTUALLY,appState:{...t,errorMessage:M("hints.firefox_clipboard_write")}}:{captureUpdate:K.EVENTUALLY,appState:{...t,errorMessage:M("errors.asyncPasteFailedOnRead")}})}try{i.pasteFromClipboard(iye({types:s}))}catch(r){return console.error(r),{captureUpdate:K.EVENTUALLY,appState:{...t,errorMessage:M("errors.asyncPasteFailedOnParse")}}}return{captureUpdate:K.EVENTUALLY}},keyTest:void 0}),OR=ce({name:"cut",label:"labels.cut",icon:sfe,trackEvent:{category:"element"},perform:(e,t,n,i)=>(q2.perform(e,t,n,i),LV.perform(e,t,null,i)),keyTest:e=>e[H.CTRL_OR_CMD]&&e.key===H.X}),PR=ce({name:"copyAsSvg",label:"labels.copyAsSvg",icon:wfe,trackEvent:{category:"element"},perform:async(e,t,n,i)=>{if(!i.canvas)return{captureUpdate:K.EVENTUALLY};const{exportedElements:s,exportingFrame:r}=Oy(e,t,!0);try{await Py("clipboard-svg",s,t,i.files,{...t,exportingFrame:r,name:i.getName()});const o=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0});return{appState:{toast:{message:M("toast.copyToClipboardAsSvg",{exportSelection:o.length?M("toast.selection"):M("toast.canvas"),exportColorScheme:t.exportWithDarkMode?M("buttons.darkMode"):M("buttons.lightMode")})}},captureUpdate:K.EVENTUALLY}}catch(o){return console.error(o),{appState:{errorMessage:o.message},captureUpdate:K.EVENTUALLY}}},predicate:e=>MT&&e.length>0,keywords:["svg","clipboard","copy"]}),FR=ce({name:"copyAsPng",label:"labels.copyAsPng",icon:_fe,trackEvent:{category:"element"},perform:async(e,t,n,i)=>{if(!i.canvas)return{captureUpdate:K.EVENTUALLY};const s=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0}),{exportedElements:r,exportingFrame:o}=Oy(e,t,!0);try{return await Py("clipboard",r,t,i.files,{...t,exportingFrame:o,name:i.getName()}),{appState:{...t,toast:{message:M("toast.copyToClipboardAsPng",{exportSelection:s.length?M("toast.selection"):M("toast.canvas"),exportColorScheme:t.exportWithDarkMode?M("buttons.darkMode"):M("buttons.lightMode")})}},captureUpdate:K.EVENTUALLY}}catch(a){return console.error(a),{appState:{...t,errorMessage:a.message},captureUpdate:K.EVENTUALLY}}},predicate:e=>kT&&e.length>0,keyTest:e=>e.code===tt.C&&e.altKey&&e.shiftKey,keywords:["png","clipboard","copy"]}),BR=ce({name:"copyText",label:"labels.copyText",trackEvent:{category:"element"},perform:(e,t,n,i)=>{const s=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0});try{au(sz(s))}catch{throw new Error(M("errors.copyToSystemClipboardFailed"))}return{captureUpdate:K.EVENTUALLY}},predicate:(e,t,n,i)=>MT&&i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0}).some(de),keywords:["text","clipboard","copy"]}),zR=ce({name:"gridMode",icon:xfe,keywords:["snap"],label:"labels.toggleGrid",viewMode:!0,trackEvent:{category:"canvas",predicate:e=>e.gridModeEnabled},perform(e,t){return{appState:{...t,gridModeEnabled:!this.checked(t),objectsSnapModeEnabled:!1},captureUpdate:K.EVENTUALLY}},checked:e=>e.gridModeEnabled,predicate:(e,t,n)=>n.gridModeEnabled===void 0,keyTest:e=>e[H.CTRL_OR_CMD]&&e.code===tt.QUOTE}),Ev=ce({name:"zenMode",label:"buttons.zenMode",icon:Ife,viewMode:!0,trackEvent:{category:"canvas",predicate:e=>!e.zenModeEnabled},perform(e,t){return{appState:{...t,zenModeEnabled:!this.checked(t)},captureUpdate:K.EVENTUALLY}},checked:e=>e.zenModeEnabled,predicate:(e,t,n)=>typeof n.zenModeEnabled>"u",keyTest:e=>!e[H.CTRL_OR_CMD]&&e.altKey&&e.code===tt.Z}),Lye=ce({name:"objectsSnapMode",label:"buttons.objectsSnapMode",icon:Tfe,viewMode:!1,trackEvent:{category:"canvas",predicate:e=>!e.objectsSnapModeEnabled},perform(e,t){return{appState:{...t,objectsSnapModeEnabled:!this.checked(t),gridModeEnabled:!1},captureUpdate:K.EVENTUALLY}},checked:e=>e.objectsSnapModeEnabled,predicate:(e,t,n)=>typeof n.objectsSnapModeEnabled>"u",keyTest:e=>!e[H.CTRL_OR_CMD]&&e.altKey&&e.code===tt.S}),vv=ce({name:"stats",label:"stats.fullTitle",icon:yfe,viewMode:!0,trackEvent:{category:"menu"},keywords:["edit","attributes","customize"],perform(e,t){return{appState:{...t,stats:{...t.stats,open:!this.checked(t)}},captureUpdate:K.EVENTUALLY}},checked:e=>e.stats.open,keyTest:e=>!e[H.CTRL_OR_CMD]&&e.altKey&&e.code===tt.SLASH}),Nye=ce({name:"unbindText",label:"labels.unbindText",trackEvent:{category:"element"},predicate:(e,t,n,i)=>i.scene.getSelectedElements(t).some(r=>Di(r)),perform:(e,t,n,i)=>{const s=i.scene.getSelectedElements(t),r=i.scene.getNonDeletedElementsMap();return s.forEach(o=>{var l;const a=Re(o,r);if(a){const{width:c,height:u}=Xn(a.originalText,gt(a),a.lineHeight),d=pae(o.id);QB(o.id);const{x:f,y:h}=su(o,a,r);i.scene.mutateElement(a,{containerId:null,width:c,height:u,text:a.originalText,x:f,y:h}),i.scene.mutateElement(o,{boundElements:(l=o.boundElements)==null?void 0:l.filter(m=>m.id!==a.id),height:d||o.height})}}),{elements:e,appState:t,captureUpdate:K.IMMEDIATELY}}}),Oye=ce({name:"bindText",label:"labels.bindText",trackEvent:{category:"element"},predicate:(e,t,n,i)=>{const s=i.scene.getSelectedElements(t);if(s.length===2){const r=de(s[0])||de(s[1]);let o;if(Zu(s[0])?o=s[0]:Zu(s[1])&&(o=s[1]),r&&o&&Re(o,i.scene.getNonDeletedElementsMap())===null)return!0}return!1},perform:(e,t,n,i)=>{const s=i.scene.getSelectedElements(t);let r,o;de(s[0])&&Zu(s[1])?(r=s[0],o=s[1]):(r=s[1],o=s[0]),i.scene.mutateElement(r,{containerId:o.id,verticalAlign:Gs.MIDDLE,textAlign:rm.CENTER,autoResize:!0,angle:xe(o)?0:(o==null?void 0:o.angle)??0}),i.scene.mutateElement(o,{boundElements:(o.boundElements||[]).concat({type:"text",id:r.id})});const a=o.height;return qi(r,o,i.scene),r6(o.id,a),{elements:Pye(e,o,r),appState:{...t,selectedElementIds:{[o.id]:!0}},captureUpdate:K.IMMEDIATELY}}}),Pye=(e,t,n)=>{const i=e.slice(),s=i.findIndex(o=>o.id===n.id);i.splice(s,1);const r=i.findIndex(o=>o.id===t.id);return i.splice(r+1,0,n),oo(i,ve([t,n])),i},Fye=(e,t,n)=>{const i=e.slice(),s=i.findIndex(o=>o.id===t.id);i.splice(s,1);const r=i.findIndex(o=>o.id===n.id);return i.splice(r,0,t),oo(i,ve([t,n])),i},Bye=ce({name:"wrapTextInContainer",label:"labels.createContainerFromText",trackEvent:{category:"element"},predicate:(e,t,n,i)=>{const s=i.scene.getSelectedElements(t),r=s.some(o=>de(o));return s.length>0&&r},perform:(e,t,n,i)=>{var a;const s=i.scene.getSelectedElements(t);let r=e.slice();const o={};for(const l of s)if(de(l)){const c=ta({type:"rectangle",backgroundColor:t.currentItemBackgroundColor,boundElements:[...l.boundElements||[],{id:l.id,type:"text"}],angle:l.angle,fillStyle:t.currentItemFillStyle,strokeColor:t.currentItemStrokeColor,roughness:t.currentItemRoughness,strokeWidth:t.currentItemStrokeWidth,strokeStyle:t.currentItemStrokeStyle,roundness:t.currentItemRoundness==="round"?{type:Bd("rectangle")?yn.ADAPTIVE_RADIUS:yn.PROPORTIONAL_RADIUS}:null,opacity:100,locked:!1,x:l.x-Vn,y:l.y-Vn,width:gd(l.width,"rectangle"),height:gd(l.height,"rectangle"),groupIds:l.groupIds,frameId:l.frameId});if((a=l.boundElements)!=null&&a.length){const u=l.boundElements.filter(f=>f.type==="arrow").map(f=>f.id);r.filter(f=>u.includes(f.id)).forEach(f=>{let h=f.startBinding,m=f.endBinding;(h==null?void 0:h.elementId)===l.id&&(h={...h,elementId:c.id}),(m==null?void 0:m.elementId)===l.id&&(m={...m,elementId:c.id}),(h||m)&&i.scene.mutateElement(f,{startBinding:h,endBinding:m})})}i.scene.mutateElement(l,{containerId:c.id,verticalAlign:Gs.MIDDLE,boundElements:null,textAlign:rm.CENTER,autoResize:!0}),qi(l,c,i.scene),r=Fye([...r,c],c,l),o[c.id]=!0}return{elements:r,appState:{...t,selectedElementIds:o},captureUpdate:K.IMMEDIATELY}}}),DT=380,zye=42,wv=5,yX=85,Hye=500;let _v=!1;const qU=new Map,Vye=({element:e,scene:t,setAppState:n,onLinkOpen:i,setToast:s,updateEmbedValidationStatus:r})=>{const o=t.getNonDeletedElementsMap(),a=Op(),l=Np(),c=oi(),u=e.link||"",[d,f]=D.useState(u),h=D.useRef(null),m=a.showHyperlinkPopup==="editor",p=D.useCallback(()=>{var I;if(!h.current)return;const v=Qs(h.current.value)||null;if(!e.link&&v&&Qe("hyperlink","create"),rs(e)){if(((I=a.activeEmbeddable)==null?void 0:I.element)===e&&n({activeEmbeddable:null}),!v){t.mutateElement(e,{link:null}),r(e,!1);return}if(!O2(v,l.validateEmbeddable))v&&s({message:M("toast.unableToEmbed"),closable:!0}),e.link&&qU.set(e.id,e.link),t.mutateElement(e,{link:v}),r(e,!1);else{const{width:C,height:_}=e,T=jf(v);(T==null?void 0:T.error)instanceof URIError&&s({message:M("toast.unrecognizedLinkFormat"),closable:!0});const k=T?T.intrinsicSize.w/T.intrinsicSize.h:1,S=qU.get(e.id)!==e.link;t.mutateElement(e,{...S?{width:(T==null?void 0:T.type)==="video"?C>_?C:_*k:C,height:(T==null?void 0:T.type)==="video"&&C>_?C/k:_}:{},link:v}),r(e,!0),qU.has(e.id)&&qU.delete(e.id)}}else t.mutateElement(e,{link:v})},[e,t,s,l.validateEmbeddable,a.activeEmbeddable,n,r]);D.useLayoutEffect(()=>()=>{p()},[p]),D.useEffect(()=>{m&&(h!=null&&h.current)&&!(c.viewport.isMobile||c.isTouchScreen)&&h.current.select()},[m,c.viewport.isMobile,c.isTouchScreen]),D.useEffect(()=>{let v=null;const I=C=>{if(m)return;v&&clearTimeout(v),Xye(e,o,a,x(C.clientX,C.clientY))&&(v=window.setTimeout(()=>{n({showHyperlinkPopup:!1})},Hye))};return window.addEventListener(te.POINTER_MOVE,I,!1),()=>{window.removeEventListener(te.POINTER_MOVE,I,!1),v&&clearTimeout(v)}},[a,e,m,n,o]);const U=D.useCallback(()=>{Qe("hyperlink","delete"),t.mutateElement(e,{link:null}),n({showHyperlinkPopup:!1})},[n,e,t]),b=()=>{Qe("hyperlink","edit","popup-ui"),n({showHyperlinkPopup:"editor"})},{x:y,y:w}=EX(e,a,o);return a.contextMenu||a.selectedElementsAreBeingDragged||a.resizingElement||a.isRotating||a.openMenu||a.viewModeEnabled?null:N("div",{className:"excalidraw-hyperlinkContainer",style:{top:`${w}px`,left:`${y}px`,width:DT,padding:wv},children:[m?g("input",{className:re("excalidraw-hyperlinkContainer-input"),placeholder:M("labels.link.hint"),ref:h,value:d,onChange:v=>f(v.target.value),autoFocus:!0,onKeyDown:v=>{v.stopPropagation(),v[H.CTRL_OR_CMD]&&v.key===H.K&&v.preventDefault(),(v.key===H.ENTER||v.key===H.ESCAPE)&&(p(),n({showHyperlinkPopup:"info"}))}}):e.link?g("a",{href:Qs(e.link||""),className:"excalidraw-hyperlinkContainer-link",target:NB(e.link)?"_self":"_blank",onClick:v=>{if(e.link&&i){const I=AB(te.EXCALIDRAW_LINK,v.nativeEvent);i({...e,link:Qs(e.link)},I),I.defaultPrevented&&v.preventDefault()}},rel:"noopener noreferrer",children:e.link}):g("div",{className:"excalidraw-hyperlinkContainer-link",children:M("labels.link.empty")}),N("div",{className:"excalidraw-hyperlinkContainer__buttons",children:[!m&&g($e,{type:"button",title:M("buttons.edit"),"aria-label":M("buttons.edit"),label:M("buttons.edit"),onClick:b,className:"excalidraw-hyperlinkContainer--edit",icon:Sp}),g($e,{type:"button",title:M("labels.linkToElement"),"aria-label":M("labels.linkToElement"),label:M("labels.linkToElement"),onClick:()=>{n({openDialog:{name:"elementLinkSelector",sourceElementId:e.id}})},icon:kV}),u&&!rs(e)&&g($e,{type:"button",title:M("buttons.remove"),"aria-label":M("buttons.remove"),label:M("buttons.remove"),onClick:U,className:"excalidraw-hyperlinkContainer--remove",icon:Hc})]})]})},EX=(e,t,n)=>{const[i,s]=ze(e,n),{x:r,y:o}=Xs({sceneX:i+e.width/2,sceneY:s},t),a=r-t.offsetLeft-DT/2,l=o-t.offsetTop-yX;return{x:a,y:l}},HR=(e,t)=>{var s;const n=Ve(e,t);return rs(n[0])?"labels.link.editEmbed":(s=n[0])!=null&&s.link?"labels.link.edit":"labels.link.create"};let M0=null;const $ye=(e,t,n)=>{M0&&clearTimeout(M0),M0=window.setTimeout(()=>Gye(e,t,n),Dse)},Gye=(e,t,n)=>{if(!e.link)return;const i=I0();i.classList.add("excalidraw-tooltip--visible"),i.style.maxWidth="20rem",i.textContent=ch(e.link)?M("labels.link.goToElement"):e.link;const[s,r,o,a]=ze(e,n),[l,c,u,d]=IT([s,r,o,a],e.angle,t),f=Xs({sceneX:l,sceneY:c},t);j$(i,{left:f.x,top:f.y,width:u,height:d},"top"),Qe("hyperlink","tooltip","link-icon"),_v=!0},VR=()=>{M0&&clearTimeout(M0),_v&&(_v=!1,I0().classList.remove("excalidraw-tooltip--visible"))},Xye=(e,t,n,[i,s])=>{const{x:r,y:o}=Dt({clientX:i,clientY:s},n),a=15/n.zoom.value;if(Z5(x(r,o),e,t))return!1;const[l,c,u]=ze(e,t);if(r>=l&&r<=u&&o>=c-yX&&o<=c)return!1;const{x:d,y:f}=EX(e,n,t);return!(i>=d-a&&i<=d+DT+wv*2+a&&s>=f-a&&s<=f+a+wv*2+zye)},vX=ce({name:"hyperlink",label:(e,t)=>HR(e,t),icon:x6,perform:(e,t)=>t.showHyperlinkPopup==="editor"?!1:{elements:e,appState:{...t,showHyperlinkPopup:"editor",openMenu:null},captureUpdate:K.IMMEDIATELY},trackEvent:{category:"hyperlink",action:"click"},keyTest:e=>e[H.CTRL_OR_CMD]&&e.key===H.K,predicate:(e,t)=>Ve(e,t).length===1,PanelComponent:({elements:e,appState:t,updateData:n})=>{const i=Ve(e,t);return g($e,{type:"button",icon:x6,"aria-label":M(HR(e,t)),title:`${rs(e[0])?M("labels.link.labelEmbed"):M("labels.link.label")} - ${J("CtrlOrCmd+K")}`,onClick:()=>n(null),selected:i.length===1&&!!i[0].link})}}),b3=e=>e.every(t=>!t.locked),wX=ce({name:"toggleElementLock",label:(e,t,n)=>{const i=n.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!1});return b3(i)?"labels.elementLock.lock":"labels.elementLock.unlock"},icon:(e,t)=>{const n=Ve(t,e);return b3(n)?D_:ay},trackEvent:{category:"element"},predicate:(e,t,n,i)=>{const s=i.scene.getSelectedElements(t);return s.length>0&&!s.some(r=>r.locked&&r.frameId)},perform:(e,t,n,i)=>{const s=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0});if(!s.length)return!1;const r=b3(s),o=ve(s),a=s.length>1&&a_(s),c=s.length===1||a?null:fs();let u={...t.lockedMultiSelections};if(r)u={...t.lockedMultiSelections,...c?{[c]:!0}:{}};else if(a){const b=s[0].groupIds.at(-1);delete u[b]}const d=e.map(b=>{if(!o.has(b.id))return b;let y=b.groupIds;return r?c&&(y=[...y,c]):y=y.filter(w=>!t.lockedMultiSelections[w]),Te(b,{locked:r,groupIds:y.length!==b.groupIds.length?y:b.groupIds})}),f=ve(d),h=r?{}:Object.fromEntries(s.map(b=>[b.id,!0])),m=s.map(b=>f.get(b.id)||b),p=r?{}:_p(m,t),U=r?c||(a?s[0].groupIds.at(-1):s[0].id):null;return{elements:d,appState:{...t,selectedElementIds:h,selectedGroupIds:p,selectedLinearElement:r?null:t.selectedLinearElement,lockedMultiSelections:u,activeLockedId:U},captureUpdate:K.IMMEDIATELY}},keyTest:(e,t,n,i)=>e.key.toLocaleLowerCase()===H.L&&e[H.CTRL_OR_CMD]&&e.shiftKey&&i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!1}).length>0}),jye=ce({name:"unlockAllElements",trackEvent:{category:"canvas"},viewMode:!1,icon:ay,predicate:(e,t)=>Ve(e,t).length===0&&e.some(i=>i.locked),perform:(e,t)=>{const n=e.filter(o=>o.locked),i=e.map(o=>{if(o.locked){const a=o.groupIds.filter(l=>!t.lockedMultiSelections[l]);return Te(o,{locked:!1,groupIds:o.groupIds.length!==a.length?a:o.groupIds})}return o}),s=ve(i),r=n.map(o=>s.get(o.id)||o);return{elements:i,appState:{...t,selectedElementIds:Object.fromEntries(n.map(o=>[o.id,!0])),selectedGroupIds:_p(r,t),lockedMultiSelections:{},activeLockedId:null},captureUpdate:K.IMMEDIATELY}},label:"labels.elementLock.unlockAll"});var _X={exports:{}};(function(e,t){(function(){var n={};e.exports=n,n.simpleFilter=function(i,s){return s.filter(function(r){return n.test(i,r)})},n.test=function(i,s){return n.match(i,s)!==null},n.match=function(i,s,r){r=r||{};var o=0,a=[],l=s.length,c=0,u=0,d=r.pre||"",f=r.post||"",h=r.caseSensitive&&s||s.toLowerCase(),m;i=r.caseSensitive&&i||i.toLowerCase();for(var p=0;p<l;p++)m=s[p],h[p]===i[o]?(m=d+m+f,o+=1,u+=1+u):u=0,c+=u,a[a.length]=m;return o===i.length?(c=h===i?1/0:c,{rendered:a.join(""),score:c}):null},n.filter=function(i,s,r){return!s||s.length===0?[]:typeof i!="string"?s:(r=r||{},s.reduce(function(o,a,l,c){var u=a;r.extract&&(u=r.extract(a));var d=n.match(i,u,r);return d!=null&&(o[o.length]={string:d.rendered,score:d.score,index:l,original:a}),o},[]).sort(function(o,a){var l=a.score-o.score;return l||o.index-a.index}))}})()})(_X);var Yye=_X.exports;const Wye=bl(Yye),Kye=8,Zye=10,$1=["rectangle","diamond","ellipse"],G1=["line","sharpArrow","curvedArrow","elbowArrow"],qye=new Set($1),Qye=new Set(G1),Wh=e=>qye.has(e),G6=e=>e==="arrow"||Qye.has(e),Ia=Yt(null),Dm=new Map,Lm=new Map,Jye=({app:e})=>{const t=e.scene.getSelectedElements(e.state),n=D.useRef(null);return D.useEffect(()=>{if(t.length===0){e.updateEditorAtom(Ia,null);return}const i=By(t);i&&!n.current?n.current=i:(n.current&&!i||n.current&&i!==n.current)&&(e.updateEditorAtom(Ia,null),n.current=null)},[t,e]),D.useEffect(()=>()=>{Dm.clear(),Lm.clear()},[]),g(eEe,{app:e,elements:t})},eEe=({app:e,elements:t})=>{const n=By(t),i=D.useMemo(()=>n==="generic"?SX(t):[],[n,t]),s=D.useMemo(()=>n==="linear"?Iv(t):[],[n,t]),r=n==="generic"?i.every(d=>d.type===i[0].type):n==="linear"?s.every(d=>oh(d)===oh(s[0])):!1,[o,a]=D.useState({x:0,y:0}),l=D.useRef(""),c=D.useRef(null);D.useEffect(()=>{const d=[...i,...s].sort((U,b)=>U.id.localeCompare(b.id)),f=`
      ${e.state.scrollX}${e.state.scrollY}${e.state.offsetTop}${e.state.offsetLeft}${e.state.zoom.value}${d.map(U=>U.id).join(",")}`;if(f===l.current)return;l.current=f;let h;if(d.length===1){const[U,,,b,y,w]=ze(d[0],e.scene.getNonDeletedElementsMap());h=q(x(U,b),x(y,w),d[0].angle)}else{const{minX:U,maxY:b}=Sr(d);h=x(U,b)}const{x:m,y:p}=Xs({sceneX:h[0],sceneY:h[1]},e.state);a({x:m,y:p})},[i,s,e.scene,e.state]),D.useEffect(()=>{for(const d of s){const f=Tv(d.id,rEe(d));Lm.has(f)||Lm.set(f,d)}},[s]),D.useEffect(()=>{for(const d of i)if(!Dm.has(d.id)){const f=Re(d,e.scene.getNonDeletedElementsMap());f&&Dm.set(d.id,{fontSize:f.fontSize})}},[i,e.scene]);const u=n==="linear"?[["line",P_],["sharpArrow",j_],["curvedArrow",W_],["elbowArrow",Y_]]:n==="generic"?[["rectangle",L_],["diamond",N_],["ellipse",O_]]:[];return g("div",{ref:c,tabIndex:-1,style:{position:"absolute",top:`${o.y+(Zye+8)*e.state.zoom.value-e.state.offsetTop}px`,left:`${o.x-e.state.offsetLeft-Kye}px`,zIndex:2},className:Zs.CONVERT_ELEMENT_TYPE_POPUP,children:u.map(([d,f])=>{const h=r&&(n==="generic"&&i[0].type===d||n==="linear"&&oh(s[0])===d);return g($e,{className:"Shape",type:"radio",icon:f,checked:h,name:"convertElementType-option",title:d,keyBindingLabel:"","aria-label":d,"data-testid":`toolbar-${d}`,onChange:()=>{var m;e.state.activeTool.type!==d&&Qe("convertElementType",d,"ui"),TX(e,{conversionType:n,nextType:d}),(m=c.current)==null||m.focus()}},`${t[0].id}${t[0].version}_${d}`)})})},tEe=(e,t,n)=>{const i=Jo(e,t),s=vp(e,t),r=iu(t.text,gt(t),i);let o=Xn(r,gt(t),t.lineHeight),a=t.fontSize;for(;(o.width>i||o.height>s)&&a>0;){a-=1;const l={...t,fontSize:a};o=Xn(t.text,gt(l),t.lineHeight)}vi(t,n.getNonDeletedElementsMap(),{fontSize:a,width:o.width,height:o.height}),qi(t,e,n)},TX=(e,{conversionType:t,nextType:n,direction:i="right"})=>{var a;if(!t)return!1;const s=e.scene.getSelectedElements(e.state),r=s.reduce((l,c)=>({...l,[c.id]:!0}),{}),o=i==="right"?1:-1;if(t==="generic"){const l=SX(s),u=l.every(d=>d.type===l[0].type)?$1.indexOf(l[0].type):-1;if(n=n??$1[(u+$1.length+o)%$1.length],n&&Wh(n)){const d={};for(const h of l){const m=GR(h,n,e);d[m.id]=m}const f=[];for(const h of e.scene.getElementsIncludingDeleted())d[h.id]?f.push(d[h.id]):f.push(h);e.scene.replaceAllElements(f);for(const h of Object.values(d)){const m=Re(h,e.scene.getNonDeletedElementsMap());m&&(Dm.get(h.id)&&vi(m,e.scene.getNonDeletedElementsMap(),{fontSize:((a=Dm.get(h.id))==null?void 0:a.fontSize)??m.fontSize}),tEe(h,m,e.scene))}e.setState(h=>({selectedElementIds:r,activeTool:en(h,{type:"selection"})}))}}if(t==="linear"){const l=Iv(s);if(!n){const u=DB(l,oh),d=u?G1.indexOf(u):-1;n=G1[(d+G1.length+o)%G1.length]}if(G6(n)){const u=[],d=e.scene.getElementsMapIncludingDeleted();for(const f of l){const h=Lm.get(Tv(f.id,n));if(h&&oh(h)===n)d.set(h.id,h),u.push(h);else{const m=GR(f,n,e);d.set(m.id,m),u.push(m)}}e.scene.replaceAllElements(d);for(const f of u)if(Se(f))if(ge(f)){const h=nEe(f);if(h.length<2)continue;const m=[];for(let U=1;U<h.length-2;U++)m.push({start:h[U],end:h[U+1],index:U+1});const p=yg(f,e.scene.getNonDeletedElementsMap(),{points:h,fixedSegments:m});vi(f,e.scene.getNonDeletedElementsMap(),{...p,endArrowhead:"arrow"})}else{const h=Tre(["line","sharpArrow","curvedArrow"],m=>Lm.get(Tv(f.id,m)));if(h){const m=h.points;e.scene.mutateElement(f,{points:m})}}}const c=Iv(e.scene.getSelectedElements(e.state));e.setState(u=>({selectedElementIds:r,selectedLinearElement:c.length===1?new pe(c[0],e.scene.getNonDeletedElementsMap()):null,activeTool:en(u,{type:"selection"})}))}return!0},By=e=>{if(e.length===0)return null;let t=!1;for(const n of e){if(Wh(n.type))return"generic";IX(n)&&(t=!0)}return t?"linear":null},IX=e=>Se(e)&&(!xe(e)||!KB(e)&&!Di(e)),Tv=(e,t)=>`${e}:${t}`,SX=e=>e.filter(t=>Wh(t.type)),Iv=e=>e.filter(t=>IX(t)),QU=20,vf=(e,t)=>e[0]===t[0],y3=(e,t)=>e[1]===t[1],$R=(e,t)=>vf(e,t)?Math.abs(e[1]-t[1]):Math.abs(e[0]-t[0]),nEe=e=>{const t=[e.points[0]],n=iEe(e.points);for(let r=1;r<n.length;++r){const o=t[t.length-1],a=[...n[r]];Math.abs(a[0]-o[0])<QU?a[0]=o[0]:Math.abs(a[1]-o[1])<QU&&(a[1]=o[1]),vf(o,a)||y3(o,a)||t.push(x(o[0],a[1])),t.push(a)}const i=[t[0]];for(let r=1;r<t.length-1;++r)vf(t[r-1],t[r])&&vf(t[r],t[r+1])||y3(t[r-1],t[r])&&y3(t[r],t[r+1])||i.push(t[r]);i.push(t[t.length-1]);const s=[i[0]];for(let r=1;r<i.length-1;++r){const o=s[s.length-1],a=i[r],l=i[r+1],c=vf(o,a),u=vf(a,l);if(c!==u){const d=$R(o,a),f=$R(a,l);if(d<QU||f<QU){if(f<d)c?l[0]=o[0]:l[1]=o[1];else if(u)for(let h=s.length-1;h>=0&&s[h][0]===o[0];--h)s[h][0]=a[0];else for(let h=s.length-1;h>=0&&s[h][1]===o[1];--h)s[h][1]=a[1];continue}}s.push(a)}return s.push(i[i.length-1]),s},iEe=e=>{if(e.length===0)return[];const t=[e[0]];for(let n=1;n<e.length;n++){const[i,s]=t[t.length-1],[r,o]=e[n];(i!==r||s!==o)&&t.push(e[n])}return t},GR=(e,t,n)=>{if(!sEe(e.type,t)||e.type===t)return e;if(Zt.delete(e),Wh(t)){const i=Da(ta({...e,type:t,roundness:t==="diamond"&&e.roundness?{type:Bd(t)?yn.ADAPTIVE_RADIUS:yn.PROPORTIONAL_RADIUS}:e.roundness}));return lm(i,n.scene),i}if(G6(t))switch(t){case"line":return Da(Ec({...e,type:"line"}));case"sharpArrow":return Da(uh({...e,type:"arrow",elbowed:!1,roundness:null,startArrowhead:n.state.currentItemStartArrowhead,endArrowhead:n.state.currentItemEndArrowhead}));case"curvedArrow":return Da(uh({...e,type:"arrow",elbowed:!1,roundness:{type:yn.PROPORTIONAL_RADIUS},startArrowhead:n.state.currentItemStartArrowhead,endArrowhead:n.state.currentItemEndArrowhead}));case"elbowArrow":return Da(uh({...e,type:"arrow",elbowed:!0,fixedSegments:null,roundness:null}))}return Ko(t,`unhandled conversion type: ${t}`),e},sEe=(e,t)=>!!(Wh(e)&&Wh(t)||G6(e)&&G6(t)),rEe=e=>Se(e)?oh(e):e.type,oEe=ce({name:"toggleShapeSwitch",label:"labels.shapeSwitch",icon:()=>null,viewMode:!0,trackEvent:{category:"shape_switch",action:"toggle"},keywords:["change","switch","swap"],perform(e,t,n,i){return Hs.set(Ia,{type:"panel"}),{captureUpdate:K.NEVER}},checked:e=>e.gridModeEnabled,predicate:(e,t,n)=>By(e)!==null}),xX=ce({name:"copyElementLink",label:"labels.copyElementLink",icon:xp,trackEvent:{category:"element"},perform:async(e,t,n,i)=>{const s=Ve(e,t);try{if(window.location){const r=Kz(s,t);return r?(await au(i.props.generateLinkForSelection?i.props.generateLinkForSelection(r.id,r.type):Wz(r.id,r.type)),{appState:{toast:{message:M("toast.elementLinkCopied"),closable:!0}},captureUpdate:K.EVENTUALLY}):{appState:t,elements:e,app:i,captureUpdate:K.EVENTUALLY}}}catch(r){console.error(r)}return{appState:t,elements:e,app:i,captureUpdate:K.EVENTUALLY}},predicate:(e,t)=>T6(Ve(e,t))}),aEe=ce({name:"linkToElement",label:"labels.linkToElement",icon:kV,perform:(e,t,n,i)=>{const s=Ve(e,t);return s.length!==1||!T6(s)?{elements:e,appState:t,app:i,captureUpdate:K.EVENTUALLY}:{appState:{...t,openDialog:{name:"elementLinkSelector",sourceElementId:Ve(e,t)[0].id}},captureUpdate:K.IMMEDIATELY}},predicate:(e,t,n,i)=>{var r;const s=Ve(e,t);return((r=t.openDialog)==null?void 0:r.name)!=="elementLinkSelector"&&s.length===1&&T6(s)},trackEvent:!1}),lEe={toggleTheme:[J("Shift+Alt+D")],saveScene:[J("CtrlOrCmd+S")],loadScene:[J("CtrlOrCmd+O")],clearCanvas:[J("CtrlOrCmd+Delete")],imageExport:[J("CtrlOrCmd+Shift+E")],commandPalette:[J("CtrlOrCmd+/"),J("CtrlOrCmd+Shift+P")],cut:[J("CtrlOrCmd+X")],copy:[J("CtrlOrCmd+C")],paste:[J("CtrlOrCmd+V")],copyStyles:[J("CtrlOrCmd+Alt+C")],pasteStyles:[J("CtrlOrCmd+Alt+V")],selectAll:[J("CtrlOrCmd+A")],deleteSelectedElements:[J("Delete")],duplicateSelection:[J("CtrlOrCmd+D"),J(`Alt+${M("helpDialog.drag")}`)],sendBackward:[J("CtrlOrCmd+[")],bringForward:[J("CtrlOrCmd+]")],sendToBack:[J(so?"CtrlOrCmd+Alt+[":"CtrlOrCmd+Shift+[")],bringToFront:[J(so?"CtrlOrCmd+Alt+]":"CtrlOrCmd+Shift+]")],copyAsPng:[J("Shift+Alt+C")],group:[J("CtrlOrCmd+G")],ungroup:[J("CtrlOrCmd+Shift+G")],gridMode:[J("CtrlOrCmd+'")],zenMode:[J("Alt+Z")],objectsSnapMode:[J("Alt+S")],stats:[J("Alt+/")],addToLibrary:[],flipHorizontal:[J("Shift+H")],flipVertical:[J("Shift+V")],viewMode:[J("Alt+R")],hyperlink:[J("CtrlOrCmd+K")],toggleElementLock:[J("CtrlOrCmd+Shift+L")],resetZoom:[J("CtrlOrCmd+0")],zoomOut:[J("CtrlOrCmd+-")],zoomIn:[J("CtrlOrCmd++")],zoomToFitSelection:[J("Shift+3")],zoomToFit:[J("Shift+1")],zoomToFitSelectionInViewport:[J("Shift+2")],toggleEraserTool:[J("E")],toggleHandTool:[J("H")],setFrameAsActiveTool:[J("F")],saveFileToDisk:[J("CtrlOrCmd+S")],saveToActiveFile:[J("CtrlOrCmd+S")],toggleShortcuts:[J("?")],searchMenu:[J("CtrlOrCmd+F")],wrapSelectionInFrame:[]},Ki=(e,t=0)=>{const n=lEe[e];return n&&n.length>0?n[t]||n[0]:""},cEe="\\u0300-\\u036f",uEe="\\ufe20-\\ufe2f",dEe="\\u20d0-\\u20ff",fEe=cEe+uEe+dEe,hEe=`[${fEe}]`,gEe=RegExp(hEe,"g"),mEe=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,pEe={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"E",:"e",:"T",:"t",:"s",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"I",:"i",:"E",:"e",:"n",:"s"},k0=e=>e.replace(mEe,t=>pEe[t]||t).replace(gEe,""),CX=()=>{const[e,t]=D.useState(null),n=D.useCallback(i=>t(i),[]);return[e,n]};var zy={},UEe=bEe;function bEe(e,t){if(e=String(e),t=String(t),!/^[\x00-\xFF]+$/.test(e)||!/^[\x00-\xFF]+$/.test(t))throw new Error("Only Latin-1 characters are permitted in PNG tEXt chunks. You might want to consider base64 encoding and/or zEXt compression");if(e.length>=80)throw new Error('Keyword "'+e+'" is longer than the 79-character limit imposed by the PNG specification');for(var n=e.length+t.length+1,i=new Uint8Array(n),s=0,r,o=0;o<e.length;o++){if(!(r=e.charCodeAt(o)))throw new Error("0x00 character is not permitted in tEXt keywords");i[s++]=r}i[s++]=0;for(var a=0;a<t.length;a++){if(!(r=t.charCodeAt(a)))throw new Error("0x00 character is not permitted in tEXt content");i[s++]=r}return{name:"tEXt",data:i}}var yEe=EEe;function EEe(e){e.data&&e.name&&(e=e.data);for(var t=!0,n="",i="",s=0;s<e.length;s++){var r=e[s];if(t)r?i+=String.fromCharCode(r):t=!1;else if(r)n+=String.fromCharCode(r);else throw new Error("Invalid NULL character found. 0x00 character is not permitted in tEXt content")}return{keyword:i,text:n}}zy.encode=UEe;zy.decode=yEe;var vEe=function(e,t,n){var i=[],s=e.length;if(s===0)return i;var r=t<0?Math.max(0,t+s):t||0;for(n!==void 0&&(s=n<0?n+s:n);s-- >r;)i[s-r]=e[s];return i},LT={};(function(e){(function(t){t(typeof DO_NOT_EXPORT_CRC>"u"?e:{})})(function(t){t.version="0.3.0";function n(){for(var c=0,u=new Array(256),d=0;d!=256;++d)c=d,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,c=c&1?-306674912^c>>>1:c>>>1,u[d]=c;return typeof Int32Array<"u"?new Int32Array(u):u}var i=n(),s=typeof Buffer<"u";function r(c){if(c.length>32768&&s)return a(new Buffer(c));for(var u=-1,d=c.length-1,f=0;f<d;)u=i[(u^c.charCodeAt(f++))&255]^u>>>8,u=i[(u^c.charCodeAt(f++))&255]^u>>>8;return f===d&&(u=u>>>8^i[(u^c.charCodeAt(f))&255]),u^-1}function o(c){if(c.length>1e4)return a(c);for(var u=-1,d=0,f=c.length-3;d<f;)u=u>>>8^i[(u^c[d++])&255],u=u>>>8^i[(u^c[d++])&255],u=u>>>8^i[(u^c[d++])&255],u=u>>>8^i[(u^c[d++])&255];for(;d<f+3;)u=u>>>8^i[(u^c[d++])&255];return u^-1}function a(c){for(var u=-1,d=0,f=c.length-7;d<f;)u=u>>>8^i[(u^c[d++])&255],u=u>>>8^i[(u^c[d++])&255],u=u>>>8^i[(u^c[d++])&255],u=u>>>8^i[(u^c[d++])&255],u=u>>>8^i[(u^c[d++])&255],u=u>>>8^i[(u^c[d++])&255],u=u>>>8^i[(u^c[d++])&255],u=u>>>8^i[(u^c[d++])&255];for(;d<f+7;)u=u>>>8^i[(u^c[d++])&255];return u^-1}function l(c){for(var u=-1,d=0,f=c.length,h,m;d<f;)h=c.charCodeAt(d++),h<128?u=u>>>8^i[(u^h)&255]:h<2048?(u=u>>>8^i[(u^(192|h>>6&31))&255],u=u>>>8^i[(u^(128|h&63))&255]):h>=55296&&h<57344?(h=(h&1023)+64,m=c.charCodeAt(d++)&1023,u=u>>>8^i[(u^(240|h>>8&7))&255],u=u>>>8^i[(u^(128|h>>2&63))&255],u=u>>>8^i[(u^(128|m>>6&15|h&3))&255],u=u>>>8^i[(u^(128|m&63))&255]):(u=u>>>8^i[(u^(224|h>>12&15))&255],u=u>>>8^i[(u^(128|h>>6&63))&255],u=u>>>8^i[(u^(128|h&63))&255]);return u^-1}t.table=i,t.bstr=r,t.buf=o,t.str=l})})(LT);var wEe=vEe,_Ee=LT,TEe=xEe,To=new Uint8Array(4),IEe=new Int32Array(To.buffer),SEe=new Uint32Array(To.buffer);function xEe(e){var t=8,n=t,i;for(i=0;i<e.length;i++)t+=e[i].data.length,t+=12;var s=new Uint8Array(t);for(s[0]=137,s[1]=80,s[2]=78,s[3]=71,s[4]=13,s[5]=10,s[6]=26,s[7]=10,i=0;i<e.length;i++){var r=e[i],o=r.name,a=r.data,l=a.length,c=[o.charCodeAt(0),o.charCodeAt(1),o.charCodeAt(2),o.charCodeAt(3)];SEe[0]=l,s[n++]=To[3],s[n++]=To[2],s[n++]=To[1],s[n++]=To[0],s[n++]=c[0],s[n++]=c[1],s[n++]=c[2],s[n++]=c[3];for(var u=0;u<l;)s[n++]=a[u++];var d=c.concat(wEe(a)),f=_Ee.buf(d);IEe[0]=f,s[n++]=To[3],s[n++]=To[2],s[n++]=To[1],s[n++]=To[0]}return s}const CEe=bl(TEe);var AEe=LT,MEe=DEe,Io=new Uint8Array(4),kEe=new Int32Array(Io.buffer),REe=new Uint32Array(Io.buffer);function DEe(e){if(e[0]!==137)throw new Error("Invalid .png file header");if(e[1]!==80)throw new Error("Invalid .png file header");if(e[2]!==78)throw new Error("Invalid .png file header");if(e[3]!==71)throw new Error("Invalid .png file header");if(e[4]!==13)throw new Error("Invalid .png file header: possibly caused by DOS-Unix line ending conversion?");if(e[5]!==10)throw new Error("Invalid .png file header: possibly caused by DOS-Unix line ending conversion?");if(e[6]!==26)throw new Error("Invalid .png file header");if(e[7]!==10)throw new Error("Invalid .png file header: possibly caused by DOS-Unix line ending conversion?");for(var t=!1,n=[],i=8;i<e.length;){Io[3]=e[i++],Io[2]=e[i++],Io[1]=e[i++],Io[0]=e[i++];var s=REe[0]+4,r=new Uint8Array(s);r[0]=e[i++],r[1]=e[i++],r[2]=e[i++],r[3]=e[i++];var o=String.fromCharCode(r[0])+String.fromCharCode(r[1])+String.fromCharCode(r[2])+String.fromCharCode(r[3]);if(!n.length&&o!=="IHDR")throw new Error("IHDR header missing");if(o==="IEND"){t=!0,n.push({name:o,data:new Uint8Array(0)});break}for(var a=4;a<s;a++)r[a]=e[i++];Io[3]=e[i++],Io[2]=e[i++],Io[1]=e[i++],Io[0]=e[i++];var l=kEe[0],c=AEe.buf(r);if(c!==l)throw new Error("CRC values for "+o+" header do not match, PNG file is likely corrupted");var u=new Uint8Array(r.buffer.slice(4));n.push({name:o,data:u})}if(!t)throw new Error(".png file ended prematurely: no IEND header was found");return n}const AX=bl(MEe),MX=async e=>{const n=AX(new Uint8Array(await Dp(e))).find(i=>i.name==="tEXt");return n?zy.decode(n.data):null},kX=async({blob:e,metadata:t})=>{const n=AX(new Uint8Array(await Dp(e))),i=zy.encode(_e.excalidraw,JSON.stringify(FG({text:t,compress:!0})));return n.splice(-1,0,i),new Blob([CEe(n)],{type:_e.png})},LEe=async e=>{const t=await MX(e);if((t==null?void 0:t.keyword)===_e.excalidraw)try{const n=JSON.parse(t.text);if(!("encoded"in n)){if("type"in n&&n.type===Tr.excalidraw)return t.text;throw new Error("FAILED")}return BG(n)}catch(n){throw console.error(n),new Error("FAILED")}throw new Error("INVALID")},RX=Object.freeze(Object.defineProperty({__proto__:null,decodePngMetadata:LEe,encodePngMetadata:kX,getTEXtChunk:MX},Symbol.toStringTag,{value:"Module"})),Hy=({elements:e,appState:t,files:n,maxWidthOrHeight:i,getDimensions:s,exportPadding:r,exportingFrame:o})=>{const{elements:a,appState:l}=Td({elements:e,appState:t},null,null,{deleteInvisibleElements:!0}),{exportBackground:c,viewBackgroundColor:u}=l;return JG(a,{...l,offsetTop:0,offsetLeft:0,width:0,height:0},n||{},{exportBackground:c,exportPadding:r,viewBackgroundColor:u,exportingFrame:o},(d,f)=>{const h=document.createElement("canvas");if(i){typeof s=="function"&&console.warn("`getDimensions()` is ignored when `maxWidthOrHeight` is supplied.");const p=Math.max(d,f),U=i<p?i/p:(t==null?void 0:t.exportScale)??1;return h.width=d*U,h.height=f*U,{canvas:h,scale:U}}const m=(s==null?void 0:s(d,f))||{width:d,height:f};return h.width=m.width,h.height=m.height,{canvas:h,scale:m.scale??1}})},NEe=async e=>{var s;let{mimeType:t=_e.png,quality:n}=e;t===_e.png&&typeof n=="number"&&console.warn(`"quality" will be ignored for "${_e.png}" mimeType`),t==="image/jpg"&&(t=_e.jpg),t===_e.jpg&&!((s=e.appState)!=null&&s.exportBackground)&&(console.warn(`Defaulting "exportBackground" to "true" for "${_e.jpg}" mimeType`),e={...e,appState:{...e.appState,exportBackground:!0}});const i=await Hy(e);return n=n||(/image\/jpe?g/.test(t)?.92:.8),new Promise((r,o)=>{i.toBlob(async a=>{var l;if(!a)return o(new Error("couldn't export to blob"));a&&t===_e.png&&((l=e.appState)!=null&&l.exportEmbedScene)&&(a=await kX({blob:a,metadata:Ag(e.elements,e.appState,e.files||{},"local")})),r(a)},t,n)})},DX=async({elements:e,appState:t=ia(),files:n={},exportPadding:i,renderEmbeddables:s,exportingFrame:r,skipInliningFonts:o,reuseImages:a})=>{const{elements:l,appState:c}=Td({elements:e,appState:t},null,null,{deleteInvisibleElements:!0}),u={...c,exportPadding:i};return ST(l,u,n,{exportingFrame:r,renderEmbeddables:s,skipInliningFonts:o,reuseImages:a})},LX=Yt(new Map),XR=async e=>await DX({elements:e,appState:{exportBackground:!1,viewBackgroundColor:Ge.white},files:null,renderEmbeddables:!1,skipInliningFonts:!0}),NX=(e,t,n,i)=>{const[s,r]=D.useState();return D.useEffect(()=>{if(t)if(e){const o=n.get(e);o?r(o):(async()=>{var l;const a=await XR(t);(l=a.querySelector(".style-fonts"))==null||l.remove(),a&&(n.set(e,a),r(a))})()}else(async()=>{const o=await XR(t);r(o)})()},[e,t,n,r]),D.useEffect(()=>{const o=i.current;if(o)return s&&(o.innerHTML=s.outerHTML),()=>{o.innerHTML=""}},[s,i]),s},NT=()=>{const[e]=un(LX);return{clearLibraryCache:()=>e.clear(),deleteItemsFromLibraryCache:i=>{i.forEach(s=>e.delete(s))},svgCache:e}},OEe=["excalidraw.com","raw.githubusercontent.com/excalidraw/excalidraw-libraries"],OX=new $r,Kh=Yt({status:"loaded",isInitialized:!1,libraryItems:[]}),p1=e=>Wa(e),PEe=(e,t)=>!e.find(n=>n.elements.length!==t.elements.length?!1:n.elements.every((i,s)=>i.id===t.elements[s].id&&i.versionNonce===t.elements[s].versionNonce)),FEe=(e,t)=>{const n=[];for(const i of t)PEe(e,i)&&n.push(i);return[...n,...e]},PX=(e,t)=>{const n=ve(t),i={deletedItems:new Map,addedItems:new Map,updatedItems:new Map};for(const r of e)n.has(r.id)||i.deletedItems.set(r.id,r);const s=ve(e);for(const r of t){const o=s.get(r.id);o?xv(o)!==xv(r)&&i.updatedItems.set(r.id,r):i.addedItems.set(r.id,r)}return i};class BEe{constructor(t){this.currLibraryItems=[],this.prevLibraryItems=p1(this.currLibraryItems),this.updateQueue=[],this.getLastUpdateTask=()=>this.updateQueue[this.updateQueue.length-1],this.notifyListeners=()=>{var n,i;if(this.updateQueue.length>0)Hs.set(Kh,s=>({status:"loading",libraryItems:this.currLibraryItems,isInitialized:s.isInitialized}));else{Hs.set(Kh,{status:"loaded",libraryItems:this.currLibraryItems,isInitialized:!0});try{const s=this.prevLibraryItems;this.prevLibraryItems=p1(this.currLibraryItems);const r=p1(this.currLibraryItems);(i=(n=this.app.props).onLibraryChange)==null||i.call(n,r),OX.trigger(PX(s,r),r)}catch(s){console.error(s)}}},this.destroy=()=>{this.updateQueue=[],this.currLibraryItems=[],Hs.set(LX,new Map)},this.resetLibrary=()=>this.setLibrary([]),this.getLatestLibrary=()=>new Promise(async n=>{try{const i=await(this.getLastUpdateTask()||this.currLibraryItems);this.updateQueue.length>0?n(this.getLatestLibrary()):n(p1(i))}catch{return n(this.currLibraryItems)}}),this.updateLibrary=async({libraryItems:n,prompt:i=!1,merge:s=!1,openLibraryMenu:r=!1,defaultStatus:o="unpublished"})=>(r&&this.app.setState({openSidebar:{name:Ir.name,tab:$b}}),this.setLibrary(()=>new Promise(async(a,l)=>{try{const c=await(typeof n=="function"&&!(n instanceof Blob)?n(this.currLibraryItems):n);let u;c instanceof Blob?u=await H5e(c,o):u=Ny(c,o),!i||window.confirm(M("alerts.confirmAddLibrary",{numShapes:u.length}))?(i&&this.app.focusContainer(),a(s?FEe(this.currLibraryItems,u):u)):l(new Gh)}catch(c){l(c)}}))),this.setLibrary=n=>{const i=new Promise(async(s,r)=>{try{await this.getLastUpdateTask(),typeof n=="function"&&(n=n(this.currLibraryItems)),this.currLibraryItems=p1(await n),s(this.currLibraryItems)}catch(o){r(o)}}).catch(s=>{if(s.name==="AbortError")return console.warn("Library update aborted by user"),this.currLibraryItems;throw s}).finally(()=>{this.updateQueue=this.updateQueue.filter(s=>s!==i),this.notifyListeners()});return this.updateQueue.push(i),this.notifyListeners(),i},this.app=t}}const OT=e=>{const n=Math.ceil(Math.sqrt(e.length)),i=[],s=h=>e.slice(h*n,h*n+n).reduce((p,U)=>{const{height:b}=Sr(U.elements);return Math.max(p,b)},0),r=h=>{let m=0,p=0,U=0;for(const b of e){if(m%n===0&&(p=0),p===h){const{width:y}=Sr(b.elements);U=Math.max(U,y)}m++,p++}return U};let o=0,a=0,l=0,c=0,u=0,d=0,f=0;for(const h of e){u&&u%n===0&&(a+=l+50,o=0,d=0,f++),d===0&&(l=s(f)),c=r(d);const{minX:m,minY:p,width:U,height:b}=Sr(h.elements),y=(c-U)/2,w=(l-b)/2;i.push(...h.elements.map(v=>({...v,x:v.x+o+y-m,y:v.y+a+w-p}))),o+=c+50,u++,d++}return i},zEe=(e,t=OEe)=>{if(typeof t=="function"?t(e):t.some(n=>{const i=new URL(`https://${n.replace(/^https?:\/\//,"")}`),{hostname:s,pathname:r}=new URL(e);return new RegExp(`(^|\\.)${i.hostname}$`).test(s)&&new RegExp(`^${i.pathname.replace(/\/+$/,"")}(/+|$)`).test(r)}))return!0;throw new Error(`Invalid or disallowed library URL: "${e}"`)},Sv=()=>{const e=new URLSearchParams(window.location.hash.slice(1)).get(f4.addLibrary)||new URLSearchParams(window.location.search).get(d4.addLibrary),t=e?new URLSearchParams(window.location.hash.slice(1)).get("token"):null;return e?{libraryUrl:e,idToken:t}:null},Yl=class Yl{static async getLibraryItems(t,n,i=!0){const s=()=>new Promise(async(r,o)=>{try{const a=await t.load({source:n});r(Ny((a==null?void 0:a.libraryItems)||[],"published"))}catch(a){o(a)}});return i?Yl.queue.push(s):s()}constructor(t){this.adapter=t}getLibraryItems(t){return Yl.getLibraryItems(this.adapter,t,!1)}};Yl.queue=new Yse,Yl.run=async(t,n)=>{const i=new Yl(t);return Yl.queue.push(()=>n(i))};let bh=Yl,R0=0,X6=0;const xv=e=>`${e.id}:${e.name||""}:${gH(e.elements)}`,Cv=e=>C_(e.map(t=>xv(t)).sort().join()),jR=async(e,t)=>{try{return X6++,await bh.run(e,async n=>{const i=ve(await n.getLibraryItems("save"));for(const[a]of t.deletedItems)i.delete(a);const s=[];for(const[a,l]of t.addedItems)i.has(a)?i.set(a,l):s.push(l);if(t.updatedItems)for(const[a,l]of t.updatedItems)i.set(a,l);const r=s.concat(Array.from(i.values())),o=Cv(r);return o!==R0&&await e.save({libraryItems:r}),R0=o,r})}finally{X6--}},HEe=e=>{const{excalidrawAPI:t}=e,n=D.useRef(e);n.current=e;const i=D.useRef(!1);D.useEffect(()=>{if(!t)return;i.current=!1;const s=async({libraryUrl:a,idToken:l})=>{const c=new Promise(async(d,f)=>{try{a=decodeURIComponent(a),a=z9(a),zEe(a,n.current.validateLibraryUrl);const m=await(await fetch(a)).blob();d(m)}catch(h){f(h)}}),u=l!==t.id;await(u&&document.hidden?new Promise(d=>{window.addEventListener("focus",()=>d(),{once:!0})}):null);try{await t.updateLibrary({libraryItems:c,prompt:u,merge:!0,defaultStatus:"published",openLibraryMenu:!0})}catch(d){throw t.updateScene({appState:{errorMessage:d.message}}),d}finally{if(window.location.hash.includes(f4.addLibrary)){const d=new URLSearchParams(window.location.hash.slice(1));d.delete(f4.addLibrary),window.history.replaceState({},bc,`#${d.toString()}`)}else if(window.location.search.includes(d4.addLibrary)){const d=new URLSearchParams(window.location.search);d.delete(d4.addLibrary),window.history.replaceState({},bc,`?${d.toString()}`)}}},r=a=>{a.preventDefault();const l=Sv();l&&(a.stopImmediatePropagation(),window.history.replaceState({},"",a.oldURL),s(l))},o=Sv();if(o&&s(o),"getInitialLibraryItems"in n.current&&n.current.getInitialLibraryItems&&(console.warn("useHandleLibrar `opts.getInitialLibraryItems` is deprecated. Use `opts.adapter` instead."),Promise.resolve(n.current.getInitialLibraryItems()).then(a=>{t.updateLibrary({libraryItems:a,merge:!0})}).catch(a=>{console.error(`UseHandeLibrary getInitialLibraryItems failed: ${a==null?void 0:a.message}`)})),"adapter"in n.current&&n.current.adapter){const a=n.current.adapter,l=n.current.migrationAdapter,c=j5();l?c.resolve(Pc(l.load).then(async u=>{let d=null;try{if(!u)return bh.getLibraryItems(a,"load");d=Ny(u.libraryItems||[],"published");const f=await jR(a,PX([],d));try{await l.clear()}catch(h){console.error(`couldn't delete legacy library data: ${h.message}`)}return f}catch(f){return console.error(`couldn't migrate legacy library data: ${f.message}`),d}}).catch(u=>(console.error(`error during library migration: ${u.message}`),bh.getLibraryItems(a,"load")))):c.resolve(Pc(bh.getLibraryItems,a,"load")),t.updateLibrary({libraryItems:c.then(u=>{const d=u||[];return R0=Cv(d),d}),merge:!0}).finally(()=>{i.current=!0})}return window.addEventListener(te.HASHCHANGE,r),()=>{window.removeEventListener(te.HASHCHANGE,r)}},[t]),D.useEffect(()=>{const s=OX.on(async(o,a)=>{const l=i.current,c="adapter"in n.current&&n.current.adapter||null;try{c&&R0!==Cv(a)&&await jR(c,o)}catch(u){console.error(`couldn't persist library update: ${u.message}`,o),l&&n.current.excalidrawAPI&&n.current.excalidrawAPI.updateScene({appState:{errorMessage:M("errors.saveLibraryError")}})}}),r=o=>{X6&&P9(o)};return window.addEventListener(te.BEFORE_UNLOAD,r),()=>{window.removeEventListener(te.BEFORE_UNLOAD,r),s(),R0=0,X6=0}},[])},VEe=({theme:e,id:t,libraryReturnUrl:n})=>{const i=n||window.location.origin+window.location.pathname;return g("a",{className:"library-menu-browse-button",href:`https://libraries.excalidraw.com?target=${window.name||"_blank"}&referrer=${i}&useHash=true&token=${t}&theme=${e}&version=${$5.excalidrawLibrary}`,target:"_excalidraw_libraries",children:M("labels.libraries")})},FX=({libraryReturnUrl:e,theme:t,id:n,style:i,children:s,className:r})=>N("div",{className:re("library-menu-control-buttons",r),style:i,children:[g(VEe,{id:n,libraryReturnUrl:e,theme:t}),s]}),$Ee=Yt(0),GEe=e=>{const[t,n]=un($Ee);return D.useEffect(()=>{const{current:i}=e;if(!i)return;const s=Oo(()=>{const{scrollTop:r}=i;n(r)},200);return i.addEventListener("scroll",s),()=>{s.cancel(),i.removeEventListener("scroll",s)}},[e,n]),t},Zh=({label:e,onClick:t,className:n,children:i,actionType:s,type:r="button",isLoading:o,...a})=>{const l=s?`Dialog__action-button--${s}`:"";return N("button",{className:re("Dialog__action-button",l,n),type:r,"aria-label":e,onClick:t,...a,children:[i&&g("div",{style:o?{visibility:"hidden"}:{},children:i}),g("div",{style:o?{visibility:"hidden"}:{},children:e}),o&&g("div",{style:{position:"absolute",inset:0},children:g(cl,{})})]})},BX=e=>{const{onConfirm:t,onCancel:n,children:i,confirmText:s=M("buttons.confirm"),cancelText:r=M("buttons.cancel"),className:o="",...a}=e,l=xn(),c=ry(PT),{container:u}=Lr();return N(ir,{onCloseRequest:n,size:"small",...a,className:`confirm-dialog ${o}`,children:[i,N("div",{className:"confirm-dialog-buttons",children:[g(Zh,{label:r,onClick:()=>{l({openMenu:null}),c(!1),hi.flushSync(()=>{n()}),u==null||u.focus()}}),g(Zh,{label:s,onClick:()=>{l({openMenu:null}),c(!1),hi.flushSync(()=>{t()}),u==null||u.focus()},actionType:"danger"})]})]})};class Ju{static has(t){try{return!!window.localStorage.getItem(t)}catch(n){return console.warn(`localStorage.getItem error: ${n.message}`),!1}}static get(t){try{const n=window.localStorage.getItem(t);return n?JSON.parse(n):null}catch(n){return console.warn(`localStorage.getItem error: ${n.message}`),null}}}F(Ju,"set",(t,n)=>{try{return window.localStorage.setItem(t,JSON.stringify(n)),!0}catch(i){return console.warn(`localStorage.setItem error: ${i.message}`),!1}}),F(Ju,"delete",t=>{try{window.localStorage.removeItem(t)}catch(n){console.warn(`localStorage.removeItem error: ${n.message}`)}});const XEe=/({{[\w-]+}})|(<[\w-]+>)|(<\/[\w-]+>)/g,jEe=/{{([\w-]+)}}/,YEe=/<([\w-]+)>/,WEe=/<\/([\w-]+)>/,KEe=(e,t)=>{const n=[{name:"",children:[]}];return e.split(XEe).filter(Boolean).forEach(i=>{const s=i.match(YEe),r=i.match(WEe),o=i.match(jEe);if(s!==null){const a=s[1];t.hasOwnProperty(a)?n.push({name:a,children:[]}):console.warn(`Trans: missed to pass in prop ${a} for interpolating ${e}`)}else if(r!==null)if(r[1]===n[n.length-1].name){const l=n.pop(),c=ae.createElement(ae.Fragment,{},...l.children),u=t[l.name];typeof u=="function"&&n[n.length-1].children.push(u(c))}else console.warn(`Trans: unexpected end tag ${i} for interpolating ${e}`);else if(o!==null){const a=o[1];t.hasOwnProperty(a)?n[n.length-1].children.push(t[a]):console.warn(`Trans: key ${a} not in props for interpolating ${e}`)}else n[n.length-1].children.push(i)}),n.length!==1&&console.warn(`Trans: stack not empty for interpolating ${e}`),n[0].children},Ts=({i18nKey:e,children:t,...n})=>{const{t:i}=dn();return ae.createElement(ae.Fragment,{},...KEe(i(e),n))},ZEe=async e=>{const i=Math.round(8),s=Math.max(Math.round(128/64),2),r=Ere(e,6),o=document.createElement("canvas");o.width=r[0].length*128+(r[0].length+1)*(i*2)-i*2,o.height=r.length*128+(r.length+1)*(i*2)-i*2;const a=o.getContext("2d");a.fillStyle=Ui.white,a.fillRect(0,0,o.width,o.height);for(const[l,c]of e.entries()){const u=await Hy({elements:c.elements,files:null,maxWidthOrHeight:128}),{width:d,height:f}=u,h=Math.floor(l/6)*(128+i*2),m=l%6*(128+i*2);a.drawImage(u,m+(128-d)/2+i,h+(128-f)/2+i),a.lineWidth=s,a.strokeStyle=Ui.gray[4],a.strokeRect(m+i/2,h+i/2,128+i,128+i)}return await aX(new File([await Mm(o)],"preview",{type:_e.png}),{outputType:_e.jpg,maxWidthOrHeight:5e3})},qEe=({libItem:e,appState:t,index:n,onChange:i,onRemove:s})=>{const r=D.useRef(null),o=D.useRef(null);return D.useEffect(()=>{const a=r.current;a&&(async()=>{const l=await DX({elements:e.elements,appState:{...t,viewBackgroundColor:Ui.white,exportBackground:!0},files:null,skipInliningFonts:!0});a.innerHTML=l.outerHTML})()},[e.elements,t]),N("div",{className:"single-library-item",children:[e.status==="published"&&g("span",{className:"single-library-item-status",children:M("labels.statusPublished")}),g("div",{ref:r,className:"single-library-item__svg"}),g($e,{"aria-label":M("buttons.remove"),type:"button",icon:Vd,className:"single-library-item--remove",onClick:s.bind(null,e.id),title:M("buttons.remove")}),N("div",{style:{display:"flex",margin:"0.8rem 0",width:"100%",fontSize:"14px",fontWeight:500,flexDirection:"column"},children:[N("label",{style:{display:"flex",justifyContent:"space-between",flexDirection:"column"},children:[N("div",{style:{padding:"0.5em 0"},children:[g("span",{style:{fontWeight:500,color:Ui.gray[6]},children:M("publishDialog.itemName")}),g("span",{"aria-hidden":"true",className:"required",children:"*"})]}),g("input",{type:"text",ref:o,style:{width:"80%",padding:"0.2rem"},defaultValue:e.name,placeholder:"Item name",onChange:a=>{i(a.target.value,n)}})]}),g("span",{className:"error",children:e.error})]})]})},QEe=({onClose:e,libraryItems:t,appState:n,onSuccess:i,onError:s,updateItemsInStorage:r,onRemove:o})=>{const[a,l]=D.useState({authorName:"",githubHandle:"",name:"",description:"",twitterHandle:"",website:""}),[c,u]=D.useState(!1);D.useEffect(()=>{const w=Ju.get(h0.PUBLISH_LIBRARY);w&&l(w)},[]);const[d,f]=D.useState(t.slice());D.useEffect(()=>{f(t.slice())},[t]);const h=w=>{l({...a,[w.target.name]:w.target.value})},m=async w=>{w.preventDefault(),u(!0);const v=[];let I=!1;if(d.forEach(R=>{let P="";R.name||(P=M("publishDialog.errors.required"),I=!0),v.push({...R,error:P})}),I){f(v),u(!1);return}const C=await ZEe(d),_={type:Tr.excalidrawLibrary,version:$5.excalidrawLibrary,source:x9(),libraryItems:d},T=JSON.stringify(_,null,2),k=new Blob([T],{type:"application/json"}),S=new FormData;S.append("excalidrawLib",k),S.append("previewImage",C),S.append("previewImageType",C.type),S.append("title",a.name),S.append("authorName",a.authorName),S.append("githubHandle",a.githubHandle),S.append("name",a.name),S.append("description",a.description),S.append("twitterHandle",a.twitterHandle),S.append("website",a.website),fetch("https://us-central1-excalidraw-room-persistence.cloudfunctions.net/libraries/submit",{method:"post",body:S}).then(R=>R.ok?R.json().then(({url:P})=>{Ju.delete(h0.PUBLISH_LIBRARY),i({url:P,authorName:a.authorName,items:d})}):R.json().catch(()=>{throw new Error(R.statusText||"something went wrong")}).then(P=>{throw new Error(P.message||R.statusText||"something went wrong")}),R=>{console.error(R),s(R),u(!1)}).catch(R=>{console.error(R),s(R),u(!1)})},p=()=>{const w=[];return d.forEach((v,I)=>{w.push(g("div",{className:"single-library-item-wrapper",children:g(qEe,{libItem:v,appState:n,index:I,onChange:(C,_)=>{const T=d.slice();T[_].name=C,f(T)},onRemove:o})},I))}),g("div",{className:"selected-library-items",children:w})},U=D.useCallback(()=>{r(d),Ju.set(h0.PUBLISH_LIBRARY,a),e()},[d,e,r,a]),b=!!t.length,y=t.some(w=>w.status==="published");return g(ir,{onCloseRequest:U,title:M("publishDialog.title"),className:"publish-library",children:b?N("form",{onSubmit:m,children:[g("div",{className:"publish-library-note",children:g(Ts,{i18nKey:"publishDialog.noteDescription",link:w=>g("a",{href:"https://libraries.excalidraw.com",target:"_blank",rel:"noopener",children:w})})}),g("span",{className:"publish-library-note",children:g(Ts,{i18nKey:"publishDialog.noteGuidelines",link:w=>g("a",{href:"https://github.com/excalidraw/excalidraw-libraries#guidelines",target:"_blank",rel:"noopener noreferrer",children:w})})}),g("div",{className:"publish-library-note",children:M("publishDialog.noteItems")}),y&&g("span",{className:"publish-library-note publish-library-warning",children:M("publishDialog.republishWarning")}),p(),N("div",{className:"publish-library__fields",children:[N("label",{children:[N("div",{children:[g("span",{children:M("publishDialog.libraryName")}),g("span",{"aria-hidden":"true",className:"required",children:"*"})]}),g("input",{type:"text",name:"name",required:!0,value:a.name,onChange:h,placeholder:M("publishDialog.placeholder.libraryName")})]}),N("label",{style:{alignItems:"flex-start"},children:[N("div",{children:[g("span",{children:M("publishDialog.libraryDesc")}),g("span",{"aria-hidden":"true",className:"required",children:"*"})]}),g("textarea",{name:"description",rows:4,required:!0,value:a.description,onChange:h,placeholder:M("publishDialog.placeholder.libraryDesc")})]}),N("label",{children:[N("div",{children:[g("span",{children:M("publishDialog.authorName")}),g("span",{"aria-hidden":"true",className:"required",children:"*"})]}),g("input",{type:"text",name:"authorName",required:!0,value:a.authorName,onChange:h,placeholder:M("publishDialog.placeholder.authorName")})]}),N("label",{children:[g("span",{children:M("publishDialog.githubUsername")}),g("input",{type:"text",name:"githubHandle",value:a.githubHandle,onChange:h,placeholder:M("publishDialog.placeholder.githubHandle")})]}),N("label",{children:[g("span",{children:M("publishDialog.twitterUsername")}),g("input",{type:"text",name:"twitterHandle",value:a.twitterHandle,onChange:h,placeholder:M("publishDialog.placeholder.twitterHandle")})]}),N("label",{children:[g("span",{children:M("publishDialog.website")}),g("input",{type:"text",name:"website",pattern:"https?://.+",title:M("publishDialog.errors.website"),value:a.website,onChange:h,placeholder:M("publishDialog.placeholder.website")})]}),g("span",{className:"publish-library-note",children:g(Ts,{i18nKey:"publishDialog.noteLicense",link:w=>g("a",{href:"https://github.com/excalidraw/excalidraw-libraries/blob/main/LICENSE",target:"_blank",rel:"noopener noreferrer",children:w})})})]}),N("div",{className:"publish-library__buttons",children:[g(Zh,{label:M("buttons.saveLibNames"),onClick:U,"data-testid":"cancel-clear-canvas-button"}),g(Zh,{type:"submit",label:M("buttons.submit"),actionType:"primary",isLoading:c})]})]}):g("p",{style:{padding:"1em",textAlign:"center",fontWeight:500},children:M("publishDialog.atleastOneLibItem")})})},JEe=D.forwardRef(({children:e,gap:t,align:n,justifyContent:i,className:s,style:r},o)=>g("div",{className:re("Stack Stack_horizontal",s),style:{"--gap":t,alignItems:n,justifyContent:i,...r},ref:o,children:e})),e8e=D.forwardRef(({children:e,gap:t,align:n,justifyContent:i,className:s,style:r},o)=>g("div",{className:re("Stack Stack_vertical",s),style:{"--gap":t,justifyItems:n,justifyContent:i,...r},ref:o,children:e})),Va={Row:JEe,Col:e8e},zX=({children:e,onClickOutside:t,className:n="",onSelect:i,style:s,placement:r="bottom"})=>{const o=oi(),a=D.useRef(null),l=Uy({onClickOutside:t});cT(a,()=>{var u;(u=l.onClickOutside)==null||u.call(l)}),D.useEffect(()=>{const u=f=>{var h;f.key===H.ESCAPE&&(f.stopImmediatePropagation(),(h=l.onClickOutside)==null||h.call(l))},d={capture:!0};return document.addEventListener(te.KEYDOWN,u,d),()=>{document.removeEventListener(te.KEYDOWN,u,d)}},[l]);const c=re(`dropdown-menu ${n}`,{"dropdown-menu--mobile":o.editor.isMobile,"dropdown-menu--placement-top":r==="top"}).trim();return g(B$.Provider,{value:{onSelect:i},children:g("div",{ref:a,className:c,style:s,"data-testid":"dropdown-menu",children:o.editor.isMobile?g(Va.Col,{className:"dropdown-menu-container",style:{"--gap":1.25},children:e}):g(vr,{className:"dropdown-menu-container",padding:2,style:{zIndex:2},children:e})})})};zX.displayName="DropdownMenuContent";const t8e=({children:e,className:t="",selected:n,...i})=>g("div",{...i,className:`dropdown-menu-item-base dropdown-menu-item-custom ${t} ${n?"dropdown-menu-item--selected":""}`.trim(),children:e}),D0=({icon:e,shortcut:t,href:n,children:i,onSelect:s,className:r="",selected:o,rel:a="noopener",...l})=>{const c=H$(l.onClick,s);return g("a",{...l,href:n,target:"_blank",rel:a||"noopener",className:z$(r,o),title:l.title??l["aria-label"],onClick:c,children:g(F$,{icon:e,shortcut:t,children:i})})};D0.displayName="DropdownMenuItemLink";const HX=()=>g("div",{style:{height:"1px",backgroundColor:"var(--default-border-color)",margin:".5rem 0",flex:"0 0 auto"}});HX.displayName="DropdownMenuSeparator";const VX=({className:e="",children:t,onToggle:n,title:i,...s})=>{const r=oi(),o=re(`dropdown-menu-button ${e}`,"zen-mode-transition",{"dropdown-menu-button--mobile":r.editor.isMobile}).trim();return g("button",{"data-prevent-outside-click":!0,className:o,onClick:n,type:"button","data-testid":"dropdown-menu-button",title:i,...s,children:t})};VX.displayName="DropdownMenuTrigger";const n8e=e=>{const t=ae.Children.toArray(e).find(n=>ae.isValidElement(n)&&typeof n.type!="string"&&(n==null?void 0:n.type.displayName)&&n.type.displayName==="DropdownMenuTrigger");return t||null},i8e=e=>{const t=ae.Children.toArray(e).find(n=>ae.isValidElement(n)&&typeof n.type!="string"&&(n==null?void 0:n.type.displayName)&&n.type.displayName==="DropdownMenuContent");return t||null},Be=({children:e,open:t,placement:n})=>{const i=n8e(e),s=i8e(e),r=s&&ae.isValidElement(s)?ae.cloneElement(s,{placement:n}):s;return N(fe,{children:[i,t&&r]})};Be.Trigger=VX;Be.Content=zX;Be.Item=Ms;Be.ItemLink=D0;Be.ItemCustom=t8e;Be.Group=L6;Be.Separator=HX;Be.displayName="DropdownMenu";const s8e=(e,t)=>e.filter(n=>t.includes(n.id)),r8e=({setAppState:e,selectedItems:t,library:n,onRemoveFromLibrary:i,resetLibrary:s,onSelectItems:r,appState:o,className:a})=>{const[l]=un(Kh),[c,u]=un(PT),d=()=>{const S=t.length?M("alerts.removeItemsFromsLibrary",{count:t.length}):M("alerts.resetLibrary"),R=t.length?M("confirmDialog.removeItemsFromLib"):M("confirmDialog.resetLibrary");return g(BX,{onConfirm:()=>{t.length?i():s(),h(!1)},onCancel:()=>{h(!1)},title:R,children:g("p",{children:S})})},[f,h]=D.useState(!1),m=!!t.length,p=m?l.libraryItems.filter(S=>t.includes(S.id)):l.libraryItems,U=M(m?"buttons.remove":"buttons.resetLibrary"),[b,y]=D.useState(!1),[w,v]=D.useState(null),I=D.useCallback(()=>N(ir,{onCloseRequest:()=>v(null),title:M("publishSuccessDialog.title"),className:"publish-library-success",size:"small",children:[g("p",{children:g(Ts,{i18nKey:"publishSuccessDialog.content",authorName:w.authorName,link:S=>g("a",{href:w==null?void 0:w.url,target:"_blank",rel:"noopener noreferrer",children:S})})}),g($e,{type:"button",title:M("buttons.close"),"aria-label":M("buttons.close"),label:M("buttons.close"),onClick:()=>v(null),"data-testid":"publish-library-success-close",className:"publish-library-success-close"})]}),[v,w]),C=(S,R)=>{y(!1),v({url:S.url,authorName:S.authorName});const P=R.slice();P.forEach(L=>{t.includes(L.id)&&(L.status="published")}),n.setLibrary(P)},_=async()=>{try{await n.updateLibrary({libraryItems:TT({description:"Excalidraw library files"}),merge:!0,openLibraryMenu:!0})}catch(S){if((S==null?void 0:S.name)==="AbortError"){console.warn(S);return}e({errorMessage:M("errors.importLibraryError")})}},T=async()=>{const S=m?p:await n.getLatestLibrary();v5e(S).catch(SB).catch(R=>{e({errorMessage:R.message})})},k=()=>N(Be,{open:c,children:[g(Be.Trigger,{onToggle:()=>u(!c),children:Zue}),N(Be.Content,{onClickOutside:()=>u(!1),onSelect:()=>u(!1),className:"library-menu",children:[!m&&g(Be.Item,{onSelect:_,icon:z_,"data-testid":"lib-dropdown--load",children:M("buttons.load")}),!!p.length&&g(Be.Item,{onSelect:T,icon:cy,"data-testid":"lib-dropdown--export",children:M("buttons.export")}),m&&g(Be.Item,{icon:ife,onSelect:()=>y(!0),"data-testid":"lib-dropdown--remove",children:M("buttons.publishLibrary")}),!!p.length&&g(Be.Item,{onSelect:()=>h(!0),icon:Hc,children:U})]})]});return N("div",{className:re("library-menu-dropdown-container",a),children:[k(),t.length>0&&g("div",{className:"library-actions-counter",children:t.length}),f&&d(),b&&g(QEe,{onClose:()=>y(!1),libraryItems:s8e(l.libraryItems,t),appState:o,onSuccess:S=>C(S,l.libraryItems),onError:S=>window.alert(S),updateItemsInStorage:()=>n.setLibrary(l.libraryItems),onRemove:S=>r(t.filter(R=>R!==S))}),w&&I()]})},o8e=({selectedItems:e,onSelectItems:t,className:n})=>{const{library:i}=go(),{clearLibraryCache:s,deleteItemsFromLibraryCache:r}=NT(),o=wi(),a=xn(),[l]=un(Kh),c=async d=>{const f=d.filter(h=>!e.includes(h.id));i.setLibrary(f).catch(()=>{a({errorMessage:M("alerts.errorRemovingFromLibrary")})}),r(e),t([])};return g(r8e,{appState:o,setAppState:a,selectedItems:e,onSelectItems:t,library:i,onRemoveFromLibrary:()=>c(l.libraryItems),resetLibrary:()=>{i.resetLibrary(),s()},className:n})};function a8e(){return[!1,D.useCallback(t=>t(),[])]}const l8e=ae.useTransition||a8e,c8e=D.memo(({id:e,elements:t,isPending:n,onClick:i,selected:s,onToggle:r,onDrag:o,svgCache:a})=>{const l=D.useRef(null),c=NX(e,t,a,l),[u,d]=D.useState(!1),f=oi().editor.isMobile,h=n&&g("div",{className:"library-unit__adder",children:Kue});return N("div",{className:re("library-unit",{"library-unit__active":t,"library-unit--hover":t&&u,"library-unit--selected":s,"library-unit--skeleton":!c}),onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),children:[g("div",{className:re("library-unit__dragger",{"library-unit__pulse":!!n}),ref:l,draggable:!!t,onClick:t||n?m=>{e&&m.shiftKey?r(e,m):i(e)}:void 0,onDragStart:m=>{if(!e){m.preventDefault();return}d(!1),o(e,m)}}),h,e&&t&&(u||f||s)&&g(bT,{checked:s,onChange:(m,p)=>r(e,p),className:"library-unit__checkbox"})]})}),u8e=()=>g("div",{className:"library-unit library-unit--skeleton"}),E3=({children:e})=>g("div",{className:"library-menu-items-container__grid",children:e}),JU=D.memo(({items:e,onItemSelectToggle:t,onItemDrag:n,isItemSelected:i,onClick:s,svgCache:r,itemsRenderedPerBatch:o})=>{const[,a]=l8e(),[l,c]=D.useState(0);return D.useEffect(()=>{l<e.length&&a(()=>{c(l+o)})},[l,e.length,a,o]),g(fe,{children:e.map((u,d)=>d<l?g(c8e,{elements:u==null?void 0:u.elements,isPending:!(u!=null&&u.id)&&!!(u!=null&&u.elements),onClick:s,svgCache:r,id:u==null?void 0:u.id,selected:i(u.id),onToggle:t,onDrag:n},(u==null?void 0:u.id)??d):g(u8e,{},d))})}),Xc=({type:e="button",onSelect:t,selected:n,children:i,className:s="",...r})=>g("button",{onClick:Y5(r.onClick,o=>{t()}),type:e,className:re("excalidraw-button",s,{selected:n}),...r,children:i}),Id=D.forwardRef(({onChange:e,label:t,fullWidth:n,placeholder:i,readonly:s,selectOnRender:r,onKeyDown:o,isRedacted:a=!1,icon:l,className:c,type:u,...d},f)=>{const h=D.useRef(null);D.useImperativeHandle(f,()=>h.current),D.useLayoutEffect(()=>{var U,b;r&&((U=h.current)==null||U.focus(),(b=h.current)==null||b.select())},[r]);const[m,p]=D.useState(!1);return N("div",{className:re("ExcTextField",c,{"ExcTextField--fullWidth":n,"ExcTextField--hasIcon":!!l}),onClick:()=>{var U;(U=h.current)==null||U.focus()},children:[l,t&&g("div",{className:"ExcTextField__label",children:t}),N("div",{className:re("ExcTextField__input",{"ExcTextField__input--readonly":s}),children:[g("input",{className:re({"is-redacted":"value"in d&&d.value&&a&&!m}),readOnly:s,value:"value"in d?d.value:void 0,defaultValue:"defaultValue"in d?d.defaultValue:void 0,placeholder:i,ref:h,onChange:U=>e==null?void 0:e(U.target.value),onKeyDown:o,type:u}),a&&g(Xc,{onSelect:()=>p(!m),style:{border:0,userSelect:"none"},children:m?ffe:G_})]})]})}),d8e=17,f8e=64;function h8e({isLoading:e,libraryItems:t,onAddToLibrary:n,onInsertLibraryItems:i,pendingElements:s,theme:r,id:o,libraryReturnUrl:a,onSelectItems:l,selectedItems:c}){const u=oi(),d=D.useRef(null),f=GEe(d);D.useEffect(()=>{var V;f>0&&((V=d.current)==null||V.scrollTo(0,f))},[]);const{svgCache:h}=NT(),[m,p]=D.useState(null),[U,b]=D.useState(""),y=!t.length&&!s.length,w=!y&&!!U.trim(),v=D.useMemo(()=>{const V=k0(U.trim().toLowerCase());return V?t.filter($=>{const j=$.name||"";return j.trim()&&k0(j.toLowerCase()).includes(V)}):[]},[t,U]),I=D.useMemo(()=>t.filter(V=>V.status!=="published"),[t]),C=D.useMemo(()=>t.filter(V=>V.status==="published"),[t]),_=D.useCallback((V,$)=>{const j=!c.includes(V),W=[...I,...C];if(j){if($.shiftKey&&m){const Q=W.findIndex(We=>We.id===m),oe=W.findIndex(We=>We.id===V);if(Q===-1||oe===-1){l([...c,V]);return}const me=ve(c),he=Math.min(Q,oe),Me=Math.max(Q,oe),mt=W.reduce((We,Ht,fn)=>((fn>=he&&fn<=Me||me.has(Ht.id))&&We.push(Ht.id),We),[]);l(mt)}else l([...c,V]);p(V)}else p(null),l(c.filter(Q=>Q!==V))},[m,l,C,c,I]);D.useEffect(()=>{c.length||p(null)},[c]);const T=D.useCallback(V=>{let $;return c.includes(V)?$=t.filter(j=>c.includes(j.id)):$=t.filter(j=>j.id===V),$.map(j=>({...j,elements:E0({type:"everything",elements:j.elements,randomizeSeed:!0}).duplicatedElements}))},[t,c]),k=D.useCallback((V,$)=>{const j={itemIds:c.includes(V)?c:[V]};$.dataTransfer.setData(_e.excalidrawlibIds,JSON.stringify(j))},[c]),S=D.useCallback(V=>V?c.includes(V):!1,[c]),R=D.useCallback(()=>{n(s)},[s,n]),P=D.useCallback(V=>{V&&i(T(V))},[T,i]),L=h.size>=(v.length?v:t).length?f8e:d8e,X=D.useRef(null);D.useEffect(()=>{bre(()=>{var V;(V=X.current)==null||V.focus()})},[]);const G=!w&&N(fe,{children:[!y&&g("div",{className:"library-menu-items-container__header",children:M("labels.personalLib")}),!s.length&&!I.length?N("div",{className:"library-menu-items__no-items",children:[!C.length&&g("div",{className:"library-menu-items__no-items__label",children:M("library.noItems")}),g("div",{className:"library-menu-items__no-items__hint",children:C.length>0?M("library.hint_emptyPrivateLibrary"):M("library.hint_emptyLibrary")})]}):N(E3,{children:[s.length>0&&g(JU,{itemsRenderedPerBatch:L,items:[{id:null,elements:s}],onItemSelectToggle:_,onItemDrag:k,onClick:R,isItemSelected:S,svgCache:h}),g(JU,{itemsRenderedPerBatch:L,items:I,onItemSelectToggle:_,onItemDrag:k,onClick:P,isItemSelected:S,svgCache:h})]}),C.length>0&&g("div",{className:"library-menu-items-container__header",style:{marginTop:"0.75rem"},children:M("labels.excalidrawLib")}),C.length>0&&g(E3,{children:g(JU,{itemsRenderedPerBatch:L,items:C,onItemSelectToggle:_,onItemDrag:k,onClick:P,isItemSelected:S,svgCache:h})})]}),z=w&&N(fe,{children:[N("div",{className:"library-menu-items-container__header",children:[M("library.search.heading"),!e&&N("div",{className:"library-menu-items-container__header__hint",style:{cursor:"pointer"},onPointerDown:V=>V.preventDefault(),onClick:V=>{b("")},children:[g("kbd",{children:"esc"})," to clear"]})]}),v.length>0?g(E3,{children:g(JU,{itemsRenderedPerBatch:L,items:v,onItemSelectToggle:_,onItemDrag:k,onClick:P,isItemSelected:S,svgCache:h})}):N("div",{className:"library-menu-items__no-items",children:[g("div",{className:"library-menu-items__no-items__hint",children:M("library.search.noResults")}),g(Xc,{onPointerDown:V=>V.preventDefault(),onSelect:()=>{b("")},style:{width:"auto",marginTop:"1rem"},children:M("library.search.clearSearch")})]})]});return N("div",{className:"library-menu-items-container",style:s.length||I.length||C.length?{justifyContent:"flex-start"}:{borderBottom:0},children:[N("div",{className:"library-menu-items-header",children:[!y&&g(Id,{ref:X,type:"search",className:re("library-menu-items-container__search",{hideCancelButton:!u.editor.isMobile}),placeholder:M("library.search.inputPlaceholder"),value:U,onChange:V=>b(V)}),g(o8e,{selectedItems:c,onSelectItems:l,className:"library-menu-dropdown-container--in-heading"})]}),N(Va.Col,{className:"library-menu-items-container__items",align:"start",gap:1,style:{flex:C.length>0?1:"0 1 auto",margin:y?"auto":0},ref:d,children:[e&&g("div",{style:{position:"absolute",top:"var(--container-padding-y)",right:"var(--container-padding-x)",transform:"translateY(50%)"},children:g(cl,{})}),G,z,y&&g(FX,{style:{padding:"16px 0",width:"100%"},id:o,libraryReturnUrl:a,theme:r})]})]})}const PT=Yt(!1),YR=({children:e})=>g("div",{className:"layer-ui__library",children:e}),g8e=D.memo(({onInsertLibraryItems:e,pendingElements:t,onAddToLibrary:n,setAppState:i,libraryReturnUrl:s,library:r,id:o,theme:a,selectedItems:l,onSelectItems:c})=>{const[u]=un(Kh),d=D.useCallback(m=>{(async(U,b)=>{Qe("element","addToLibrary","ui");for(const w of uB)if(U.some(v=>v.type===w))return i({errorMessage:M(`errors.libraryElementTypeError.${w}`)});const y=[{status:"unpublished",elements:U,id:fs(),created:Date.now()},...b];n(),r.setLibrary(y).catch(()=>{i({errorMessage:M("alerts.errorAddingToLibrary")})})})(m,u.libraryItems)},[n,r,i,u.libraryItems]),f=D.useMemo(()=>u.libraryItems,[u]);if(u.status==="loading"&&!u.isInitialized)return g(YR,{children:g("div",{className:"layer-ui__library-message",children:N("div",{children:[g(cl,{size:"2em"}),g("span",{children:M("labels.libraryLoadingMessage")})]})})});const h=u.libraryItems.length>0||t.length>0;return N(YR,{children:[g(h8e,{isLoading:u.status==="loading",libraryItems:f,onAddToLibrary:d,onInsertLibraryItems:e,pendingElements:t,id:o,libraryReturnUrl:s,theme:a,onSelectItems:c,selectedItems:l}),h&&g(FX,{className:"library-menu-control-buttons--at-bottom",style:{padding:"16px 12px 0 12px"},id:o,libraryReturnUrl:s,theme:a})]})}),v3=(e,t)=>({elements:e,pending:Ve(e,{selectedElementIds:t},{includeBoundTextElement:!0,includeElementsInFrames:!0}),selectedElementIds:t}),m8e=(e,t)=>{const n=Wy(),[i,s]=D.useState(()=>v3(n,e.selectedElementIds)),r=D.useRef(new Map);return D.useEffect(()=>{for(const o of i.pending)r.current.set(o.id,o.version)},[i.pending]),D.useEffect(()=>{t.state.cursorButton==="up"&&t.state.activeTool.type==="selection"&&s(o=>{var l;if(!Wi(o.selectedElementIds,e.selectedElementIds))return r.current.clear(),v3(n,e.selectedElementIds);const a=t.scene.getNonDeletedElementsMap();for(const c of Object.keys(e.selectedElementIds)){const u=(l=a.get(c))==null?void 0:l.version;if(u&&u!==r.current.get(c))return v3(n,e.selectedElementIds)}return o})},[t,t.state.cursorButton,t.state.activeTool.type,e.selectedElementIds,n]),i.pending},p8e=D.memo(()=>{const e=go(),{onInsertElements:t}=e,n=Np(),i=wi(),s=xn(),[r,o]=D.useState([]),a=D.useMemo(()=>e.library,[e.library]),l=m8e(i,e);D.useEffect(()=>Jt(document,te.KEYDOWN,d=>{if(d.key===H.ESCAPE&&d.target instanceof HTMLElement){const f=d.target;if(f.closest(`.${Zs.SIDEBAR}`))r.length>0?(d.stopPropagation(),o([])):ka(f)&&f instanceof HTMLInputElement&&!f.value&&(d.stopPropagation(),s({openSidebar:null}),e.focusContainer());else if(r.length>0){const{x:h,y:m}=e.lastViewportPosition,p=document.elementFromPoint(h,m);p!=null&&p.closest(`.${Zs.SIDEBAR}`)&&(d.stopPropagation(),o([]))}}},{capture:!0}),[r,s,e]);const c=D.useCallback(d=>{t(OT(d)),e.focusContainer()},[t,e]),u=D.useCallback(()=>{s({selectedElementIds:{},selectedGroupIds:{},activeEmbeddable:null})},[s]);return g(g8e,{pendingElements:l,onInsertLibraryItems:c,onAddToLibrary:u,setAppState:s,libraryReturnUrl:n.libraryReturnUrl,library:a,id:e.id,theme:i.theme,selectedItems:r,onSelectItems:o})}),U8e=e=>{const{closeOnClickOutside:t=!0}=e,n=D$({className:"excalidraw-modal-container"}),i=D.useRef(document.body.classList.contains("excalidraw-animations-disabled"));if(!n)return null;const s=r=>{r.key===H.ESCAPE&&(r.nativeEvent.stopImmediatePropagation(),r.stopPropagation(),e.onCloseRequest())};return hi.createPortal(N("div",{className:re("Modal",e.className,{"animations-disabled":i.current}),role:"dialog","aria-modal":"true",onKeyDown:s,"aria-labelledby":e.labelledBy,"data-prevent-outside-click":!0,children:[g("div",{className:"Modal__background",onClick:t?e.onCloseRequest:void 0}),g("div",{className:"Modal__content",style:{"--max-width":`${e.maxWidth}px`},tabIndex:0,children:e.children})]}),n)};function b8e(e){if(e&&typeof e=="number")return e;switch(e){case"small":return 550;case"wide":return 1024;case"regular":default:return 800}}const ir=e=>{const[t,n]=CX(),[i]=D.useState(document.activeElement),{id:s}=Lr(),r=oi().viewport.isMobile;D.useEffect(()=>{if(!t)return;const c=U4(t);setTimeout(()=>{c.length>0&&e.autofocus!==!1&&(c[1]||c[0]).focus()});const u=d=>{if(d.key===H.TAB){const f=U4(t),{activeElement:h}=document,m=f.findIndex(p=>p===h);m===0&&d.shiftKey?(f[f.length-1].focus(),d.preventDefault()):m===f.length-1&&!d.shiftKey&&(f[0].focus(),d.preventDefault())}};return t.addEventListener("keydown",u),()=>t.removeEventListener("keydown",u)},[t,e.autofocus]);const o=xn(),a=ry(PT),l=()=>{o({openMenu:null}),a(!1),i.focus(),e.onCloseRequest()};return g(U8e,{className:re("Dialog",e.className,{"Dialog--fullscreen":r}),labelledBy:"dialog-title",maxWidth:b8e(e.size),onCloseRequest:l,closeOnClickOutside:e.closeOnClickOutside,children:N(vr,{ref:n,children:[e.title&&g("h2",{id:`${s}-dialog-title`,className:"Dialog__title",children:g("span",{className:"Dialog__titleContent",children:e.title})}),r&&g("button",{className:"Dialog__close",onClick:l,title:M("buttons.close"),"aria-label":M("buttons.close"),type:"button",children:Vd}),g("div",{className:"Dialog__content",children:e.children})]})})},Av=[{icon:ly,value:"selection",key:H.V,numericKey:H[1],fillable:!0},{icon:L_,value:"rectangle",key:H.R,numericKey:H[2],fillable:!0},{icon:N_,value:"diamond",key:H.D,numericKey:H[3],fillable:!0},{icon:O_,value:"ellipse",key:H.O,numericKey:H[4],fillable:!0},{icon:pV,value:"arrow",key:H.A,numericKey:H[5],fillable:!0},{icon:P_,value:"line",key:H.L,numericKey:H[6],fillable:!0},{icon:Sp,value:"freedraw",key:[H.P,H.X],numericKey:H[7],fillable:!1},{icon:hh,value:"text",key:H.T,numericKey:H[8],fillable:!1},{icon:K4,value:"image",key:null,numericKey:H[9],fillable:!1},{icon:UV,value:"eraser",key:H.E,numericKey:H[0],fillable:!1}],$X=e=>e.state.preferredSelectionTool.type==="lasso"?[{value:"lasso",icon:ly,key:H.V,numericKey:H[1],fillable:!0},...Av.slice(1)]:Av,y8e=(e,t)=>{const n=$X(t).find((i,s)=>i.numericKey!=null&&e===i.numericKey.toString()||i.key&&(typeof i.key=="string"?i.key===e:i.key.includes(e)));return(n==null?void 0:n.value)||null};var E8e={};const WR=e=>{let t;const n=new Set,i=(u,d)=>{const f=typeof u=="function"?u(t):u;if(!Object.is(f,t)){const h=t;t=d??(typeof f!="object"||f===null)?f:Object.assign({},t,f),n.forEach(m=>m(t,h))}},s=()=>t,l={setState:i,getState:s,getInitialState:()=>c,subscribe:u=>(n.add(u),()=>n.delete(u)),destroy:()=>{(E8e?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},c=t=e(i,s,l);return l},v8e=e=>e?WR(e):WR;var GX={exports:{}},XX={},jX={exports:{}},YX={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qh=D;function w8e(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var _8e=typeof Object.is=="function"?Object.is:w8e,T8e=qh.useState,I8e=qh.useEffect,S8e=qh.useLayoutEffect,x8e=qh.useDebugValue;function C8e(e,t){var n=t(),i=T8e({inst:{value:n,getSnapshot:t}}),s=i[0].inst,r=i[1];return S8e(function(){s.value=n,s.getSnapshot=t,w3(s)&&r({inst:s})},[e,n,t]),I8e(function(){return w3(s)&&r({inst:s}),e(function(){w3(s)&&r({inst:s})})},[e]),x8e(n),n}function w3(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!_8e(e,n)}catch{return!0}}function A8e(e,t){return t()}var M8e=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?A8e:C8e;YX.useSyncExternalStore=qh.useSyncExternalStore!==void 0?qh.useSyncExternalStore:M8e;jX.exports=YX;var k8e=jX.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vy=D,R8e=k8e;function D8e(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var L8e=typeof Object.is=="function"?Object.is:D8e,N8e=R8e.useSyncExternalStore,O8e=Vy.useRef,P8e=Vy.useEffect,F8e=Vy.useMemo,B8e=Vy.useDebugValue;XX.useSyncExternalStoreWithSelector=function(e,t,n,i,s){var r=O8e(null);if(r.current===null){var o={hasValue:!1,value:null};r.current=o}else o=r.current;r=F8e(function(){function l(h){if(!c){if(c=!0,u=h,h=i(h),s!==void 0&&o.hasValue){var m=o.value;if(s(m,h))return d=m}return d=h}if(m=d,L8e(u,h))return m;var p=i(h);return s!==void 0&&s(m,p)?(u=h,m):(u=h,d=p)}var c=!1,u,d,f=n===void 0?null:n;return[function(){return l(t())},f===null?void 0:function(){return l(f())}]},[t,n,i,s]);var a=N8e(e,r[0],r[1]);return P8e(function(){o.hasValue=!0,o.value=a},[a]),B8e(a),a};GX.exports=XX;var z8e=GX.exports;const H8e=bl(z8e);var WX={};const{useDebugValue:V8e}=ae,{useSyncExternalStoreWithSelector:$8e}=H8e;let KR=!1;const G8e=e=>e;function X8e(e,t=G8e,n){(WX?"production":void 0)!=="production"&&n&&!KR&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),KR=!0);const i=$8e(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return V8e(i),i}const ZR=e=>{(WX?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?v8e(e):e,n=(i,s)=>X8e(t,i,s);return Object.assign(n,t),n},j8e=e=>e?ZR(e):ZR;var qR,QR;const JR=typeof window<"u"&&((qR=window.document)!=null&&qR.createElement||((QR=window.navigator)==null?void 0:QR.product)==="ReactNative")?ae.useLayoutEffect:ae.useEffect;function yo(){const e=j8e(t=>({current:new Array,version:0,set:t}));return{In:({children:t})=>{const n=e(s=>s.set),i=e(s=>s.version);return JR(()=>{n(s=>({version:s.version+1}))},[]),JR(()=>(n(({current:s})=>({current:[...s,t]})),()=>n(({current:s})=>({current:s.filter(r=>r!==t)}))),[t,i]),null},Out:()=>{const t=e(n=>n.current);return ae.createElement(ae.Fragment,null,t)}}}const KX=ae.createContext(null),Ji=()=>ae.useContext(KX),Y8e=wH(),W8e=()=>ae.useMemo(()=>({MainMenuTunnel:yo(),WelcomeScreenMenuHintTunnel:yo(),WelcomeScreenToolbarHintTunnel:yo(),WelcomeScreenHelpHintTunnel:yo(),WelcomeScreenCenterTunnel:yo(),FooterCenterTunnel:yo(),DefaultSidebarTriggerTunnel:yo(),DefaultSidebarTabTriggersTunnel:yo(),OverwriteConfirmDialogTunnel:yo(),TTDDialogTriggerTunnel:yo(),tunnelsJotai:Y8e}),[]),Q2=({app:e,options:t,activeTool:n,defaultOption:i,className:s="Shape",namePrefix:r,title:o,"data-testid":a,onToolChange:l,displayedOption:c,fillable:u=!1})=>{const[d,f]=D.useState(!1),h=n.type,m=c.type===h,p=32/2+10;return!t.some(U=>U.type===h)&&d&&f(!1),D.useEffect(()=>{const U=e.onPointerDownEmitter.on(()=>{f(!1)});return()=>U==null?void 0:U()},[e]),N(wl,{open:d,children:[g(_l,{asChild:!0,children:g($e,{className:re(s,{fillable:u,active:t.some(U=>U.type===n.type)}),type:"radio",icon:c.icon,checked:m,name:"editor-current-shape",title:o,"aria-label":o,"data-testid":a,onPointerDown:()=>{f(U=>!U),l(i)}})}),g(py,{className:"tool-popover-content",sideOffset:p,children:t.map(({type:U,icon:b,title:y})=>g($e,{className:re(s,{active:h===U}),type:"radio",icon:b,checked:h===U,name:`${r}-option`,title:y||Mt(U),keyBindingLabel:"","aria-label":y||Mt(U),"data-testid":`toolbar-${U}`,onChange:()=>{e.state.activeTool.type!==U&&Qe("toolbar",U,"ui"),e.setActiveTool({type:U}),l==null||l(U)}},U))})]})},FT=re([Zs.SHAPE_ACTIONS_THEME_SCOPE,"properties-content"]),$y=(e,t)=>{var i;let n=((i=t[0])==null?void 0:i.type)||null;for(const s of t)if(s.type!==n){n=null;break}return A4(e.activeTool.type)&&n!=="image"&&n!=="frame"&&n!=="magicframe"||t.some(s=>A4(s.type))},Gy=(e,t)=>Bc(e.activeTool.type)||t.some(n=>Bc(n.type)),K8e=({appState:e,elementsMap:t,renderAction:n,app:i})=>{var m;const s=J5(t,e);let r=!1;s.length===2&&(Di(s[0])||Di(s[1]))&&(r=!0);const o=!!(e.editingTextElement||e.newElement),a=oi(),l=document.documentElement.getAttribute("dir")==="rtl",c=Bc(e.activeTool.type)&&!ws(e.currentItemBackgroundColor)||s.some(p=>Bc(p.type)&&!ws(p.backgroundColor)),u=s.length===1||r,d=!((m=e.selectedLinearElement)!=null&&m.isEditing)&&s.length===1&&Se(s[0])&&!ge(s[0]),f=!e.croppingElementId&&s.length===1&&yt(s[0]),h=!r&&Cs(e,i);return N("div",{className:"selected-shape-actions",children:[g("div",{children:$y(e,s)&&n("changeStrokeColor")}),Gy(e,s)&&g("div",{children:n("changeBackgroundColor")}),c&&n("changeFillStyle"),(p6(e.activeTool.type)||s.some(p=>p6(p.type)))&&n("changeStrokeWidth"),(e.activeTool.type==="freedraw"||s.some(p=>p.type==="freedraw"))&&n("changeStrokeShape"),(U6(e.activeTool.type)||s.some(p=>U6(p.type)))&&N(fe,{children:[n("changeStrokeStyle"),n("changeSloppiness")]}),(um(e.activeTool.type)||s.some(p=>um(p.type)))&&g(fe,{children:n("changeRoundness")}),(b6(e.activeTool.type)||s.some(p=>b6(p.type)))&&g(fe,{children:n("changeArrowType")}),(e.activeTool.type==="text"||s.some(de))&&N(fe,{children:[n("changeFontFamily"),n("changeFontSize"),(e.activeTool.type==="text"||iz(s,t))&&n("changeTextAlign")]}),nz(s,t)&&n("changeVerticalAlign"),(y6(e.activeTool.type)||s.some(p=>y6(p.type)))&&g(fe,{children:n("changeArrowhead")}),n("changeOpacity"),N("fieldset",{children:[g("legend",{children:M("labels.layers")}),N("div",{className:"buttonList",children:[n("sendToBack"),n("sendBackward"),n("bringForward"),n("bringToFront")]})]}),h&&!r&&N("fieldset",{children:[g("legend",{children:M("labels.align")}),N("div",{className:"buttonList",children:[l?N(fe,{children:[n("alignRight"),n("alignHorizontallyCentered"),n("alignLeft")]}):N(fe,{children:[n("alignLeft"),n("alignHorizontallyCentered"),n("alignRight")]}),s.length>2&&n("distributeHorizontally"),g("div",{style:{flexBasis:"100%",height:0}}),N("div",{style:{display:"flex",flexWrap:"wrap",gap:".5rem",marginTop:"-0.5rem"},children:[n("alignTop"),n("alignVerticallyCentered"),n("alignBottom"),s.length>2&&n("distributeVertically")]})]})]}),!o&&s.length>0&&N("fieldset",{children:[g("legend",{children:M("labels.actions")}),N("div",{className:"buttonList",children:[!a.editor.isMobile&&n("duplicateSelection"),!a.editor.isMobile&&n("deleteSelectedElements"),n("group"),n("ungroup"),u&&n("hyperlink"),f&&n("cropEditor"),d&&n("toggleLinearEditor")]})]})]})},ZX=({appState:e,renderAction:t,setAppState:n,targetElements:i,container:s})=>{const r=Bc(e.activeTool.type)&&!ws(e.currentItemBackgroundColor)||i.some(l=>Bc(l.type)&&!ws(l.backgroundColor)),o=i.length>0||e.activeTool.type!=="selection"&&e.activeTool.type!=="eraser"&&e.activeTool.type!=="hand"&&e.activeTool.type!=="laser"&&e.activeTool.type!=="lasso",a=e.openPopup==="compactStrokeStyles";return o?g("div",{className:"compact-action-item",children:N(wl,{open:a,onOpenChange:l=>{n(l?{openPopup:"compactStrokeStyles"}:{openPopup:null})},children:[g(_l,{asChild:!0,children:g("button",{type:"button",className:re("compact-action-button properties-trigger",{active:a}),title:M("labels.stroke"),onClick:l=>{l.preventDefault(),l.stopPropagation(),n({openPopup:a?null:"compactStrokeStyles"})},children:kfe})}),a&&g(Ig,{className:FT,container:s,style:{maxWidth:"13rem"},onClose:()=>{},children:N("div",{className:"selected-shape-actions",children:[r&&t("changeFillStyle"),(p6(e.activeTool.type)||i.some(l=>p6(l.type)))&&t("changeStrokeWidth"),(U6(e.activeTool.type)||i.some(l=>U6(l.type)))&&N(fe,{children:[t("changeStrokeStyle"),t("changeSloppiness")]}),(um(e.activeTool.type)||i.some(l=>um(l.type)))&&t("changeRoundness"),t("changeOpacity")]})})]})}):null},qX=({appState:e,renderAction:t,setAppState:n,targetElements:i,container:s,app:r})=>{const o=b6(e.activeTool.type)||i.some(l=>b6(l.type)),a=e.openPopup==="compactArrowProperties";return o?g("div",{className:"compact-action-item",children:N(wl,{open:a,onOpenChange:l=>{n(l?{openPopup:"compactArrowProperties"}:{openPopup:null})},children:[g(_l,{asChild:!0,children:g("button",{type:"button",className:re("compact-action-button properties-trigger",{active:a}),title:M("labels.arrowtypes"),onClick:l=>{l.preventDefault(),l.stopPropagation(),n({openPopup:a?null:"compactArrowProperties"})},children:(()=>{const l=gs(i,r,c=>xe(c)?c.elbowed?"elbow":c.roundness?"round":"sharp":null,c=>xe(c),c=>c?null:e.currentItemArrowType);return l==="elbow"?Y_:l==="round"?W_:j_})()})}),a&&g(Ig,{container:s,className:"properties-content",style:{maxWidth:"13rem"},onClose:()=>{},children:t("changeArrowProperties")})]})}):null},QX=({appState:e,renderAction:t,setAppState:n,targetElements:i,container:s,elementsMap:r})=>{const{saveCaretPosition:o,restoreCaretPosition:a}=T1e(),l=e.openPopup==="compactTextProperties";return g("div",{className:"compact-action-item",children:N(wl,{open:l,onOpenChange:c=>{c?(e.editingTextElement&&o(),n({openPopup:"compactTextProperties"})):(n({openPopup:null}),e.editingTextElement&&a())},children:[g(_l,{asChild:!0,children:g("button",{type:"button",className:re("compact-action-button properties-trigger",{active:l}),title:M("labels.textAlign"),onClick:c=>{c.preventDefault(),c.stopPropagation(),l?n({openPopup:null}):(e.editingTextElement&&o(),n({openPopup:"compactTextProperties"}))},children:sde})}),e.openPopup==="compactTextProperties"&&g(Ig,{className:FT,container:s,style:{maxWidth:"13rem"},preventAutoFocusOnTouch:!!e.editingTextElement,onClose:()=>{e.editingTextElement&&a()},children:N("div",{className:"selected-shape-actions",children:[(e.activeTool.type==="text"||i.some(de))&&t("changeFontSize"),(e.activeTool.type==="text"||iz(i,r))&&t("changeTextAlign"),nz(i,r)&&t("changeVerticalAlign")]})})]})})},JX=({appState:e,renderAction:t,targetElements:n,setAppState:i,container:s,app:r,showDuplicate:o,showDelete:a})=>{const l=!!(e.editingTextElement||e.newElement),c=!e.croppingElementId&&n.length===1&&yt(n[0]),u=n.length===1,d=Cs(e,r);let f=!1;n.length===2&&(Di(n[0])||Di(n[1]))&&(f=!0);const h=document.documentElement.getAttribute("dir")==="rtl",m=e.openPopup==="compactOtherProperties";return l||n.length===0?null:g("div",{className:"compact-action-item",children:N(wl,{open:m,onOpenChange:p=>{i(p?{openPopup:"compactOtherProperties"}:{openPopup:null})},children:[g(_l,{asChild:!0,children:g("button",{type:"button",className:re("compact-action-button properties-trigger",{active:m}),title:M("labels.actions"),onClick:p=>{p.preventDefault(),p.stopPropagation(),i({openPopup:m?null:"compactOtherProperties"})},children:que})}),m&&g(Ig,{className:FT,container:s,style:{maxWidth:"12rem",justifyContent:"center",alignItems:"center"},onClose:()=>{},children:N("div",{className:"selected-shape-actions",children:[N("fieldset",{children:[g("legend",{children:M("labels.layers")}),N("div",{className:"buttonList",children:[t("sendToBack"),t("sendBackward"),t("bringForward"),t("bringToFront")]})]}),d&&!f&&N("fieldset",{children:[g("legend",{children:M("labels.align")}),N("div",{className:"buttonList",children:[h?N(fe,{children:[t("alignRight"),t("alignHorizontallyCentered"),t("alignLeft")]}):N(fe,{children:[t("alignLeft"),t("alignHorizontallyCentered"),t("alignRight")]}),n.length>2&&t("distributeHorizontally"),g("div",{style:{flexBasis:"100%",height:0}}),N("div",{style:{display:"flex",flexWrap:"wrap",gap:".5rem",marginTop:"-0.5rem"},children:[t("alignTop"),t("alignVerticallyCentered"),t("alignBottom"),n.length>2&&t("distributeVertically")]})]})]}),N("fieldset",{children:[g("legend",{children:M("labels.actions")}),N("div",{className:"buttonList",children:[t("group"),t("ungroup"),u&&t("hyperlink"),c&&t("cropEditor"),o&&t("duplicateSelection"),a&&t("deleteSelectedElements")]})]})]})})]})})},Z8e=({appState:e,renderAction:t,targetElements:n})=>{var s;return!((s=e.selectedLinearElement)!=null&&s.isEditing)&&n.length===1&&Se(n[0])&&!ge(n[0])?g("div",{className:"compact-action-item",children:t("toggleLinearEditor")}):null},q8e=({appState:e,elementsMap:t,renderAction:n,app:i,setAppState:s})=>{var c;const r=J5(t,e),{container:o}=Lr(),a=!!(e.editingTextElement||e.newElement),l=!((c=e.selectedLinearElement)!=null&&c.isEditing)&&r.length===1&&Se(r[0])&&!ge(r[0]);return N("div",{className:"compact-shape-actions",children:[$y(e,r)&&g("div",{className:re("compact-action-item"),children:n("changeStrokeColor")}),Gy(e,r)&&g("div",{className:"compact-action-item",children:n("changeBackgroundColor")}),g(ZX,{appState:e,renderAction:n,setAppState:s,targetElements:r,container:o}),g(qX,{appState:e,renderAction:n,setAppState:s,targetElements:r,container:o,app:i}),l&&g("div",{className:"compact-action-item",children:n("toggleLinearEditor")}),(e.activeTool.type==="text"||r.some(de))&&N(fe,{children:[g("div",{className:"compact-action-item",children:n("changeFontFamily")}),g(QX,{appState:e,renderAction:n,setAppState:s,targetElements:r,container:o,elementsMap:t})]}),!a&&r.length>0&&g("div",{className:"compact-action-item",children:n("duplicateSelection")}),!a&&r.length>0&&g("div",{className:"compact-action-item",children:n("deleteSelectedElements")}),g(JX,{appState:e,renderAction:n,targetElements:r,setAppState:s,container:o,app:i})]})},Q8e=({appState:e,elementsMap:t,renderAction:n,app:i,setAppState:s})=>{var U,b;const r=J5(t,e),{container:o}=Lr(),a=D.useRef(null),l=((b=(U=a.current)==null?void 0:U.getBoundingClientRect())==null?void 0:b.width)??0,c=9,u=6,d=32,f=c*d+(c-1)*u,h=d+u,m=l>=f+h,p=l>=f+2*h;return N(vr,{className:"compact-shape-actions mobile-shape-actions",style:{flexDirection:"row",boxShadow:"none",padding:0,zIndex:2,backgroundColor:"transparent",height:d*1.35,marginBottom:4,alignItems:"center",gap:u,pointerEvents:"none"},ref:a,children:[N("div",{style:{display:"flex",flexDirection:"row",gap:u,flex:1},children:[$y(e,r)&&g("div",{className:re("compact-action-item"),children:n("changeStrokeColor")}),Gy(e,r)&&g("div",{className:"compact-action-item",children:n("changeBackgroundColor")}),g(ZX,{appState:e,renderAction:n,setAppState:s,targetElements:r,container:o}),g(qX,{appState:e,renderAction:n,setAppState:s,targetElements:r,container:o,app:i}),g(Z8e,{appState:e,renderAction:n,targetElements:r}),(e.activeTool.type==="text"||r.some(de))&&N(fe,{children:[g("div",{className:"compact-action-item",children:n("changeFontFamily")}),g(QX,{appState:e,renderAction:n,setAppState:s,targetElements:r,container:o,elementsMap:t})]}),g(JX,{appState:e,renderAction:n,targetElements:r,setAppState:s,container:o,app:i,showDuplicate:!p,showDelete:!m})]}),N("div",{style:{display:"flex",flexDirection:"row",gap:u},children:[g("div",{className:"compact-action-item",children:n("undo")}),g("div",{className:"compact-action-item",children:n("redo")}),p&&g("div",{className:"compact-action-item",children:n("duplicateSelection")}),m&&g("div",{className:"compact-action-item",children:n("deleteSelectedElements")})]})]})},J8e=({activeTool:e,setAppState:t,app:n,UIOptions:i})=>{const[s,r]=D.useState(!1),o=[{type:"selection",icon:ly,title:Mt(M("toolBar.selection"))},{type:"lasso",icon:T0,title:Mt(M("toolBar.lasso"))}],a=e.type==="frame",l=e.type==="laser",c=n.state.stylesPanelMode==="full"&&e.type==="lasso"&&n.state.preferredSelectionTool.type!=="lasso",u=e.type==="embeddable",{TTDDialogTriggerTunnel:d}=Ji();return N(fe,{children:[$X(n).map(({value:f,icon:h,key:m,numericKey:p,fillable:U},b)=>{var I;if(((I=i.tools)==null?void 0:I[f])===!1)return null;const y=M(`toolBar.${f}`),w=m&&Mt(typeof m=="string"?m:m[0]),v=w?`${w} ${M("helpDialog.or")} ${p}`:`${p}`;return(f==="selection"||f==="lasso")&&n.state.stylesPanelMode==="compact"?g(Q2,{app:n,options:o,activeTool:e,defaultOption:n.state.preferredSelectionTool.type,namePrefix:"selectionType",title:Mt(M("toolBar.selection")),"data-testid":"toolbar-selection",onToolChange:C=>{(C==="selection"||C==="lasso")&&(n.setActiveTool({type:C}),t({preferredSelectionTool:{type:C,initialized:!0}}))},displayedOption:o.find(C=>C.type===n.state.preferredSelectionTool.type)||o[0],fillable:e.type==="selection"},"selection-popover"):g($e,{className:re("Shape",{fillable:U}),type:"radio",icon:h,checked:e.type===f,name:"editor-current-shape",title:`${Mt(y)}  ${v}`,keyBindingLabel:p||w,"aria-label":Mt(y),"aria-keyshortcuts":v,"data-testid":`toolbar-${f}`,onPointerDown:({pointerType:C})=>{!n.state.penDetected&&C==="pen"&&n.togglePenMode(!0),f==="selection"&&(n.state.activeTool.type==="selection"?n.setActiveTool({type:"lasso"}):n.setActiveTool({type:"selection"}))},onChange:({pointerType:C})=>{n.state.activeTool.type!==f&&Qe("toolbar",f,"ui"),f==="image"?n.setActiveTool({type:f}):n.setActiveTool({type:f})}},f)}),g("div",{className:"App-toolbar__divider"}),N(Be,{open:s,children:[g(Be.Trigger,{className:re("App-toolbar__extra-tools-trigger",{"App-toolbar__extra-tools-trigger--selected":a||u||c||l&&!n.props.isCollaborating}),onToggle:()=>{r(!s),t({openMenu:null,openPopup:null})},title:M("toolBar.extraTools"),children:a?Qu:u?S6:l&&!n.props.isCollaborating?pm:c?T0:tv}),N(Be.Content,{onClickOutside:()=>r(!1),onSelect:()=>r(!1),className:"App-toolbar__extra-tools-dropdown",children:[g(Be.Item,{onSelect:()=>n.setActiveTool({type:"frame"}),icon:Qu,shortcut:H.F.toLocaleUpperCase(),"data-testid":"toolbar-frame",selected:a,children:M("toolBar.frame")}),g(Be.Item,{onSelect:()=>n.setActiveTool({type:"embeddable"}),icon:S6,"data-testid":"toolbar-embeddable",selected:u,children:M("toolBar.embeddable")}),g(Be.Item,{onSelect:()=>n.setActiveTool({type:"laser"}),icon:pm,"data-testid":"toolbar-laser",selected:l,shortcut:H.K.toLocaleUpperCase(),children:M("toolBar.laser")}),n.state.stylesPanelMode==="full"&&g(Be.Item,{onSelect:()=>n.setActiveTool({type:"lasso"}),icon:T0,"data-testid":"toolbar-lasso",selected:c,children:M("toolBar.lasso")}),g("div",{style:{margin:"6px 0",fontSize:14,fontWeight:600},children:"Generate"}),n.props.aiEnabled!==!1&&g(d.Out,{}),g(Be.Item,{onSelect:()=>n.setOpenDialog({name:"ttd",tab:"mermaid"}),icon:$_,"data-testid":"toolbar-embeddable",children:M("toolBar.mermaidToExcalidraw")}),n.props.aiEnabled!==!1&&n.plugins.diagramToCode&&N(Be.Item,{onSelect:()=>n.onMagicframeToolSelect(),icon:C6,"data-testid":"toolbar-magicframe",children:[M("toolBar.magicframe"),g(Be.Item.Badge,{children:"AI"})]})]})]})]})},e3e=({renderAction:e,zoom:t})=>g(Va.Col,{gap:1,className:Zs.ZOOM_ACTIONS,children:N(Va.Row,{align:"center",children:[e("zoomOut"),e("resetZoom"),e("zoomIn")]})}),t3e=({renderAction:e,className:t})=>N("div",{className:`undo-redo-buttons ${t}`,children:[g("div",{className:"undo-button-container",children:g(hl,{label:M("buttons.undo"),children:e("undo")})}),g("div",{className:"redo-button-container",children:N(hl,{label:M("buttons.redo"),children:[" ",e("redo")]})})]}),n3e=({actionManager:e,showExitZenModeBtn:t})=>g("button",{type:"button",className:re("disable-zen-mode",{"disable-zen-mode--visible":t}),onClick:()=>e.executeAction(Ev),children:M("buttons.exitZenMode")}),eD=e=>{const t=D.useRef({userFn:e});return t.current.userFn=e,t.current.stableFn||(t.current.stableFn=(...n)=>t.current.userFn(...n)),t.current.stableFn},Xy=Yt(null),i3e=()=>{const[e,t]=un(Xy),n=ks();return e&&e==="clearCanvas"?g(BX,{onConfirm:()=>{n.executeAction(S0),t(null)},onCancel:()=>t(null),title:M("clearCanvasDialog.title"),children:N("p",{className:"clear-canvas__content",children:[" ",M("alerts.clearReset")]})}):null},s3e={...N6,category:"App",label:"Toggle theme",perform:({actionManager:e})=>{e.executeAction(N6,"commandPalette")}},r3e=Object.freeze(Object.defineProperty({__proto__:null,toggleTheme:s3e},Symbol.toStringTag,{value:"Module"})),o3e=Yt(null),st={app:"App",export:"Export",tools:"Tools",editor:"Editor",elements:"Elements",links:"Links"},tD=e=>{switch(e){case st.app:return 1;case st.export:return 2;case st.editor:return 3;case st.tools:return 4;case st.elements:return 5;case st.links:return 6;default:return 10}},J2=({shortcut:e,className:t,children:n})=>{const i=e.replace("++","+$").split("+");return N("div",{className:re("shortcut",t),children:[i.map((s,r)=>g("div",{className:"shortcut-wrapper",children:g("div",{className:"shortcut-key",children:s==="$"?"+":s})},s)),g("div",{className:"shortcut-desc",children:n})]})},ej=e=>!e.altKey&&e[H.CTRL_OR_CMD]&&(e.shiftKey&&e.key.toLowerCase()===H.P||e.key===H.SLASH),nD=Object.assign(e=>{var i;const t=wi(),n=xn();return D.useEffect(()=>{const s=r=>{ej(r)&&(r.preventDefault(),r.stopPropagation(),n(o=>{var l;const a=((l=o.openDialog)==null?void 0:l.name)==="commandPalette"?null:{name:"commandPalette"};return a&&Qe("command_palette","open","shortcut"),{openDialog:a}}))};return window.addEventListener(te.KEYDOWN,s,{capture:!0}),()=>window.removeEventListener(te.KEYDOWN,s,{capture:!0})},[n]),((i=t.openDialog)==null?void 0:i.name)!=="commandPalette"?null:g(a3e,{...e})},{defaultItems:r3e});function a3e({customCommandPaletteItems:e}){const t=go(),n=wi(),i=xn(),s=Np(),r=ks(),[o,a]=un(o3e),[l,c]=D.useState(null),u=D.useRef(null),d=Uy({uiAppState:n,customCommandPaletteItems:e,appProps:s}),[f]=un(Kh),h=D.useMemo(()=>{var T;return((T=f.libraryItems)==null?void 0:T.filter(k=>!!k.name).map(k=>({label:k.name,icon:g(l3e,{id:k.id,elements:k.elements}),category:"Library",order:tD("Library"),haystack:k0(k.name),perform:()=>{t.onInsertElements(OT([k]))}})))||[]},[t,f.libraryItems]);D.useEffect(()=>{const{uiAppState:T,customCommandPaletteItems:k,appProps:S}=d,R=G=>{let z="";return G.label&&(typeof G.label=="function"?z=M(G.label(t.scene.getNonDeletedElements(),T,t)):z=M(G.label)),z},P=G=>typeof G.icon=="function"?G.icon(T,t.scene.getNonDeletedElements()):G.icon;let L=[];const X=(G,z,V)=>{const $={label:R(G),icon:P(G),category:z,shortcut:Ki(G.name),keywords:G.keywords,predicate:G.predicate,viewMode:G.viewMode,perform:()=>{r.executeAction(G,"commandPalette")}};return V?V($,G):$};if(T&&t.scene&&r){const G=[r.actions.group,r.actions.ungroup,r.actions.cut,r.actions.copy,r.actions.deleteSelectedElements,r.actions.wrapSelectionInFrame,r.actions.copyStyles,r.actions.pasteStyles,r.actions.bringToFront,r.actions.bringForward,r.actions.sendBackward,r.actions.sendToBack,r.actions.alignTop,r.actions.alignBottom,r.actions.alignLeft,r.actions.alignRight,r.actions.alignVerticallyCentered,r.actions.alignHorizontallyCentered,r.actions.duplicateSelection,r.actions.flipHorizontal,r.actions.flipVertical,r.actions.zoomToFitSelection,r.actions.zoomToFitSelectionInViewport,r.actions.increaseFontSize,r.actions.decreaseFontSize,r.actions.toggleLinearEditor,r.actions.cropEditor,r.actions.togglePolygon,vX,xX,aEe].map(Q=>X(Q,st.elements,(oe,me)=>({...oe,predicate:me.predicate?me.predicate:(he,Me,mt,We)=>Ve(he,Me).length>0}))),z=[r.actions.toggleHandTool,r.actions.setFrameAsActiveTool,r.actions.toggleLassoTool].map(Q=>X(Q,st.tools)),V=[r.actions.undo,r.actions.redo,r.actions.zoomIn,r.actions.zoomOut,r.actions.resetZoom,r.actions.zoomToFit,r.actions.zenMode,r.actions.viewMode,r.actions.gridMode,r.actions.objectsSnapMode,r.actions.toggleShortcuts,r.actions.selectAll,r.actions.toggleElementLock,r.actions.unlockAllElements,r.actions.stats].map(Q=>X(Q,st.editor)),$=[r.actions.saveToActiveFile,r.actions.saveFileToDisk,r.actions.copyAsPng,r.actions.copyAsSvg].map(Q=>X(Q,st.export));L=[...G,...V,{label:R(S0),icon:P(S0),shortcut:Ki(S0.name),category:st.editor,keywords:["delete","destroy"],viewMode:!1,perform:()=>{Hs.set(Xy,"clearCanvas")}},{label:M("buttons.exportImage"),category:st.export,icon:EV,shortcut:Ki("imageExport"),keywords:["export","image","png","jpeg","svg","clipboard","picture"],perform:()=>{i({openDialog:{name:"imageExport"}})}},...$];const j=[{label:M("toolBar.library"),category:st.app,icon:R_,viewMode:!1,perform:()=>{T.openSidebar?i({openSidebar:null}):i({openSidebar:{name:Ir.name,tab:Ir.defaultTab}})}},{label:M("search.title"),category:st.app,icon:pd,viewMode:!0,perform:()=>{r.executeAction(tj)}},{label:M("labels.shapeSwitch"),category:st.elements,icon:nv,perform:()=>{r.executeAction(oEe)}},{label:M("labels.changeStroke"),keywords:["color","outline"],category:st.elements,icon:z8,viewMode:!1,predicate:(Q,oe)=>{const me=Ve(Q,oe);return me.length>0&&$y(oe,me)},perform:()=>{i(Q=>({openPopup:"elementStroke"}))}},{label:M("labels.changeBackground"),keywords:["color","fill"],icon:z8,category:st.elements,viewMode:!1,predicate:(Q,oe)=>{const me=Ve(Q,oe);return me.length>0&&Gy(oe,me)},perform:()=>{i(Q=>({openPopup:"elementBackground"}))}},{label:M("labels.canvasBackground"),keywords:["color"],icon:z8,category:st.editor,viewMode:!1,perform:()=>{i(Q=>({openMenu:Q.openMenu==="canvas"?null:"canvas",openPopup:"canvasBackground"}))}},...Av.reduce((Q,oe)=>{var je;const{value:me,icon:he,key:Me,numericKey:mt}=oe;if(((je=S.UIOptions.tools)==null?void 0:je[me])===!1)return Q;const Ht=Me&&Mt(typeof Me=="string"?Me:Me[0])||mt,fn={label:M(`toolBar.${me}`),category:st.tools,shortcut:Ht,icon:he,keywords:["toolbar"],viewMode:!1,perform:({event:lt})=>{me==="image"?t.setActiveTool({type:me}):t.setActiveTool({type:me})}};return Q.push(fn),Q},[]),...z,{label:M("toolBar.lock"),category:st.tools,icon:T.activeTool.locked?D_:ay,shortcut:H.Q.toLocaleUpperCase(),viewMode:!1,perform:()=>{t.toggleLock()}},{label:`${M("labels.textToDiagram")}...`,category:st.tools,icon:gfe,viewMode:!1,predicate:S.aiEnabled,perform:()=>{i(Q=>({...Q,openDialog:{name:"ttd",tab:"text-to-diagram"}}))}},{label:`${M("toolBar.mermaidToExcalidraw")}...`,category:st.tools,icon:$_,viewMode:!1,predicate:S.aiEnabled,perform:()=>{i(Q=>({...Q,openDialog:{name:"ttd",tab:"mermaid"}}))}}],W=[...L,...j,...k||[]].map(Q=>{var oe;return{...Q,icon:Q.icon||nv,order:Q.order??tD(Q.category),haystack:`${k0(Q.label.toLocaleLowerCase())} ${((oe=Q.keywords)==null?void 0:oe.join(" "))||""}`}});c(W),a([...W,...h].find(Q=>Q.label===(o==null?void 0:o.label))??null)}},[d,t,r,c,o==null?void 0:o.label,a,i,h]);const[m,p]=D.useState(""),[U,b]=D.useState(null),[y,w]=D.useState({}),v=T=>{i({openDialog:null},T),p("")},I=(T,k)=>{var S;((S=n.openDialog)==null?void 0:S.name)==="commandPalette"&&(k.stopPropagation(),k.preventDefault(),document.body.classList.add("excalidraw-animations-disabled"),v(()=>{T.perform({actionManager:r,event:k}),a(T),requestAnimationFrame(()=>{document.body.classList.remove("excalidraw-animations-disabled")})}))},C=eD(T=>T.viewMode===!1&&n.viewModeEnabled?!1:typeof T.predicate=="function"?T.predicate(t.scene.getNonDeletedElements(),n,s,t):T.predicate===void 0||T.predicate),_=eD(T=>{var P;const k=ka(T.target)||ej(T)||T.key===H.ESCAPE;if(k&&T.key!==H.ARROW_UP&&T.key!==H.ARROW_DOWN&&T.key!==H.ENTER)return;const S=Object.values(y).flat(),R=o&&!m&&C(o);if(T.key===H.ARROW_UP){T.preventDefault();const L=S.findIndex(z=>z.label===(U==null?void 0:U.label));if(R){if(L===0){b(o);return}if(U===o){const z=S[S.length-1];z&&b(z);return}}let X;L===-1?X=S.length-1:X=L===0?S.length-1:(L-1)%S.length;const G=S[X];G&&b(G);return}if(T.key===H.ARROW_DOWN){T.preventDefault();const L=S.findIndex(z=>z.label===(U==null?void 0:U.label));if(R){if(!U||L===S.length-1){b(o);return}if(U===o){const z=S[0];z&&b(z);return}}const X=(L+1)%S.length,G=S[X];G&&b(G);return}if(T.key===H.ENTER&&U&&setTimeout(()=>{I(U,T)}),!k){if(T.stopPropagation(),/^[a-zA-Z0-9]$/.test(T.key)){(P=u==null?void 0:u.current)==null||P.focus();return}T.preventDefault()}});return D.useEffect(()=>(window.addEventListener(te.KEYDOWN,_,{capture:!0}),()=>window.removeEventListener(te.KEYDOWN,_,{capture:!0})),[_]),D.useEffect(()=>{if(!l)return;const T=P=>{const L={};for(const X of P)L[X.category]?L[X.category].push(X):L[X.category]=[X];return L};let k=(m==null?void 0:m.length)>1?[...l.filter(C).sort((P,L)=>P.order-L.order),...h]:l.filter(C).sort((P,L)=>P.order-L.order);const S=!m&&o&&C(o);if(!m){w(T(S?k.filter(P=>P.label!==(o==null?void 0:o.label)):k)),b(S?o:k[0]||null);return}const R=k0(m.toLocaleLowerCase().replace(/[<>_| -]/g,""));k=Wye.filter(R,k,{extract:P=>P.haystack??""}).sort((P,L)=>L.score-P.score).map(P=>P.original),w(T(k)),b(k[0]??null)},[m,l,C,o,h]),N(ir,{onCloseRequest:()=>v(),closeOnClickOutside:!0,title:!1,size:720,autofocus:!0,className:"command-palette-dialog",children:[g(Id,{value:m,placeholder:M("commandPalette.search.placeholder"),onChange:T=>{p(T)},selectOnRender:!0,ref:u}),!t.device.viewport.isMobile&&N("div",{className:"shortcuts-wrapper",children:[g(J2,{shortcut:"",children:M("commandPalette.shortcuts.select")}),g(J2,{shortcut:"",children:M("commandPalette.shortcuts.confirm")}),g(J2,{shortcut:J("Esc"),children:M("commandPalette.shortcuts.close")})]}),N("div",{className:"commands",children:[o&&!m&&N("div",{className:"command-category",children:[N("div",{className:"command-category-title",children:[M("commandPalette.recents"),g("div",{className:"icon",style:{marginLeft:"6px"},children:mfe})]}),g(iD,{command:o,isSelected:o.label===(U==null?void 0:U.label),onClick:T=>I(o,T),disabled:!C(o),onMouseMove:()=>b(o),showShortcut:!t.device.viewport.isMobile,appState:n})]}),Object.keys(y).length>0?Object.keys(y).map((T,k)=>N("div",{className:"command-category",children:[g("div",{className:"command-category-title",children:T}),y[T].map(S=>g(iD,{command:S,isSelected:S.label===(U==null?void 0:U.label),onClick:R=>I(S,R),onMouseMove:()=>b(S),showShortcut:!t.device.viewport.isMobile,appState:n,size:T==="Library"?"large":"small"},S.label))]},T)):l?N("div",{className:"no-match",children:[g("div",{className:"icon",children:pd})," ",M("commandPalette.search.noMatch")]}):null]})]})}const l3e=({id:e,elements:t})=>{const n=D.useRef(null),{svgCache:i}=NT();return NX(e,t,i,n),g("div",{className:"library-item-icon",ref:n})},iD=({command:e,isSelected:t,disabled:n,onMouseMove:i,onClick:s,showShortcut:r,appState:o,size:a="small"})=>{const l=()=>{};return N("div",{className:re("command-item",{"item-selected":t,"item-disabled":n,"command-item-large":a==="large"}),ref:c=>{var u;t&&!n&&((u=c==null?void 0:c.scrollIntoView)==null||u.call(c,{block:"nearest"}))},onClick:n?l:s,onMouseMove:n?l:i,title:n?M("commandPalette.itemNotAvailable"):"",children:[N("div",{className:"name",children:[e.icon&&g(wy,{className:"icon",size:"var(--icon-size, 1rem)",icon:typeof e.icon=="function"?e.icon(o):e.icon}),g(P$,{children:e.label})]}),r&&e.shortcut&&g(J2,{shortcut:e.shortcut})]})},e2=ce({name:"toggleLinearEditor",category:st.elements,label:(e,t,n)=>{const i=n.scene.getSelectedElements({selectedElementIds:t.selectedElementIds})[0];return(i==null?void 0:i.type)==="arrow"?"labels.lineEditor.editArrow":"labels.lineEditor.edit"},keywords:["line"],trackEvent:{category:"element"},predicate:(e,t,n,i)=>{var r;const s=i.scene.getSelectedElements(t);return!!(!((r=t.selectedLinearElement)!=null&&r.isEditing)&&s.length===1&&Se(s[0])&&!ge(s[0]))},perform(e,t,n,i){const s=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0})[0];gn(s,"No selected element found"),gn(t.selectedLinearElement,"No selected linear element found"),gn(s.id===t.selectedLinearElement.elementId,"Selected element ID and linear editor elementId does not match");const r={...t.selectedLinearElement,isEditing:!t.selectedLinearElement.isEditing};return{appState:{...t,selectedLinearElement:r},captureUpdate:K.IMMEDIATELY}},PanelComponent:({appState:e,updateData:t,app:n})=>{const i=n.scene.getSelectedElements({selectedElementIds:e.selectedElementIds})[0];if(!i)return null;const s=M(i.type==="arrow"?"labels.lineEditor.editArrow":"labels.lineEditor.edit");return g($e,{type:"button",icon:Cfe,title:s,"aria-label":s,onClick:()=>t(null)})}});ce({name:"togglePolygon",category:st.elements,icon:OM,keywords:["loop"],label:(e,t,n)=>!n.scene.getSelectedElements({selectedElementIds:t.selectedElementIds}).some(r=>!tn(r)||!r.polygon)?"labels.polygon.breakPolygon":"labels.polygon.convertToPolygon",trackEvent:{category:"element"},predicate:(e,t,n,i)=>{const s=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds});return s.length>0&&s.every(r=>tn(r)&&r.points.length>=4)},perform(e,t,n,i){const s=i.scene.getSelectedElements(t);if(s.some(l=>!tn(l)))return!1;const r=s,o=r.some(l=>!l.polygon),a=ve(r);return{elements:e.map(l=>!a.has(l.id)||!tn(l)?l:Te(l,{backgroundColor:o?l.backgroundColor:"transparent",...p_(l,o)})),appState:t,captureUpdate:K.IMMEDIATELY}},PanelComponent:({appState:e,updateData:t,app:n})=>{const i=n.scene.getSelectedElements({selectedElementIds:e.selectedElementIds});if(i.length===0||i.some(o=>!tn(o)||!o.polygon||o.points.length<3))return null;const s=i.every(o=>tn(o)&&o.polygon),r=M(s?"labels.polygon.breakPolygon":"labels.polygon.convertToPolygon");return g(K_,{icon:OM,title:r,"aria-label":r,active:s,onClick:()=>t(null),style:{marginLeft:"auto"}})}});const tj=ce({name:"searchMenu",icon:pd,keywords:["search","find"],label:"search.title",viewMode:!0,trackEvent:{category:"search_menu",action:"toggle",predicate:e=>e.gridModeEnabled},perform(e,t,n,i){var s,r;if(t.openDialog)return!1;if(((s=t.openSidebar)==null?void 0:s.name)===Ir.name&&t.openSidebar.tab===Wu){const o=(r=i.excalidrawContainerValue.container)==null?void 0:r.querySelector(`.${Zs.SEARCH_MENU_INPUT_WRAPPER} input`);return o==null||o.focus(),o==null||o.select(),!1}return{appState:{...t,openSidebar:{name:Ir.name,tab:Wu},openDialog:null},captureUpdate:K.EVENTUALLY}},checked:e=>e.gridModeEnabled,predicate:(e,t,n)=>n.gridModeEnabled===void 0,keyTest:e=>e[H.CTRL_OR_CMD]&&e.key===H.F}),c3e=ce({name:"cropEditor",label:"helpDialog.cropStart",icon:tk,viewMode:!0,trackEvent:{category:"menu"},keywords:["image","crop"],perform(e,t,n,i){const s=i.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!0})[0];return{appState:{...t,isCropping:!1,croppingElementId:s.id},captureUpdate:K.IMMEDIATELY}},predicate:(e,t,n,i)=>{const s=i.scene.getSelectedElements(t);return!!(!t.croppingElementId&&s.length===1&&yt(s[0]))},PanelComponent:({appState:e,updateData:t,app:n})=>{const i=M("helpDialog.cropStart");return g($e,{type:"button",icon:tk,title:i,"aria-label":i,onClick:()=>t(null)})}}),nj=(e,t)=>{const n=t.scene.getSelectedElements(e);return n.length===1&&Ee(n[0])},u3e=ce({name:"selectAllElementsInFrame",label:"labels.selectAllElementsInFrame",trackEvent:{category:"canvas"},perform:(e,t,n,i)=>{const s=i.scene.getSelectedElements(t).at(0)||null;if(Ee(s)){const r=Js(jt(e),s.id).filter(o=>!(o.type==="text"&&o.containerId));return{elements:e,appState:{...t,selectedElementIds:r.reduce((o,a)=>(o[a.id]=!0,o),{})},captureUpdate:K.IMMEDIATELY}}return{elements:e,appState:t,captureUpdate:K.EVENTUALLY}},predicate:(e,t,n,i)=>nj(t,i)}),d3e=ce({name:"removeAllElementsFromFrame",label:"labels.removeAllElementsFromFrame",trackEvent:{category:"history"},perform:(e,t,n,i)=>{const s=i.scene.getSelectedElements(t).at(0)||null;return Ee(s)?{elements:Iz(e,s),appState:{...t,selectedElementIds:{[s.id]:!0}},captureUpdate:K.IMMEDIATELY}:{elements:e,appState:t,captureUpdate:K.EVENTUALLY}},predicate:(e,t,n,i)=>nj(t,i)});ce({name:"updateFrameRendering",label:"labels.updateFrameRendering",viewMode:!0,trackEvent:{category:"canvas"},perform:(e,t)=>({elements:e,appState:{...t,frameRendering:{...t.frameRendering,enabled:!t.frameRendering.enabled}},captureUpdate:K.EVENTUALLY}),checked:e=>e.frameRendering.enabled});ce({name:"setFrameAsActiveTool",label:"toolBar.frame",trackEvent:{category:"toolbar"},icon:Qu,viewMode:!1,perform:(e,t,n,i)=>{const s=en(t,{type:"frame"});return _o(i.interactiveCanvas,{...t,activeTool:s}),{elements:e,appState:{...t,activeTool:en(t,{type:"frame"})},captureUpdate:K.EVENTUALLY}},keyTest:e=>!e[H.CTRL_OR_CMD]&&!e.shiftKey&&!e.altKey&&e.key.toLocaleLowerCase()===H.F});const f3e=ce({name:"wrapSelectionInFrame",label:"labels.wrapSelectionInFrame",trackEvent:{category:"element"},predicate:(e,t,n,i)=>{const s=Ve(e,t);return s.length>0&&!s.some(r=>Ee(r))},perform:(e,t,n,i)=>{const s=Ve(e,t),r=i.scene.getNonDeletedElementsMap(),[o,a,l,c]=ft(s,r),u=16,d=__({x:o-u,y:a-u,width:l-o+u*2,height:c-a+u*2});if(t.editingGroupId){const h=Ct(s,t.editingGroupId);for(const m of h){const p=m.groupIds.indexOf(t.editingGroupId);vi(m,r,{groupIds:m.groupIds.slice(0,p)})}}return{elements:y0([...i.scene.getElementsIncludingDeleted(),d],s,d,t),appState:{selectedElementIds:{[d.id]:!0}},captureUpdate:K.IMMEDIATELY}}});class t2 extends md{applyTo(t,n,i){const[s,r]=this.elements.applyTo(t,i.elements,{excludedProperties:new Set(["version","versionNonce"])}),[o,a]=this.appState.applyTo(n,s);return[s,o,r||a]}static calculate(t,n){return super.calculate(t,n)}static inverse(t){return super.inverse(t)}static applyLatestChanges(t,n,i,s){return super.applyLatestChanges(t,n,i,s)}}class j6{constructor(t=!0,n=!0){this.isUndoStackEmpty=t,this.isRedoStackEmpty=n}}class Fu{constructor(t){F(this,"onHistoryChangedEmitter",new $r);F(this,"undoStack",[]);F(this,"redoStack",[]);this.store=t}get isUndoStackEmpty(){return this.undoStack.length===0}get isRedoStackEmpty(){return this.redoStack.length===0}clear(){this.undoStack.length=0,this.redoStack.length=0}record(t){if(t.isEmpty()||t instanceof t2)return;const n=t2.inverse(t);this.undoStack.push(n),n.elements.isEmpty()||(this.redoStack.length=0),this.onHistoryChangedEmitter.trigger(new j6(this.isUndoStackEmpty,this.isRedoStackEmpty))}undo(t,n){return this.perform(t,n,()=>Fu.pop(this.undoStack),i=>Fu.push(this.redoStack,i))}redo(t,n){return this.perform(t,n,()=>Fu.pop(this.redoStack),i=>Fu.push(this.undoStack,i))}perform(t,n,i,s){try{let r=i();if(r===null)return;const o=K.IMMEDIATELY;let a=this.store.snapshot,l=t,c=n,u=!1;for(;r;){try{[l,c,u]=r.applyTo(l,c,a);const d=a.elements,f=a.maybeClone(o,l,c),h=ah.create(a,f),m=t2.applyLatestChanges(r,d,l);m.isEmpty()||(this.store.scheduleMicroAction({action:o,change:h,delta:m}),r=m),a=f}finally{s(r)}if(u)break;r=i()}return[l,c]}finally{this.onHistoryChangedEmitter.trigger(new j6(this.isUndoStackEmpty,this.isRedoStackEmpty))}}static pop(t){if(!t.length)return null;const n=t.pop();return n!==void 0?n:null}static push(t,n){const i=t2.inverse(n);return t.push(i)}}const ij=(e,t)=>{const[n,i]=D.useState(t);return D.useEffect(()=>{const s=e.on(r=>{i(r)});return()=>{s()}},[e]),n},sj=(e,t,n)=>{if(!t.multiElement&&!t.resizingElement&&!t.editingTextElement&&!t.newElement&&!t.selectedElementsAreBeingDragged&&!t.selectionElement&&!e.flowChartCreator.isCreatingChart){const i=n();if(!i)return{captureUpdate:K.EVENTUALLY};const[s,r]=i,o=v_(Array.from(s.values()));return{appState:r,elements:o,captureUpdate:K.NEVER}}return{captureUpdate:K.EVENTUALLY}},h3e=e=>({name:"undo",label:"buttons.undo",icon:zM,trackEvent:{category:"history"},viewMode:!1,perform:(t,n,i,s)=>sj(s,n,()=>e.undo(ve(t),n)),keyTest:t=>t[H.CTRL_OR_CMD]&&h4(t,H.Z)&&!t.shiftKey,PanelComponent:({appState:t,updateData:n,data:i})=>{const{isUndoStackEmpty:s}=ij(e.onHistoryChangedEmitter,new j6(e.isUndoStackEmpty,e.isRedoStackEmpty));return g($e,{type:"button",icon:zM,"aria-label":M("buttons.undo"),onClick:n,size:(i==null?void 0:i.size)||"medium",disabled:s,"data-testid":"button-undo",style:{...t.stylesPanelMode==="mobile"?dp:{}}})}}),g3e=e=>({name:"redo",label:"buttons.redo",icon:HM,trackEvent:{category:"history"},viewMode:!1,perform:(t,n,i,s)=>sj(s,n,()=>e.redo(ve(t),n)),keyTest:t=>t[H.CTRL_OR_CMD]&&t.shiftKey&&h4(t,H.Z)||qF&&t.ctrlKey&&!t.shiftKey&&h4(t,H.Y),PanelComponent:({appState:t,updateData:n,data:i})=>{const{isRedoStackEmpty:s}=ij(e.onHistoryChangedEmitter,new j6(e.isUndoStackEmpty,e.isRedoStackEmpty));return g($e,{type:"button",icon:HM,"aria-label":M("buttons.redo"),onClick:n,size:(i==null?void 0:i.size)||"medium",disabled:s,"data-testid":"button-redo",style:{...t.stylesPanelMode==="mobile"?dp:{}}})}}),m3e=ce({name:"autoResize",label:"labels.autoResize",icon:null,trackEvent:{category:"element"},predicate:(e,t,n,i)=>{const s=Ve(e,t);return s.length===1&&de(s[0])&&!s[0].autoResize},perform:(e,t,n,i)=>{const s=Ve(e,t);return{appState:t,elements:e.map(r=>{if(r.id===s[0].id&&de(r)){const o=Xn(r.originalText,gt(r),r.lineHeight);return Te(r,{autoResize:!0,width:o.width,height:o.height,text:r.originalText})}return r}),captureUpdate:K.IMMEDIATELY}}}),sD=ce({name:"viewMode",label:"labels.viewMode",icon:G_,viewMode:!0,trackEvent:{category:"canvas",predicate:e=>!e.viewModeEnabled},perform(e,t){return{appState:{...t,viewModeEnabled:!this.checked(t)},captureUpdate:K.EVENTUALLY}},checked:e=>e.viewModeEnabled,predicate:(e,t,n)=>typeof n.viewModeEnabled>"u",keyTest:e=>!e[H.CTRL_OR_CMD]&&e.altKey&&e.code===tt.R}),_3=(e,t,n,i,s,r)=>{if(e.trackEvent)try{typeof e.trackEvent=="object"&&(!e.trackEvent.predicate||e.trackEvent.predicate(n,i,r))&&Qe(e.trackEvent.category,e.trackEvent.action||e.name,`${t} (${s.device.editor.isMobile?"mobile":"desktop"})`)}catch(o){console.error("error while logging action:",o)}};class p3e{constructor(t,n,i,s){F(this,"actions",{});F(this,"updater");F(this,"getAppState");F(this,"getElementsIncludingDeleted");F(this,"app");F(this,"renderAction",(t,n)=>{const i=this.app.props.UIOptions.canvasActions;if(this.actions[t]&&"PanelComponent"in this.actions[t]&&(!(t in i)||i[t])){const s=this.actions[t],r=s.PanelComponent;r.displayName="PanelComponent";const o=this.getElementsIncludingDeleted(),a=this.getAppState(),l=c=>{_3(s,"ui",a,o,this.app,c),this.updater(s.perform(this.getElementsIncludingDeleted(),this.getAppState(),c,this.app))};return g(r,{elements:this.getElementsIncludingDeleted(),appState:this.getAppState(),updateData:l,appProps:this.app.props,app:this.app,data:n,renderAction:this.renderAction})}return null});F(this,"isActionEnabled",t=>{const n=this.getElementsIncludingDeleted(),i=this.getAppState();return!t.predicate||t.predicate(n,i,this.app.props,this.app)});this.updater=r=>{if(mp(r))r.then(o=>t(o));else return t(r)},this.getAppState=n,this.getElementsIncludingDeleted=i,this.app=s}registerAction(t){this.actions[t.name]=t}registerAll(t){t.forEach(n=>this.registerAction(n))}handleKeyDown(t){const n=this.app.props.UIOptions.canvasActions,i=Object.values(this.actions).sort((l,c)=>(c.keyPriority||0)-(l.keyPriority||0)).filter(l=>(l.name in n?n[l.name]:!0)&&l.keyTest&&l.keyTest(t,this.getAppState(),this.getElementsIncludingDeleted(),this.app));if(i.length!==1)return i.length>1&&console.warn("Canceling as multiple actions match this shortcut",i),!1;const s=i[0];if(this.getAppState().viewModeEnabled&&s.viewMode!==!0)return!1;const r=this.getElementsIncludingDeleted(),o=this.getAppState(),a=null;return _3(s,"keyboard",o,r,this.app,null),t.preventDefault(),t.stopPropagation(),this.updater(i[0].perform(r,o,a,this.app)),!0}executeAction(t,n="api",i=null){const s=this.getElementsIncludingDeleted(),r=this.getAppState();_3(t,n,r,s,this.app,i),this.updater(t.perform(s,r,i,this.app))}}class U3e{constructor(){F(this,"targets",new WeakMap);F(this,"rafIds",new WeakMap)}register(t,n){this.targets.set(t,{callback:n,stopped:!0})}start(t){const n=this.targets.get(t);n&&(this.rafIds.has(t)||(this.targets.set(t,{...n,stopped:!1}),this.scheduleFrame(t)))}stop(t){const n=this.targets.get(t);n&&!n.stopped&&this.targets.set(t,{...n,stopped:!0}),this.cancelFrame(t)}constructFrame(t){return n=>{const i=this.targets.get(t);if(!i)return;const s=this.onFrame(i,n);!i.stopped&&!s?this.scheduleFrame(t):this.cancelFrame(t)}}scheduleFrame(t){const n=requestAnimationFrame(this.constructFrame(t));this.rafIds.set(t,n)}cancelFrame(t){if(this.rafIds.has(t)){const n=this.rafIds.get(t);cancelAnimationFrame(n)}this.rafIds.delete(t)}onFrame(t,n){return t.callback(n)??!1}}const rD=e=>{const t=Array.from(e.values());return{x:aD(t,n=>n.x)/t.length,y:aD(t,n=>n.y)/t.length}},oD=([e,t])=>Math.hypot(e.x-t.x,e.y-t.y),aD=(e,t)=>e.reduce((n,i)=>n+t(i),0),b3e=8,lD=99999,jy=e=>b3e/e,is=class is{};F(is,"referenceSnapPoints",null),F(is,"visibleGaps",null),F(is,"setReferenceSnapPoints",t=>{is.referenceSnapPoints=t}),F(is,"getReferenceSnapPoints",()=>is.referenceSnapPoints),F(is,"setVisibleGaps",t=>{is.visibleGaps=t}),F(is,"getVisibleGaps",()=>is.visibleGaps),F(is,"destroy",()=>{is.referenceSnapPoints=null,is.visibleGaps=null});let Gr=is;const Nm=e=>e.props.gridModeEnabled??e.state.gridModeEnabled,jc=({event:e,app:t,selectedElements:n})=>{if(e){const i=t.state.activeTool.type==="lasso"&&t.state.selectedElementsAreBeingDragged;return(t.state.activeTool.type!=="lasso"||i)&&(t.state.objectsSnapModeEnabled&&!e[H.CTRL_OR_CMD]||!t.state.objectsSnapModeEnabled&&e[H.CTRL_OR_CMD]&&!Nm(t))}return n.length===1&&n[0].type==="arrow"?!1:t.state.objectsSnapModeEnabled},y3e=(e,t,n=.01)=>Math.abs(e-t)<=n,Om=(e,t,{omitCenter:n,boundingBoxCorners:i,dragOffset:s}={omitCenter:!1,boundingBoxCorners:!1})=>{let r=[];if(e.length===1){const o=e[0];let[a,l,c,u,d,f]=ze(o,t);s&&(a+=s.x,c+=s.x,d+=s.x,l+=s.y,u+=s.y,f+=s.y);const h=(c-a)/2,m=(u-l)/2;if((o.type==="diamond"||o.type==="ellipse")&&!i){const p=q(x(a,l+m),x(d,f),o.angle),U=q(x(a+h,l),x(d,f),o.angle),b=q(x(c,l+m),x(d,f),o.angle),y=q(x(a+h,u),x(d,f),o.angle),w=x(d,f);r=n?[p,U,b,y]:[p,U,b,y,w]}else{const p=q(x(a,l),x(d,f),o.angle),U=q(x(c,l),x(d,f),o.angle),b=q(x(a,u),x(d,f),o.angle),y=q(x(c,u),x(d,f),o.angle),w=x(d,f);r=n?[p,U,b,y]:[p,U,b,y,w]}}else if(e.length>1){const[o,a,l,c]=y_(e,s??{x:0,y:0}),u=l-o,d=c-a,f=x(o,a),h=x(l,a),m=x(o,c),p=x(l,c),U=x(o+u/2,a+d/2);r=n?[f,h,m,p]:[f,h,m,p,U]}return r.map(o=>x(an(o[0]),an(o[1])))},rj=(e,t,n,i)=>wz(e,t,n,i),E3e=(e,t,n,i)=>{const s=rj(e,t,n,i),r=vz(s,i).filter(d=>!(d.length===1&&zt(d[0]))).map(d=>ft(d).map(f=>an(f))),o=r.sort((d,f)=>d[0]-f[0]),a=[];let l=0;e:for(let d=0;d<o.length;d++){const f=o[d];for(let h=d+1;h<o.length;h++){if(++l>lD)break e;const m=o[h],[,p,U,b]=f,[y,w,,v]=m;U<y&&Zb(Hi(p,b),Hi(w,v))&&a.push({startBounds:f,endBounds:m,startSide:[x(U,p),x(U,b)],endSide:[x(y,w),x(y,v)],length:y-U,overlap:qb(Hi(p,b),Hi(w,v))})}}const c=r.sort((d,f)=>d[1]-f[1]),u=[];l=0;e:for(let d=0;d<c.length;d++){const f=c[d];for(let h=d+1;h<c.length;h++){if(++l>lD)break e;const m=c[h],[p,,U,b]=f,[y,w,v]=m;b<w&&Zb(Hi(p,U),Hi(y,v))&&u.push({startBounds:f,endBounds:m,startSide:[x(p,b),x(U,b)],endSide:[x(y,w),x(v,w)],length:w-b,overlap:qb(Hi(p,U),Hi(y,v))})}}return{horizontalGaps:a,verticalGaps:u}},cD=(e,t,n,i,s,r,o)=>{if(!jc({app:n,event:i,selectedElements:e}))return[];if(e.length===0)return[];const a=Gr.getVisibleGaps();if(a){const{horizontalGaps:l,verticalGaps:c}=a,[u,d,f,h]=y_(e,t).map(U=>an(U)),m=(u+f)/2,p=(d+h)/2;for(const U of l){if(!Zb(Hi(d,h),U.overlap))continue;const b=U.startSide[0][0]+U.length/2,y=an(b-m);if(U.length>f-u&&Math.abs(y)<=o.x){Math.abs(y)<o.x&&(s.length=0),o.x=Math.abs(y);const S={type:"gap",direction:"center_horizontal",gap:U,offset:y};s.push(S);continue}const[,,v]=U.endBounds,I=u-v,C=an(U.length-I);if(Math.abs(C)<=o.x){Math.abs(C)<o.x&&(s.length=0),o.x=Math.abs(C);const S={type:"gap",direction:"side_right",gap:U,offset:C};s.push(S);continue}const[_,,,]=U.startBounds,T=_-f,k=an(T-U.length);if(Math.abs(k)<=o.x){Math.abs(k)<o.x&&(s.length=0),o.x=Math.abs(k);const S={type:"gap",direction:"side_left",gap:U,offset:k};s.push(S);continue}}for(const U of c){if(!Zb(Hi(u,f),U.overlap))continue;const b=U.startSide[0][1]+U.length/2,y=an(b-p);if(U.length>h-d&&Math.abs(y)<=o.y){Math.abs(y)<o.y&&(r.length=0),o.y=Math.abs(y);const S={type:"gap",direction:"center_vertical",gap:U,offset:y};r.push(S);continue}const[,v,,]=U.startBounds,I=v-h,C=an(I-U.length);if(Math.abs(C)<=o.y){Math.abs(C)<o.y&&(r.length=0),o.y=Math.abs(C);const S={type:"gap",direction:"side_top",gap:U,offset:C};r.push(S);continue}const[,,,_]=U.endBounds,T=an(d-_),k=U.length-T;if(Math.abs(k)<=o.y){Math.abs(k)<o.y&&(r.length=0),o.y=Math.abs(k);const S={type:"gap",direction:"side_bottom",gap:U,offset:k};r.push(S);continue}}}},v3e=(e,t,n,i)=>{const s=rj(e,t,n,i);return vz(s,i).filter(r=>!(r.length===1&&zt(r[0]))).flatMap(r=>Om(r,i))},Qh=(e,t,n,i,s,r,o)=>{if(!jc({app:n,event:i,selectedElements:e})||e.length===0&&t.length===0)return[];const a=Gr.getReferenceSnapPoints();if(a)for(const l of t)for(const c of a){const u=c[0]-l[0],d=c[1]-l[1];Math.abs(u)<=o.x&&(Math.abs(u)<o.x&&(s.length=0),s.push({type:"point",points:[l,c],offset:u}),o.x=Math.abs(u)),Math.abs(d)<=o.y&&(Math.abs(d)<o.y&&(r.length=0),r.push({type:"point",points:[l,c],offset:d}),o.y=Math.abs(d))}},w3e=(e,t,n,i,s)=>{var U,b;const r=n.state,o=Ve(e,r);if(!jc({app:n,event:i,selectedElements:o})||o.length===0)return{snapOffset:{x:0,y:0},snapLines:[]};t.x=an(t.x),t.y=an(t.y);const a=[],l=[],c=jy(r.zoom.value),u={x:c,y:c},d=Om(o,s,{dragOffset:t});Qh(o,d,n,i,a,l,u),cD(o,t,n,i,a,l,u);const f={x:((U=a[0])==null?void 0:U.offset)??0,y:((b=l[0])==null?void 0:b.offset)??0};u.x=0,u.y=0,a.length=0,l.length=0;const h={x:an(t.x+f.x),y:an(t.y+f.y)};Qh(o,Om(o,s,{dragOffset:h}),n,i,a,l,u),cD(o,h,n,i,a,l,u);const m=BT(a,l),p=T3e(o,h,[...a,...l].filter(y=>y.type==="gap"));return{snapOffset:f,snapLines:[...m,...p]}},an=e=>Math.round(e*10**6)/10**6,uD=e=>{const t=new Map;for(const n of e){const i=n.join(",");t.has(i)||t.set(i,n)}return Array.from(t.values())},BT=(e,t)=>{const n={},i={};if(e.length>0){for(const s of e)if(s.type==="point"){const r=an(s.points[0][0]);n[r]||(n[r]=[]),n[r].push(...s.points.map(o=>x(an(o[0]),an(o[1]))))}}if(t.length>0){for(const s of t)if(s.type==="point"){const r=an(s.points[0][1]);i[r]||(i[r]=[]),i[r].push(...s.points.map(o=>x(an(o[0]),an(o[1]))))}}return Object.entries(n).map(([s,r])=>({type:"points",points:uD(r.map(o=>x(Number(s),o[1])).sort((o,a)=>o[1]-a[1]))})).concat(Object.entries(i).map(([s,r])=>({type:"points",points:uD(r.map(o=>x(o[0],Number(s))).sort((o,a)=>o[0]-a[0]))})))},_3e=e=>{const t=new Map;for(const n of e){const i=n.points.flat().map(s=>[an(s)]).join(",");t.has(i)||t.set(i,n)}return Array.from(t.values())},T3e=(e,t,n)=>{const[i,s,r,o]=y_(e,t),a=[];for(const l of n){const[c,u,d,f]=l.gap.startBounds,[h,m,p,U]=l.gap.endBounds,b=qb(Hi(s,o),l.gap.overlap),y=qb(Hi(i,r),l.gap.overlap);switch(l.direction){case"center_horizontal":{if(b){const w=(b[0]+b[1])/2;a.push({type:"gap",direction:"horizontal",points:[x(l.gap.startSide[0][0],w),x(i,w)]},{type:"gap",direction:"horizontal",points:[x(r,w),x(l.gap.endSide[0][0],w)]})}break}case"center_vertical":{if(y){const w=(y[0]+y[1])/2;a.push({type:"gap",direction:"vertical",points:[x(w,l.gap.startSide[0][1]),x(w,s)]},{type:"gap",direction:"vertical",points:[x(w,o),x(w,l.gap.endSide[0][1])]})}break}case"side_right":{if(b){const w=(b[0]+b[1])/2;a.push({type:"gap",direction:"horizontal",points:[x(d,w),x(h,w)]},{type:"gap",direction:"horizontal",points:[x(p,w),x(i,w)]})}break}case"side_left":{if(b){const w=(b[0]+b[1])/2;a.push({type:"gap",direction:"horizontal",points:[x(r,w),x(c,w)]},{type:"gap",direction:"horizontal",points:[x(d,w),x(h,w)]})}break}case"side_top":{if(y){const w=(y[0]+y[1])/2;a.push({type:"gap",direction:"vertical",points:[x(w,o),x(w,u)]},{type:"gap",direction:"vertical",points:[x(w,f),x(w,m)]})}break}case"side_bottom":{if(y){const w=(y[0]+y[1])/2;a.push({type:"gap",direction:"vertical",points:[x(w,f),x(w,m)]},{type:"gap",direction:"vertical",points:[x(w,U),x(w,s)]})}break}}}return _3e(a.map(l=>({...l,points:l.points.map(c=>x(an(c[0]),an(c[1])))})))},dD=(e,t,n,i,s,r)=>{var C,_;if(!jc({event:i,selectedElements:e,app:n})||e.length===0||e.length===1&&!y3e(e[0].angle,0))return{snapOffset:{x:0,y:0},snapLines:[]};let[o,a,l,c]=ft(t);r&&(r.includes("e")?l+=s.x:r.includes("w")&&(o+=s.x),r.includes("n")?a+=s.y:r.includes("s")&&(c+=s.y));const u=[];if(r)switch(r){case"e":{u.push(x(l,a),x(l,c));break}case"w":{u.push(x(o,a),x(o,c));break}case"n":{u.push(x(o,a),x(l,a));break}case"s":{u.push(x(o,c),x(l,c));break}case"ne":{u.push(x(l,a));break}case"nw":{u.push(x(o,a));break}case"se":{u.push(x(l,c));break}case"sw":{u.push(x(o,c));break}}const d=jy(n.state.zoom.value),f={x:d,y:d},h=[],m=[];Qh(t,u,n,i,h,m,f);const p={x:((C=h[0])==null?void 0:C.offset)??0,y:((_=m[0])==null?void 0:_.offset)??0};f.x=0,f.y=0,h.length=0,m.length=0;const[U,b,y,w]=ft(e).map(T=>an(T)),v=[x(U,b),x(U,w),x(y,b),x(y,w)];Qh(e,v,n,i,h,m,f);const I=BT(h,m);return{snapOffset:p,snapLines:I}},I3e=(e,t,n,i,s,r)=>{var m,p;if(!jc({event:n,selectedElements:[e],app:t}))return{snapOffset:{x:0,y:0},snapLines:[]};const o=[x(i.x+s.x,i.y+s.y)],a=jy(t.state.zoom.value),l={x:a,y:a},c=[],u=[];Qh([e],o,t,n,c,u,l);const d={x:((m=c[0])==null?void 0:m.offset)??0,y:((p=u[0])==null?void 0:p.offset)??0};l.x=0,l.y=0,c.length=0,u.length=0;const f=Om([e],r,{boundingBoxCorners:!0,omitCenter:!0});Qh([e],f,t,n,c,u,l);const h=BT(c,u);return{snapOffset:d,snapLines:h}},S3e=(e,t,n,i,s)=>{if(!jc({event:i,selectedElements:[],app:t}))return{originOffset:{x:0,y:0},snapLines:[]};const r=wz(e,[],t.state,s),o=jy(t.state.zoom.value),a={x:o,y:o},l=[],c=[];for(const u of r){const d=Om([u],s);for(const f of d){const h=f[0]-n.x;Math.abs(h)<=Math.abs(a.x)&&(Math.abs(h)<Math.abs(a.x)&&(c.length=0),c.push({type:"pointer",points:[f,x(f[0],n.y)],direction:"vertical"}),a.x=h);const m=f[1]-n.y;Math.abs(m)<=Math.abs(a.y)&&(Math.abs(m)<Math.abs(a.y)&&(l.length=0),l.push({type:"pointer",points:[f,x(n.x,f[1])],direction:"horizontal"}),a.y=m)}}return{originOffset:{x:c.length>0?c[0].points[0][0]-n.x:0,y:l.length>0?l[0].points[0][1]-n.y:0},snapLines:[...c,...l]}},x3e=e=>e===qn.rectangle||e===qn.ellipse||e===qn.diamond||e===qn.frame||e===qn.magicframe||e===qn.image||e===qn.text,n2={width:100,height:0},ac=100,C3e=(e,t,n)=>{const i=nr({x:0,y:0,textAlign:rm.CENTER,verticalAlign:Gs.MIDDLE,...t,containerId:e.id,strokeColor:t.strokeColor||e.strokeColor});return Object.assign(e,{boundElements:(e.boundElements||[]).concat({type:"text",id:i.id})}),qi(i,e,n),[e,i]},fD=(e,t,n,i,s)=>{let r,o;if(Object.assign(e,{startBinding:(e==null?void 0:e.startBinding)||null,endBinding:e.endBinding||null}),t){const u=(t==null?void 0:t.width)??ac,d=(t==null?void 0:t.height)??ac;let f;t.id&&(f=i.getElement(t.id),f||console.error(`No element for start binding with id ${t.id} found`));const h=t.x||e.x-u,m=t.y||e.y-d/2,p=f?f.type:t.type;if(p){if(p==="text"){let U="";f&&f.type==="text"?U=f.text:t.type==="text"&&(U=t.text),U||console.error(`No text found for start binding text element for ${e.id}`),r=nr({x:h,y:m,type:"text",...f,...t,text:U}),Object.assign(r,{x:t.x||e.x-r.width,y:t.y||e.y-r.height/2})}else switch(p){case"rectangle":case"ellipse":case"diamond":{r=ta({x:h,y:m,width:u,height:d,...f,...t,type:p});break}default:Ko(e,`Unhandled element start type "${t.type}"`,!0)}ea(e,r,"start",s)}}if(n){const u=(n==null?void 0:n.height)??ac,d=(n==null?void 0:n.width)??ac;let f;n.id&&(f=i.getElement(n.id),f||console.error(`No element for end binding with id ${n.id} found`));const h=n.x||e.x+e.width,m=n.y||e.y-u/2,p=f?f.type:n.type;if(p){if(p==="text"){let U="";f&&f.type==="text"?U=f.text:n.type==="text"&&(U=n.text),U||console.error(`No text found for end binding text element for ${e.id}`),o=nr({x:h,y:m,type:"text",...f,...n,text:U}),Object.assign(o,{y:n.y||e.y-o.height/2})}else switch(p){case"rectangle":case"ellipse":case"diamond":{o=ta({x:h,y:m,width:d,height:u,...f,...n,type:p});break}default:Ko(e,`Unhandled element end type "${p}"`,!0)}ea(e,o,"end",s)}}if(e.points.length<2)return{linearElement:e,startBoundElement:r,endBoundElement:o};const a=e.points.length-1,l=.5,c=Wa(e.points);return e.points[a][0]>e.points[a-1][0]&&(c[0][0]=l,c[a][0]-=l),e.points[a][0]<e.points[a-1][0]&&(c[0][0]=-.5,c[a][0]+=l),e.points[a][1]>e.points[a-1][1]&&(c[0][1]=l,c[a][1]-=l),e.points[a][1]<e.points[a-1][1]&&(c[0][1]=-.5,c[a][1]+=l),Object.assign(e,pe.getNormalizeElementPointsAndCoords({...e,points:c})),{linearElement:e,startBoundElement:r,endBoundElement:o}};class A3e{constructor(){F(this,"excalidrawElements",new Map);F(this,"add",t=>{t&&this.excalidrawElements.set(t.id,t)});F(this,"getElements",()=>ru(Array.from(this.excalidrawElements.values())));F(this,"getElementsMap",()=>Zo(ve(this.getElements())));F(this,"getElement",t=>this.excalidrawElements.get(t))}}const Mv=(e,t)=>{var l,c,u;if(!e)return[];const n=Wa(e),i=new A3e,s=new Map,r=new Map;for(const d of n){let f;const h=d.id;switch((t==null?void 0:t.regenerateIds)!==!1&&Object.assign(d,{id:fs()}),d.type){case"rectangle":case"ellipse":case"diamond":{const p=(l=d==null?void 0:d.label)!=null&&l.text&&d.width===void 0?0:(d==null?void 0:d.width)||ac,U=(c=d==null?void 0:d.label)!=null&&c.text&&d.height===void 0?0:(d==null?void 0:d.height)||ac;f=ta({...d,width:p,height:U});break}case"line":{const p=d.width||n2.width,U=d.height||n2.height;f=Ec({width:p,height:U,points:[x(0,0),x(p,U)],...d});break}case"arrow":{const p=d.width||n2.width,U=d.height||n2.height;f=uh({width:p,height:U,endArrowhead:"arrow",points:[x(0,0),x(p,U)],...d,type:"arrow"}),Object.assign(f,Oh(f.points));break}case"text":{const p=(d==null?void 0:d.fontFamily)||tu,U=(d==null?void 0:d.fontSize)||vl,b=(d==null?void 0:d.lineHeight)||Oc(p),y=d.text??"",w=Bh(y),v=Xn(w,gt({fontFamily:p,fontSize:U}),b);f=nr({width:v.width,height:v.height,fontFamily:p,fontSize:U,...d});break}case"image":{f=Qz({width:(d==null?void 0:d.width)||ac,height:(d==null?void 0:d.height)||ac,...d});break}case"frame":{f=__({x:0,y:0,...d});break}case"magicframe":{f=N4({x:0,y:0,...d});break}case"freedraw":case"iframe":case"embeddable":{f=d;break}default:f=d,Ko(d,`Unhandled element type "${d.type}"`,!0)}i.getElement(f.id)?console.error(`Duplicate id found for ${f.id}`):(i.add(f),s.set(f.id,d),h&&r.set(h,f.id))}const o=i.getElementsMap(),a=new _6(o);for(const[d,f]of s){const h=i.getElement(d);switch(f.type){case"rectangle":case"ellipse":case"diamond":case"arrow":{if((u=f.label)!=null&&u.text){let[m,p]=C3e(h,f==null?void 0:f.label,a);if(i.add(m),i.add(p),xe(m)){const U=f.type==="arrow"?f==null?void 0:f.start:void 0,b=f.type==="arrow"?f==null?void 0:f.end:void 0;if(U&&U.id){const I=r.get(U.id);I&&Object.assign(U,{id:I})}if(b&&b.id){const I=r.get(b.id);I&&Object.assign(b,{id:I})}const{linearElement:y,startBoundElement:w,endBoundElement:v}=fD(m,U,b,i,a);m=y,i.add(y),i.add(w),i.add(v)}}else switch(f.type){case"arrow":{const{start:m,end:p}=f;if(m&&m.id){const w=r.get(m.id);Object.assign(m,{id:w})}if(p&&p.id){const w=r.get(p.id);Object.assign(p,{id:w})}const{linearElement:U,startBoundElement:b,endBoundElement:y}=fD(h,m,p,i,a);i.add(U),i.add(b),i.add(y);break}}break}}}for(const[d,f]of s){if(f.type!=="frame"&&f.type!=="magicframe")continue;const h=i.getElement(d);if(!h)throw new Error(`Excalidraw element with id ${d} doesn't exist`);const m=[];f.children.forEach(T=>{var R;const k=r.get(T);if(!k)throw new Error(`Element with ${T} wasn't mapped correctly`);const S=i.getElement(k);if(!S)throw new Error(`Frame element with id ${k} doesn't exist`);Object.assign(S,{frameId:h.id}),(R=S==null?void 0:S.boundElements)==null||R.forEach(P=>{const L=i.getElement(P.id);if(!L)throw new Error(`Bound element with id ${P.id} doesn't exist`);Object.assign(L,{frameId:h.id}),m.push(L)}),m.push(S)});let[p,U,b,y]=ft(m);const w=10;p=p-w,U=U-w,b=b+w,y=y+w;const v=(h==null?void 0:h.x)||p,I=(h==null?void 0:h.y)||U,C=(h==null?void 0:h.width)||b-p,_=(h==null?void 0:h.height)||y-U;Object.assign(h,{x:v,y:I,width:C,height:_})}return i.getElements()},M3e="#ff6b6b",k3e="#ff0000",hD=1,gD=2,R3e=(e,t)=>{if(!t.snapLines.length)return;const n=t.theme===ke.LIGHT||t.zenModeEnabled?M3e:k3e,i=(t.zenModeEnabled?hD*1.5:hD)/t.zoom.value;e.save(),e.translate(t.scrollX,t.scrollY);for(const s of t.snapLines)s.type==="pointer"?(e.lineWidth=i,e.strokeStyle=n,L3e(s,e,t)):s.type==="gap"?(e.lineWidth=i,e.strokeStyle=n,N3e(s.points[0],s.points[1],s.direction,t,e)):s.type==="points"&&(e.lineWidth=i,e.strokeStyle=n,D3e(s,e,t));e.restore()},D3e=(e,t,n)=>{if(!n.zenModeEnabled){const i=e.points[0],s=e.points[e.points.length-1];ar(i,s,t)}for(const i of e.points)oj(i,n,t)},L3e=(e,t,n)=>{oj(e.points[0],n,t),n.zenModeEnabled||ar(e.points[0],e.points[1],t)},oj=([e,t],n,i)=>{i.save();const s=(n.zenModeEnabled?gD*1.5:gD)/n.zoom.value;i.beginPath(),i.moveTo(e-s,t-s),i.lineTo(e+s,t+s),i.moveTo(e+s,t-s),i.lineTo(e-s,t+s),i.stroke(),i.restore()},ar=(e,t,n)=>{n.beginPath(),n.lineTo(e[0],e[1]),n.lineTo(t[0],t[1]),n.stroke()},N3e=(e,t,n,i,s)=>{const r=8/i.zoom.value,o=r/2,a=r/4;if(n==="horizontal"){const l=[(e[0]+t[0])/2,e[1]];i.zenModeEnabled||ar(x(e[0],e[1]-r),x(e[0],e[1]+r),s),ar(x(l[0]-a,l[1]-o),x(l[0]-a,l[1]+o),s),ar(x(l[0]+a,l[1]-o),x(l[0]+a,l[1]+o),s),i.zenModeEnabled||(ar(x(t[0],t[1]-r),x(t[0],t[1]+r),s),ar(e,t,s))}else{const l=[e[0],(e[1]+t[1])/2];i.zenModeEnabled||ar(x(e[0]-r,e[1]),x(e[0]+r,e[1]),s),ar(x(l[0]-o,l[1]-a),x(l[0]+o,l[1]-a),s),ar(x(l[0]-o,l[1]+a),x(l[0]+o,l[1]+a),s),i.zenModeEnabled||(ar(x(t[0]-r,t[1]),x(t[0]+r,t[1]),s),ar(e,t,s))}},Hl=4,So=6,O3e="rgba(0,0,0,0.3)",P3e=(e,t,n,i)=>{if(!e.size)return{horizontal:null,vertical:null};const[s,r,o,a]=ft(e),l=t/i.zoom.value,c=n/i.zoom.value,u={top:parseInt(RU("sat"))||0,bottom:parseInt(RU("sab"))||0,left:parseInt(RU("sal"))||0,right:parseInt(RU("sar"))||0},d=gm().rtl,f=-i.scrollX+u.left,h=-i.scrollY+u.top,m=f+l-u.right,p=h+c-u.bottom,U=Math.min(s,f),b=Math.min(r,h),y=Math.max(o,m),w=Math.max(a,p),v=o-s,I=a-r,C=y-U,_=w-b,T=Math.max(Hl*2,u.left+u.right)+So*2,k=t*(l/C)-T,S=Math.max(Hl*2,u.top+u.bottom)+So*2,R=n*(c/_)-S,P=C>v?C*i.zoom.value/(k+T):t/(k+T),L=_>I?_*i.zoom.value/(R+S):n/(R+S);return{horizontal:f===U&&m===y?null:{x:Math.max(u.left,Hl)+So+(f-U)/C*t,y:n-So-Math.max(Hl,u.bottom),width:k,height:So,deltaMultiplier:P},vertical:h===b&&p===w?null:{x:d?Math.max(u.left,Hl):t-So-Math.max(u.right,Hl),y:Math.max(u.top,Hl)+So+(h-b)/_*n,width:So,height:R,deltaMultiplier:L}}},mD=(e,t,n)=>{const[i,s]=[e.horizontal,e.vertical].map(o=>o!=null&&o.x<=t&&t<=o.x+o.width&&o.y<=n&&n<=o.y+o.height);return{isOverEither:i||s,isOverHorizontal:i,isOverVertical:s}},F3e=(e,t)=>{gn(t.selectedLinearElement,"selectedLinearElement is null");const{segmentMidPointHoveredCoords:n}=t.selectedLinearElement;gn(n,"midPointCoords is null"),e.save(),e.translate(t.scrollX,t.scrollY),aj(n,e,t),e.restore()},B3e=(e,t,n)=>{var a,l,c;const{elementId:i,hoverPointIndex:s}=t.selectedLinearElement;if((a=t.selectedLinearElement)!=null&&a.isEditing&&((c=(l=t.selectedLinearElement)==null?void 0:l.selectedPointsIndices)!=null&&c.includes(s)))return;const r=pe.getElement(i,n);if(!r)return;const o=pe.getPointAtIndexGlobalCoordinates(r,s,n);e.save(),e.translate(t.scrollX,t.scrollY),aj(o,e,t),e.restore()},aj=(e,t,n)=>{t.fillStyle="rgba(105, 101, 219, 0.4)",ky(t,e[0],e[1],pe.POINT_HANDLE_SIZE/n.zoom.value,!1)},T3=(e,t,n,i,s,r,o)=>{var a;e.strokeStyle="#5e5ad8",e.setLineDash([]),e.fillStyle="rgba(255, 255, 255, 0.9)",s?e.fillStyle="rgba(134, 131, 226, 0.9)":r&&(e.fillStyle="rgba(177, 151, 252, 0.7)"),ky(e,n[0],n[1],(o?i*((a=t.selectedLinearElement)!=null&&a.isEditing?1.5:2):i)/t.zoom.value,!r,!o||s)},z3e=(e,t,n,i)=>{const s=Eg(t,t.width,t.height,i);switch(e.fillStyle="rgba(0,0,0,.05)",t.type){case"rectangle":case"text":case"image":case"iframe":case"embeddable":case"frame":case"magicframe":_5e(e,t,n,s);break;case"diamond":I5e(e,s,t,n);break;case"ellipse":{const[r,o,a,l]=ze(t,n),c=a-r,u=l-o;e.strokeStyle="rgba(0,0,0,.05)",e.lineWidth=s-kt,T5e(e,c+s+kt,u+s+kt,r+c/2,o+u/2,t.angle);break}}},H3e=(e,t,n,i)=>{const[s,r,o]=t,a=Eg(o,o.width,o.height,i);e.strokeStyle="rgba(0,0,0,0)",e.fillStyle="rgba(0,0,0,.05)",(r==="both"?[0,-1]:r==="start"?[0]:[-1]).forEach(c=>{const[u,d]=pe.getPointAtIndexGlobalCoordinates(s,c,n);ky(e,u,d,a,!0)})},lj=(e,t,n)=>{const{angle:i,x1:s,y1:r,x2:o,y2:a,selectionColors:l,cx:c,cy:u,dashed:d,activeEmbeddable:f}=n,h=o-s,m=a-r,U=(n.padding??fd*2)/t.zoom.value,b=8/t.zoom.value,y=4/t.zoom.value;e.save(),e.translate(t.scrollX,t.scrollY),e.lineWidth=(f?4:1)/t.zoom.value;const w=l.length;for(let v=0;v<w;++v)e.strokeStyle=l[v],d&&e.setLineDash([b,y+(b+y)*(w-1)]),e.lineDashOffset=(b+y)*v,Ly(e,s-U,r-U,h+U*2,m+U*2,c,u,i);e.restore()},V3e=(e,t,n,i)=>{const s=Array.isArray(n)?H3e:z3e;e.save(),e.translate(t.scrollX,t.scrollY),s(e,n,i,t.zoom),e.restore()},$3e=(e,t,n,i)=>{const[s,r,o,a]=ze(n,i),l=o-s,c=a-r;e.strokeStyle="rgb(0,118,255)",e.lineWidth=Ft.strokeWidth/t.zoom.value,e.save(),e.translate(t.scrollX,t.scrollY),Ly(e,s,r,l,c,s+l/2,r+c/2,n.angle,!1,Ft.radius/t.zoom.value),e.restore()},pD=(e,t,n,i)=>{const{colors:s=["rgb(0,118,255)"],dashed:r=!1}=i||{},o=n.filter(u=>u.groupIds.length===0),a=n.filter(u=>u.groupIds.length>0),l=u=>{const[d,f,h,m]=ft(u);return{angle:0,x1:d,x2:h,y1:f,y2:m,selectionColors:s,dashed:r,cx:d+(h-d)/2,cy:f+(m-f)/2,activeEmbeddable:!1}},c=u=>{const d=Ct(n,u);return l(d)};Object.entries(_p(a,t)).filter(([u,d])=>d).map(([u,d])=>u).map(u=>c(u)).concat(o.map(u=>l([u]))).forEach(u=>lj(e,t,u))},I3=(e,t,n,i)=>{var c,u;if(!t.selectedLinearElement)return;e.save(),e.translate(t.scrollX,t.scrollY),e.lineWidth=1/t.zoom.value;const s=pe.getPointsGlobalCoordinates(n,i),{POINT_HANDLE_SIZE:r}=pe,o=(c=t.selectedLinearElement)!=null&&c.isEditing?r:r/2,a=ge(n),l=tn(n);if(s.forEach((d,f)=>{var p,U,b,y,w,v;if(a&&f!==0&&f!==s.length-1)return;const h=f>0&&(f!==s.length-1||!l||!n.polygon)&&kr(d,f===s.length-1?s[0]:s[f-1],2/t.zoom.value);let m=!!((p=t.selectedLinearElement)!=null&&p.isEditing)&&!!((b=(U=t.selectedLinearElement)==null?void 0:U.selectedPointsIndices)!=null&&b.includes(f));l&&n.polygon&&!m&&f===n.points.length-1&&((y=t.selectedLinearElement)!=null&&y.isEditing)&&((v=(w=t.selectedLinearElement)==null?void 0:w.selectedPointsIndices)!=null&&v.includes(0))&&(m=!0),T3(e,t,d,o,m,!1,h)}),ge(n)){const d=((u=n.fixedSegments)==null?void 0:u.map(f=>f.index))||[];s.slice(0,-1).forEach((f,h)=>{pe.isSegmentTooShort(n,s[h+1],s[h],h,t.zoom)||T3(e,t,x((f[0]+s[h+1][0])/2,(f[1]+s[h+1][1])/2),r/2,!1,!d.includes(h+1),!1)})}else pe.getEditorMidPoints(n,i,t).filter((f,h,m)=>f!==null&&!(ge(n)&&(h===0||h===m.length-1))).forEach(f=>{var h;((h=t.selectedLinearElement)!=null&&h.isEditing||s.length===2)&&T3(e,t,f,r/2,!1,!0,!1)});e.restore()},UD=(e,t,n,i,s)=>{Object.keys(i).forEach(r=>{const o=i[r];if(o!==void 0){const[a,l,c,u]=o;e.save(),e.lineWidth=1/n.zoom.value,t.selectionColor&&(e.strokeStyle=t.selectionColor),r==="rotation"?ky(e,a+c/2,l+u/2,c/2,!0):e.roundRect?(e.beginPath(),e.roundRect(a,l,c,u,2/n.zoom.value),e.fill(),e.stroke()):Ly(e,a,l,c,u,a+c/2,l+u/2,s,!0),e.restore()}})},G3e=(e,t,n,i,s)=>{const[r,o,,,a,l]=ze(i,s),c=3,u=20,d=c/n.zoom.value,f=d/2,h=a-r+d,m=l-o+d,p=Math.min(u/n.zoom.value,h),U=Math.min(u/n.zoom.value,m);e.save(),e.fillStyle=t.selectionColor,e.strokeStyle=t.selectionColor,e.lineWidth=d,[[[-h,-m],[0,f],[p,f],[f,0],[f,U]],[[h-f,-m],[f,f],[-p+f,f],[0,0],[0,U]],[[-h,m],[0,-f],[p,-f],[f,0],[f,-U]],[[h-f,m],[f,-f],[-p+f,-f],[0,0],[0,-U]]].forEach(y=>{const[[w,v],[I,C],[_,T],[k,S],[R,P]]=y;e.save(),e.translate(a,l),e.rotate(i.angle),e.beginPath(),e.moveTo(w+I,v+C),e.lineTo(w+_,v+T),e.stroke(),e.beginPath(),e.moveTo(w+k,v+S),e.lineTo(w+R,v+P),e.stroke(),e.restore()}),e.restore()},X3e=(e,t,n,i)=>{t.save();const s=fd*2/n.zoom.value,r=e.width+s*2,o=e.height+s*2,a=e.x+r/2,l=e.y+o/2,c=-(r/2+s),u=-(o/2+s);t.translate(a+n.scrollX,l+n.scrollY),t.rotate(e.angle),t.lineWidth=1/n.zoom.value,t.strokeStyle=i,t.strokeRect(c,u,r,o),t.restore()},cj=({canvas:e,elementsMap:t,visibleElements:n,selectedElements:i,allElementsMap:s,scale:r,appState:o,renderConfig:a,device:l})=>{var p,U,b,y,w;if(e===null)return{atLeastOneVisibleElement:!1,elementsMap:t};const[c,u]=Ry(e,r),d=Dy({canvas:e,scale:r,normalizedWidth:c,normalizedHeight:u});d.save(),d.scale(o.zoom.value,o.zoom.value);let f;if(n.forEach(v=>{var I;(I=o.selectedLinearElement)!=null&&I.isEditing&&o.selectedLinearElement.elementId===v.id&&v&&(f=v)}),f&&I3(d,o,f,t),o.selectionElement&&!o.isCropping)try{qle(o.selectionElement,d,o,a.selectionColor)}catch(v){console.error(v)}if(o.editingTextElement&&de(o.editingTextElement)){const v=s.get(o.editingTextElement.id);v&&!v.autoResize&&X3e(v,d,o,a.selectionColor)}if(o.isBindingEnabled&&o.suggestedBindings.filter(v=>v!=null).forEach(v=>{V3e(d,o,v,t)}),o.frameToHighlight&&$3e(d,o,o.frameToHighlight,t),o.elementsToHighlight&&pD(d,o,o.elementsToHighlight),o.activeLockedId){const v=s.get(o.activeLockedId),I=v?[v]:Ct(s,o.activeLockedId);pD(d,o,I,{colors:["#ced4da"],dashed:!0})}const h=i.some(v=>Ee(v));if(i.length===1&&((p=o.selectedLinearElement)!=null&&p.isEditing)&&o.selectedLinearElement.elementId===i[0].id&&I3(d,o,i[0],t),o.selectedLinearElement){const v=o.selectedLinearElement,I=i.find(C=>C.id===v.elementId);v.segmentMidPointHoveredCoords?F3e(d,o):(ge(I)?v.hoverPointIndex===0||v.hoverPointIndex===I.points.length-1:v.hoverPointIndex>=0)&&B3e(d,o,t)}if(!o.multiElement&&!((U=o.selectedLinearElement)!=null&&U.isEditing)){const v=aH(i,o),I=i.length===1&&Se(i[0]);I&&((b=o.selectedLinearElement)==null?void 0:b.elementId)===i[0].id&&!i[0].locked&&I3(d,o,i[0],t);const C=a.selectionColor||Ui.black;if(v){const _=ve(i),T=[];for(const S of t.values()){const R=[],P=a.remoteSelectedElementIds.get(S.id);if(I&&ge(S)&&(S.startBinding||S.endBinding)||(_.has(S.id)&&!o_(o,S)&&R.push(C),P&&R.push(...P.map(L=>Fy(L,o.collaborators.get(L))))),R.length){const[L,X,G,z,V,$]=ze(S,t,!0);T.push({angle:S.angle,x1:L,y1:X,x2:G,y2:z,selectionColors:S.locked?["#ced4da"]:R,dashed:!!P||S.locked,cx:V,cy:$,activeEmbeddable:((y=o.activeEmbeddable)==null?void 0:y.element)===S&&o.activeEmbeddable.state==="active",padding:S.id===o.croppingElementId||yt(S)?0:void 0})}}const k=S=>{const R=Ct(t,S),[P,L,X,G]=ft(R);T.push({angle:0,x1:P,x2:X,y1:L,y2:G,selectionColors:R.some(z=>z.locked)?["#ced4da"]:[Ui.black],dashed:!0,cx:P+(X-P)/2,cy:L+(G-L)/2,activeEmbeddable:!1})};for(const S of yc(o))k(S);o.editingGroupId&&k(o.editingGroupId),T.forEach(S=>lj(d,o,S))}if(d.save(),d.translate(o.scrollX,o.scrollY),i.length===1){d.fillStyle=Ui.white;const _=oH(i[0],o.zoom,t,"mouse",w0(l));if(!o.viewModeEnabled&&v&&!de(o.editingTextElement)&&!o.croppingElementId&&UD(d,a,o,_,i[0].angle),o.croppingElementId&&!o.isCropping){const T=t.get(o.croppingElementId);T&&yt(T)&&G3e(d,a,o,T,t)}}else if(i.length>1&&!o.isRotating&&!i.some(_=>_.locked)){const _=fd*2/o.zoom.value;d.fillStyle=Ui.white;const[T,k,S,R]=ft(i,t),P=d.getLineDash();d.setLineDash([2/o.zoom.value]);const L=d.lineWidth;d.lineWidth=1/o.zoom.value,d.strokeStyle=C,Ly(d,T-_,k-_,S-T+_*2,R-k+_*2,(T+S)/2,(k+R)/2,0),d.lineWidth=L,d.setLineDash(P);const X=x_([T,k,S,R,(T+S)/2,(k+R)/2],0,o.zoom,"mouse",h?{...w0(l),rotation:!0}:w0(l));i.some(G=>!G.locked)&&UD(d,a,o,X,0)}d.restore()}(w=o.searchMatches)==null||w.matches.forEach(({id:v,focus:I,matchedLines:C})=>{const _=t.get(v);if(_){const[T,k,,,S,R]=ze(_,t,!0);d.save(),o.theme===ke.LIGHT?I?d.fillStyle="rgba(255, 124, 0, 0.4)":d.fillStyle="rgba(255, 226, 0, 0.4)":I?d.fillStyle="rgba(229, 82, 0, 0.4)":d.fillStyle="rgba(99, 52, 0, 0.4)";const P=Ee(_)?o.zoom.value:1;d.translate(o.scrollX,o.scrollY),d.translate(S,R),d.rotate(_.angle),C.forEach(L=>{(L.showOnCanvas||I)&&d.fillRect(T+L.offsetX/P-S,k+L.offsetY/P-R,L.width/P,L.height/P)}),d.restore()}}),R3e(d,o),d.restore(),Aye({context:d,renderConfig:a,appState:o,normalizedWidth:c,normalizedHeight:u});let m;return a.renderScrollbars&&(m=P3e(t,c,u,o),d.save(),d.fillStyle=O3e,d.strokeStyle="rgba(255,255,255,0.8)",[m.horizontal,m.vertical].forEach(v=>{v&&mX(d,v.x,v.y,v.width,v.height,So/2)}),d.restore()),{scrollBars:m,atLeastOneVisibleElement:n.length>0,elementsMap:t}},uj=Ug(e=>{var n;const t=cj(e);(n=e.callback)==null||n.call(e,t)},{trailing:!0}),j3e=(e,t)=>{if(t){uj(e);return}const n=cj(e);return e.callback(n),n};class bD{constructor(t){F(this,"scene");F(this,"getRenderableElements",(()=>{const t=({elementsMap:i,zoom:s,offsetLeft:r,offsetTop:o,scrollX:a,scrollY:l,height:c,width:u})=>{const d=[];for(const f of i.values())w6(f,u,c,{zoom:s,offsetLeft:r,offsetTop:o,scrollX:a,scrollY:l},i)&&d.push(f);return d},n=({elements:i,editingTextElement:s,newElementId:r})=>{const o=Zo(new Map);for(const a of i)r!==a.id&&(!s||s.type!=="text"||a.id!==s.id)&&o.set(a.id,a);return o};return Dre(({zoom:i,offsetLeft:s,offsetTop:r,scrollX:o,scrollY:a,height:l,width:c,editingTextElement:u,newElementId:d,sceneNonce:f})=>{const h=this.scene.getNonDeletedElements(),m=n({elements:h,editingTextElement:u,newElementId:d}),p=t({elementsMap:m,zoom:i,offsetLeft:s,offsetTop:r,scrollX:o,scrollY:a,height:l,width:c});return{elementsMap:m,visibleElements:p}})})());this.scene=t}destroy(){uj.cancel(),KG.cancel(),this.getRenderableElements.clear()}}const Y3e=5,W3e=(e,t,n)=>{const[i,s]=ze(e,n),{x:r,y:o}=Xs({sceneX:i+e.width,sceneY:s},t),a=r-t.offsetLeft+10,l=o-t.offsetTop;return{x:a,y:l}},yD=({children:e,element:t,elementsMap:n})=>{const i=Op();if(i.contextMenu||i.newElement||i.resizingElement||i.isRotating||i.openMenu||i.viewModeEnabled)return null;const{x:s,y:r}=W3e(t,i,n);return g("div",{className:"excalidraw-canvas-buttons",style:{top:`${r}px`,left:`${s}px`,padding:Y3e},children:e})};function K3e(e,t,n,i){Object.defineProperty(e,t,{get:n,set:i,enumerable:!0,configurable:!0})}var Z3e={};K3e(Z3e,"LaserPointer",()=>W6);function vn([e,t,n],[i,s,r]){return[e+i,t+s,n+r]}function X1([e,t,n],[i,s,r]){return[e-i,t-s,n-r]}function Nn([e,t,n],i){return[e*i,t*i,n*i]}function df([e,t,n]){return[e/Math.sqrt(e**2+t**2),t/Math.sqrt(e**2+t**2),n]}function Fi([e,t,n],i){return[Math.cos(i)*e-Math.sin(i)*t,Math.sin(i)*e+Math.cos(i)*t,n]}function q3e(e,t,n){return vn(e,Nn(X1(t,e),n))}function ED(e,t,n){return Math.atan2(n[1]-e[1],n[0]-e[0])-Math.atan2(t[1]-e[1],t[0]-e[0])}function vD(e){return Math.atan2(Math.sin(e),Math.cos(e))}function wD([e,t]){return Math.sqrt(e**2+t**2)}function yh([e,t],[n,i]){return Math.sqrt((n-e)**2+(i-t)**2)}function Q3e(e){if(e.length<2)return 0;let t=0;for(let n=1;n<=e.length-1;n++)t+=yh(e[n-1],e[n]);return t+=yh(e[e.length-2],e[e.length-1]),t}const J3e=(e,t,n)=>Math.max(t,Math.min(n,e));function e7e(e,t,n){const i=yh(t,n);if(i===0)return yh(e,t);const s=J3e(((e[0]-t[0])*(n[0]-t[0])+(e[1]-t[1])*(n[1]-t[1]))/i**2,0,1),r=[t[0]+s*(n[0]-t[0]),t[1]+s*(n[1]-t[1]),e[2]];return yh(r,e)}function Y6(e,t){if(t===0||e.length<=2)return e;const n=e[0],i=e[e.length-1],[s,r]=e.reduce(([o,a],l,c)=>{const u=e7e(l,n,i);return u>o?[u,c]:[o,a]},[0,-1]);if(s>=t){const o=e[r];return[...Y6([n,...e.slice(1,r),o],t).slice(0,-1),o,...Y6([o,...e.slice(r,-1),i],t).slice(1)]}else return[n,i]}const Wl=class Wl{constructor(t){this.originalPoints=[],this.stablePoints=[],this.tailPoints=[],this.isFresh=!0,this.options=Object.assign({},Wl.defaults,t)}get lastPoint(){return this.tailPoints[this.tailPoints.length-1]??this.stablePoints[this.stablePoints.length-1]}addPoint(t){const n=this.originalPoints[this.originalPoints.length-1];if(!(n&&n[0]===t[0]&&n[1]===t[1])){if(this.originalPoints.push(t),this.isFresh){this.isFresh=!1,this.stablePoints.push(t);return}this.options.streamline>0&&(t=q3e(this.lastPoint,t,1-this.options.streamline)),this.tailPoints.push(t),Q3e(this.tailPoints)>Wl.constants.maxTailLength&&this.stabilizeTail()}}close(){this.stabilizeTail()}stabilizeTail(){if(this.options.simplify>0&&this.options.simplifyPhase=="tail")throw new Error("Not implemented yet");this.stablePoints.push(...this.tailPoints),this.tailPoints=[]}getSize(t,n,i,s,r){return(t??this.options.size)*this.options.sizeMapping({pressure:n,runningLength:r,currentIndex:i,totalLength:s})}getStrokeOutline(t){if(this.isFresh)return[];let n=[...this.stablePoints,...this.tailPoints];this.options.simplify>0&&this.options.simplifyPhase==="input"&&(n=Y6(n,this.options.simplify));const i=n.length;if(i===0)return[];if(i===1){const _=n[0],T=this.getSize(t,_[2],0,i,0);if(T<.5)return[];const k=[];for(let S=0;S<=Math.PI*2;S+=Math.PI/16)k.push(vn(_,Nn(Fi([1,0,0],S),T)));return k.push(vn(_,Nn([1,0,0],this.getSize(t,_[2],0,i,0)))),k}if(i===2){const _=n[0],T=n[1],k=this.getSize(t,_[2],0,i,0),S=this.getSize(t,T[2],0,i,0);if(k<.5||S<.5)return[];const R=[],P=ED(_,[_[0],_[1]-100,_[2]],T);for(let L=P;L<=Math.PI+P;L+=Math.PI/16)R.push(vn(_,Nn(Fi([1,0,0],L),k)));for(let L=Math.PI+P;L<=Math.PI*2+P;L+=Math.PI/16)R.push(vn(T,Nn(Fi([1,0,0],L),S)));return R.push(R[0]),R}const s=[],r=[];let o=0,a=0,l=0,c=0;for(let _=1;_<i-1;_++){const T=n[_-1],k=n[_],S=n[_+1];let R=k[2];const P=yh(T,k);c+=P,o=a+(P-a)*.2;const L=this.getSize(t,R,_,i,c);if(L===0){l=_+1;continue}const X=df(X1(T,k)),G=df(X1(S,k)),z=Fi(X,Math.PI/2),V=Fi(X,-Math.PI/2),$=Fi(G,Math.PI/2),j=Fi(G,-Math.PI/2),W=vn(k,Nn(z,L)),Q=vn(k,Nn(V,L)),oe=vn(k,Nn($,L)),me=vn(k,Nn(j,L)),he=vn(z,j),Me=vn(V,$),mt=vn(k,Nn(wD(he)===0?X:df(he),L)),We=vn(k,Nn(wD(Me)===0?G:df(Me),L)),Ht=vD(ED(k,T,S)),fn=Wl.constants.cornerDetectionMaxAngle/180*Math.PI*Wl.constants.cornerDetectionVariance(o);if(Math.abs(Ht)<fn){const je=Math.abs(vD(Math.PI-Ht));if(je===0)continue;if(Ht<0){r.push(Q,We);for(let lt=0;lt<=je;lt+=je/4)s.push(vn(k,Fi(Nn(z,L),lt)));for(let lt=je;lt>=0;lt-=je/4)r.push(vn(k,Fi(Nn(z,L),lt)));r.push(We,oe)}else{s.push(W,mt);for(let lt=0;lt<=je;lt+=je/4)r.push(vn(k,Fi(Nn(z,-L),-lt)));for(let lt=je;lt>=0;lt-=je/4)s.push(vn(k,Fi(Nn(z,-L),-lt)));s.push(mt,me)}}else s.push(mt),r.push(We);a=o}if(l>=i-2)if(this.options.keepHead){const _=n[i-1],T=[];for(let k=0;k<=Math.PI*2;k+=Math.PI/16)T.push(vn(_,Nn(Fi([1,0,0],k),this.options.size)));return T.push(vn(_,Nn([1,0,0],this.options.size))),T}else return[];const u=n[l],d=n[l+1],f=n[i-2],h=n[i-1],m=df(X1(d,u)),p=df(X1(f,h)),U=Fi(m,-Math.PI/2),b=Fi(p,Math.PI/2),y=this.getSize(t,u[2],0,i,0),w=[],v=this.options.keepHead?this.options.size:this.getSize(t,f[2],i-2,i,c),I=[];if(y>1){for(let _=0;_<=Math.PI;_+=Math.PI/16)w.unshift(vn(u,Fi(Nn(U,y),-_)));w.unshift(vn(u,Nn(U,-y)))}else w.push(u);for(let _=0;_<=Math.PI*3;_+=Math.PI/16)I.push(vn(h,Fi(Nn(b,-v),-_)));const C=[...w,...s,...I.reverse(),...r.reverse()];return w.length>0&&C.push(w[0]),this.options.simplify>0&&this.options.simplifyPhase==="output"?Y6(C,this.options.simplify):C}};Wl.defaults={size:2,streamline:.45,simplify:.1,simplifyPhase:"output",keepHead:!1,sizeMapping:()=>1},Wl.constants={cornerDetectionMaxAngle:75,cornerDetectionVariance:t=>t>35?.5:1,maxTailLength:50};let W6=Wl;class K6{constructor(t,n,i){F(this,"currentTrail");F(this,"pastTrails",[]);F(this,"container");F(this,"trailElement");F(this,"trailAnimation");this.animationFrameHandler=t,this.app=n,this.options=i,this.animationFrameHandler.register(this,this.onFrame.bind(this)),this.trailElement=document.createElementNS(it,"path"),this.options.animateTrail&&(this.trailAnimation=document.createElementNS(it,"animate"),this.trailAnimation.setAttribute("attributeName","stroke-dashoffset"),this.trailElement.setAttribute("stroke-dasharray","7 7"),this.trailElement.setAttribute("stroke-dashoffset","10"),this.trailAnimation.setAttribute("from","0"),this.trailAnimation.setAttribute("to","-14"),this.trailAnimation.setAttribute("dur","0.3s"),this.trailElement.appendChild(this.trailAnimation))}get hasCurrentTrail(){return!!this.currentTrail}hasLastPoint(t,n){if(this.currentTrail){const i=this.currentTrail.originalPoints.length;return this.currentTrail.originalPoints[i-1][0]===t&&this.currentTrail.originalPoints[i-1][1]===n}return!1}start(t){t&&(this.container=t),this.trailElement.parentNode!==this.container&&this.container&&this.container.appendChild(this.trailElement),this.animationFrameHandler.start(this)}stop(){var t;this.animationFrameHandler.stop(this),this.trailElement.parentNode===this.container&&((t=this.container)==null||t.removeChild(this.trailElement))}startPath(t,n){this.currentTrail=new W6(this.options),this.currentTrail.addPoint([t,n,performance.now()]),this.update()}addPointToPath(t,n){this.currentTrail&&(this.currentTrail.addPoint([t,n,performance.now()]),this.update())}endPath(){this.currentTrail&&(this.currentTrail.close(),this.currentTrail.options.keepHead=!1,this.pastTrails.push(this.currentTrail),this.currentTrail=void 0,this.update())}getCurrentTrail(){return this.currentTrail}clearTrails(){this.pastTrails=[],this.currentTrail=void 0,this.update()}update(){this.start(),this.trailAnimation&&(this.trailAnimation.setAttribute("begin","indefinite"),this.trailAnimation.setAttribute("repeatCount","indefinite"))}onFrame(){const t=[];for(const i of this.pastTrails)t.push(this.drawTrail(i,this.app.state));if(this.currentTrail){const i=this.drawTrail(this.currentTrail,this.app.state);t.push(i)}this.pastTrails=this.pastTrails.filter(i=>i.getStrokeOutline().length!==0),t.length===0&&this.stop();const n=t.join(" ").trim();this.trailElement.setAttribute("d",n),this.trailAnimation?(this.trailElement.setAttribute("fill",(this.options.fill??(()=>"black"))(this)),this.trailElement.setAttribute("stroke",(this.options.stroke??(()=>"black"))(this))):this.trailElement.setAttribute("fill",(this.options.fill??(()=>"black"))(this))}drawTrail(t,n){const i=t.getStrokeOutline(t.options.size/n.zoom.value).map(([r,o])=>{const a=Xs({sceneX:r,sceneY:o},n);return[a.x,a.y]}),s=this.trailAnimation?i.slice(0,i.length/2):i;return Lre(s,!0)}}class t7e{constructor(t,n){F(this,"localTrail");F(this,"collabTrails",new Map);F(this,"container");this.animationFrameHandler=t,this.app=n,this.animationFrameHandler.register(this,this.onFrame.bind(this)),this.localTrail=new K6(t,n,{...this.getTrailOptions(),fill:()=>Ese})}getTrailOptions(){return{simplify:0,streamline:.4,sizeMapping:t=>{const s=Math.max(0,1-(performance.now()-t.pressure)/1e3),r=(50-Math.min(50,t.totalLength-t.currentIndex))/50;return Math.min(rl(r),rl(s))}}}startPath(t,n){this.localTrail.startPath(t,n)}addPointToPath(t,n){this.localTrail.addPointToPath(t,n)}endPath(){this.localTrail.endPath()}start(t){this.container=t,this.animationFrameHandler.start(this),this.localTrail.start(t)}stop(){this.animationFrameHandler.stop(this),this.localTrail.stop()}onFrame(){this.updateCollabTrails()}updateCollabTrails(){if(!(!this.container||this.app.state.collaborators.size===0)){for(const[t,n]of this.app.state.collaborators.entries()){let i;this.collabTrails.has(t)?i=this.collabTrails.get(t):(i=new K6(this.animationFrameHandler,this.app,{...this.getTrailOptions(),fill:()=>{var s;return((s=n.pointer)==null?void 0:s.laserColor)||Fy(t,n)}}),i.start(this.container),this.collabTrails.set(t,i)),n.pointer&&n.pointer.tool==="laser"&&(n.button==="down"&&!i.hasCurrentTrail&&i.startPath(n.pointer.x,n.pointer.y),n.button==="down"&&i.hasCurrentTrail&&!i.hasLastPoint(n.pointer.x,n.pointer.y)&&i.addPointToPath(n.pointer.x,n.pointer.y),n.button==="up"&&i.hasCurrentTrail&&(i.addPointToPath(n.pointer.x,n.pointer.y),i.endPath()))}for(const t of this.collabTrails.keys())this.app.state.collaborators.has(t)||(this.collabTrails.get(t).stop(),this.collabTrails.delete(t))}}}const on=e=>t=>{hi.unstable_batchedUpdates(e,t)},S3=e=>Ug(t=>{hi.unstable_batchedUpdates(e,t)}),zT=(()=>{let e;try{const n=D.version.split(".");e=Number(n[0])>17}catch{e=!1}let t=!1;return()=>window.EXCALIDRAW_THROTTLE_RENDER===!0?e?!0:(t||(t=!0,console.warn("Excalidraw: render throttling is disabled on React versions < 18.")),!1):!1})(),n7e=(e,t,n,i,s,r)=>{const{zoom:o}=i,a=180*n/Math.PI;let l=e*(o.value-1)/2,c=t*(o.value-1)/2;return e>s&&o.value!==1&&(l=s*(o.value-1)/2),t>r&&o.value!==1&&(c=r*(o.value-1)/2),`translate(${l}px, ${c}px) scale(${o.value}) rotate(${a}deg)`},i7e=({id:e,onChange:t,onSubmit:n,getViewportCoords:i,element:s,canvas:r,excalidrawContainer:o,app:a,autoSelect:l=!0})=>{const c=(G,z)=>{if(!z.style.fontFamily||!z.style.fontSize)return!1;const V=z.style.fontFamily.replace(/"/g,"");return hp({fontFamily:G.fontFamily})!==V||`${G.fontSize}px`!==z.style.fontSize},u=()=>{const G=a.state,z=a.scene.getElement(e);if(!z)return;const{textAlign:V,verticalAlign:$}=z,j=a.scene.getNonDeletedElementsMap();if(z&&de(z)){let W=z.x,Q=z.y;const oe=jn(z,a.scene.getNonDeletedElementsMap());let me=z.width,he=z.height,Me=z.width,mt=z.height;if(oe&&z.containerId){if(xe(oe)){const ai=pe.getBoundTextElementPosition(oe,z,j);W=ai.x,Q=ai.y}const lt=c(z,d);let Vt;if(lt?Vt=r6(oe.id,oe.height):(Vt=Fh[oe.id],Vt||(Vt=r6(oe.id,oe.height))),Me=Jo(oe,z),mt=vp(oe,z),!xe(oe)&&he>mt){const ai=gd(he,oe.type);a.scene.mutateElement(oe,{height:ai});return}else if(!xe(oe)&&oe.height>Vt.height&&he<mt){const ai=gd(he,oe.type);a.scene.mutateElement(oe,{height:ai})}else{const{x:ai,y:Il}=su(oe,z,j);W=ai,Q=Il}}const[We,Ht]=i(W,Q);oe?me+=.5:(Me=(G.width-8-We)/G.zoom.value,me=Math.min(me,Me)),he*=1.05;const fn=gt(z),je=(G.height-Ht)/G.zoom.value;Object.assign(d.style,{font:fn,lineHeight:z.lineHeight,width:`${me}px`,height:`${he}px`,left:`${We}px`,top:`${Ht}px`,transform:n7e(me,he,Dae(z,oe),G,Me,je),textAlign:V,verticalAlign:$,color:z.strokeColor,opacity:z.opacity/100,filter:"var(--theme-filter)",maxHeight:`${je}px`}),d.scrollTop=0,a.scene.mutateElement(z,{x:W,y:Q})}},d=document.createElement("textarea");d.dir="auto",d.tabIndex=0,d.dataset.type="wysiwyg",d.wrap="off",d.classList.add("excalidraw-wysiwyg");let f="pre",h="normal";(zt(s)||!s.autoResize)&&(f="pre-wrap",h="break-word"),Object.assign(d.style,{position:"absolute",display:"inline-block",minHeight:"1em",backfaceVisibility:"hidden",margin:0,padding:0,border:0,outline:0,resize:"none",background:"transparent",overflow:"hidden",zIndex:"var(--zIndex-wysiwyg)",wordBreak:h,whiteSpace:f,overflowWrap:"break-word",boxSizing:"content-box"}),d.value=s.originalText,u(),t&&(d.onpaste=async G=>{const z=(await bv(G)).findByType(_e.text);if(!z)return;const V=Bh(z.value);if(!V)return;const $=jn(s,a.scene.getNonDeletedElementsMap()),j=gt({fontSize:a.state.currentItemFontSize,fontFamily:a.state.currentItemFontFamily});if($){const W=Re($,a.scene.getNonDeletedElementsMap()),Q=iu(`${d.value}${V}`,j,Jo($,W)),oe=q9(Q,j);d.style.width=`${oe}px`}},d.oninput=()=>{const G=Bh(d.value);if(d.value!==G){const z=d.selectionStart;d.value=G,d.selectionStart=z,d.selectionEnd=z}t(d.value)}),d.onkeydown=G=>{if(!G.shiftKey&&Rk.keyTest(G))G.preventDefault(),a.actionManager.executeAction(Rk),u();else if(!G.shiftKey&&Dk.keyTest(G))G.preventDefault(),a.actionManager.executeAction(Dk),u();else if(!G.shiftKey&&Lk.keyTest(G))G.preventDefault(),a.actionManager.executeAction(Lk),u();else if(Ck.keyTest(G))a.actionManager.executeAction(Ck);else if(Ak.keyTest(G))a.actionManager.executeAction(Ak);else if(G.key===H.ESCAPE)G.preventDefault(),I=!0,C();else if($6.keyTest(G))G.preventDefault(),C(),a.actionManager.executeAction($6);else if(G.key===H.ENTER&&G[H.CTRL_OR_CMD]){if(G.preventDefault(),G.isComposing||G.keyCode===229)return;I=!0,C()}else if(G.key===H.TAB||G[H.CTRL_OR_CMD]&&(G.code===tt.BRACKET_LEFT||G.code===tt.BRACKET_RIGHT)){if(G.preventDefault(),G.isComposing)return;G.shiftKey||G.code===tt.BRACKET_LEFT?y():b(),d.dispatchEvent(new Event("input"))}};const m=4,p=" ".repeat(m),U=new RegExp(`^ {1,${m}}`),b=()=>{const{selectionStart:G,selectionEnd:z}=d,V=w();let $=d.value;V.forEach(j=>{const W=$.slice(0,j),Q=$.slice(j);$=`${W}${p}${Q}`}),d.value=$,d.selectionStart=G+m,d.selectionEnd=z+m*V.length},y=()=>{const{selectionStart:G,selectionEnd:z}=d,V=w(),$=[];let j=d.value;V.forEach(W=>{const Q=j.slice(W,W+m).match(U);if(Q){const oe=j.slice(0,W),me=j.slice(W+Q[0].length);j=`${oe}${me}`,$.push(W)}}),d.value=j,$.length&&(G>$[$.length-1]?d.selectionStart=Math.max(G-m,$[$.length-1]):d.selectionStart=G,d.selectionEnd=Math.max(d.selectionStart,z-m*$.length))},w=()=>{let{selectionStart:G,selectionEnd:z,value:V}=d;const $=V.slice(0,G).match(/[^\n]*$/)[0].length;return G=G-$,V.slice(G,z).split(`
`).reduce((W,Q,oe,me)=>W.concat(oe?W[oe-1]+me[oe-1].length+1:G),[]).reverse()},v=G=>{G.target instanceof HTMLCanvasElement&&(G.preventDefault(),G.stopPropagation())};let I=!1;const C=()=>{var V;if(L)return;L=!0,_();const G=a.scene.getElement(s.id);if(!G)return;const z=jn(G,a.scene.getNonDeletedElementsMap());if(z){if(d.value.trim()){const $=Qo(z);!$||$!==s.id?a.scene.mutateElement(z,{boundElements:(z.boundElements||[]).concat({type:"text",id:s.id})}):xe(z)&&Da(z)}else a.scene.mutateElement(z,{boundElements:(V=z.boundElements)==null?void 0:V.filter($=>!de($))});qi(G,z,a.scene)}n({viaKeyboard:I,nextOriginalText:d.value})},_=()=>{d.onblur=null,d.oninput=null,d.onkeydown=null,X&&X.disconnect(),window.removeEventListener("resize",u),window.removeEventListener("wheel",v,!0),window.removeEventListener("pointerdown",S),window.removeEventListener("pointerup",T),window.removeEventListener("blur",C),window.removeEventListener("beforeunload",C),R(),P(),d.remove()},T=G=>{window.removeEventListener("pointerup",T);const z=G==null?void 0:G.target,V=z instanceof HTMLElement&&z.classList.contains("properties-trigger"),$=(z instanceof HTMLElement||z instanceof SVGElement)&&!!z.closest(".properties-content"),j=(z instanceof HTMLElement||z instanceof SVGElement)&&(!!z.closest(`.${Zs.SHAPE_ACTIONS_MENU}`)||!!z.closest(".compact-shape-actions-island"));setTimeout(()=>{j||V||$||(d.onblur=C,d.focus())})},k=()=>{d.onblur=null,window.addEventListener("pointerup",T),window.addEventListener("blur",C)},S=G=>{const z=G==null?void 0:G.target;if(G.button===Fl.WHEEL){z instanceof HTMLTextAreaElement&&(G.preventDefault(),a.handleCanvasPanUsingWheelOrSpaceDrag(G)),k();return}const V=z instanceof HTMLElement&&z.classList.contains("properties-trigger"),$=(z instanceof HTMLElement||z instanceof SVGElement)&&!!z.closest(".properties-content");(G.target instanceof HTMLElement||G.target instanceof SVGElement)&&(G.target.closest(`.${Zs.SHAPE_ACTIONS_MENU}, .${Zs.ZOOM_ACTIONS}`)||G.target.closest(".compact-shape-actions-island"))&&!ka(G.target)||V||$?k():G.target instanceof HTMLCanvasElement&&requestAnimationFrame(()=>{C()})},R=a.scene.onUpdate(()=>{var z;u(),!!((z=document.activeElement)!=null&&z.closest(".properties-content"))||d.focus()}),P=a.onScrollChangeEmitter.on(()=>{u()});let L=!1;l&&d.select(),T();let X=null;return r&&"ResizeObserver"in window?(X=new window.ResizeObserver(()=>{u()}),X.observe(r)):window.addEventListener("resize",u),d.onpointerdown=G=>G.stopPropagation(),requestAnimationFrame(()=>{window.addEventListener("pointerdown",S,{capture:!0})}),window.addEventListener("beforeunload",C),o==null||o.querySelector(".excalidraw-textEditorContainer").appendChild(d),C},s7e=e=>{const t=["flowchart","graph","sequenceDiagram","classDiagram","stateDiagram","stateDiagram-v2","erDiagram","journey","gantt","pie","quadrantChart","requirementDiagram","gitGraph","C4Context","mindmap","timeline","zenuml","sankey","xychart","block"];return new RegExp(`^(?:%%{.*?}%%[\\s\\n]*)?\\b(?:${t.map(i=>`\\s*${i}(-beta)?`).join("|")})\\b`).test(e.trim())};function x3(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)}function r7e(e,t,n){const i=x3(t,n);if(i===0)return x3(e,t);let s=((e[0]-t[0])*(n[0]-t[0])+(e[1]-t[1])*(n[1]-t[1]))/i;return s=Math.max(0,Math.min(1,s)),x3(e,o7e(t,n,s))}function o7e(e,t,n){return[e[0]+(t[0]-e[0])*n,e[1]+(t[1]-e[1])*n]}function a7e(e,t){return kv(e,0,e.length,t)}function kv(e,t,n,i,s){const r=s||[],o=e[t],a=e[n-1];let l=0,c=1;for(let u=t+1;u<n-1;++u){const d=r7e(e[u],o,a);d>l&&(l=d,c=u)}return Math.sqrt(l)>i?(kv(e,t,c+1,i,r),kv(e,c,n,i,r)):(r.length||r.push(o),r.push(a)),r}const l7e=e=>{const{lassoPath:t,elements:n,elementsMap:i,elementsSegments:s,intersectedElements:r,enclosedElements:o,simplifyDistance:a}=e;let l=t;a&&(l=a7e(t,a));const c=n.filter(f=>!f.locked);o.clear(),r.clear();const u=t.reduce((f,h)=>[Math.min(f[0],h[0]),Math.min(f[1],h[1]),Math.max(f[2],h[0]),Math.max(f[3],h[1])],[1/0,1/0,-1/0,-1/0]);for(const f of c){const h=si(f,i);zd(u,h)&&!r.has(f.id)&&!o.has(f.id)&&(c7e(l,f,s)?o.add(f.id):u7e(l,f,i)&&r.add(f.id))}return{selectedElementIds:[...r,...o]}},c7e=(e,t,n)=>{const i=Kb(e),s=n.get(t.id);return s?s.some(r=>r.some(o=>EB(o,i))):!1},u7e=(e,t,n)=>{const i=e.slice(1).map((r,o)=>Ae(e[o],r)).concat([Ae(e[e.length-1],e[0])]),s=Re(t,n);return i.some(r=>$o(t,n,r,0,!0).length>0||!!s&&$o({...s,...su(t,s,n)},n,r,0,!0).length>0)};class d7e extends K6{constructor(n,i){super(n,i,{animateTrail:!0,streamline:.4,sizeMapping:s=>{const a=Math.max(0,1-(performance.now()-s.pressure)/(1/0)),l=(5e3-Math.min(5e3,s.totalLength-s.currentIndex))/5e3;return Math.min(rl(l),rl(a))},fill:()=>"rgba(105,101,219,0.05)",stroke:()=>"rgba(105,101,219)"});F(this,"intersectedElements",new Set);F(this,"enclosedElements",new Set);F(this,"elementsSegments",null);F(this,"canvasTranslate",null);F(this,"keepPreviousSelection",!1);F(this,"selectElementsFromIds",n=>{this.app.setState(i=>{const s=n.reduce((l,c)=>(l[c]=!0,l),{});if(this.keepPreviousSelection)for(const l of Object.keys(i.selectedElementIds))s[l]=!0;for(const[l]of Object.entries(s)){const c=this.app.scene.getNonDeletedElement(l);if(c&&de(c)){const u=jn(c,this.app.scene.getNonDeletedElementsMap());u&&(s[u.id]=!0,delete s[c.id])}}for(const[l]of Object.entries(s)){const c=this.app.scene.getNonDeletedElement(l);if(c&&Ee(c)){const u=Js(this.app.scene.getNonDeletedElementsMap(),c.id);for(const d of u)delete s[d.id]}}const r=Ii({editingGroupId:i.editingGroupId,selectedElementIds:s},this.app.scene.getNonDeletedElements(),i,this.app),o=[...Object.keys(r.selectedElementIds)],a=[...Object.keys(r.selectedGroupIds)];return{selectedElementIds:r.selectedElementIds,selectedGroupIds:r.selectedGroupIds,selectedLinearElement:o.length===1&&!a.length&&Se(this.app.scene.getNonDeletedElement(o[0]))?new pe(this.app.scene.getNonDeletedElement(o[0]),this.app.scene.getNonDeletedElementsMap()):null}})});F(this,"addPointToPath",(n,i,s=!1)=>{super.addPointToPath(n,i),this.keepPreviousSelection=s,this.updateSelection()});F(this,"updateSelection",()=>{var s,r;const n=(r=(s=super.getCurrentTrail())==null?void 0:s.originalPoints)==null?void 0:r.map(o=>x(o[0],o[1])),i={scrollX:this.app.state.scrollX,scrollY:this.app.state.scrollY,zoom:this.app.state.zoom.value};if(!this.elementsSegments||!Wi(i,this.canvasTranslate??{})){this.canvasTranslate=i,this.elementsSegments=new Map;const o=ve(this.app.visibleElements);for(const a of this.app.visibleElements){const l=E6(a,o);this.elementsSegments.set(a.id,l)}}if(n){const{selectedElementIds:o}=l7e({lassoPath:n,elements:this.app.visibleElements,elementsMap:this.app.scene.getNonDeletedElementsMap(),elementsSegments:this.elementsSegments,intersectedElements:this.intersectedElements,enclosedElements:this.enclosedElements,simplifyDistance:5/this.app.state.zoom.value});this.selectElementsFromIds(o)}})}startPath(n,i,s=!1){this.endPath(),super.startPath(n,i),this.intersectedElements.clear(),this.enclosedElements.clear(),this.keepPreviousSelection=s,this.keepPreviousSelection||this.app.setState({selectedElementIds:{},selectedGroupIds:{},selectedLinearElement:null})}endPath(){super.endPath(),super.clearTrails(),this.intersectedElements.clear(),this.enclosedElements.clear(),this.elementsSegments=null}}class f7e extends K6{constructor(n,i){super(n,i,{streamline:.2,size:5,keepHead:!0,sizeMapping:s=>{const a=Math.max(0,1-(performance.now()-s.pressure)/200),l=(10-Math.min(10,s.totalLength-s.currentIndex))/10;return Math.min(rl(l),rl(a))},fill:()=>i.state.theme===ke.LIGHT?"rgba(0, 0, 0, 0.2)":"rgba(255, 255, 255, 0.2)"});F(this,"elementsToErase",new Set);F(this,"groupsToErase",new Set)}startPath(n,i){this.endPath(),super.startPath(n,i),this.elementsToErase.clear()}addPointToPath(n,i,s=!1){return super.addPointToPath(n,i),this.updateElementsToBeErased(s)}updateElementsToBeErased(n){var a,l;const i=((l=(a=super.getCurrentTrail())==null?void 0:a.originalPoints)==null?void 0:l.map(c=>x(c[0],c[1])))||[];if(i.length<2)return[];const s=Ae(i[i.length-1],i[i.length-2]),r=this.app.visibleElements.filter(c=>!c.locked),o=ve(r);for(const c of r)if(n&&this.elementsToErase.has(c.id)){if(_D(s,c,o,this.app.state.zoom.value)){const d=c.groupIds.at(-1);if(this.groupsToErase.has(d)){const f=Ct(this.app.scene.getNonDeletedElementsMap(),d);for(const h of f)this.elementsToErase.delete(h.id);this.groupsToErase.delete(d)}if(zt(c)&&this.elementsToErase.delete(c.containerId),Di(c)){const f=Qo(c);f&&this.elementsToErase.delete(f)}this.elementsToErase.delete(c.id)}}else if(!n&&!this.elementsToErase.has(c.id)&&_D(s,c,o,this.app.state.zoom.value)){const d=c.groupIds.at(-1);if(!this.groupsToErase.has(d)){const f=Ct(this.app.scene.getNonDeletedElementsMap(),d);for(const h of f)this.elementsToErase.add(h.id);this.groupsToErase.add(d)}if(Di(c)){const f=Qo(c);f&&this.elementsToErase.add(f)}zt(c)&&this.elementsToErase.add(c.containerId),this.elementsToErase.add(c.id)}return Array.from(this.elementsToErase)}endPath(){super.endPath(),super.clearTrails(),this.elementsToErase.clear(),this.groupsToErase.clear()}}const _D=(e,t,n,i)=>{const s=e[1],r=Zi(t)?15:t.strokeWidth/2,o=[Math.min(e[0][0],e[1][0])-r,Math.min(e[0][1],e[1][1])-r,Math.max(e[0][0],e[1][0])+r,Math.max(e[0][1],e[1][1])+r],a=si(t,n),l=[a[0]-r,a[1]-r,a[2]+r,a[3]+r];if(!zd(o,l))return!1;if(o6(t)&&J9(s,t,n))return!0;if(Zi(t)){const u=Pz(t),d=ece(t,u,n),f=Math.max(2.25,5/i);for(const m of d)if(UA(m,e)<=f)return!0;const h=g4(...u.map(([m,p])=>x(t.x+m,t.y+p)));return!!EB(e[0],h)}const c=Re(t,n);if(xe(t)||tn(t)&&!t.polygon){const u=Math.max(t.strokeWidth,t.strokeWidth*2/i),d=E6(t,n);for(const f of d)if(UA(f,e)<=u)return!0;return!1}return $o(t,n,e,0,!0).length>0||!!c&&$o({...c,...su(t,c,n)},n,e,0,!0).length>0},h7e=()=>N("div",{"data-testid":"brave-measure-text-error",children:[g("p",{children:g(Ts,{i18nKey:"errors.brave_measure_text_error.line1",bold:e=>g("span",{style:{fontWeight:600},children:e})})}),g("p",{children:g(Ts,{i18nKey:"errors.brave_measure_text_error.line2",bold:e=>g("span",{style:{fontWeight:600},children:e})})}),g("p",{children:g(Ts,{i18nKey:"errors.brave_measure_text_error.line3",link:e=>g("a",{href:"http://docs.excalidraw.com/docs/@excalidraw/excalidraw/faq#turning-off-aggresive-block-fingerprinting-in-brave-browser",children:e})})}),g("p",{children:g(Ts,{i18nKey:"errors.brave_measure_text_error.line4",issueLink:e=>g("a",{href:"https://github.com/excalidraw/excalidraw/issues/new",children:e}),discordLink:e=>N("a",{href:"https://discord.gg/UexuTaE",children:[e,"."]})})})]}),g7e=({children:e,left:t,top:n,onCloseRequest:i,fitInViewport:s=!1,offsetLeft:r=0,offsetTop:o=0,viewportWidth:a=window.innerWidth,viewportHeight:l=window.innerHeight,className:c})=>{const u=D.useRef(null);D.useEffect(()=>{const f=u.current;if(!f)return;f.contains(document.activeElement)||f.focus();const h=m=>{var p,U,b;if(m.key===H.TAB){const y=U4(f),{activeElement:w}=document,v=y.findIndex(I=>I===w);w===f?(m.shiftKey?(p=y[y.length-1])==null||p.focus():y[0].focus(),m.preventDefault(),m.stopImmediatePropagation()):v===0&&m.shiftKey?((U=y[y.length-1])==null||U.focus(),m.preventDefault(),m.stopImmediatePropagation()):v===y.length-1&&!m.shiftKey&&((b=y[0])==null||b.focus(),m.preventDefault(),m.stopImmediatePropagation())}};return f.addEventListener("keydown",h),()=>f.removeEventListener("keydown",h)},[]);const d=D.useRef(null);return D.useLayoutEffect(()=>{var f,h;if(s&&u.current&&n!=null&&t!=null){const m=u.current,{width:p,height:U}=m.getBoundingClientRect();if(((f=d.current)==null?void 0:f.top)===n&&((h=d.current)==null?void 0:h.left)===t)return;d.current={top:n,left:t},p>=a?(m.style.width=`${a}px`,m.style.left="0px",m.style.overflowX="scroll"):t+p-r>a?m.style.left=`${a-p-10}px`:m.style.left=`${t}px`,U>=l?(m.style.height=`${l-20}px`,m.style.top="10px",m.style.overflowY="scroll"):n+U-o>l?m.style.top=`${l-U}px`:m.style.top=`${n}px`}},[n,t,s,a,l,r,o]),D.useEffect(()=>{if(i){const f=h=>{var m;(m=u.current)!=null&&m.contains(h.target)||hi.unstable_batchedUpdates(()=>i(h))};return document.addEventListener("pointerdown",f,!1),()=>document.removeEventListener("pointerdown",f,!1)}},[i]),g("div",{className:re("popover",c),ref:u,tabIndex:-1,children:e})},Zn="separator",m7e=ae.memo(({actionManager:e,items:t,top:n,left:i,onClose:s})=>{const r=Op(),o=Wy(),a=t.reduce((l,c)=>(c&&(c===Zn||!c.predicate||c.predicate(o,r,e.app.props,e.app))&&l.push(c),l),[]);return g(g7e,{onCloseRequest:()=>{s()},top:n,left:i,fitInViewport:!0,offsetLeft:r.offsetLeft,offsetTop:r.offsetTop,viewportWidth:r.width,viewportHeight:r.height,className:"context-menu-popover",children:g("ul",{className:"context-menu",onContextMenu:l=>l.preventDefault(),children:a.map((l,c)=>{var f;if(l===Zn)return!a[c-1]||a[c-1]===Zn?null:g("hr",{className:"context-menu-item-separator"},c);const u=l.name;let d="";return l.label&&(typeof l.label=="function"?d=M(l.label(o,r,e.app)):d=M(l.label)),g("li",{"data-testid":u,onClick:()=>{s(()=>{e.executeAction(l,"contextMenu")})},children:N("button",{type:"button",className:re("context-menu-item",{dangerous:u==="deleteSelectedElements",checkmark:(f=l.checked)==null?void 0:f.call(l,r)}),children:[g("div",{className:"context-menu-item__label",children:d}),g("kbd",{className:"context-menu-item__shortcut",children:u?Ki(u):""})]})},c)})})})}),p7e=({height:e,width:t,userToFollow:n,onDisconnect:i})=>g("div",{className:"follow-mode",style:{width:t,height:e},children:N("div",{className:"follow-mode__badge",children:[N("div",{className:"follow-mode__badge__label",children:["Following"," ",g("span",{className:"follow-mode__badge__username",title:n.username,children:n.username})]}),g("button",{type:"button",onClick:i,className:"follow-mode__disconnect-btn",children:Vd})]})}),dj=({delay:e,theme:t})=>{const[n,i]=D.useState(!!e);return D.useEffect(()=>{if(!e)return;const s=setTimeout(()=>{i(!1)},e);return()=>clearTimeout(s)},[e]),n?null:N("div",{className:re("LoadingMessage",{"LoadingMessage--dark":t===ke.DARK}),children:[g("div",{children:g(cl,{})}),g("div",{className:"LoadingMessage-text",children:M("labels.loadingScene")})]})},U7e="medium",TD={CHECKED:D_,UNCHECKED:ay},b7e=e=>N("label",{className:re("ToolIcon ToolIcon__lock",`ToolIcon_size_${U7e}`,{"is-mobile":e.isMobile}),title:`${e.title}  Q`,children:[g("input",{className:"ToolIcon_type_checkbox",type:"checkbox",name:e.name,onChange:e.onChange,checked:e.checked,"aria-label":e.title,"data-testid":"toolbar-lock"}),g("div",{className:"ToolIcon__icon",children:e.checked?TD.CHECKED:TD.UNCHECKED})]}),fj=e=>g($e,{className:re("Shape",{fillable:!1,active:e.checked}),type:"radio",icon:SV,name:"editor-current-shape",checked:e.checked,title:`${e.title}  H`,keyBindingLabel:e.isMobile?void 0:H.H.toLocaleUpperCase(),"aria-label":`${e.title}  H`,"aria-keyshortcuts":H.H,"data-testid":"toolbar-hand",onChange:()=>{var t;return(t=e.onChange)==null?void 0:t.call(e)}}),C3=[{type:"rectangle",icon:L_,title:Mt(M("toolBar.rectangle"))},{type:"diamond",icon:N_,title:Mt(M("toolBar.diamond"))},{type:"ellipse",icon:O_,title:Mt(M("toolBar.ellipse"))}],A3=[{type:"selection",icon:ly,title:Mt(M("toolBar.selection"))},{type:"lasso",icon:T0,title:Mt(M("toolBar.lasso"))}],M3=[{type:"arrow",icon:pV,title:Mt(M("toolBar.arrow"))},{type:"line",icon:P_,title:Mt(M("toolBar.line"))}],y7e=({app:e,onHandToolToggle:t,setAppState:n})=>{var P,L;const i=e.state.activeTool,[s,r]=D.useState(!1),[o,a]=D.useState("rectangle"),[l,c]=D.useState("arrow"),u=D.useRef(null);D.useEffect(()=>{(i.type==="rectangle"||i.type==="diamond"||i.type==="ellipse")&&a(i.type)},[i.type]),D.useEffect(()=>{(i.type==="arrow"||i.type==="line")&&c(i.type)},[i.type]);const d=i.type==="frame",f=i.type==="laser",h=i.type==="embeddable",{TTDDialogTriggerTunnel:m}=Ji(),p=(X,G)=>{e.state.activeTool.type!==X&&Qe("toolbar",X,"ui"),X==="selection"?e.state.activeTool.type==="selection"||e.setActiveTool({type:"selection"}):e.setActiveTool({type:X})},U=((L=(P=u.current)==null?void 0:P.getBoundingClientRect())==null?void 0:L.width)??-8,b=36,y=4,w=7,v=w*b+(w-1)*y,I=b+y,C=U>=v+1*I,_=U>=v+2*I,T=U>=v+3*I,S=["text","frame","embeddable","laser","magicframe"].filter(X=>!(_&&X==="image"||T&&X==="frame")).includes(i.type),R=S?i.type==="frame"?Qu:i.type==="embeddable"?S6:i.type==="laser"?pm:i.type==="text"?hh:i.type==="magicframe"?C6:tv:tv;return N("div",{className:"mobile-toolbar",ref:u,children:[g(fj,{checked:Yh(e.state),onChange:t,title:M("toolBar.hand"),isMobile:!0}),g(Q2,{app:e,options:A3,activeTool:i,defaultOption:e.state.preferredSelectionTool.type,namePrefix:"selectionType",title:Mt(M("toolBar.selection")),"data-testid":"toolbar-selection",onToolChange:X=>{(X==="selection"||X==="lasso")&&(e.setActiveTool({type:X}),n({preferredSelectionTool:{type:X,initialized:!0}}))},displayedOption:A3.find(X=>X.type===e.state.preferredSelectionTool.type)||A3[0]}),g($e,{className:re({active:i.type==="freedraw"}),type:"radio",icon:Sp,checked:i.type==="freedraw",name:"editor-current-shape",title:`${Mt(M("toolBar.freedraw"))}`,"aria-label":Mt(M("toolBar.freedraw")),"data-testid":"toolbar-freedraw",onChange:()=>p("freedraw")}),g($e,{className:re({active:i.type==="eraser"}),type:"radio",icon:UV,checked:i.type==="eraser",name:"editor-current-shape",title:`${Mt(M("toolBar.eraser"))}`,"aria-label":Mt(M("toolBar.eraser")),"data-testid":"toolbar-eraser",onChange:()=>p("eraser")}),g(Q2,{app:e,options:C3,activeTool:i,defaultOption:o,namePrefix:"shapeType",title:Mt(M(o==="rectangle"?"toolBar.rectangle":o==="diamond"?"toolBar.diamond":o==="ellipse"?"toolBar.ellipse":"toolBar.rectangle")),"data-testid":"toolbar-rectangle",onToolChange:X=>{(X==="rectangle"||X==="diamond"||X==="ellipse")&&(a(X),e.setActiveTool({type:X}))},displayedOption:C3.find(X=>X.type===o)||C3[0]}),g(Q2,{app:e,options:M3,activeTool:i,defaultOption:l,namePrefix:"linearElementType",title:Mt(M(l==="arrow"?"toolBar.arrow":"toolBar.line")),"data-testid":"toolbar-arrow",fillable:!0,onToolChange:X=>{(X==="arrow"||X==="line")&&(c(X),e.setActiveTool({type:X}))},displayedOption:M3.find(X=>X.type===l)||M3[0]}),C&&g($e,{className:re({active:i.type==="text"}),type:"radio",icon:hh,checked:i.type==="text",name:"editor-current-shape",title:`${Mt(M("toolBar.text"))}`,"aria-label":Mt(M("toolBar.text")),"data-testid":"toolbar-text",onChange:()=>p("text")}),_&&g($e,{className:re({active:i.type==="image"}),type:"radio",icon:K4,checked:i.type==="image",name:"editor-current-shape",title:`${Mt(M("toolBar.image"))}`,"aria-label":Mt(M("toolBar.image")),"data-testid":"toolbar-image",onChange:()=>p("image")}),T&&g($e,{className:re({active:d}),type:"radio",icon:Qu,checked:d,name:"editor-current-shape",title:`${Mt(M("toolBar.frame"))}`,"aria-label":Mt(M("toolBar.frame")),"data-testid":"toolbar-frame",onChange:()=>p("frame")}),N(Be,{open:s,placement:"top",children:[g(Be.Trigger,{className:re("App-toolbar__extra-tools-trigger App-toolbar__extra-tools-trigger--mobile",{"App-toolbar__extra-tools-trigger--selected":S||s}),onToggle:()=>{r(!s),n({openMenu:null,openPopup:null})},title:M("toolBar.extraTools"),style:{width:b,height:b,display:"flex",alignItems:"center",justifyContent:"center"},children:R}),N(Be.Content,{onClickOutside:()=>r(!1),onSelect:()=>r(!1),className:"App-toolbar__extra-tools-dropdown",children:[!C&&g(Be.Item,{onSelect:()=>e.setActiveTool({type:"text"}),icon:hh,shortcut:H.T.toLocaleUpperCase(),"data-testid":"toolbar-text",selected:i.type==="text",children:M("toolBar.text")}),!_&&g(Be.Item,{onSelect:()=>e.setActiveTool({type:"image"}),icon:K4,"data-testid":"toolbar-image",selected:i.type==="image",children:M("toolBar.image")}),!T&&g(Be.Item,{onSelect:()=>e.setActiveTool({type:"frame"}),icon:Qu,shortcut:H.F.toLocaleUpperCase(),"data-testid":"toolbar-frame",selected:d,children:M("toolBar.frame")}),g(Be.Item,{onSelect:()=>e.setActiveTool({type:"embeddable"}),icon:S6,"data-testid":"toolbar-embeddable",selected:h,children:M("toolBar.embeddable")}),g(Be.Item,{onSelect:()=>e.setActiveTool({type:"laser"}),icon:pm,"data-testid":"toolbar-laser",selected:f,shortcut:H.K.toLocaleUpperCase(),children:M("toolBar.laser")}),g("div",{style:{margin:"6px 0",fontSize:14,fontWeight:600},children:"Generate"}),e.props.aiEnabled!==!1&&g(m.Out,{}),g(Be.Item,{onSelect:()=>e.setOpenDialog({name:"ttd",tab:"mermaid"}),icon:$_,"data-testid":"toolbar-embeddable",children:M("toolBar.mermaidToExcalidraw")}),e.props.aiEnabled!==!1&&e.plugins.diagramToCode&&g(fe,{children:N(Be.Item,{onSelect:()=>e.onMagicframeToolSelect(),icon:C6,"data-testid":"toolbar-magicframe",children:[M("toolBar.magicframe"),g(Be.Item.Badge,{children:"AI"})]})})]})]})]})},hj=({children:e,side:t,className:n})=>g("div",{className:re("FixedSideContainer",`FixedSideContainer_side_${t}`,n),children:e}),E7e=({appState:e,elements:t,actionManager:n,setAppState:i,onHandToolToggle:s,renderTopLeftUI:r,renderTopRightUI:o,renderSidebars:a,renderWelcomeScreen:l,UIOptions:c,app:u})=>{var U;const{WelcomeScreenCenterTunnel:d,MainMenuTunnel:f,DefaultSidebarTriggerTunnel:h}=Ji(),m=()=>{var w;const b=(o==null?void 0:o(!0,e))??g(h.Out,{}),y=N("div",{className:"excalidraw-ui-top-left",children:[r==null?void 0:r(!0,e),g(f.Out,{})]});return e.viewModeEnabled||((w=e.openDialog)==null?void 0:w.name)==="elementLinkSelector"?g("div",{className:"App-toolbar-content",children:y}):N("div",{className:"App-toolbar-content",style:{display:"flex",flexDirection:"row",justifyContent:"space-between"},children:[y,b]})},p=()=>g(y7e,{app:u,onHandToolToggle:s,setAppState:i});return N(fe,{children:[a(),g("div",{className:"App-welcome-screen",children:l&&g(d.Out,{})}),N("div",{className:"App-bottom-bar",style:{marginBottom:So+Hl},children:[g(Q8e,{appState:e,elementsMap:u.scene.getNonDeletedElementsMap(),renderAction:n.renderAction,app:u,setAppState:i}),N(vr,{className:"App-toolbar",children:[!e.viewModeEnabled&&((U=e.openDialog)==null?void 0:U.name)!=="elementLinkSelector"&&p(),e.scrolledOutside&&!e.openMenu&&!e.openSidebar&&g("button",{type:"button",className:"scroll-back-to-content",onClick:()=>{i(b=>({...mm(t,b)}))},children:M("buttons.scrollBackToContent")})]})]}),g(hj,{side:"top",className:"App-top-bar",children:m()})]})},ID=e=>{const t=D.useRef(null),[n,i]=D.useState(null);return D.useLayoutEffect(()=>{if(!e.spreadsheet)return;const s=tye(e.chartType,e.spreadsheet,0,0);i(s);let r;const o=t.current;return(async()=>{var a;r=await ST(s,{exportBackground:!1,viewBackgroundColor:Ui.white},null,{skipInliningFonts:!0}),(a=r.querySelector(".style-fonts"))==null||a.remove(),o.replaceChildren(),o.appendChild(r),e.selected&&o.parentNode.focus()})(),()=>{o.replaceChildren()}},[e.spreadsheet,e.chartType,e.selected]),g("button",{type:"button",className:"ChartPreview",onClick:()=>{n&&e.onClick(e.chartType,n)},children:g("div",{ref:t})})},v7e=({setAppState:e,appState:t,onClose:n})=>{const{onInsertElements:i}=go(),s=ae.useCallback(()=>{n&&n()},[n]),r=(o,a)=>{i(a),Qe("paste","chart",o),e({currentChartType:o,pasteDialog:{shown:!1,data:null}})};return g(ir,{size:"small",onCloseRequest:s,title:M("labels.pasteCharts"),className:"PasteChartDialog",autofocus:!1,children:N("div",{className:"container",children:[g(ID,{chartType:"bar",spreadsheet:t.pasteDialog.data,selected:t.currentChartType==="bar",onClick:r}),g(ID,{chartType:"line",spreadsheet:t.pasteDialog.data,selected:t.currentChartType==="line",onClick:r})]})})},Rv=({heading:e,children:t,...n})=>{const{id:i}=Lr(),s=g("h2",{className:"visually-hidden",id:`${i}-${e}-title`,children:M(`headings.${e}`)});return g("section",{...n,"aria-labelledby":`${i}-${e}-title`,children:typeof t=="function"?t(s):N(fe,{children:[s,t]})})},w7e=4,_7e=8,T7e=({shouldWrap:e,children:t,username:n})=>e?g(hl,{label:n||"Unknown user",children:t}):g(fe,{children:t}),k3=({actionManager:e,collaborator:t,socketId:n,withName:i=!1,shouldWrapWithTooltip:s=!1,isBeingFollowed:r})=>{const o={socketId:n,collaborator:t,withName:i,isBeingFollowed:r},a=e.renderAction("goToCollaborator",o);return g(T7e,{username:t.username,shouldWrap:s,children:a},n)},I7e=["avatarUrl","id","socketId","username","isInCall","isSpeaking","isMuted"],gj=ae.memo(({className:e,mobile:t,collaborators:n,userToFollow:i})=>{const s=ks(),r=new Map;n.forEach((p,U)=>{const b=p.id||U;r.set(b,{...p,socketId:U})});const o=Array.from(r.values()).filter(p=>{var U;return(U=p.username)==null?void 0:U.trim()}),[a,l]=ae.useState(""),c=o.filter(p=>{var U;return(U=p.username)==null?void 0:U.toLowerCase().includes(a)}),u=ae.useRef(null);D.useLayoutEffect(()=>{if(u.current){const p=b=>{const y=Math.max(1,Math.min(8,Math.floor(b/38)));f(y)};if(p(u.current.clientWidth),!u4)return;const U=new ResizeObserver(b=>{for(const y of b){const{width:w}=y.contentRect;p(w)}});return U.observe(u.current),()=>{U.disconnect()}}},[]);const[d,f]=ae.useState(w7e),m=o.slice(0,d-1).map(p=>k3({actionManager:s,collaborator:p,socketId:p.socketId,shouldWrapWithTooltip:!0,isBeingFollowed:p.socketId===i}));return t?g("div",{className:re("UserList UserList_mobile",e),children:o.map(p=>k3({actionManager:s,collaborator:p,socketId:p.socketId,shouldWrapWithTooltip:!0,isBeingFollowed:p.socketId===i}))}):g("div",{className:"UserList__wrapper",ref:u,children:N("div",{className:re("UserList",e),style:{"--max-avatars":d},children:[m,o.length>d-1&&N(wl,{children:[N(_l,{className:"UserList__more",children:["+",o.length-d+1]}),g(py,{style:{zIndex:2,width:"15rem",textAlign:"left"},align:"end",sideOffset:10,children:N(vr,{padding:2,children:[o.length>=_7e&&g(N$,{placeholder:M("quickSearch.placeholder"),onChange:l}),g(O$,{className:"dropdown-menu UserList__collaborators",placeholder:M("userList.empty"),children:c.length>0?[g("div",{className:"hint",children:M("userList.hint.text")}),c.map(p=>k3({actionManager:s,collaborator:p,socketId:p.socketId,withName:!0,isBeingFollowed:p.socketId===i}))]:[]}),g(M$,{width:20,height:10,style:{fill:"var(--popup-bg-color)",filter:"drop-shadow(rgba(0, 0, 0, 0.05) 0px 3px 2px)"}})]})})]})]})})},(e,t)=>{if(e.collaborators.size!==t.collaborators.size||e.mobile!==t.mobile||e.className!==t.className||e.userToFollow!==t.userToFollow)return!1;const n=t.collaborators.keys();for(const[i,s]of e.collaborators){const r=t.collaborators.get(i);if(!r||i!==n.next().value||!Wi(s,r,I7e))return!1}return!0}),S7e="medium",x7e=e=>e.penDetected?N("label",{className:re("ToolIcon ToolIcon__penMode",`ToolIcon_size_${S7e}`,{"is-mobile":e.isMobile}),title:`${e.title}`,children:[g("input",{className:"ToolIcon_type_checkbox",type:"checkbox",name:e.name,onChange:e.onChange,checked:e.checked,"aria-label":e.title}),g("div",{className:"ToolIcon__icon",children:ide})]}):null,C7e=e=>g("button",{className:"help-icon",onClick:e.onClick,type:"button",title:`${M("helpDialog.title")}  ?`,"aria-label":M("helpDialog.title"),children:F_}),mj=({appState:e,actionManager:t,showExitZenModeBtn:n,renderWelcomeScreen:i})=>{const{FooterCenterTunnel:s,WelcomeScreenHelpHintTunnel:r}=Ji();return N("footer",{role:"contentinfo",className:"layer-ui__wrapper__footer App-menu App-menu_bottom",children:[g("div",{className:re("layer-ui__wrapper__footer-left zen-mode-transition",{"layer-ui__wrapper__footer-left--transition-left":e.zenModeEnabled}),children:g(Va.Col,{gap:2,children:N(Rv,{heading:"canvasActions",children:[g(e3e,{renderAction:t.renderAction,zoom:e.zoom}),!e.viewModeEnabled&&g(t3e,{renderAction:t.renderAction,className:re("zen-mode-transition",{"layer-ui__wrapper__footer-left--transition-bottom":e.zenModeEnabled})})]})})}),g(s.Out,{}),g("div",{className:re("layer-ui__wrapper__footer-right zen-mode-transition",{"transition-right":e.zenModeEnabled}),children:N("div",{style:{position:"relative"},children:[i&&g(r.Out,{}),g(C7e,{onClick:()=>t.executeAction(RT)})]})}),g(n3e,{actionManager:t,showExitZenModeBtn:n})]})};mj.displayName="Footer";const pj=ae.createContext({}),Uj=({children:e,className:t})=>{const n=oi(),i=D.useContext(pj),s=!!(n.editor.canFitSidebar&&i.shouldRenderDockButton);return N("div",{className:re("sidebar__header",t),"data-testid":"sidebar-header",children:[e,N("div",{className:"sidebar__header__buttons",children:[s&&g(hl,{label:M("labels.sidebarLock"),children:g(Xc,{onSelect:()=>{var r;return(r=i.onDock)==null?void 0:r.call(i,!i.docked)},selected:!!i.docked,className:"sidebar__dock","data-testid":"sidebar-dock","aria-label":M("labels.sidebarLock"),children:Que})}),g(Xc,{"data-testid":"sidebar-close",className:"sidebar__close",onSelect:i.onCloseRequest,"aria-label":M("buttons.close"),children:Vd})]})]})};Uj.displayName="SidebarHeader";function A7e(e){const t=e+"CollectionProvider",[n,i]=Cp(t),[s,r]=n(t,{collectionRef:{current:null},itemMap:new Map}),o=h=>{const{scope:m,children:p}=h,U=ae.useRef(null),b=ae.useRef(new Map).current;return g(s,{scope:m,itemMap:b,collectionRef:U,children:p})};o.displayName=t;const a=e+"CollectionSlot",l=ae.forwardRef((h,m)=>{const{scope:p,children:U}=h,b=r(a,p),y=lo(m,b.collectionRef);return g(Um,{ref:y,children:U})});l.displayName=a;const c=e+"CollectionItemSlot",u="data-radix-collection-item",d=ae.forwardRef((h,m)=>{const{scope:p,children:U,...b}=h,y=ae.useRef(null),w=lo(m,y),v=r(c,p);return ae.useEffect(()=>(v.itemMap.set(y,{ref:y,...b}),()=>void v.itemMap.delete(y))),g(Um,{[u]:"",ref:w,children:U})});d.displayName=c;function f(h){const m=r(e+"CollectionConsumer",h);return ae.useCallback(()=>{const U=m.collectionRef.current;if(!U)return[];const b=Array.from(U.querySelectorAll(`[${u}]`));return Array.from(m.itemMap.values()).sort((v,I)=>b.indexOf(v.ref.current)-b.indexOf(I.ref.current))},[m.collectionRef,m.itemMap])}return[{Provider:o,Slot:l,ItemSlot:d},f,i]}var M7e=D.createContext(void 0);function bj(e){const t=D.useContext(M7e);return e||t||"ltr"}var R3="rovingFocusGroup.onEntryFocus",k7e={bubbles:!1,cancelable:!0},Yy="RovingFocusGroup",[Dv,yj,R7e]=A7e(Yy),[D7e,Ej]=Cp(Yy,[R7e]),[L7e,N7e]=D7e(Yy),vj=D.forwardRef((e,t)=>g(Dv.Provider,{scope:e.__scopeRovingFocusGroup,children:g(Dv.Slot,{scope:e.__scopeRovingFocusGroup,children:g(O7e,{...e,ref:t})})}));vj.displayName=Yy;var O7e=D.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:i,loop:s=!1,dir:r,currentTabStopId:o,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...d}=e,f=D.useRef(null),h=lo(t,f),m=bj(r),[p=null,U]=oT({prop:o,defaultProp:a,onChange:l}),[b,y]=D.useState(!1),w=ul(c),v=yj(n),I=D.useRef(!1),[C,_]=D.useState(0);return D.useEffect(()=>{const T=f.current;if(T)return T.addEventListener(R3,w),()=>T.removeEventListener(R3,w)},[w]),g(L7e,{scope:n,orientation:i,dir:m,loop:s,currentTabStopId:p,onItemFocus:D.useCallback(T=>U(T),[U]),onItemShiftTab:D.useCallback(()=>y(!0),[]),onFocusableItemAdd:D.useCallback(()=>_(T=>T+1),[]),onFocusableItemRemove:D.useCallback(()=>_(T=>T-1),[]),children:g(ps.div,{tabIndex:b||C===0?-1:0,"data-orientation":i,...d,ref:h,style:{outline:"none",...e.style},onMouseDown:Ri(e.onMouseDown,()=>{I.current=!0}),onFocus:Ri(e.onFocus,T=>{const k=!I.current;if(T.target===T.currentTarget&&k&&!b){const S=new CustomEvent(R3,k7e);if(T.currentTarget.dispatchEvent(S),!S.defaultPrevented){const R=v().filter(z=>z.focusable),P=R.find(z=>z.active),L=R.find(z=>z.id===p),G=[P,L,...R].filter(Boolean).map(z=>z.ref.current);Tj(G,u)}}I.current=!1}),onBlur:Ri(e.onBlur,()=>y(!1))})})}),wj="RovingFocusGroupItem",_j=D.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:i=!0,active:s=!1,tabStopId:r,...o}=e,a=Z_(),l=r||a,c=N7e(wj,n),u=c.currentTabStopId===l,d=yj(n),{onFocusableItemAdd:f,onFocusableItemRemove:h}=c;return D.useEffect(()=>{if(i)return f(),()=>h()},[i,f,h]),g(Dv.ItemSlot,{scope:n,id:l,focusable:i,active:s,children:g(ps.span,{tabIndex:u?0:-1,"data-orientation":c.orientation,...o,ref:t,onMouseDown:Ri(e.onMouseDown,m=>{i?c.onItemFocus(l):m.preventDefault()}),onFocus:Ri(e.onFocus,()=>c.onItemFocus(l)),onKeyDown:Ri(e.onKeyDown,m=>{if(m.key==="Tab"&&m.shiftKey){c.onItemShiftTab();return}if(m.target!==m.currentTarget)return;const p=B7e(m,c.orientation,c.dir);if(p!==void 0){if(m.metaKey||m.ctrlKey||m.altKey||m.shiftKey)return;m.preventDefault();let b=d().filter(y=>y.focusable).map(y=>y.ref.current);if(p==="last")b.reverse();else if(p==="prev"||p==="next"){p==="prev"&&b.reverse();const y=b.indexOf(m.currentTarget);b=c.loop?z7e(b,y+1):b.slice(y+1)}setTimeout(()=>Tj(b))}})})})});_j.displayName=wj;var P7e={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function F7e(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function B7e(e,t,n){const i=F7e(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(i))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(i)))return P7e[i]}function Tj(e,t=!1){const n=document.activeElement;for(const i of e)if(i===n||(i.focus({preventScroll:t}),document.activeElement!==n))return}function z7e(e,t){return e.map((n,i)=>e[(t+i)%e.length])}var H7e=vj,V7e=_j,HT="Tabs",[$7e,FCe]=Cp(HT,[Ej]),Ij=Ej(),[G7e,VT]=$7e(HT),Sj=D.forwardRef((e,t)=>{const{__scopeTabs:n,value:i,onValueChange:s,defaultValue:r,orientation:o="horizontal",dir:a,activationMode:l="automatic",...c}=e,u=bj(a),[d,f]=oT({prop:i,onChange:s,defaultProp:r});return g(G7e,{scope:n,baseId:Z_(),value:d,onValueChange:f,orientation:o,dir:u,activationMode:l,children:g(ps.div,{dir:u,"data-orientation":o,...c,ref:t})})});Sj.displayName=HT;var xj="TabsList",Cj=D.forwardRef((e,t)=>{const{__scopeTabs:n,loop:i=!0,...s}=e,r=VT(xj,n),o=Ij(n);return g(H7e,{asChild:!0,...o,orientation:r.orientation,dir:r.dir,loop:i,children:g(ps.div,{role:"tablist","aria-orientation":r.orientation,...s,ref:t})})});Cj.displayName=xj;var Aj="TabsTrigger",Mj=D.forwardRef((e,t)=>{const{__scopeTabs:n,value:i,disabled:s=!1,...r}=e,o=VT(Aj,n),a=Ij(n),l=Dj(o.baseId,i),c=Lj(o.baseId,i),u=i===o.value;return g(V7e,{asChild:!0,...a,focusable:!s,active:u,children:g(ps.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":c,"data-state":u?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:l,...r,ref:t,onMouseDown:Ri(e.onMouseDown,d=>{!s&&d.button===0&&d.ctrlKey===!1?o.onValueChange(i):d.preventDefault()}),onKeyDown:Ri(e.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&o.onValueChange(i)}),onFocus:Ri(e.onFocus,()=>{const d=o.activationMode!=="manual";!u&&!s&&d&&o.onValueChange(i)})})})});Mj.displayName=Aj;var kj="TabsContent",Rj=D.forwardRef((e,t)=>{const{__scopeTabs:n,value:i,forceMount:s,children:r,...o}=e,a=VT(kj,n),l=Dj(a.baseId,i),c=Lj(a.baseId,i),u=i===a.value,d=D.useRef(u);return D.useEffect(()=>{const f=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(f)},[]),g(gy,{present:s||u,children:({present:f})=>g(ps.div,{"data-state":u?"active":"inactive","data-orientation":a.orientation,role:"tabpanel","aria-labelledby":l,hidden:!f,id:c,tabIndex:0,...o,ref:t,style:{...e.style,animationDuration:d.current?"0s":void 0},children:f&&r})})});Rj.displayName=kj;function Dj(e,t){return`${e}-trigger-${t}`}function Lj(e,t){return`${e}-content-${t}`}var Nj=Sj,Oj=Cj,Pj=Mj,Fj=Rj;const Bj=({children:e,tab:t,onSelect:n,...i})=>g(Pj,{value:t,asChild:!0,onSelect:n,children:g("button",{type:"button",className:"excalidraw-button sidebar-tab-trigger",...i,children:e})});Bj.displayName="SidebarTabTrigger";const zj=({children:e,...t})=>g(Oj,{className:"sidebar-triggers",...t,children:e});zj.displayName="SidebarTabTriggers";const Hj=({name:e,tab:t,icon:n,title:i,children:s,onToggle:r,className:o,style:a})=>{var u;const l=xn(),c=wi();return N("label",{title:i,className:"sidebar-trigger__label-element",children:[g("input",{className:"ToolIcon_type_checkbox",type:"checkbox",onChange:d=>{var h;(h=document.querySelector(".layer-ui__wrapper"))==null||h.classList.remove("animate");const f=d.target.checked;l({openSidebar:f?{name:e,tab:t}:null,openMenu:null,openPopup:null}),r==null||r(f)},checked:((u=c.openSidebar)==null?void 0:u.name)===e,"aria-label":i,"aria-keyshortcuts":"0"}),N("div",{className:re("sidebar-trigger",o),style:a,children:[n&&g("div",{children:n}),s&&g("div",{className:"sidebar-trigger__label",children:s})]})]})};Hj.displayName="SidebarTrigger";const Vj=({children:e,...t})=>{const n=wi(),i=xn();if(!n.openSidebar)return null;const{name:s}=n.openSidebar;return g(Nj,{className:"sidebar-tabs-root",value:n.openSidebar.tab,onValueChange:r=>i(o=>({...o,openSidebar:{...o.openSidebar,name:s,tab:r}})),...t,children:e})};Vj.displayName="SidebarTabs";const $j=({tab:e,children:t,...n})=>g(Fj,{...n,value:e,"data-testid":e,children:t});$j.displayName="SidebarTab";const $T=Yt(!1),Gj=D.forwardRef(({name:e,children:t,onDock:n,docked:i,className:s,...r},o)=>{const a=xn(),l=ry($T);D.useLayoutEffect(()=>(l(!!i),()=>{l(!1)}),[l,i]);const c=D.useRef({});c.current.onCloseRequest=()=>{a({openSidebar:null})},c.current.onDock=h=>n==null?void 0:n(h),c.current=C2(c.current,{docked:i,shouldRenderDockButton:!!n&&i!=null});const u=D.useRef(null);D.useImperativeHandle(o,()=>u.current);const d=oi(),f=D.useCallback(()=>{document.querySelector(".Dialog")||a({openSidebar:null})},[a]);return cT(u,D.useCallback(h=>{h.target.closest(".sidebar-trigger")||(!i||!d.editor.canFitSidebar)&&f()},[f,i,d.editor.canFitSidebar])),D.useEffect(()=>{const h=m=>{m.key===H.ESCAPE&&(!i||!d.editor.canFitSidebar)&&f()};return document.addEventListener(te.KEYDOWN,h),()=>{document.removeEventListener(te.KEYDOWN,h)}},[f,i,d.editor.canFitSidebar]),g(vr,{...r,className:re(Zs.SIDEBAR,{"sidebar--docked":i},s),ref:u,children:g(pj.Provider,{value:c.current,children:t})})});Gj.displayName="SidebarInner";const xo=Object.assign(D.forwardRef((e,t)=>{var l;const n=wi(),{onStateChange:i}=e,s=D.useRef(n.openSidebar);D.useEffect(()=>{var c,u,d,f,h;(!n.openSidebar&&((c=s==null?void 0:s.current)==null?void 0:c.name)===e.name||((u=n.openSidebar)==null?void 0:u.name)===e.name&&((d=s==null?void 0:s.current)==null?void 0:d.name)!==e.name||((f=s.current)==null?void 0:f.name)===e.name)&&n.openSidebar!==s.current&&(i==null||i(((h=n.openSidebar)==null?void 0:h.name)!==e.name?null:n.openSidebar)),s.current=n.openSidebar},[n.openSidebar,i,e.name]);const[r,o]=D.useState(!1);return D.useLayoutEffect(()=>(o(!0),()=>o(!1)),[]),r&&((l=n.openSidebar)==null?void 0:l.name)===e.name?D.createElement(Gj,{...e,ref:t,key:e.name}):null}),{Header:Uj,TabTriggers:zj,TabTrigger:Bj,Tabs:Vj,Tab:$j,Trigger:Hj});xo.displayName="Sidebar";const Lp=(e,t)=>{const n=Yt(0),i=s=>{const{tunnelsJotai:{useAtom:r}}=Ji(),[,o]=r(n),a=D.useRef({preferHost:!1,counter:0});return D.useLayoutEffect(()=>{const l=a.current;return o(c=>{const u=c+1;return l.counter=u,u}),()=>{o(c=>{const u=c-1;return l.counter=u,u||(l.preferHost=!1),u})}},[o]),s.__fallback||(a.current.preferHost=!0),!a.current.counter&&s.__fallback&&a.current.preferHost||a.current.counter>1&&s.__fallback?null:g(t,{...s})};return i.displayName=e,i},Xj=Yt({active:!1});async function Lv({title:e,description:t,actionLabel:n,color:i}){return new Promise(s=>{Hs.set(Xj,{active:!0,onConfirm:()=>s(!0),onClose:()=>s(!1),onReject:()=>s(!1),title:e,description:t,actionLabel:n,color:i})})}const jj=function({onChange:e,value:t,choices:n,name:i}){return g("div",{className:"RadioGroup",children:n.map(s=>N("div",{className:re("RadioGroup__choice",{active:s.value===t}),title:s.ariaLabel,children:[g("input",{name:i,type:"radio",checked:s.value===t,onChange:()=>e(s.value),"aria-label":s.ariaLabel}),s.label]},String(s.value)))})},Yj=({value:e,shortcut:t,onChange:n,choices:i,children:s,name:r})=>{const o=oi();return N(fe,{children:[N("div",{className:"dropdown-menu-item-base dropdown-menu-item-bare",children:[g("label",{className:"dropdown-menu-item__text",htmlFor:r,children:s}),g(jj,{name:r,value:e,onChange:n,choices:i})]}),t&&!o.editor.isMobile&&g("div",{className:"dropdown-menu-item__shortcut dropdown-menu-item__shortcut--orphaned",children:t})]})};Yj.displayName="DropdownMenuItemContentRadio";const Wj=()=>{const{t:e}=dn(),t=ks(),n=Wy();return t.isActionEnabled(yv)?g(Ms,{icon:z_,onSelect:async()=>{(!n.length||await Lv({title:e("overwriteConfirm.modal.loadFromFile.title"),actionLabel:e("overwriteConfirm.modal.loadFromFile.button"),color:"warning",description:g(Ts,{i18nKey:"overwriteConfirm.modal.loadFromFile.description",bold:s=>g("strong",{children:s}),br:()=>g("br",{})})}))&&t.executeAction(yv)},"data-testid":"load-button",shortcut:Ki("loadScene"),"aria-label":e("buttons.load"),children:e("buttons.load")}):null};Wj.displayName="LoadScene";const Kj=()=>{const{t:e}=dn(),t=ks();return t.isActionEnabled($6)?g(Ms,{shortcut:Ki("saveScene"),"data-testid":"save-button",onSelect:()=>t.executeAction($6),icon:cde,"aria-label":`${e("buttons.save")}`,children:`${e("buttons.save")}`}):null};Kj.displayName="SaveToActiveFile";const Zj=()=>{const e=xn(),{t}=dn();return g(Ms,{icon:EV,"data-testid":"image-export-button",onSelect:()=>e({openDialog:{name:"imageExport"}}),shortcut:Ki("imageExport"),"aria-label":t("buttons.exportImage"),children:t("buttons.exportImage")})};Zj.displayName="SaveAsImage";const qj=e=>{const t=xn(),{t:n}=dn();return g(Ms,{icon:nv,"data-testid":"command-palette-button",onSelect:()=>{Qe("command_palette","open","menu"),t({openDialog:{name:"commandPalette"}})},shortcut:Ki("commandPalette"),"aria-label":n("commandPalette.title"),className:e==null?void 0:e.className,children:n("commandPalette.title")})};qj.displayName="CommandPalette";const Qj=e=>{const{t}=dn(),n=ks();return g(Ms,{icon:pd,"data-testid":"search-menu-button",onSelect:()=>{n.executeAction(tj)},shortcut:Ki("searchMenu"),"aria-label":t("search.title"),className:e==null?void 0:e.className,children:t("search.title")})};Qj.displayName="SearchMenu";const Jj=()=>{const{t:e}=dn(),t=ks();return g(Ms,{"data-testid":"help-menu-item",icon:F_,onSelect:()=>t.executeAction(RT),shortcut:"?","aria-label":e("helpDialog.title"),children:e("helpDialog.title")})};Jj.displayName="Help";const eY=()=>{const{t:e}=dn(),t=ry(Xy);return ks().isActionEnabled(S0)?g(Ms,{icon:Hc,onSelect:()=>t("clearCanvas"),"data-testid":"clear-canvas-button","aria-label":e("buttons.clearReset"),children:e("buttons.clearReset")}):null};eY.displayName="ClearCanvas";const tY=e=>{const{t}=dn(),n=wi(),i=ks(),s=Ki("toggleTheme");return i.isActionEnabled(N6)?e!=null&&e.allowSystemTheme?g(Yj,{name:"theme",value:e.theme,onChange:r=>e.onSelect(r),choices:[{value:ke.LIGHT,label:Q4,ariaLabel:`${t("buttons.lightMode")} - ${s}`},{value:ke.DARK,label:q4,ariaLabel:`${t("buttons.darkMode")} - ${s}`},{value:"system",label:Sfe,ariaLabel:t("buttons.systemMode")}],children:t("labels.theme")}):g(Ms,{onSelect:r=>{if(r.preventDefault(),e!=null&&e.onSelect)e.onSelect(n.theme===ke.DARK?ke.LIGHT:ke.DARK);else return i.executeAction(N6)},icon:n.theme===ke.DARK?Q4:q4,"data-testid":"toggle-dark-mode",shortcut:s,"aria-label":n.theme===ke.DARK?t("buttons.lightMode"):t("buttons.darkMode"),children:n.theme===ke.DARK?t("buttons.lightMode"):t("buttons.darkMode")}):null};tY.displayName="ToggleTheme";const nY=()=>{const{t:e}=dn(),t=wi(),n=ks(),i=Np();return t.viewModeEnabled||!i.UIOptions.canvasActions.changeViewBackgroundColor?null:N("div",{style:{marginTop:"0.5rem"},children:[g("div",{"data-testid":"canvas-background-label",style:{fontSize:".75rem",marginBottom:".5rem"},children:e("labels.canvasBackground")}),g("div",{style:{padding:"0 0.625rem"},children:n.renderAction("changeViewBackgroundColor")})]})};nY.displayName="ChangeCanvasBackground";const iY=()=>{const{t:e}=dn(),t=xn();return g(Ms,{icon:cy,onSelect:()=>{t({openDialog:{name:"jsonExport"}})},"data-testid":"json-export-button","aria-label":e("buttons.export"),children:e("buttons.export")})};iY.displayName="Export";const sY=()=>{const{t:e}=dn();return N(fe,{children:[g(D0,{icon:B_,href:"https://github.com/excalidraw/excalidraw","aria-label":"GitHub",children:"GitHub"}),g(D0,{icon:yV,href:"https://x.com/excalidraw","aria-label":"X",children:e("labels.followUs")}),g(D0,{icon:bV,href:"https://discord.gg/UexuTaE","aria-label":"Discord",children:e("labels.discordChat")})]})};sY.displayName="Socials";const rY=({onSelect:e,isCollaborating:t})=>{const{t:n}=dn();return g(Ms,{"data-testid":"collab-button",icon:V_,className:re({"active-collab":t}),onSelect:e,children:n("labels.liveCollaboration")})};rY.displayName="LiveCollaborationTrigger";const X7e=Object.freeze(Object.defineProperty({__proto__:null,ChangeCanvasBackground:nY,ClearCanvas:eY,CommandPalette:qj,Export:iY,Help:Jj,LiveCollaborationTrigger:rY,LoadScene:Wj,SaveAsImage:Zj,SaveToActiveFile:Kj,SearchMenu:Qj,Socials:sY,ToggleTheme:tY},Symbol.toStringTag,{value:"Module"})),Tt=Object.assign(Lp("MainMenu",({children:e,onSelect:t})=>{var o;const{MainMenuTunnel:n}=Ji(),i=oi(),s=wi(),r=xn();return g(n.In,{children:N(Be,{open:s.openMenu==="canvas",children:[g(Be.Trigger,{onToggle:()=>{r({openMenu:s.openMenu==="canvas"?null:"canvas",openPopup:null,openDialog:null})},"data-testid":"main-menu-trigger",className:"main-menu-trigger",children:ode}),N(Be.Content,{onClickOutside:()=>r({openMenu:null}),onSelect:Y5(t,()=>{r({openMenu:null})}),placement:"bottom",className:i.editor.isMobile?"main-menu-dropdown":"",children:[e,i.editor.isMobile&&s.collaborators.size>0&&N("fieldset",{className:"UserList-Wrapper",children:[g("legend",{children:M("labels.collaborators")}),g(gj,{mobile:!0,collaborators:s.collaborators,userToFollow:((o=s.userToFollow)==null?void 0:o.socketId)||null})]})]})]})})}),{Trigger:Be.Trigger,Item:Be.Item,ItemLink:Be.ItemLink,ItemCustom:Be.ItemCustom,Group:Be.Group,Separator:Be.Separator,DefaultItems:X7e}),io=D.forwardRef(({children:e,icon:t,onClick:n,label:i,variant:s="filled",color:r="primary",size:o="medium",fullWidth:a,className:l,status:c},u)=>{const[d,f]=D.useState(!1),h=async p=>{const U=n==null?void 0:n(p);if(mp(U)){const b=window.setTimeout(()=>{f(!0)},50);try{await U}catch(y){if(y instanceof Gh)console.warn(y);else throw y}finally{clearTimeout(b),f(!1)}}},m=d?"loading":c;return r=m==="success"?"success":r,g("button",{className:re("ExcButton",`ExcButton--color-${r}`,`ExcButton--variant-${s}`,`ExcButton--size-${o}`,`ExcButton--status-${m}`,{"ExcButton--fullWidth":a},l),onClick:h,type:"button","aria-label":i,ref:u,disabled:m==="loading"||m==="success",children:N("div",{className:"ExcButton__contents",children:[m==="loading"?g(cl,{className:"ExcButton__statusIcon"}):m==="success"&&g("div",{className:"ExcButton__statusIcon",children:lfe}),t&&g("div",{className:"ExcButton__icon","aria-hidden":!0,children:t}),s!=="icon"&&(e??i)]})})}),GT=({title:e,children:t,actionLabel:n,onClick:i})=>N("div",{className:"OverwriteConfirm__Actions__Action",children:[g("h4",{children:e}),g("div",{className:"OverwriteConfirm__Actions__Action__content",children:t}),g(io,{variant:"outlined",color:"muted",label:n,size:"large",fullWidth:!0,onClick:i})]}),j7e=()=>{const{t:e}=dn(),t=ks(),n=xn();return g(GT,{title:e("overwriteConfirm.action.exportToImage.title"),actionLabel:e("overwriteConfirm.action.exportToImage.button"),onClick:()=>{t.executeAction(fX,"ui",!0),n({openDialog:{name:"imageExport"}})},children:e("overwriteConfirm.action.exportToImage.description")})},Y7e=()=>{const{t:e}=dn(),t=ks();return g(GT,{title:e("overwriteConfirm.action.saveToDisk.title"),actionLabel:e("overwriteConfirm.action.saveToDisk.button"),onClick:()=>{t.executeAction(hX,"ui")},children:e("overwriteConfirm.action.saveToDisk.description")})},SD=Object.assign(({children:e})=>g("div",{className:"OverwriteConfirm__Actions",children:e}),{ExportToImage:j7e,SaveToDisk:Y7e}),Bu=Object.assign(Lp("OverwriteConfirmDialog",({children:e})=>{const{OverwriteConfirmDialogTunnel:t}=Ji(),[n,i]=un(Xj);if(!n.active)return null;const s=()=>{n.onClose(),i(o=>({...o,active:!1}))},r=()=>{n.onConfirm(),i(o=>({...o,active:!1}))};return g(t.In,{children:g(ir,{onCloseRequest:s,title:!1,size:916,children:N("div",{className:"OverwriteConfirm",children:[g("h3",{children:n.title}),N("div",{className:`OverwriteConfirm__Description OverwriteConfirm__Description--color-${n.color}`,children:[g("div",{className:"OverwriteConfirm__Description__icon",children:cfe}),g("div",{children:n.description}),g("div",{className:"OverwriteConfirm__Description__spacer"}),g(io,{color:n.color,size:"large",label:n.actionLabel,onClick:r})]}),g(SD,{children:e})]})})})}),{Actions:SD,Action:GT});var W7e="Expected a function",xD=NaN,K7e="[object Symbol]",Z7e=/^\s+|\s+$/g,q7e=/^[-+]0x[0-9a-f]+$/i,Q7e=/^0b[01]+$/i,J7e=/^0o[0-7]+$/i,e4e=parseInt,t4e=typeof La=="object"&&La&&La.Object===Object&&La,n4e=typeof self=="object"&&self&&self.Object===Object&&self,i4e=t4e||n4e||Function("return this")(),s4e=Object.prototype,r4e=s4e.toString,o4e=Math.max,a4e=Math.min,D3=function(){return i4e.Date.now()};function l4e(e,t,n){var i,s,r,o,a,l,c=0,u=!1,d=!1,f=!0;if(typeof e!="function")throw new TypeError(W7e);t=CD(t)||0,Nv(n)&&(u=!!n.leading,d="maxWait"in n,r=d?o4e(CD(n.maxWait)||0,t):r,f="trailing"in n?!!n.trailing:f);function h(C){var _=i,T=s;return i=s=void 0,c=C,o=e.apply(T,_),o}function m(C){return c=C,a=setTimeout(b,t),u?h(C):o}function p(C){var _=C-l,T=C-c,k=t-_;return d?a4e(k,r-T):k}function U(C){var _=C-l,T=C-c;return l===void 0||_>=t||_<0||d&&T>=r}function b(){var C=D3();if(U(C))return y(C);a=setTimeout(b,p(C))}function y(C){return a=void 0,f&&i?h(C):(i=s=void 0,o)}function w(){a!==void 0&&clearTimeout(a),c=0,i=l=s=a=void 0}function v(){return a===void 0?o:y(D3())}function I(){var C=D3(),_=U(C);if(i=arguments,s=this,l=C,_){if(a===void 0)return m(l);if(d)return a=setTimeout(b,t),h(l)}return a===void 0&&(a=setTimeout(b,t)),o}return I.cancel=w,I.flush=v,I}function Nv(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function c4e(e){return!!e&&typeof e=="object"}function u4e(e){return typeof e=="symbol"||c4e(e)&&r4e.call(e)==K7e}function CD(e){if(typeof e=="number")return e;if(u4e(e))return xD;if(Nv(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Nv(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(Z7e,"");var n=Q7e.test(e);return n||J7e.test(e)?e4e(e.slice(2),n?2:8):q7e.test(e)?xD:+e}var d4e=l4e;const f4e=bl(d4e),h4e=Yt(""),oY=Yt(null),g4e=350,m4e=()=>{const e=go(),t=xn(),n=D.useRef(null),[i,s]=un(h4e),r=i.trim(),[o,a]=D.useState(!1),[l,c]=D.useState({nonce:null,items:[]}),u=D.useRef(null),d=D.useRef(void 0),[f,h]=un(oY),m=e.scene.getNonDeletedElementsMap();D.useEffect(()=>{o||(r!==u.current||e.scene.getSceneNonce()!==d.current)&&(u.current=null,kD(r,e,(w,v)=>{c({nonce:Rr(),items:w}),u.current=r,d.current=e.scene.getSceneNonce(),t({searchMatches:w.length?{focusedId:null,matches:w.map(I=>({id:I.element.id,focus:!1,matchedLines:I.matchedLines}))}:null})}))},[o,r,m,e,t,h,d]);const p=()=>{l.items.length>0&&h(w=>w===null?0:(w+1)%l.items.length)},U=()=>{l.items.length>0&&h(w=>w===null?0:w-1<0?l.items.length-1:w-1)};D.useEffect(()=>{t(w=>{var I,C;return w.searchMatches?{searchMatches:{focusedId:f!==null&&((C=(I=w.searchMatches)==null?void 0:I.matches[f])==null?void 0:C.id)||null,matches:w.searchMatches.matches.map((_,T)=>T===f?{..._,focus:!0}:{..._,focus:!1})}}:null})},[f,t]),D.useEffect(()=>{var w,v,I,C;if(l.items.length>0&&f!==null){const _=l.items[f];if(_){const T=e.state.zoom.value,k=nr({text:_.searchQuery,x:_.element.x+(((w=_.matchedLines[0])==null?void 0:w.offsetX)??0),y:_.element.y+(((v=_.matchedLines[0])==null?void 0:v.offsetY)??0),width:(I=_.matchedLines[0])==null?void 0:I.width,height:(C=_.matchedLines[0])==null?void 0:C.height,fontSize:Ee(_.element)?Ft.nameFontSize:_.element.fontSize,fontFamily:Ee(_.element)?et.Assistant:_.element.fontFamily}),S=14,R=k.fontSize,P=R*T<S;if(!N2([k],e.canvas.width/window.devicePixelRatio,e.canvas.height/window.devicePixelRatio,{offsetLeft:e.state.offsetLeft,offsetTop:e.state.offsetTop,scrollX:e.state.scrollX,scrollY:e.state.scrollY,zoom:e.state.zoom},e.scene.getNonDeletedElementsMap(),e.getEditorUIOffsets())||P){let L;P?R>=S?L={fitToContent:!0}:L={fitToViewport:!0,maxZoom:ja(S/R,1)}:L={fitToContent:!0},e.scrollToContent(k,{animate:!0,duration:300,...L,canvasOffsets:e.getEditorUIOffsets()})}}}},[f,l,e]),D.useEffect(()=>()=>{h(null),u.current=null,d.current=void 0,t({searchMatches:null}),a(!1)},[t,h]);const b=Uy({goToNextItem:p,goToPreviousItem:U,searchMatches:l});D.useEffect(()=>{const w=v=>{var I,C,_;if(v.key===H.ESCAPE&&!e.state.openDialog&&!e.state.openPopup){v.preventDefault(),v.stopPropagation(),t({openSidebar:null});return}if(v[H.CTRL_OR_CMD]&&v.key===H.F){if(v.preventDefault(),v.stopPropagation(),e.state.openDialog)return;(I=n.current)!=null&&I.matches(":focus")||(e.state.openDialog&&t({openDialog:null}),(C=n.current)==null||C.focus(),(_=n.current)==null||_.select())}v.target instanceof HTMLElement&&v.target.closest(".layer-ui__search")&&b.searchMatches.items.length&&(v.key===H.ENTER&&(v.stopPropagation(),b.goToNextItem()),v.key===H.ARROW_UP?(v.stopPropagation(),b.goToPreviousItem()):v.key===H.ARROW_DOWN&&(v.stopPropagation(),b.goToNextItem()))};return Jt(window,te.KEYDOWN,w,{capture:!0,passive:!1})},[t,b,e]);const y=`${l.items.length} ${l.items.length===1?M("search.singleResult"):M("search.multipleResults")}`;return N("div",{className:"layer-ui__search",children:[g("div",{className:"layer-ui__search-header",children:g(Id,{className:Zs.SEARCH_MENU_INPUT_WRAPPER,value:i,ref:n,placeholder:M("search.placeholder"),icon:pd,onChange:w=>{s(w),a(!0);const v=w.trim();kD(v,e,(I,C)=>{c({nonce:Rr(),items:I}),h(C),u.current=v,d.current=e.scene.getSceneNonce(),t({searchMatches:I.length?{focusedId:null,matches:I.map(_=>({id:_.element.id,focus:!1,matchedLines:_.matchedLines}))}:null}),a(!1)})},selectOnRender:!0})}),N("div",{className:"layer-ui__search-count",children:[l.items.length>0&&N(fe,{children:[f!==null&&f>-1?N("div",{children:[f+1," / ",y]}):g("div",{children:y}),N("div",{className:"result-nav",children:[g(Xc,{onSelect:()=>{p()},className:"result-nav-btn",children:MV}),g(Xc,{onSelect:()=>{U()},className:"result-nav-btn",children:Mfe})]})]}),l.items.length===0&&r&&u.current&&g("div",{style:{margin:"1rem auto"},children:M("search.noMatch")})]}),g(b4e,{matches:l,onItemClick:h,focusIndex:f,searchQuery:r})]})},AD=e=>{const t=[e.preview.moreBefore?"...":"",e.preview.previewText.slice(0,e.preview.indexInSearchQuery),e.preview.previewText.slice(e.preview.indexInSearchQuery,e.preview.indexInSearchQuery+e.searchQuery.length),e.preview.previewText.slice(e.preview.indexInSearchQuery+e.searchQuery.length),e.preview.moreAfter?"...":""];return g("div",{tabIndex:-1,className:re("layer-ui__result-item",{active:e.highlighted}),onClick:e.onClick,ref:n=>{e.highlighted&&(n==null||n.scrollIntoView({behavior:"auto",block:"nearest"}))},children:g("div",{className:"preview-text",children:t.flatMap((n,i)=>g(D.Fragment,{children:i===2?g("b",{children:n}):n},i))})})},p4e=e=>{const t=D.useMemo(()=>e.matches.items.filter(i=>Ee(i.element)),[e.matches]),n=D.useMemo(()=>e.matches.items.filter(i=>de(i.element)),[e.matches]);return N("div",{children:[t.length>0&&N("div",{className:"layer-ui__search-result-container",children:[N("div",{className:"layer-ui__search-result-title",children:[g("div",{className:"title-icon",children:Qu}),g("div",{children:M("search.frames")})]}),t.map((i,s)=>g(AD,{searchQuery:e.searchQuery,preview:i.preview,highlighted:s===e.focusIndex,onClick:()=>e.onItemClick(s)},i.element.id+i.index)),n.length>0&&g("div",{className:"layer-ui__divider"})]}),n.length>0&&N("div",{className:"layer-ui__search-result-container",children:[N("div",{className:"layer-ui__search-result-title",children:[g("div",{className:"title-icon",children:hh}),g("div",{children:M("search.texts")})]}),n.map((i,s)=>g(AD,{searchQuery:e.searchQuery,preview:i.preview,highlighted:s+t.length===e.focusIndex,onClick:()=>e.onItemClick(s+t.length)},i.element.id+i.index))]})]})},U4e=(e,t)=>e.matches.nonce===t.matches.nonce&&e.focusIndex===t.focusIndex,b4e=D.memo(p4e,U4e),MD=(e,t,n)=>{const r=e.slice(0,t),o=r.split(/\s+/),a=r.endsWith(" "),l=o.length-2-1-(a?0:1);let c=o.slice(l<=0?0:l).join(" ")+(a?" ":"");c=c.length>20?c.slice(-20):c;const d=e.slice(t+n.length),f=d.split(/\s+/),h=!d.startsWith(" "),m=h?6:5,p=(h?"":" ")+f.slice(0,m).join(" ");return{indexInSearchQuery:c.length,previewText:c+n+p,moreBefore:l>0,moreAfter:f.length>m}},y4e=(e,t)=>{const n=e.split(`
`),i=[];let s=0;for(let r=0;r<n.length;r++){let o=n[r];const a=n[r+1];if(a){const l=t.indexOf(a,s);if(l>o.length+s){let c=l-(o.length+s);for(;c>0;)o+=" ",c--}}i.push(o),s=s+o.length}return i.join(`
`)},E4e=(e,t,n)=>{const s=y4e(e.text,e.originalText).split(`
`),r=[];let o=0,a=0;for(const d of s){const f=o,h=f+d.length-1;r.push({line:d,startIndex:f,endIndex:h,lineNumber:a}),o=h+1,a++}let l=n,c=e.originalText.slice(n,n+t.length);const u=[];for(const d of r){if(c==="")break;if(l>=d.startIndex&&l<=d.endIndex){const f=d.endIndex+1-l,h=d.line.slice(0,l-d.startIndex),m=c.slice(0,f);c=c.slice(f);const p=Xn(h,gt(e),e.lineHeight);if(h===""&&(p.width=0),e.textAlign!=="left"&&d.line.length>0){const v=Xn(d.line,gt(e),e.lineHeight),I=e.textAlign==="center"?(e.width-v.width)/2:e.width-v.width;p.width+=I}const{width:U,height:b}=Xn(m,gt(e),e.lineHeight),y=p.width,w=d.lineNumber*p.height;u.push({offsetX:y,offsetY:w,width:U,height:b,showOnCanvas:!0}),l+=f}}return u},v4e=(e,t,n,i)=>{const s=e.name??g_(e),r=s.slice(n,n+t.length),o=s.slice(0,n),a=gt({fontSize:Ft.nameFontSize,fontFamily:et.Assistant}),l=Oc(et.Assistant),c=Xn(o,a,l);o===""&&(c.width=0);const u=Xn(r,a,l),d=c.width,f=-c.height-Ft.strokeWidth,h=u.width;return[{offsetX:d,offsetY:f,width:h,height:u.height,showOnCanvas:d+h<=e.width*i}]},w4e=e=>e.replace(/[.*+?^${}()|[\]\\-]/g,"\\$&"),kD=f4e((e,t,n)=>{if(!e||e===""){n([],null);return}const i=t.scene.getNonDeletedElements(),s=i.filter(f=>de(f)),r=i.filter(f=>Ee(f));s.sort((f,h)=>f.y-h.y),r.sort((f,h)=>f.y-h.y);const o=[],a=new RegExp(w4e(e),"gi");for(const f of s){let h=null;const m=f.originalText;for(;(h=a.exec(m))!==null;){const p=MD(m,h.index,e),U=E4e(f,e,h.index);U.length>0&&o.push({element:f,searchQuery:e,preview:p,index:h.index,matchedLines:U})}}const l=[];for(const f of r){let h=null;const m=f.name??g_(f);for(;(h=a.exec(m))!==null;){const p=MD(m,h.index,e),U=v4e(f,e,h.index,t.state.zoom.value);U.length>0&&l.push({element:f,searchQuery:e,preview:p,index:h.index,matchedLines:U})}}const c=new Set(t.visibleElements.map(f=>f.id)),u=[...l,...o],d=u.findIndex(f=>c.has(f.element.id))??null;n(u,d)},g4e),aY=Lp("DefaultSidebarTrigger",e=>{const{DefaultSidebarTriggerTunnel:t}=Ji();return g(t.In,{children:g(xo.Trigger,{...e,className:"default-sidebar-trigger",name:Ir.name})})});aY.displayName="DefaultSidebarTrigger";const lY=({children:e})=>{const{DefaultSidebarTabTriggersTunnel:t}=Ji();return g(t.In,{children:e})};lY.displayName="DefaultTabTriggers";const RD=Object.assign(Lp("DefaultSidebar",({children:e,className:t,onDock:n,docked:i,...s})=>{var c;const r=wi(),o=xn(),{DefaultSidebarTabTriggersTunnel:a}=Ji(),l=((c=r.openSidebar)==null?void 0:c.tab)===Wu;return D.createElement(xo,{...s,name:"default",key:"default",className:re("default-sidebar",t),docked:l||(i??r.defaultSidebarDockedPreference),onDock:l||n===!1||!n&&i!=null?void 0:Y5(n,u=>{o({defaultSidebarDockedPreference:u})})},N(xo.Tabs,{children:[g(xo.Header,{children:N(xo.TabTriggers,{children:[g(xo.TabTrigger,{tab:Wu,children:pd}),g(xo.TabTrigger,{tab:$b,children:R_}),g(a.Out,{})]})}),g(xo.Tab,{tab:$b,children:g(p8e,{})}),g(xo.Tab,{tab:Wu,children:g(m4e,{})}),e]}))}),{Trigger:aY,TabTriggers:lY}),cY=({input:e,placeholder:t,onChange:n,onKeyboardSubmit:i})=>{const s=D.useRef(null),r=D.useRef(i);return r.current=i,D.useEffect(()=>{if(!r.current)return;const o=s.current;if(o){const a=l=>{var c;l[H.CTRL_OR_CMD]&&l.key===H.ENTER&&(l.preventDefault(),(c=r.current)==null||c.call(r))};return o.focus(),o.addEventListener(te.KEYDOWN,a),()=>{o.removeEventListener(te.KEYDOWN,a)}}},[]),g("textarea",{className:"ttd-dialog-input",onChange:n,value:e,placeholder:t,ref:s})},_4e=({error:e})=>N("div",{"data-testid":"ttd-dialog-output-error",className:"ttd-dialog-output-error",children:["Error! ",g("p",{children:e})]}),uY=({error:e,canvasRef:t,loaded:n})=>N("div",{className:"ttd-dialog-output-wrapper",children:[e&&g(_4e,{error:e.message}),n?g("div",{ref:t,style:{opacity:e?"0.15":1},className:"ttd-dialog-output-canvas-container"}):g(cl,{size:"2rem"})]}),Z6=({label:e,children:t,panelAction:n,panelActionDisabled:i=!1,onTextSubmitInProgess:s,renderTopRight:r,renderSubmitShortcut:o,renderBottomRight:a})=>N("div",{className:"ttd-dialog-panel",children:[N("div",{className:"ttd-dialog-panel__header",children:[g("label",{children:e}),r==null?void 0:r()]}),t,N("div",{className:re("ttd-dialog-panel-button-container",{invisible:!n}),style:{display:"flex",alignItems:"center"},children:[N(Xc,{className:"ttd-dialog-panel-button",onSelect:n?n.action:()=>{},disabled:i||s,children:[N("div",{className:re({invisible:s}),children:[n==null?void 0:n.label,(n==null?void 0:n.icon)&&g("span",{children:n.icon})]}),s&&g(cl,{})]}),!i&&!s&&(o==null?void 0:o()),a==null?void 0:a()]})]}),dY=({children:e})=>g("div",{className:"ttd-dialog-panels",children:e}),fY=()=>N("div",{className:"ttd-dialog-submit-shortcut",children:[g("div",{className:"ttd-dialog-submit-shortcut__key",children:J("CtrlOrCmd")}),g("div",{className:"ttd-dialog-submit-shortcut__key",children:J("Enter")})]}),T4e=({canvasRef:e,setError:t})=>{const n=e.current;if(!n)return;const i=n.parentElement;i&&(i.style.background="",t(null),n.replaceChildren())},hY=async({canvasRef:e,mermaidToExcalidrawLib:t,mermaidDefinition:n,setError:i,data:s})=>{const r=e.current,o=r==null?void 0:r.parentElement;if(!(!r||!o)){if(!n){T4e({canvasRef:e,setError:i});return}try{const a=await t.api;let l;try{l=await a.parseMermaidToExcalidraw(n)}catch{l=await a.parseMermaidToExcalidraw(n.replace(/"/g,"'"))}const{elements:c,files:u}=l;i(null),s.current={elements:Mv(c,{regenerateIds:!0}),files:u};const d=await Hy({elements:s.current.elements,files:s.current.files,exportPadding:pg,maxWidthOrHeight:Math.max(o.offsetWidth,o.offsetHeight)*window.devicePixelRatio});try{await Mm(d)}catch(f){throw f.name==="CANVAS_POSSIBLY_TOO_BIG"?new Error(M("canvasError.canvasTooBig")):f}o.style.background="var(--default-bg-color)",r.replaceChildren(d)}catch(a){throw o.style.background="var(--default-bg-color)",n&&i(a),a}}},XT=e=>{Ju.set(h0.MERMAID_TO_EXCALIDRAW,e)},gY=({app:e,data:t,text:n,shouldSaveMermaidDataToStorage:i})=>{const{elements:s,files:r}=t.current;s.length&&(e.addElementsFromPasteOrLibrary({elements:s,files:r,position:"center",fitToContent:!0}),e.setOpenDialog(null),i&&n&&XT(n))},I4e=`flowchart TD
 A[Christmas] -->|Get money| B(Go shopping)
 B --> C{Let me think}
 C -->|One| D[Laptop]
 C -->|Two| E[iPhone]
 C -->|Three| F[Car]`,DD=sl(XT,300),S4e=({mermaidToExcalidrawLib:e})=>{const[t,n]=D.useState(()=>Ju.get(h0.MERMAID_TO_EXCALIDRAW)||I4e),i=D.useDeferredValue(t.trim()),[s,r]=D.useState(null),o=D.useRef(null),a=D.useRef({elements:[],files:null}),l=go();D.useEffect(()=>{hY({canvasRef:o,data:a,mermaidToExcalidrawLib:e,setError:r,mermaidDefinition:i}).catch(u=>{}),DD(i)},[i,e]),D.useEffect(()=>()=>{DD.flush()},[]);const c=()=>{gY({app:l,data:a,text:t,shouldSaveMermaidDataToStorage:!0})};return N(fe,{children:[g("div",{className:"ttd-dialog-desc",children:g(Ts,{i18nKey:"mermaid.description",flowchartLink:u=>g("a",{href:"https://mermaid.js.org/syntax/flowchart.html",children:u}),sequenceLink:u=>g("a",{href:"https://mermaid.js.org/syntax/sequenceDiagram.html",children:u}),classLink:u=>g("a",{href:"https://mermaid.js.org/syntax/classDiagram.html",children:u})})}),N(dY,{children:[g(Z6,{label:M("mermaid.syntax"),children:g(cY,{input:t,placeholder:"Write Mermaid diagram defintion here...",onChange:u=>n(u.target.value),onKeyboardSubmit:()=>{c()}})}),g(Z6,{label:M("mermaid.preview"),panelAction:{action:()=>{c()},label:M("mermaid.button"),icon:F2},renderSubmitShortcut:()=>g(fY,{}),children:g(uY,{canvasRef:o,loaded:e.loaded,error:s})})]})]})},mY=e=>{const t=xn(),n=D.useRef(null),i=D.useRef(0);return g(Nj,{ref:n,className:"ttd-dialog-tabs-root",value:e.tab,onValueChange:s=>{var o;if(!s)return;const r=(o=n.current)==null?void 0:o.closest(".Modal__content");if(r){const a=r.offsetHeight||0;a>i.current&&(i.current=a,r.style.minHeight=`min(${i.current}px, 100%)`)}e.dialog==="ttd"&&MB(["text-to-diagram","mermaid"],s)&&t({openDialog:{name:e.dialog,tab:s}})},children:e.children})};mY.displayName="TTDDialogTabs";const pY=({children:e,...t})=>g(Oj,{className:"ttd-dialog-triggers",...t,children:e});pY.displayName="TTDDialogTabTriggers";const Ov=({children:e,tab:t,onSelect:n,...i})=>g(Pj,{value:t,asChild:!0,onSelect:n,children:g("button",{type:"button",className:"ttd-dialog-tab-trigger",...i,children:e})});Ov.displayName="TTDDialogTabTrigger";const Pv=({tab:e,children:t,...n})=>g(Fj,{...n,value:e,children:t});Pv.displayName="TTDDialogTab";const L3=3,ff=1e3,x4e=Yt(null),C4e=Yt(null),UY=e=>{var n;const t=wi();return((n=t.openDialog)==null?void 0:n.name)!=="ttd"?null:g(A4e,{...e,tab:t.openDialog.tab})},A4e=Lp("TTDDialogBase",({tab:e,...t})=>{const n=go(),i=xn(),s=D.useRef(null),[r,o]=un(C4e),[a,l]=D.useState((r==null?void 0:r.prompt)??""),c=a.trim(),u=C=>{l(C.target.value),o(_=>({generatedResponse:(_==null?void 0:_.generatedResponse)??null,prompt:C.target.value}))},[d,f]=D.useState(!1),[h,m]=un(x4e),p=async()=>{if(c.length>ff||c.length<L3||d||(h==null?void 0:h.rateLimitRemaining)===0||"__fallback"in t){c.length<L3&&I(new Error(`Prompt is too short (min ${L3} characters)`)),c.length>ff&&I(new Error(`Prompt is too long (max ${ff} characters)`));return}try{f(!0),Qe("ai","generate","ttd");const{generatedResponse:C,error:_,rateLimit:T,rateLimitRemaining:k}=await t.onTextSubmit(c);if(typeof C=="string"&&o(S=>({generatedResponse:C,prompt:(S==null?void 0:S.prompt)??null})),m0(T)&&m0(k)&&m({rateLimit:T,rateLimitRemaining:k}),_){I(_);return}if(!C){I(new Error("Generation failed"));return}try{await hY({canvasRef:s,data:w,mermaidToExcalidrawLib:b,setError:I,mermaidDefinition:C}),Qe("ai","mermaid parse success","ttd")}catch(S){console.info(`%cTTD mermaid render errror: ${S.message}`,"color: red"),console.info(`>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
TTD mermaid definition render errror: ${S.message}`,"color: yellow"),Qe("ai","mermaid parse failed","ttd"),I(new Error("Generated an invalid diagram :(. You may also try a different prompt."))}}catch(C){let _=C.message;(!_||_==="Failed to fetch")&&(_="Request failed"),I(new Error(_))}finally{f(!1)}},U=D.useRef(p);U.current=p;const[b,y]=D.useState({loaded:!1,api:ye(()=>import("./index-CicYZL9c.js").then(C=>C.b6),__vite__mapDeps([]))});D.useEffect(()=>{(async()=>{await b.api,y(_=>({..._,loaded:!0}))})()},[b.api]);const w=D.useRef({elements:[],files:null}),[v,I]=D.useState(null);return g(ir,{className:"ttd-dialog",onCloseRequest:()=>{n.setOpenDialog(null)},size:1200,title:!1,...t,autofocus:!1,children:N(mY,{dialog:"ttd",tab:e,children:["__fallback"in t&&t.__fallback?g("p",{className:"dialog-mermaid-title",children:M("mermaid.title")}):N(pY,{children:[g(Ov,{tab:"text-to-diagram",children:N("div",{style:{display:"flex",alignItems:"center"},children:[M("labels.textToDiagram"),g("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"1px 6px",marginLeft:"10px",fontSize:10,borderRadius:"12px",background:"var(--color-promo)",color:"var(--color-surface-lowest)"},children:"AI Beta"})]})}),g(Ov,{tab:"mermaid",children:"Mermaid"})]}),g(Pv,{className:"ttd-dialog-content",tab:"mermaid",children:g(S4e,{mermaidToExcalidrawLib:b})}),!("__fallback"in t)&&N(Pv,{className:"ttd-dialog-content",tab:"text-to-diagram",children:[g("div",{className:"ttd-dialog-desc",children:"Currently we use Mermaid as a middle step, so you'll get best results if you describe a diagram, workflow, flow chart, and similar."}),N(dY,{children:[g(Z6,{label:M("labels.prompt"),panelAction:{action:p,label:"Generate",icon:F2},onTextSubmitInProgess:d,panelActionDisabled:c.length>ff||(h==null?void 0:h.rateLimitRemaining)===0,renderTopRight:()=>h?N("div",{className:"ttd-dialog-rate-limit",style:{fontSize:12,marginLeft:"auto",color:h.rateLimitRemaining===0?"var(--color-danger)":void 0},children:[h.rateLimitRemaining," requests left today"]}):null,renderSubmitShortcut:()=>g(fY,{}),renderBottomRight:()=>{if(typeof(r==null?void 0:r.generatedResponse)=="string")return N("div",{className:"excalidraw-link",style:{marginLeft:"auto",fontSize:14},onClick:()=>{typeof(r==null?void 0:r.generatedResponse)=="string"&&(XT(r.generatedResponse),i({openDialog:{name:"ttd",tab:"mermaid"}}))},children:["View as Mermaid",g(wy,{icon:F2})]});const C=c.length/ff;return C>.8?N("div",{style:{marginLeft:"auto",fontSize:12,fontFamily:"monospace",color:C>1?"var(--color-danger)":void 0},children:["Length: ",c.length,"/",ff]}):null},children:g(cY,{onChange:u,input:a,placeholder:"Describe what you want to see...",onKeyboardSubmit:()=>{U.current()}})}),g(Z6,{label:"Preview",panelAction:{action:()=>{console.info("Panel action clicked"),gY({app:n,data:w})},label:"Insert",icon:F2},children:g(uY,{canvasRef:s,error:v,loaded:b.loaded})})]})]})]})})}),M4e=.01,Fv=10,gl=(e,t)=>!(t==="angle"&&Ee(e)),Gi=(e,t)=>{const n=e+t/2;return n-n%t},q6=(e,t,n)=>Object.keys(e).map(i=>({original:(n??t).get(i),latest:t.get(i)})).filter(i=>i.original!==void 0&&i.latest!==void 0),Pm=(e,t,n,i,s,r=!0)=>{const o=i.getNonDeletedElementsMap(),a=o.get(n.id);if(!a)return;const[l,c]=[n.x+n.width/2,n.y+n.height/2],[u,d]=q(x(n.x,n.y),x(l,c),n.angle),f=e-u,h=t-d,[m,p]=q(x(e,t),x(l+f,c+h),-n.angle);i.mutateElement(a,{x:m,y:p},{informMutation:r,isDragging:!1}),lm(a,i);const U=Re(n,s);if(U){const b=o.get(U.id);b&&i.mutateElement(b,{x:U.x+f,y:U.y+h},{informMutation:r,isDragging:!1})}if(Ee(n)){const b=Js(s,n.id);b.forEach(y=>{const w=o.get(y.id);if(!w)return;const[v,I]=[y.x+y.width/2,y.y+y.height/2],[C,_]=q(x(y.x,y.y),x(v,I),y.angle),T=Math.round(C+f),k=Math.round(_+h),[S,R]=q(x(T,k),x(v+f,I+h),-y.angle);i.mutateElement(w,{x:S,y:R},{informMutation:r,isDragging:!1}),lm(w,i,{simultaneouslyUpdated:b})})}},jT=(e,t)=>{const i=yc(t).map(s=>Ct(e,s).reduce((r,o)=>(r[o.id]=!0,r),{}));return e.filter(s=>!Hh(s)).forEach(s=>{i.push({[s.id]:!0})}),i},Tl=({label:e,icon:t,dragInputCallback:n,value:i,elements:s,editable:r=!0,shouldKeepAspectRatio:o,property:a,scene:l,appState:c,sensitivity:u=1,dragFinishedCallback:d})=>{const f=go(),h=xn(),m=D.useRef(null),p=D.useRef(null),[U,b]=D.useState(i.toString()),y=D.useRef(null);y.current||(y.current={originalAppState:Wa(c),originalElements:s,lastUpdatedValue:U,updatePending:!1}),D.useEffect(()=>{const I=i.toString();b(I),y.current.lastUpdatedValue=I},[i]);const w=(I,C,_)=>{if(!y.current.updatePending)return!1;y.current.updatePending=!1;const T=Number(I);if(isNaN(T)){b(i.toString());return}const k=Number(T.toFixed(2)),S=Number(i);(isNaN(S)||Math.abs(k-S)>=M4e)&&(y.current.lastUpdatedValue=I,n({accumulatedChange:0,instantChange:0,originalElements:C,originalElementsMap:f.scene.getNonDeletedElementsMap(),shouldKeepAspectRatio:o,shouldChangeByStepSize:!1,scene:l,nextValue:k,property:a,originalAppState:_,setInputValue:R=>b(String(R)),app:f,setAppState:h}),f.syncActionResult({captureUpdate:K.IMMEDIATELY}))},v=D.useRef({});return v.current.handleInputValue=w,D.useEffect(()=>{const I=m.current,C=v.current;return()=>{var T;const _=I==null?void 0:I.value;_&&((T=C.handleInputValue)==null||T.call(C,_,y.current.originalElements,y.current.originalAppState)),window.removeEventListener(te.POINTER_MOVE,C.onPointerMove,!1),window.removeEventListener(te.POINTER_UP,C.onPointerUp,!1)}},[r]),r?N("div",{className:re("drag-input-container",!r&&"disabled"),"data-testid":e,children:[g("div",{className:"drag-input-label",ref:p,onPointerDown:I=>{if(m.current&&r){document.body.classList.add("excalidraw-cursor-resize"),Number(m.current.value);let C=null,_=f.scene.getNonDeletedElements().reduce((X,G)=>(X.set(G.id,zc(G)),X),new Map),T=s.map(X=>_.get(X.id));const k=Wa(c);let S=0,R=0;const P=X=>{if(C&&_!==null&&T!==null){const G=X.clientX-C.x;G!==0&&(R+=G,Math.abs(R)>=u&&(R=Math.sign(R)*Math.floor(Math.abs(R)/u),S+=R,n({accumulatedChange:S,instantChange:R,originalElements:T,originalElementsMap:_,shouldKeepAspectRatio:o,shouldChangeByStepSize:X.shiftKey,property:a,scene:l,originalAppState:k,setInputValue:z=>b(String(z)),app:f,setAppState:h}),R=0))}C={x:X.clientX,y:X.clientY}},L=()=>{window.removeEventListener(te.POINTER_MOVE,P,!1),f.syncActionResult({captureUpdate:K.IMMEDIATELY}),d==null||d({app:f,setAppState:h,originalElements:T,originalAppState:k}),C=null,S=0,R=0,T=null,_=null,document.body.classList.remove("excalidraw-cursor-resize"),window.removeEventListener(te.POINTER_UP,L,!1)};v.current.onPointerMove=P,v.current.onPointerUp=L,window.addEventListener(te.POINTER_MOVE,P,!1),window.addEventListener(te.POINTER_UP,L,!1)}},onPointerEnter:()=>{p.current&&(p.current.style.cursor="ew-resize")},children:t?g(wy,{icon:t}):e}),g("input",{className:"drag-input",autoComplete:"off",spellCheck:"false",onKeyDown:I=>{if(r){const C=I.target;C instanceof HTMLInputElement&&I.key===H.ENTER&&(w(C.value,s,c),f.focusContainer())}},ref:m,value:U,onChange:I=>{y.current.updatePending=!0,b(I.target.value)},onFocus:I=>{I.target.select(),y.current.originalElements=s,y.current.originalAppState=Wa(c)},onBlur:I=>{U?r&&w(I.target.value,y.current.originalElements,y.current.originalAppState):b(i.toString())},disabled:!r})]}):null},k4e=15,R4e=({accumulatedChange:e,originalElements:t,shouldChangeByStepSize:n,nextValue:i,scene:s})=>{const r=s.getNonDeletedElementsMap(),o=t[0];if(o&&!ge(o)){const a=r.get(o.id);if(!a)return;if(i!==void 0){const h=Ku(i);s.mutateElement(a,{angle:h}),lm(a,s);const m=Re(a,r);m&&!xe(a)&&s.mutateElement(m,{angle:h});return}const l=Math.round(G5(o.angle)*100)/100,c=Math.round(e);let u=(l+c)%360;n&&(u=Gi(u,k4e)),u=u<0?u+360:u;const d=Ku(u);s.mutateElement(a,{angle:d}),lm(a,s);const f=Re(a,r);f&&!xe(a)&&s.mutateElement(f,{angle:d})}},D4e=({element:e,scene:t,appState:n,property:i})=>g(Tl,{label:"A",icon:IV,value:Math.round(G5(e.angle)%360*100)/100,elements:[e],dragInputCallback:R4e,editable:gl(e,"angle"),scene:t,appState:n,property:i}),LD=5,L4e=({property:e,scene:t,appState:n,setAppState:i})=>g(Tl,{label:"Grid step",sensitivity:8,elements:[],dragInputCallback:({nextValue:s,instantChange:r,shouldChangeByStepSize:o,setInputValue:a})=>{i(l=>{let c;return s?c=s:r&&(c=o?Gi(l.gridStep+LD*Math.sign(r),LD):l.gridStep+r),c?(c=gV(c),a(c),{gridStep:c}):(a(l.gridStep),null)})},scene:t,value:n.gridStep,property:e,appState:n}),ND=10,N4e=e=>e.type==="image",O4e=({accumulatedChange:e,originalElements:t,originalElementsMap:n,shouldKeepAspectRatio:i,shouldChangeByStepSize:s,nextValue:r,property:o,originalAppState:a,instantChange:l,scene:c,app:u,setAppState:d})=>{const f=c.getNonDeletedElementsMap(),h=t[0],m=f.get(h.id);if(h&&m){const p=i||N4e(h),U=h.width/h.height;if(a.croppingElementId===h.id){const b=f.get(h.id);if(!b||!yt(b)||!b.crop)return;const y=b.crop;let w={...y};const v=b.scale[0]===-1,I=b.scale[1]===-1,{width:C,height:_}=al(b),T=y.naturalWidth/C,k=y.naturalHeight/_,S=v?y.width+y.x:y.naturalWidth-y.x,R=I?y.height+y.y:y.naturalHeight-y.y,P=li*T,L=li*k;if(r!==void 0){if(o==="width"){const $=r*T,j=Ke($,P,S);w={...w,width:j,x:v?y.x+y.width-j:y.x}}else if(o==="height"){const $=r*k,j=Ke($,L,R);w={...w,height:j,y:I?y.y+y.height-j:y.y}}c.mutateElement(b,{crop:w,width:w.width/(y.naturalWidth/C),height:w.height/(y.naturalHeight/_)});return}const X=o==="width"?l:0,G=o==="height"?l:0,z=Ke(y.width+X,P,S),V=Ke(y.height+G,P,R);w={...y,x:v?y.x+y.width-z:y.x,y:I?y.y+y.height-V:y.y,width:z,height:V},c.mutateElement(b,{crop:w,width:w.width/(y.naturalWidth/C),height:w.height/(y.naturalHeight/_)});return}if(r!==void 0){const b=Math.max(o==="width"?r:p?r*U:h.width,ur),y=Math.max(o==="height"?r:p?r/U:h.height,ur);if(hm(b,y,m,h,n,c,o==="width"?"e":"s",{shouldMaintainAspectRatio:p}),Ee(m)){const w=Go(c.getElementsIncludingDeleted(),m,a,c.getNonDeletedElementsMap()),v=vg(c.getElementsIncludingDeleted(),w,m,u);c.replaceAllElements(v)}return}{const b=o==="width"?e:0,y=o==="height"?e:0;let w=Math.max(0,h.width+b);o==="width"&&(s?w=Gi(w,ND):w=Math.round(w));let v=Math.max(0,h.height+y);if(o==="height"&&(s?v=Gi(v,ND):v=Math.round(v)),p&&(o==="width"?v=Math.round(w/U*100)/100:w=Math.round(v*U*100)/100),v=Math.max(ur,v),w=Math.max(ur,w),hm(w,v,m,h,n,c,o==="width"?"e":"s",{shouldMaintainAspectRatio:p}),Ee(m)){const I=Go(c.getElementsIncludingDeleted(),m,a,c.getNonDeletedElementsMap());d({elementsToHighlight:I})}}}},P4e=({setAppState:e,app:t,originalElements:n,originalAppState:i})=>{const s=t.scene.getNonDeletedElementsMap(),r=n==null?void 0:n[0],o=r&&s.get(r.id);if(o&&Ee(o)){const a=Go(t.scene.getElementsIncludingDeleted(),o,i,t.scene.getNonDeletedElementsMap()),l=vg(t.scene.getElementsIncludingDeleted(),a,o,t);t.scene.replaceAllElements(l),e({elementsToHighlight:null})}},OD=({property:e,element:t,scene:n,appState:i})=>{let s=ja(e==="width"?t.width:t.height,2);if(i.croppingElementId&&i.croppingElementId===t.id&&yt(t)&&t.crop){const{width:r,height:o}=al(t);if(e==="width"){const a=r/t.crop.naturalWidth;s=ja(t.crop.width*a,2)}if(e==="height"){const a=o/t.crop.naturalHeight;s=ja(t.crop.height*a,2)}}return g(Tl,{label:e==="width"?"W":"H",elements:[t],dragInputCallback:O4e,value:s,editable:gl(t,e),scene:n,appState:i,property:e,dragFinishedCallback:P4e})},PD=4,F4e=4,B4e=({accumulatedChange:e,originalElements:t,shouldChangeByStepSize:n,nextValue:i,scene:s})=>{const r=s.getNonDeletedElementsMap(),o=t[0];if(o){const a=r.get(o.id);if(!a||!de(a))return;let l;if(i!==void 0)l=Math.max(Math.round(i),PD);else if(o.type==="text"){const c=Math.round(o.fontSize),u=Math.round(e);l=Math.max(c+u,PD),n&&(l=Gi(l,F4e))}l&&(s.mutateElement(a,{fontSize:l}),qi(a,s.getContainerElement(a),s))}},z4e=({element:e,scene:t,appState:n,property:i})=>{const s=de(e)?e:Di(e)?Re(e,t.getNonDeletedElementsMap()):null;return s?g(Tl,{label:"F",value:Math.round(s.fontSize*10)/10,elements:[s],dragInputCallback:B4e,icon:uy,appState:n,scene:t,property:i}):null},H4e=15,V4e=({accumulatedChange:e,originalElements:t,shouldChangeByStepSize:n,nextValue:i,property:s,scene:r})=>{const o=r.getNonDeletedElementsMap(),a=t.map(c=>o.get(c.id)).filter(c=>c&&!Hh(c)&&gl(c,s)),l=t.filter(c=>!Hh(c)&&gl(c,s));if(i!==void 0){const c=Ku(i);for(const u of a){if(!u)continue;r.mutateElement(u,{angle:c});const d=Re(u,o);d&&!xe(u)&&r.mutateElement(d,{angle:c})}r.triggerUpdate();return}for(let c=0;c<a.length;c++){const u=a[c];if(!u)continue;const d=l[c],f=Math.round(G5(d.angle)*100)/100,h=Math.round(e);let m=(f+h)%360;n&&(m=Gi(m,H4e)),m=m<0?m+360:m;const p=Ku(m);r.mutateElement(u,{angle:p});const U=Re(u,o);U&&!xe(u)&&r.mutateElement(U,{angle:p})}r.triggerUpdate()},$4e=({elements:e,scene:t,appState:n,property:i})=>{const s=e.filter(l=>!Hh(l)&&gl(l,"angle")),r=s.map(l=>Math.round(G5(l.angle)%360*100)/100),o=new Set(r).size===1?r[0]:"Mixed",a=s.some(l=>gl(l,"angle"));return g(Tl,{label:"A",icon:IV,value:o,elements:e,dragInputCallback:V4e,editable:a,appState:n,scene:t,property:i})},hf=10,G4e=(e,t,n,i)=>{const s=i.x-e,r=i.y-t,o=i.width*n,a=i.height*n,l=e+s*n,c=t+r*n;return{width:o,height:a,x:l,y:c,...T_(i,o,a,!1),...de(i)?{fontSize:i.fontSize*n}:{}}},X4e=(e,t,n,i,s,r,o,a)=>{const l=a.getNonDeletedElementsMap(),c=G4e(e,t,i,r);a.mutateElement(s,c);const u=Re(r,o);if(u){const d=u.fontSize*i;Is(s,a,{newSize:{width:c.width,height:c.height}});const f=l.get(u.id);f&&de(f)&&(a.mutateElement(f,{fontSize:d}),Ep(s,a,n==="width"?"e":"s",!0))}},FD=(e,t,n,i,s,r,o,a,l,c)=>{r==="width"?t=Math.round(e/i*100)/100:e=Math.round(t*i*100)/100;const u=t/n;for(let d=0;d<a.length;d++){const f=a[d],h=o[d];X4e(s[0],s[1],r,u,h,f,l,c)}},j4e=({accumulatedChange:e,originalElements:t,originalElementsMap:n,originalAppState:i,shouldChangeByStepSize:s,nextValue:r,scene:o,property:a,setAppState:l,app:c})=>{const u=o.getNonDeletedElementsMap(),d=jT(t,i);if(r!==void 0){for(const p of d){const U=q6(p,u,n);if(U.length>1){const b=U.map(P=>P.latest),y=U.map(P=>P.original),[w,v,I,C]=ft(y),_=I-w,T=C-v,k=_/T,S=Math.max(ur,a==="width"?Math.max(0,r):_),R=Math.max(ur,a==="height"?Math.max(0,r):T);FD(S,R,T,k,x(w,v),a,b,y,n,o)}else{const[b]=U,y=b==null?void 0:b.latest,w=b==null?void 0:b.original;if(y&&w&&gl(y,a)){let v=a==="width"?Math.max(0,r):y.width;a==="width"&&(s?v=Gi(v,hf):v=Math.round(v));let I=a==="height"?Math.max(0,r):y.height;if(a==="height"&&(s?I=Gi(I,hf):I=Math.round(I)),v=Math.max(ur,v),I=Math.max(ur,I),hm(v,I,y,w,n,o,a==="width"?"e":"s",{shouldInformMutation:!1}),Ee(y)){const C=Go(o.getElementsIncludingDeleted(),y,i,o.getNonDeletedElementsMap()),_=vg(o.getElementsIncludingDeleted(),C,y,c);o.replaceAllElements(_)}}}}o.triggerUpdate();return}const f=a==="width"?e:0,h=a==="height"?e:0,m=[];for(const p of d){const U=q6(p,u,n);if(U.length>1){const b=U.map(P=>P.latest),y=U.map(P=>P.original),[w,v,I,C]=ft(y),_=I-w,T=C-v,k=_/T;let S=Math.max(0,_+f);a==="width"&&(s?S=Gi(S,hf):S=Math.round(S));let R=Math.max(0,T+h);a==="height"&&(s?R=Gi(R,hf):R=Math.round(R)),S=Math.max(ur,S),R=Math.max(ur,R),FD(S,R,T,k,x(w,v),a,b,y,n,o)}else{const[b]=U,y=b==null?void 0:b.latest,w=b==null?void 0:b.original;if(y&&w&&gl(y,a)){let v=Math.max(0,w.width+f);a==="width"&&(s?v=Gi(v,hf):v=Math.round(v));let I=Math.max(0,w.height+h);if(a==="height"&&(s?I=Gi(I,hf):I=Math.round(I)),v=Math.max(ur,v),I=Math.max(ur,I),hm(v,I,y,w,n,o,a==="width"?"e":"s",{shouldInformMutation:!1}),Ee(y)){const C=Go(o.getElementsIncludingDeleted(),y,i,o.getNonDeletedElementsMap());m.push(...C)}}}}l({elementsToHighlight:m}),o.triggerUpdate()},Y4e=({setAppState:e,app:t,originalElements:n,originalAppState:i})=>{const s=t.scene.getNonDeletedElementsMap(),r=n==null?void 0:n[0],o=r&&s.get(r.id);if(o&&Ee(o)){const a=Go(t.scene.getElementsIncludingDeleted(),o,i,t.scene.getNonDeletedElementsMap()),l=vg(t.scene.getElementsIncludingDeleted(),a,o,t);t.scene.replaceAllElements(l),e({elementsToHighlight:null})}},BD=({property:e,elements:t,elementsMap:n,atomicUnits:i,scene:s,appState:r})=>{const o=D.useMemo(()=>i.map(c=>{const u=q6(c,n);if(u.length>1){const[f,h,m,p]=ft(u.map(U=>U.latest));return Math.round((e==="width"?m-f:p-h)*100)/100}const[d]=u;return Math.round((e==="width"?d.latest.width:d.latest.height)*100)/100}),[n,i,e]),a=new Set(o).size===1?Math.round(o[0]*100)/100:"Mixed",l=o.length>0;return g(Tl,{label:e==="width"?"W":"H",elements:t,dragInputCallback:j4e,value:a,editable:l,appState:r,property:e,scene:s,dragFinishedCallback:Y4e})},zD=4,W4e=4,K4e=(e,t)=>e.reduce((n,i)=>{if(!i||Hh(i))return n;if(de(i))return n.push(i),n;if(Di(i)){const s=Re(i,t);if(s)return n.push(s),n}return n},[]),Z4e=({accumulatedChange:e,originalElements:t,shouldChangeByStepSize:n,nextValue:i,scene:s})=>{const r=s.getNonDeletedElementsMap(),o=t.map(l=>r.get(l.id));let a;if(i){a=Math.max(Math.round(i),zD);for(const l of o)s.mutateElement(l,{fontSize:a}),qi(l,s.getContainerElement(l),s);s.triggerUpdate()}else{const l=t;for(let c=0;c<o.length;c++){const u=o[c],d=l[c],f=Math.round(d.fontSize),h=Math.round(e);let m=Math.max(f+h,zD);n&&(m=Gi(m,W4e)),s.mutateElement(u,{fontSize:m}),qi(u,s.getContainerElement(u),s)}s.triggerUpdate()}},q4e=({elements:e,scene:t,appState:n,property:i,elementsMap:s})=>{const r=K4e(e,s);if(!r.length)return null;const o=r.map(c=>Math.round(c.fontSize*10)/10),a=new Set(o).size===1?o[0]:"Mixed",l=o.length>0;return g(Tl,{label:"F",icon:uy,elements:r,dragInputCallback:Z4e,value:a,editable:l,scene:t,property:i,appState:n})},Q4e=(e,t,n,i,s,r)=>{for(let o=0;o<i.length;o++){const a=i[o],[l,c]=[a.x+a.width/2,a.y+a.height/2],[u,d]=q(x(a.x,a.y),x(l,c),a.angle),f=e==="x"?Math.round(u+t):u,h=e==="y"?Math.round(d+n):d;Pm(f,h,a,r,s,!1)}},J4e=(e,t,n,i,s)=>{const r=s.getNonDeletedElementsMap(),[o,a,,]=ft(n),l=e-o,c=t-a;for(let u=0;u<n.length;u++){const d=n[u],f=r.get(d.id);if(f&&(!de(f)||!f.containerId)){const[h,m]=[f.x+f.width/2,f.y+f.height/2],[p,U]=q(x(f.x,f.y),x(h,m),f.angle);Pm(p+l,U+c,d,s,i,!1)}}},eve=({accumulatedChange:e,originalElements:t,originalElementsMap:n,shouldChangeByStepSize:i,nextValue:s,property:r,scene:o,originalAppState:a})=>{var f,h;const l=o.getNonDeletedElementsMap();if(s!==void 0){for(const m of jT(t,a)){const p=q6(m,l,n);if(p.length>1){const[U,b,,]=ft(p.map(v=>v.latest));J4e(r==="x"?s:U,r==="y"?s:b,p.map(v=>v.original),n,o)}else{const U=(f=p[0])==null?void 0:f.original,b=(h=p[0])==null?void 0:h.latest;if(U&&b&&gl(b,r)){const[y,w]=[U.x+U.width/2,U.y+U.height/2],[v,I]=q(x(U.x,U.y),x(y,w),U.angle);Pm(r==="x"?s:v,r==="y"?s:I,U,o,n,!1)}}}o.triggerUpdate();return}const c=i?Gi(e,Fv):e;Q4e(r,r==="x"?c:0,r==="y"?c:0,t,n,o),o.triggerUpdate()},HD=({property:e,elements:t,elementsMap:n,atomicUnits:i,scene:s,appState:r})=>{const o=D.useMemo(()=>i.map(l=>{const c=Object.keys(l).map(p=>n.get(p)).filter(p=>p!==void 0);if(c.length>1){const[p,U]=ft(c);return Math.round((e==="x"?p:U)*100)/100}const[u]=c,[d,f]=[u.x+u.width/2,u.y+u.height/2],[h,m]=q(x(u.x,u.y),x(d,f),u.angle);return Math.round((e==="x"?h:m)*100)/100}),[i,n,e]),a=new Set(o).size===1?o[0]:"Mixed";return g(Tl,{label:e==="x"?"X":"Y",elements:t,dragInputCallback:eve,value:a,property:e,scene:s,appState:r})},tve=({accumulatedChange:e,instantChange:t,originalElements:n,originalElementsMap:i,shouldChangeByStepSize:s,nextValue:r,property:o,scene:a,originalAppState:l})=>{const c=a.getNonDeletedElementsMap(),u=n[0],[d,f]=[u.x+u.width/2,u.y+u.height/2],[h,m]=q(x(u.x,u.y),x(d,f),u.angle);if(l.croppingElementId===u.id){const w=c.get(u.id);if(!w||!yt(w)||!w.crop)return;const v=w.crop;let I=v;const C=w.scale[0]===-1,_=w.scale[1]===-1,{width:T,height:k}=al(w);if(r!==void 0){if(o==="x"){const P=r*(v.naturalWidth/T);C?I={...v,x:Ke(v.naturalWidth-P-v.width,0,v.naturalWidth-v.width)}:I={...v,x:Ke(r*(v.naturalWidth/T),0,v.naturalWidth-v.width)}}o==="y"&&(I={...v,y:Ke(r*(v.naturalHeight/k),0,v.naturalHeight-v.height)}),a.mutateElement(w,{crop:I});return}const S=(o==="x"?t:0)*(C?-1:1),R=(o==="y"?t:0)*(_?-1:1);I={...v,x:Ke(v.x+S,0,v.naturalWidth-v.width),y:Ke(v.y+R,0,v.naturalHeight-v.height)},a.mutateElement(w,{crop:I});return}if(r!==void 0){Pm(o==="x"?r:h,o==="y"?r:m,u,a,i);return}const p=o==="x"?e:0,U=o==="y"?e:0,b=o==="x"?Math.round(s?Gi(u.x+p,Fv):h+p):h,y=o==="y"?Math.round(s?Gi(u.y+U,Fv):m+U):m;Pm(b,y,u,a,i)},VD=({property:e,element:t,elementsMap:n,scene:i,appState:s})=>{const[r,o]=q(x(t.x,t.y),x(t.x+t.width/2,t.y+t.height/2),t.angle);let a=ja(e==="x"?r:o,2);if(s.croppingElementId===t.id&&yt(t)&&t.crop){const l=lae(t);l&&(a=ja(e==="x"?l.x:l.y,2))}return g(Tl,{label:e==="x"?"X":"Y",elements:[t],dragInputCallback:tve,scene:i,value:a,property:e,appState:s})},nve=50,Sa=e=>{const t=Op(),n=e.app.scene.getSceneNonce()||1,i=e.app.scene.getSelectedElements({selectedElementIds:t.selectedElementIds,includeBoundTextElement:!1}),s=Nm(e.app);return g(ive,{...e,appState:t,sceneNonce:n,selectedElements:i,gridModeEnabled:s})},Wt=({children:e,columns:t=1,heading:n,style:i,...s})=>g("div",{className:re("exc-stats__row",{"exc-stats__row--heading":n}),style:{gridTemplateColumns:`repeat(${t}, 1fr)`,...i},...s,children:e});Wt.displayName="StatsRow";const Q6=({children:e,order:t,style:n,...i})=>g("div",{className:"exc-stats__rows",style:{order:t,...n},...i,children:e});Q6.displayName="StatsRows";Sa.StatsRow=Wt;Sa.StatsRows=Q6;const ive=D.memo(({app:e,onClose:t,renderCustomStats:n,selectedElements:i,appState:s,sceneNonce:r,gridModeEnabled:o})=>{const a=e.scene,l=a.getNonDeletedElements(),c=a.getNonDeletedElementsMap(),u=xn(),d=i.length===1?i[0]:null,f=i.length>1?i:null,h=s.croppingElementId&&yt(d),m=h?al(d):null,[p,U]=D.useState({width:0,height:0}),b=D.useMemo(()=>Oo(v=>{const I=ft(v);U({width:Math.round(I[2])-Math.round(I[0]),height:Math.round(I[3])-Math.round(I[1])})},nve),[]);D.useEffect(()=>{b(l)},[r,l,b]),D.useEffect(()=>()=>b.cancel(),[b]);const y=D.useMemo(()=>jT(i,s),[i,s]),w=D.useMemo(()=>xz(i),[i]);return g("div",{className:"exc-stats",children:N(vr,{padding:3,children:[N("div",{className:"title",children:[g("h2",{children:M("stats.title")}),g("div",{className:"close",onClick:t,children:Vd})]}),N(fv,{label:g("h3",{children:M("stats.generalStats")}),open:!!(s.stats.panels&zf.generalStats),openTrigger:()=>u(v=>({stats:{open:!0,panels:v.stats.panels^zf.generalStats}})),children:[N(Q6,{children:[g(Wt,{heading:!0,children:M("stats.scene")}),N(Wt,{columns:2,children:[g("div",{children:M("stats.shapes")}),g("div",{children:l.length})]}),N(Wt,{columns:2,children:[g("div",{children:M("stats.width")}),g("div",{children:p.width})]}),N(Wt,{columns:2,children:[g("div",{children:M("stats.height")}),g("div",{children:p.height})]}),o&&N(fe,{children:[g(Wt,{heading:!0,children:"Canvas"}),g(Wt,{children:g(L4e,{property:"gridStep",scene:a,appState:s,setAppState:u})})]})]}),n==null?void 0:n(l,s)]}),!w&&i.length>0&&g("div",{id:"elementStats",style:{marginTop:12},children:g(fv,{label:g("h3",{children:M("stats.elementProperties")}),open:!!(s.stats.panels&zf.elementProperties),openTrigger:()=>u(v=>({stats:{open:!0,panels:v.stats.panels^zf.elementProperties}})),children:N(Q6,{children:[d&&N(fe,{children:[h&&g(Wt,{heading:!0,children:M("labels.unCroppedDimension")}),s.croppingElementId&&yt(d)&&m&&N(Wt,{columns:2,children:[g("div",{children:M("stats.width")}),g("div",{children:ja(m.width,2)})]}),s.croppingElementId&&yt(d)&&m&&N(Wt,{columns:2,children:[g("div",{children:M("stats.height")}),g("div",{children:ja(m.height,2)})]}),g(Wt,{heading:!0,"data-testid":"stats-element-type",style:{margin:"0.3125rem 0"},children:s.croppingElementId?M("labels.imageCropping"):M(`element.${d.type}`)}),g(Wt,{children:g(VD,{element:d,property:"x",elementsMap:c,scene:a,appState:s})}),g(Wt,{children:g(VD,{element:d,property:"y",elementsMap:c,scene:a,appState:s})}),g(Wt,{children:g(OD,{property:"width",element:d,scene:a,appState:s})}),g(Wt,{children:g(OD,{property:"height",element:d,scene:a,appState:s})}),!ge(d)&&g(Wt,{children:g(D4e,{property:"angle",element:d,scene:a,appState:s})}),g(Wt,{children:g(z4e,{property:"fontSize",element:d,scene:a,appState:s})})]}),f&&N(fe,{children:[a_(f)&&g(Wt,{heading:!0,children:M("element.group")}),N(Wt,{columns:2,style:{margin:"0.3125rem 0"},children:[g("div",{children:M("stats.shapes")}),g("div",{children:i.length})]}),g(Wt,{children:g(HD,{property:"x",elements:f,elementsMap:c,atomicUnits:y,scene:a,appState:s})}),g(Wt,{children:g(HD,{property:"y",elements:f,elementsMap:c,atomicUnits:y,scene:a,appState:s})}),g(Wt,{children:g(BD,{property:"width",elements:f,elementsMap:c,atomicUnits:y,scene:a,appState:s})}),g(Wt,{children:g(BD,{property:"height",elements:f,elementsMap:c,atomicUnits:y,scene:a,appState:s})}),g(Wt,{children:g($4e,{property:"angle",elements:f,scene:a,appState:s})}),g(Wt,{children:g(q4e,{property:"fontSize",elements:f,scene:a,appState:s,elementsMap:c})})]})]})})})]})})},(e,t)=>e.sceneNonce===t.sceneNonce&&e.selectedElements===t.selectedElements&&e.appState.stats.panels===t.appState.stats.panels&&e.gridModeEnabled===t.gridModeEnabled&&e.appState.gridStep===t.appState.gridStep&&e.appState.croppingElementId===t.appState.croppingElementId),sve=({sourceElementId:e,onClose:t,appState:n,scene:i,generateLinkForSelection:s=Wz})=>{var f;const r=i.getNonDeletedElementsMap(),o=((f=r.get(e))==null?void 0:f.link)??null,[a,l]=D.useState(o),[c,u]=D.useState(!1);D.useEffect(()=>{const h=Ve(r,n);let m=o;if(h.length>0&&s){const p=Kz(h,n);p&&(m=Qs(s(p.id,p.type)))}l(m)},[r,n,n.selectedElementIds,o,s]);const d=D.useCallback(()=>{var h;if(a&&a!==((h=r.get(e))==null?void 0:h.link)){const m=r.get(e);m&&i.mutateElement(m,{link:a})}if(!a&&c&&e){const m=r.get(e);m&&i.mutateElement(m,{link:null})}t==null||t()},[e,a,r,c,i,t]);return D.useEffect(()=>{const h=m=>{var p,U;((p=n.openDialog)==null?void 0:p.name)==="elementLinkSelector"&&m.key===H.ENTER&&d(),((U=n.openDialog)==null?void 0:U.name)==="elementLinkSelector"&&m.key===H.ESCAPE&&(t==null||t())};return window.addEventListener("keydown",h),()=>{window.removeEventListener("keydown",h)}},[n,t,d]),N("div",{className:"ElementLinkDialog",children:[N("div",{className:"ElementLinkDialog__header",children:[g("h2",{children:M("elementLink.title")}),g("p",{children:M("elementLink.desc")})]}),N("div",{className:"ElementLinkDialog__input",children:[g(Id,{value:a??"",onChange:h=>{c||u(!0),l(h)},onKeyDown:h=>{h.key===H.ENTER&&d()},className:"ElementLinkDialog__input-field",selectOnRender:!0}),o&&a&&g($e,{type:"button",title:M("buttons.remove"),"aria-label":M("buttons.remove"),label:M("buttons.remove"),onClick:()=>{l(null),u(!0)},className:"ElementLinkDialog__remove",icon:Hc})]}),N("div",{className:"ElementLinkDialog__actions",children:[g(Zh,{label:M("buttons.cancel"),onClick:()=>{t==null||t()},style:{marginRight:10}}),g(Zh,{label:M("buttons.confirm"),onClick:d,actionType:"primary"})]})]})},YT=({children:e,onClose:t})=>{const[n,i]=D.useState(!!e),{container:s}=Lr(),r=ae.useCallback(()=>{i(!1),t&&t(),s==null||s.focus()},[t,s]);return g(fe,{children:n&&g(ir,{size:"small",onCloseRequest:r,title:M("errorDialog.title"),children:g("div",{style:{whiteSpace:"pre-wrap"},children:e})})})},rve=()=>N("div",{className:"HelpDialog__header",children:[N("a",{className:"HelpDialog__btn",href:"https://docs.excalidraw.com",target:"_blank",rel:"noopener",children:[g("div",{className:"HelpDialog__link-icon",children:BM}),M("helpDialog.documentation")]}),N("a",{className:"HelpDialog__btn",href:"https://plus.excalidraw.com/blog",target:"_blank",rel:"noopener",children:[g("div",{className:"HelpDialog__link-icon",children:BM}),M("helpDialog.blog")]}),N("a",{className:"HelpDialog__btn",href:"https://github.com/excalidraw/excalidraw/issues",target:"_blank",rel:"noopener noreferrer",children:[g("div",{className:"HelpDialog__link-icon",children:B_}),M("helpDialog.github")]}),N("a",{className:"HelpDialog__btn",href:"https://youtube.com/@excalidraw",target:"_blank",rel:"noopener noreferrer",children:[g("div",{className:"HelpDialog__link-icon",children:AV}),"YouTube"]})]}),ove=e=>N(fe,{children:[g("h3",{children:e.title}),g("div",{className:"HelpDialog__islands-container",children:e.children})]}),N3=e=>N("div",{className:`HelpDialog__island ${e.className}`,children:[g("h4",{className:"HelpDialog__island-title",children:e.caption}),g("div",{className:"HelpDialog__island-content",children:e.children})]});function*ave(e,t){let n=!0;for(const i of e)n||(yield t),n=!1,yield i}const lve=e=>e.replace(/\b[a-z]\b/,t=>t.toUpperCase()),be=({label:e,shortcuts:t,isOr:n=!0})=>{const i=t.map(s=>(s.endsWith("++")?[...s.slice(0,-2).split("+"),"+"]:s.split("+")).map(o=>g(cve,{children:lve(o)},o)));return N("div",{className:"HelpDialog__shortcut",children:[g("div",{children:e}),g("div",{className:"HelpDialog__key-container",children:[...ave(i,n?M("helpDialog.or"):null)]})]})},cve=e=>g("kbd",{className:"HelpDialog__key",...e}),uve=({onClose:e})=>{const t=ae.useCallback(()=>{e&&e()},[e]);return g(fe,{children:N(ir,{onCloseRequest:t,title:M("helpDialog.title"),className:"HelpDialog",children:[g(rve,{}),N(ove,{title:M("helpDialog.shortcuts"),children:[N(N3,{className:"HelpDialog__island--tools",caption:M("helpDialog.tools"),children:[g(be,{label:M("toolBar.hand"),shortcuts:[H.H]}),g(be,{label:M("toolBar.selection"),shortcuts:[H.V,H[1]]}),g(be,{label:M("toolBar.rectangle"),shortcuts:[H.R,H[2]]}),g(be,{label:M("toolBar.diamond"),shortcuts:[H.D,H[3]]}),g(be,{label:M("toolBar.ellipse"),shortcuts:[H.O,H[4]]}),g(be,{label:M("toolBar.arrow"),shortcuts:[H.A,H[5]]}),g(be,{label:M("toolBar.line"),shortcuts:[H.L,H[6]]}),g(be,{label:M("toolBar.freedraw"),shortcuts:[H.P,H[7]]}),g(be,{label:M("toolBar.text"),shortcuts:[H.T,H[8]]}),g(be,{label:M("toolBar.image"),shortcuts:[H[9]]}),g(be,{label:M("toolBar.eraser"),shortcuts:[H.E,H[0]]}),g(be,{label:M("toolBar.frame"),shortcuts:[H.F]}),g(be,{label:M("toolBar.laser"),shortcuts:[H.K]}),g(be,{label:M("labels.eyeDropper"),shortcuts:[H.I,"Shift+S","Shift+G"]}),g(be,{label:M("helpDialog.editLineArrowPoints"),shortcuts:[J("CtrlOrCmd+Enter")]}),g(be,{label:M("helpDialog.editText"),shortcuts:[J("Enter")]}),g(be,{label:M("helpDialog.textNewLine"),shortcuts:[J("Enter"),J("Shift+Enter")]}),g(be,{label:M("helpDialog.textFinish"),shortcuts:[J("Esc"),J("CtrlOrCmd+Enter")]}),g(be,{label:M("helpDialog.curvedArrow"),shortcuts:["A",M("helpDialog.click"),M("helpDialog.click"),M("helpDialog.click")],isOr:!1}),g(be,{label:M("helpDialog.curvedLine"),shortcuts:["L",M("helpDialog.click"),M("helpDialog.click"),M("helpDialog.click")],isOr:!1}),g(be,{label:M("helpDialog.cropStart"),shortcuts:[M("helpDialog.doubleClick"),J("Enter")],isOr:!0}),g(be,{label:M("helpDialog.cropFinish"),shortcuts:[J("Enter"),J("Escape")],isOr:!0}),g(be,{label:M("toolBar.lock"),shortcuts:[H.Q]}),g(be,{label:M("helpDialog.preventBinding"),shortcuts:[J("CtrlOrCmd")]}),g(be,{label:M("toolBar.link"),shortcuts:[J("CtrlOrCmd+K")]}),g(be,{label:M("toolBar.convertElementType"),shortcuts:["Tab","Shift+Tab"],isOr:!0})]}),N(N3,{className:"HelpDialog__island--view",caption:M("helpDialog.view"),children:[g(be,{label:M("buttons.zoomIn"),shortcuts:[J("CtrlOrCmd++")]}),g(be,{label:M("buttons.zoomOut"),shortcuts:[J("CtrlOrCmd+-")]}),g(be,{label:M("buttons.resetZoom"),shortcuts:[J("CtrlOrCmd+0")]}),g(be,{label:M("helpDialog.zoomToFit"),shortcuts:["Shift+1"]}),g(be,{label:M("helpDialog.zoomToSelection"),shortcuts:["Shift+2"]}),g(be,{label:M("helpDialog.movePageUpDown"),shortcuts:["PgUp/PgDn"]}),g(be,{label:M("helpDialog.movePageLeftRight"),shortcuts:["Shift+PgUp/PgDn"]}),g(be,{label:M("buttons.zenMode"),shortcuts:[J("Alt+Z")]}),g(be,{label:M("buttons.objectsSnapMode"),shortcuts:[J("Alt+S")]}),g(be,{label:M("labels.toggleGrid"),shortcuts:[J("CtrlOrCmd+'")]}),g(be,{label:M("labels.viewMode"),shortcuts:[J("Alt+R")]}),g(be,{label:M("labels.toggleTheme"),shortcuts:[J("Alt+Shift+D")]}),g(be,{label:M("stats.fullTitle"),shortcuts:[J("Alt+/")]}),g(be,{label:M("search.title"),shortcuts:[Ki("searchMenu")]}),g(be,{label:M("commandPalette.title"),shortcuts:im?[Ki("commandPalette")]:[Ki("commandPalette"),Ki("commandPalette",1)]})]}),N(N3,{className:"HelpDialog__island--editor",caption:M("helpDialog.editor"),children:[g(be,{label:M("helpDialog.createFlowchart"),shortcuts:[J("CtrlOrCmd+Arrow Key")],isOr:!0}),g(be,{label:M("helpDialog.navigateFlowchart"),shortcuts:[J("Alt+Arrow Key")],isOr:!0}),g(be,{label:M("labels.moveCanvas"),shortcuts:[J(`Space+${M("helpDialog.drag")}`),J(`Wheel+${M("helpDialog.drag")}`)],isOr:!0}),g(be,{label:M("buttons.clearReset"),shortcuts:[J("CtrlOrCmd+Delete")]}),g(be,{label:M("labels.delete"),shortcuts:[J("Delete")]}),g(be,{label:M("labels.cut"),shortcuts:[J("CtrlOrCmd+X")]}),g(be,{label:M("labels.copy"),shortcuts:[J("CtrlOrCmd+C")]}),g(be,{label:M("labels.paste"),shortcuts:[J("CtrlOrCmd+V")]}),g(be,{label:M("labels.pasteAsPlaintext"),shortcuts:[J("CtrlOrCmd+Shift+V")]}),g(be,{label:M("labels.selectAll"),shortcuts:[J("CtrlOrCmd+A")]}),g(be,{label:M("labels.multiSelect"),shortcuts:[J(`Shift+${M("helpDialog.click")}`)]}),g(be,{label:M("helpDialog.deepSelect"),shortcuts:[J(`CtrlOrCmd+${M("helpDialog.click")}`)]}),g(be,{label:M("helpDialog.deepBoxSelect"),shortcuts:[J(`CtrlOrCmd+${M("helpDialog.drag")}`)]}),(kT||im)&&g(be,{label:M("labels.copyAsPng"),shortcuts:[J("Shift+Alt+C")]}),g(be,{label:M("labels.copyStyles"),shortcuts:[J("CtrlOrCmd+Alt+C")]}),g(be,{label:M("labels.pasteStyles"),shortcuts:[J("CtrlOrCmd+Alt+V")]}),g(be,{label:M("labels.sendToBack"),shortcuts:[J(so?"CtrlOrCmd+Alt+[":"CtrlOrCmd+Shift+[")]}),g(be,{label:M("labels.bringToFront"),shortcuts:[J(so?"CtrlOrCmd+Alt+]":"CtrlOrCmd+Shift+]")]}),g(be,{label:M("labels.sendBackward"),shortcuts:[J("CtrlOrCmd+[")]}),g(be,{label:M("labels.bringForward"),shortcuts:[J("CtrlOrCmd+]")]}),g(be,{label:M("labels.alignTop"),shortcuts:[J("CtrlOrCmd+Shift+Up")]}),g(be,{label:M("labels.alignBottom"),shortcuts:[J("CtrlOrCmd+Shift+Down")]}),g(be,{label:M("labels.alignLeft"),shortcuts:[J("CtrlOrCmd+Shift+Left")]}),g(be,{label:M("labels.alignRight"),shortcuts:[J("CtrlOrCmd+Shift+Right")]}),g(be,{label:M("labels.duplicateSelection"),shortcuts:[J("CtrlOrCmd+D"),J(`Alt+${M("helpDialog.drag")}`)]}),g(be,{label:M("helpDialog.toggleElementLock"),shortcuts:[J("CtrlOrCmd+Shift+L")]}),g(be,{label:M("buttons.undo"),shortcuts:[J("CtrlOrCmd+Z")]}),g(be,{label:M("buttons.redo"),shortcuts:qF?[J("CtrlOrCmd+Y"),J("CtrlOrCmd+Shift+Z")]:[J("CtrlOrCmd+Shift+Z")]}),g(be,{label:M("labels.group"),shortcuts:[J("CtrlOrCmd+G")]}),g(be,{label:M("labels.ungroup"),shortcuts:[J("CtrlOrCmd+Shift+G")]}),g(be,{label:M("labels.flipHorizontal"),shortcuts:[J("Shift+H")]}),g(be,{label:M("labels.flipVertical"),shortcuts:[J("Shift+V")]}),g(be,{label:M("labels.showStroke"),shortcuts:[J("S")]}),g(be,{label:M("labels.showBackground"),shortcuts:[J("G")]}),g(be,{label:M("labels.showFonts"),shortcuts:[J("Shift+F")]}),g(be,{label:M("labels.decreaseFontSize"),shortcuts:[J("CtrlOrCmd+Shift+<")]}),g(be,{label:M("labels.increaseFontSize"),shortcuts:[J("CtrlOrCmd+Shift+>")]})]})]})]})})},At=e=>Array.isArray(e)?`<kbd>${e.map(J).join(" + ")}</kbd>`:`<kbd>${J(e)}</kbd>`,dve=({appState:e,isMobile:t,device:n,app:i})=>{var u,d,f,h;const{activeTool:s,isResizing:r,isRotating:o,lastPointerDownWith:a}=e,l=e.multiElement!==null;if(((u=e.openSidebar)==null?void 0:u.name)===Ir.name&&e.openSidebar.tab===Wu&&((d=e.searchMatches)!=null&&d.matches.length))return M("hints.dismissSearch",{shortcut:At("Escape")});if(e.openSidebar&&!n.editor.canFitSidebar)return null;if(Ao(e))return M("hints.eraserRevert",{shortcut:At("Alt")});if(s.type==="arrow"||s.type==="line")return l?M("hints.linearElementMulti",{shortcut_1:At("Escape"),shortcut_2:At("Enter")}):s.type==="arrow"?M("hints.arrowTool",{shortcut:At("A")}):M("hints.linearElement");if(s.type==="freedraw")return M("hints.freeDraw");if(s.type==="text")return M("hints.text");if(s.type==="embeddable")return M("hints.embeddable");const c=i.scene.getSelectedElements(e);if(r&&a==="mouse"&&c.length===1){const m=c[0];return Se(m)&&m.points.length===2?M("hints.lockAngle",{shortcut:At("Shift")}):yt(m)?M("hints.resizeImage",{shortcut_1:At("Shift"),shortcut_2:At("Alt")}):M("hints.resize",{shortcut_1:At("Shift"),shortcut_2:At("Alt")})}if(o&&a==="mouse")return M("hints.rotate",{shortcut:At("Shift")});if(c.length===1&&de(c[0]))return M("hints.text_selected",{shortcut:At("Enter")});if(e.editingTextElement)return M("hints.text_editing",{shortcut_1:At("Escape"),shortcut_2:At(["CtrlOrCmd","Enter"])});if(e.croppingElementId)return M("hints.leaveCropEditor",{shortcut_1:At("Enter"),shortcut_2:At("Escape")});if(c.length===1&&yt(c[0]))return M("hints.enterCropEditor",{shortcut:At("Enter")});if(s.type==="selection"){if(e.selectionElement&&!c.length&&!e.editingTextElement&&!((f=e.selectedLinearElement)!=null&&f.isEditing))return M("hints.deepBoxSelect",{shortcut:At("CtrlOrCmd")});if(Nm(i)&&e.selectedElementsAreBeingDragged)return M("hints.disableSnapping",{shortcut:At("CtrlOrCmd")});if(!c.length&&!t)return M("hints.canvasPanning",{shortcut_1:At(M("keys.mmb")),shortcut_2:At("Space")});if(c.length===1){if(Se(c[0]))return(h=e.selectedLinearElement)!=null&&h.isEditing?e.selectedLinearElement.selectedPointsIndices?M("hints.lineEditor_pointSelected",{shortcut_1:At("Delete"),shortcut_2:At(["CtrlOrCmd","D"])}):M("hints.lineEditor_nothingSelected",{shortcut_1:At("Shift"),shortcut_2:At("Alt")}):tn(c[0])?M("hints.lineEditor_line_info",{shortcut:At("Enter")}):M("hints.lineEditor_info",{shortcut_1:At("CtrlOrCmd"),shortcut_2:At(["CtrlOrCmd","Enter"])});if(!e.newElement&&!e.selectedElementsAreBeingDragged&&Zu(c[0])){const m=M("hints.bindTextToElement",{shortcut:At("Enter")}),p=M("hints.createFlowchart",{shortcut:At(["CtrlOrCmd",""])});return K5(c[0])?sue(c[0],i.scene.getNonDeletedElementsMap())?[m,p]:[m,p]:m}}}return null},fve=({appState:e,isMobile:t,device:n,app:i})=>{const s=dve({appState:e,isMobile:t,device:n,app:i});if(!s)return null;const o=(Array.isArray(s)?s.map(a=>a.replace(/\. ?$/,"")).join(", "):s).split(/(<kbd>[^<]+<\/kbd>)/g).map((a,l)=>{if(l%2===1){const c=a[0]==="<"&&a.match(/^<kbd>([^<]+)<\/kbd>$/);return g("kbd",{children:c?c[1]:a},l)}return a});return g("div",{className:"HintViewer",children:g("span",{children:o})})},hve=2e3,WT=()=>{const[e,t]=D.useState(null),n=D.useRef(0),i=()=>{clearTimeout(n.current),t("success"),n.current=window.setTimeout(()=>{t(null)},hve)},s=D.useCallback(()=>{t(null)},[]);return{copyStatus:e,resetCopyStatus:s,onCopy:i}},i2=({title:e,name:t,checked:n,onChange:i,disabled:s=!1})=>g("div",{className:re("Switch",{toggled:n,disabled:s}),children:g("input",{name:t,id:t,title:e,type:"checkbox",checked:n,disabled:s,onChange:()=>i(!n),onKeyDown:r=>{r.key===" "&&i(!n)}})}),gve="filter"in document.createElement("canvas").getContext("2d"),mve=()=>N("div",{children:[g("h3",{children:M("canvasError.cannotShowPreview")}),g("p",{children:g("span",{children:M("canvasError.canvasTooBig")})}),N("em",{children:["(",M("canvasError.canvasTooBigTip"),")"]})]}),pve=({appStateSnapshot:e,elementsSnapshot:t,files:n,actionManager:i,onExportImage:s,name:r})=>{const o=Yn(t,e),[a,l]=D.useState(r),[c,u]=D.useState(o),[d,f]=D.useState(e.exportBackground),[h,m]=D.useState(e.exportWithDarkMode),[p,U]=D.useState(e.exportEmbedScene),[b,y]=D.useState(e.exportScale),w=D.useRef(null),[v,I]=D.useState(null),{onCopy:C,copyStatus:_,resetCopyStatus:T}=WT();D.useEffect(()=>{T()},[a,d,h,b,p,T]);const{exportedElements:k,exportingFrame:S}=Oy(t,e,c);return D.useEffect(()=>{const R=w.current;if(!R)return;const P=R.offsetWidth,L=R.offsetHeight;P&&Hy({elements:k,appState:{...e,name:a,exportBackground:d,exportWithDarkMode:h,exportScale:b,exportEmbedScene:p},files:n,exportPadding:pg,maxWidthOrHeight:Math.max(P,L),exportingFrame:S}).then(X=>(I(null),Mm(X).then(()=>{R.replaceChildren(X)}).catch(G=>{throw G.name==="CANVAS_POSSIBLY_TOO_BIG"?new Error(M("canvasError.canvasTooBig")):G}))).catch(X=>{console.error(X),I(X)})},[e,n,k,S,a,d,h,b,p]),N("div",{className:"ImageExportModal",children:[g("h3",{children:M("imageExportDialog.header")}),N("div",{className:"ImageExportModal__preview",children:[g("div",{className:"ImageExportModal__preview__canvas",ref:w,children:v&&g(mve,{})}),g("div",{className:"ImageExportModal__preview__filename",children:!Gd&&g("input",{type:"text",className:"TextInput",value:a,style:{width:"30ch"},onChange:R=>{l(R.target.value),i.executeAction(bye,"ui",R.target.value)}})})]}),N("div",{className:"ImageExportModal__settings",children:[g("h3",{children:M("imageExportDialog.header")}),o&&g(U1,{label:M("imageExportDialog.label.onlySelected"),name:"exportOnlySelected",children:g(i2,{name:"exportOnlySelected",checked:c,onChange:R=>{u(R)}})}),g(U1,{label:M("imageExportDialog.label.withBackground"),name:"exportBackgroundSwitch",children:g(i2,{name:"exportBackgroundSwitch",checked:d,onChange:R=>{f(R),i.executeAction(Eye,"ui",R)}})}),gve&&g(U1,{label:M("imageExportDialog.label.darkMode"),name:"exportDarkModeSwitch",children:g(i2,{name:"exportDarkModeSwitch",checked:h,onChange:R=>{m(R),i.executeAction(vye,"ui",R)}})}),g(U1,{label:M("imageExportDialog.label.embedScene"),tooltip:M("imageExportDialog.tooltip.embedScene"),name:"exportEmbedSwitch",children:g(i2,{name:"exportEmbedSwitch",checked:p,onChange:R=>{U(R),i.executeAction(fX,"ui",R)}})}),g(U1,{label:M("imageExportDialog.label.scale"),name:"exportScale",children:g(jj,{name:"exportScale",value:b,onChange:R=>{y(R),i.executeAction(yye,"ui",R)},choices:k9.map(R=>({value:R,label:`${R}`}))})}),N("div",{className:"ImageExportModal__settings__buttons",children:[g(io,{className:"ImageExportModal__settings__buttons__button",label:M("imageExportDialog.title.exportToPng"),onClick:()=>s(U8.png,k,{exportingFrame:S}),icon:ek,children:M("imageExportDialog.button.exportToPng")}),g(io,{className:"ImageExportModal__settings__buttons__button",label:M("imageExportDialog.title.exportToSvg"),onClick:()=>s(U8.svg,k,{exportingFrame:S}),icon:ek,children:M("imageExportDialog.button.exportToSvg")}),(kT||im)&&g(io,{className:"ImageExportModal__settings__buttons__button",label:M("imageExportDialog.title.copyPngToClipboard"),status:_,onClick:async()=>{await s(U8.clipboard,k,{exportingFrame:S}),C()},icon:xp,children:M("imageExportDialog.button.copyPngToClipboard")})]})]})]})},U1=({label:e,children:t,tooltip:n,name:i})=>N("div",{className:"ImageExportModal__settings__setting",title:e,children:[N("label",{htmlFor:i,className:"ImageExportModal__settings__setting__label",children:[e,n&&g(hl,{label:n,long:!0,children:rfe})]}),g("div",{className:"ImageExportModal__settings__setting__content",children:t})]}),Uve=({elements:e,appState:t,files:n,actionManager:i,onExportImage:s,onCloseRequest:r,name:o})=>{const[{appStateSnapshot:a,elementsSnapshot:l}]=D.useState(()=>({appStateSnapshot:Wa(t),elementsSnapshot:Wa(e)}));return g(ir,{onCloseRequest:r,size:"wide",title:!1,children:g(pve,{elementsSnapshot:l,appStateSnapshot:a,files:n,actionManager:i,onExportImage:s,name:o})})},Bv=({children:e,color:t})=>g("div",{className:"Card",style:{"--card-color":t==="primary"?"var(--color-primary)":Ui[t][7],"--card-color-darker":t==="primary"?"var(--color-primary-darker)":Ui[t][8],"--card-color-darkest":t==="primary"?"var(--color-primary-darkest)":Ui[t][9]},children:e}),bve=({elements:e,appState:t,setAppState:n,files:i,actionManager:s,exportOpts:r,canvas:o,onCloseRequest:a})=>{const{onExportToBackend:l}=r;return g("div",{className:"ExportDialog ExportDialog--json",children:N("div",{className:"ExportDialog-cards",children:[r.saveFileToDisk&&N(Bv,{color:"lime",children:[g("div",{className:"Card-icon",children:fde}),g("h2",{children:M("exportDialog.disk_title")}),N("div",{className:"Card-details",children:[M("exportDialog.disk_details"),!Gd&&s.renderAction("changeProjectName")]}),g($e,{className:"Card-button",type:"button",title:M("exportDialog.disk_button"),"aria-label":M("exportDialog.disk_button"),showAriaLabel:!0,onClick:()=>{s.executeAction(hX,"ui")}})]}),l&&N(Bv,{color:"pink",children:[g("div",{className:"Card-icon",children:x6}),g("h2",{children:M("exportDialog.link_title")}),g("div",{className:"Card-details",children:M("exportDialog.link_details")}),g($e,{className:"Card-button",type:"button",title:M("exportDialog.link_button"),"aria-label":M("exportDialog.link_button"),showAriaLabel:!0,onClick:async()=>{try{Qe("export","link",`ui (${gp()})`),await l(e,t,i),a()}catch(c){n({errorMessage:c.message})}}})]}),r.renderCustomUI&&r.renderCustomUI(e,t,i,o)]})})},yve=({elements:e,appState:t,files:n,actionManager:i,exportOpts:s,canvas:r,setAppState:o})=>{var l;const a=ae.useCallback(()=>{o({openDialog:null})},[o]);return g(fe,{children:((l=t.openDialog)==null?void 0:l.name)==="jsonExport"&&g(ir,{onCloseRequest:a,title:M("buttons.export"),children:g(bve,{elements:e,appState:t,setAppState:o,files:n,actionManager:i,onCloseRequest:a,exportOpts:s,canvas:r})})})},Eve="small",vve=e=>N("label",{className:re("ToolIcon ToolIcon__LaserPointer",`ToolIcon_size_${Eve}`,{"is-mobile":e.isMobile}),title:`${e.title}`,children:[g("input",{className:"ToolIcon_type_checkbox",type:"checkbox",name:e.name,onChange:e.onChange,checked:e.checked,"aria-label":e.title,"data-testid":"toolbar-LaserPointer"}),g("div",{className:"ToolIcon__icon",children:pm})]}),wve=({UIOptions:e})=>N(Tt,{__fallback:!0,children:[g(Tt.DefaultItems.LoadScene,{}),g(Tt.DefaultItems.SaveToActiveFile,{}),e.canvasActions.export&&g(Tt.DefaultItems.Export,{}),e.canvasActions.saveAsImage&&g(Tt.DefaultItems.SaveAsImage,{}),g(Tt.DefaultItems.SearchMenu,{}),g(Tt.DefaultItems.Help,{}),g(Tt.DefaultItems.ClearCanvas,{}),g(Tt.Separator,{}),g(Tt.Group,{title:"Excalidraw links",children:g(Tt.DefaultItems.Socials,{})}),g(Tt.Separator,{}),g(Tt.DefaultItems.ToggleTheme,{}),g(Tt.DefaultItems.ChangeCanvasBackground,{})]}),_ve=()=>N(Bu,{__fallback:!0,children:[g(Bu.Actions.SaveToDisk,{}),g(Bu.Actions.ExportToImage,{})]}),Tve=({actionManager:e,appState:t,files:n,setAppState:i,elements:s,canvas:r,onLockToggle:o,onHandToolToggle:a,onPenModeToggle:l,showExitZenModeBtn:c,renderTopLeftUI:u,renderTopRightUI:d,renderCustomStats:f,UIOptions:h,onExportImage:m,renderWelcomeScreen:p,children:U,app:b,isCollaborating:y,generateLinkForSelection:w})=>{var $,j,W;const v=oi(),I=W8e(),C=t.stylesPanelMode==="compact"?{menuTopGap:4,toolbarColGap:4,toolbarRowGap:1,toolbarInnerRowGap:.5,islandPadding:1,collabMarginLeft:8}:{menuTopGap:6,toolbarColGap:4,toolbarRowGap:1,toolbarInnerRowGap:1,islandPadding:1,collabMarginLeft:8},_=I.tunnelsJotai.Provider,[T,k]=un(by),S=()=>h.canvasActions.export?g(yve,{elements:s,appState:t,files:n,actionManager:e,exportOpts:h.canvasActions.export,canvas:r,setAppState:i}):null,R=()=>{var Q;return!h.canvasActions.saveAsImage||((Q=t.openDialog)==null?void 0:Q.name)!=="imageExport"?null:g(Uve,{elements:s,appState:t,files:n,actionManager:e,onExportImage:m,onCloseRequest:()=>i({openDialog:null}),name:b.getName()})},P=()=>N("div",{style:{position:"relative"},children:[g(I.MainMenuTunnel.Out,{}),p&&g(I.WelcomeScreenMenuHintTunnel.Out,{})]}),L=()=>{const Q=t.stylesPanelMode==="compact";return g(Rv,{heading:"selectedShapeActions",className:re("selected-shape-actions zen-mode-transition",{"transition-left":t.zenModeEnabled}),children:Q?g(vr,{className:re("compact-shape-actions-island"),padding:0,style:{maxHeight:`${t.height-166}px`},children:g(q8e,{appState:t,elementsMap:b.scene.getNonDeletedElementsMap(),renderAction:e.renderAction,app:b,setAppState:i})}):g(vr,{className:Zs.SHAPE_ACTIONS_MENU,padding:2,style:{maxHeight:`${t.height-166}px`},children:g(K8e,{appState:t,elementsMap:b.scene.getNonDeletedElementsMap(),renderAction:e.renderAction,app:b})})})},X=()=>{var me,he,Me,mt,We;const Q=yue(t,s),oe=t.stats.open&&!t.zenModeEnabled&&!t.viewModeEnabled&&((me=t.openDialog)==null?void 0:me.name)!=="elementLinkSelector";return g(hj,{side:"top",children:N("div",{className:"App-menu App-menu_top",children:[N(Va.Col,{gap:C.menuTopGap,className:re("App-menu_top__left"),children:[P(),g("div",{className:re("selected-shape-actions-container",{"selected-shape-actions-container--compact":t.stylesPanelMode==="compact"}),children:Q&&L()})]}),!t.viewModeEnabled&&((he=t.openDialog)==null?void 0:he.name)!=="elementLinkSelector"&&g(Rv,{heading:"shapes",className:"shapes-section",children:Ht=>N("div",{style:{position:"relative"},children:[p&&g(I.WelcomeScreenToolbarHintTunnel.Out,{}),g(Va.Col,{gap:C.toolbarColGap,align:"start",children:N(Va.Row,{gap:C.toolbarRowGap,className:re("App-toolbar-container",{"zen-mode":t.zenModeEnabled}),children:[N(vr,{padding:C.islandPadding,className:re("App-toolbar",{"zen-mode":t.zenModeEnabled,"App-toolbar--compact":t.stylesPanelMode==="compact"}),children:[g(fve,{appState:t,isMobile:v.editor.isMobile,device:v,app:b}),Ht,N(Va.Row,{gap:C.toolbarInnerRowGap,children:[g(x7e,{zenModeEnabled:t.zenModeEnabled,checked:t.penMode,onChange:()=>l(null),title:M("toolBar.penMode"),penDetected:t.penDetected}),g(b7e,{checked:t.activeTool.locked,onChange:o,title:M("toolBar.lock")}),g("div",{className:"App-toolbar__divider"}),g(fj,{checked:Yh(t),onChange:()=>a(),title:M("toolBar.hand"),isMobile:!0}),g(J8e,{setAppState:i,activeTool:t.activeTool,UIOptions:h,app:b})]})]}),y&&g(vr,{style:{marginLeft:C.collabMarginLeft,alignSelf:"center",height:"fit-content"},children:g(vve,{title:M("toolBar.laser"),checked:t.activeTool.type===qn.laser,onChange:()=>b.setActiveTool({type:qn.laser}),isMobile:!0})})]})})]})}),N("div",{className:re("layer-ui__wrapper__top-right zen-mode-transition",{"transition-right":t.zenModeEnabled,"layer-ui__wrapper__top-right--compact":t.stylesPanelMode==="compact"}),children:[t.collaborators.size>0&&g(gj,{collaborators:t.collaborators,userToFollow:((Me=t.userToFollow)==null?void 0:Me.socketId)||null}),d==null?void 0:d(v.editor.isMobile,t),!t.viewModeEnabled&&((mt=t.openDialog)==null?void 0:mt.name)!=="elementLinkSelector"&&(!z||((We=t.openSidebar)==null?void 0:We.name)!==Ir.name)&&g(I.DefaultSidebarTriggerTunnel.Out,{}),oe&&g(Sa,{app:b,onClose:()=>{e.executeAction(vv)},renderCustomStats:f})]})]})})},G=()=>g(RD,{__fallback:!0,onDock:Q=>{Qe("sidebar",`toggleDock (${Q?"dock":"undock"})`,`(${v.editor.isMobile?"mobile":"desktop"})`)}}),z=TH($T),V=N(fe,{children:[U,g(wve,{UIOptions:h}),g(RD.Trigger,{__fallback:!0,icon:R_,title:Mt(M("toolBar.library")),onToggle:Q=>{Q&&Qe("sidebar",`${Ir.name} (open)`,`button (${v.editor.isMobile?"mobile":"desktop"})`)},tab:Ir.defaultTab,children:t.stylesPanelMode==="full"&&t.width>=aB&&M("toolBar.library")}),g(_ve,{}),(($=t.openDialog)==null?void 0:$.name)==="ttd"&&g(UY,{__fallback:!0}),t.isLoading&&g(dj,{delay:250}),t.errorMessage&&g(YT,{onClose:()=>i({errorMessage:null}),children:t.errorMessage}),T&&!v.editor.isMobile&&g(_1e,{colorPickerType:T.colorPickerType,onCancel:()=>{k(null)},onChange:(Q,oe,me,{altKey:he})=>{if(!(Q!=="elementBackground"&&Q!=="elementStroke"))if(me.length){for(const Me of me)vi(Me,ve(s),{[he&&T.swapPreviewOnAlt?Q==="elementBackground"?"strokeColor":"backgroundColor":Q==="elementBackground"?"backgroundColor":"strokeColor"]:oe}),Zt.delete(Me);b.scene.triggerUpdate()}else i(Q==="elementBackground"?{currentItemBackgroundColor:oe}:{currentItemStrokeColor:oe})},onSelect:(Q,oe)=>{var me;k(he=>he!=null&&he.keepOpenOnAlt&&oe.altKey?he:null),(me=T==null?void 0:T.onSelect)==null||me.call(T,Q,oe)}}),((j=t.openDialog)==null?void 0:j.name)==="help"&&g(uve,{onClose:()=>{i({openDialog:null})}}),g(i3e,{}),((W=t.openDialog)==null?void 0:W.name)==="elementLinkSelector"&&g(sve,{sourceElementId:t.openDialog.sourceElementId,onClose:()=>{i({openDialog:null})},scene:b.scene,appState:t,generateLinkForSelection:w}),g(I.OverwriteConfirmDialogTunnel.Out,{}),R(),S(),t.pasteDialog.shown&&g(v7e,{setAppState:i,appState:t,onClose:()=>i({pasteDialog:{shown:!1,data:null}})}),v.editor.isMobile&&g(E7e,{app:b,appState:t,elements:s,actionManager:e,renderJSONExportDialog:S,renderImageExportDialog:R,setAppState:i,onHandToolToggle:a,onPenModeToggle:l,renderTopLeftUI:u,renderTopRightUI:d,renderSidebars:G,renderWelcomeScreen:p,UIOptions:h}),!v.editor.isMobile&&N(fe,{children:[N("div",{className:"layer-ui__wrapper",style:t.openSidebar&&z&&v.editor.canFitSidebar?{width:"calc(100% - var(--right-sidebar-width))"}:{},children:[p&&g(I.WelcomeScreenCenterTunnel.Out,{}),X(),g(mj,{appState:t,actionManager:e,showExitZenModeBtn:c,renderWelcomeScreen:p}),t.scrolledOutside&&g("button",{type:"button",className:"scroll-back-to-content",onClick:()=>{i(Q=>({...mm(s,Q)}))},children:M("buttons.scrollBackToContent")})]}),G()]})]});return g(R$.Provider,{value:t,children:g(_,{children:g(KX.Provider,{value:I,children:V})})})},$D=e=>{const{suggestedBindings:t,startBoundElement:n,cursorButton:i,scrollX:s,scrollY:r,...o}=e;return o},Ive=(e,t)=>{if(e.children!==t.children)return!1;const{canvas:n,appState:i,...s}=e,{canvas:r,appState:o,...a}=t;return Wi($D(i),$D(o),{selectedElementIds:Wi,selectedGroupIds:Wi})&&Wi(s,a)},Sve=ae.memo(Tve,Ive),xve="small",O3=e=>N("label",{className:re("ToolIcon ToolIcon__MagicButton",`ToolIcon_size_${xve}`,{"is-mobile":e.isMobile}),title:`${e.title}`,children:[g("input",{className:"ToolIcon_type_checkbox",type:"checkbox",name:e.name,onChange:e.onChange,checked:e.checked,"aria-label":e.title}),g("div",{className:"ToolIcon__icon",children:e.icon})]}),Cve=({trails:e})=>{const t=D.useRef(null);return D.useEffect(()=>{if(t.current)for(const n of e)n.start(t.current);return()=>{for(const n of e)n.stop()}},e),g("div",{className:"SVGLayer",children:g("svg",{ref:t})})},Ave=e=>{const t=D.useRef(!1);return D.useEffect(()=>{var l;if(!t.current){t.current=!0;return}const n=new Map,i=new Map,s=new Map,r=new Map,o=new Map;e.appState.collaborators.forEach((c,u)=>{if(c.selectedElementIds)for(const d of Object.keys(c.selectedElementIds))s.has(d)||s.set(d,[]),s.get(d).push(u);!c.pointer||c.pointer.renderCursor===!1||(c.username&&r.set(u,c.username),c.userState&&o.set(u,c.userState),i.set(u,Xs({sceneX:c.pointer.x,sceneY:c.pointer.y},e.appState)),n.set(u,c.button))});const a=((l=e.containerRef)==null?void 0:l.current)&&getComputedStyle(e.containerRef.current).getPropertyValue("--color-selection")||"#6965db";j3e({canvas:e.canvas,elementsMap:e.elementsMap,visibleElements:e.visibleElements,selectedElements:e.selectedElements,allElementsMap:e.allElementsMap,scale:window.devicePixelRatio,appState:e.appState,renderConfig:{remotePointerViewportCoords:i,remotePointerButton:n,remoteSelectedElementIds:s,remotePointerUsernames:r,remotePointerUserStates:o,selectionColor:a,renderScrollbars:e.renderScrollbars},device:e.device,callback:e.renderInteractiveSceneCallback},zT())}),g("canvas",{className:"excalidraw__canvas interactive",style:{width:e.appState.width,height:e.appState.height,cursor:e.appState.viewModeEnabled?xt.GRAB:xt.AUTO},width:e.appState.width*e.scale,height:e.appState.height*e.scale,ref:e.handleCanvasRef,onContextMenu:e.onContextMenu,onPointerMove:e.onPointerMove,onPointerUp:e.onPointerUp,onPointerCancel:e.onPointerCancel,onTouchMove:e.onTouchMove,onPointerDown:e.onPointerDown,onDoubleClick:e.appState.viewModeEnabled?void 0:e.onDoubleClick,children:M("labels.drawingCanvas")})},GD=e=>({zoom:e.zoom,scrollX:e.scrollX,scrollY:e.scrollY,width:e.width,height:e.height,viewModeEnabled:e.viewModeEnabled,openDialog:e.openDialog,editingGroupId:e.editingGroupId,selectedElementIds:e.selectedElementIds,frameToHighlight:e.frameToHighlight,offsetLeft:e.offsetLeft,offsetTop:e.offsetTop,theme:e.theme,selectionElement:e.selectionElement,selectedGroupIds:e.selectedGroupIds,selectedLinearElement:e.selectedLinearElement,multiElement:e.multiElement,isBindingEnabled:e.isBindingEnabled,suggestedBindings:e.suggestedBindings,isRotating:e.isRotating,elementsToHighlight:e.elementsToHighlight,collaborators:e.collaborators,activeEmbeddable:e.activeEmbeddable,snapLines:e.snapLines,zenModeEnabled:e.zenModeEnabled,editingTextElement:e.editingTextElement,isCropping:e.isCropping,croppingElementId:e.croppingElementId,searchMatches:e.searchMatches,activeLockedId:e.activeLockedId}),Mve=(e,t)=>e.selectionNonce!==t.selectionNonce||e.sceneNonce!==t.sceneNonce||e.scale!==t.scale||e.elementsMap!==t.elementsMap||e.visibleElements!==t.visibleElements||e.selectedElements!==t.selectedElements||e.renderScrollbars!==t.renderScrollbars?!1:Wi(GD(e.appState),GD(t.appState)),kve=ae.memo(Ave,Mve),Rve=e=>{const t=D.useRef(null),n=D.useRef(!1);return D.useEffect(()=>{e.canvas.style.width=`${e.appState.width}px`,e.canvas.style.height=`${e.appState.height}px`,e.canvas.width=e.appState.width*e.scale,e.canvas.height=e.appState.height*e.scale},[e.appState.height,e.appState.width,e.canvas,e.scale]),D.useEffect(()=>{const i=t.current;if(!i)return;const s=e.canvas;n.current||(n.current=!0,i.replaceChildren(s),s.classList.add("excalidraw__canvas","static")),ZG({canvas:s,rc:e.rc,scale:e.scale,elementsMap:e.elementsMap,allElementsMap:e.allElementsMap,visibleElements:e.visibleElements,appState:e.appState,renderConfig:e.renderConfig},zT())}),g("div",{className:"excalidraw__canvas-wrapper",ref:t})},XD=e=>({zoom:e.zoom,scrollX:e.scrollX,scrollY:e.scrollY,width:e.width,height:e.height,viewModeEnabled:e.viewModeEnabled,openDialog:e.openDialog,hoveredElementIds:e.hoveredElementIds,offsetLeft:e.offsetLeft,offsetTop:e.offsetTop,theme:e.theme,shouldCacheIgnoreZoom:e.shouldCacheIgnoreZoom,viewBackgroundColor:e.viewBackgroundColor,exportScale:e.exportScale,selectedElementsAreBeingDragged:e.selectedElementsAreBeingDragged,gridSize:e.gridSize,gridStep:e.gridStep,frameRendering:e.frameRendering,selectedElementIds:e.selectedElementIds,frameToHighlight:e.frameToHighlight,editingGroupId:e.editingGroupId,currentHoveredFontFamily:e.currentHoveredFontFamily,croppingElementId:e.croppingElementId}),Dve=(e,t)=>e.sceneNonce!==t.sceneNonce||e.scale!==t.scale||e.elementsMap!==t.elementsMap||e.visibleElements!==t.visibleElements?!1:Wi(XD(e.appState),XD(t.appState))&&Wi(e.renderConfig,t.renderConfig),Lve=ae.memo(Rve,Dve),bY=({canvas:e,rc:t,newElement:n,elementsMap:i,allElementsMap:s,scale:r,appState:o,renderConfig:a})=>{var l;if(e){const[c,u]=Ry(e,r),d=Dy({canvas:e,scale:r,normalizedWidth:c,normalizedHeight:u});if(d.save(),d.scale(o.zoom.value,o.zoom.value),n&&n.type!=="selection"){if(qa(n))return;if((n.frameId||((l=o.frameToHighlight)==null?void 0:l.id))&&o.frameRendering.enabled&&o.frameRendering.clip){const h=g6(n,i,o);h&&x4(n,h,o,i)&&Uv(h,d,a,o)}wu(n,i,s,t,d,a,o)}else d.clearRect(0,0,c,u);d.restore()}},Nve=Ug(e=>{bY(e)},{trailing:!0}),Ove=(e,t)=>{if(t){Nve(e);return}bY(e)},Pve=e=>{const t=D.useRef(null);return D.useEffect(()=>{t.current&&Ove({canvas:t.current,scale:e.scale,newElement:e.appState.newElement,elementsMap:e.elementsMap,allElementsMap:e.allElementsMap,rc:e.rc,renderConfig:e.renderConfig,appState:e.appState},zT())}),g("canvas",{className:"excalidraw__canvas",style:{width:e.appState.width,height:e.appState.height},width:e.appState.width*e.scale,height:e.appState.height*e.scale,ref:t})},Fve=5e3,Bve=({message:e,onClose:t,closable:n=!1,duration:i=Fve,style:s})=>{const r=D.useRef(0),o=i!==1/0,a=D.useCallback(()=>{o&&(r.current=window.setTimeout(()=>t(),i))},[t,i,o]);return D.useEffect(()=>{if(o)return a(),()=>clearTimeout(r.current)},[a,e,i,o]),N("div",{className:"Toast",onMouseEnter:o?()=>clearTimeout(r==null?void 0:r.current):void 0,onMouseLeave:o?a:void 0,style:s,children:[g("p",{className:"Toast__message",children:e}),n&&g($e,{icon:Vd,"aria-label":"close",type:"icon",onClick:t,className:"close"})]})},zve=({app:e,activeLockedId:t})=>{const n=e.scene.getElement(t),i=n?[n]:Ct(e.scene.getNonDeletedElementsMap(),t);if(i.length===0)return null;const[s,r]=ft(i),{x:o,y:a}=Xs({sceneX:s,sceneY:r},e.state);return g("div",{className:"UnlockPopup",style:{bottom:`${e.state.height+12-a+e.state.offsetTop}px`,left:`${o-e.state.offsetLeft}px`},onClick:()=>{hi.flushSync(()=>{const l=_p(i,e.state);e.setState({selectedElementIds:i.reduce((c,u)=>({...c,[u.id]:!0}),{}),selectedGroupIds:l,activeLockedId:null})}),e.actionManager.executeAction(wX)},title:M("labels.elementLock.unlock"),children:Jue})},yY=ae.createContext(null),EY=ae.createContext(null),vY={viewport:{isMobile:!1,isLandscape:!1},editor:{isMobile:!1,canFitSidebar:!1},isTouchScreen:!1},KT=ae.createContext(vY);KT.displayName="DeviceContext";const ZT=ae.createContext({container:null,id:null});ZT.displayName="ExcalidrawContainerContext";const qT=ae.createContext([]);qT.displayName="ExcalidrawElementsContext";const QT=ae.createContext({...ia(),width:0,height:0,offsetLeft:0,offsetTop:0});QT.displayName="ExcalidrawAppStateContext";const JT=ae.createContext(()=>{console.warn("Uninitialized ExcalidrawSetAppStateContext context!")});JT.displayName="ExcalidrawSetAppStateContext";const eI=ae.createContext(null);eI.displayName="ExcalidrawActionManagerContext";const go=()=>D.useContext(yY),Np=()=>D.useContext(EY),oi=()=>D.useContext(KT),Lr=()=>D.useContext(ZT),Wy=()=>D.useContext(qT),Op=()=>D.useContext(QT),xn=()=>D.useContext(JT),ks=()=>D.useContext(eI);let b1=!1,P3=0,y1=null,pu=!1,E1=!1,F3=!1,v1={horizontal:null,vertical:null},Ol=0,w1=!1;const B3=new Map;let z3=!1,jD=0,YD=!1,Uu=null;const pt={pointers:new Map,lastCenter:null,initialDistance:null,initialScale:null};class tI extends ae.Component{constructor(n){super(n);F(this,"canvas");F(this,"interactiveCanvas",null);F(this,"rc");F(this,"unmounted",!1);F(this,"actionManager");F(this,"device",vY);F(this,"excalidrawContainerRef",ae.createRef());F(this,"scene");F(this,"fonts");F(this,"renderer");F(this,"visibleElements");F(this,"resizeObserver");F(this,"nearestScrollableContainer");F(this,"library");F(this,"libraryItemsFromStorage");F(this,"id");F(this,"store");F(this,"history");F(this,"excalidrawContainerValue");F(this,"files",{});F(this,"imageCache",new Map);F(this,"iFrameRefs",new Map);F(this,"embedsValidationStatus",new Map);F(this,"initializedEmbeds",new Set);F(this,"handleToastClose",()=>{this.setToast(null)});F(this,"elementsPendingErasure",new Set);F(this,"flowChartCreator",new iue);F(this,"flowChartNavigator",new nue);F(this,"hitLinkElement");F(this,"lastPointerDownEvent",null);F(this,"lastPointerUpEvent",null);F(this,"lastPointerMoveEvent",null);F(this,"lastPointerMoveCoords",null);F(this,"lastViewportPosition",{x:0,y:0});F(this,"animationFrameHandler",new U3e);F(this,"laserTrails",new t7e(this.animationFrameHandler,this));F(this,"eraserTrail",new f7e(this.animationFrameHandler,this));F(this,"lassoTrail",new d7e(this.animationFrameHandler,this));F(this,"onChangeEmitter",new $r);F(this,"onPointerDownEmitter",new $r);F(this,"onPointerUpEmitter",new $r);F(this,"onUserFollowEmitter",new $r);F(this,"onScrollChangeEmitter",new $r);F(this,"missingPointerEventCleanupEmitter",new $r);F(this,"onRemoveEventListenersEmitter",new $r);F(this,"updateEditorAtom",(n,...i)=>{const s=Hs.set(n,...i);return this.triggerRender(),s});F(this,"getEffectiveGridSize",()=>Nm(this)?this.state.gridSize:null);F(this,"updateEmbedValidationStatus",(n,i)=>{this.embedsValidationStatus.set(n.id,i),Zt.delete(n)});F(this,"updateEmbeddables",()=>{const n=new Set;let i=!1;this.scene.getNonDeletedElements().filter(s=>{if(rs(s)){if(n.add(s.id),!this.embedsValidationStatus.has(s.id)){i=!0;const r=O2(s.link,this.props.validateEmbeddable);this.updateEmbedValidationStatus(s,r)}}else jl(s)&&n.add(s.id);return!1}),i&&this.scene.triggerUpdate(),this.iFrameRefs.forEach((s,r)=>{n.has(r)||this.iFrameRefs.delete(r)})});F(this,"getFrameNameDOMId",n=>`${this.id}-frame-name-${n.id}`);F(this,"frameNameBoundsCache",{get:n=>{let i=this.frameNameBoundsCache._cache.get(n.id);if(!i||i.zoom!==this.state.zoom.value||i.versionNonce!==n.versionNonce){const s=document.getElementById(this.getFrameNameDOMId(n));if(s){const r=s.getBoundingClientRect(),o=Dt({clientX:r.x,clientY:r.y},this.state),a=Dt({clientX:r.right,clientY:r.bottom},this.state);return i={x:o.x,y:o.y,width:a.x-o.x,height:a.y-o.y,angle:0,zoom:this.state.zoom.value,versionNonce:n.versionNonce},this.frameNameBoundsCache._cache.set(n.id,i),i}return null}return i},_cache:new Map});F(this,"resetEditingFrame",n=>{var i;n&&this.scene.mutateElement(n,{name:((i=n.name)==null?void 0:i.trim())||null}),this.setState({editingFrame:null})});F(this,"renderFrameNames",()=>{var r;if(!this.state.frameRendering.enabled||!this.state.frameRendering.name)return this.state.editingFrame&&this.resetEditingFrame(null),null;const n=this.state.theme===ke.DARK,i=this.scene.getNonDeletedFramesLikes(),s=i.length>0&&(r=this.state.searchMatches)!=null&&r.focusedId&&Ee(this.scene.getElement(this.state.searchMatches.focusedId))?this.state.searchMatches.matches.find(o=>o.focus):null;return i.map(o=>{if(!w6(o,this.canvas.width/window.devicePixelRatio,this.canvas.height/window.devicePixelRatio,{offsetLeft:this.state.offsetLeft,offsetTop:this.state.offsetTop,scrollX:this.state.scrollX,scrollY:this.state.scrollY,zoom:this.state.zoom},this.scene.getNonDeletedElementsMap()))return this.state.editingFrame===o.id&&this.resetEditingFrame(o),null;const{x:a,y:l}=Xs({sceneX:o.x,sceneY:o.y},this.state),c=6;let u;const d=Sz(o);if(o.id===this.state.editingFrame){const f=d;u=g("input",{autoFocus:!0,value:f,onChange:h=>{this.scene.mutateElement(o,{name:h.target.value})},onFocus:h=>h.target.select(),onBlur:()=>this.resetEditingFrame(o),onKeyDown:h=>{(h.key===H.ESCAPE||h.key===H.ENTER)&&this.resetEditingFrame(o)},style:{background:this.state.viewBackgroundColor,filter:n?M9:"none",zIndex:2,border:"none",display:"block",padding:`${c}px`,borderRadius:4,boxShadow:"inset 0 0 0 1px var(--color-primary)",fontFamily:"Assistant",fontSize:`${Ft.nameFontSize}px`,transform:`translate(-${c}px, ${c}px)`,color:"var(--color-gray-80)",overflow:"hidden",maxWidth:`${document.body.clientWidth-a-c}px`},size:f.length+1||1,dir:"auto",autoComplete:"off",autoCapitalize:"off",autoCorrect:"off"})}else u=d;return g("div",{id:this.getFrameNameDOMId(o),style:{position:"absolute",bottom:`${this.state.height+Ft.nameOffsetY-l+this.state.offsetTop}px`,left:`${a-this.state.offsetLeft}px`,zIndex:2,fontSize:Ft.nameFontSize,color:n?Ft.nameColorDarkTheme:Ft.nameColorLightTheme,lineHeight:Ft.nameLineHeight,width:"max-content",maxWidth:(s==null?void 0:s.id)===o.id&&(s!=null&&s.focus)?"none":`${o.width*this.state.zoom.value}px`,overflow:o.id===this.state.editingFrame?"visible":"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",cursor:xt.MOVE,pointerEvents:this.state.viewModeEnabled?Eu.disabled:Eu.enabled},onPointerDown:f=>this.handleCanvasPointerDown(f),onWheel:f=>this.handleWheel(f),onContextMenu:this.handleCanvasContextMenu,onDoubleClick:()=>{this.setState({editingFrame:o.id})},children:u},o.id)})});F(this,"focusContainer",()=>{var n;(n=this.excalidrawContainerRef.current)==null||n.focus()});F(this,"getSceneElementsIncludingDeleted",()=>this.scene.getElementsIncludingDeleted());F(this,"getSceneElementsMapIncludingDeleted",()=>this.scene.getElementsMapIncludingDeleted());F(this,"getSceneElements",()=>this.scene.getNonDeletedElements());F(this,"onInsertElements",n=>{this.addElementsFromPasteOrLibrary({elements:n,position:"center",files:null})});F(this,"onExportImage",async(n,i,s)=>{Qe("export",n,"ui");const r=await Py(n,i,this.state,this.files,{exportBackground:this.state.exportBackground,name:this.getName(),viewBackgroundColor:this.state.viewBackgroundColor,exportingFrame:s.exportingFrame}).catch(SB).catch(o=>{console.error(o),this.setState({errorMessage:o.message})});this.state.exportEmbedScene&&r&&CT(r)&&this.setState({fileHandle:r})});F(this,"magicGenerations",new Map);F(this,"updateMagicGeneration",({frameElement:n,data:i})=>{i.status==="pending"?this.scene.mutateElement(n,{customData:{generationData:void 0}},{informMutation:!1,isDragging:!1}):this.scene.mutateElement(n,{customData:{generationData:i}},{informMutation:!1,isDragging:!1}),this.magicGenerations.set(n.id,i),this.triggerRender()});F(this,"plugins",{});F(this,"onMagicframeToolSelect",()=>{const n=this.scene.getSelectedElements({selectedElementIds:this.state.selectedElementIds});if(n.length===0)this.setActiveTool({type:qn.magicframe}),Qe("ai","tool-select (empty-selection)","d2c");else{const i=n.length===1&&R2(n[0])&&n[0];if(!i&&n.some(r=>Ee(r)||r.frameId)){this.setActiveTool({type:qn.magicframe});return}Qe("ai","tool-select (existing selection)","d2c");let s;if(i)s=i;else{const[r,o,a,l]=ft(n),c=50;s=N4({...Ft,x:r-c,y:o-c,width:a-r+c*2,height:l-o+c*2,opacity:100,locked:!1}),this.scene.insertElement(s);for(const u of n)this.scene.mutateElement(u,{frameId:s.id});this.setState({selectedElementIds:{[s.id]:!0}})}this.onMagicFrameGenerate(s,"upstream")}});F(this,"openEyeDropper",({type:n})=>{this.updateEditorAtom(by,{swapPreviewOnAlt:!0,colorPickerType:n==="stroke"?"elementStroke":"elementBackground",onSelect:(i,s)=>{const r=n==="background"&&s.altKey||n==="stroke"&&!s.altKey;!this.scene.getSelectedElements(this.state).length||this.state.activeTool.type!=="selection"?r?this.syncActionResult({appState:{...this.state,currentItemStrokeColor:i},captureUpdate:K.IMMEDIATELY}):this.syncActionResult({appState:{...this.state,currentItemBackgroundColor:i},captureUpdate:K.IMMEDIATELY}):this.updateScene({elements:this.scene.getElementsIncludingDeleted().map(a=>this.state.selectedElementIds[a.id]?Te(a,{[r?"strokeColor":"backgroundColor"]:i}):a),captureUpdate:K.IMMEDIATELY})},keepOpenOnAlt:!1})});F(this,"dismissLinearEditor",()=>{setTimeout(()=>{var n;(n=this.state.selectedLinearElement)!=null&&n.isEditing&&this.setState({selectedLinearElement:{...this.state.selectedLinearElement,isEditing:!1}})})});F(this,"syncActionResult",on(n=>{var r,o,a,l,c,u;if(this.unmounted||n===!1)return;this.store.scheduleAction(n.captureUpdate);let i=!1,s=null;if(n.elements&&(this.scene.replaceAllElements(n.elements),i=!0),n.files&&(this.addMissingFiles(n.files,n.replaceFiles),this.addNewImagesToImageCache()),n.appState||s||this.state.contextMenu){let d=((r=n==null?void 0:n.appState)==null?void 0:r.viewModeEnabled)||!1,f=((o=n==null?void 0:n.appState)==null?void 0:o.zenModeEnabled)||!1;const h=((a=n==null?void 0:n.appState)==null?void 0:a.theme)||this.props.theme||ke.LIGHT,m=((l=n==null?void 0:n.appState)==null?void 0:l.name)??this.state.name,p=((c=n==null?void 0:n.appState)==null?void 0:c.errorMessage)??this.state.errorMessage;typeof this.props.viewModeEnabled<"u"&&(d=this.props.viewModeEnabled),typeof this.props.zenModeEnabled<"u"&&(f=this.props.zenModeEnabled),s=((u=n.appState)==null?void 0:u.editingTextElement)||null,n.elements&&s&&n.elements.forEach(U=>{(s==null?void 0:s.id)===U.id&&s!==U&&$4(U)&&de(U)&&(s=U)}),s!=null&&s.isDeleted&&(s=null),this.setState(U=>{const b=n.appState||{};return{...U,...b,contextMenu:null,editingTextElement:s,viewModeEnabled:d,zenModeEnabled:f,theme:h,name:m,errorMessage:p}}),i=!0}i||this.scene.triggerUpdate()}));F(this,"onBlur",on(()=>{pu=!1,this.setState({isBindingEnabled:!0})}));F(this,"onUnload",()=>{this.onBlur()});F(this,"disableEvent",n=>{n.preventDefault()});F(this,"resetHistory",()=>{this.history.clear()});F(this,"resetStore",()=>{this.store.clear()});F(this,"resetScene",on(n=>{this.scene.replaceAllElements([]),this.setState(i=>({...ia(),isLoading:n!=null&&n.resetLoadingState?!1:i.isLoading,theme:this.state.theme})),this.resetStore(),this.resetHistory()}));F(this,"initializeScene",async()=>{var r;"launchQueue"in window&&"LaunchParams"in window&&window.launchQueue.setConsumer(async o=>{if(!o.files.length)return;const a=o.files[0],l=await a.getFile();this.loadFileToCanvas(new File([l],l.name||"",{type:l.type}),a)}),this.props.theme&&this.setState({theme:this.props.theme}),this.state.isLoading||this.setState({isLoading:!0});let n=null;try{typeof this.props.initialData=="function"?n=await this.props.initialData()||null:n=await this.props.initialData||null,n!=null&&n.libraryItems&&this.library.updateLibrary({libraryItems:n.libraryItems,merge:!0}).catch(o=>{console.error(o)})}catch(o){console.error(o),n={appState:{errorMessage:o.message||"Encountered an error during importing or restoring scene data"}}}const i=Td(n,null,null,{repairBindings:!0,deleteInvisibleElements:!0}),s=i.appState.activeTool;i.appState.preferredSelectionTool.initialized||(i.appState.preferredSelectionTool={type:this.device.editor.isMobile?"lasso":"selection",initialized:!0}),i.appState={...i.appState,theme:this.props.theme||i.appState.theme,openSidebar:((r=i.appState)==null?void 0:r.openSidebar)||this.state.openSidebar,activeTool:s.type==="image"||s.type==="lasso"||s.type==="selection"?{...s,type:i.appState.preferredSelectionTool.type}:i.appState.activeTool,isLoading:!1,toast:this.state.toast},n!=null&&n.scrollToContent&&(i.appState={...i.appState,...mm(i.elements,{...i.appState,width:this.state.width,height:this.state.height,offsetTop:this.state.offsetTop,offsetLeft:this.state.offsetLeft})}),this.resetStore(),this.resetHistory(),this.syncActionResult({...i,captureUpdate:K.NEVER}),this.clearImageShapeCache(),this.fonts.loadSceneFonts().then(o=>{this.fonts.onLoaded(o)}),ch(window.location.href)&&this.scrollToContent(window.location.href,{animate:!1})});F(this,"isMobileBreakpoint",(n,i)=>n<=oB||i<Nse&&n<Lse);F(this,"isTabletBreakpoint",(n,i)=>{const s=Math.min(n,i),r=Math.max(n,i);return s>=Ose&&r<=Pse});F(this,"refreshViewportBreakpoints",()=>{const n=this.excalidrawContainerRef.current;if(!n)return;const{width:i,height:s}=n.getBoundingClientRect(),r=this.device.viewport,o=C2(r,{isLandscape:i>s,isMobile:this.isMobileBreakpoint(i,s)});return r!==o?(this.device={...this.device,viewport:o},!0):!1});F(this,"refreshEditorBreakpoints",()=>{const n=this.excalidrawContainerRef.current;if(!n)return;const{width:i,height:s}=n.getBoundingClientRect(),r=this.props.UIOptions.dockedSidebarBreakpoint!=null?this.props.UIOptions.dockedSidebarBreakpoint:Fse,o=this.device.editor,a=C2(o,{isMobile:this.isMobileBreakpoint(i,s),canFitSidebar:i>r}),l=this.isTabletBreakpoint(i,s)&&vo()?"compact":this.isMobileBreakpoint(i,s)?"mobile":"full";return this.setState(c=>({stylesPanelMode:l,preferredSelectionTool:l==="full"?{type:"selection",initialized:!0}:c.preferredSelectionTool})),o!==a?(this.device={...this.device,editor:a},!0):!1});F(this,"onResize",on(()=>{this.scene.getElementsIncludingDeleted().forEach(n=>Zt.delete(n)),this.refreshViewportBreakpoints(),this.updateDOMRect(),u4||this.refreshEditorBreakpoints(),this.setState({})}));F(this,"onFullscreenChange",()=>{var n;!document.fullscreenElement&&((n=this.state.activeEmbeddable)==null?void 0:n.state)==="active"&&this.setState({activeEmbeddable:null})});F(this,"renderInteractiveSceneCallback",({atLeastOneVisibleElement:n,scrollBars:i,elementsMap:s})=>{i&&(v1=i);const r=this.state.editingTextElement?!1:!n&&s.size>0;this.state.scrolledOutside!==r&&this.setState({scrolledOutside:r}),this.scheduleImageRefresh()});F(this,"onScroll",sl(()=>{const{offsetTop:n,offsetLeft:i}=this.getCanvasOffsets();this.setState(s=>s.offsetLeft===i&&s.offsetTop===n?null:{offsetTop:n,offsetLeft:i})},Rse));F(this,"onCut",on(n=>{var s;!((s=this.excalidrawContainerRef.current)!=null&&s.contains(document.activeElement))||ka(n.target)||(this.actionManager.executeAction(OR,"keyboard",n),n.preventDefault(),n.stopPropagation())}));F(this,"onCopy",on(n=>{var s;!((s=this.excalidrawContainerRef.current)!=null&&s.contains(document.activeElement))||ka(n.target)||(this.actionManager.executeAction(q2,"keyboard",n),n.preventDefault(),n.stopPropagation())}));F(this,"onTouchStart",n=>{if(I9&&n.preventDefault(),!b1){b1=!0,n.touches.length===1&&(y1={x:n.touches[0].clientX,y:n.touches[0].clientY}),clearTimeout(P3),P3=window.setTimeout(tI.resetTapTwice,Ase);return}if(b1&&n.touches.length===1&&y1){const i=n.touches[0];at(x(i.clientX,i.clientY),x(y1.x,y1.y))<=jse&&(this.lassoTrail.endPath(),this.deselectElements(),this.handleCanvasDoubleClick({clientX:i.clientX,clientY:i.clientY})),b1=!1,clearTimeout(P3)}n.touches.length===2&&this.setState({selectedElementIds:St({},this.state),activeEmbeddable:null})});F(this,"onTouchEnd",n=>{this.resetContextMenuTimer(),n.touches.length>0?this.setState({previousSelectedElementIds:{},selectedElementIds:St(this.state.previousSelectedElementIds,this.state)}):pt.pointers.clear()});F(this,"pasteFromClipboard",on(async n=>{var u;const i=!!z3,s=document.activeElement,r=(u=this.excalidrawContainerRef.current)==null?void 0:u.contains(s);if(n&&!r)return;const o=document.elementFromPoint(this.lastViewportPosition.x,this.lastViewportPosition.y);if(n&&(!(o instanceof HTMLCanvasElement)||ka(s)))return;const a=await bv(n),l=a.getFiles(),c=await hye(a,i);if(this.props.onPaste)try{if(await this.props.onPaste(c,n)===!1)return}catch(d){console.error(d)}await this.insertClipboardContent(c,l,i),this.setActiveTool({type:this.state.preferredSelectionTool.type},!0),n==null||n.preventDefault()}));F(this,"addElementsFromPasteOrLibrary",n=>{var T,k;const i=_d(n.elements,null,{deleteInvisibleElements:!0}),[s,r,o,a]=ft(i),l=$i(s,o)/2,c=$i(r,a)/2,u=typeof n.position=="object"?n.position.clientX:n.position==="cursor"?this.lastViewportPosition.x:this.state.width/2+this.state.offsetLeft,d=typeof n.position=="object"?n.position.clientY:n.position==="cursor"?this.lastViewportPosition.y:this.state.height/2+this.state.offsetTop,{x:f,y:h}=Dt({clientX:u,clientY:d},this.state),m=f-l,p=h-c,[U,b]=On(m,p,this.getEffectiveGridSize()),{duplicatedElements:y}=E0({type:"everything",elements:i.map(S=>Te(S,{x:S.x+U-s,y:S.y+b-r})),randomizeSeed:!n.retainSeed}),w=this.scene.getElementsIncludingDeleted();let v=[...w,...y];v=((k=(T=this.props).onDuplicate)==null?void 0:k.call(T,v,w))||v,oo(v,ve(y));const C=this.getTopLayerFrameAtSceneCoords({x:f,y:h});if(C){const S=jle(y,C);y0(v,S,C,this.state)}this.scene.replaceAllElements(v),y.forEach(S=>{if(de(S)&&zt(S)){const R=jn(S,this.scene.getElementsMapIncludingDeleted());qi(S,R,this.scene)}}),mse&&Qa.loadElementsFonts(y).then(S=>{this.fonts.onLoaded(S)}),n.files&&this.addMissingFiles(n.files);const _=l_(y);this.store.scheduleCapture(),this.setState({...this.state,openSidebar:this.state.openSidebar&&this.device.editor.canFitSidebar&&Hs.get($T)?this.state.openSidebar:null,...Ii({editingGroupId:null,selectedElementIds:_.reduce((S,R)=>(zt(R)||(S[R.id]=!0),S),{})},this.scene.getNonDeletedElements(),this.state,this)},()=>{n.files&&this.addNewImagesToImageCache()}),this.setActiveTool({type:this.state.preferredSelectionTool.type},!0),n.fitToContent&&this.scrollToContent(y,{fitToContent:!0,canvasOffsets:this.getEditorUIOffsets()})});F(this,"setAppState",(n,i)=>{this.setState(n,i)});F(this,"removePointer",n=>{Ol&&this.resetContextMenuTimer(),pt.pointers.delete(n.pointerId)});F(this,"toggleLock",(n="ui")=>{this.state.activeTool.locked||Qe("toolbar","toggleLock",`${n} (${this.device.editor.isMobile?"mobile":"desktop"})`),this.setState(i=>({activeTool:{...i.activeTool,...en(this.state,i.activeTool.locked?{type:this.state.preferredSelectionTool.type}:i.activeTool),locked:!i.activeTool.locked}}))});F(this,"updateFrameRendering",n=>{this.setState(i=>{const s=typeof n=="function"?n(i.frameRendering):n;return{frameRendering:{enabled:(s==null?void 0:s.enabled)??i.frameRendering.enabled,clip:(s==null?void 0:s.clip)??i.frameRendering.clip,name:(s==null?void 0:s.name)??i.frameRendering.name,outline:(s==null?void 0:s.outline)??i.frameRendering.outline}}})});F(this,"togglePenMode",n=>{this.setState(i=>({penMode:n??!i.penMode,penDetected:!0}))});F(this,"onHandToolToggle",()=>{this.actionManager.executeAction(M2e)});F(this,"zoomCanvas",n=>{this.setState({...Nu({viewportX:this.state.width/2+this.state.offsetLeft,viewportY:this.state.height/2+this.state.offsetTop,nextZoom:Ha(n)},this.state)})});F(this,"cancelInProgressAnimation",null);F(this,"scrollToContent",(n=this.scene.getNonDeletedElements(),i)=>{var l;if(typeof n=="string"){let c;if(ch(n)?c=Pce(n):c=n,c){const u=this.scene.getElementsFromId(c);u!=null&&u.length?this.scrollToContent(u,{fitToContent:(i==null?void 0:i.fitToContent)??!0,animate:(i==null?void 0:i.animate)??!0}):ch(n)&&this.setState({toast:{message:M("elementLink.notFound"),duration:3e3,closable:!0}})}return}(l=this.cancelInProgressAnimation)==null||l.call(this);const s=Array.isArray(n)?n:[n];let r=this.state.zoom,o=this.state.scrollX,a=this.state.scrollY;if(i!=null&&i.fitToContent||i!=null&&i.fitToViewport){const{appState:c}=_y({canvasOffsets:i.canvasOffsets,targetElements:s,appState:this.state,fitToViewport:!!(i!=null&&i.fitToViewport),viewportZoomFactor:i==null?void 0:i.viewportZoomFactor,minZoom:i==null?void 0:i.minZoom,maxZoom:i==null?void 0:i.maxZoom});r=c.zoom,o=c.scrollX,a=c.scrollY}else{const c=mm(s,this.state);o=c.scrollX,a=c.scrollY}if(i!=null&&i.animate){const c=this.state.scrollX,u=this.state.scrollY,d=this.state.zoom.value,f=yre({fromValues:{scrollX:c,scrollY:u,zoom:d},toValues:{scrollX:o,scrollY:a,zoom:r.value},interpolateValue:(h,m,p,U)=>{if(U==="zoom")return h*Math.pow(m/h,rl(p))},onStep:({scrollX:h,scrollY:m,zoom:p})=>{this.setState({scrollX:h,scrollY:m,zoom:{value:p}})},onStart:()=>{this.setState({shouldCacheIgnoreZoom:!0})},onEnd:()=>{this.setState({shouldCacheIgnoreZoom:!1})},onCancel:()=>{this.setState({shouldCacheIgnoreZoom:!1})},duration:(i==null?void 0:i.duration)??500});this.cancelInProgressAnimation=()=>{f(),this.cancelInProgressAnimation=null}}else this.setState({scrollX:o,scrollY:a,zoom:r})});F(this,"maybeUnfollowRemoteUser",()=>{this.state.userToFollow&&this.setState({userToFollow:null})});F(this,"translateCanvas",n=>{var i;(i=this.cancelInProgressAnimation)==null||i.call(this),this.maybeUnfollowRemoteUser(),this.setState(n)});F(this,"setToast",n=>{this.setState({toast:n})});F(this,"restoreFileFromShare",async()=>{try{const n=await caches.open("web-share-target"),i=await n.match("shared-file");if(i){const s=await i.blob(),r=new File([s],s.name||"",{type:s.type});this.loadFileToCanvas(r,null),await n.delete("shared-file"),window.history.replaceState(null,bc,window.location.pathname)}}catch(n){this.setState({errorMessage:n.message})}});F(this,"addFiles",on(n=>{const{addedFiles:i}=this.addMissingFiles(n);this.clearImageShapeCache(i),this.scene.triggerUpdate(),this.addNewImagesToImageCache()}));F(this,"addMissingFiles",(n,i=!1)=>{const s=i?{}:{...this.files},r={},o=Array.isArray(n)?n:Object.values(n);for(const a of o)if(!s[a.id]&&(r[a.id]=a,s[a.id]=a,a.mimeType===_e.svg))try{const l=$5e(vM(G5e(a.dataURL)),_e.svg);a.dataURL!==l&&(a.version=(a.version??1)+1,a.dataURL=l)}catch(l){console.error(l)}return this.files=s,{addedFiles:r}});F(this,"updateScene",on(n=>{const{elements:i,appState:s,collaborators:r,captureUpdate:o}=n;if(o){const a=i||void 0,l=s?lh({...this.store.snapshot.appState,...s}):void 0;this.store.scheduleMicroAction({action:o,elements:a,appState:l})}s&&this.setState({...s,stylesPanelMode:this.state.stylesPanelMode}),i&&this.scene.replaceAllElements(i),r&&this.setState({collaborators:r})}));F(this,"applyDeltas",(n,i)=>{const s=md.squash(...n),r={...this.state},o=new Map(this.scene.getElementsMapIncludingDeleted());return md.applyTo(s,o,r,i)});F(this,"mutateElement",(n,i,s=!0)=>this.scene.mutateElement(n,i,{informMutation:s,isDragging:!1}));F(this,"triggerRender",n=>{n===!0?this.scene.triggerUpdate():this.setState({})});F(this,"toggleSidebar",({name:n,tab:i,force:s})=>{var a,l;let r;s===void 0?r=((a=this.state.openSidebar)==null?void 0:a.name)===n&&((l=this.state.openSidebar)==null?void 0:l.tab)===i?null:n:r=s?n:null;const o=r?{name:r}:null;return o&&i&&(o.tab=i),this.setState({openSidebar:o}),!!r});F(this,"updateCurrentCursorPosition",on(n=>{this.lastViewportPosition.x=n.clientX,this.lastViewportPosition.y=n.clientY}));F(this,"getEditorUIOffsets",()=>{var o,a,l,c,u,d,f,h,m,p;const n=((c=(l=(a=(o=this.excalidrawContainerRef)==null?void 0:o.current)==null?void 0:a.querySelector(".App-toolbar"))==null?void 0:l.getBoundingClientRect())==null?void 0:c.bottom)??0,i=(f=(d=(u=this.excalidrawContainerRef)==null?void 0:u.current)==null?void 0:d.querySelector(".sidebar"))==null?void 0:f.getBoundingClientRect(),s=(p=(m=(h=this.excalidrawContainerRef)==null?void 0:h.current)==null?void 0:m.querySelector(".App-menu__left"))==null?void 0:p.getBoundingClientRect(),r=16;return gm().rtl?{top:n+r,right:Math.max(this.state.width-((s==null?void 0:s.left)??this.state.width),0)+r,bottom:r,left:Math.max((i==null?void 0:i.right)??0,0)+r}:{top:n+r,right:Math.max(this.state.width-((i==null?void 0:i.left)??this.state.width)+r,0),bottom:r,left:Math.max((s==null?void 0:s.right)??0,0)+r}});F(this,"onKeyDown",on(n=>{var o,a,l,c,u,d;if("Proxy"in window&&(!n.shiftKey&&/^[A-Z]$/.test(n.key)||n.shiftKey&&/^[a-z]$/.test(n.key))&&(n=new Proxy(n,{get(f,h){const m=f[h];return typeof m=="function"?m.bind(f):h==="key"?n.shiftKey?f.key.toUpperCase():f.key.toLowerCase():m}})),!m4(n.target)){if((n.key===H.ESCAPE||n.key===H.ENTER)&&this.state.croppingElementId){this.finishImageCropping();return}const f=Ve(this.scene.getNonDeletedElementsMap(),this.state);if(f.length===1&&yt(f[0])&&n.key===H.ENTER){this.startImageCropping(f[0]);return}if(n.key===H.ESCAPE)this.updateEditorAtom(Ia,null);else if(n.key===H.TAB&&(document.activeElement===((o=this.excalidrawContainerRef)==null?void 0:o.current)||(a=document.activeElement)!=null&&a.classList.contains(Zs.CONVERT_ELEMENT_TYPE_POPUP))){n.preventDefault();const m=By(f);((l=Hs.get(Ia))==null?void 0:l.type)==="panel"&&TX(this,{conversionType:m,direction:n.shiftKey?"left":"right"})&&this.store.scheduleCapture(),m&&this.updateEditorAtom(Ia,{type:"panel"})}if(n.key===H.ESCAPE&&this.flowChartCreator.isCreatingChart){this.flowChartCreator.clear(),this.triggerRender(!0);return}const h=L1(n.key);if(n[H.CTRL_OR_CMD]&&h&&!n.shiftKey){n.preventDefault();const m=Ve(this.scene.getNonDeletedElementsMap(),this.state);m.length===1&&K5(m[0])&&this.flowChartCreator.createNodes(m[0],this.state,EM(n.key),this.scene),(c=this.flowChartCreator.pendingNodes)!=null&&c.length&&!N2(this.flowChartCreator.pendingNodes,this.canvas.width/window.devicePixelRatio,this.canvas.height/window.devicePixelRatio,{offsetLeft:this.state.offsetLeft,offsetTop:this.state.offsetTop,scrollX:this.state.scrollX,scrollY:this.state.scrollY,zoom:this.state.zoom},this.scene.getNonDeletedElementsMap(),this.getEditorUIOffsets())&&this.scrollToContent(this.flowChartCreator.pendingNodes,{animate:!0,duration:300,fitToContent:!0,canvasOffsets:this.getEditorUIOffsets()});return}if(n.altKey){const m=Ve(this.scene.getNonDeletedElementsMap(),this.state);if(m.length===1&&h){n.preventDefault();const p=this.flowChartNavigator.exploreByDirection(m[0],this.scene.getNonDeletedElementsMap(),EM(n.key));if(p){this.setState(b=>({selectedElementIds:St({[p]:!0},b)}));const U=this.scene.getNonDeletedElementsMap().get(p);U&&!N2([U],this.canvas.width/window.devicePixelRatio,this.canvas.height/window.devicePixelRatio,{offsetLeft:this.state.offsetLeft,offsetTop:this.state.offsetTop,scrollX:this.state.scrollX,scrollY:this.state.scrollY,zoom:this.state.zoom},this.scene.getNonDeletedElementsMap(),this.getEditorUIOffsets())&&this.scrollToContent(U,{animate:!0,duration:300,canvasOffsets:this.getEditorUIOffsets()})}return}}}if(n[H.CTRL_OR_CMD]&&n.key===H.P&&!n.shiftKey&&!n.altKey){this.setToast({message:M("commandPalette.shortcutHint",{shortcut:Ki("commandPalette")})}),n.preventDefault();return}if(n[H.CTRL_OR_CMD]&&n.key.toLowerCase()===H.V&&(z3=n.shiftKey,clearTimeout(jD),jD=window.setTimeout(()=>{z3=!1},100)),n[H.CTRL_OR_CMD]&&ka(n.target)&&(n.code===tt.MINUS||n.code===tt.EQUAL)){n.preventDefault();return}if(ka(n.target)&&n.key!==H.ESCAPE||L1(n.key)&&m4(n.target))return;if(n.key===H.QUESTION_MARK){this.setState({openDialog:{name:"help"}});return}else if(n.key.toLowerCase()===H.E&&n.shiftKey&&n[H.CTRL_OR_CMD]){n.preventDefault(),this.setState({openDialog:{name:"imageExport"}});return}if(n.key===H.PAGE_UP||n.key===H.PAGE_DOWN){let f=(n.shiftKey?this.state.width:this.state.height)/this.state.zoom.value;n.key===H.PAGE_DOWN&&(f=-f),n.shiftKey?this.translateCanvas(h=>({scrollX:h.scrollX+f})):this.translateCanvas(h=>({scrollY:h.scrollY+f}))}if(((u=this.state.openDialog)==null?void 0:u.name)==="elementLinkSelector"||this.actionManager.handleKeyDown(n)||this.state.viewModeEnabled)return;if(n[H.CTRL_OR_CMD]&&this.state.isBindingEnabled&&this.setState({isBindingEnabled:!1}),L1(n.key)){let f=this.scene.getSelectedElements({selectedElementIds:this.state.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0});const h=f.find(ge),m=new Set;f.filter(ge).filter(y=>{const w=y.startBinding&&!f.some(I=>{var C;return I.id===((C=y.startBinding)==null?void 0:C.elementId)}),v=y.endBinding&&!f.some(I=>{var C;return I.id===((C=y.endBinding)==null?void 0:C.elementId)});return w||v}).forEach(y=>m.add(y.id)),f=f.filter(y=>!m.has(y.id));const p=this.getEffectiveGridSize()&&(n.shiftKey?lA:this.getEffectiveGridSize())||(n.shiftKey?bse:lA);let U=0,b=0;n.key===H.ARROW_LEFT?U=-p:n.key===H.ARROW_RIGHT?U=p:n.key===H.ARROW_UP?b=-p:n.key===H.ARROW_DOWN&&(b=p),f.forEach(y=>{this.scene.mutateElement(y,{x:y.x+U,y:y.y+b},{informMutation:!1,isDragging:!1}),Is(y,this.scene,{simultaneouslyUpdated:f})}),this.setState({suggestedBindings:R8(f.filter(y=>y.id!==(h==null?void 0:h.id)||p!==0),this.scene.getNonDeletedElementsMap(),this.state.zoom)}),this.scene.triggerUpdate(),n.preventDefault()}else if(n.key===H.ENTER){const f=this.scene.getSelectedElements(this.state);if(f.length===1){const h=f[0];if(n[H.CTRL_OR_CMD]||tn(h))Se(h)&&(!((d=this.state.selectedLinearElement)!=null&&d.isEditing)||this.state.selectedLinearElement.elementId!==h.id)&&(this.store.scheduleCapture(),ge(h)||this.actionManager.executeAction(e2));else if(de(h)||Nae(h)){let m;de(h)||(m=h);const p=M8(h,this.state,this.scene.getNonDeletedElementsMap()),U=p.x,b=p.y;this.startTextEditing({sceneX:U,sceneY:b,container:m}),n.preventDefault();return}else Ee(h)&&this.setState({editingFrame:h.id})}}else if(!n.ctrlKey&&!n.altKey&&!n.metaKey&&!this.state.newElement&&!this.state.selectionElement&&!this.state.selectedElementsAreBeingDragged){const f=y8e(n.key,this);f?(this.state.activeTool.type!==f&&Qe("toolbar",f,`keyboard (${this.device.editor.isMobile?"mobile":"desktop"})`),f==="arrow"&&this.state.activeTool.type==="arrow"&&this.setState(h=>({currentItemArrowType:h.currentItemArrowType===ui.sharp?ui.round:h.currentItemArrowType===ui.round?ui.elbow:ui.sharp})),this.setActiveTool({type:f}),n.stopPropagation()):n.key===H.Q&&(this.toggleLock("keyboard"),n.stopPropagation())}if(n.key===H.SPACE&&pt.pointers.size===0&&(pu=!0,Rt(this.interactiveCanvas,xt.GRAB),n.preventDefault()),(n.key===H.G||n.key===H.S)&&!n.altKey&&!n[H.CTRL_OR_CMD]){const f=this.scene.getSelectedElements(this.state);if(this.state.activeTool.type==="selection"&&!f.length)return;n.key===H.G&&(Bc(this.state.activeTool.type)||f.some(h=>Bc(h.type)))&&(this.setState({openPopup:"elementBackground"}),n.stopPropagation()),n.key===H.S&&(this.setState({openPopup:"elementStroke"}),n.stopPropagation())}if(!n[H.CTRL_OR_CMD]&&n.shiftKey&&n.key.toLowerCase()===H.F){const f=this.scene.getSelectedElements(this.state);if(this.state.activeTool.type==="selection"&&!f.length)return;(this.state.activeTool.type==="text"||f.find(h=>de(h)||Re(h,this.scene.getNonDeletedElementsMap())))&&(n.preventDefault(),this.setState({openPopup:"fontFamily"}))}if(n.key===H.K&&!n.altKey&&!n[H.CTRL_OR_CMD]){this.state.activeTool.type==="laser"?this.setActiveTool({type:this.state.preferredSelectionTool.type}):this.setActiveTool({type:"laser"});return}n[H.CTRL_OR_CMD]&&(n.key===H.BACKSPACE||n.key===H.DELETE)&&this.updateEditorAtom(Xy,"clearCanvas");const i=n.key.toLocaleLowerCase(),s=i===H.S&&n.shiftKey,r=n.key===H.I||i===H.G&&n.shiftKey;(s||r)&&this.openEyeDropper({type:s?"stroke":"background"})}));F(this,"onKeyUp",on(n=>{var i,s,r,o;if(n.key===H.SPACE&&(this.state.viewModeEnabled||((i=this.state.openDialog)==null?void 0:i.name)==="elementLinkSelector"?Rt(this.interactiveCanvas,xt.GRAB):this.state.activeTool.type==="selection"||this.state.activeTool.type==="lasso"?wo(this.interactiveCanvas):(_o(this.interactiveCanvas,this.state),this.setState({selectedElementIds:St({},this.state),selectedGroupIds:{},editingGroupId:null,activeEmbeddable:null})),pu=!1),!n[H.CTRL_OR_CMD]&&!this.state.isBindingEnabled&&this.setState({isBindingEnabled:!0}),L1(n.key)&&(c6(this.scene.getSelectedElements(this.state).filter(Se),qu(this.state),((s=this.state.selectedLinearElement)==null?void 0:s.selectedPointsIndices)??[],this.scene,this.state.zoom),this.setState({suggestedBindings:[]})),n.altKey||this.flowChartNavigator.isExploring&&(this.flowChartNavigator.clear(),this.syncActionResult({captureUpdate:K.IMMEDIATELY})),!n[H.CTRL_OR_CMD]&&this.flowChartCreator.isCreatingChart){(r=this.flowChartCreator.pendingNodes)!=null&&r.length&&this.scene.insertElements(this.flowChartCreator.pendingNodes);const a=(o=this.flowChartCreator.pendingNodes)==null?void 0:o[0];a&&(this.setState(l=>({selectedElementIds:St({[a.id]:!0},l)})),N2([a],this.canvas.width/window.devicePixelRatio,this.canvas.height/window.devicePixelRatio,{offsetLeft:this.state.offsetLeft,offsetTop:this.state.offsetTop,scrollX:this.state.scrollX,scrollY:this.state.scrollY,zoom:this.state.zoom},this.scene.getNonDeletedElementsMap(),this.getEditorUIOffsets())||this.scrollToContent(a,{animate:!0,duration:300,canvasOffsets:this.getEditorUIOffsets()})),this.flowChartCreator.clear(),this.syncActionResult({captureUpdate:K.IMMEDIATELY})}}));F(this,"isToolSupported",n=>{var i;return((i=this.props.UIOptions.tools)==null?void 0:i[n])!==!1});F(this,"setActiveTool",(n,i=!1)=>{if(!this.isToolSupported(n.type)){console.warn(`"${n.type}" tool is disabled via "UIOptions.canvasActions.tools.${n.type}"`);return}const s=en(this.state,n);s.type==="hand"?Rt(this.interactiveCanvas,xt.GRAB):pu||_o(this.interactiveCanvas,{...this.state,activeTool:s}),pre(document.activeElement)&&this.focusContainer(),W9(s.type)||this.setState({suggestedBindings:[]}),s.type==="image"&&this.onImageToolbarButtonClick(),this.setState(r=>{const o={snapLines:r.snapLines.length?[]:r.snapLines,originSnapOffset:null,activeEmbeddable:null};return s.type==="freedraw"&&this.store.scheduleCapture(),s.type==="lasso"?{...r,activeTool:s,...i?{}:{selectedElementIds:St({},r),selectedGroupIds:St({},r),editingGroupId:null,multiElement:null},...o}:s.type!=="selection"?{...r,activeTool:s,selectedElementIds:St({},r),selectedGroupIds:St({},r),editingGroupId:null,multiElement:null,...o}:{...r,activeTool:s,...o}})});F(this,"setOpenDialog",n=>{this.setState({openDialog:n})});F(this,"setCursor",n=>{Rt(this.interactiveCanvas,n)});F(this,"resetCursor",()=>{wo(this.interactiveCanvas)});F(this,"isTouchScreenMultiTouchGesture",()=>pt.pointers.size>=2);F(this,"getName",()=>this.state.name||this.props.name||`${M("labels.untitled")}-${yA()}`);F(this,"onGestureStart",on(n=>{n.preventDefault(),this.isTouchScreenMultiTouchGesture()&&this.setState({selectedElementIds:St({},this.state),activeEmbeddable:null}),pt.initialScale=this.state.zoom.value}));F(this,"onGestureChange",on(n=>{if(n.preventDefault(),this.isTouchScreenMultiTouchGesture())return;const i=pt.initialScale;i&&this.setState(s=>({...Nu({viewportX:this.lastViewportPosition.x,viewportY:this.lastViewportPosition.y,nextZoom:Ha(i*n.scale)},s)}))}));F(this,"onGestureEnd",on(n=>{n.preventDefault(),this.isTouchScreenMultiTouchGesture()&&this.setState({previousSelectedElementIds:{},selectedElementIds:St(this.state.previousSelectedElementIds,this.state)}),pt.initialScale=null}));F(this,"startTextEditing",({sceneX:n,sceneY:i,insertAtParentCenter:s=!0,container:r,autoEdit:o=!0})=>{let a=!1,l=s&&this.getTextWysiwygSnappedToCenterPosition(n,i,this.state,r);r&&l&&(Re(r,this.scene.getNonDeletedElementsMap())||(a=!0));let c=null;const u=this.scene.getSelectedElements(this.state);u.length===1?de(u[0])?c=u[0]:r?c=Re(u[0],this.scene.getNonDeletedElementsMap()):c=this.getTextElementAtPosition(n,i):c=this.getTextElementAtPosition(n,i);const d=(c==null?void 0:c.fontFamily)||this.state.currentItemFontFamily,f=(c==null?void 0:c.lineHeight)||Oc(d),h=this.state.currentItemFontSize;if(!c&&a&&r&&!xe(r)){const b=ez(gt({fontSize:h,fontFamily:d}),f),y=tz(h,f),w=Math.max(r.height,y),v=Math.max(r.width,b);this.scene.mutateElement(r,{height:w,width:v}),n=r.x+v/2,i=r.y+w/2,l&&(l=this.getTextWysiwygSnappedToCenterPosition(n,i,this.state,r))}const m=this.getTopLayerFrameAtSceneCoords({x:n,y:i}),p=c||nr({x:l?l.elementCenterX:n,y:l?l.elementCenterY:i,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,opacity:this.state.currentItemOpacity,text:"",fontSize:h,fontFamily:d,textAlign:l?"center":this.state.currentItemTextAlign,verticalAlign:l?Gs.MIDDLE:zb,containerId:a?r==null?void 0:r.id:void 0,groupIds:(r==null?void 0:r.groupIds)??[],lineHeight:f,angle:r?xe(r)?0:r.angle:0,frameId:m?m.id:null});if(!c&&a&&r&&this.scene.mutateElement(r,{boundElements:(r.boundElements||[]).concat({type:"text",id:p.id})}),this.setState({editingTextElement:p}),!c)if(r&&a){const U=this.scene.getElementIndex(r.id);this.scene.insertElementAtIndex(p,U+1)}else this.scene.insertElement(p);o||c||r?this.handleTextWysiwyg(p,{isExistingElement:!!c}):this.setState({newElement:p,multiElement:null})});F(this,"startImageCropping",n=>{this.store.scheduleCapture(),this.setState({croppingElementId:n.id})});F(this,"finishImageCropping",()=>{this.state.croppingElementId&&(this.store.scheduleCapture(),this.setState({croppingElementId:null}))});F(this,"handleCanvasDoubleClick",n=>{var a,l,c;if(this.state.multiElement||this.state.activeTool.type!==this.state.preferredSelectionTool.type)return;const i=this.scene.getSelectedElements(this.state);let{x:s,y:r}=Dt(n,this.state);if(i.length===1&&Se(i[0])){const u=i[0];if((n[H.CTRL_OR_CMD]&&uae(u)||tn(u))&&(!((a=this.state.selectedLinearElement)!=null&&a.isEditing)||this.state.selectedLinearElement.elementId!==u.id)){this.actionManager.executeAction(e2);return}else if(this.state.selectedLinearElement&&ge(i[0])){const d=pe.getSegmentMidpointHitCoords(this.state.selectedLinearElement,{x:s,y:r},this.state,this.scene.getNonDeletedElementsMap()),f=d?pe.getSegmentMidPointIndex(this.state.selectedLinearElement,this.state,d,this.scene.getNonDeletedElementsMap()):-1;if(f&&f>-1){this.store.scheduleCapture(),pe.deleteFixedSegment(i[0],this.scene,f);const h=pe.getSegmentMidpointHitCoords({...this.state.selectedLinearElement,segmentMidPointHoveredCoords:null},{x:s,y:r},this.state,this.scene.getNonDeletedElementsMap()),m=h?pe.getSegmentMidPointIndex(this.state.selectedLinearElement,this.state,h,this.scene.getNonDeletedElementsMap()):null;this.setState({selectedLinearElement:{...this.state.selectedLinearElement,pointerDownState:{...this.state.selectedLinearElement.pointerDownState,segmentMidpoint:{index:m,value:d,added:!1}},segmentMidPointHoveredCoords:h}});return}}else if((l=this.state.selectedLinearElement)!=null&&l.isEditing&&this.state.selectedLinearElement.elementId===u.id&&tn(u))return}if(i.length===1&&yt(i[0])){this.startImageCropping(i[0]);return}if(wo(this.interactiveCanvas),yc(this.state).length>0){const u=this.getElementAtPosition(s,r),d=u&&Ez(u,this.state.selectedGroupIds);if(d){this.store.scheduleCapture(),this.setState(f=>({...f,...Ii({editingGroupId:d,selectedElementIds:{[u.id]:!0}},this.scene.getNonDeletedElements(),f,this)}));return}}if(wo(this.interactiveCanvas),!n[H.CTRL_OR_CMD]&&!this.state.viewModeEnabled){const u=this.getElementAtPosition(s,r);if(pr(u)){this.setState({activeEmbeddable:{element:u,state:"active"}});return}if(!((c=this.state.selectedLinearElement)!=null&&c.isEditing)){const d=this.getTextBindableContainerAtPosition(s,r);if(d&&(Di(d)||!ws(d.backgroundColor)||Ef({point:x(s,r),element:d,elementsMap:this.scene.getNonDeletedElementsMap(),threshold:this.getElementHitThreshold(d)}))){const f=M8(d,this.state,this.scene.getNonDeletedElementsMap());s=f.x,r=f.y}this.startTextEditing({sceneX:s,sceneY:r,insertAtParentCenter:!n.altKey,container:d})}}});F(this,"getElementLinkAtPosition",(n,i)=>{if(i&&i.locked)return;const s=this.scene.getNonDeletedElements();let r=-1;for(let o=s.length-1;o>=0;o--){const a=s[o];if(i&&a.id===i.id&&(r=o),a.link&&o>=r&&p3(a,this.scene.getNonDeletedElementsMap(),this.state,x(n.x,n.y),this.device.editor.isMobile))return a}});F(this,"redirectToLink",(n,i)=>{const s=at(x(this.lastPointerDownEvent.clientX,this.lastPointerDownEvent.clientY),x(this.lastPointerUpEvent.clientX,this.lastPointerUpEvent.clientY));if(!this.hitLinkElement||s>JF)return;const r=Dt(this.lastPointerDownEvent,this.state),o=this.scene.getNonDeletedElementsMap(),a=p3(this.hitLinkElement,o,this.state,x(r.x,r.y),this.device.editor.isMobile),l=Dt(this.lastPointerUpEvent,this.state),c=p3(this.hitLinkElement,o,this.state,x(l.x,l.y),this.device.editor.isMobile);if(a&&c){VR();let u=this.hitLinkElement.link;if(u){u=Qs(u);let d;if(this.props.onLinkOpen&&(d=AB(te.EXCALIDRAW_LINK,n.nativeEvent),this.props.onLinkOpen({...this.hitLinkElement,link:u},d)),!(d!=null&&d.defaultPrevented)){const f=NB(u)?"_self":"_blank",h=window.open(void 0,f);h&&(h.opener=null,h.location=u)}}}});F(this,"getTopLayerFrameAtSceneCoords",n=>{const i=this.scene.getNonDeletedElementsMap(),s=this.scene.getNonDeletedFramesLikes().filter(r=>!r.locked&&KA(n,r,i));return s.length?s[s.length-1]:null});F(this,"handleCanvasPointerMove",n=>{var m,p,U,b,y,w,v,I;this.savePointer(n.clientX,n.clientY,this.state.cursorButton),this.lastPointerMoveEvent=n.nativeEvent,pt.pointers.has(n.pointerId)&&pt.pointers.set(n.pointerId,{x:n.clientX,y:n.clientY});const i=pt.initialScale;if(pt.pointers.size===2&&pt.lastCenter&&i&&pt.initialDistance){const C=rD(pt.pointers),_=C.x-pt.lastCenter.x,T=C.y-pt.lastCenter.y;pt.lastCenter=C;const k=oD(Array.from(pt.pointers.values())),S=this.state.activeTool.type==="freedraw"&&this.state.penMode?1:k/pt.initialDistance,R=S?Ha(i*S):this.state.zoom.value;this.setState(P=>{const L=Nu({viewportX:C.x,viewportY:C.y,nextZoom:R},P);this.translateCanvas({zoom:L.zoom,scrollX:L.scrollX+2*(_/R),scrollY:L.scrollY+2*(T/R),shouldCacheIgnoreZoom:!0})}),this.resetShouldCacheIgnoreZoomDebounced()}else pt.lastCenter=pt.initialDistance=pt.initialScale=null;if(pu||E1||F3||Yh(this.state))return;const r=mD(v1,n.clientX-this.state.offsetLeft,n.clientY-this.state.offsetTop).isOverEither;!this.state.newElement&&!this.state.selectionElement&&!this.state.selectedElementsAreBeingDragged&&!this.state.multiElement&&(r?wo(this.interactiveCanvas):_o(this.interactiveCanvas,this.state));const o=Dt(n,this.state),{x:a,y:l}=o;if(!this.state.newElement&&x3e(this.state.activeTool.type)){const{originOffset:C,snapLines:_}=S3e(this.scene.getNonDeletedElements(),this,{x:a,y:l},n,this.scene.getNonDeletedElementsMap());this.setState(T=>{const k=r1(T.snapLines,_),S=T.originSnapOffset?r1(T.originSnapOffset,C):C;return T.snapLines===k&&T.originSnapOffset===S?null:{snapLines:k,originSnapOffset:S}})}else!this.state.newElement&&!this.state.selectedElementsAreBeingDragged&&!this.state.selectionElement&&this.setState(C=>C.snapLines.length?{snapLines:[]}:null);if((m=this.state.selectedLinearElement)!=null&&m.isEditing&&!this.state.selectedLinearElement.isDragging){const C=pe.handlePointerMove(n,a,l,this),_=C?this.scene.getElement(C.elementId):null;C&&C!==this.state.selectedLinearElement&&hi.flushSync(()=>{this.setState({selectedLinearElement:C})}),(C==null?void 0:C.lastUncommittedPoint)!=null&&_&&_4(_.type)?this.maybeSuggestBindingAtCursor(o,C.elbowed):this.state.suggestedBindings.length&&this.setState({suggestedBindings:[]})}if(_4(this.state.activeTool.type)){const{newElement:C}=this.state;za(C,!1)?this.setState({suggestedBindings:I4(C,[o],this.scene,this.state.zoom,this.state.startBoundElement)}):this.maybeSuggestBindingAtCursor(o,!1)}if(this.state.multiElement){const{multiElement:C}=this.state,{x:_,y:T}=C,{points:k,lastCommittedPoint:S}=C,R=k[k.length-1];if(_o(this.interactiveCanvas,this.state),R===S)at(x(a-_,l-T),R)>=S2?this.scene.mutateElement(C,{points:[...k,x(a-_,l-T)]},{informMutation:!1,isDragging:!1}):Rt(this.interactiveCanvas,xt.POINTER);else if(k.length>2&&S&&at(x(a-_,l-T),S)<S2)Rt(this.interactiveCanvas,xt.POINTER),this.scene.mutateElement(C,{points:k.slice(0,-1)},{informMutation:!1,isDragging:!1});else{const[P,L]=On(a,l,n[H.CTRL_OR_CMD]||ge(C)?null:this.getEffectiveGridSize()),[X,G]=(C==null?void 0:C.lastCommittedPoint)??[0,0];let z=P-_-X,V=L-T-G;g0(n)&&({width:z,height:V}=k4(X+_,G+T,P,L)),qo(k,this.state.zoom.value)&&Rt(this.interactiveCanvas,xt.POINTER),this.scene.mutateElement(C,{points:[...k.slice(0,-1),x(X+z,G+V)]},{isDragging:!0,informMutation:!1}),this.triggerRender(!1)}return}if(!!n.buttons||this.state.activeTool.type!=="selection"&&this.state.activeTool.type!=="lasso"&&this.state.activeTool.type!=="text"&&this.state.activeTool.type!=="eraser")return;const u=this.scene.getNonDeletedElements(),d=this.scene.getSelectedElements(this.state);if(d.length===1&&!r&&!((p=this.state.selectedLinearElement)!=null&&p.isEditing)){if(this.state.selectedLinearElement&&this.handleHoverSelectedLinearElement(this.state.selectedLinearElement,a,l),(!this.state.selectedLinearElement||this.state.selectedLinearElement.hoverPointIndex===-1)&&((U=this.state.openDialog)==null?void 0:U.name)!=="elementLinkSelector"&&!(d.length===1&&ge(d[0]))&&!(Se(d[0])&&(vo()||d[0].points.length===2))){const C=IM(u,this.state,a,l,this.state.zoom,n.pointerType,this.scene.getNonDeletedElementsMap(),this.device);if(C&&C.transformHandleType){Rt(this.interactiveCanvas,xM(C));return}}}else if(d.length>1&&!r&&((b=this.state.openDialog)==null?void 0:b.name)!=="elementLinkSelector"){const C=SM(ft(d),a,l,this.state.zoom,n.pointerType,this.device);if(C){Rt(this.interactiveCanvas,xM({transformHandleType:C}));return}}const f=this.getElementAtPosition(a,l,{preferSelected:!0,includeLockedElements:!0});let h=null;f&&f.locked?h=null:h=f,this.hitLinkElement=this.getElementLinkAtPosition(o,f),!Ao(this.state)&&(this.hitLinkElement&&!this.state.selectedElementIds[this.hitLinkElement.id]?(Rt(this.interactiveCanvas,xt.POINTER),$ye(this.hitLinkElement,this.state,this.scene.getNonDeletedElementsMap())):(VR(),h&&(h.link||rs(h))&&this.state.selectedElementIds[h.id]&&!this.state.contextMenu&&!this.state.showHyperlinkPopup?this.setState({showHyperlinkPopup:"info"}):this.state.activeTool.type==="text"?Rt(this.interactiveCanvas,de(h)?xt.TEXT:xt.CROSSHAIR):this.state.viewModeEnabled?Rt(this.interactiveCanvas,xt.GRAB):((y=this.state.openDialog)==null?void 0:y.name)==="elementLinkSelector"?Rt(this.interactiveCanvas,xt.AUTO):r?Rt(this.interactiveCanvas,xt.AUTO):n[H.CTRL_OR_CMD]?Rt(this.interactiveCanvas,xt.AUTO):(h||this.isHittingCommonBoundingBoxOfSelectedElements(o,d))&&!(h!=null&&h.locked)&&(h&&pr(h)&&this.isIframeLikeElementCenter(h,n,a,l)?(Rt(this.interactiveCanvas,xt.POINTER),this.setState({activeEmbeddable:{element:h,state:"hover"}})):(!h||!ge(h)||!(h.startBinding||h.endBinding))&&((this.state.activeTool.type!=="lasso"||d.length>0)&&Rt(this.interactiveCanvas,xt.MOVE),((w=this.state.activeEmbeddable)==null?void 0:w.state)==="hover"&&this.setState({activeEmbeddable:null}))),this.state.selectedLinearElement&&this.handleHoverSelectedLinearElement(this.state.selectedLinearElement,a,l)),((v=this.state.openDialog)==null?void 0:v.name)==="elementLinkSelector"&&h?this.setState(C=>({hoveredElementIds:r1(C.hoveredElementIds,Ii({editingGroupId:C.editingGroupId,selectedElementIds:{[h.id]:!0}},this.scene.getNonDeletedElements(),C,this).selectedElementIds)})):((I=this.state.openDialog)==null?void 0:I.name)==="elementLinkSelector"&&!h&&this.setState(C=>({hoveredElementIds:r1(C.hoveredElementIds,{})})))});F(this,"handleEraser",(n,i)=>{const s=this.eraserTrail.addPointToPath(i.x,i.y,n.altKey);this.elementsPendingErasure=new Set(s),this.triggerRender()});F(this,"handleTouchMove",n=>{w1=!0});F(this,"handleCanvasPointerDown",n=>{var d,f,h;const i=n.target;if(i.setPointerCapture&&i.setPointerCapture(n.pointerId),this.maybeCleanupAfterMissingPointerUp(n.nativeEvent),this.maybeUnfollowRemoteUser(),this.state.searchMatches&&(this.setState(m=>({searchMatches:m.searchMatches&&{focusedId:null,matches:m.searchMatches.matches.map(p=>({...p,focus:!1}))}})),this.updateEditorAtom(oY,null)),Hs.get(Ia)&&this.updateEditorAtom(Ia,null),this.state.contextMenu&&this.setState({contextMenu:null}),this.state.snapLines&&this.setAppState({snapLines:[]}),this.state.openPopup&&this.setState({openPopup:null}),this.updateGestureOnPointerDown(n),n.pointerType==="touch"&&this.state.newElement&&this.state.newElement.type==="freedraw"){const m=this.state.newElement;this.updateScene({...m.points.length<10?{elements:this.scene.getElementsIncludingDeleted().filter(p=>p.id!==m.id)}:{},appState:{newElement:null,editingTextElement:null,startBoundElement:null,suggestedBindings:[],selectedElementIds:St(Object.keys(this.state.selectedElementIds).filter(p=>p!==m.id).reduce((p,U)=>(p[U]=this.state.selectedElementIds[U],p),{}),this.state)},captureUpdate:((d=this.state.openDialog)==null?void 0:d.name)==="elementLinkSelector"?K.EVENTUALLY:K.NEVER});return}const s=document.getSelection();if(s!=null&&s.anchorNode&&s.removeAllRanges(),this.maybeOpenContextMenuAfterPointerDownOnTouchDevices(n),!this.state.penDetected&&n.pointerType==="pen"&&this.setState(m=>({penMode:!0,penDetected:!0})),!this.device.isTouchScreen&&["pen","touch"].includes(n.pointerType)&&(this.device=C2(this.device,{isTouchScreen:!0})),E1||(this.lastPointerDownEvent=n,this.handleCanvasPanUsingWheelOrSpaceDrag(n)))return;if(this.setState({lastPointerDownWith:n.pointerType,cursorButton:"down"}),this.savePointer(n.clientX,n.clientY,"down"),n.button===Fl.ERASER&&this.state.activeTool.type!==qn.eraser){this.setState({activeTool:en(this.state,{type:qn.eraser,lastActiveToolBeforeEraser:this.state.activeTool})},()=>{this.handleCanvasPointerDown(n);const m=()=>{p(),U==null||U(),Ao(this.state)&&this.setState({activeTool:en(this.state,{...this.state.activeTool.lastActiveTool||{type:qn.selection},lastActiveToolBeforeEraser:null})})},p=Jt(window,te.POINTER_UP,m,{once:!0});let U;requestAnimationFrame(()=>{U=this.missingPointerEventCleanupEmitter.once(m)})});return}if(n.button!==Fl.MAIN&&n.button!==Fl.TOUCH&&n.button!==Fl.ERASER||pt.pointers.size>1)return;const r=this.initialPointerDownState(n);if(this.setState({selectedElementsAreBeingDragged:!1}),this.handleDraggingScrollBar(n,r)||(this.clearSelectionIfNotUsingSelection(),this.updateBindingEnabledOnPointerMove(n),this.handleSelectionOnPointerDown(n,r))||!(!this.state.penMode||n.pointerType!=="touch"||this.state.activeTool.type==="selection"||this.state.activeTool.type==="lasso"||this.state.activeTool.type==="text"||this.state.activeTool.type==="image"))return;if(this.state.activeTool.type==="lasso"){const m=r.hit.element&&this.isASelectedElement(r.hit.element);!r.hit.hasHitCommonBoundingBoxOfSelectedElements&&!r.resize.handleType&&!m&&(this.lassoTrail.startPath(r.origin.x,r.origin.y,n.shiftKey),r.drag.blockDragging=!vo()),vo()&&r.hit.element&&!m&&(this.setState(p=>{const U={...p.selectedElementIds,[r.hit.element.id]:!0},b=[];Object.keys(p.selectedElementIds).forEach(w=>{const v=this.scene.getElement(w);v&&b.push(v)});const y=r.hit.element;if(Ee(y))Js(b,y.id).forEach(w=>{delete U[w.id]});else if(y.frameId)U[y.frameId]&&delete U[y.id];else{const w=y.groupIds,v=new Set(w.flatMap(I=>Ct(this.scene.getNonDeletedElements(),I)).filter(I=>Ee(I)).map(I=>I.id));v.size>0&&b.forEach(I=>{I.frameId&&v.has(I.frameId)&&(delete U[I.id],I.groupIds.flatMap(C=>Ct(this.scene.getNonDeletedElements(),C)).forEach(C=>{delete U[C.id]}))})}return{...Ii({editingGroupId:p.editingGroupId,selectedElementIds:U},this.scene.getNonDeletedElements(),p,this),showHyperlinkPopup:y.link||rs(y)?"info":!1}}),r.hit.wasAddedToSelection=!0)}else this.state.activeTool.type==="text"?this.handleTextOnPointerDown(n,r):this.state.activeTool.type==="arrow"||this.state.activeTool.type==="line"?this.handleLinearElementOnPointerDown(n,this.state.activeTool.type,r):this.state.activeTool.type==="freedraw"?this.handleFreeDrawElementOnPointerDown(n,this.state.activeTool.type,r):this.state.activeTool.type==="custom"?_o(this.interactiveCanvas,this.state):this.state.activeTool.type===qn.frame||this.state.activeTool.type===qn.magicframe?this.createFrameElementOnPointerDown(r,this.state.activeTool.type):this.state.activeTool.type==="laser"?this.laserTrails.startPath(r.lastCoords.x,r.lastCoords.y):this.state.activeTool.type!=="eraser"&&this.state.activeTool.type!=="hand"&&this.state.activeTool.type!=="image"&&this.createGenericElementOnPointerDown(this.state.activeTool.type,r);(h=(f=this.props)==null?void 0:f.onPointerDown)==null||h.call(f,this.state.activeTool,r),this.onPointerDownEmitter.trigger(this.state.activeTool,r,n),this.state.activeTool.type==="eraser"&&this.eraserTrail.startPath(r.lastCoords.x,r.lastCoords.y);const a=this.onPointerMoveFromPointerDownHandler(r),l=this.onPointerUpFromPointerDownHandler(r),c=this.onKeyDownFromPointerDownHandler(r),u=this.onKeyUpFromPointerDownHandler(r);this.missingPointerEventCleanupEmitter.once(m=>l(m||n.nativeEvent)),(!this.state.viewModeEnabled||this.state.activeTool.type==="laser")&&(window.addEventListener(te.POINTER_MOVE,a),window.addEventListener(te.POINTER_UP,l),window.addEventListener(te.KEYDOWN,c),window.addEventListener(te.KEYUP,u),r.eventListeners.onMove=a,r.eventListeners.onUp=l,r.eventListeners.onKeyUp=u,r.eventListeners.onKeyDown=c)});F(this,"handleCanvasPointerUp",n=>{var r;this.removePointer(n),this.lastPointerUpEvent=n;const i=Dt({clientX:n.clientX,clientY:n.clientY},this.state),s=n.timeStamp-(((r=this.lastPointerDownEvent)==null?void 0:r.timeStamp)??0);if(this.device.editor.isMobile&&s<300){const o=this.getElementAtPosition(i.x,i.y);if(pr(o)&&this.isIframeLikeElementCenter(o,n,i.x,i.y)){this.handleEmbeddableCenterClick(o);return}}if(this.device.isTouchScreen){const o=this.getElementAtPosition(i.x,i.y,{includeLockedElements:!0});this.hitLinkElement=this.getElementLinkAtPosition(i,o)}this.hitLinkElement&&!this.state.selectedElementIds[this.hitLinkElement.id]?s<300&&pr(this.hitLinkElement)&&!YG(this.hitLinkElement,this.scene.getNonDeletedElementsMap(),this.state,x(i.x,i.y))?this.handleEmbeddableCenterClick(this.hitLinkElement):this.redirectToLink(n,this.device.isTouchScreen):this.state.viewModeEnabled&&this.setState({activeEmbeddable:null,selectedElementIds:{}})});F(this,"maybeOpenContextMenuAfterPointerDownOnTouchDevices",n=>{n.pointerType==="touch"&&(w1=!1,Ol?w1=!0:Ol=window.setTimeout(()=>{Ol=0,w1||this.handleCanvasContextMenu(n)},Mse))});F(this,"resetContextMenuTimer",()=>{clearTimeout(Ol),Ol=0,w1=!1});F(this,"maybeCleanupAfterMissingPointerUp",n=>{Uu==null||Uu(),this.missingPointerEventCleanupEmitter.trigger(n).clear()});F(this,"handleCanvasPanUsingWheelOrSpaceDrag",n=>{if(!(pt.pointers.size<=1&&(n.button===Fl.WHEEL||n.button===Fl.MAIN&&pu||Yh(this.state)||this.state.viewModeEnabled)))return!1;E1=!0,this.focusContainer(),this.state.editingTextElement||n.preventDefault();let i=!1;const s=typeof window===void 0?!1:/Linux/.test(window.navigator.platform);Rt(this.interactiveCanvas,xt.GRABBING);let{clientX:r,clientY:o}=n;const a=S3(c=>{const u=r-c.clientX,d=o-c.clientY;if(r=c.clientX,o=c.clientY,s&&!i&&(Math.abs(u)>1||Math.abs(d)>1)){i=!0;const f=m=>{document.body.removeEventListener(te.PASTE,f),m.stopPropagation()},h=()=>{setTimeout(()=>{document.body.removeEventListener(te.PASTE,f),window.removeEventListener(te.POINTER_UP,h)},100)};document.body.addEventListener(te.PASTE,f),window.addEventListener(te.POINTER_UP,h)}this.translateCanvas({scrollX:this.state.scrollX-u/this.state.zoom.value,scrollY:this.state.scrollY-d/this.state.zoom.value})}),l=on(Uu=()=>{Uu=null,E1=!1,pu||(this.state.viewModeEnabled?Rt(this.interactiveCanvas,xt.GRAB):_o(this.interactiveCanvas,this.state)),this.setState({cursorButton:"up"}),this.savePointer(n.clientX,n.clientY,"up"),window.removeEventListener(te.POINTER_MOVE,a),window.removeEventListener(te.POINTER_UP,l),window.removeEventListener(te.BLUR,l),a.flush()});return window.addEventListener(te.BLUR,l),window.addEventListener(te.POINTER_MOVE,a,{passive:!0}),window.addEventListener(te.POINTER_UP,l),!0});F(this,"clearSelectionIfNotUsingSelection",()=>{this.state.activeTool.type!=="selection"&&this.state.activeTool.type!=="lasso"&&this.setState({selectedElementIds:St({},this.state),selectedGroupIds:{},editingGroupId:null,activeEmbeddable:null})});F(this,"handleSelectionOnPointerDown",(n,i)=>{var s,r,o,a;if(this.state.activeTool.type==="selection"||this.state.activeTool.type==="lasso"){const l=this.scene.getNonDeletedElements(),c=this.scene.getNonDeletedElementsMap(),u=this.scene.getSelectedElements(this.state);if(u.length===1&&!((s=this.state.selectedLinearElement)!=null&&s.isEditing)&&!ge(u[0])&&!(Se(u[0])&&(vo()||u[0].points.length===2))&&!(this.state.selectedLinearElement&&this.state.selectedLinearElement.hoverPointIndex!==-1)){const d=IM(l,this.state,i.origin.x,i.origin.y,this.state.zoom,n.pointerType,this.scene.getNonDeletedElementsMap(),this.device);d!=null&&(d.transformHandleType==="rotation"?(this.setState({resizingElement:d.element}),i.resize.handleType=d.transformHandleType):(this.state.croppingElementId||this.setState({resizingElement:d.element}),i.resize.handleType=d.transformHandleType))}else u.length>1&&(i.resize.handleType=SM(ft(u),i.origin.x,i.origin.y,this.state.zoom,n.pointerType,this.device));if(i.resize.handleType)i.resize.isResizing=!0,i.resize.offset=Ya(due(i.resize.handleType,u,c,i.origin.x,i.origin.y)),u.length===1&&Se(u[0])&&u[0].points.length===2&&(i.resize.arrowDirection=fue(i.resize.handleType,u[0]));else{if(this.state.selectedLinearElement){const U=this.state.selectedLinearElement,b=pe.handlePointerDown(n,this,this.store,i.origin,U,this.scene);if(b.hitElement&&(i.hit.element=b.hitElement),b.linearElementEditor&&this.setState({selectedLinearElement:b.linearElementEditor}),b.didAddPoint)return!0}const d=this.getElementsAtPosition(i.origin.x,i.origin.y,{includeLockedElements:!0}),f=d.filter(U=>!U.locked),h=this.getElementAtPosition(i.origin.x,i.origin.y,{allHitElements:d});if((!h||h.id!==this.state.activeLockedId)&&this.setState({activeLockedId:null}),h&&h.locked&&!f.some(U=>this.state.selectedElementIds[U.id])?i.hit.element=null:i.hit.element=i.hit.element??this.getElementAtPosition(i.origin.x,i.origin.y),this.hitLinkElement=this.getElementLinkAtPosition(i.origin,h),this.hitLinkElement)return!0;if(this.state.croppingElementId&&((r=i.hit.element)==null?void 0:r.id)!==this.state.croppingElementId&&this.finishImageCropping(),i.hit.element&&this.getElementLinkAtPosition({x:i.origin.x,y:i.origin.y},i.hit.element))return!1;i.hit.allHitElements=f;const m=i.hit.element,p=i.hit.allHitElements.some(U=>this.isASelectedElement(U));if((m===null||!p)&&!n.shiftKey&&!i.hit.hasHitCommonBoundingBoxOfSelectedElements&&this.clearSelection(m),(o=this.state.selectedLinearElement)!=null&&o.isEditing)this.setState({selectedElementIds:St({[this.state.selectedLinearElement.elementId]:!0},this.state)});else if(m!=null){if(n[H.CTRL_OR_CMD])return n.altKey?(((a=this.state.openDialog)==null?void 0:a.name)==="elementLinkSelector"&&this.setOpenDialog(null),this.lassoTrail.startPath(i.origin.x,i.origin.y,n.shiftKey),this.setActiveTool({type:"lasso",fromSelection:!0}),!1):(this.state.selectedElementIds[m.id]||(i.hit.wasAddedToSelection=!0),this.setState(U=>({...Ole(U,m),previousSelectedElementIds:this.state.selectedElementIds})),!1);this.state.selectedElementIds[m.id]||(this.state.editingGroupId&&!cm(m,this.state.editingGroupId)&&this.setState({selectedElementIds:St({},this.state),selectedGroupIds:{},editingGroupId:null,activeEmbeddable:null}),!p&&!i.hit.hasHitCommonBoundingBoxOfSelectedElements&&(this.setState(U=>{var w;let b={...U.selectedElementIds,[m.id]:!0};const y=[];if(Object.keys(U.selectedElementIds).forEach(v=>{const I=this.scene.getElement(v);I&&y.push(I)}),Ee(m))Js(y,m.id).forEach(v=>{delete b[v.id]});else if(m.frameId)b[m.frameId]&&delete b[m.id];else{const v=m.groupIds,I=new Set(v.flatMap(C=>Ct(this.scene.getNonDeletedElements(),C)).filter(C=>Ee(C)).map(C=>C.id));I.size>0&&y.forEach(C=>{C.frameId&&I.has(C.frameId)&&(delete b[C.id],C.groupIds.flatMap(_=>Ct(this.scene.getNonDeletedElements(),_)).forEach(_=>{delete b[_.id]}))})}return((w=U.openDialog)==null?void 0:w.name)==="elementLinkSelector"&&(m.groupIds.some(v=>U.selectedGroupIds[v])||(b={[m.id]:!0})),{...Ii({editingGroupId:U.editingGroupId,selectedElementIds:b},this.scene.getNonDeletedElements(),U,this),showHyperlinkPopup:m.link||rs(m)?"info":!1}}),i.hit.wasAddedToSelection=!0))}this.setState({previousSelectedElementIds:this.state.selectedElementIds})}}return!1});F(this,"handleTextOnPointerDown",(n,i)=>{if(this.state.editingTextElement)return;let s=i.origin.x,r=i.origin.y;const o=this.getElementAtPosition(s,r,{includeBoundTextElement:!0});let a=this.getTextBindableContainerAtPosition(s,r);Di(o)&&(a=o,s=o.x+o.width/2,r=o.y+o.height/2),this.startTextEditing({sceneX:s,sceneY:r,insertAtParentCenter:!n.altKey,container:a,autoEdit:!1}),wo(this.interactiveCanvas),this.state.activeTool.locked||this.setState({activeTool:en(this.state,{type:this.state.preferredSelectionTool.type})})});F(this,"handleFreeDrawElementOnPointerDown",(n,i,s)=>{const[r,o]=On(s.origin.x,s.origin.y,null),a=this.getTopLayerFrameAtSceneCoords({x:r,y:o}),l=n.pressure===.5,c=Hce({type:i,x:r,y:o,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,opacity:this.state.currentItemOpacity,roundness:null,simulatePressure:l,locked:!1,frameId:a?a.id:null,points:[x(0,0)],pressures:l?[]:[n.pressure]});this.scene.insertElement(c),this.setState(d=>{const f={...d.selectedElementIds};return delete f[c.id],{selectedElementIds:St(f,d)}});const u=Za(s.origin,this.scene.getNonDeletedElements(),this.scene.getNonDeletedElementsMap(),this.state.zoom);this.setState({newElement:c,startBoundElement:u,suggestedBindings:[]})});F(this,"insertIframeElement",({sceneX:n,sceneY:i,width:s,height:r})=>{var c;const[o,a]=On(n,i,(c=this.lastPointerDownEvent)!=null&&c[H.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),l=Fce({type:"iframe",x:o,y:a,strokeColor:"transparent",backgroundColor:"transparent",fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,roundness:this.getCurrentItemRoundness("iframe"),opacity:this.state.currentItemOpacity,locked:!1,width:s,height:r});return this.scene.insertElement(l),l});F(this,"insertEmbeddableElement",({sceneX:n,sceneY:i,link:s})=>{var c;const[r,o]=On(n,i,(c=this.lastPointerDownEvent)!=null&&c[H.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),a=jf(s);if(!a)return;a.error instanceof URIError&&this.setToast({message:M("toast.unrecognizedLinkFormat"),closable:!0});const l=gM({type:"embeddable",x:r,y:o,strokeColor:"transparent",backgroundColor:"transparent",fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,roundness:this.getCurrentItemRoundness("embeddable"),opacity:this.state.currentItemOpacity,locked:!1,width:a.intrinsicSize.w,height:a.intrinsicSize.h,link:s});return this.scene.insertElement(l),l});F(this,"newImagePlaceholder",({sceneX:n,sceneY:i,addToFrameUnderCursor:s=!0})=>{var c;const[r,o]=On(n,i,(c=this.lastPointerDownEvent)!=null&&c[H.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),a=s?this.getTopLayerFrameAtSceneCoords({x:r,y:o}):null,l=100/this.state.zoom.value;return Qz({type:"image",strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,roundness:null,opacity:this.state.currentItemOpacity,locked:!1,frameId:a?a.id:null,x:r-l/2,y:o-l/2,width:l,height:l})});F(this,"handleLinearElementOnPointerDown",(n,i,s)=>{if(this.state.multiElement){const{multiElement:r}=this.state;if(r.type==="line"&&qo(r.points,this.state.zoom.value)){this.scene.mutateElement(r,{lastCommittedPoint:r.points[r.points.length-1]}),this.actionManager.executeAction(Fr);return}if(ge(r)&&r.points.length>1){this.scene.mutateElement(r,{lastCommittedPoint:r.points[r.points.length-1]}),this.actionManager.executeAction(Fr);return}const{x:o,y:a,lastCommittedPoint:l}=r;if(r.points.length>1&&l&&at(x(s.origin.x-o,s.origin.y-a),l)<S2){this.actionManager.executeAction(Fr);return}this.setState(c=>({selectedElementIds:St({...c.selectedElementIds,[r.id]:!0},c)})),this.scene.mutateElement(r,{lastCommittedPoint:r.points[r.points.length-1]}),Rt(this.interactiveCanvas,xt.POINTER)}else{const[r,o]=On(s.origin.x,s.origin.y,n[H.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),a=this.getTopLayerFrameAtSceneCoords({x:r,y:o}),{currentItemStartArrowhead:l,currentItemEndArrowhead:c}=this.state,[u,d]=i==="arrow"?[l,c]:[null,null],f=i==="arrow"?uh({type:i,x:r,y:o,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,opacity:this.state.currentItemOpacity,roundness:this.state.currentItemArrowType===ui.round?{type:yn.PROPORTIONAL_RADIUS}:null,startArrowhead:u,endArrowhead:d,locked:!1,frameId:a?a.id:null,elbowed:this.state.currentItemArrowType===ui.elbow,fixedSegments:this.state.currentItemArrowType===ui.elbow?[]:null}):Ec({type:i,x:r,y:o,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,opacity:this.state.currentItemOpacity,roundness:this.state.currentItemRoundness==="round"?{type:yn.PROPORTIONAL_RADIUS}:null,locked:!1,frameId:a?a.id:null});this.setState(m=>{const p={...m.selectedElementIds};return delete p[f.id],{selectedElementIds:St(p,m)}}),this.scene.mutateElement(f,{points:[...f.points,x(0,0)]});const h=Za(s.origin,this.scene.getNonDeletedElements(),this.scene.getNonDeletedElementsMap(),this.state.zoom,ge(f),ge(f));this.scene.insertElement(f),this.setState({newElement:f,startBoundElement:h,suggestedBindings:[]})}});F(this,"createGenericElementOnPointerDown",(n,i)=>{var c;const[s,r]=On(i.origin.x,i.origin.y,(c=this.lastPointerDownEvent)!=null&&c[H.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),o=this.getTopLayerFrameAtSceneCoords({x:s,y:r}),a={x:s,y:r,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roughness:this.state.currentItemRoughness,opacity:this.state.currentItemOpacity,roundness:this.getCurrentItemRoundness(n),locked:!1,frameId:o?o.id:null};let l;n==="embeddable"?l=gM({type:"embeddable",...a}):l=ta({type:n,...a}),l.type==="selection"?this.setState({selectionElement:l}):(this.scene.insertElement(l),this.setState({multiElement:null,newElement:l}))});F(this,"createFrameElementOnPointerDown",(n,i)=>{var l;const[s,r]=On(n.origin.x,n.origin.y,(l=this.lastPointerDownEvent)!=null&&l[H.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),o={x:s,y:r,opacity:this.state.currentItemOpacity,locked:!1,...Ft},a=i===qn.magicframe?N4(o):__(o);this.scene.insertElement(a),this.setState({multiElement:null,newElement:a})});F(this,"restoreReadyToEraseElements",()=>{this.elementsPendingErasure=new Set,this.triggerRender()});F(this,"eraseElements",()=>{let n=!1;const i=this.scene.getElementsIncludingDeleted().map(s=>this.elementsPendingErasure.has(s.id)||s.frameId&&this.elementsPendingErasure.has(s.frameId)||zt(s)&&this.elementsPendingErasure.has(s.containerId)?(n=!0,Te(s,{isDeleted:!0})):s);this.elementsPendingErasure=new Set,n&&(this.store.scheduleCapture(),this.scene.replaceAllElements(i))});F(this,"initializeImage",async(n,i)=>{var l,c,u;if(!Am(i))throw new Error(M("errors.unsupportedFileType"));const s=i.type;if(Rt(this.interactiveCanvas,"wait"),s===_e.svg)try{i=MR(vM(await i.text()),i.name)}catch(d){throw console.warn(d),new Error(M("errors.svgImageInsertError"))}const r=await(((c=(l=this.props).generateIdForFile)==null?void 0:c.call(l,i))||V5e(i));if(!r)throw console.warn("Couldn't generate file id or the supplied `generateIdForFile` didn't resolve to one."),new Error(M("errors.imageInsertError"));const o=this.files[r];if(!(o!=null&&o.dataURL)){try{i=await aX(i,{maxWidthOrHeight:Bse})}catch(d){console.error("Error trying to resizing image file on insertion",d)}if(i.size>hA)throw new Error(M("errors.fileTooBig",{maxSize:`${Math.trunc(hA/1024/1024)}MB`}))}const a=((u=this.files[r])==null?void 0:u.dataURL)||await oX(i);return new Promise(async(d,f)=>{var h,m;try{let p=this.getLatestInitializedImageElement(n,r);if(this.addMissingFiles([{mimeType:s,id:r,dataURL:a,created:Date.now(),lastRetrieved:Date.now()}]),!this.imageCache.get(r)){this.addNewImagesToImageCache();const{erroredFiles:b}=await this.updateImageCache([p]);if(b.size)throw new Error("Image cache update resulted with an error.")}const U=await((h=this.imageCache.get(r))==null?void 0:h.image);if(U&&((m=this.state.newElement)==null?void 0:m.id)!==p.id){p=this.getLatestInitializedImageElement(n,r);const b=this.getImageNaturalDimensions(p,U);Object.assign(p,b)}d(p)}catch(p){console.error(p),f(new Error(M("errors.imageInsertError")))}})});F(this,"getLatestInitializedImageElement",(n,i)=>{const s=this.scene.getElement(n.id)??n;return Te(s,{fileId:i})});F(this,"onImageToolbarButtonClick",async()=>{try{const n=this.state.width/2+this.state.offsetLeft,i=this.state.height/2+this.state.offsetTop,{x:s,y:r}=Dt({clientX:n,clientY:i},this.state),o=await TT({description:"Image",extensions:Object.keys(Lh),multiple:!0});this.insertImages(o,s,r)}catch(n){n.name!=="AbortError"?console.error(n):console.warn(n),this.setState({newElement:null,activeTool:en(this.state,{type:this.state.preferredSelectionTool.type})},()=>{this.actionManager.executeAction(Fr)})}});F(this,"getImageNaturalDimensions",(n,i)=>{const s=Math.max(this.state.height-120,160),r=Math.min(s,Math.floor(this.state.height*.5)/this.state.zoom.value),o=Math.min(i.naturalHeight,r),a=o*(i.naturalWidth/i.naturalHeight),l=n.x+n.width/2-a/2,c=n.y+n.height/2-o/2;return{x:l,y:c,width:a,height:o,crop:null}});F(this,"updateImageCache",async(n,i=this.files)=>{const{updatedFiles:s,erroredFiles:r}=await nH({imageCache:this.imageCache,fileIds:n.map(o=>o.fileId),files:i});return r.size&&(this.store.scheduleAction(K.NEVER),this.scene.replaceAllElements(this.scene.getElementsIncludingDeleted().map(o=>Dn(o)&&r.has(o.fileId)?Te(o,{status:"error"}):o))),{updatedFiles:s,erroredFiles:r}});F(this,"addNewImagesToImageCache",async(n=iH(this.scene.getNonDeletedElements()),i=this.files)=>{const s=n.filter(r=>!r.isDeleted&&!this.imageCache.has(r.fileId));if(s.length){const{updatedFiles:r}=await this.updateImageCache(s,i);if(r.size)for(const o of s)r.has(o.fileId)&&Zt.delete(o);r.size&&this.scene.triggerUpdate()}});F(this,"scheduleImageRefresh",Oo(()=>{this.addNewImagesToImageCache()},Cse));F(this,"updateBindingEnabledOnPointerMove",n=>{const i=ile(n);this.state.isBindingEnabled!==i&&this.setState({isBindingEnabled:i})});F(this,"maybeSuggestBindingAtCursor",(n,i)=>{const s=Za(n,this.scene.getNonDeletedElements(),this.scene.getNonDeletedElementsMap(),this.state.zoom,!1,i);this.setState({suggestedBindings:s!=null?[s]:[]})});F(this,"handleInteractiveCanvasRef",n=>{var i,s;n!==null?(this.interactiveCanvas=n,this.interactiveCanvas.addEventListener(te.TOUCH_START,this.onTouchStart,{passive:!1}),this.interactiveCanvas.addEventListener(te.TOUCH_END,this.onTouchEnd)):((i=this.interactiveCanvas)==null||i.removeEventListener(te.TOUCH_START,this.onTouchStart),(s=this.interactiveCanvas)==null||s.removeEventListener(te.TOUCH_END,this.onTouchEnd))});F(this,"insertImages",async(n,i,s)=>{const r=50/this.state.zoom.value,o=wM(n.map(()=>this.newImagePlaceholder({sceneX:i,sceneY:s})),i,s,r);o.forEach(f=>this.scene.insertElement(f));const a=await Promise.all(o.map(async(f,h)=>{try{return await this.initializeImage(f,await km(n[h]))}catch(m){return this.setState({errorMessage:m.message||M("errors.imageInsertError")}),Te(f,{isDeleted:!0})}})),l=ve(a),c=wM(a.filter(f=>!f.isDeleted),i,s,r),u=ve(c),d=this.scene.getElementsIncludingDeleted().map(f=>u.get(f.id)??l.get(f.id)??f);this.updateScene({appState:{selectedElementIds:St(Object.fromEntries(c.map(f=>[f.id,!0])),this.state)},elements:d,captureUpdate:K.IMMEDIATELY}),this.setState({},()=>{this.actionManager.executeAction(Fr)})});F(this,"handleAppOnDrop",async n=>{var d;const{x:i,y:s}=Dt(n,this.state),r=await bv(n),o=r.getFiles();if(o.length===1){const{file:f,fileHandle:h}=o[0];if(f&&(f.type===_e.png||f.type===_e.svg))try{const m=await AT(f,this.state,this.scene.getElementsIncludingDeleted(),h);this.syncActionResult({...m,appState:{...m.appState||this.state,isLoading:!1},replaceFiles:!0,captureUpdate:K.IMMEDIATELY});return}catch(m){if(m.name!=="EncodingError")throw new Error(M("alerts.couldNotLoadInvalidFile"))}}const a=o.map(f=>f.file).filter(f=>Am(f));if(a.length>0&&this.isToolSupported("image"))return this.insertImages(a,i,s);const l=r.getData(_e.excalidrawlibIds),c=r.getData(_e.excalidrawlib);if(l||c){try{let f=null;if(l){const{itemIds:h}=JSON.parse(l);f=(await this.library.getLatestLibrary()).filter(p=>h.includes(p.id))}else c&&(f=rX(c));f!=null&&f.length&&(f=f.map(h=>({...h,elements:E0({type:"everything",elements:h.elements,randomizeSeed:!0}).duplicatedElements})),this.addElementsFromPasteOrLibrary({elements:OT(f),position:n,files:null}))}catch(f){this.setState({errorMessage:f.message})}return}if(o.length>0){const{file:f,fileHandle:h}=o[0];f&&await this.loadFileToCanvas(f,h)}const u=r.findByType(_e.text);if(u){const f=u.value;if(f&&O2(f,this.props.validateEmbeddable)&&(/^(http|https):\/\/[^\s/$.?#].[^\s]*$/.test(f)||((d=jf(f))==null?void 0:d.type)==="video")){const h=this.insertEmbeddableElement({sceneX:i,sceneY:s,link:Qs(f)});h&&(this.store.scheduleCapture(),this.setState({selectedElementIds:{[h.id]:!0}}))}}});F(this,"loadFileToCanvas",async(n,i)=>{n=await km(n);try{const s=this.scene.getElementsIncludingDeleted();let r;try{r=await sX(n,this.state,s,i)}catch(o){const a=o instanceof Lu;if(a&&o.code==="IMAGE_NOT_CONTAINS_SCENE_DATA"&&!this.isToolSupported("image")){this.setState({isLoading:!1,errorMessage:M("errors.imageToolNotSupported")});return}const l=M(a?"alerts.cannotRestoreFromImage":"alerts.couldNotLoadInvalidFile");this.setState({isLoading:!1,errorMessage:l})}if(!r)return;r.type===_e.excalidraw?(ru(s.concat(r.data.elements)),this.store.scheduleMicroAction({action:K.NEVER,elements:s,appState:void 0}),this.setState({isLoading:!0}),this.syncActionResult({...r.data,appState:{...r.data.appState||this.state,isLoading:!1},replaceFiles:!0,captureUpdate:K.IMMEDIATELY})):r.type===_e.excalidrawlib&&await this.library.updateLibrary({libraryItems:n,merge:!0,openLibraryMenu:!0}).catch(o=>{console.error(o),this.setState({errorMessage:M("errors.importLibraryError")})})}catch(s){this.setState({isLoading:!1,errorMessage:s.message})}});F(this,"handleCanvasContextMenu",n=>{if(n.preventDefault(),("pointerType"in n.nativeEvent&&n.nativeEvent.pointerType==="touch"||"pointerType"in n.nativeEvent&&n.nativeEvent.pointerType==="pen"&&n.button!==Fl.SECONDARY)&&this.state.activeTool.type!==this.state.preferredSelectionTool.type)return;const{x:i,y:s}=Dt(n,this.state),r=this.getElementAtPosition(i,s,{preferSelected:!0,includeLockedElements:!0}),o=this.scene.getSelectedElements(this.state),a=this.isHittingCommonBoundingBoxOfSelectedElements({x:i,y:s},o),l=r||a?"element":"canvas",c=this.excalidrawContainerRef.current,{top:u,left:d}=c.getBoundingClientRect(),f=n.clientX-d,h=n.clientY-u;Qe("contextMenu","openContextMenu",l),this.setState({...r&&!this.state.selectedElementIds[r.id]?{...this.state,...Ii({editingGroupId:this.state.editingGroupId,selectedElementIds:{[r.id]:!0}},this.scene.getNonDeletedElements(),this.state,this),selectedLinearElement:Se(r)?new pe(r,this.scene.getNonDeletedElementsMap()):null}:this.state,showHyperlinkPopup:!1},()=>{this.setState({contextMenu:{top:h,left:f,items:this.getContextMenuItems(l)}})})});F(this,"maybeDragNewGenericElement",(n,i,s=!0)=>{var m,p,U;const r=this.state.selectionElement,o=n.lastCoords;if(r&&this.state.activeTool.type!=="eraser"){hM({newElement:r,elementType:this.state.activeTool.type,originX:n.origin.x,originY:n.origin.y,x:o.x,y:o.y,width:$i(n.origin.x,o.x),height:$i(n.origin.y,o.y),shouldMaintainAspectRatio:s1(i),shouldResizeFromCenter:!1,scene:this.scene,zoom:this.state.zoom.value,informMutation:!1});return}const a=this.state.newElement;if(!a)return;let[l,c]=On(o.x,o.y,i[H.CTRL_OR_CMD]?null:this.getEffectiveGridSize());const u=Dn(a)&&((m=this.imageCache.get(a.fileId))==null?void 0:m.image),d=u&&!(u instanceof Promise)?u.width/u.height:null;this.maybeCacheReferenceSnapPoints(i,[a]);const{snapOffset:f,snapLines:h}=I3e(a,this,i,{x:n.originInGrid.x+(((p=this.state.originSnapOffset)==null?void 0:p.x)??0),y:n.originInGrid.y+(((U=this.state.originSnapOffset)==null?void 0:U.y)??0)},{x:l-n.originInGrid.x,y:c-n.originInGrid.y},this.scene.getNonDeletedElementsMap());l+=f.x,c+=f.y,this.setState({snapLines:h}),hM({newElement:a,elementType:this.state.activeTool.type,originX:n.originInGrid.x,originY:n.originInGrid.y,x:l,y:c,width:$i(n.originInGrid.x,l),height:$i(n.originInGrid.y,c),shouldMaintainAspectRatio:yt(a)?!s1(i):s1(i),shouldResizeFromCenter:gA(i),zoom:this.state.zoom.value,scene:this.scene,widthAspectRatio:d,originOffset:this.state.originSnapOffset,informMutation:s}),this.setState({newElement:a}),(this.state.activeTool.type===qn.frame||this.state.activeTool.type===qn.magicframe)&&this.setState({elementsToHighlight:Go(this.scene.getNonDeletedElements(),a,this.state,this.scene.getNonDeletedElementsMap())})});F(this,"maybeHandleCrop",(n,i)=>{var c;if(!this.state.croppingElementId)return!1;const s=n.resize.handleType,r=n.lastCoords,[o,a]=On(r.x-n.resize.offset.x,r.y-n.resize.offset.y,i[H.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),l=this.scene.getNonDeletedElementsMap().get(this.state.croppingElementId);if(s&&l&&yt(l)){const u=n.originalElements.get(l.id),d=Dn(l)&&((c=this.imageCache.get(l.fileId))==null?void 0:c.image);if(u&&yt(u)&&d&&!(d instanceof Promise)){const[f,h]=On(r.x,r.y,i[H.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),m={x:f-n.originInGrid.x,y:h-n.originInGrid.y};this.maybeCacheReferenceSnapPoints(i,[l]);const{snapOffset:p,snapLines:U}=dD([l],[u],this,i,m,s);this.scene.mutateElement(l,sae(l,this.scene.getNonDeletedElementsMap(),s,d.naturalWidth,d.naturalHeight,o+p.x,a+p.y,i.shiftKey?u.width/u.height:void 0)),Is(l,this.scene,{newSize:{width:l.width,height:l.height}}),this.setState({isCropping:s&&s!=="rotation",snapLines:U})}return!0}return!1});F(this,"maybeHandleResize",(n,i)=>{const s=this.scene.getSelectedElements(this.state),r=s.filter(d=>Ee(d)),o=n.resize.handleType;if(r.length>0&&o==="rotation"||s.length===1&&ge(s[0])||this.state.croppingElementId)return!1;this.setState({isResizing:o&&o!=="rotation",isRotating:o==="rotation",activeEmbeddable:null});const a=n.lastCoords;let[l,c]=On(a.x-n.resize.offset.x,a.y-n.resize.offset.y,i[H.CTRL_OR_CMD]?null:this.getEffectiveGridSize());const u=new Map;if(r.forEach(d=>{Js(this.scene.getNonDeletedElements(),d.id).forEach(h=>{u.set(d.id+h.id,{x:h.x-d.x,y:h.y-d.y})})}),!this.state.selectedElementsAreBeingDragged){const[d,f]=On(a.x,a.y,i[H.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),h={x:d-n.originInGrid.x,y:f-n.originInGrid.y},m=[...n.originalElements.values()];this.maybeCacheReferenceSnapPoints(i,s);const{snapOffset:p,snapLines:U}=dD(s,Ve(m,this.state),this,i,h,o);l+=p.x,c+=p.y,this.setState({snapLines:U})}if(aue(n.originalElements,o,s,this.scene,g0(i),gA(i),s.some(d=>yt(d))?!s1(i):s1(i),l,c,n.resize.center.x,n.resize.center.y)){const d=R8(s,this.scene.getNonDeletedElementsMap(),this.state.zoom),f=new Set;return r.forEach(h=>{Go(this.scene.getNonDeletedElements(),h,this.state,this.scene.getNonDeletedElementsMap()).forEach(m=>f.add(m))}),this.setState({elementsToHighlight:[...f],suggestedBindings:d}),!0}return!1});F(this,"getContextMenuItems",n=>{const i=[];if(i.push(FR,PR),n==="canvas")return this.state.viewModeEnabled?[...i,zR,Ev,sD,vv]:[NR,Zn,FR,PR,BR,Zn,Bfe,jye,Zn,zR,Lye,Ev,sD,vv];if(i.push(BR),this.state.viewModeEnabled)return[q2,...i];const s=this.state.stylesPanelMode==="full"?[Zn,Nfe,Ofe,Pfe,Ffe]:[];return[Zn,OR,q2,NR,Zn,u3e,d3e,f3e,Zn,c3e,Zn,...i,Zn,wye,_ye,Zn,Iye,m3e,Nye,Oye,Bye,Sye,Zn,Mye,...s,Zn,kye,Rye,Zn,e2,Zn,vX,xX,Zn,zfe,wX,Zn,LV]});F(this,"handleWheel",on(n=>{if(!(n.target instanceof HTMLCanvasElement||n.target instanceof HTMLTextAreaElement||n.target instanceof HTMLIFrameElement)){n[H.CTRL_OR_CMD]&&n.preventDefault();return}if(n.preventDefault(),E1)return;const{deltaX:i,deltaY:s}=n;if(n.metaKey||n.ctrlKey){const r=Math.sign(s),o=V5*100,a=Math.abs(s);let l=s;a>o&&(l=o*r);let c=this.state.zoom.value-l/100;c+=Math.log10(Math.max(1,this.state.zoom.value))*-r*Math.min(1,a/20),this.translateCanvas(u=>({...Nu({viewportX:this.lastViewportPosition.x,viewportY:this.lastViewportPosition.y,nextZoom:Ha(c)},u),shouldCacheIgnoreZoom:!0})),this.resetShouldCacheIgnoreZoomDebounced();return}if(n.shiftKey){this.translateCanvas(({zoom:r,scrollX:o})=>({scrollX:o-(s||i)/r.value}));return}this.translateCanvas(({zoom:r,scrollX:o,scrollY:a})=>({scrollX:o-i/r.value,scrollY:a-s/r.value}))}));F(this,"savePointer",(n,i,s)=>{var l,c;if(!n||!i)return;const{x:r,y:o}=Dt({clientX:n,clientY:i},this.state),a={x:r,y:o,tool:this.state.activeTool.type==="laser"?"laser":"pointer"};(c=(l=this.props).onPointerUpdate)==null||c.call(l,{pointer:a,button:s,pointersMap:pt.pointers})});F(this,"resetShouldCacheIgnoreZoomDebounced",sl(()=>{this.unmounted||this.setState({shouldCacheIgnoreZoom:!1})},300));F(this,"updateDOMRect",n=>{var i;if((i=this.excalidrawContainerRef)!=null&&i.current){const s=this.excalidrawContainerRef.current,{width:r,height:o,left:a,top:l}=s.getBoundingClientRect(),{width:c,height:u,offsetTop:d,offsetLeft:f}=this.state;if(r===c&&o===u&&a===f&&l===d){n&&n();return}this.setState({width:r,height:o,offsetLeft:a,offsetTop:l},()=>{n&&n()})}});F(this,"refresh",()=>{this.setState({...this.getCanvasOffsets()})});const i=ia(),{excalidrawAPI:s,viewModeEnabled:r=!1,zenModeEnabled:o=!1,gridModeEnabled:a=!1,objectsSnapModeEnabled:l=!1,theme:c=i.theme,name:u=`${M("labels.untitled")}-${yA()}`}=n;if(this.state={...i,theme:c,isLoading:!0,...this.getCanvasOffsets(),viewModeEnabled:r,zenModeEnabled:o,objectsSnapModeEnabled:l,gridModeEnabled:a??i.gridModeEnabled,name:u,width:window.innerWidth,height:window.innerHeight},this.id=XB(),this.library=new BEe(this),this.actionManager=new p3e(this.syncActionResult,()=>this.state,()=>this.scene.getElementsIncludingDeleted(),this),this.scene=new _6,this.canvas=document.createElement("canvas"),this.rc=nu.canvas(this.canvas),this.renderer=new bD(this.scene),this.visibleElements=[],this.store=new _ce(this),this.history=new Fu(this.store),s){const d={updateScene:this.updateScene,applyDeltas:this.applyDeltas,mutateElement:this.mutateElement,updateLibrary:this.library.updateLibrary,addFiles:this.addFiles,resetScene:this.resetScene,getSceneElementsIncludingDeleted:this.getSceneElementsIncludingDeleted,getSceneElementsMapIncludingDeleted:this.getSceneElementsMapIncludingDeleted,history:{clear:this.resetHistory},scrollToContent:this.scrollToContent,getSceneElements:this.getSceneElements,getAppState:()=>this.state,getFiles:()=>this.files,getName:this.getName,registerAction:f=>{this.actionManager.registerAction(f)},refresh:this.refresh,setToast:this.setToast,id:this.id,setActiveTool:this.setActiveTool,setCursor:this.setCursor,resetCursor:this.resetCursor,updateFrameRendering:this.updateFrameRendering,toggleSidebar:this.toggleSidebar,onChange:f=>this.onChangeEmitter.on(f),onIncrement:f=>this.store.onStoreIncrementEmitter.on(f),onPointerDown:f=>this.onPointerDownEmitter.on(f),onPointerUp:f=>this.onPointerUpEmitter.on(f),onScrollChange:f=>this.onScrollChangeEmitter.on(f),onUserFollow:f=>this.onUserFollowEmitter.on(f)};typeof s=="function"?s(d):console.error("excalidrawAPI should be a function!")}this.excalidrawContainerValue={container:this.excalidrawContainerRef.current,id:this.id},this.fonts=new Qa(this.scene),this.history=new Fu(this.store),this.actionManager.registerAll(iv),this.actionManager.registerAction(h3e(this.history)),this.actionManager.registerAction(g3e(this.history))}onWindowMessage(n){if(n.origin!=="https://player.vimeo.com"&&n.origin!=="https://www.youtube.com")return;let i=null;try{i=JSON.parse(n.data)}catch{}if(i)switch(n.origin){case"https://player.vimeo.com":if(i.method==="paused"){let s=null;const r=document.body.querySelectorAll("iframe.excalidraw__embeddable");if(!r)break;for(const o of r)o.contentWindow===n.source&&(s=o.contentWindow);s==null||s.postMessage(JSON.stringify({method:i.value?"play":"pause",value:!0}),"*")}break;case"https://www.youtube.com":if(i.event==="infoDelivery"&&i.info&&i.id&&typeof i.info.playerState=="number"){const s=i.id,r=i.info.playerState;Object.values(CU).includes(r)&&B3.set(s,r)}break}}cacheEmbeddableRef(n,i){i&&this.iFrameRefs.set(n.id,i)}getHTMLIFrameElement(n){return this.iFrameRefs.get(n.id)}handleEmbeddableCenterClick(n){var s,r,o,a;if(((s=this.state.activeEmbeddable)==null?void 0:s.element)===n&&((r=this.state.activeEmbeddable)==null?void 0:r.state)==="active"||(setTimeout(()=>{this.setState({activeEmbeddable:{element:n,state:"active"},selectedElementIds:{[n.id]:!0},newElement:null,selectionElement:null})},100),jl(n)))return;const i=this.getHTMLIFrameElement(n);if(i!=null&&i.contentWindow){if(i.src.includes("youtube")){const l=B3.get(n.id);switch(l||(B3.set(n.id,CU.UNSTARTED),i.contentWindow.postMessage(JSON.stringify({event:"listening",id:n.id}),"*")),l){case CU.PLAYING:case CU.BUFFERING:(o=i.contentWindow)==null||o.postMessage(JSON.stringify({event:"command",func:"pauseVideo",args:""}),"*");break;default:(a=i.contentWindow)==null||a.postMessage(JSON.stringify({event:"command",func:"playVideo",args:""}),"*")}}i.src.includes("player.vimeo.com")&&i.contentWindow.postMessage(JSON.stringify({method:"paused"}),"*")}}isIframeLikeElementCenter(n,i,s,r){var o,a;return n&&!i.altKey&&!i.shiftKey&&!i.metaKey&&!i.ctrlKey&&(((o=this.state.activeEmbeddable)==null?void 0:o.element)!==n||((a=this.state.activeEmbeddable)==null?void 0:a.state)==="hover"||!this.state.activeEmbeddable)&&s>=n.x+n.width/3&&s<=n.x+2*n.width/3&&r>=n.y+n.height/3&&r<=n.y+2*n.height/3}renderEmbeddables(){const n=this.state.zoom.value,i=this.state.width,s=this.state.height,r=this.scene.getNonDeletedElements().filter(o=>rs(o)&&this.embedsValidationStatus.get(o.id)===!0||jl(o));return g(fe,{children:r.map(o=>{var p,U,b,y,w,v,I,C,_;const{x:a,y:l}=Xs({sceneX:o.x,sceneY:o.y},this.state),c=w6(o,i,s,this.state,this.scene.getNonDeletedElementsMap()),u=this.initializedEmbeds.has(o.id);if(c&&!u&&this.initializedEmbeds.add(o.id),!(c||u))return null;let f;if(jl(o)){f=null;const T=(((p=o.customData)==null?void 0:p.generationData)??this.magicGenerations.get(o.id))||{status:"error",message:"No generation data",code:"ERR_NO_GENERATION_DATA"};if(T.status==="done"){const k=T.html;f={intrinsicSize:{w:o.width,h:o.height},type:"document",srcdoc:()=>k}}else if(T.status==="pending")f={intrinsicSize:{w:o.width,h:o.height},type:"document",srcdoc:()=>v0(`
                    <style>
                      html, body {
                        width: 100%;
                        height: 100%;
                        color: ${this.state.theme===ke.DARK?"white":"black"};
                      }
                      body {
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        flex-direction: column;
                        gap: 1rem;
                      }

                      .Spinner {
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        margin-left: auto;
                        margin-right: auto;
                      }

                      .Spinner svg {
                        animation: rotate 1.6s linear infinite;
                        transform-origin: center center;
                        width: 40px;
                        height: 40px;
                      }

                      .Spinner circle {
                        stroke: currentColor;
                        animation: dash 1.6s linear 0s infinite;
                        stroke-linecap: round;
                      }

                      @keyframes rotate {
                        100% {
                          transform: rotate(360deg);
                        }
                      }

                      @keyframes dash {
                        0% {
                          stroke-dasharray: 1, 300;
                          stroke-dashoffset: 0;
                        }
                        50% {
                          stroke-dasharray: 150, 300;
                          stroke-dashoffset: -200;
                        }
                        100% {
                          stroke-dasharray: 1, 300;
                          stroke-dashoffset: -280;
                        }
                      }
                    </style>
                    <div class="Spinner">
                      <svg
                        viewBox="0 0 100 100"
                      >
                        <circle
                          cx="50"
                          cy="50"
                          r="46"
                          stroke-width="8"
                          fill="none"
                          stroke-miter-limit="10"
                        />
                      </svg>
                    </div>
                    <div>Generating...</div>
                  `)};else{let k;T.code==="ERR_GENERATION_INTERRUPTED"?k="Generation was interrupted...":k=T.message||"Generation failed",f={intrinsicSize:{w:o.width,h:o.height},type:"document",srcdoc:()=>v0(`
                    <style>
                    html, body {
                      height: 100%;
                    }
                      body {
                        display: flex;
                        flex-direction: column;
                        align-items: center;
                        justify-content: center;
                        color: ${Ge.red[3]};
                      }
                      h1, h3 {
                        margin-top: 0;
                        margin-bottom: 0.5rem;
                      }
                    </style>
                    <h1>Error!</h1>
                    <h3>${k}</h3>
                  `)}}}else f=jf(z9(o.link||""));const h=((U=this.state.activeEmbeddable)==null?void 0:U.element)===o&&((b=this.state.activeEmbeddable)==null?void 0:b.state)==="active",m=((y=this.state.activeEmbeddable)==null?void 0:y.element)===o&&((w=this.state.activeEmbeddable)==null?void 0:w.state)==="hover";return g("div",{className:re("excalidraw__embeddable-container",{"is-hovered":m}),style:{transform:c?`translate(${a-this.state.offsetLeft}px, ${l-this.state.offsetTop}px) scale(${n})`:"none",display:c?"block":"none",opacity:kz(o,Ss(o,this.scene.getNonDeletedElementsMap()),this.elementsPendingErasure,null,((v=this.state.openDialog)==null?void 0:v.name)==="elementLinkSelector"?fB:1),"--embeddable-radius":`${us(Math.min(o.width,o.height),o)}px`},children:N("div",{className:"excalidraw__embeddable-container__inner",style:{width:c?`${o.width}px`:0,height:c?`${o.height}px`:0,transform:c?`rotate(${o.angle}rad)`:"none",pointerEvents:h?Eu.enabled:Eu.disabled},children:[m&&g("div",{className:"excalidraw__embeddable-hint",children:M("buttons.embeddableInteractionButton")}),g("div",{className:"excalidraw__embeddable__outer",style:{padding:`${o.strokeWidth}px`},children:(rs(o)?(C=(I=this.props).renderEmbeddable)==null?void 0:C.call(I,o,this.state):null)??g("iframe",{ref:T=>this.cacheEmbeddableRef(o,T),className:"excalidraw__embeddable",srcDoc:(f==null?void 0:f.type)==="document"?f.srcdoc(this.state.theme):void 0,src:(f==null?void 0:f.type)!=="document"?(f==null?void 0:f.link)??"":void 0,scrolling:"no",referrerPolicy:"no-referrer-when-downgrade",title:"Excalidraw Embedded Content",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,sandbox:`${(_=f==null?void 0:f.sandbox)!=null&&_.allowSameOrigin?"allow-same-origin":""} allow-scripts allow-forms allow-popups allow-popups-to-escape-sandbox allow-presentation allow-downloads`})})]})},o.id)})})}toggleOverscrollBehavior(n){document.documentElement.style.overscrollBehaviorX=n.type==="pointerenter"?"none":"auto"}render(){var h,m,p,U,b,y,w,v,I;const n=this.scene.getSelectedElements(this.state),{renderTopRightUI:i,renderTopLeftUI:s,renderCustomStats:r}=this.props,o=this.scene.getSceneNonce(),{elementsMap:a,visibleElements:l}=this.renderer.getRenderableElements({sceneNonce:o,zoom:this.state.zoom,offsetLeft:this.state.offsetLeft,offsetTop:this.state.offsetTop,scrollX:this.state.scrollX,scrollY:this.state.scrollY,height:this.state.height,width:this.state.width,editingTextElement:this.state.editingTextElement,newElementId:(h=this.state.newElement)==null?void 0:h.id});this.visibleElements=l;const c=this.scene.getNonDeletedElementsMap(),u="setPointerCapture"in HTMLElement.prototype?!1:this.state.selectionElement||this.state.newElement||this.state.selectedElementsAreBeingDragged||this.state.resizingElement||this.state.activeTool.type==="laser"&&this.state.cursorButton==="down",d=n[0],f=((m=Hs.get(Ia))==null?void 0:m.type)==="panel";return g("div",{className:re("excalidraw excalidraw-container",{"excalidraw--view-mode":this.state.viewModeEnabled||((p=this.state.openDialog)==null?void 0:p.name)==="elementLinkSelector","excalidraw--mobile":this.device.editor.isMobile}),style:{"--ui-pointerEvents":u?Eu.disabled:Eu.enabled,"--right-sidebar-width":"302px"},ref:this.excalidrawContainerRef,onDrop:this.handleAppOnDrop,tabIndex:0,onKeyDown:this.props.handleKeyboardGlobally?void 0:this.onKeyDown,onPointerEnter:this.toggleOverscrollBehavior,onPointerLeave:this.toggleOverscrollBehavior,children:g(yY.Provider,{value:this,children:g(EY.Provider,{value:this.props,children:g(ZT.Provider,{value:this.excalidrawContainerValue,children:g(KT.Provider,{value:this.device,children:g(JT.Provider,{value:this.setAppState,children:g(QT.Provider,{value:this.state,children:N(qT.Provider,{value:this.scene.getNonDeletedElements(),children:[N(eI.Provider,{value:this.actionManager,children:[g(Sve,{canvas:this.canvas,appState:this.state,files:this.files,setAppState:this.setAppState,actionManager:this.actionManager,elements:this.scene.getNonDeletedElements(),onLockToggle:this.toggleLock,onPenModeToggle:this.togglePenMode,onHandToolToggle:this.onHandToolToggle,langCode:gm().code,renderTopLeftUI:s,renderTopRightUI:i,renderCustomStats:r,showExitZenModeBtn:typeof((U=this.props)==null?void 0:U.zenModeEnabled)>"u"&&this.state.zenModeEnabled,UIOptions:this.props.UIOptions,onExportImage:this.onExportImage,renderWelcomeScreen:!this.state.isLoading&&this.state.showWelcomeScreen&&this.state.activeTool.type===this.state.preferredSelectionTool.type&&!this.state.zenModeEnabled&&!this.scene.getElementsIncludingDeleted().length,app:this,isCollaborating:this.props.isCollaborating,generateLinkForSelection:this.props.generateLinkForSelection,children:this.props.children}),g("div",{className:"excalidraw-textEditorContainer"}),g("div",{className:"excalidraw-contextMenuContainer"}),g("div",{className:"excalidraw-eye-dropper-container"}),g(Cve,{trails:[this.laserTrails,this.lassoTrail,this.eraserTrail]}),n.length===1&&((b=this.state.openDialog)==null?void 0:b.name)!=="elementLinkSelector"&&this.state.showHyperlinkPopup&&g(Vye,{element:d,scene:this.scene,setAppState:this.setAppState,onLinkOpen:this.props.onLinkOpen,setToast:this.setToast,updateEmbedValidationStatus:this.updateEmbedValidationStatus},d.id),this.props.aiEnabled!==!1&&n.length===1&&R2(d)&&g(yD,{element:d,elementsMap:a,children:g(O3,{title:M("labels.convertToCode"),icon:C6,checked:!1,onChange:()=>this.onMagicFrameGenerate(d,"button")})}),n.length===1&&jl(d)&&((w=(y=d.customData)==null?void 0:y.generationData)==null?void 0:w.status)==="done"&&N(yD,{element:d,elementsMap:a,children:[g(O3,{title:M("labels.copySource"),icon:xp,checked:!1,onChange:()=>this.onIframeSrcCopy(d)}),g(O3,{title:"Enter fullscreen",icon:dfe,checked:!1,onChange:()=>{const C=this.getHTMLIFrameElement(d);if(C)try{C.requestFullscreen(),this.setState({activeEmbeddable:{element:d,state:"active"},selectedElementIds:{[d.id]:!0},newElement:null,selectionElement:null})}catch(_){console.warn(_),this.setState({errorMessage:"Couldn't enter fullscreen"})}}})]}),this.state.toast!==null&&g(Bve,{message:this.state.toast.message,onClose:this.handleToastClose,duration:this.state.toast.duration,closable:this.state.toast.closable}),this.state.contextMenu&&g(m7e,{items:this.state.contextMenu.items,top:this.state.contextMenu.top,left:this.state.contextMenu.left,actionManager:this.actionManager,onClose:C=>{this.setState({contextMenu:null},()=>{this.focusContainer(),C==null||C()})}}),g(Lve,{canvas:this.canvas,rc:this.rc,elementsMap:a,allElementsMap:c,visibleElements:l,sceneNonce:o,selectionNonce:(v=this.state.selectionElement)==null?void 0:v.versionNonce,scale:window.devicePixelRatio,appState:this.state,renderConfig:{imageCache:this.imageCache,isExporting:!1,renderGrid:Nm(this),canvasBackgroundColor:this.state.viewBackgroundColor,embedsValidationStatus:this.embedsValidationStatus,elementsPendingErasure:this.elementsPendingErasure,pendingFlowchartNodes:this.flowChartCreator.pendingNodes}}),this.state.newElement&&g(Pve,{appState:this.state,scale:window.devicePixelRatio,rc:this.rc,elementsMap:a,allElementsMap:c,renderConfig:{imageCache:this.imageCache,isExporting:!1,renderGrid:!1,canvasBackgroundColor:this.state.viewBackgroundColor,embedsValidationStatus:this.embedsValidationStatus,elementsPendingErasure:this.elementsPendingErasure,pendingFlowchartNodes:null}}),g(kve,{containerRef:this.excalidrawContainerRef,canvas:this.interactiveCanvas,elementsMap:a,visibleElements:l,allElementsMap:c,selectedElements:n,sceneNonce:o,selectionNonce:(I=this.state.selectionElement)==null?void 0:I.versionNonce,scale:window.devicePixelRatio,appState:this.state,renderScrollbars:this.props.renderScrollbars===!0,device:this.device,renderInteractiveSceneCallback:this.renderInteractiveSceneCallback,handleCanvasRef:this.handleInteractiveCanvasRef,onContextMenu:this.handleCanvasContextMenu,onPointerMove:this.handleCanvasPointerMove,onPointerUp:this.handleCanvasPointerUp,onPointerCancel:this.removePointer,onTouchMove:this.handleTouchMove,onPointerDown:this.handleCanvasPointerDown,onDoubleClick:this.handleCanvasDoubleClick}),this.state.userToFollow&&g(p7e,{width:this.state.width,height:this.state.height,userToFollow:this.state.userToFollow,onDisconnect:this.maybeUnfollowRemoteUser}),this.renderFrameNames(),this.state.activeLockedId&&g(zve,{app:this,activeLockedId:this.state.activeLockedId}),f&&g(Jye,{app:this})]}),this.renderEmbeddables()]})})})})})})})})}setPlugins(n){Object.assign(this.plugins,n)}async onMagicFrameGenerate(n,i){var a;const s=(a=this.plugins.diagramToCode)==null?void 0:a.generate;if(!s){this.setState({errorMessage:"No diagram to code plugin found"});return}const r=m_(this.scene.getNonDeletedElements(),n).filter(l=>!R2(l));if(!r.length){i==="button"?(this.setState({errorMessage:"Cannot generate from an empty frame"}),Qe("ai","generate (no-children)","d2c")):this.setActiveTool({type:"magicframe"});return}const o=this.insertIframeElement({sceneX:n.x+n.width+30,sceneY:n.y,width:n.width,height:n.height});if(o){this.updateMagicGeneration({frameElement:o,data:{status:"pending"}}),this.setState({selectedElementIds:{[o.id]:!0}}),Qe("ai","generate (start)","d2c");try{const{html:l}=await s({frame:n,children:r});if(Qe("ai","generate (success)","d2c"),!l.trim()){this.updateMagicGeneration({frameElement:o,data:{status:"error",code:"ERR_OAI",message:"Nothing genereated :("}});return}const c=l.includes("<!DOCTYPE html>")&&l.includes("</html>")?l.slice(l.indexOf("<!DOCTYPE html>"),l.indexOf("</html>")+7):l;this.updateMagicGeneration({frameElement:o,data:{status:"done",html:c}})}catch(l){Qe("ai","generate (failed)","d2c"),this.updateMagicGeneration({frameElement:o,data:{status:"error",code:"ERR_OAI",message:l.message||"Unknown error during generation"}})}}}onIframeSrcCopy(n){var i,s;((s=(i=n.customData)==null?void 0:i.generationData)==null?void 0:s.status)==="done"&&(au(n.customData.generationData.html),this.setToast({message:"copied to clipboard",closable:!1,duration:1500}))}clearImageShapeCache(n){const i=n??this.files;this.scene.getNonDeletedElements().forEach(s=>{Dn(s)&&i[s.fileId]&&(this.imageCache.delete(s.fileId),Zt.delete(s))})}async componentDidMount(){var s;this.unmounted=!1,this.excalidrawContainerValue.container=this.excalidrawContainerRef.current,this.store.onDurableIncrementEmitter.on(r=>{this.history.record(r.delta)});const{onIncrement:n}=this.props;n&&this.store.onStoreIncrementEmitter.on(r=>{n(r)}),this.scene.onUpdate(this.triggerRender),this.addEventListeners(),this.props.autoFocus&&this.excalidrawContainerRef.current&&this.focusContainer(),this.refreshViewportBreakpoints(),this.refreshEditorBreakpoints(),u4&&this.excalidrawContainerRef.current&&(this.resizeObserver=new ResizeObserver(()=>{this.refreshEditorBreakpoints(),this.updateDOMRect()}),(s=this.resizeObserver)==null||s.observe(this.excalidrawContainerRef.current)),new URLSearchParams(window.location.search.slice(1)).has("web-share-target")?this.restoreFileFromShare():this.updateDOMRect(this.initializeScene),pse()&&!Uae()&&this.setState({errorMessage:g(h7e,{})})}componentWillUnmount(){var n,i;(n=window.launchQueue)==null||n.setConsumer(()=>{}),this.renderer.destroy(),this.scene.destroy(),this.scene=new _6,this.fonts=new Qa(this.scene),this.renderer=new bD(this.scene),this.files={},this.imageCache.clear(),(i=this.resizeObserver)==null||i.disconnect(),this.unmounted=!0,this.removeEventListeners(),this.library.destroy(),this.laserTrails.stop(),this.eraserTrail.stop(),this.onChangeEmitter.clear(),this.store.onStoreIncrementEmitter.clear(),this.store.onDurableIncrementEmitter.clear(),Zt.destroy(),Gr.destroy(),clearTimeout(Ol),Yn.clearCache(),Ii.clearCache(),Ol=0,document.documentElement.style.overscrollBehaviorX=""}removeEventListeners(){this.onRemoveEventListenersEmitter.trigger()}addEventListeners(){this.removeEventListeners(),this.props.handleKeyboardGlobally&&this.onRemoveEventListenersEmitter.once(Jt(document,te.KEYDOWN,this.onKeyDown,!1)),this.onRemoveEventListenersEmitter.once(Jt(this.excalidrawContainerRef.current,te.WHEEL,this.handleWheel,{passive:!1}),Jt(window,te.MESSAGE,this.onWindowMessage,!1),Jt(document,te.POINTER_UP,this.removePointer,{passive:!1}),Jt(document,te.COPY,this.onCopy,{passive:!1}),Jt(document,te.KEYUP,this.onKeyUp,{passive:!0}),Jt(document,te.POINTER_MOVE,this.updateCurrentCursorPosition,{passive:!1}),Jt(document.fonts,"loadingdone",n=>{const i=n.fontfaces;this.fonts.onLoaded(i)},{passive:!1}),Jt(document,te.GESTURE_START,this.onGestureStart,!1),Jt(document,te.GESTURE_CHANGE,this.onGestureChange,!1),Jt(document,te.GESTURE_END,this.onGestureEnd,!1),Jt(window,te.FOCUS,()=>{this.maybeCleanupAfterMissingPointerUp(null),this.triggerRender(!0)},{passive:!1})),!this.state.viewModeEnabled&&(this.onRemoveEventListenersEmitter.once(Jt(document,te.FULLSCREENCHANGE,this.onFullscreenChange,{passive:!1}),Jt(document,te.PASTE,this.pasteFromClipboard,{passive:!1}),Jt(document,te.CUT,this.onCut,{passive:!1}),Jt(window,te.RESIZE,this.onResize,!1),Jt(window,te.UNLOAD,this.onUnload,!1),Jt(window,te.BLUR,this.onBlur,!1),Jt(this.excalidrawContainerRef.current,te.WHEEL,this.handleWheel,{passive:!1}),Jt(this.excalidrawContainerRef.current,te.DRAG_OVER,this.disableEvent,!1),Jt(this.excalidrawContainerRef.current,te.DROP,this.disableEvent,!1)),this.props.detectScroll&&this.onRemoveEventListenersEmitter.once(Jt(Ire(this.excalidrawContainerRef.current),te.SCROLL,this.onScroll,{passive:!1})))}componentDidUpdate(n,i){var a,l,c,u,d,f,h,m,p,U,b;this.updateEmbeddables();const s=this.scene.getElementsIncludingDeleted(),r=this.scene.getElementsMapIncludingDeleted();!this.state.showWelcomeScreen&&!s.length&&this.setState({showWelcomeScreen:!0}),n.UIOptions.dockedSidebarBreakpoint!==this.props.UIOptions.dockedSidebarBreakpoint&&this.refreshEditorBreakpoints(),i.userToFollow&&!this.state.collaborators.has(i.userToFollow.socketId)&&this.maybeUnfollowRemoteUser(),(i.zoom.value!==this.state.zoom.value||i.scrollX!==this.state.scrollX||i.scrollY!==this.state.scrollY)&&((l=(a=this.props)==null?void 0:a.onScrollChange)==null||l.call(a,this.state.scrollX,this.state.scrollY,this.state.zoom),this.onScrollChangeEmitter.trigger(this.state.scrollX,this.state.scrollY,this.state.zoom)),i.userToFollow!==this.state.userToFollow&&(i.userToFollow&&this.onUserFollowEmitter.trigger({userToFollow:i.userToFollow,action:"UNFOLLOW"}),this.state.userToFollow&&this.onUserFollowEmitter.trigger({userToFollow:this.state.userToFollow,action:"FOLLOW"})),Object.keys(this.state.selectedElementIds).length&&Ao(this.state)&&this.setState({activeTool:en(this.state,{type:"selection"})}),this.state.activeTool.type==="eraser"&&i.theme!==this.state.theme&&K$(this.interactiveCanvas,this.state.theme),i.activeTool.type==="selection"&&this.state.activeTool.type!=="selection"&&this.state.showHyperlinkPopup&&this.setState({showHyperlinkPopup:!1}),n.langCode!==this.props.langCode&&this.updateLanguage(),Ao(i)&&!Ao(this.state)&&this.eraserTrail.endPath(),n.viewModeEnabled!==this.props.viewModeEnabled&&this.setState({viewModeEnabled:!!this.props.viewModeEnabled}),i.viewModeEnabled!==this.state.viewModeEnabled&&(this.addEventListeners(),this.deselectElements()),(((c=i.openDialog)==null?void 0:c.name)==="elementLinkSelector"||((u=this.state.openDialog)==null?void 0:u.name)==="elementLinkSelector")&&((d=i.openDialog)==null?void 0:d.name)!==((f=this.state.openDialog)==null?void 0:f.name)&&(this.deselectElements(),this.setState({hoveredElementIds:{}})),n.zenModeEnabled!==this.props.zenModeEnabled&&this.setState({zenModeEnabled:!!this.props.zenModeEnabled}),n.theme!==this.props.theme&&this.props.theme&&this.setState({theme:this.props.theme}),(h=this.excalidrawContainerRef.current)==null||h.classList.toggle("theme--dark",this.state.theme===ke.DARK),(m=this.state.selectedLinearElement)!=null&&m.isEditing&&!this.state.selectedElementIds[this.state.selectedLinearElement.elementId]&&setTimeout(()=>{var y;(y=this.state.selectedLinearElement)!=null&&y.isEditing&&this.actionManager.executeAction(Fr)}),(p=this.state.editingTextElement)!=null&&p.isDeleted&&this.setState({editingTextElement:null}),this.state.selectedLinearElement&&!this.state.selectedElementIds[this.state.selectedLinearElement.elementId]&&this.setState({selectedLinearElement:null}),this.store.commit(r,this.state),this.state.isLoading||((b=(U=this.props).onChange)==null||b.call(U,s,this.state,this.files),this.onChangeEmitter.trigger(s,this.state,this.files))}static resetTapTwice(){b1=!1,y1=null}async insertClipboardContent(n,i,s){const{x:r,y:o}=Dt({clientX:this.lastViewportPosition.x,clientY:this.lastViewportPosition.y},this.state);if(n.errorMessage){this.setState({errorMessage:n.errorMessage});return}if(i.length===0&&!s&&n.mixedContent){await this.addElementsFromMixedContentPaste(n.mixedContent,{isPlainPaste:s,sceneX:r,sceneY:o});return}if(n.spreadsheet&&!s){this.setState({pasteDialog:{data:n.spreadsheet,shown:!0}});return}const a=i.map(u=>u.file);if(a.length===0&&n.text&&!s){const u=n.text.trim();u.startsWith("<svg")&&u.endsWith("</svg>")&&a.push(MR(u))}if(a.length>0){this.isToolSupported("image")?await this.insertImages(a,r,o):this.setState({errorMessage:M("errors.imageToolNotSupported")});return}if(n.elements){const u=n.programmaticAPI?Mv(n.elements):n.elements;this.addElementsFromPasteOrLibrary({elements:u,files:n.files||null,position:vo()?"center":"cursor",retainSeed:s});return}if(!n.text)return;if(!s&&s7e(n.text)){const u=await ye(()=>import("./index-CicYZL9c.js").then(d=>d.b6),__vite__mapDeps([]));try{const{elements:d,files:f}=await u.parseMermaidToExcalidraw(n.text),h=Mv(d,{regenerateIds:!0});this.addElementsFromPasteOrLibrary({elements:h,files:f,position:vo()?"center":"cursor"});return}catch(d){console.warn(`parsing pasted text as mermaid definition failed: ${d.message}`)}}const l=kB(n.text).split(/\n+/).map(u=>u.trim()).filter(Boolean),c=l.map(u=>Qce(u)).filter(u=>{var d;return O2(u,this.props.validateEmbeddable)&&(/^(http|https):\/\/[^\s/$.?#].[^\s]*$/.test(u)||((d=jf(u))==null?void 0:d.type)==="video")});if(!s&&c.length>0&&c.length===l.length){const u=[];for(const d of c){const f=u[u.length-1],h=this.insertEmbeddableElement({sceneX:f?f.x+f.width+20:r,sceneY:o,link:Qs(d)});h&&u.push(h)}u.length&&(this.store.scheduleCapture(),this.setState({selectedElementIds:Object.fromEntries(u.map(d=>[d.id,!0]))}));return}this.addTextFromPaste(n.text,s)}async addElementsFromMixedContentPaste(n,{isPlainPaste:i,sceneX:s,sceneY:r}){if(!i&&n.some(o=>o.type==="imageUrl")&&this.isToolSupported("image")){const o=n.filter(u=>u.type==="imageUrl").map(u=>u.value),a=await Promise.all(o.map(async u=>{try{return{file:await X5e(u)}}catch(d){let f=d.message;return d.cause==="FETCH_ERROR"?f=M("errors.failedToFetchImage"):d.cause==="UNSUPPORTED"&&(f=M("errors.unsupportedFileType")),{errorMessage:f}}})),l=a.filter(u=>!!u.file).map(u=>u.file);await this.insertImages(l,s,r);const c=a.find(u=>!!u.errorMessage);c&&c.errorMessage&&this.setState({errorMessage:c.errorMessage})}else{const o=n.filter(a=>a.type==="text");o.length&&this.addTextFromPaste(o.map(a=>a.value).join(`

`),i)}}addTextFromPaste(n,i=!1){const{x:s,y:r}=Dt({clientX:this.lastViewportPosition.x,clientY:this.lastViewportPosition.y},this.state),o={x:s,y:r,strokeColor:this.state.currentItemStrokeColor,backgroundColor:this.state.currentItemBackgroundColor,fillStyle:this.state.currentItemFillStyle,strokeWidth:this.state.currentItemStrokeWidth,strokeStyle:this.state.currentItemStrokeStyle,roundness:null,roughness:this.state.currentItemRoughness,opacity:this.state.currentItemOpacity,text:n,fontSize:this.state.currentItemFontSize,fontFamily:this.state.currentItemFontFamily,textAlign:up,verticalAlign:zb,locked:!1},a=gt({fontSize:o.fontSize,fontFamily:o.fontFamily}),l=Oc(o.fontFamily),[c,,u]=zz(this.state),d=Math.max(Math.min((u-c)*.5,800),200),f=10;let h=r;const m=i?[n]:n.split(`
`),p=m.reduce((U,b,y)=>{var v;const w=Bh(b).trim();if(w.length){const I=this.getTopLayerFrameAtSceneCoords({x:s,y:h});let C=Xn(w,a,l);const _=C.width>d,T=_?iu(w,a,d):w;C=_?Xn(T,a,l):C;const k=s-C.width/2,S=h-C.height/2,R=nr({...o,x:k,y:S,text:T,originalText:w,lineHeight:l,autoResize:!_,frameId:I?I.id:null});U.push(R),h+=R.height+f}else((v=m[y-1])==null?void 0:v.trim())&&(h+=bp(o.fontSize,l)+f);return U},[]);p.length!==0&&(this.scene.insertElements(p),this.store.scheduleCapture(),this.setState({selectedElementIds:St(Object.fromEntries(p.map(U=>[U.id,!0])),this.state)}),!i&&p.length>1&&YD===!1&&!this.device.editor.isMobile&&(this.setToast({message:M("toast.pasteAsSingleElement",{shortcut:J("CtrlOrCmd+Shift+V")}),duration:5e3}),YD=!0))}handleTextWysiwyg(n,{isExistingElement:i=!1}){const s=this.scene.getElementsMapIncludingDeleted(),r=(o,a)=>{this.scene.replaceAllElements([...this.scene.getElementsIncludingDeleted().map(l=>l.id===n.id&&de(l)?Te(l,{originalText:o,isDeleted:a??l.isDeleted,...qz(l,jn(l,s),s,o)}):l)])};i7e({id:n.id,canvas:this.canvas,getViewportCoords:(o,a)=>{const{x:l,y:c}=Xs({sceneX:o,sceneY:a},this.state);return[l-this.state.offsetLeft,c-this.state.offsetTop]},onChange:on(o=>{r(o,!1),$4(n)&&Is(n,this.scene)}),onSubmit:on(({viaKeyboard:o,nextOriginalText:a})=>{const l=!a.trim();if(r(a,l),!l&&o){const c=n.containerId?n.containerId:n.id;hi.flushSync(()=>{this.setState(u=>({selectedElementIds:St({...u.selectedElementIds,[c]:!0},u)}))})}l&&Uz(this.scene.getNonDeletedElements(),[n]),(!l||i)&&this.store.scheduleCapture(),hi.flushSync(()=>{this.setState({newElement:null,editingTextElement:null})}),this.state.activeTool.locked&&_o(this.interactiveCanvas,this.state),this.focusContainer()}),element:n,excalidrawContainer:this.excalidrawContainerRef.current,app:this,autoSelect:!this.device.isTouchScreen}),this.deselectElements(),r(n.originalText,!1)}deselectElements(){this.setState({selectedElementIds:St({},this.state),selectedGroupIds:{},editingGroupId:null,activeEmbeddable:null})}getTextElementAtPosition(n,i){const s=this.getElementAtPosition(n,i,{includeBoundTextElement:!0});return s&&de(s)&&!s.isDeleted?s:null}getElementAtPosition(n,i,s){let r=[];if(s&&"allHitElements"in s?r=(s==null?void 0:s.allHitElements)||[]:r=this.getElementsAtPosition(n,i,{includeBoundTextElement:s==null?void 0:s.includeBoundTextElement,includeLockedElements:s==null?void 0:s.includeLockedElements}),r.length>1){if(s!=null&&s.preferSelected){for(let a=r.length-1;a>-1;a--)if(this.state.selectedElementIds[r[a].id])return r[a]}const o=r[r.length-1];return Ef({point:x(n,i),element:o,threshold:this.getElementHitThreshold(o)/2,elementsMap:this.scene.getNonDeletedElementsMap(),frameNameBound:Ee(o)?this.frameNameBoundsCache.get(o):null})?o:r[r.length-2]}return r.length===1?r[0]:null}getElementsAtPosition(n,i,s){const r=[],o=this.scene.getNonDeletedElementsMap();return(s!=null&&s.includeBoundTextElement&&(s!=null&&s.includeLockedElements)?this.scene.getNonDeletedElements():this.scene.getNonDeletedElements().filter(l=>((s==null?void 0:s.includeLockedElements)||!l.locked)&&((s==null?void 0:s.includeBoundTextElement)||!(de(l)&&l.containerId)))).filter(l=>this.hitElement(n,i,l)).filter(l=>{const c=Ss(l,o);return c&&this.state.frameRendering.enabled&&this.state.frameRendering.clip?KA({x:n,y:i},c,o):!0}).filter(l=>jl(l)?(r.push(l),!1):!0).concat(r)}getElementHitThreshold(n){return Math.max(n.strokeWidth/2+.1,.85*(cA/this.state.zoom.value))}hitElement(n,i,s,r=!0){return r&&this.state.selectedElementIds[s.id]&&aH([s],this.state)&&Z5(x(n,i),s,this.scene.getNonDeletedElementsMap(),this.getElementHitThreshold(s))||rz(x(n,i),s,this.scene.getNonDeletedElementsMap())?!0:Ef({point:x(n,i),element:s,threshold:this.getElementHitThreshold(s),elementsMap:this.scene.getNonDeletedElementsMap(),frameNameBound:Ee(s)?this.frameNameBoundsCache.get(s):null})}getTextBindableContainerAtPosition(n,i){const s=this.scene.getNonDeletedElements(),r=this.scene.getSelectedElements(this.state);if(r.length===1)return Zu(r[0],!1)?r[0]:null;let o=null;for(let a=s.length-1;a>=0;--a){if(s[a].isDeleted)continue;const[l,c,u,d]=ze(s[a],this.scene.getNonDeletedElementsMap());if(xe(s[a])&&Ef({point:x(n,i),element:s[a],elementsMap:this.scene.getNonDeletedElementsMap(),threshold:this.getElementHitThreshold(s[a])})){o=s[a];break}else if(l<n&&n<u&&c<i&&i<d){o=s[a];break}}return Zu(o,!1)?o:null}handleHoverSelectedLinearElement(n,i,s){const r=this.scene.getNonDeletedElementsMap(),o=pe.getElement(n.elementId,r);if(o)if(this.state.selectedLinearElement){let a=-1,l=null;Ef({point:x(i,s),element:o,elementsMap:r,threshold:this.getElementHitThreshold(o)})?(a=pe.getPointIndexUnderCursor(o,r,this.state.zoom,i,s),l=pe.getSegmentMidpointHitCoords(n,{x:i,y:s},this.state,this.scene.getNonDeletedElementsMap()),(ge(o)?a===0||a===o.points.length-1:a>=0)||l?Rt(this.interactiveCanvas,xt.POINTER):this.hitElement(i,s,o)&&(!ge(o)||!(o.startBinding||o.endBinding))&&(this.state.activeTool.type!=="lasso"||Object.keys(this.state.selectedElementIds).length>0)&&Rt(this.interactiveCanvas,xt.MOVE)):this.hitElement(i,s,o)&&(!ge(o)||!(o.startBinding||o.endBinding))&&(this.state.activeTool.type!=="lasso"||Object.keys(this.state.selectedElementIds).length>0)&&Rt(this.interactiveCanvas,xt.MOVE),this.state.selectedLinearElement.hoverPointIndex!==a&&this.setState({selectedLinearElement:{...this.state.selectedLinearElement,hoverPointIndex:a}}),pe.arePointsEqual(this.state.selectedLinearElement.segmentMidPointHoveredCoords,l)||this.setState({selectedLinearElement:{...this.state.selectedLinearElement,segmentMidPointHoveredCoords:l}})}else Rt(this.interactiveCanvas,xt.AUTO)}updateGestureOnPointerDown(n){pt.pointers.set(n.pointerId,{x:n.clientX,y:n.clientY}),pt.pointers.size===2&&(pt.lastCenter=rD(pt.pointers),pt.initialScale=this.state.zoom.value,pt.initialDistance=oD(Array.from(pt.pointers.values())))}initialPointerDownState(n){const i=Dt(n,this.state),s=this.scene.getSelectedElements(this.state),[r,o,a,l]=ft(s),c=s.findIndex(ge)===0;return{origin:i,withCmdOrCtrl:n[H.CTRL_OR_CMD],originInGrid:Ya(On(i.x,i.y,n[H.CTRL_OR_CMD]||c?null:this.getEffectiveGridSize())),scrollbars:mD(v1,n.clientX-this.state.offsetLeft,n.clientY-this.state.offsetTop),lastCoords:{...i},originalElements:this.scene.getNonDeletedElements().reduce((u,d)=>(u.set(d.id,zc(d)),u),new Map),resize:{handleType:!1,isResizing:!1,offset:{x:0,y:0},arrowDirection:"origin",center:{x:(a+r)/2,y:(l+o)/2}},hit:{element:null,allHitElements:[],wasAddedToSelection:!1,hasBeenDuplicated:!1,hasHitCommonBoundingBoxOfSelectedElements:this.isHittingCommonBoundingBoxOfSelectedElements(i,s)},drag:{hasOccurred:!1,offset:null,origin:{...i},blockDragging:!1},eventListeners:{onMove:null,onUp:null,onKeyUp:null,onKeyDown:null},boxSelection:{hasOccurred:!1}}}handleDraggingScrollBar(n,i){if(!(i.scrollbars.isOverEither&&!this.state.multiElement))return!1;F3=!0,i.lastCoords.x=n.clientX,i.lastCoords.y=n.clientY;const s=S3(o=>{o.target instanceof HTMLElement&&this.handlePointerMoveOverScrollbars(o,i)}),r=on(()=>{Uu=null,F3=!1,_o(this.interactiveCanvas,this.state),this.setState({cursorButton:"up"}),this.savePointer(n.clientX,n.clientY,"up"),window.removeEventListener(te.POINTER_MOVE,s),window.removeEventListener(te.POINTER_UP,r),s.flush()});return Uu=r,window.addEventListener(te.POINTER_MOVE,s),window.addEventListener(te.POINTER_UP,r),!0}isASelectedElement(n){return n!=null&&this.state.selectedElementIds[n.id]}isHittingCommonBoundingBoxOfSelectedElements(n,i){if(i.length<2)return!1;const s=Math.max(cA/this.state.zoom.value,1),[r,o,a,l]=ft(i);return n.x>r-s&&n.x<a+s&&n.y>o-s&&n.y<l+s}getCurrentItemRoundness(n){return this.state.currentItemRoundness==="round"?{type:Bd(n)?yn.ADAPTIVE_RADIUS:yn.PROPORTIONAL_RADIUS}:null}maybeCacheReferenceSnapPoints(n,i,s=!1){jc({event:n,app:this,selectedElements:i})&&(s||!Gr.getReferenceSnapPoints())&&Gr.setReferenceSnapPoints(v3e(this.scene.getNonDeletedElements(),i,this.state,this.scene.getNonDeletedElementsMap()))}maybeCacheVisibleGaps(n,i,s=!1){jc({event:n,app:this,selectedElements:i})&&(s||!Gr.getVisibleGaps())&&Gr.setVisibleGaps(E3e(this.scene.getNonDeletedElements(),i,this.state,this.scene.getNonDeletedElementsMap()))}onKeyDownFromPointerDownHandler(n){return on(i=>{this.maybeHandleResize(n,i)||this.maybeDragNewGenericElement(n,i)})}onKeyUpFromPointerDownHandler(n){return on(i=>{i.key===H.ALT&&i.preventDefault(),!this.maybeHandleResize(n,i)&&this.maybeDragNewGenericElement(n,i)})}onPointerMoveFromPointerDownHandler(n){return S3(i=>{var f,h,m,p,U,b,y,w;if(((f=this.state.openDialog)==null?void 0:f.name)==="elementLinkSelector")return;const s=Dt(i,this.state);if(this.state.activeLockedId&&this.setState({activeLockedId:null}),this.state.selectedLinearElement&&this.state.selectedLinearElement.elbowed&&this.state.selectedLinearElement.pointerDownState.segmentMidpoint.index){const[v,I]=On(s.x,s.y,i[H.CTRL_OR_CMD]?null:this.getEffectiveGridSize());let C=this.state.selectedLinearElement.pointerDownState.segmentMidpoint.index;if(C<0){const T=pe.getSegmentMidpointHitCoords({...this.state.selectedLinearElement,segmentMidPointHoveredCoords:null},{x:v,y:I},this.state,this.scene.getNonDeletedElementsMap());C=T?pe.getSegmentMidPointIndex(this.state.selectedLinearElement,this.state,T,this.scene.getNonDeletedElementsMap()):-1}const _=pe.moveFixedSegment(this.state.selectedLinearElement,C,v,I,this.scene);this.setState({selectedLinearElement:{...this.state.selectedLinearElement,segmentMidPointHoveredCoords:_.segmentMidPointHoveredCoords,pointerDownState:_.pointerDownState}});return}const r=this.lastPointerMoveCoords??n.origin;if(this.lastPointerMoveCoords=s,n.drag.offset===null&&(n.drag.offset=Ya(Oce(this.scene.getSelectedElements(this.state),n.origin.x,n.origin.y))),!(i.target instanceof HTMLElement)||this.handlePointerMoveOverScrollbars(i,n))return;if(Ao(this.state)){this.handleEraser(i,s);return}this.state.activeTool.type==="laser"&&this.laserTrails.addPointToPath(s.x,s.y);const[a,l]=On(s.x,s.y,i[H.CTRL_OR_CMD]?null:this.getEffectiveGridSize());if(!n.drag.hasOccurred&&(this.state.activeTool.type==="arrow"||this.state.activeTool.type==="line")&&at(x(s.x,s.y),x(n.origin.x,n.origin.y))*this.state.zoom.value<aA)return;if(n.resize.isResizing&&(n.lastCoords.x=s.x,n.lastCoords.y=s.y,this.maybeHandleCrop(n,i)||this.maybeHandleResize(n,i)))return!0;const c=this.scene.getNonDeletedElementsMap();if(this.state.selectedLinearElement){const v=this.state.selectedLinearElement;if(pe.shouldAddMidpoint(this.state.selectedLinearElement,s,this.state,c)){const C=pe.addMidpoint(this.state.selectedLinearElement,s,this,!i[H.CTRL_OR_CMD],this.scene);if(!C)return;hi.flushSync(()=>{this.state.selectedLinearElement&&this.setState({selectedLinearElement:{...this.state.selectedLinearElement,pointerDownState:C.pointerDownState,selectedPointsIndices:C.selectedPointsIndices,segmentMidPointHoveredCoords:null}})});return}else if(v.pointerDownState.segmentMidpoint.value!==null&&!v.pointerDownState.segmentMidpoint.added)return;const I=pe.handlePointDragging(i,this,s.x,s.y,v);if(I){n.lastCoords.x=s.x,n.lastCoords.y=s.y,n.drag.hasOccurred=!0,this.setState(I);return}}const u=n.hit.allHitElements.some(v=>this.isASelectedElement(v)),d=((h=this.state.selectedLinearElement)==null?void 0:h.isEditing)&&i.shiftKey&&this.state.selectedLinearElement.elementId===((m=n.hit.element)==null?void 0:m.id);if((u||n.hit.hasHitCommonBoundingBoxOfSelectedElements)&&!d&&!n.drag.blockDragging){const v=this.scene.getSelectedElements(this.state);if(v.length>0&&v.every(T=>T.locked))return;const I=v.find(T=>Ee(T)),C=this.getTopLayerFrameAtSceneCoords(s),_=C&&!I?C:null;if(this.state.frameToHighlight!==_&&hi.flushSync(()=>{this.setState({frameToHighlight:_})}),n.drag.hasOccurred=!0,this.state.activeTool.type==="lasso"&&this.lassoTrail.hasCurrentTrail&&!(vo()&&n.hit.element)&&!this.state.activeTool.fromSelection)return;if(this.state.activeTool.type==="lasso"&&v.length>0&&n.drag.hasOccurred&&!this.state.activeTool.fromSelection&&this.lassoTrail.endPath(),v.length>0&&!n.withCmdOrCtrl&&!this.state.editingTextElement&&((p=this.state.activeEmbeddable)==null?void 0:p.state)!=="active"){const T={x:s.x-n.drag.origin.x,y:s.y-n.drag.origin.y},k=[...n.originalElements.values()],S=i.shiftKey;if(S){const L=Math.abs(T.x),X=Math.abs(T.y),G=S&&L<X,z=S&&L>X;G&&(T.x=0),z&&(T.y=0)}if(this.state.croppingElementId){const L=this.scene.getNonDeletedElementsMap().get(this.state.croppingElementId);if(L&&yt(L)&&L.crop!==null&&n.hit.element===L){const X=L.crop,G=Dn(L)&&((U=this.imageCache.get(L.fileId))==null?void 0:U.image);if(G&&!(G instanceof Promise)){const z=In(pn(s.x-r.x,s.y-r.y),Math.max(this.state.zoom.value,2)),[V,$,j,W,Q,oe]=ze(L,c),me=ue(q(x(V,$),x(Q,oe),L.angle)),he=ue(q(x(j,$),x(Q,oe),L.angle)),Me=ue(q(x(V,W),x(Q,oe),L.angle)),mt=qs(Xb(he,me)),We=qs(Xb(Me,me)),Ht=pn(p0(z,mt),p0(z,We)),fn={...X,x:Ke(X.x-Ht[0]*Math.sign(L.scale[0]),0,G.naturalWidth-X.width),y:Ke(X.y-Ht[1]*Math.sign(L.scale[1]),0,G.naturalHeight-X.height)};this.scene.mutateElement(L,{crop:fn});return}}}this.maybeCacheVisibleGaps(i,v),this.maybeCacheReferenceSnapPoints(i,v);const{snapOffset:R,snapLines:P}=w3e(k,T,this,i,this.scene.getNonDeletedElementsMap());if(this.setState({snapLines:P}),this.state.editingFrame||Lce(n,v,T,this.scene,R,i[H.CTRL_OR_CMD]?null:this.getEffectiveGridSize()),this.setState({selectedElementsAreBeingDragged:!0,selectionElement:null}),(v.length!==1||!ge(v[0]))&&this.setState({suggestedBindings:R8(v,this.scene.getNonDeletedElementsMap(),this.state.zoom)}),i.altKey&&!n.hit.hasBeenDuplicated){n.hit.hasBeenDuplicated=!0;const L=this.scene.getElementsIncludingDeleted(),X=n.hit.element,G=this.scene.getSelectedElements({selectedElementIds:this.state.selectedElementIds,includeBoundTextElement:!0,includeElementsInFrames:!0});X&&n.hit.wasAddedToSelection&&!G.find(he=>he.id===X.id)&&G.push(X);const z=new Map(G.map(he=>[he.id,he])),{duplicatedElements:V,duplicateElementsMap:$,elementsWithDuplicates:j,origIdToDuplicateId:W}=E0({type:"in-place",elements:L,appState:this.state,randomizeSeed:!0,idsOfElementsToDuplicate:z,overrides:({duplicateElement:he,origElement:Me})=>({frameId:he.frameId??Me.frameId,seed:Rr()})});V.forEach(he=>{n.originalElements.set(he.id,zc(he))});const Q=j.map(he=>{if(z.has(he.id)){const Me=n.originalElements.get(he.id);if(Me)return Te(he,{x:Me.x,y:Me.y})}return he}),oe=(y=(b=this.props).onDuplicate)==null?void 0:y.call(b,Q,L),me=oo(oe||Q,ve(V));hi.flushSync(()=>{if(n.hit.element){const he=W.get(n.hit.element.id),Me=he&&$.get(he);n.hit.element=Me||null}n.hit.allHitElements=n.hit.allHitElements.reduce((he,Me)=>{const mt=W.get(Me.id),We=mt&&$.get(mt);return We&&he.push(We),he},[]),n.drag.origin=Dt(i,this.state),this.setState(he=>({..._z(V,this.scene.getNonDeletedElements(),he)})),this.scene.replaceAllElements(me),this.maybeCacheVisibleGaps(i,G,!0),this.maybeCacheReferenceSnapPoints(i,G,!0)})}return}}if(this.state.selectionElement){if(n.lastCoords.x=s.x,n.lastCoords.y=s.y,i.altKey){this.setActiveTool({type:"lasso",fromSelection:!0},i.shiftKey),this.lassoTrail.startPath(n.origin.x,n.origin.y,i.shiftKey),this.setAppState({selectionElement:null});return}this.maybeDragNewGenericElement(n,i)}else if(this.state.activeTool.type==="lasso")!i.altKey&&this.state.activeTool.fromSelection?(this.setActiveTool({type:"selection"}),this.createGenericElementOnPointerDown("selection",n),n.lastCoords.x=s.x,n.lastCoords.y=s.y,this.maybeDragNewGenericElement(n,i),this.lassoTrail.endPath()):this.lassoTrail.addPointToPath(s.x,s.y,i.shiftKey);else{const v=this.state.newElement;if(!v)return;if(v.type==="freedraw"){const I=v.points,C=s.x-v.x,_=s.y-v.y,T=I.length>0&&I[I.length-1];if(!(T&&T[0]===C&&T[1]===_)){const S=v.simulatePressure?v.pressures:[...v.pressures,i.pressure];this.scene.mutateElement(v,{points:[...I,x(C,_)],pressures:S},{informMutation:!1,isDragging:!1}),this.setState({newElement:v})}}else if(Se(v)){n.drag.hasOccurred=!0;const I=v.points;let C=a-v.x,_=l-v.y;g0(i)&&I.length===2&&({width:C,height:_}=k4(v.x,v.y,s.x,s.y)),I.length===1?this.scene.mutateElement(v,{points:[...I,x(C,_)]},{informMutation:!1,isDragging:!1}):(I.length===2||I.length>1&&ge(v))&&this.scene.mutateElement(v,{points:[...I.slice(0,-1),x(C,_)]},{isDragging:!0,informMutation:!1}),this.setState({newElement:v}),za(v,!1)&&this.setState({suggestedBindings:I4(v,[s],this.scene,this.state.zoom,this.state.startBoundElement)})}else n.lastCoords.x=s.x,n.lastCoords.y=s.y,this.maybeDragNewGenericElement(n,i,!1)}if(this.state.activeTool.type==="selection"){n.boxSelection.hasOccurred=!0;const v=this.scene.getNonDeletedElements();if((w=this.state.selectedLinearElement)!=null&&w.isEditing)pe.handleBoxSelection(i,this.state,this.setState.bind(this),this.scene.getNonDeletedElementsMap());else{let I=!0;!i.shiftKey&&Yn(v,this.state)&&(n.withCmdOrCtrl&&n.hit.element?this.setState(_=>Ii({..._,selectedElementIds:{[n.hit.element.id]:!0}},this.scene.getNonDeletedElements(),_,this)):I=!1);const C=this.state.selectionElement?c_(v,this.state.selectionElement,this.scene.getNonDeletedElementsMap(),!1):[];this.setState(_=>{const T={...I&&_.selectedElementIds,...C.reduce((k,S)=>(k[S.id]=!0,k),{})};return n.hit.element&&(C.length?delete T[n.hit.element.id]:T[n.hit.element.id]=!0),_=I?_:{..._,selectedGroupIds:{},editingGroupId:null},{...Ii({editingGroupId:_.editingGroupId,selectedElementIds:T},this.scene.getNonDeletedElements(),_,this),selectedLinearElement:C.length===1&&Se(C[0])?new pe(C[0],this.scene.getNonDeletedElementsMap()):null,showHyperlinkPopup:C.length===1&&(C[0].link||rs(C[0]))?"info":!1}})}}})}handlePointerMoveOverScrollbars(n,i){var s,r;if(i.scrollbars.isOverHorizontal){const o=n.clientX,a=o-i.lastCoords.x;return this.translateCanvas({scrollX:this.state.scrollX-a*(((s=v1.horizontal)==null?void 0:s.deltaMultiplier)||1)/this.state.zoom.value}),i.lastCoords.x=o,!0}if(i.scrollbars.isOverVertical){const o=n.clientY,a=o-i.lastCoords.y;return this.translateCanvas({scrollY:this.state.scrollY-a*(((r=v1.vertical)==null?void 0:r.deltaMultiplier)||1)/this.state.zoom.value}),i.lastCoords.y=o,!0}return!1}onPointerUpFromPointerDownHandler(n){return on(i=>{var y,w,v,I,C,_,T,k,S,R,P,L,X,G,z,V;this.removePointer(i),n.drag.blockDragging=!1,n.eventListeners.onMove&&n.eventListeners.onMove.flush();const{newElement:s,resizingElement:r,croppingElementId:o,multiElement:a,activeTool:l,isResizing:c,isRotating:u,isCropping:d}=this.state;this.setState($=>({isResizing:!1,isRotating:!1,isCropping:!1,resizingElement:null,selectionElement:null,frameToHighlight:null,elementsToHighlight:null,cursorButton:"up",snapLines:r1($.snapLines,[]),originSnapOffset:null})),this.lassoTrail.endPath(),this.lastPointerMoveCoords=null,Gr.setReferenceSnapPoints(null),Gr.setVisibleGaps(null),this.savePointer(i.clientX,i.clientY,"up");const f=n.hit.allHitElements,h=Dt({clientX:i.clientX,clientY:i.clientY},this.state);if(this.state.activeTool.type==="selection"&&!n.boxSelection.hasOccurred&&!n.resize.isResizing&&!f.some($=>this.state.selectedElementIds[$.id])){const $=this.getElementAtPosition(h.x,h.y,{includeLockedElements:!0});this.store.scheduleCapture(),$!=null&&$.locked?this.setState({activeLockedId:$.groupIds.length>0?$.groupIds.at(-1)||"":$.id}):this.setState({activeLockedId:null})}else this.setState({activeLockedId:null});this.setState({selectedElementsAreBeingDragged:!1});const m=this.scene.getNonDeletedElementsMap();if(n.drag.hasOccurred&&((w=(y=n.hit)==null?void 0:y.element)!=null&&w.id)){const $=m.get(n.hit.element.id);ro($)&&((v=$.boundElements)==null||v.filter(j=>j.type==="arrow").map(j=>m.get(j.id)).filter(j=>ge(j)).forEach(j=>{j&&this.scene.mutateElement(j,{})}))}if((I=this.state.selectedLinearElement)!=null&&I.isEditing)if(!n.boxSelection.hasOccurred&&((_=(C=n.hit)==null?void 0:C.element)==null?void 0:_.id)!==this.state.selectedLinearElement.elementId)this.actionManager.executeAction(Fr);else{const $=pe.handlePointerUp(i,this.state.selectedLinearElement,this.state,this.scene);$!==this.state.selectedLinearElement&&this.setState({selectedLinearElement:$,suggestedBindings:[]})}else if(this.state.selectedLinearElement){if(this.state.selectedLinearElement.elbowed){const $=pe.getElement(this.state.selectedLinearElement.elementId,this.scene.getNonDeletedElementsMap());$&&this.scene.mutateElement($,{})}((k=(T=n.hit)==null?void 0:T.element)==null?void 0:k.id)!==this.state.selectedLinearElement.elementId?this.scene.getSelectedElements(this.state).length>1&&this.setState({selectedLinearElement:null}):this.state.selectedLinearElement.isDragging&&this.actionManager.executeAction(Fr,"ui",{event:i,sceneCoords:h})}if(this.missingPointerEventCleanupEmitter.clear(),window.removeEventListener(te.POINTER_MOVE,n.eventListeners.onMove),window.removeEventListener(te.POINTER_UP,n.eventListeners.onUp),window.removeEventListener(te.KEYDOWN,n.eventListeners.onKeyDown),window.removeEventListener(te.KEYUP,n.eventListeners.onKeyUp),(R=(S=this.props)==null?void 0:S.onPointerUp)==null||R.call(S,l,n),this.onPointerUpEmitter.trigger(this.state.activeTool,n,i),(s==null?void 0:s.type)==="freedraw"){const $=Dt(i,this.state),j=s.points;let W=$.x-s.x,Q=$.y-s.y;W===j[0][0]&&Q===j[0][1]&&(Q+=1e-4,W+=1e-4);const oe=s.simulatePressure?[]:[...s.pressures,i.pressure];this.scene.mutateElement(s,{points:[...j,x(W,Q)],pressures:oe,lastCommittedPoint:x(W,Q)}),this.actionManager.executeAction(Fr);return}if(Se(s)){s.points.length>1&&this.store.scheduleCapture();const $=Dt(i,this.state),j=at(x($.x,$.y),x(n.origin.x,n.origin.y))*this.state.zoom.value;if((!n.drag.hasOccurred||j<aA)&&s&&!a)if(this.device.isTouchScreen){const W=Math.min(this.state.width*.7/this.state.zoom.value,100);this.scene.mutateElement(s,{x:s.x-W/2,points:[x(0,0),x(W,0)]},{informMutation:!1,isDragging:!1}),this.actionManager.executeAction(Fr)}else{const W=$.x-s.x,Q=$.y-s.y;this.scene.mutateElement(s,{points:[...s.points,x(W,Q)]},{informMutation:!1,isDragging:!1}),this.setState({multiElement:s,newElement:s})}else n.drag.hasOccurred&&!a&&(qu(this.state)&&za(s,!1)&&this.actionManager.executeAction(Fr,"ui",{event:i,sceneCoords:h}),this.setState({suggestedBindings:[],startBoundElement:null}),l.locked?this.setState(W=>({newElement:null})):(wo(this.interactiveCanvas),this.setState(W=>({newElement:null,activeTool:en(this.state,{type:this.state.preferredSelectionTool.type}),selectedElementIds:St({...W.selectedElementIds,[s.id]:!0},W),selectedLinearElement:new pe(s,this.scene.getNonDeletedElementsMap())}))),this.scene.triggerUpdate());return}if(de(s)){const $=K9(gt({fontSize:s.fontSize,fontFamily:s.fontFamily}),s.lineHeight);s.width<$&&this.scene.mutateElement(s,{autoResize:!0}),this.resetCursor(),this.handleTextWysiwyg(s,{isExistingElement:!0})}if(l.type!=="selection"&&s&&qa(s)){this.updateScene({elements:this.scene.getElementsIncludingDeleted().filter($=>$.id!==s.id),appState:{newElement:null},captureUpdate:K.NEVER});return}if(Ee(s)){const $=Gle(this.scene.getElementsIncludingDeleted(),s,this.scene.getNonDeletedElementsMap());this.scene.replaceAllElements(y0(this.scene.getElementsMapIncludingDeleted(),$,s,this.state))}if(s&&(this.scene.mutateElement(s,Hz(s),{informMutation:!1,isDragging:!1}),this.scene.triggerUpdate()),n.drag.hasOccurred){const $=Dt(i,this.state);if(this.state.selectedLinearElement&&this.state.selectedLinearElement.isDragging){const j=this.scene.getElement(this.state.selectedLinearElement.elementId);if(j!=null&&j.frameId){const W=Ss(j,m);W&&j&&(Fc(j,W,this.scene.getNonDeletedElementsMap())||(this.scene.mutateElement(j,{groupIds:[]}),ey([j],this.scene.getNonDeletedElementsMap()),this.scene.triggerUpdate()))}}else{const j=this.getTopLayerFrameAtSceneCoords($),W=this.scene.getSelectedElements(this.state);let Q=this.scene.getElementsMapIncludingDeleted();const oe=me=>{if(me.length>0){for(const he of me){const Me=he.groupIds.indexOf(this.state.editingGroupId);this.scene.mutateElement(he,{groupIds:he.groupIds.slice(0,Me)},{informMutation:!1,isDragging:!1})}Q.forEach(he=>{he.groupIds.length&&Ct(Q,he.groupIds[he.groupIds.length-1]).length<2&&this.scene.mutateElement(he,{groupIds:[]},{informMutation:!1,isDragging:!1})}),this.setState({editingGroupId:null})}};if(j&&!this.state.selectedElementIds[j.id]){const me=W.filter(he=>he.frameId!==j.id&&m6(he,Q,this.state));this.state.editingGroupId&&oe(me),Q=y0(Q,me,j,this.state)}else if(!j&&this.state.editingGroupId){const me=W.filter(he=>he.frameId&&!m6(he,Q,this.state));oe(me)}Q=Vh(Q,this.state,this),this.scene.replaceAllElements(Q)}}if(r&&this.store.scheduleCapture(),r&&qa(r)&&this.updateScene({elements:this.scene.getElementsIncludingDeleted().filter($=>$.id!==r.id),captureUpdate:K.NEVER}),n.resize.isResizing){let $=Vh(this.scene.getElementsIncludingDeleted(),this.state,this);const j=this.scene.getSelectedElements(this.state).filter(W=>Ee(W));for(const W of j)$=vg($,Go(this.scene.getElementsIncludingDeleted(),W,this.state,m),W,this);this.scene.replaceAllElements($)}const p=n.hit.element;((P=this.state.selectedLinearElement)==null?void 0:P.elementId)!==(p==null?void 0:p.id)&&Se(p)&&this.scene.getSelectedElements(this.state).length===1&&this.setState({selectedLinearElement:new pe(p,this.scene.getNonDeletedElementsMap())}),(!o||o&&(!p&&!d||p&&p.id!==o))&&this.finishImageCropping();const U=this.lastPointerDownEvent,b=this.lastPointerUpEvent||this.lastPointerMoveEvent;if(Ao(this.state)&&U&&b){if(this.eraserTrail.endPath(),at(x(U.clientX,U.clientY),x(b.clientX,b.clientY))===0){const j=Dt({clientX:b.clientX,clientY:b.clientY},this.state);this.getElementsAtPosition(j.x,j.y).forEach(Q=>this.elementsPendingErasure.add(Q.id))}this.eraseElements();return}else this.elementsPendingErasure.size&&this.restoreReadyToEraseElements();if(p&&!n.drag.hasOccurred&&!n.hit.wasAddedToSelection&&(!((L=this.state.selectedLinearElement)!=null&&L.isEditing)||!n.boxSelection.hasOccurred)&&this.state.activeTool.type!=="lasso"&&(i.shiftKey&&!((X=this.state.selectedLinearElement)!=null&&X.isEditing)?this.state.selectedElementIds[p.id]?o_(this.state,p)?this.setState($=>{const j={...$.selectedElementIds};for(const W of p.groupIds.flatMap(Q=>Ct(this.scene.getNonDeletedElements(),Q)))delete j[W.id];return{selectedGroupIds:{...$.selectedElementIds,...p.groupIds.map(W=>({[W]:!1})).reduce((W,Q)=>({...W,...Q}),{})},selectedElementIds:St(j,$)}}):(G=this.state.selectedLinearElement)!=null&&G.isDragging||this.setState($=>{const j={...$.selectedElementIds};delete j[p.id];const W=Ve(this.scene.getNonDeletedElements(),{selectedElementIds:j});return{...Ii({editingGroupId:$.editingGroupId,selectedElementIds:j},this.scene.getNonDeletedElements(),$,this),selectedLinearElement:W.length===1&&Se(W[0])?new pe(W[0],this.scene.getNonDeletedElementsMap()):$.selectedLinearElement}}):p.frameId&&this.state.selectedElementIds[p.frameId]?this.setState($=>{var W;const j={...$.selectedElementIds,[p.id]:!0};return delete j[p.frameId],(((W=this.scene.getElement(p.frameId))==null?void 0:W.groupIds)??[]).flatMap(Q=>Ct(this.scene.getNonDeletedElements(),Q)).forEach(Q=>{delete j[Q.id]}),{...Ii({editingGroupId:$.editingGroupId,selectedElementIds:j},this.scene.getNonDeletedElements(),$,this),showHyperlinkPopup:p.link||rs(p)?"info":!1}}):this.setState($=>({selectedElementIds:St({...$.selectedElementIds,[p.id]:!0},$)})):this.setState($=>{var j;return{...Ii({editingGroupId:$.editingGroupId,selectedElementIds:{[p.id]:!0}},this.scene.getNonDeletedElements(),$,this),selectedLinearElement:Se(p)&&((j=$.selectedLinearElement)==null?void 0:j.elementId)!==p.id?new pe(p,this.scene.getNonDeletedElementsMap()):$.selectedLinearElement}})),this.state.activeTool.type!=="lasso"&&!(p&&ge(p))&&!n.drag.hasOccurred&&!this.state.isResizing&&(p&&zae({point:x(n.origin.x,n.origin.y),element:p,elementsMap:m,threshold:this.getElementHitThreshold(p),frameNameBound:Ee(p)?this.frameNameBoundsCache.get(p):null},m)||!p&&n.hit.hasHitCommonBoundingBoxOfSelectedElements)){(z=this.state.selectedLinearElement)!=null&&z.isEditing?this.actionManager.executeAction(e2):this.setState({selectedElementIds:St({},this.state),selectedGroupIds:{},editingGroupId:null,activeEmbeddable:null}),Rt(this.interactiveCanvas,xt.AUTO);return}if(!l.locked&&l.type!=="freedraw"&&s&&this.setState($=>({selectedElementIds:St({...$.selectedElementIds,[s.id]:!0},$),showHyperlinkPopup:rs(s)&&!s.link?"editor":$.showHyperlinkPopup})),(l.type!=="selection"||Yn(this.scene.getNonDeletedElements(),this.state)||!Wi(this.state.previousSelectedElementIds,this.state.selectedElementIds))&&this.store.scheduleCapture(),n.drag.hasOccurred&&!this.state.selectedLinearElement||c||u||d){const $=this.scene.getSelectedElements(this.state).filter(Se);c6($,qu(this.state),((V=this.state.selectedLinearElement)==null?void 0:V.selectedPointsIndices)??[],this.scene,this.state.zoom)}if(l.type==="laser"){this.laserTrails.endPath();return}!l.locked&&l.type!=="freedraw"&&(l.type!=="lasso"||l.type==="lasso"&&l.fromSelection)?(wo(this.interactiveCanvas),this.setState({newElement:null,suggestedBindings:[],activeTool:en(this.state,{type:this.state.preferredSelectionTool.type})})):this.setState({newElement:null,suggestedBindings:[]}),p&&this.lastPointerUpEvent&&this.lastPointerDownEvent&&this.lastPointerUpEvent.timeStamp-this.lastPointerDownEvent.timeStamp<300&&pt.pointers.size<=1&&pr(p)&&this.isIframeLikeElementCenter(p,this.lastPointerUpEvent,n.origin.x,n.origin.y)&&this.handleEmbeddableCenterClick(p)})}clearSelection(n){this.setState(i=>({selectedElementIds:St({},i),activeEmbeddable:null,selectedGroupIds:{},editingGroupId:i.editingGroupId&&n!=null&&cm(n,i.editingGroupId)?i.editingGroupId:null})),this.setState({selectedElementIds:St({},this.state),activeEmbeddable:null,previousSelectedElementIds:this.state.selectedElementIds})}getTextWysiwygSnappedToCenterPosition(n,i,s,r){if(r){let o=r.x+r.width/2,a=r.y+r.height/2;const l=M8(r,s,this.scene.getNonDeletedElementsMap());if(l&&(o=l.x,a=l.y),Math.hypot(n-o,i-a)<yse){const{x:d,y:f}=Xs({sceneX:o,sceneY:a},s);return{viewportX:d,viewportY:f,elementCenterX:o,elementCenterY:a}}}}getCanvasOffsets(){var n;if((n=this.excalidrawContainerRef)!=null&&n.current){const i=this.excalidrawContainerRef.current,{left:s,top:r}=i.getBoundingClientRect();return{offsetLeft:s,offsetTop:r}}return{offsetLeft:0,offsetTop:0}}async updateLanguage(){const n=oy.find(i=>i.code===this.props.langCode)||Hd;await dV(n),this.setAppState({})}}const Hve=e=>{const[t,n]=D.useState(!0);return D.useEffect(()=>{const i=async()=>{await dV(s),n(!1)},s=oy.find(r=>r.code===e.langCode)||Hd;i()},[e.langCode]),t?g(dj,{theme:e.theme}):e.children},wY=({children:e})=>{const{FooterCenterTunnel:t}=Ji(),n=wi();return g(t.In,{children:g("div",{className:re("footer-center zen-mode-transition",{"layer-ui__wrapper__footer-left--transition-bottom":n.zenModeEnabled}),children:e})})};wY.displayName="FooterCenter";const _Y=({isCollaborating:e,onSelect:t,...n})=>{const i=wi(),s=vo()||i.width<aB;return N(Xc,{...n,className:re("collab-button",{active:e}),type:"button",onSelect:t,style:{position:"relative",width:s?void 0:"auto"},title:M("labels.liveCollaboration"),children:[s?H_:M("labels.share"),i.collaborators.size>0&&g("div",{className:"CollabButton-collaborators",children:i.collaborators.size})]})};_Y.displayName="LiveCollaborationTrigger";const Vve=()=>g("svg",{viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"ExcalidrawLogo-icon",children:g("path",{d:"M39.9 32.889a.326.326 0 0 0-.279-.056c-2.094-3.083-4.774-6-7.343-8.833l-.419-.472a.212.212 0 0 0-.056-.139.586.586 0 0 0-.167-.111l-.084-.083-.056-.056c-.084-.167-.28-.278-.475-.167-.782.39-1.507.973-2.206 1.528-.92.722-1.842 1.445-2.708 2.25a8.405 8.405 0 0 0-.977 1.028c-.14.194-.028.361.14.444-.615.611-1.23 1.223-1.843 1.861a.315.315 0 0 0-.084.223c0 .083.056.166.111.194l1.09.833v.028c1.535 1.528 4.244 3.611 7.12 5.861.418.334.865.667 1.284 1 .195.223.39.473.558.695.084.11.28.139.391.055.056.056.14.111.196.167a.398.398 0 0 0 .167.056.255.255 0 0 0 .224-.111.394.394 0 0 0 .055-.167c.029 0 .028.028.056.028a.318.318 0 0 0 .224-.084l5.082-5.528a.309.309 0 0 0 0-.444Zm-14.63-1.917a.485.485 0 0 0 .111.14c.586.5 1.2 1 1.843 1.555l-2.569-1.945-.251-.166c-.056-.028-.112-.084-.168-.111l-.195-.167.056-.056.055-.055.112-.111c.866-.861 2.346-2.306 3.1-3.028-.81.805-2.43 3.167-2.095 3.944Zm8.767 6.89-2.122-1.612a44.713 44.713 0 0 0-2.625-2.5c1.145.861 2.122 1.611 2.262 1.75 1.117.972 1.06.806 1.815 1.445l.921.666a1.06 1.06 0 0 1-.251.25Zm.558.416-.056-.028c.084-.055.168-.111.252-.194l-.196.222ZM1.089 5.75c.055.361.14.722.195 1.056.335 1.833.67 3.5 1.284 4.75l.252.944c.084.361.223.806.363.917 1.424 1.25 3.602 3.11 5.947 4.889a.295.295 0 0 0 .363 0s0 .027.028.027a.254.254 0 0 0 .196.084.318.318 0 0 0 .223-.084c2.988-3.305 5.221-6.027 6.813-8.305.112-.111.14-.278.14-.417.111-.111.195-.25.307-.333.111-.111.111-.306 0-.39l-.028-.027c0-.055-.028-.139-.084-.167-.698-.666-1.2-1.138-1.731-1.638-.922-.862-1.871-1.75-3.881-3.75l-.028-.028c-.028-.028-.056-.056-.112-.056-.558-.194-1.703-.389-3.127-.639C6.087 2.223 3.21 1.723.614.944c0 0-.168 0-.196.028l-.083.084c-.028.027-.056.055-.224.11h.056-.056c.028.167.028.278.084.473 0 .055.112.5.112.555l.782 3.556Zm15.496 3.278-.335-.334c.084.112.196.195.335.334Zm-3.546 4.666-.056.056c0-.028.028-.056.056-.056Zm-2.038-10c.168.167.866.834 1.033.973-.726-.334-2.54-1.167-3.379-1.445.838.167 1.983.334 2.346.472ZM1.424 2.306c.419.722.754 3.222 1.089 5.666-.196-.778-.335-1.555-.503-2.278-.251-1.277-.503-2.416-.838-3.416.056 0 .14 0 .252.028Zm-.168-.584c-.112 0-.223-.028-.307-.028 0-.027 0-.055-.028-.055.14 0 .223.028.335.083Zm-1.089.222c0-.027 0-.027 0 0ZM39.453 1.333c.028-.11-.558-.61-.363-.639.42-.027.42-.666 0-.666-.558.028-1.144.166-1.675.25-.977.194-1.982.389-2.96.61-2.205.473-4.383.973-6.561 1.557-.67.194-1.424.333-2.066.666-.224.111-.196.333-.084.472-.056.028-.084.028-.14.056-.195.028-.363.056-.558.083-.168.028-.252.167-.224.334 0 .027.028.083.028.11-1.173 1.556-2.485 3.195-3.909 4.945-1.396 1.611-2.876 3.306-4.356 5.056-4.719 5.5-10.052 11.75-15.943 17.25a.268.268 0 0 0 0 .389c.028.027.056.055.084.055-.084.084-.168.14-.252.222-.056.056-.084.111-.084.167a.605.605 0 0 0-.111.139c-.112.111-.112.305.028.389.111.11.307.11.39-.028.029-.028.029-.056.056-.056a.44.44 0 0 1 .615 0c.335.362.67.723.977 1.028l-.698-.583c-.112-.111-.307-.083-.39.028-.113.11-.085.305.027.389l7.427 6.194c.056.056.112.056.196.056s.14-.028.195-.084l.168-.166c.028.027.083.027.111.027.084 0 .14-.027.196-.083 10.052-10.055 18.15-17.639 27.42-24.417.083-.055.111-.166.111-.25.112 0 .196-.083.251-.194 1.704-5.194 2.039-9.806 2.15-12.083v-.028c0-.028.028-.056.028-.083.028-.056.028-.084.028-.084a1.626 1.626 0 0 0-.111-1.028ZM21.472 9.5c.446-.5.893-1.028 1.34-1.5-2.876 3.778-7.65 9.583-14.408 16.5 4.607-5.083 9.242-10.333 13.068-15ZM5.193 35.778h.084-.084Zm3.462 3.194c-.027-.028-.027-.028 0-.028v.028Zm4.16-3.583c.224-.25.448-.472.699-.722 0 0 0 .027.028.027-.252.223-.475.445-.726.695Zm1.146-1.111c.14-.14.279-.334.446-.5l.028-.028c1.648-1.694 3.351-3.389 5.082-5.111l.028-.028c.419-.333.921-.694 1.368-1.028a379.003 379.003 0 0 0-6.952 6.695ZM24.794 6.472c-.921 1.195-1.954 2.778-2.82 4.028-2.736 3.944-11.532 13.583-11.727 13.75a1976.983 1976.983 0 0 1-8.042 7.639l-.167.167c-.14-.167-.14-.417.028-.556C14.49 19.861 22.03 10.167 25.074 5.917c-.084.194-.14.36-.28.555Zm4.83 5.695c-1.116-.64-1.646-1.64-1.34-2.611l.084-.334c.028-.083.084-.194.14-.277.307-.5.754-.917 1.257-1.167.027 0 .055 0 .083-.028-.028-.056-.028-.139-.028-.222.028-.167.14-.278.335-.278.335 0 1.369.306 1.76.639.111.083.223.194.335.305.14.167.363.445.474.667.056.028.112.306.196.445.056.222.111.472.084.694-.028.028 0 .194-.028.194a2.668 2.668 0 0 1-.363 1.028c-.028.028-.028.056-.056.084l-.028.027c-.14.223-.335.417-.53.556-.643.444-1.369.583-2.095.389 0 0-.195-.084-.28-.111Zm8.154-.834a39.098 39.098 0 0 1-.893 3.167c0 .028-.028.083 0 .111-.056 0-.084.028-.14.056-2.206 1.61-4.356 3.305-6.506 5.028 1.843-1.64 3.686-3.306 5.613-4.945.558-.5.949-1.139 1.06-1.861l.28-1.667v-.055c.14-.334.67-.195.586.166Z",fill:"currentColor"})}),$ve=()=>N("svg",{viewBox:"0 0 450 55",xmlns:"http://www.w3.org/2000/svg",fill:"none",className:"ExcalidrawLogo-text",children:[g("path",{d:"M429.27 96.74c2.47-1.39 4.78-3.02 6.83-4.95 1.43-1.35 2.73-2.86 3.81-4.51-.66.9-1.4 1.77-2.23 2.59-2.91 2.84-5.72 5.09-8.42 6.87h.01ZM343.6 69.36c.33 3.13.58 6.27.79 9.4.09 1.37.18 2.75.25 4.12-.12-4.46-.27-8.93-.5-13.39-.11-2.08-.24-4.16-.4-6.24-.06 1.79-.11 3.85-.13 6.11h-.01ZM378.47 98.34c.01-.37.07-1.13.01-6.51-.11 1.9-.22 3.81-.31 5.71-.07 1.42-.22 2.91-.16 4.35.39.03.78.07 1.17.1-.92-.85-.76-2.01-.72-3.66l.01.01ZM344.09 86.12c-.09-2.41-.22-4.83-.39-7.24v12.21c.15-.05.32-.09.47-.14.05-1.61-.03-3.23-.09-4.83h.01ZM440.69 66.79c-.22-.34-.45-.67-.69-.99-3.71-4.87-9.91-7.14-15.65-8.55-1.05-.26-2.12-.49-3.18-.71 2.29.59 4.48 1.26 6.64 2.02 7.19 2.54 10.57 5.41 12.88 8.23ZM305.09 72.46l1.2 3.6c.84 2.53 1.67 5.06 2.46 7.61.24.78.5 1.57.73 2.36.22-.04.44-.08.67-.12a776.9 776.9 0 0 1-5.01-13.57c-.02.04-.03.09-.05.13v-.01ZM345.49 90.25v.31c1.48-.42 3.05-.83 4.66-1.2-1.56.25-3.12.52-4.66.89ZM371.02 90.22c0-.57-.04-1.14-.11-1.71-.06-.02-.12-.04-.19-.05-.21-.05-.43-.08-.65-.11.42.16.74.88.95 1.87ZM398.93 54.23c-.13 0-.27-.01-.4-.02l.03.4c.11-.15.23-.27.37-.38ZM401.57 62.28v-.15c-1.22-.24-2.86-.61-3.23-1.25-.09-.15-.18-.51-.27-.98-.09.37-.2.73-.33 1.09 1.24.56 2.52.98 3.83 1.29ZM421.73 88.68c-2.97 1.65-6.28 3.12-9.69 3.68v.18c4.72-.14 11.63-3.85 16.33-8.38-2.04 1.75-4.33 3.24-6.63 4.53l-.01-.01ZM411.28 80.92c-.05-1.2-.09-2.4-.15-3.6-.21 5.66-.46 11.38-.47 14.51.24-.02.48-.04.71-.07.15-3.61.05-7.23-.09-10.83v-.01Z",transform:"translate(-144.023 -51.76)"}),g("path",{d:"M425.38 67.41c-3.5-1.45-7.19-2.57-14.06-3.62.09 1.97.06 4.88-.03 8.12.03.04.06.09.06.15.19 1.36.28 2.73.37 4.1.25 3.77.39 7.55.41 11.33 0 1.38-.01 2.76-.07 4.13 1.4-.25 2.78-.65 4.12-1.15 4.07-1.5 7.94-3.78 11.28-6.54 2.33-1.92 5.13-4.49 5.88-7.58.63-3.53-2.45-6.68-7.97-8.96l.01.02ZM411.35 92.53v-.06l-.34.03c.11.01.22.03.34.03ZM314.26 64.06c-.23-.59-.47-1.17-.7-1.75.57 1.62 1.11 3.25 1.6 4.9l.15.54 2.35 6.05c.32.82.66 1.64.98 2.46-1.38-4.1-2.83-8.17-4.39-12.2h.01ZM156.82 103.07c-.18.13-.38.23-.58.33 1.32-.03 2.66-.2 3.93-.34.86-.09 1.72-.22 2.58-.33-2.12.1-4.12.17-5.94.34h.01ZM210.14 68.88s.03.04.05.07c.18-.31.39-.64.58-.96-.21.3-.42.6-.64.89h.01ZM201.65 82.8c-.5.77-1.02 1.56-1.49 2.37 1.11-1.55 2.21-3.1 3.2-4.59-.23.23-.49.51-.75.79-.32.47-.65.95-.96 1.43ZM194.03 98.66c-.33-.4-.65-.84-1.05-1.17-.24-.2-.07-.49.17-.56-.23-.26-.42-.5-.63-.75 1.51-2.55 3.93-5.87 6.4-9.28-.17-.08-.29-.28-.2-.49.04-.09.09-.17.13-.26-1.21 1.78-2.42 3.55-3.61 5.33-.87 1.31-1.74 2.64-2.54 4-.29.5-.63 1.04-.87 1.61.81.65 1.63 1.27 2.47 1.88-.09-.11-.18-.21-.27-.32v.01ZM307.79 82.93c-1-3.17-2.05-6.32-3.1-9.48-1.62 4.08-3.69 9.17-6.16 15.19 3.32-1.04 6.77-1.87 10.27-2.5-.32-1.08-.67-2.15-1.01-3.21ZM149.5 80.7c.05-1.71.04-3.43 0-5.14-.1 2.26-.16 4.51-.22 6.77-.02.73-.03 1.46-.04 2.19.14-1.27.2-2.55.24-3.82h.02ZM228.98 98.3c.39 1.25.91 3.03.94 3.91.06-.03.12-.07.17-.1.08-1.29-.55-2.65-1.11-3.81ZM307.72 53.36c.81.5 1.53 1.04 2.07 1.49-.38-.8-.78-1.58-1.21-2.35-.17.03-.34.06-.51.11-.43.12-.86.26-1.29.41.35-.01.53.1.94.34ZM283.69 96.14c3.91-7.25 6.89-13.35 8.88-18.15l1.1-2.66c-1.27 2.64-2.56 5.27-3.83 7.9-1.53 3.15-3.06 6.31-4.58 9.47-.87 1.81-1.76 3.62-2.54 5.47.04.02.07.04.11.07.05.05.1.09.15.14.05-.73.27-1.48.71-2.24ZM289.92 103.23s-.04.01-.05.03c0-.02.04-.03.05-.04.05-.05.11-.1.16-.15l.21-.21c-.55 0-1.5-.27-2.55-.72.4.26.8.51 1.22.74.24.13.48.26.73.37.05.02.1.03.14.05a.27.27 0 0 1 .08-.07h.01ZM269.23 68.49c-.39-.19-.82-.48-1.33-.87-3.06-1.56-6.31-2.78-9.36-2.35-3.5.49-5.7 1.11-7.74 2.44 5.71-2.6 12.82-2.07 18.44.79l-.01-.01ZM177.87 53.69l1.06.03c-.96-.22-2-.25-2.89-.3-4.95-.26-9.99.33-14.86 1.19-2.44.43-4.88.95-7.28 1.59 9.09-1.76 15.69-2.77 23.97-2.51ZM219.85 55.51c-.18.12-.36.27-.56.45-.45.53-.86 1.11-1.26 1.66-1.91 2.61-3.71 5.31-5.57 7.95l-.12.18 8.05-10.11c-.18-.05-.36-.1-.55-.13h.01ZM510.71 54.1c.12-.15.29-.3.53-.45.69-.4 3.72-.63 5.87-.74-.36-.02-.73-.04-1.09-.05-1.84-.03-3.67.09-5.49.35.05.3.12.59.18.88v.01ZM510.76 86.02c1.37-3.07 2.49-6.27 3.57-9.46.55-1.64 1.12-3.3 1.6-4.97-1.59 4.01-3.67 9.14-6.2 15.3.24-.08.5-.14.74-.22.1-.22.19-.44.29-.65ZM566.95 75.76c.11-.02.23.03.31.11-.05-.13-.09-.26-.14-.39-.05.09-.11.18-.17.28ZM511.33 86.41c3.08-.89 6.24-1.62 9.46-2.14-1.51-3.98-2.98-7.96-4.39-11.87-.05.15-.09.31-.14.46-1.02 3.32-2.15 6.61-3.39 9.85-.48 1.25-.98 2.49-1.53 3.7h-.01ZM578.24 74.45c.11-.44.23-.87.35-1.31-.31.7-.64 1.39-.97 2.08.09.21.19.4.28.61.12-.46.23-.92.35-1.38h-.01ZM520.62 53.11c-.09 0-.18-.01-.28-.02.38.34.29 1.08.93 2.53l6.65 17.15c2.2 5.68 4.69 11.36 7.41 16.87l1.06 2.17c-2.95-7.05-5.92-14.08-8.87-21.13-1.58-3.79-3.16-7.59-4.7-11.4-.78-1.92-1.73-3.89-2.25-5.91-.03-.1 0-.19.04-.26h.01ZM578.78 77.87c1.45-5.77 3.07-10.43 3.58-13.36.05-.34.16-.88.31-1.55-.67 1.79-1.37 3.56-2.08 5.33-.12.43-.23.86-.35 1.29-.65 2.43-1.29 4.86-1.9 7.3.14.33.29.65.43 1l.01-.01ZM545.3 94.66c.02-.44.03-.83.05-1.12.02-1.01.05-2.02.11-3.02.03-6.66-.46-14.33-1.46-22.8-.13-.42-.27-1.24-.56-2.89 0-.02 0-.04-.01-.06.62 6.61.95 13.25 1.32 19.87.17 3.08.33 6.16.52 9.23.02.25.03.52.04.78l-.01.01ZM580.77 102.81c.13.2.27.38.37.49.27-.11.53-.22.8-.32-.43.09-.82.05-1.17-.16v-.01ZM530.48 104.07h.33c-.36-.13-.71-.32-1.04-.56.14.24.3.47.45.7.06-.08.14-.13.26-.13v-.01ZM542.63 58.82c.06.23.11.47.15.71.14-.33.36-.62.7-.86-.28.05-.57.11-.85.15ZM583.81 57.87c.15-.7.29-1.41.42-2.11-.14.45-.28.9-.42 1.34-.46 1.44-.89 2.89-1.31 4.34.44-1.19.88-2.37 1.31-3.57ZM523.62 91.48c-4.66 1.17-9.05 2.89-14.02 5.27 4.65-1.84 9.48-3.29 14.28-4.63-.09-.22-.17-.41-.26-.64ZM460.64 78.3c-.04-2.9-.11-5.81-.28-8.71-.1-1.68-.17-3.43-.5-5.09-.07.02-.14.03-.2.05.3 6.54.45 12.17.51 17.12.17-.07.34-.14.51-.2 0-1.06-.01-2.11-.03-3.17h-.01ZM470.63 63.24c-3.38-.26-6.81.32-10.1 1.1.41 2.01.47 4.14.57 6.18.18 3.55.25 7.11.27 10.67 3.31-1.38 6.5-3.12 9.3-5.35 1.96-1.56 3.86-3.41 5.02-5.66.73-1.41 1.19-3.22.26-4.65-1.09-1.7-3.46-2.14-5.32-2.29ZM460.29 63.68c1-.24 2.01-.46 3.04-.65-1.15.16-2.37.38-3.71.69v.13c.07-.02.15-.04.22-.05.11-.13.3-.18.45-.11v-.01ZM457.24 100.96c.43-.03.86-.07 1.29-.11.14-.49.27-.99.38-1.49-.44.7-1 1.23-1.67 1.6ZM482.88 104.98c-.18.23-.36.38-.55.47.14.09.27.19.4.28a70.76 70.76 0 0 0 4.37-4.63c.76-.89 1.52-1.81 2.19-2.77-.3-.27-.61-.53-.92-.79-.07 1.94-4.62 6.32-5.49 7.45v-.01Z",transform:"translate(-144.023 -51.76)"}),g("path",{d:"M474.36 63.31c-.4-.16-.84-.27-1.29-.37 1.56.42 3.08 1.22 3.76 2.74.62 1.4.32 2.95-.28 4.32.7-1.22.94-2.34.74-3.47-.24-1.33-1.19-2.54-2.93-3.21v-.01ZM477.34 89.18c-1.2-.81-2.4-1.62-3.6-2.42-.14.1-.26.19-.4.29 1.4.67 2.73 1.39 4 2.13ZM465.88 93.85c.37.25.74.5 1.1.75.46.32.92.65 1.38.97-1.57-1.2-2.01-1.61-2.49-1.72h.01ZM574.92 90.06c-2.28-5.21-4.93-11.13-5.67-12.26-.1-.15-1.57-3.01-1.63-3.08 0 0-.01.02-.02.02.4 1.37 1.09 2.69 1.65 3.99 2.14 4.95 4.36 9.86 6.67 14.73.6 1.26 1.21 2.52 1.83 3.78-.75-2.01-1.64-4.45-2.83-7.18ZM448.73 65.29c.1.2.22.38.34.57.22-.02.43-.06.65-.08v-.08c-.14-.05-.25 0-.99-.41ZM460.16 94.81c-.02.31-.06.59-.1.89-.03 1.71-.33 3.43-.79 5.07.15-.02.3-.03.45-.05.01-.04.02-.08.03-.11.09-.34.15-.69.2-1.03.17-1.07.25-2.16.33-3.24.05-.69.08-1.39.12-2.08-.27.1-.27.26-.24.57v-.02Z",transform:"translate(-144.023 -51.76)"}),g("path",{d:"m328.67 98.12-3.22-6.58c-1.29-2.63-2.53-5.29-3.72-7.97-.25-.85-.52-1.69-.79-2.53-.81-2.57-1.67-5.12-2.55-7.67-1.92-5.53-3.9-11.08-6.32-16.41-.72-1.58-1.46-3.44-2.63-4.79-.03-.17-.16-.29-.34-.36a.282.282 0 0 0-.23-.04c-.06-.01-.12 0-.18.01-.74.06-1.5.38-2.19.61-2.22.77-4.4 1.64-6.63 2.38-.03-.08-.06-.16-.09-.25-.15-.42-.82-.24-.67.19.03.09.07.19.1.28l-.18.06c-.36.11-.28.6 0 .68.18 1.18.63 2.36.98 3.49.03.09.06.17.08.26-.08.23-.17.46-.24.64-.37.98-.79 1.94-1.21 2.9-1.27 2.89-2.62 5.75-3.98 8.6-3.18 6.67-6.44 13.31-9.64 19.97-1.08 2.25-2.2 4.5-3.15 6.81-.13.32.24.5.5.37 1.34 1.33 2.84 2.5 4.4 3.57.65.44 1.31.87 2.01 1.24.4.22.86.48 1.33.5.24.01.35-.19.33-.37.11-.1.21-.21.28-.28.41-.41.81-.84 1.2-1.26.85-.92 1.69-1.87 2.5-2.84 6.31-2.34 12.6-4.31 18.71-5.84 2.14 5.3 3.43 8.43 3.97 9.58.55 1.05 1.15 1.88 1.82 2.52 1.32.56 6.96-.03 9.23-1.96.87-1.28 1.19-2.67.93-4.15-.09-.5-.22-.95-.4-1.33l-.01-.03Zm-20.09-45.61c.43.77.83 1.56 1.21 2.35-.54-.45-1.27-.99-2.07-1.49-.42-.24-.6-.35-.94-.34.43-.15.85-.29 1.29-.41.17-.05.34-.08.51-.11Zm-25.86 45.66c.78-1.85 1.67-3.66 2.54-5.47 1.51-3.16 3.05-6.31 4.58-9.47 1.28-2.63 2.56-5.26 3.83-7.9l-1.1 2.66c-1.99 4.79-4.97 10.9-8.88 18.15-.43.76-.66 1.51-.71 2.24-.05-.05-.1-.09-.15-.14a.259.259 0 0 0-.11-.07Zm6.24 4.71c-.42-.23-.82-.48-1.22-.74 1.05.45 2 .72 2.55.72l-.21.21c-.05.05-.11.1-.16.15-.01.01-.04.03-.05.04 0-.02.03-.02.05-.03a.27.27 0 0 0-.08.07c-.05-.02-.1-.03-.14-.05-.25-.1-.49-.24-.73-.37h-.01Zm15.73-29.43c1.05 3.15 2.1 6.31 3.1 9.48.34 1.06.69 2.13 1.01 3.21-3.5.63-6.95 1.46-10.27 2.5 2.48-6.03 4.54-11.11 6.16-15.19Zm4.79 12.57c-.23-.79-.49-1.58-.73-2.36-.79-2.54-1.63-5.08-2.46-7.61l-1.2-3.6c.02-.04.04-.09.05-.13 1.6 4.45 3.28 9 5.01 13.57l-.67.12v.01Zm5.83-18.27-.15-.54c-.49-1.64-1.03-3.28-1.6-4.9.23.58.47 1.17.7 1.75 1.56 4.03 3.01 8.1 4.39 12.2-.33-.82-.67-1.64-.98-2.46l-2.35-6.05h-.01ZM390.43 79.37c-.13-10.43-.22-17.5-.24-19.97-.24-1.6.21-2.88-.65-3.65-.14-.13-.32-.23-.52-.32h.03c.45 0 .45-.69 0-.7-1.75-.03-3.5-.04-5.25-.14-1.38-.08-2.76-.21-4.15-.31-.07 0-.12.01-.17.04-.21-.07-.47.03-.45.31l.03.45c-.11.14-.19.3-.22.5-.21 1.26-.32 13.67-.36 23.59-.32 5.79-.67 11.57-.97 17.36-.09 1.73-.29 3.54-.21 5.3-.39.02-.38.64.04.69v.12c.05.44.74.45.7 0v-.06c1.1.09 2.2.21 3.3.3 1.14.19 2.44.2 3.29.17 1.73-.05 2.92-.05 3.8-.37.45-.05.9-.11 1.35-.17.44-.06.25-.73-.19-.67h-.01c.24-.32.45-.72.62-1.25.66-1.84.41-6.36.34-11.33l-.13-9.9.02.01Zm-12.26 18.17c.09-1.91.2-3.81.31-5.71.06 5.38 0 6.14-.01 6.51-.05 1.65-.21 2.81.72 3.66-.39-.04-.78-.07-1.17-.1-.06-1.44.09-2.93.16-4.35l-.01-.01ZM588.97 53.85c-2.06-.25-3.17-.51-3.76-.6a.3.3 0 0 1 .04-.08c.22-.39-.39-.75-.6-.35-.56 1.02-.9 2.19-1.26 3.29-.61 1.88-1.17 3.78-1.72 5.68-.63 2.19-1.24 4.39-1.83 6.59-.81 2.03-1.67 4.05-2.61 6.03-1.7-3.64-3.11-6.04-4.03-7.57-2.26-3.74-2.85-5.48-3.57-6.08l.31-.09c.43-.12.25-.8-.19-.67-1.06.3-2.12.6-3.17.95-.93.32-1.85.69-2.76 1.07-.13.05-.19.16-.22.27-.04.02-.08.05-.11.07-.04-.06-.07-.12-.11-.18a.354.354 0 0 0-.48-.12c-.16.09-.22.32-.13.48l.33.54c0 .09.02.18.06.28.51 1.16.78 1.38.72 1.47-2.42 3.44-5.41 7.86-6.2 9.1-1.27 1.97-2.01 3.14-2.45 3.84l-.91-6.56-.43-4.1c-.19-1.85-.37-3.23-.53-4.13-.19-1.1-.3-2.15-.45-3.16-.2-1.36-.29-2.06-.47-2.42h.04c.45.02.45-.68 0-.7-3.43-.16-6.81.94-10.17 1.48-.24-.22-.73-.04-.58.32.24.59.33 1.25.43 1.87.17 1.06.29 2.13.4 3.2.32 3.09.53 6.2.74 9.3.44 6.75.77 13.51 1.17 20.26.11 1.95.13 3.96.46 5.89.05.3.37.31.55.14.74 1.71 2.87 1.27 6.13 1.27 1.34 0 2.39.04 2.99-.11.02.32.48.53.63.18 3.61-8.26 7.41-16.46 12.05-24.2.03-.05.04-.1.05-.15.3.73.64 1.45.94 2.16.97 2.26 1.97 4.52 2.98 6.76 2.26 5.03 4.54 10.07 7.09 14.96.47.9.94 1.79 1.47 2.65.2.32.4.67.66.96-.18.25 0 .68.34.54.91-.38 1.82-.75 2.76-1.07 1.04-.35 2.11-.65 3.17-.95.39-.11.28-.66-.07-.68.62-.4.95-.96.87-1.91-.3-3.34.72-7.47.86-8.52l2.14-11.43c1.75-10.74 3.13-17.51 3.23-20.86.02-.49.08-2.84.13-3.24.17-1.25.48-1-4.96-1.65l.03-.02Zm-46.19 5.67c-.04-.24-.09-.48-.15-.71l.85-.15c-.34.24-.56.53-.7.86Zm1.95 25.12c-.36-6.63-.7-13.26-1.32-19.87 0 .02 0 .04.01.06.29 1.65.44 2.47.56 2.89 1 8.46 1.5 16.14 1.46 22.8-.06.99-.1 2-.11 3.02-.01.29-.03.68-.05 1.12-.01-.26-.03-.53-.04-.78-.19-3.08-.35-6.16-.52-9.23l.01-.01Zm36.4 18.66c-.11-.11-.24-.29-.37-.49.35.21.74.26 1.17.16-.27.11-.53.22-.8.32v.01Zm-.89-33.72c.12-.43.23-.86.35-1.29.71-1.77 1.41-3.55 2.08-5.33-.15.68-.26 1.22-.31 1.55-.5 2.94-2.13 7.59-3.58 13.36-.15-.35-.29-.66-.43-1 .61-2.44 1.25-4.87 1.9-7.3l-.01.01Zm3.56-12.48c.14-.44.28-.89.42-1.34-.13.7-.27 1.41-.42 2.11-.43 1.19-.86 2.38-1.31 3.57.42-1.45.85-2.9 1.31-4.34Zm-5.22 16.05c-.11.44-.23.87-.35 1.31-.12.46-.23.92-.35 1.38-.1-.22-.19-.4-.28-.61.34-.69.66-1.38.97-2.08h.01Zm-11.64 2.62c.06-.1.12-.19.17-.28.05.13.09.26.14.39a.398.398 0 0 0-.31-.11Zm2.3 2.98c-.56-1.3-1.25-2.63-1.65-3.99 0 0 .01-.02.02-.02.06.08 1.52 2.93 1.63 3.08.73 1.13 3.38 7.04 5.67 12.26 1.2 2.73 2.08 5.17 2.83 7.18-.62-1.25-1.23-2.51-1.83-3.78-2.31-4.87-4.53-9.78-6.67-14.73ZM275.92 87.03c-1.06-2.18-1.13-3.45-2.44-2.93-1.52.57-2.94 1.3-4.5 2.1-1.4.72-2.68 1.44-3.92 2.12.01-.25-.24-.5-.51-.34-4.8 2.93-12.41 4.7-17.28 1.31-1.98-1.77-3.32-4.15-3.97-5.78-.29-.95-.49-1.94-.63-2.93-.14-3.34 1.58-6.53 3.9-9.12.8-.79 1.68-1.51 2.66-2.12 3.7-2.3 8.22-3.07 12.51-2.51 2.71.35 5.32 1.24 7.71 2.55.39.22.75-.39.35-.6-.18-.1-.37-.18-.55-.27.56.27 1.03.33 1.51.19l-.48.39c-.15.11-.23.3-.13.48.09.15.33.24.48.13 1.3-.97 2.46-2.09 3.45-3.37.37-.29.64-.6.65-.97v-.02c.08-.33-.03-.7-.21-1.08-.31-.87-.98-2.01-2.19-3.26-2.43-2.52-3.79-3.45-5.68-4.26-1.14-.49-3.12-1.06-4.42-1.23-3.28-.42-10.64-1.21-18.18 4.11-7.74 5.46-11.94 12.3-12.23 20.61-.08 2.06.04 3.98.34 5.71.74 4.18 2.57 8 5.44 11.34 4.26 4.99 9.76 7.52 16.34 7.52 4.85 0 9.69-1.77 14.89-4.62.23-.12.45-.23.68-.35 2.19-1.1 4.37-2.23 6.46-3.5.49-.3 1.03-.61 1.5-.98 1.47-.87 1.11-1.12.49-2.95-.39-1.14-.76-2.7-2.06-5.36l.02-.01Zm-17.38-21.76c3.05-.42 6.31.79 9.36 2.35.51.39.94.68 1.33.87-5.61-2.86-12.72-3.39-18.44-.79 2.05-1.33 4.24-1.95 7.74-2.44l.01.01ZM443.67 72.67c-.4-2.2-1.15-4.33-2.37-6.22-1.49-2.32-3.58-4.19-5.91-5.64-6.17-3.81-13.75-5.11-20.83-6.01-3.23-.41-6.47-.69-9.72-.92l-1.39-.12c-.85-.07-1.52-.1-2.05-.1-1.08-.06-2.17-.12-3.25-.17-.08 0-.14.02-.19.05-.1.05-.18.14-.16.3.27 2.55-.01 5.12-.92 7.52-.15.38.4.56.62.28 1.32.59 2.68 1.05 4.08 1.37 0 2.78-.14 7.58-.33 12.91 0 0 0 .02-.01.03-.61 3.66-.79 7.42-1 11.12-.23 4.01-.43 8.03-.44 12.05 0 .64 0 1.28.03 1.93.02.31 0 .68.15.96.06.11.14.16.24.17-.2.17-.21.54.11.59 3.83.67 7.78.71 11.68.25 2.3-.19 4.87-.65 7.65-1.56 1.85-.54 3.67-1.18 5.43-1.91 7.2-3.02 14.31-8.07 17.35-15.53.76-1.86 1.17-3.8 1.31-5.75.3-1.93.28-3.82-.09-5.58l.01-.02Zm-19.32-15.42c5.74 1.41 11.94 3.68 15.65 8.55.25.32.47.65.69.99-2.3-2.82-5.68-5.69-12.88-8.23-2.16-.76-4.35-1.43-6.64-2.02 1.06.21 2.13.45 3.18.71Zm-25.82-3.04c.13 0 .27.01.4.02-.14.1-.26.23-.37.38 0-.13-.02-.26-.03-.4Zm34.82 22.17c-.75 3.09-3.55 5.66-5.88 7.58-3.35 2.76-7.21 5.03-11.28 6.54-1.33.49-2.71.9-4.12 1.15.06-1.38.08-2.76.07-4.13-.02-3.78-.16-7.56-.41-11.33-.09-1.37-.18-2.74-.37-4.1 0-.06-.03-.11-.06-.15.09-3.25.12-6.16.03-8.12 6.86 1.05 10.56 2.17 14.06 3.62 5.52 2.28 8.59 5.44 7.97 8.96l-.01-.02Zm-22 16.15c-.12 0-.23-.02-.34-.03l.34-.03v.06Zm-.69-.7c0-3.13.26-8.84.47-14.51.06 1.2.11 2.41.15 3.6.15 3.6.25 7.23.09 10.83-.24.03-.48.05-.71.07v.01Zm-12.33-30.94c.37.63 2.01 1.01 3.23 1.25v.15c-1.31-.31-2.59-.73-3.83-1.29.12-.36.23-.72.33-1.09.08.48.18.84.27.98Zm13.7 31.65v-.18c3.41-.56 6.71-2.02 9.69-3.68 2.31-1.28 4.59-2.78 6.63-4.53-4.69 4.53-11.61 8.24-16.33 8.38l.01.01Zm24.07-.75c-2.05 1.93-4.37 3.56-6.83 4.95 2.7-1.78 5.52-4.03 8.42-6.87.82-.82 1.56-1.69 2.23-2.59-1.08 1.65-2.38 3.16-3.81 4.51h-.01ZM187.16 92.14c-.79-2.47-2.1-7.12-3.1-6.87-.19-.01-2.09.77-4.08 1.54-3.06 1.18-5.91 2.13-10.09 2.82-2.74.42-5.87 1.01-10.61 1.06.04-3.34.05-6.01.05-7.99 7.97-.65 12.33-2.11 16.37-3.55 1.11-.39 2.69-1.01 2.63-1.8-.08-.35-.55-1.39-1.17-2.61-.47-1.16-.98-2.31-1.61-3.38-.42-.71-1.04-1.69-1.86-2.06-.11-.08-.22-.13-.29-.12-.02 0-.04 0-.07.01-.19-.04-.39-.05-.6-.01-.17.03-.24.15-.25.28-.04.02-.09.04-.14.05-4.33 1.48-8.85 2.33-13.24 3.61a499.1 499.1 0 0 0-.31-8.19c4.51-.99 8.88-1.38 13.11-1.82 3.68-.38 6.28.12 7.47.34.59.11.9.16 1.16.18h.1c-.1.37.44.66.62.28.02-.04.03-.08.05-.13.15.2.53.22.62-.1.17-.58.19-1.21.21-1.81v-.36c.03-.15.05-.3.07-.45.52-2.47.33-5.09-.64-7.44-.11-.27-.44-.28-.6-.14-.08-.21-.15-.42-.24-.62-.19-.41-.79-.05-.6.35.03.07.05.15.09.22-.98-.42-2.15-.54-3.17-.63-2.17-.19-4.37-.14-6.54 0-5.7.35-11.4 1.3-16.91 2.79-2.08.56-4.13 1.22-6.14 2-4.54 1.05-3.79 1.51-2.17 6.07.18.51.46 1.68.54 1.94.82 2.47 1.08 2.13 3.1 2.13s0 .05 0 .08h.52c-.48 2.66-.51 5.45-.62 8.13-.15 3.48-.22 6.96-.28 10.45 0 .41-.01.82-.02 1.23-.16.29-.33.57-.51.85-.05.38-.09.77-.14 1.18-.42 3.52-.59 6.48-.52 8.8v.34c.02.47.05.76.06.87.16 1.57-.26 3.47 1.35 3.79 1.61.32 3.5.55 4.85.55.11 0 .22-.02.33-.02 1.79.24 3.67.05 5.45-.12 2.85-.28 5.69-.7 8.51-1.19 3.03-.53 6.05-1.14 9.04-1.86 2.4-.58 4.82-1.19 7.13-2.06.51-.19 1.73-.57 2.46-1.14 1.81-.68 2.18-1 1.57-2.67-.23-.62-.48-1.49-.91-2.78l-.03-.02Zm-11.12-38.71c.89.05 1.93.08 2.89.3-.33 0-.68-.02-1.06-.03-8.28-.26-14.88.75-23.97 2.51 2.41-.64 4.85-1.16 7.28-1.59 4.87-.86 9.91-1.45 14.86-1.19Zm-26.53 22.13c.03 1.71.04 3.43 0 5.14-.04 1.27-.11 2.55-.24 3.82 0-.73.02-1.46.04-2.19.05-2.26.12-4.51.22-6.77h-.02Zm6.73 27.85c.2-.1.4-.21.58-.33 1.82-.17 3.82-.24 5.94-.34-.86.11-1.72.24-2.58.33-1.27.14-2.61.31-3.93.34h-.01ZM534.48 85.44c-3.52-8.38-7.07-16.75-10.5-25.17-.63-1.54-1.25-3.09-1.86-4.65-.31-.8-.65-1.6-.87-2.43-.04-.17-.17-.24-.31-.25.1-.2 0-.51-.29-.53-1.59-.08-3.18-.22-4.78-.25-1.96-.03-3.91.13-5.84.42-.31.05-.31.38-.13.56-.03.06-.05.14-.04.22.23 1.54.63 3.06 1.16 4.53.13.35.27.7.41 1.06l-2.68 6.18c-.11.03-.2.09-.25.22-.67 1.9-1.52 3.73-2.34 5.56a536.85 536.85 0 0 1-3.9 8.45c-2.64 5.64-5.34 11.25-7.91 16.93-.44.97-.88 1.94-1.29 2.93-.2.48-.47 1-.55 1.52v.05c-.02.12.02.26.16.34 1.19.73 2.41 1.41 3.66 2.05 1.2.62 2.45 1.25 3.76 1.61.43.12.62-.55.19-.67-1.13-.31-2.2-.83-3.24-1.36 1.09.36 2.1.69 2.75.93 2.82 1.01 2.38 1.1 4.3-3.75 2.1-1.09 4.34-1.96 6.53-2.79 4.35-1.64 8.8-3.03 13.27-4.29.82 2.01 1.77 3.97 2.72 5.92.35.83.62 1.45.79 1.82.22.42.45.8.69 1.15.17.33.33.67.5 1 .42.8.84 1.63 1.4 2.35.23.29.6 0 .55-.31 1.53-.02 3.06-.07 4.58-.27.92-.12 1.82-.32 2.71-.54 1.39-.27 3.85-1.11 3.74-1.42-.67-1.96-1.55-3.87-2.34-5.78-1.57-3.78-3.16-7.56-4.75-11.33v-.01Zm-11.65-26.16c1.54 3.81 3.12 7.6 4.7 11.4 2.94 7.05 5.91 14.09 8.87 21.13l-1.06-2.17c-2.71-5.51-5.2-11.19-7.41-16.87l-6.65-17.15c-.65-1.45-.55-2.19-.93-2.53.09 0 .18.01.28.02a.29.29 0 0 0-.04.26c.52 2.02 1.47 3.98 2.25 5.91h-.01Zm-6.58 13.58c.05-.15.09-.31.14-.46 1.41 3.92 2.88 7.9 4.39 11.87-3.22.52-6.38 1.25-9.46 2.14.55-1.22 1.05-2.46 1.53-3.7 1.24-3.24 2.37-6.53 3.39-9.85h.01Zm-.23-20c.36 0 .73.03 1.09.05-2.15.1-5.18.33-5.87.74-.24.15-.41.3-.53.45-.06-.29-.13-.58-.18-.88 1.82-.26 3.65-.39 5.49-.35v-.01Zm-.09 18.72c-.49 1.67-1.05 3.33-1.6 4.97-1.07 3.19-2.19 6.38-3.57 9.46-.09.21-.19.43-.29.65-.25.07-.5.14-.74.22 2.53-6.16 4.61-11.29 6.2-15.3Zm-6.34 25.16c4.97-2.38 9.37-4.1 14.02-5.27l.26.64c-4.8 1.35-9.63 2.8-14.28 4.63Zm20.17 6.76c.33.23.68.42 1.04.56h-.33c-.12 0-.21.06-.26.13-.15-.23-.31-.45-.45-.7v.01ZM226.57 91.75c-3.55-4.74-6.68-9.11-9.31-12.99 9.2-15.25 10.05-17.81 10.35-18.38.17-.34 1.09-2.27.64-2.53-1.13-.65-1.03-.65-2.97-1.71-1.19-.65-3.04-1.61-4.53-2.12-1.71-.59-1.24-.36-3 2.77-.06.1-.11.2-.17.3-.75 1.02-1.48 2.05-2.2 3.09-1.88 2.71-3.73 5.45-5.69 8.1-3.68-4.91-6.88-8.76-9.51-11.43-.15-.15-.3-.29-.46-.42-1.27-1.28-7.24 3.53-7.93 5.58-.09.09-.19.16-.28.25-.27.26.03.64.33.58.19.65.5 1.29.94 1.91 3.85 5.06 7.19 9.76 9.94 14-1.23 2.61-3.06 5-4.67 7.38l-2.28 3.33c-.5.66-.93 1.23-1.29 1.69-.67.93-2.09 2.61-2.3 3.87-.51.85-1.16 1.84-1.29 2.83-.06.44.61.63.67.19.01-.08.04-.15.06-.22 1.36 1.08 2.76 2.11 4.19 3.11 1.3.91 2.62 1.85 4.04 2.56.21.1.4 0 .48-.17.24.07.48.14.72.2.44.1.62-.57.19-.67-2.02-.48-3.77-1.57-5.23-3.02-.47-.46-.9-.96-1.32-1.46 1.74 1.35 4.2 2.89 5.89 4.14 1.39 1.03 2.85-2.27 4.22-4.2 1.86-2.64 3.96-5.86 5.52-8.29l10.39 14.51c.67.81 1.14 1.21 1.57 1.36-.05.24.12.51.41.4 1.53-.58 3.05-1.19 4.54-1.87 1.52-.69 3.06-1.45 4.36-2.5a.28.28 0 0 0 .12-.23c1.66-1.1.81-1.74-1.41-4.91-1.13-1.58-1.71-2.36-3.7-5.01l-.03-.02Zm2.41 6.54c.56 1.15 1.19 2.52 1.11 3.81-.06.04-.12.07-.17.1-.03-.88-.55-2.66-.94-3.91Zm-16.51-32.73c1.86-2.65 3.65-5.35 5.57-7.95.4-.55.81-1.13 1.26-1.66.19-.18.38-.33.56-.45.18.03.36.08.55.13l-8.05 10.11.12-.18h-.01ZM192.7 95.48c.79-1.37 1.66-2.69 2.54-4 1.19-1.79 2.4-3.56 3.61-5.33-.04.09-.09.17-.13.26-.1.22.03.41.2.49-2.47 3.42-4.89 6.73-6.4 9.28.21.24.4.48.63.75-.24.07-.4.36-.17.56.4.33.72.77 1.05 1.17.09.11.18.21.27.32-.84-.61-1.66-1.24-2.47-1.88.24-.57.58-1.11.87-1.61v-.01Zm7.46-10.32c.47-.81.98-1.59 1.49-2.37.31-.48.64-.95.96-1.43.26-.29.52-.56.75-.79-.99 1.48-2.09 3.03-3.2 4.59Zm10.03-16.22s-.03-.05-.05-.07c.22-.29.43-.59.64-.89-.2.32-.4.65-.58.96h-.01ZM371.54 87.96c-.01-.08-.01-.16-.03-.23-.06-.38-.58-.29-.66.03-.3-.05-.6-.08-.81-.11-1.14-.15-2.29-.19-3.44-.2 1.04-.09 2.09-.18 3.14-.23.45-.02.45-.72 0-.7-6.57.35-13.14 1.23-19.65 2.11-1.53.21-3.05.42-4.57.68-.01 0-.02.01-.04.01-.04-3.33-.13-6.66-.24-9.99-.19-5.7-.4-11.41-.88-17.1-.13-1.51-.23-3.07-.49-4.58 0-.25 0-.48-.02-.68-.06-1.19-.04-2.61-.68-2.78-.16-.07-.72-.16-1.5-.24.22-.17.16-.62-.2-.63-1.19-.04-2.39.09-3.57.23-1.2.14-2.41.32-3.59.6-.16-.1-.41-.06-.5.12-.06.02-.13.03-.19.05-.35.1-.29.55-.03.66-.26.6-.19 2.27-.21 3-.02.66-.66 33.73-.9 40.3-.03.65.06 1.12.04 1.45-.16 3.05.87 4.96 6.34 3.93 1.09-.08 2.75-.77 5.36-1.43 4.13-1.04 5.78-1.52 6.2-1.65 6.43-1.69 6.78-1.97 11.72-2.43.55-.05 4.8-.38 6.03-.3.64.04 1.19.07 1.65.1.09 0 .16-.03.24-.05.1.27.56.33.66-.02.39-1.32.61-2.71.78-4.08.2-1.61.29-3.24.15-4.86.24.03.52-.23.38-.53-.09-.2-.27-.33-.49-.43v-.02Zm-.63.56c.07.57.11 1.14.11 1.71-.21-.99-.53-1.71-.95-1.87.22.03.44.06.65.11.06.01.12.04.19.05Zm-25.41 1.73c1.54-.36 3.1-.64 4.66-.89-1.61.37-3.18.77-4.66 1.2v-.31Zm-.86-7.37c-.07-1.37-.16-2.75-.25-4.12-.21-3.13-.45-6.27-.79-9.4.02-2.25.08-4.31.13-6.11.16 2.08.29 4.16.4 6.24.23 4.46.38 8.93.5 13.39h.01Zm-.94-4c.16 2.41.29 4.83.39 7.24.06 1.6.14 3.22.09 4.83-.15.05-.32.09-.47.14V78.88h-.01ZM483.72 92.83c-3.05-2.28-6.22-4.4-9.38-6.51 8.86-6.49 13.49-12.95 13.73-19.23.04-.76 0-1.5-.13-2.2-.67-3.82-3.5-6.68-8.39-8.48.13.04.27.08.4.13 3.92 1.39 7.74 4.23 8.5 8.56.34 1.95-.05 3.96-.98 5.69-.21.4.39.75.6.35 1.86-3.46 1.46-7.55-.97-10.63-3.53-4.47-9.76-5.88-15.16-6.16-2.32-.12-4.64-.04-6.95.19-6 .32-12.71 1.68-17.63 3.21-.37.11-.67.23-.92.35-.2-.17-.62.02-.57.37v.03c-.64.68-.18 1.64.48 3.21.38.91.67 1.89 1.15 2.58.32.76.68 1.51 1.13 2.19.14.21.38.19.53.07.19-.02.38-.05.57-.08v1.57c-.06.06-.1.13-.11.23-.27 4.18-.34 8.38-.48 12.57l-.3 9.03c-.24 3.91-.44 6.77-.46 7.26-.05.88-.11 1.95.07 2.81-.01.22-.02.43-.04.65 0 .11-.02.23-.03.35 0 .05-.03.27-.01.16-.05.4.5.59.64.28.05.04.12.08.2.08 1.75.13 3.5.28 5.25.3 1.69.02 3.38-.12 5.06-.32.08.23.36.39.55.15.06-.08.11-.17.16-.26.18-.09.24-.32.18-.48.05-.2.1-.4.13-.6.16-.86.25-1.74.33-2.62.11-1.17.17-2.34.23-3.51.15-.01.32-.03.52-.04.36-.03 1.73-.15 2.06-.15.39 0 .7-.02.95-.04 1.76 1.11 3.45 2.35 5.14 3.55 2.83 2.01 5.64 4.04 8.47 6.04 1.42 1 2.85 2 4.29 2.97.1.06.19.07.27.04.08 0 .17-.02.25-.1 1.61-1.56 3.15-3.18 4.6-4.88.75-.88 1.49-1.78 2.15-2.73.01.01.03.02.04.03.34.3.83-.2.49-.49-2.16-1.9-4.34-3.76-6.64-5.48l.03-.01Zm-6.38-3.65a55.72 55.72 0 0 0-4-2.13c.14-.1.26-.19.4-.29 1.2.81 2.4 1.61 3.6 2.42Zm-20.1 11.78c.67-.37 1.23-.91 1.67-1.6-.11.5-.24 1-.38 1.49-.43.04-.86.08-1.29.11Zm2.38-37.24c1.34-.31 2.56-.52 3.71-.69-1.03.19-2.04.41-3.04.65-.14-.07-.34-.02-.45.11-.07.02-.15.04-.22.05v-.13.01Zm.04.84c.07-.02.14-.03.2-.05.34 1.66.41 3.41.5 5.09.17 2.9.24 5.81.28 8.71l.03 3.17c-.17.07-.34.14-.51.2-.06-4.96-.21-10.58-.51-17.12h.01Zm16.04 5.62c-1.16 2.25-3.06 4.1-5.02 5.66-2.8 2.23-5.99 3.97-9.3 5.35-.01-3.56-.09-7.12-.27-10.67-.1-2.04-.16-4.16-.57-6.18 3.3-.78 6.72-1.36 10.1-1.1 1.85.14 4.23.59 5.32 2.29.92 1.43.46 3.24-.26 4.65Zm.85-.18c.6-1.37.9-2.92.28-4.32-.67-1.52-2.2-2.32-3.76-2.74.46.1.89.21 1.29.37 1.74.67 2.69 1.88 2.93 3.21.2 1.13-.05 2.25-.74 3.47V70Zm-27.47-4.14c-.12-.19-.23-.38-.34-.57.74.42.85.36.99.41v.08c-.22.03-.43.06-.65.08Zm11.21 30.46c-.08 1.08-.16 2.17-.33 3.24-.05.35-.11.69-.2 1.03 0 .04-.02.07-.03.11-.15.02-.3.04-.45.05.45-1.64.76-3.36.79-5.07.03-.29.08-.57.1-.89-.03-.31-.03-.47.24-.57-.04.69-.07 1.39-.12 2.08v.02Zm5.6-2.47c.48.11.92.52 2.49 1.72-.46-.32-.92-.65-1.38-.97-.37-.25-.73-.5-1.1-.75h-.01Zm21.23 7.24a70.76 70.76 0 0 1-4.37 4.63c-.14-.09-.27-.19-.4-.28.19-.09.37-.24.55-.47.87-1.14 5.43-5.51 5.49-7.45.31.26.62.53.92.79-.67.97-1.42 1.88-2.19 2.77v.01Z",fill:"currentColor",transform:"translate(-144.023 -51.76)"})]}),TY=({style:e,size:t="small",withText:n})=>N("div",{className:`ExcalidrawLogo is-${t}`,style:e,children:[g(Vve,{}),n&&g($ve,{})]}),nI=({icon:e,shortcut:t,children:n})=>{const i=oi();return N(fe,{children:[g("div",{className:"welcome-screen-menu-item__icon",children:e}),g("div",{className:"welcome-screen-menu-item__text",children:n}),t&&!i.editor.isMobile&&g("div",{className:"welcome-screen-menu-item__shortcut",children:t})]})};nI.displayName="WelcomeScreenMenuItemContent";const Pp=({onSelect:e,children:t,icon:n,shortcut:i,className:s="",...r})=>g("button",{...r,type:"button",className:`welcome-screen-menu-item ${s}`,onClick:e,children:g(nI,{icon:n,shortcut:i,children:t})});Pp.displayName="WelcomeScreenMenuItem";const IY=({children:e,href:t,icon:n,shortcut:i,className:s="",...r})=>g("a",{...r,className:`welcome-screen-menu-item ${s}`,href:t,target:"_blank",rel:"noopener",children:g(nI,{icon:n,shortcut:i,children:e})});IY.displayName="WelcomeScreenMenuItemLink";const mo=({children:e})=>{const{WelcomeScreenCenterTunnel:t}=Ji();return g(t.In,{children:g("div",{className:"welcome-screen-center",children:e||N(fe,{children:[g(iI,{}),g(sI,{children:M("welcomeScreen.defaults.center_heading")}),N(rI,{children:[g(aI,{}),g(oI,{})]})]})})})};mo.displayName="Center";const iI=({children:e})=>g("div",{className:"welcome-screen-center__logo excalifont welcome-screen-decor",children:e||g(TY,{withText:!0})});iI.displayName="Logo";const sI=({children:e})=>g("div",{className:"welcome-screen-center__heading welcome-screen-decor excalifont",children:e});sI.displayName="Heading";const rI=({children:e})=>g("div",{className:"welcome-screen-menu",children:e});rI.displayName="Menu";const oI=()=>{const e=ks();return g(Pp,{onSelect:()=>e.executeAction(RT),shortcut:"?",icon:F_,children:M("helpDialog.title")})};oI.displayName="MenuItemHelp";const aI=()=>{const e=wi(),t=ks();return e.viewModeEnabled?null:g(Pp,{onSelect:()=>t.executeAction(yv),shortcut:Ki("loadScene"),icon:z_,children:M("buttons.load")})};aI.displayName="MenuItemLoadScene";const SY=({onSelect:e})=>{const{t}=dn();return g(Pp,{shortcut:null,onSelect:e,icon:V_,children:t("labels.liveCollaboration")})};SY.displayName="MenuItemLiveCollaborationTrigger";mo.Logo=iI;mo.Heading=sI;mo.Menu=rI;mo.MenuItem=Pp;mo.MenuItemLink=IY;mo.MenuItemHelp=oI;mo.MenuItemLoadScene=aI;mo.MenuItemLiveCollaborationTrigger=SY;const lI=({children:e})=>{const{WelcomeScreenMenuHintTunnel:t}=Ji();return g(t.In,{children:N("div",{className:"excalifont welcome-screen-decor welcome-screen-decor-hint welcome-screen-decor-hint--menu",children:[ede,g("div",{className:"welcome-screen-decor-hint__label",children:e||M("welcomeScreen.defaults.menuHint")})]})})};lI.displayName="MenuHint";const cI=({children:e})=>{const{WelcomeScreenToolbarHintTunnel:t}=Ji();return g(t.In,{children:N("div",{className:"excalifont welcome-screen-decor welcome-screen-decor-hint welcome-screen-decor-hint--toolbar",children:[g("div",{className:"welcome-screen-decor-hint__label",children:e||M("welcomeScreen.defaults.toolbarHint")}),nde]})})};cI.displayName="ToolbarHint";const uI=({children:e})=>{const{WelcomeScreenHelpHintTunnel:t}=Ji();return g(t.In,{children:N("div",{className:"excalifont welcome-screen-decor welcome-screen-decor-hint welcome-screen-decor-hint--help",children:[g("div",{children:e||M("welcomeScreen.defaults.helpHint")}),tde]})})};uI.displayName="HelpHint";const ss=e=>g(fe,{children:e.children||N(fe,{children:[g(mo,{}),g(lI,{}),g(cI,{}),g(uI,{})]})});ss.displayName="WelcomeScreen";ss.Center=mo;ss.Hints={MenuHint:lI,ToolbarHint:cI,HelpHint:uI};const xY=()=>{Array.prototype.at||Object.defineProperty(Array.prototype,"at",{value:function(e){if(e=Math.trunc(e)||0,e<0&&(e+=this.length),!(e<0||e>=this.length))return this[e]},writable:!0,enumerable:!1,configurable:!0}),Element.prototype.replaceChildren||(Element.prototype.replaceChildren=function(...e){this.innerHTML="",this.append(...e)})},Gve=(e,t,n)=>{var i,s,r;return!!(t&&(t.id===((i=e.editingTextElement)==null?void 0:i.id)||t.id===((s=e.resizingElement)==null?void 0:s.id)||t.id===((r=e.newElement)==null?void 0:r.id)||t.version>n.version||t.version===n.version&&t.versionNonce<n.versionNonce))},Xve=Oo((e,t,n)=>{if(window!=null&&window.DEBUG_FRACTIONAL_INDICES){const i=ru(e.map(s=>({...s})));E_(i,{shouldThrow:F9(),includeBoundTextValidation:!0,reconciliationContext:{localElements:t,remoteElements:n}})}},1e3*60,{leading:!0,trailing:!1}),dI=(e,t,n)=>{const i=ve(e),s=[],r=new Set;for(const a of t)if(!r.has(a.id)){const l=i.get(a.id),c=Gve(n,l,a);l&&c?(s.push(l),r.add(l.id)):(s.push(a),r.add(a.id))}for(const a of e)r.has(a.id)||(s.push(a),r.add(a.id));const o=v_(s);return Xve(o,e,t),ru(o),o},CY=({children:e,icon:t})=>{const{t:n}=dn(),{TTDDialogTriggerTunnel:i}=Ji(),s=xn();return g(i.In,{children:N(Be.Item,{onSelect:()=>{Qe("ai","dialog open","ttd"),s({openDialog:{name:"ttd",tab:"text-to-diagram"}})},icon:t??hfe,children:[e??n("labels.textToDiagram"),g(Be.Item.Badge,{children:"AI"})]})})};CY.displayName="TTDDialogTrigger";const jve=e=>{const t=go();return D.useLayoutEffect(()=>{t.setPlugins({diagramToCode:{generate:e.generate}})},[t,e.generate]),null};xY();const Yve=e=>{var Q,oe,me,he;const{onChange:t,onIncrement:n,initialData:i,excalidrawAPI:s,isCollaborating:r=!1,onPointerUpdate:o,renderTopLeftUI:a,renderTopRightUI:l,langCode:c=Hd.code,viewModeEnabled:u,zenModeEnabled:d,gridModeEnabled:f,libraryReturnUrl:h,theme:m,name:p,renderCustomStats:U,onPaste:b,detectScroll:y=!0,handleKeyboardGlobally:w=!1,onLibraryChange:v,autoFocus:I=!1,generateIdForFile:C,onLinkOpen:_,generateLinkForSelection:T,onPointerDown:k,onPointerUp:S,onScrollChange:R,onDuplicate:P,children:L,validateEmbeddable:X,renderEmbeddable:G,aiEnabled:z,showDeprecatedFonts:V,renderScrollbars:$}=e,j=(Q=e.UIOptions)==null?void 0:Q.canvasActions,W={...e.UIOptions,canvasActions:{...fA.canvasActions,...j},tools:{image:((me=(oe=e.UIOptions)==null?void 0:oe.tools)==null?void 0:me.image)??!0}};return j!=null&&j.export&&(W.canvasActions.export.saveFileToDisk=((he=j.export)==null?void 0:he.saveFileToDisk)??fA.canvasActions.export.saveFileToDisk),W.canvasActions.toggleTheme===null&&typeof m>"u"&&(W.canvasActions.toggleTheme=!0),D.useEffect(()=>{(async()=>{await ye(()=>import("./roundRect-0PYZxl1G.js"),__vite__mapDeps([]))})();const mt=We=>{typeof We.scale=="number"&&We.scale!==1&&We.preventDefault()};return document.addEventListener("touchmove",mt,{passive:!1}),()=>{document.removeEventListener("touchmove",mt)}},[]),g($ue,{store:Hs,children:g(Hve,{langCode:c,theme:m,children:g(tI,{onChange:t,onIncrement:n,initialData:i,excalidrawAPI:s,isCollaborating:r,onPointerUpdate:o,renderTopLeftUI:a,renderTopRightUI:l,langCode:c,viewModeEnabled:u,zenModeEnabled:d,gridModeEnabled:f,libraryReturnUrl:h,theme:m,name:p,renderCustomStats:U,UIOptions:W,onPaste:b,detectScroll:y,handleKeyboardGlobally:w,onLibraryChange:v,autoFocus:I,generateIdForFile:C,onLinkOpen:_,generateLinkForSelection:T,onPointerDown:k,onPointerUp:S,onScrollChange:R,onDuplicate:P,validateEmbeddable:X,renderEmbeddable:G,aiEnabled:z!==!1,showDeprecatedFonts:V,renderScrollbars:$,children:L})})})},Wve=(e,t)=>{if(e.children!==t.children)return!1;const{initialData:n,UIOptions:i={},...s}=e,{initialData:r,UIOptions:o={},...a}=t,l=Object.keys(i),c=Object.keys(o);return l.length!==c.length?!1:l.every(d=>d==="canvasActions"?Object.keys(i.canvasActions).every(h=>{var m,p,U,b;return h==="export"&&((m=i==null?void 0:i.canvasActions)!=null&&m.export)&&((p=o==null?void 0:o.canvasActions)!=null&&p.export)?i.canvasActions.export.saveFileToDisk===o.canvasActions.export.saveFileToDisk:((U=i==null?void 0:i.canvasActions)==null?void 0:U[h])===((b=o==null?void 0:o.canvasActions)==null?void 0:b[h])}):i[d]===o[d])&&Wi(s,a)},AY=ae.memo(Yve,Wve);AY.displayName="Excalidraw";const Kve=({link:e,onCloseRequest:t,setErrorMessage:n})=>{const{t:i}=dn(),[,s]=D.useState(!1),r=D.useRef(0),o=D.useRef(null),a=async()=>{var u;try{await au(e)}catch{n(i("errors.copyToSystemClipboardFailed"))}s(!0),r.current&&window.clearTimeout(r.current),r.current=window.setTimeout(()=>{s(!1)},3e3),(u=o.current)==null||u.select()},{onCopy:l,copyStatus:c}=WT();return g(ir,{onCloseRequest:t,title:!1,size:"small",children:N("div",{className:"ShareableLinkDialog",children:[g("h3",{children:"Shareable link"}),N("div",{className:"ShareableLinkDialog__linkRow",children:[g(Id,{ref:o,label:"Link",readonly:!0,fullWidth:!0,value:e,selectOnRender:!0}),g(io,{size:"large",label:i("buttons.copyLink"),icon:xp,status:c,onClick:()=>{l(),a()}})]}),N("div",{className:"ShareableLinkDialog__description",children:[" ",i("alerts.uploadedSecurly")]})]})})},Zve=300,qve=5e3,Qve=300,Jve=500,WD=2e4,ewe=50,twe=33,nwe=24*60*60*1e3,fI=4*1024*1024,iwe=31536e3,eb={SERVER_VOLATILE:"server-volatile-broadcast",SERVER:"server-broadcast",USER_FOLLOW_CHANGE:"user-follow",USER_FOLLOW_ROOM_CHANGE:"user-follow-room-change"};var os=(e=>(e.INVALID_RESPONSE="INVALID_RESPONSE",e.INIT="SCENE_INIT",e.UPDATE="SCENE_UPDATE",e.MOUSE_LOCATION="MOUSE_LOCATION",e.IDLE_STATUS="IDLE_STATUS",e.USER_VISIBLE_SCENE_BOUNDS="USER_VISIBLE_SCENE_BOUNDS",e))(os||{});const MY={shareLinkFiles:"/files/shareLinks",collabFiles:"/files/rooms"},swe=10,Sn={LOCAL_STORAGE_ELEMENTS:"excalidraw",LOCAL_STORAGE_APP_STATE:"excalidraw-state",LOCAL_STORAGE_COLLAB:"excalidraw-collab",LOCAL_STORAGE_THEME:"excalidraw-theme",LOCAL_STORAGE_DEBUG:"excalidraw-debug",VERSION_DATA_STATE:"version-dataState",VERSION_FILES:"version-files",IDB_LIBRARY:"excalidraw-library",__LEGACY_LOCAL_STORAGE_LIBRARY:"excalidraw-library"},rwe={AUTH_STATE_COOKIE:"excplus-auth"},Sd=document.cookie.includes(rwe.AUTH_STATE_COOKIE),owe=e=>{try{localStorage.setItem(Sn.LOCAL_STORAGE_COLLAB,JSON.stringify({username:e}))}catch(t){console.error(t)}},kY=()=>{try{const e=localStorage.getItem(Sn.LOCAL_STORAGE_COLLAB);if(e)return JSON.parse(e).username}catch(e){console.error(e)}return null},RY=()=>{let e=null,t=null;try{e=localStorage.getItem(Sn.LOCAL_STORAGE_ELEMENTS),t=localStorage.getItem(Sn.LOCAL_STORAGE_APP_STATE)}catch(s){console.error(s)}let n=[];if(e)try{n=pH(JSON.parse(e))}catch(s){console.error(s)}let i=null;if(t)try{i={...ia(),...G$(JSON.parse(t))}}catch(s){console.error(s)}return{elements:n,appState:i}},DY=()=>{try{const e=localStorage.getItem(Sn.LOCAL_STORAGE_ELEMENTS);return(e==null?void 0:e.length)||0}catch(e){return console.error(e),0}},awe=()=>{try{const e=localStorage.getItem(Sn.LOCAL_STORAGE_APP_STATE),t=localStorage.getItem(Sn.LOCAL_STORAGE_COLLAB),n=(e==null?void 0:e.length)||0,i=(t==null?void 0:t.length)||0;return n+i+DY()}catch(e){return console.error(e),0}},lwe=500,KD=sl(e=>{e({scene:DY(),total:awe()})},lwe),cwe=e=>{const[t,n]=D.useState({scene:0,total:0});D.useEffect(()=>{KD(o=>{n(o)})},[e.elements,e.appState]),D.useEffect(()=>()=>KD.cancel(),[]);const i=p4();let s,r;return i!==sB?(r=i.slice(0,16).replace("T"," "),s=i.slice(21)):r=M("stats.versionNotAvailable"),N(Sa.StatsRows,{order:-1,children:[g(Sa.StatsRow,{heading:!0,children:M("stats.version")}),N(Sa.StatsRow,{style:{textAlign:"center",cursor:"pointer"},onClick:async()=>{try{await au(p4()),e.setToast(M("toast.copyToClipboard"))}catch{}},title:M("stats.versionCopy"),children:[r,g("br",{}),s]}),g(Sa.StatsRow,{heading:!0,children:M("stats.storage")}),N(Sa.StatsRow,{columns:2,children:[g("div",{children:M("stats.scene")}),g("div",{children:vA(t.scene,1)})]}),N(Sa.StatsRow,{columns:2,children:[g("div",{children:M("stats.total")}),g("div",{children:vA(t.total,1)})]})]})},Xr=Ip(),uwe=(e,t)=>{const[n,i]=$h(e);return D.useLayoutEffect(()=>{i(typeof t=="function"?t():t)},[]),[n,i]};class LY{constructor({getFiles:t,saveFiles:n}){F(this,"fetchingFiles",new Map);F(this,"erroredFiles_fetch",new Map);F(this,"savingFiles",new Map);F(this,"savedFiles",new Map);F(this,"erroredFiles_save",new Map);F(this,"_getFiles");F(this,"_saveFiles");F(this,"isFileTracked",t=>this.savedFiles.has(t)||this.savingFiles.has(t)||this.fetchingFiles.has(t)||this.erroredFiles_fetch.has(t)||this.erroredFiles_save.has(t));F(this,"isFileSavedOrBeingSaved",t=>{const n=this.getFileVersion(t);return this.savedFiles.get(t.id)===n||this.savingFiles.get(t.id)===n});F(this,"getFileVersion",t=>t.version??1);F(this,"saveFiles",async({elements:t,files:n})=>{const i=new Map;for(const s of t){const r=Dn(s)&&n[s.fileId];r&&!this.isFileSavedOrBeingSaved(r)&&(i.set(s.fileId,n[s.fileId]),this.savingFiles.set(s.fileId,this.getFileVersion(r)))}try{const{savedFiles:s,erroredFiles:r}=await this._saveFiles({addedFiles:i});for(const[o,a]of s)this.savedFiles.set(o,this.getFileVersion(a));for(const[o,a]of r)this.erroredFiles_save.set(o,this.getFileVersion(a));return{savedFiles:s,erroredFiles:r}}finally{for(const[s]of i)this.savingFiles.delete(s)}});F(this,"getFiles",async t=>{if(!t.length)return{loadedFiles:[],erroredFiles:new Map};for(const n of t)this.fetchingFiles.set(n,!0);try{const{loadedFiles:n,erroredFiles:i}=await this._getFiles(t);for(const s of n)this.savedFiles.set(s.id,this.getFileVersion(s));for(const[s]of i)this.erroredFiles_fetch.set(s,!0);return{loadedFiles:n,erroredFiles:i}}finally{for(const n of t)this.fetchingFiles.delete(n)}});F(this,"shouldPreventUnload",t=>t.some(n=>Dn(n)&&!n.isDeleted&&this.savingFiles.has(n.fileId)));F(this,"shouldUpdateImageElementStatus",t=>Dn(t)&&this.savedFiles.has(t.fileId)&&t.status==="pending");this._getFiles=t,this._saveFiles=n}reset(){this.fetchingFiles.clear(),this.savingFiles.clear(),this.savedFiles.clear(),this.erroredFiles_fetch.clear(),this.erroredFiles_save.clear()}}const hI=async({files:e,maxBytes:t,encryptionKey:n})=>{const i=[];for(const[s,r]of e){const o=new TextEncoder().encode(r.dataURL),a=await HG(o,{encryptionKey:n,metadata:{id:s,mimeType:r.mimeType,created:Date.now(),lastRetrieved:Date.now()}});if(o.byteLength>t)throw new Error(M("errors.fileTooBig",{maxSize:`${Math.trunc(t/1024/1024)}MB`}));i.push({id:s,buffer:a})}return i},j1=e=>{e.erroredFiles.size&&e.excalidrawAPI.updateScene({elements:e.excalidrawAPI.getSceneElementsIncludingDeleted().map(t=>Dn(t)&&e.erroredFiles.has(t.fileId)?Te(t,{status:"error"}):t),captureUpdate:K.NEVER})};var ZD={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NY=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let s=e.charCodeAt(i);s<128?t[n++]=s:s<2048?(t[n++]=s>>6|192,t[n++]=s&63|128):(s&64512)===55296&&i+1<e.length&&(e.charCodeAt(i+1)&64512)===56320?(s=65536+((s&1023)<<10)+(e.charCodeAt(++i)&1023),t[n++]=s>>18|240,t[n++]=s>>12&63|128,t[n++]=s>>6&63|128,t[n++]=s&63|128):(t[n++]=s>>12|224,t[n++]=s>>6&63|128,t[n++]=s&63|128)}return t},dwe=function(e){const t=[];let n=0,i=0;for(;n<e.length;){const s=e[n++];if(s<128)t[i++]=String.fromCharCode(s);else if(s>191&&s<224){const r=e[n++];t[i++]=String.fromCharCode((s&31)<<6|r&63)}else if(s>239&&s<365){const r=e[n++],o=e[n++],a=e[n++],l=((s&7)<<18|(r&63)<<12|(o&63)<<6|a&63)-65536;t[i++]=String.fromCharCode(55296+(l>>10)),t[i++]=String.fromCharCode(56320+(l&1023))}else{const r=e[n++],o=e[n++];t[i++]=String.fromCharCode((s&15)<<12|(r&63)<<6|o&63)}}return t.join("")},OY={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<e.length;s+=3){const r=e[s],o=s+1<e.length,a=o?e[s+1]:0,l=s+2<e.length,c=l?e[s+2]:0,u=r>>2,d=(r&3)<<4|a>>4;let f=(a&15)<<2|c>>6,h=c&63;l||(h=64,o||(f=64)),i.push(n[u],n[d],n[f],n[h])}return i.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(NY(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):dwe(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<e.length;){const r=n[e.charAt(s++)],a=s<e.length?n[e.charAt(s)]:0;++s;const c=s<e.length?n[e.charAt(s)]:64;++s;const d=s<e.length?n[e.charAt(s)]:64;if(++s,r==null||a==null||c==null||d==null)throw new fwe;const f=r<<2|a>>4;if(i.push(f),c!==64){const h=a<<4&240|c>>2;if(i.push(h),d!==64){const m=c<<6&192|d;i.push(m)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class fwe extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const hwe=function(e){const t=NY(e);return OY.encodeByteArray(t,!0)},J6=function(e){return hwe(e).replace(/\./g,"")},gwe=function(e){try{return OY.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mwe(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pwe=()=>mwe().__FIREBASE_DEFAULTS__,Uwe=()=>{if(typeof process>"u"||typeof ZD>"u")return;const e=ZD.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},bwe=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&gwe(e[1]);return t&&JSON.parse(t)},gI=()=>{try{return pwe()||Uwe()||bwe()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},ywe=e=>{var t,n;return(n=(t=gI())===null||t===void 0?void 0:t.emulatorHosts)===null||n===void 0?void 0:n[e]},PY=e=>{const t=ywe(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(n+1),10);return t[0]==="["?[t.substring(1,n-1),i]:[t.substring(0,n),i]},FY=()=>{var e;return(e=gI())===null||e===void 0?void 0:e.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ewe{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}wrapCallback(t){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(n):t(n,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BY(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},i=t||"demo-project",s=e.iat||0,r=e.sub||e.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:s,exp:s+3600,auth_time:s,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},e);return[J6(JSON.stringify(n)),J6(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vwe(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function wwe(){var e;const t=(e=gI())===null||e===void 0?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function _we(){return!wwe()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Twe(){try{return typeof indexedDB=="object"}catch{return!1}}function Iwe(){return new Promise((e,t)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(i),e(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var r;t(((r=s.error)===null||r===void 0?void 0:r.message)||"")}}catch(n){t(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Swe="FirebaseError";class Xd extends Error{constructor(t,n,i){super(n),this.code=t,this.customData=i,this.name=Swe,Object.setPrototypeOf(this,Xd.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,zY.prototype.create)}}class zY{constructor(t,n,i){this.service=t,this.serviceName=n,this.errors=i}create(t,...n){const i=n[0]||{},s=`${this.service}/${t}`,r=this.errors[t],o=r?xwe(r,i):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Xd(s,a,i)}}function xwe(e,t){return e.replace(Cwe,(n,i)=>{const s=t[i];return s!=null?String(s):`<${i}?>`})}const Cwe=/\{\$([^}]+)}/g;function zv(e,t){if(e===t)return!0;const n=Object.keys(e),i=Object.keys(t);for(const s of n){if(!i.includes(s))return!1;const r=e[s],o=t[s];if(qD(r)&&qD(o)){if(!zv(r,o))return!1}else if(r!==o)return!1}for(const s of i)if(!n.includes(s))return!1;return!0}function qD(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fo(e){return e&&e._delegate?e._delegate:e}class Jh{constructor(t,n,i){this.name=t,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _u="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Awe{constructor(t,n){this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){const i=new Ewe;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(t){var n;const i=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),s=(n=t==null?void 0:t.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(r){if(s)return null;throw r}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(kwe(t))try{this.getOrInitializeService({instanceIdentifier:_u})}catch{}for(const[n,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const r=this.getOrInitializeService({instanceIdentifier:s});i.resolve(r)}catch{}}}}clearInstance(t=_u){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...t.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=_u){return this.instances.has(t)}getOptions(t=_u){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:n={}}=t,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:n});for(const[r,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);i===a&&o.resolve(s)}return s}onInit(t,n){var i;const s=this.normalizeInstanceIdentifier(n),r=(i=this.onInitCallbacks.get(s))!==null&&i!==void 0?i:new Set;r.add(t),this.onInitCallbacks.set(s,r);const o=this.instances.get(s);return o&&t(o,s),()=>{r.delete(t)}}invokeOnInitCallbacks(t,n){const i=this.onInitCallbacks.get(n);if(i)for(const s of i)try{s(t,n)}catch{}}getOrInitializeService({instanceIdentifier:t,options:n={}}){let i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:Mwe(t),options:n}),this.instances.set(t,i),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch{}return i||null}normalizeInstanceIdentifier(t=_u){return this.component?this.component.multipleInstances?t:_u:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Mwe(e){return e===_u?void 0:e}function kwe(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rwe{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const n=this.getProvider(t.name);if(n.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);n.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const n=new Awe(t,this);return this.providers.set(t,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ut;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(ut||(ut={}));const Dwe={debug:ut.DEBUG,verbose:ut.VERBOSE,info:ut.INFO,warn:ut.WARN,error:ut.ERROR,silent:ut.SILENT},Lwe=ut.INFO,Nwe={[ut.DEBUG]:"log",[ut.VERBOSE]:"log",[ut.INFO]:"info",[ut.WARN]:"warn",[ut.ERROR]:"error"},Owe=(e,t,...n)=>{if(t<e.logLevel)return;const i=new Date().toISOString(),s=Nwe[t];if(s)console[s](`[${i}]  ${e.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class HY{constructor(t){this.name=t,this._logLevel=Lwe,this._logHandler=Owe,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in ut))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?Dwe[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,ut.DEBUG,...t),this._logHandler(this,ut.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,ut.VERBOSE,...t),this._logHandler(this,ut.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,ut.INFO,...t),this._logHandler(this,ut.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,ut.WARN,...t),this._logHandler(this,ut.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,ut.ERROR,...t),this._logHandler(this,ut.ERROR,...t)}}const Pwe=(e,t)=>t.some(n=>e instanceof n);let QD,JD;function Fwe(){return QD||(QD=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Bwe(){return JD||(JD=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const VY=new WeakMap,Hv=new WeakMap,$Y=new WeakMap,H3=new WeakMap,mI=new WeakMap;function zwe(e){const t=new Promise((n,i)=>{const s=()=>{e.removeEventListener("success",r),e.removeEventListener("error",o)},r=()=>{n(Ic(e.result)),s()},o=()=>{i(e.error),s()};e.addEventListener("success",r),e.addEventListener("error",o)});return t.then(n=>{n instanceof IDBCursor&&VY.set(n,e)}).catch(()=>{}),mI.set(t,e),t}function Hwe(e){if(Hv.has(e))return;const t=new Promise((n,i)=>{const s=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",o),e.removeEventListener("abort",o)},r=()=>{n(),s()},o=()=>{i(e.error||new DOMException("AbortError","AbortError")),s()};e.addEventListener("complete",r),e.addEventListener("error",o),e.addEventListener("abort",o)});Hv.set(e,t)}let Vv={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return Hv.get(e);if(t==="objectStoreNames")return e.objectStoreNames||$Y.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ic(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function Vwe(e){Vv=e(Vv)}function $we(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...n){const i=e.call(V3(this),t,...n);return $Y.set(i,t.sort?t.sort():[t]),Ic(i)}:Bwe().includes(e)?function(...t){return e.apply(V3(this),t),Ic(VY.get(this))}:function(...t){return Ic(e.apply(V3(this),t))}}function Gwe(e){return typeof e=="function"?$we(e):(e instanceof IDBTransaction&&Hwe(e),Pwe(e,Fwe())?new Proxy(e,Vv):e)}function Ic(e){if(e instanceof IDBRequest)return zwe(e);if(H3.has(e))return H3.get(e);const t=Gwe(e);return t!==e&&(H3.set(e,t),mI.set(t,e)),t}const V3=e=>mI.get(e);function Xwe(e,t,{blocked:n,upgrade:i,blocking:s,terminated:r}={}){const o=indexedDB.open(e,t),a=Ic(o);return i&&o.addEventListener("upgradeneeded",l=>{i(Ic(o.result),l.oldVersion,l.newVersion,Ic(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{r&&l.addEventListener("close",()=>r()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const jwe=["get","getKey","getAll","getAllKeys","count"],Ywe=["put","add","delete","clear"],$3=new Map;function eL(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if($3.get(t))return $3.get(t);const n=t.replace(/FromIndex$/,""),i=t!==n,s=Ywe.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(s||jwe.includes(n)))return;const r=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let c=l.store;return i&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),s&&l.done]))[0]};return $3.set(t,r),r}Vwe(e=>({...e,get:(t,n,i)=>eL(t,n)||e.get(t,n,i),has:(t,n)=>!!eL(t,n)||e.has(t,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wwe{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Kwe(n)){const i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}}function Kwe(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const $v="@firebase/app",tL="0.11.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ml=new HY("@firebase/app"),Zwe="@firebase/app-compat",qwe="@firebase/analytics-compat",Qwe="@firebase/analytics",Jwe="@firebase/app-check-compat",e9e="@firebase/app-check",t9e="@firebase/auth",n9e="@firebase/auth-compat",i9e="@firebase/database",s9e="@firebase/data-connect",r9e="@firebase/database-compat",o9e="@firebase/functions",a9e="@firebase/functions-compat",l9e="@firebase/installations",c9e="@firebase/installations-compat",u9e="@firebase/messaging",d9e="@firebase/messaging-compat",f9e="@firebase/performance",h9e="@firebase/performance-compat",g9e="@firebase/remote-config",m9e="@firebase/remote-config-compat",p9e="@firebase/storage",U9e="@firebase/storage-compat",b9e="@firebase/firestore",y9e="@firebase/vertexai",E9e="@firebase/firestore-compat",v9e="firebase",w9e="11.3.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gv="[DEFAULT]",_9e={[$v]:"fire-core",[Zwe]:"fire-core-compat",[Qwe]:"fire-analytics",[qwe]:"fire-analytics-compat",[e9e]:"fire-app-check",[Jwe]:"fire-app-check-compat",[t9e]:"fire-auth",[n9e]:"fire-auth-compat",[i9e]:"fire-rtdb",[s9e]:"fire-data-connect",[r9e]:"fire-rtdb-compat",[o9e]:"fire-fn",[a9e]:"fire-fn-compat",[l9e]:"fire-iid",[c9e]:"fire-iid-compat",[u9e]:"fire-fcm",[d9e]:"fire-fcm-compat",[f9e]:"fire-perf",[h9e]:"fire-perf-compat",[g9e]:"fire-rc",[m9e]:"fire-rc-compat",[p9e]:"fire-gcs",[U9e]:"fire-gcs-compat",[b9e]:"fire-fst",[E9e]:"fire-fst-compat",[y9e]:"fire-vertex","fire-js":"fire-js",[v9e]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e5=new Map,T9e=new Map,Xv=new Map;function nL(e,t){try{e.container.addComponent(t)}catch(n){ml.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Fm(e){const t=e.name;if(Xv.has(t))return ml.debug(`There were multiple attempts to register component ${t}.`),!1;Xv.set(t,e);for(const n of e5.values())nL(n,e);for(const n of T9e.values())nL(n,e);return!0}function GY(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function XY(e){return e==null?!1:e.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I9e={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Sc=new zY("app","Firebase",I9e);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S9e{constructor(t,n,i){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Jh("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Sc.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jY=w9e;function YY(e,t={}){let n=e;typeof t!="object"&&(t={name:t});const i=Object.assign({name:Gv,automaticDataCollectionEnabled:!1},t),s=i.name;if(typeof s!="string"||!s)throw Sc.create("bad-app-name",{appName:String(s)});if(n||(n=FY()),!n)throw Sc.create("no-options");const r=e5.get(s);if(r){if(zv(n,r.options)&&zv(i,r.config))return r;throw Sc.create("duplicate-app",{appName:s})}const o=new Rwe(s);for(const l of Xv.values())o.addComponent(l);const a=new S9e(n,i,o);return e5.set(s,a),a}function WY(e=Gv){const t=e5.get(e);if(!t&&e===Gv&&FY())return YY();if(!t)throw Sc.create("no-app",{appName:e});return t}function xc(e,t,n){var i;let s=(i=_9e[e])!==null&&i!==void 0?i:e;n&&(s+=`-${n}`);const r=s.match(/\s|\//),o=t.match(/\s|\//);if(r||o){const a=[`Unable to register library "${s}" with version "${t}":`];r&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&o&&a.push("and"),o&&a.push(`version name "${t}" contains illegal characters (whitespace or "/")`),ml.warn(a.join(" "));return}Fm(new Jh(`${s}-version`,()=>({library:s,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x9e="firebase-heartbeat-database",C9e=1,Bm="firebase-heartbeat-store";let G3=null;function KY(){return G3||(G3=Xwe(x9e,C9e,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(Bm)}catch(n){console.warn(n)}}}}).catch(e=>{throw Sc.create("idb-open",{originalErrorMessage:e.message})})),G3}async function A9e(e){try{const n=(await KY()).transaction(Bm),i=await n.objectStore(Bm).get(ZY(e));return await n.done,i}catch(t){if(t instanceof Xd)ml.warn(t.message);else{const n=Sc.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});ml.warn(n.message)}}}async function iL(e,t){try{const i=(await KY()).transaction(Bm,"readwrite");await i.objectStore(Bm).put(t,ZY(e)),await i.done}catch(n){if(n instanceof Xd)ml.warn(n.message);else{const i=Sc.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});ml.warn(i.message)}}}function ZY(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M9e=1024,k9e=30;class R9e{constructor(t){this.container=t,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new L9e(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var t,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=sL();if(((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(o=>o.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:s}),this._heartbeatsCache.heartbeats.length>k9e){const o=N9e(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){ml.warn(i)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=sL(),{heartbeatsToSend:i,unsentEntries:s}=D9e(this._heartbeatsCache.heartbeats),r=J6(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(n){return ml.warn(n),""}}}function sL(){return new Date().toISOString().substring(0,10)}function D9e(e,t=M9e){const n=[];let i=e.slice();for(const s of e){const r=n.find(o=>o.agent===s.agent);if(r){if(r.dates.push(s.date),rL(n)>t){r.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),rL(n)>t){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}class L9e{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Twe()?Iwe().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await A9e(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return iL(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return iL(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...t.heartbeats]})}else return}}function rL(e){return J6(JSON.stringify({version:2,heartbeats:e})).length}function N9e(e){if(e.length===0)return-1;let t=0,n=e[0].date;for(let i=1;i<e.length;i++)e[i].date<n&&(n=e[i].date,t=i);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O9e(e){Fm(new Jh("platform-logger",t=>new Wwe(t),"PRIVATE")),Fm(new Jh("heartbeat",t=>new R9e(t),"PRIVATE")),xc($v,tL,e),xc($v,tL,"esm2017"),xc("fire-js","")}O9e("");var P9e="firebase",F9e="11.3.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */xc(P9e,F9e,"app");var oL=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Cc,qY;(function(){var e;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(_,T){function k(){}k.prototype=T.prototype,_.D=T.prototype,_.prototype=new k,_.prototype.constructor=_,_.C=function(S,R,P){for(var L=Array(arguments.length-2),X=2;X<arguments.length;X++)L[X-2]=arguments[X];return T.prototype[R].apply(S,L)}}function n(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(i,n),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(_,T,k){k||(k=0);var S=Array(16);if(typeof T=="string")for(var R=0;16>R;++R)S[R]=T.charCodeAt(k++)|T.charCodeAt(k++)<<8|T.charCodeAt(k++)<<16|T.charCodeAt(k++)<<24;else for(R=0;16>R;++R)S[R]=T[k++]|T[k++]<<8|T[k++]<<16|T[k++]<<24;T=_.g[0],k=_.g[1],R=_.g[2];var P=_.g[3],L=T+(P^k&(R^P))+S[0]+3614090360&4294967295;T=k+(L<<7&4294967295|L>>>25),L=P+(R^T&(k^R))+S[1]+3905402710&4294967295,P=T+(L<<12&4294967295|L>>>20),L=R+(k^P&(T^k))+S[2]+606105819&4294967295,R=P+(L<<17&4294967295|L>>>15),L=k+(T^R&(P^T))+S[3]+3250441966&4294967295,k=R+(L<<22&4294967295|L>>>10),L=T+(P^k&(R^P))+S[4]+4118548399&4294967295,T=k+(L<<7&4294967295|L>>>25),L=P+(R^T&(k^R))+S[5]+1200080426&4294967295,P=T+(L<<12&4294967295|L>>>20),L=R+(k^P&(T^k))+S[6]+2821735955&4294967295,R=P+(L<<17&4294967295|L>>>15),L=k+(T^R&(P^T))+S[7]+4249261313&4294967295,k=R+(L<<22&4294967295|L>>>10),L=T+(P^k&(R^P))+S[8]+1770035416&4294967295,T=k+(L<<7&4294967295|L>>>25),L=P+(R^T&(k^R))+S[9]+2336552879&4294967295,P=T+(L<<12&4294967295|L>>>20),L=R+(k^P&(T^k))+S[10]+4294925233&4294967295,R=P+(L<<17&4294967295|L>>>15),L=k+(T^R&(P^T))+S[11]+2304563134&4294967295,k=R+(L<<22&4294967295|L>>>10),L=T+(P^k&(R^P))+S[12]+1804603682&4294967295,T=k+(L<<7&4294967295|L>>>25),L=P+(R^T&(k^R))+S[13]+4254626195&4294967295,P=T+(L<<12&4294967295|L>>>20),L=R+(k^P&(T^k))+S[14]+2792965006&4294967295,R=P+(L<<17&4294967295|L>>>15),L=k+(T^R&(P^T))+S[15]+1236535329&4294967295,k=R+(L<<22&4294967295|L>>>10),L=T+(R^P&(k^R))+S[1]+4129170786&4294967295,T=k+(L<<5&4294967295|L>>>27),L=P+(k^R&(T^k))+S[6]+3225465664&4294967295,P=T+(L<<9&4294967295|L>>>23),L=R+(T^k&(P^T))+S[11]+643717713&4294967295,R=P+(L<<14&4294967295|L>>>18),L=k+(P^T&(R^P))+S[0]+3921069994&4294967295,k=R+(L<<20&4294967295|L>>>12),L=T+(R^P&(k^R))+S[5]+3593408605&4294967295,T=k+(L<<5&4294967295|L>>>27),L=P+(k^R&(T^k))+S[10]+38016083&4294967295,P=T+(L<<9&4294967295|L>>>23),L=R+(T^k&(P^T))+S[15]+3634488961&4294967295,R=P+(L<<14&4294967295|L>>>18),L=k+(P^T&(R^P))+S[4]+3889429448&4294967295,k=R+(L<<20&4294967295|L>>>12),L=T+(R^P&(k^R))+S[9]+568446438&4294967295,T=k+(L<<5&4294967295|L>>>27),L=P+(k^R&(T^k))+S[14]+3275163606&4294967295,P=T+(L<<9&4294967295|L>>>23),L=R+(T^k&(P^T))+S[3]+4107603335&4294967295,R=P+(L<<14&4294967295|L>>>18),L=k+(P^T&(R^P))+S[8]+1163531501&4294967295,k=R+(L<<20&4294967295|L>>>12),L=T+(R^P&(k^R))+S[13]+2850285829&4294967295,T=k+(L<<5&4294967295|L>>>27),L=P+(k^R&(T^k))+S[2]+4243563512&4294967295,P=T+(L<<9&4294967295|L>>>23),L=R+(T^k&(P^T))+S[7]+1735328473&4294967295,R=P+(L<<14&4294967295|L>>>18),L=k+(P^T&(R^P))+S[12]+2368359562&4294967295,k=R+(L<<20&4294967295|L>>>12),L=T+(k^R^P)+S[5]+4294588738&4294967295,T=k+(L<<4&4294967295|L>>>28),L=P+(T^k^R)+S[8]+2272392833&4294967295,P=T+(L<<11&4294967295|L>>>21),L=R+(P^T^k)+S[11]+1839030562&4294967295,R=P+(L<<16&4294967295|L>>>16),L=k+(R^P^T)+S[14]+4259657740&4294967295,k=R+(L<<23&4294967295|L>>>9),L=T+(k^R^P)+S[1]+2763975236&4294967295,T=k+(L<<4&4294967295|L>>>28),L=P+(T^k^R)+S[4]+1272893353&4294967295,P=T+(L<<11&4294967295|L>>>21),L=R+(P^T^k)+S[7]+4139469664&4294967295,R=P+(L<<16&4294967295|L>>>16),L=k+(R^P^T)+S[10]+3200236656&4294967295,k=R+(L<<23&4294967295|L>>>9),L=T+(k^R^P)+S[13]+681279174&4294967295,T=k+(L<<4&4294967295|L>>>28),L=P+(T^k^R)+S[0]+3936430074&4294967295,P=T+(L<<11&4294967295|L>>>21),L=R+(P^T^k)+S[3]+3572445317&4294967295,R=P+(L<<16&4294967295|L>>>16),L=k+(R^P^T)+S[6]+76029189&4294967295,k=R+(L<<23&4294967295|L>>>9),L=T+(k^R^P)+S[9]+3654602809&4294967295,T=k+(L<<4&4294967295|L>>>28),L=P+(T^k^R)+S[12]+3873151461&4294967295,P=T+(L<<11&4294967295|L>>>21),L=R+(P^T^k)+S[15]+530742520&4294967295,R=P+(L<<16&4294967295|L>>>16),L=k+(R^P^T)+S[2]+3299628645&4294967295,k=R+(L<<23&4294967295|L>>>9),L=T+(R^(k|~P))+S[0]+4096336452&4294967295,T=k+(L<<6&4294967295|L>>>26),L=P+(k^(T|~R))+S[7]+1126891415&4294967295,P=T+(L<<10&4294967295|L>>>22),L=R+(T^(P|~k))+S[14]+2878612391&4294967295,R=P+(L<<15&4294967295|L>>>17),L=k+(P^(R|~T))+S[5]+4237533241&4294967295,k=R+(L<<21&4294967295|L>>>11),L=T+(R^(k|~P))+S[12]+1700485571&4294967295,T=k+(L<<6&4294967295|L>>>26),L=P+(k^(T|~R))+S[3]+2399980690&4294967295,P=T+(L<<10&4294967295|L>>>22),L=R+(T^(P|~k))+S[10]+4293915773&4294967295,R=P+(L<<15&4294967295|L>>>17),L=k+(P^(R|~T))+S[1]+2240044497&4294967295,k=R+(L<<21&4294967295|L>>>11),L=T+(R^(k|~P))+S[8]+1873313359&4294967295,T=k+(L<<6&4294967295|L>>>26),L=P+(k^(T|~R))+S[15]+4264355552&4294967295,P=T+(L<<10&4294967295|L>>>22),L=R+(T^(P|~k))+S[6]+2734768916&4294967295,R=P+(L<<15&4294967295|L>>>17),L=k+(P^(R|~T))+S[13]+1309151649&4294967295,k=R+(L<<21&4294967295|L>>>11),L=T+(R^(k|~P))+S[4]+4149444226&4294967295,T=k+(L<<6&4294967295|L>>>26),L=P+(k^(T|~R))+S[11]+3174756917&4294967295,P=T+(L<<10&4294967295|L>>>22),L=R+(T^(P|~k))+S[2]+718787259&4294967295,R=P+(L<<15&4294967295|L>>>17),L=k+(P^(R|~T))+S[9]+3951481745&4294967295,_.g[0]=_.g[0]+T&4294967295,_.g[1]=_.g[1]+(R+(L<<21&4294967295|L>>>11))&4294967295,_.g[2]=_.g[2]+R&4294967295,_.g[3]=_.g[3]+P&4294967295}i.prototype.u=function(_,T){T===void 0&&(T=_.length);for(var k=T-this.blockSize,S=this.B,R=this.h,P=0;P<T;){if(R==0)for(;P<=k;)s(this,_,P),P+=this.blockSize;if(typeof _=="string"){for(;P<T;)if(S[R++]=_.charCodeAt(P++),R==this.blockSize){s(this,S),R=0;break}}else for(;P<T;)if(S[R++]=_[P++],R==this.blockSize){s(this,S),R=0;break}}this.h=R,this.o+=T},i.prototype.v=function(){var _=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);_[0]=128;for(var T=1;T<_.length-8;++T)_[T]=0;var k=8*this.o;for(T=_.length-8;T<_.length;++T)_[T]=k&255,k/=256;for(this.u(_),_=Array(16),T=k=0;4>T;++T)for(var S=0;32>S;S+=8)_[k++]=this.g[T]>>>S&255;return _};function r(_,T){var k=a;return Object.prototype.hasOwnProperty.call(k,_)?k[_]:k[_]=T(_)}function o(_,T){this.h=T;for(var k=[],S=!0,R=_.length-1;0<=R;R--){var P=_[R]|0;S&&P==T||(k[R]=P,S=!1)}this.g=k}var a={};function l(_){return-128<=_&&128>_?r(_,function(T){return new o([T|0],0>T?-1:0)}):new o([_|0],0>_?-1:0)}function c(_){if(isNaN(_)||!isFinite(_))return d;if(0>_)return U(c(-_));for(var T=[],k=1,S=0;_>=k;S++)T[S]=_/k|0,k*=4294967296;return new o(T,0)}function u(_,T){if(_.length==0)throw Error("number format error: empty string");if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(_.charAt(0)=="-")return U(u(_.substring(1),T));if(0<=_.indexOf("-"))throw Error('number format error: interior "-" character');for(var k=c(Math.pow(T,8)),S=d,R=0;R<_.length;R+=8){var P=Math.min(8,_.length-R),L=parseInt(_.substring(R,R+P),T);8>P?(P=c(Math.pow(T,P)),S=S.j(P).add(c(L))):(S=S.j(k),S=S.add(c(L)))}return S}var d=l(0),f=l(1),h=l(16777216);e=o.prototype,e.m=function(){if(p(this))return-U(this).m();for(var _=0,T=1,k=0;k<this.g.length;k++){var S=this.i(k);_+=(0<=S?S:4294967296+S)*T,T*=4294967296}return _},e.toString=function(_){if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(m(this))return"0";if(p(this))return"-"+U(this).toString(_);for(var T=c(Math.pow(_,6)),k=this,S="";;){var R=v(k,T).g;k=b(k,R.j(T));var P=((0<k.g.length?k.g[0]:k.h)>>>0).toString(_);if(k=R,m(k))return P+S;for(;6>P.length;)P="0"+P;S=P+S}},e.i=function(_){return 0>_?0:_<this.g.length?this.g[_]:this.h};function m(_){if(_.h!=0)return!1;for(var T=0;T<_.g.length;T++)if(_.g[T]!=0)return!1;return!0}function p(_){return _.h==-1}e.l=function(_){return _=b(this,_),p(_)?-1:m(_)?0:1};function U(_){for(var T=_.g.length,k=[],S=0;S<T;S++)k[S]=~_.g[S];return new o(k,~_.h).add(f)}e.abs=function(){return p(this)?U(this):this},e.add=function(_){for(var T=Math.max(this.g.length,_.g.length),k=[],S=0,R=0;R<=T;R++){var P=S+(this.i(R)&65535)+(_.i(R)&65535),L=(P>>>16)+(this.i(R)>>>16)+(_.i(R)>>>16);S=L>>>16,P&=65535,L&=65535,k[R]=L<<16|P}return new o(k,k[k.length-1]&-2147483648?-1:0)};function b(_,T){return _.add(U(T))}e.j=function(_){if(m(this)||m(_))return d;if(p(this))return p(_)?U(this).j(U(_)):U(U(this).j(_));if(p(_))return U(this.j(U(_)));if(0>this.l(h)&&0>_.l(h))return c(this.m()*_.m());for(var T=this.g.length+_.g.length,k=[],S=0;S<2*T;S++)k[S]=0;for(S=0;S<this.g.length;S++)for(var R=0;R<_.g.length;R++){var P=this.i(S)>>>16,L=this.i(S)&65535,X=_.i(R)>>>16,G=_.i(R)&65535;k[2*S+2*R]+=L*G,y(k,2*S+2*R),k[2*S+2*R+1]+=P*G,y(k,2*S+2*R+1),k[2*S+2*R+1]+=L*X,y(k,2*S+2*R+1),k[2*S+2*R+2]+=P*X,y(k,2*S+2*R+2)}for(S=0;S<T;S++)k[S]=k[2*S+1]<<16|k[2*S];for(S=T;S<2*T;S++)k[S]=0;return new o(k,0)};function y(_,T){for(;(_[T]&65535)!=_[T];)_[T+1]+=_[T]>>>16,_[T]&=65535,T++}function w(_,T){this.g=_,this.h=T}function v(_,T){if(m(T))throw Error("division by zero");if(m(_))return new w(d,d);if(p(_))return T=v(U(_),T),new w(U(T.g),U(T.h));if(p(T))return T=v(_,U(T)),new w(U(T.g),T.h);if(30<_.g.length){if(p(_)||p(T))throw Error("slowDivide_ only works with positive integers.");for(var k=f,S=T;0>=S.l(_);)k=I(k),S=I(S);var R=C(k,1),P=C(S,1);for(S=C(S,2),k=C(k,2);!m(S);){var L=P.add(S);0>=L.l(_)&&(R=R.add(k),P=L),S=C(S,1),k=C(k,1)}return T=b(_,R.j(T)),new w(R,T)}for(R=d;0<=_.l(T);){for(k=Math.max(1,Math.floor(_.m()/T.m())),S=Math.ceil(Math.log(k)/Math.LN2),S=48>=S?1:Math.pow(2,S-48),P=c(k),L=P.j(T);p(L)||0<L.l(_);)k-=S,P=c(k),L=P.j(T);m(P)&&(P=f),R=R.add(P),_=b(_,L)}return new w(R,_)}e.A=function(_){return v(this,_).h},e.and=function(_){for(var T=Math.max(this.g.length,_.g.length),k=[],S=0;S<T;S++)k[S]=this.i(S)&_.i(S);return new o(k,this.h&_.h)},e.or=function(_){for(var T=Math.max(this.g.length,_.g.length),k=[],S=0;S<T;S++)k[S]=this.i(S)|_.i(S);return new o(k,this.h|_.h)},e.xor=function(_){for(var T=Math.max(this.g.length,_.g.length),k=[],S=0;S<T;S++)k[S]=this.i(S)^_.i(S);return new o(k,this.h^_.h)};function I(_){for(var T=_.g.length+1,k=[],S=0;S<T;S++)k[S]=_.i(S)<<1|_.i(S-1)>>>31;return new o(k,_.h)}function C(_,T){var k=T>>5;T%=32;for(var S=_.g.length-k,R=[],P=0;P<S;P++)R[P]=0<T?_.i(P+k)>>>T|_.i(P+k+1)<<32-T:_.i(P+k);return new o(R,_.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,qY=i,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=u,Cc=o}).apply(typeof oL<"u"?oL:typeof self<"u"?self:typeof window<"u"?window:{});var s2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var QY,Y1,JY,tb,jv,eW,tW,nW;(function(){var e,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(E,A,O){return E==Array.prototype||E==Object.prototype||(E[A]=O.value),E};function n(E){E=[typeof globalThis=="object"&&globalThis,E,typeof window=="object"&&window,typeof self=="object"&&self,typeof s2=="object"&&s2];for(var A=0;A<E.length;++A){var O=E[A];if(O&&O.Math==Math)return O}throw Error("Cannot find global object")}var i=n(this);function s(E,A){if(A)e:{var O=i;E=E.split(".");for(var B=0;B<E.length-1;B++){var Z=E[B];if(!(Z in O))break e;O=O[Z]}E=E[E.length-1],B=O[E],A=A(B),A!=B&&A!=null&&t(O,E,{configurable:!0,writable:!0,value:A})}}function r(E,A){E instanceof String&&(E+="");var O=0,B=!1,Z={next:function(){if(!B&&O<E.length){var ee=O++;return{value:A(ee,E[ee]),done:!1}}return B=!0,{done:!0,value:void 0}}};return Z[Symbol.iterator]=function(){return Z},Z}s("Array.prototype.values",function(E){return E||function(){return r(this,function(A,O){return O})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(E){var A=typeof E;return A=A!="object"?A:E?Array.isArray(E)?"array":A:"null",A=="array"||A=="object"&&typeof E.length=="number"}function c(E){var A=typeof E;return A=="object"&&E!=null||A=="function"}function u(E,A,O){return E.call.apply(E.bind,arguments)}function d(E,A,O){if(!E)throw Error();if(2<arguments.length){var B=Array.prototype.slice.call(arguments,2);return function(){var Z=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Z,B),E.apply(A,Z)}}return function(){return E.apply(A,arguments)}}function f(E,A,O){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:d,f.apply(null,arguments)}function h(E,A){var O=Array.prototype.slice.call(arguments,1);return function(){var B=O.slice();return B.push.apply(B,arguments),E.apply(this,B)}}function m(E,A){function O(){}O.prototype=A.prototype,E.aa=A.prototype,E.prototype=new O,E.prototype.constructor=E,E.Qb=function(B,Z,ee){for(var Ue=Array(arguments.length-2),$t=2;$t<arguments.length;$t++)Ue[$t-2]=arguments[$t];return A.prototype[Z].apply(B,Ue)}}function p(E){const A=E.length;if(0<A){const O=Array(A);for(let B=0;B<A;B++)O[B]=E[B];return O}return[]}function U(E,A){for(let O=1;O<arguments.length;O++){const B=arguments[O];if(l(B)){const Z=E.length||0,ee=B.length||0;E.length=Z+ee;for(let Ue=0;Ue<ee;Ue++)E[Z+Ue]=B[Ue]}else E.push(B)}}class b{constructor(A,O){this.i=A,this.j=O,this.h=0,this.g=null}get(){let A;return 0<this.h?(this.h--,A=this.g,this.g=A.next,A.next=null):A=this.i(),A}}function y(E){return/^[\s\xa0]*$/.test(E)}function w(){var E=a.navigator;return E&&(E=E.userAgent)?E:""}function v(E){return v[" "](E),E}v[" "]=function(){};var I=w().indexOf("Gecko")!=-1&&!(w().toLowerCase().indexOf("webkit")!=-1&&w().indexOf("Edge")==-1)&&!(w().indexOf("Trident")!=-1||w().indexOf("MSIE")!=-1)&&w().indexOf("Edge")==-1;function C(E,A,O){for(const B in E)A.call(O,E[B],B,E)}function _(E,A){for(const O in E)A.call(void 0,E[O],O,E)}function T(E){const A={};for(const O in E)A[O]=E[O];return A}const k="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function S(E,A){let O,B;for(let Z=1;Z<arguments.length;Z++){B=arguments[Z];for(O in B)E[O]=B[O];for(let ee=0;ee<k.length;ee++)O=k[ee],Object.prototype.hasOwnProperty.call(B,O)&&(E[O]=B[O])}}function R(E){var A=1;E=E.split(":");const O=[];for(;0<A&&E.length;)O.push(E.shift()),A--;return E.length&&O.push(E.join(":")),O}function P(E){a.setTimeout(()=>{throw E},0)}function L(){var E=j;let A=null;return E.g&&(A=E.g,E.g=E.g.next,E.g||(E.h=null),A.next=null),A}class X{constructor(){this.h=this.g=null}add(A,O){const B=G.get();B.set(A,O),this.h?this.h.next=B:this.g=B,this.h=B}}var G=new b(()=>new z,E=>E.reset());class z{constructor(){this.next=this.g=this.h=null}set(A,O){this.h=A,this.g=O,this.next=null}reset(){this.next=this.g=this.h=null}}let V,$=!1,j=new X,W=()=>{const E=a.Promise.resolve(void 0);V=()=>{E.then(Q)}};var Q=()=>{for(var E;E=L();){try{E.h.call(E.g)}catch(O){P(O)}var A=G;A.j(E),100>A.h&&(A.h++,E.next=A.g,A.g=E)}$=!1};function oe(){this.s=this.s,this.C=this.C}oe.prototype.s=!1,oe.prototype.ma=function(){this.s||(this.s=!0,this.N())},oe.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function me(E,A){this.type=E,this.g=this.target=A,this.defaultPrevented=!1}me.prototype.h=function(){this.defaultPrevented=!0};var he=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var E=!1,A=Object.defineProperty({},"passive",{get:function(){E=!0}});try{const O=()=>{};a.addEventListener("test",O,A),a.removeEventListener("test",O,A)}catch{}return E}();function Me(E,A){if(me.call(this,E?E.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,E){var O=this.type=E.type,B=E.changedTouches&&E.changedTouches.length?E.changedTouches[0]:null;if(this.target=E.target||E.srcElement,this.g=A,A=E.relatedTarget){if(I){e:{try{v(A.nodeName);var Z=!0;break e}catch{}Z=!1}Z||(A=null)}}else O=="mouseover"?A=E.fromElement:O=="mouseout"&&(A=E.toElement);this.relatedTarget=A,B?(this.clientX=B.clientX!==void 0?B.clientX:B.pageX,this.clientY=B.clientY!==void 0?B.clientY:B.pageY,this.screenX=B.screenX||0,this.screenY=B.screenY||0):(this.clientX=E.clientX!==void 0?E.clientX:E.pageX,this.clientY=E.clientY!==void 0?E.clientY:E.pageY,this.screenX=E.screenX||0,this.screenY=E.screenY||0),this.button=E.button,this.key=E.key||"",this.ctrlKey=E.ctrlKey,this.altKey=E.altKey,this.shiftKey=E.shiftKey,this.metaKey=E.metaKey,this.pointerId=E.pointerId||0,this.pointerType=typeof E.pointerType=="string"?E.pointerType:mt[E.pointerType]||"",this.state=E.state,this.i=E,E.defaultPrevented&&Me.aa.h.call(this)}}m(Me,me);var mt={2:"touch",3:"pen",4:"mouse"};Me.prototype.h=function(){Me.aa.h.call(this);var E=this.i;E.preventDefault?E.preventDefault():E.returnValue=!1};var We="closure_listenable_"+(1e6*Math.random()|0),Ht=0;function fn(E,A,O,B,Z){this.listener=E,this.proxy=null,this.src=A,this.type=O,this.capture=!!B,this.ha=Z,this.key=++Ht,this.da=this.fa=!1}function je(E){E.da=!0,E.listener=null,E.proxy=null,E.src=null,E.ha=null}function lt(E){this.src=E,this.g={},this.h=0}lt.prototype.add=function(E,A,O,B,Z){var ee=E.toString();E=this.g[ee],E||(E=this.g[ee]=[],this.h++);var Ue=ai(E,A,B,Z);return-1<Ue?(A=E[Ue],O||(A.fa=!1)):(A=new fn(A,this.src,ee,!!B,Z),A.fa=O,E.push(A)),A};function Vt(E,A){var O=A.type;if(O in E.g){var B=E.g[O],Z=Array.prototype.indexOf.call(B,A,void 0),ee;(ee=0<=Z)&&Array.prototype.splice.call(B,Z,1),ee&&(je(A),E.g[O].length==0&&(delete E.g[O],E.h--))}}function ai(E,A,O,B){for(var Z=0;Z<E.length;++Z){var ee=E[Z];if(!ee.da&&ee.listener==A&&ee.capture==!!O&&ee.ha==B)return Z}return-1}var Il="closure_lm_"+(1e6*Math.random()|0),Ng={};function $p(E,A,O,B,Z){if(Array.isArray(A)){for(var ee=0;ee<A.length;ee++)$p(E,A[ee],O,B,Z);return null}return O=iS(O),E&&E[We]?E.K(A,O,c(B)?!!B.capture:!1,Z):cE(E,A,O,!1,B,Z)}function cE(E,A,O,B,Z,ee){if(!A)throw Error("Invalid event type");var Ue=c(Z)?!!Z.capture:!!Z,$t=fE(E);if($t||(E[Il]=$t=new lt(E)),O=$t.add(A,O,B,Ue,ee),O.proxy)return O;if(B=uE(),O.proxy=B,B.src=E,B.listener=O,E.addEventListener)he||(Z=Ue),Z===void 0&&(Z=!1),E.addEventListener(A.toString(),B,Z);else if(E.attachEvent)E.attachEvent(nS(A.toString()),B);else if(E.addListener&&E.removeListener)E.addListener(B);else throw Error("addEventListener and attachEvent are unavailable.");return O}function uE(){function E(O){return A.call(E.src,E.listener,O)}const A=WK;return E}function lu(E,A,O,B,Z){if(Array.isArray(A))for(var ee=0;ee<A.length;ee++)lu(E,A[ee],O,B,Z);else B=c(B)?!!B.capture:!!B,O=iS(O),E&&E[We]?(E=E.i,A=String(A).toString(),A in E.g&&(ee=E.g[A],O=ai(ee,O,B,Z),-1<O&&(je(ee[O]),Array.prototype.splice.call(ee,O,1),ee.length==0&&(delete E.g[A],E.h--)))):E&&(E=fE(E))&&(A=E.g[A.toString()],E=-1,A&&(E=ai(A,O,B,Z)),(O=-1<E?A[E]:null)&&dE(O))}function dE(E){if(typeof E!="number"&&E&&!E.da){var A=E.src;if(A&&A[We])Vt(A.i,E);else{var O=E.type,B=E.proxy;A.removeEventListener?A.removeEventListener(O,B,E.capture):A.detachEvent?A.detachEvent(nS(O),B):A.addListener&&A.removeListener&&A.removeListener(B),(O=fE(A))?(Vt(O,E),O.h==0&&(O.src=null,A[Il]=null)):je(E)}}}function nS(E){return E in Ng?Ng[E]:Ng[E]="on"+E}function WK(E,A){if(E.da)E=!0;else{A=new Me(A,this);var O=E.listener,B=E.ha||E.src;E.fa&&dE(E),E=O.call(B,A)}return E}function fE(E){return E=E[Il],E instanceof lt?E:null}var hE="__closure_events_fn_"+(1e9*Math.random()>>>0);function iS(E){return typeof E=="function"?E:(E[hE]||(E[hE]=function(A){return E.handleEvent(A)}),E[hE])}function Ni(){oe.call(this),this.i=new lt(this),this.M=this,this.F=null}m(Ni,oe),Ni.prototype[We]=!0,Ni.prototype.removeEventListener=function(E,A,O,B){lu(this,E,A,O,B)};function es(E,A){var O,B=E.F;if(B)for(O=[];B;B=B.F)O.push(B);if(E=E.M,B=A.type||A,typeof A=="string")A=new me(A,E);else if(A instanceof me)A.target=A.target||E;else{var Z=A;A=new me(B,E),S(A,Z)}if(Z=!0,O)for(var ee=O.length-1;0<=ee;ee--){var Ue=A.g=O[ee];Z=Gp(Ue,B,!0,A)&&Z}if(Ue=A.g=E,Z=Gp(Ue,B,!0,A)&&Z,Z=Gp(Ue,B,!1,A)&&Z,O)for(ee=0;ee<O.length;ee++)Ue=A.g=O[ee],Z=Gp(Ue,B,!1,A)&&Z}Ni.prototype.N=function(){if(Ni.aa.N.call(this),this.i){var E=this.i,A;for(A in E.g){for(var O=E.g[A],B=0;B<O.length;B++)je(O[B]);delete E.g[A],E.h--}}this.F=null},Ni.prototype.K=function(E,A,O,B){return this.i.add(String(E),A,!1,O,B)},Ni.prototype.L=function(E,A,O,B){return this.i.add(String(E),A,!0,O,B)};function Gp(E,A,O,B){if(A=E.i.g[String(A)],!A)return!0;A=A.concat();for(var Z=!0,ee=0;ee<A.length;++ee){var Ue=A[ee];if(Ue&&!Ue.da&&Ue.capture==O){var $t=Ue.listener,_i=Ue.ha||Ue.src;Ue.fa&&Vt(E.i,Ue),Z=$t.call(_i,B)!==!1&&Z}}return Z&&!B.defaultPrevented}function sS(E,A,O){if(typeof E=="function")O&&(E=f(E,O));else if(E&&typeof E.handleEvent=="function")E=f(E.handleEvent,E);else throw Error("Invalid listener argument");return 2147483647<Number(A)?-1:a.setTimeout(E,A||0)}function rS(E){E.g=sS(()=>{E.g=null,E.i&&(E.i=!1,rS(E))},E.l);const A=E.h;E.h=null,E.m.apply(null,A)}class KK extends oe{constructor(A,O){super(),this.m=A,this.l=O,this.h=null,this.i=!1,this.g=null}j(A){this.h=arguments,this.g?this.i=!0:rS(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Og(E){oe.call(this),this.h=E,this.g={}}m(Og,oe);var oS=[];function aS(E){C(E.g,function(A,O){this.g.hasOwnProperty(O)&&dE(A)},E),E.g={}}Og.prototype.N=function(){Og.aa.N.call(this),aS(this)},Og.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var gE=a.JSON.stringify,ZK=a.JSON.parse,qK=class{stringify(E){return a.JSON.stringify(E,void 0)}parse(E){return a.JSON.parse(E,void 0)}};function mE(){}mE.prototype.h=null;function lS(E){return E.h||(E.h=E.i())}function cS(){}var Pg={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function pE(){me.call(this,"d")}m(pE,me);function UE(){me.call(this,"c")}m(UE,me);var cu={},uS=null;function Xp(){return uS=uS||new Ni}cu.La="serverreachability";function dS(E){me.call(this,cu.La,E)}m(dS,me);function Fg(E){const A=Xp();es(A,new dS(A))}cu.STAT_EVENT="statevent";function fS(E,A){me.call(this,cu.STAT_EVENT,E),this.stat=A}m(fS,me);function ts(E){const A=Xp();es(A,new fS(A,E))}cu.Ma="timingevent";function hS(E,A){me.call(this,cu.Ma,E),this.size=A}m(hS,me);function Bg(E,A){if(typeof E!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){E()},A)}function zg(){this.g=!0}zg.prototype.xa=function(){this.g=!1};function QK(E,A,O,B,Z,ee){E.info(function(){if(E.g)if(ee)for(var Ue="",$t=ee.split("&"),_i=0;_i<$t.length;_i++){var vt=$t[_i].split("=");if(1<vt.length){var Oi=vt[0];vt=vt[1];var Pi=Oi.split("_");Ue=2<=Pi.length&&Pi[1]=="type"?Ue+(Oi+"="+vt+"&"):Ue+(Oi+"=redacted&")}}else Ue=null;else Ue=ee;return"XMLHTTP REQ ("+B+") [attempt "+Z+"]: "+A+`
`+O+`
`+Ue})}function JK(E,A,O,B,Z,ee,Ue){E.info(function(){return"XMLHTTP RESP ("+B+") [ attempt "+Z+"]: "+A+`
`+O+`
`+ee+" "+Ue})}function Zd(E,A,O,B){E.info(function(){return"XMLHTTP TEXT ("+A+"): "+tZ(E,O)+(B?" "+B:"")})}function eZ(E,A){E.info(function(){return"TIMEOUT: "+A})}zg.prototype.info=function(){};function tZ(E,A){if(!E.g)return A;if(!A)return null;try{var O=JSON.parse(A);if(O){for(E=0;E<O.length;E++)if(Array.isArray(O[E])){var B=O[E];if(!(2>B.length)){var Z=B[1];if(Array.isArray(Z)&&!(1>Z.length)){var ee=Z[0];if(ee!="noop"&&ee!="stop"&&ee!="close")for(var Ue=1;Ue<Z.length;Ue++)Z[Ue]=""}}}}return gE(O)}catch{return A}}var jp={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},gS={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},bE;function Yp(){}m(Yp,mE),Yp.prototype.g=function(){return new XMLHttpRequest},Yp.prototype.i=function(){return{}},bE=new Yp;function Sl(E,A,O,B){this.j=E,this.i=A,this.l=O,this.R=B||1,this.U=new Og(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new mS}function mS(){this.i=null,this.g="",this.h=!1}var pS={},yE={};function EE(E,A,O){E.L=1,E.v=qp(ua(A)),E.m=O,E.P=!0,US(E,null)}function US(E,A){E.F=Date.now(),Wp(E),E.A=ua(E.v);var O=E.A,B=E.R;Array.isArray(B)||(B=[String(B)]),kS(O.i,"t",B),E.C=0,O=E.j.J,E.h=new mS,E.g=KS(E.j,O?A:null,!E.m),0<E.O&&(E.M=new KK(f(E.Y,E,E.g),E.O)),A=E.U,O=E.g,B=E.ca;var Z="readystatechange";Array.isArray(Z)||(Z&&(oS[0]=Z.toString()),Z=oS);for(var ee=0;ee<Z.length;ee++){var Ue=$p(O,Z[ee],B||A.handleEvent,!1,A.h||A);if(!Ue)break;A.g[Ue.key]=Ue}A=E.H?T(E.H):{},E.m?(E.u||(E.u="POST"),A["Content-Type"]="application/x-www-form-urlencoded",E.g.ea(E.A,E.u,E.m,A)):(E.u="GET",E.g.ea(E.A,E.u,null,A)),Fg(),QK(E.i,E.u,E.A,E.l,E.R,E.m)}Sl.prototype.ca=function(E){E=E.target;const A=this.M;A&&da(E)==3?A.j():this.Y(E)},Sl.prototype.Y=function(E){try{if(E==this.g)e:{const Pi=da(this.g);var A=this.g.Ba();const Jd=this.g.Z();if(!(3>Pi)&&(Pi!=3||this.g&&(this.h.h||this.g.oa()||FS(this.g)))){this.J||Pi!=4||A==7||(A==8||0>=Jd?Fg(3):Fg(2)),vE(this);var O=this.g.Z();this.X=O;t:if(bS(this)){var B=FS(this.g);E="";var Z=B.length,ee=da(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){uu(this),Hg(this);var Ue="";break t}this.h.i=new a.TextDecoder}for(A=0;A<Z;A++)this.h.h=!0,E+=this.h.i.decode(B[A],{stream:!(ee&&A==Z-1)});B.length=0,this.h.g+=E,this.C=0,Ue=this.h.g}else Ue=this.g.oa();if(this.o=O==200,JK(this.i,this.u,this.A,this.l,this.R,Pi,O),this.o){if(this.T&&!this.K){t:{if(this.g){var $t,_i=this.g;if(($t=_i.g?_i.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!y($t)){var vt=$t;break t}}vt=null}if(O=vt)Zd(this.i,this.l,O,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,wE(this,O);else{this.o=!1,this.s=3,ts(12),uu(this),Hg(this);break e}}if(this.P){O=!0;let Nr;for(;!this.J&&this.C<Ue.length;)if(Nr=nZ(this,Ue),Nr==yE){Pi==4&&(this.s=4,ts(14),O=!1),Zd(this.i,this.l,null,"[Incomplete Response]");break}else if(Nr==pS){this.s=4,ts(15),Zd(this.i,this.l,Ue,"[Invalid Chunk]"),O=!1;break}else Zd(this.i,this.l,Nr,null),wE(this,Nr);if(bS(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Pi!=4||Ue.length!=0||this.h.h||(this.s=1,ts(16),O=!1),this.o=this.o&&O,!O)Zd(this.i,this.l,Ue,"[Invalid Chunked Response]"),uu(this),Hg(this);else if(0<Ue.length&&!this.W){this.W=!0;var Oi=this.j;Oi.g==this&&Oi.ba&&!Oi.M&&(Oi.j.info("Great, no buffering proxy detected. Bytes received: "+Ue.length),CE(Oi),Oi.M=!0,ts(11))}}else Zd(this.i,this.l,Ue,null),wE(this,Ue);Pi==4&&uu(this),this.o&&!this.J&&(Pi==4?XS(this.j,this):(this.o=!1,Wp(this)))}else yZ(this.g),O==400&&0<Ue.indexOf("Unknown SID")?(this.s=3,ts(12)):(this.s=0,ts(13)),uu(this),Hg(this)}}}catch{}finally{}};function bS(E){return E.g?E.u=="GET"&&E.L!=2&&E.j.Ca:!1}function nZ(E,A){var O=E.C,B=A.indexOf(`
`,O);return B==-1?yE:(O=Number(A.substring(O,B)),isNaN(O)?pS:(B+=1,B+O>A.length?yE:(A=A.slice(B,B+O),E.C=B+O,A)))}Sl.prototype.cancel=function(){this.J=!0,uu(this)};function Wp(E){E.S=Date.now()+E.I,yS(E,E.I)}function yS(E,A){if(E.B!=null)throw Error("WatchDog timer not null");E.B=Bg(f(E.ba,E),A)}function vE(E){E.B&&(a.clearTimeout(E.B),E.B=null)}Sl.prototype.ba=function(){this.B=null;const E=Date.now();0<=E-this.S?(eZ(this.i,this.A),this.L!=2&&(Fg(),ts(17)),uu(this),this.s=2,Hg(this)):yS(this,this.S-E)};function Hg(E){E.j.G==0||E.J||XS(E.j,E)}function uu(E){vE(E);var A=E.M;A&&typeof A.ma=="function"&&A.ma(),E.M=null,aS(E.U),E.g&&(A=E.g,E.g=null,A.abort(),A.ma())}function wE(E,A){try{var O=E.j;if(O.G!=0&&(O.g==E||_E(O.h,E))){if(!E.K&&_E(O.h,E)&&O.G==3){try{var B=O.Da.g.parse(A)}catch{B=null}if(Array.isArray(B)&&B.length==3){var Z=B;if(Z[0]==0){e:if(!O.u){if(O.g)if(O.g.F+3e3<E.F)iU(O),tU(O);else break e;xE(O),ts(18)}}else O.za=Z[1],0<O.za-O.T&&37500>Z[2]&&O.F&&O.v==0&&!O.C&&(O.C=Bg(f(O.Za,O),6e3));if(1>=wS(O.h)&&O.ca){try{O.ca()}catch{}O.ca=void 0}}else fu(O,11)}else if((E.K||O.g==E)&&iU(O),!y(A))for(Z=O.Da.g.parse(A),A=0;A<Z.length;A++){let vt=Z[A];if(O.T=vt[0],vt=vt[1],O.G==2)if(vt[0]=="c"){O.K=vt[1],O.ia=vt[2];const Oi=vt[3];Oi!=null&&(O.la=Oi,O.j.info("VER="+O.la));const Pi=vt[4];Pi!=null&&(O.Aa=Pi,O.j.info("SVER="+O.Aa));const Jd=vt[5];Jd!=null&&typeof Jd=="number"&&0<Jd&&(B=1.5*Jd,O.L=B,O.j.info("backChannelRequestTimeoutMs_="+B)),B=O;const Nr=E.g;if(Nr){const rU=Nr.g?Nr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(rU){var ee=B.h;ee.g||rU.indexOf("spdy")==-1&&rU.indexOf("quic")==-1&&rU.indexOf("h2")==-1||(ee.j=ee.l,ee.g=new Set,ee.h&&(TE(ee,ee.h),ee.h=null))}if(B.D){const AE=Nr.g?Nr.g.getResponseHeader("X-HTTP-Session-Id"):null;AE&&(B.ya=AE,Qt(B.I,B.D,AE))}}O.G=3,O.l&&O.l.ua(),O.ba&&(O.R=Date.now()-E.F,O.j.info("Handshake RTT: "+O.R+"ms")),B=O;var Ue=E;if(B.qa=WS(B,B.J?B.ia:null,B.W),Ue.K){_S(B.h,Ue);var $t=Ue,_i=B.L;_i&&($t.I=_i),$t.B&&(vE($t),Wp($t)),B.g=Ue}else $S(B);0<O.i.length&&nU(O)}else vt[0]!="stop"&&vt[0]!="close"||fu(O,7);else O.G==3&&(vt[0]=="stop"||vt[0]=="close"?vt[0]=="stop"?fu(O,7):SE(O):vt[0]!="noop"&&O.l&&O.l.ta(vt),O.v=0)}}Fg(4)}catch{}}var iZ=class{constructor(E,A){this.g=E,this.map=A}};function ES(E){this.l=E||10,a.PerformanceNavigationTiming?(E=a.performance.getEntriesByType("navigation"),E=0<E.length&&(E[0].nextHopProtocol=="hq"||E[0].nextHopProtocol=="h2")):E=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=E?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function vS(E){return E.h?!0:E.g?E.g.size>=E.j:!1}function wS(E){return E.h?1:E.g?E.g.size:0}function _E(E,A){return E.h?E.h==A:E.g?E.g.has(A):!1}function TE(E,A){E.g?E.g.add(A):E.h=A}function _S(E,A){E.h&&E.h==A?E.h=null:E.g&&E.g.has(A)&&E.g.delete(A)}ES.prototype.cancel=function(){if(this.i=TS(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const E of this.g.values())E.cancel();this.g.clear()}};function TS(E){if(E.h!=null)return E.i.concat(E.h.D);if(E.g!=null&&E.g.size!==0){let A=E.i;for(const O of E.g.values())A=A.concat(O.D);return A}return p(E.i)}function sZ(E){if(E.V&&typeof E.V=="function")return E.V();if(typeof Map<"u"&&E instanceof Map||typeof Set<"u"&&E instanceof Set)return Array.from(E.values());if(typeof E=="string")return E.split("");if(l(E)){for(var A=[],O=E.length,B=0;B<O;B++)A.push(E[B]);return A}A=[],O=0;for(B in E)A[O++]=E[B];return A}function rZ(E){if(E.na&&typeof E.na=="function")return E.na();if(!E.V||typeof E.V!="function"){if(typeof Map<"u"&&E instanceof Map)return Array.from(E.keys());if(!(typeof Set<"u"&&E instanceof Set)){if(l(E)||typeof E=="string"){var A=[];E=E.length;for(var O=0;O<E;O++)A.push(O);return A}A=[],O=0;for(const B in E)A[O++]=B;return A}}}function IS(E,A){if(E.forEach&&typeof E.forEach=="function")E.forEach(A,void 0);else if(l(E)||typeof E=="string")Array.prototype.forEach.call(E,A,void 0);else for(var O=rZ(E),B=sZ(E),Z=B.length,ee=0;ee<Z;ee++)A.call(void 0,B[ee],O&&O[ee],E)}var SS=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function oZ(E,A){if(E){E=E.split("&");for(var O=0;O<E.length;O++){var B=E[O].indexOf("="),Z=null;if(0<=B){var ee=E[O].substring(0,B);Z=E[O].substring(B+1)}else ee=E[O];A(ee,Z?decodeURIComponent(Z.replace(/\+/g," ")):"")}}}function du(E){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,E instanceof du){this.h=E.h,Kp(this,E.j),this.o=E.o,this.g=E.g,Zp(this,E.s),this.l=E.l;var A=E.i,O=new Gg;O.i=A.i,A.g&&(O.g=new Map(A.g),O.h=A.h),xS(this,O),this.m=E.m}else E&&(A=String(E).match(SS))?(this.h=!1,Kp(this,A[1]||"",!0),this.o=Vg(A[2]||""),this.g=Vg(A[3]||"",!0),Zp(this,A[4]),this.l=Vg(A[5]||"",!0),xS(this,A[6]||"",!0),this.m=Vg(A[7]||"")):(this.h=!1,this.i=new Gg(null,this.h))}du.prototype.toString=function(){var E=[],A=this.j;A&&E.push($g(A,CS,!0),":");var O=this.g;return(O||A=="file")&&(E.push("//"),(A=this.o)&&E.push($g(A,CS,!0),"@"),E.push(encodeURIComponent(String(O)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),O=this.s,O!=null&&E.push(":",String(O))),(O=this.l)&&(this.g&&O.charAt(0)!="/"&&E.push("/"),E.push($g(O,O.charAt(0)=="/"?cZ:lZ,!0))),(O=this.i.toString())&&E.push("?",O),(O=this.m)&&E.push("#",$g(O,dZ)),E.join("")};function ua(E){return new du(E)}function Kp(E,A,O){E.j=O?Vg(A,!0):A,E.j&&(E.j=E.j.replace(/:$/,""))}function Zp(E,A){if(A){if(A=Number(A),isNaN(A)||0>A)throw Error("Bad port number "+A);E.s=A}else E.s=null}function xS(E,A,O){A instanceof Gg?(E.i=A,fZ(E.i,E.h)):(O||(A=$g(A,uZ)),E.i=new Gg(A,E.h))}function Qt(E,A,O){E.i.set(A,O)}function qp(E){return Qt(E,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),E}function Vg(E,A){return E?A?decodeURI(E.replace(/%25/g,"%2525")):decodeURIComponent(E):""}function $g(E,A,O){return typeof E=="string"?(E=encodeURI(E).replace(A,aZ),O&&(E=E.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E):null}function aZ(E){return E=E.charCodeAt(0),"%"+(E>>4&15).toString(16)+(E&15).toString(16)}var CS=/[#\/\?@]/g,lZ=/[#\?:]/g,cZ=/[#\?]/g,uZ=/[#\?@]/g,dZ=/#/g;function Gg(E,A){this.h=this.g=null,this.i=E||null,this.j=!!A}function xl(E){E.g||(E.g=new Map,E.h=0,E.i&&oZ(E.i,function(A,O){E.add(decodeURIComponent(A.replace(/\+/g," ")),O)}))}e=Gg.prototype,e.add=function(E,A){xl(this),this.i=null,E=qd(this,E);var O=this.g.get(E);return O||this.g.set(E,O=[]),O.push(A),this.h+=1,this};function AS(E,A){xl(E),A=qd(E,A),E.g.has(A)&&(E.i=null,E.h-=E.g.get(A).length,E.g.delete(A))}function MS(E,A){return xl(E),A=qd(E,A),E.g.has(A)}e.forEach=function(E,A){xl(this),this.g.forEach(function(O,B){O.forEach(function(Z){E.call(A,Z,B,this)},this)},this)},e.na=function(){xl(this);const E=Array.from(this.g.values()),A=Array.from(this.g.keys()),O=[];for(let B=0;B<A.length;B++){const Z=E[B];for(let ee=0;ee<Z.length;ee++)O.push(A[B])}return O},e.V=function(E){xl(this);let A=[];if(typeof E=="string")MS(this,E)&&(A=A.concat(this.g.get(qd(this,E))));else{E=Array.from(this.g.values());for(let O=0;O<E.length;O++)A=A.concat(E[O])}return A},e.set=function(E,A){return xl(this),this.i=null,E=qd(this,E),MS(this,E)&&(this.h-=this.g.get(E).length),this.g.set(E,[A]),this.h+=1,this},e.get=function(E,A){return E?(E=this.V(E),0<E.length?String(E[0]):A):A};function kS(E,A,O){AS(E,A),0<O.length&&(E.i=null,E.g.set(qd(E,A),p(O)),E.h+=O.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const E=[],A=Array.from(this.g.keys());for(var O=0;O<A.length;O++){var B=A[O];const ee=encodeURIComponent(String(B)),Ue=this.V(B);for(B=0;B<Ue.length;B++){var Z=ee;Ue[B]!==""&&(Z+="="+encodeURIComponent(String(Ue[B]))),E.push(Z)}}return this.i=E.join("&")};function qd(E,A){return A=String(A),E.j&&(A=A.toLowerCase()),A}function fZ(E,A){A&&!E.j&&(xl(E),E.i=null,E.g.forEach(function(O,B){var Z=B.toLowerCase();B!=Z&&(AS(this,B),kS(this,Z,O))},E)),E.j=A}function hZ(E,A){const O=new zg;if(a.Image){const B=new Image;B.onload=h(Cl,O,"TestLoadImage: loaded",!0,A,B),B.onerror=h(Cl,O,"TestLoadImage: error",!1,A,B),B.onabort=h(Cl,O,"TestLoadImage: abort",!1,A,B),B.ontimeout=h(Cl,O,"TestLoadImage: timeout",!1,A,B),a.setTimeout(function(){B.ontimeout&&B.ontimeout()},1e4),B.src=E}else A(!1)}function gZ(E,A){const O=new zg,B=new AbortController,Z=setTimeout(()=>{B.abort(),Cl(O,"TestPingServer: timeout",!1,A)},1e4);fetch(E,{signal:B.signal}).then(ee=>{clearTimeout(Z),ee.ok?Cl(O,"TestPingServer: ok",!0,A):Cl(O,"TestPingServer: server error",!1,A)}).catch(()=>{clearTimeout(Z),Cl(O,"TestPingServer: error",!1,A)})}function Cl(E,A,O,B,Z){try{Z&&(Z.onload=null,Z.onerror=null,Z.onabort=null,Z.ontimeout=null),B(O)}catch{}}function mZ(){this.g=new qK}function pZ(E,A,O){const B=O||"";try{IS(E,function(Z,ee){let Ue=Z;c(Z)&&(Ue=gE(Z)),A.push(B+ee+"="+encodeURIComponent(Ue))})}catch(Z){throw A.push(B+"type="+encodeURIComponent("_badmap")),Z}}function Qp(E){this.l=E.Ub||null,this.j=E.eb||!1}m(Qp,mE),Qp.prototype.g=function(){return new Jp(this.l,this.j)},Qp.prototype.i=function(E){return function(){return E}}({});function Jp(E,A){Ni.call(this),this.D=E,this.o=A,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}m(Jp,Ni),e=Jp.prototype,e.open=function(E,A){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=E,this.A=A,this.readyState=1,jg(this)},e.send=function(E){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const A={headers:this.u,method:this.B,credentials:this.m,cache:void 0};E&&(A.body=E),(this.D||a).fetch(new Request(this.A,A)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Xg(this)),this.readyState=0},e.Sa=function(E){if(this.g&&(this.l=E,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=E.headers,this.readyState=2,jg(this)),this.g&&(this.readyState=3,jg(this),this.g)))if(this.responseType==="arraybuffer")E.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in E){if(this.j=E.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;RS(this)}else E.text().then(this.Ra.bind(this),this.ga.bind(this))};function RS(E){E.j.read().then(E.Pa.bind(E)).catch(E.ga.bind(E))}e.Pa=function(E){if(this.g){if(this.o&&E.value)this.response.push(E.value);else if(!this.o){var A=E.value?E.value:new Uint8Array(0);(A=this.v.decode(A,{stream:!E.done}))&&(this.response=this.responseText+=A)}E.done?Xg(this):jg(this),this.readyState==3&&RS(this)}},e.Ra=function(E){this.g&&(this.response=this.responseText=E,Xg(this))},e.Qa=function(E){this.g&&(this.response=E,Xg(this))},e.ga=function(){this.g&&Xg(this)};function Xg(E){E.readyState=4,E.l=null,E.j=null,E.v=null,jg(E)}e.setRequestHeader=function(E,A){this.u.append(E,A)},e.getResponseHeader=function(E){return this.h&&this.h.get(E.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const E=[],A=this.h.entries();for(var O=A.next();!O.done;)O=O.value,E.push(O[0]+": "+O[1]),O=A.next();return E.join(`\r
`)};function jg(E){E.onreadystatechange&&E.onreadystatechange.call(E)}Object.defineProperty(Jp.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(E){this.m=E?"include":"same-origin"}});function DS(E){let A="";return C(E,function(O,B){A+=B,A+=":",A+=O,A+=`\r
`}),A}function IE(E,A,O){e:{for(B in O){var B=!1;break e}B=!0}B||(O=DS(O),typeof E=="string"?O!=null&&encodeURIComponent(String(O)):Qt(E,A,O))}function En(E){Ni.call(this),this.headers=new Map,this.o=E||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}m(En,Ni);var UZ=/^https?$/i,bZ=["POST","PUT"];e=En.prototype,e.Ha=function(E){this.J=E},e.ea=function(E,A,O,B){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+E);A=A?A.toUpperCase():"GET",this.D=E,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():bE.g(),this.v=this.o?lS(this.o):lS(bE),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(A,String(E),!0),this.B=!1}catch(ee){LS(this,ee);return}if(E=O||"",O=new Map(this.headers),B)if(Object.getPrototypeOf(B)===Object.prototype)for(var Z in B)O.set(Z,B[Z]);else if(typeof B.keys=="function"&&typeof B.get=="function")for(const ee of B.keys())O.set(ee,B.get(ee));else throw Error("Unknown input type for opt_headers: "+String(B));B=Array.from(O.keys()).find(ee=>ee.toLowerCase()=="content-type"),Z=a.FormData&&E instanceof a.FormData,!(0<=Array.prototype.indexOf.call(bZ,A,void 0))||B||Z||O.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ee,Ue]of O)this.g.setRequestHeader(ee,Ue);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{PS(this),this.u=!0,this.g.send(E),this.u=!1}catch(ee){LS(this,ee)}};function LS(E,A){E.h=!1,E.g&&(E.j=!0,E.g.abort(),E.j=!1),E.l=A,E.m=5,NS(E),eU(E)}function NS(E){E.A||(E.A=!0,es(E,"complete"),es(E,"error"))}e.abort=function(E){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=E||7,es(this,"complete"),es(this,"abort"),eU(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),eU(this,!0)),En.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?OS(this):this.bb())},e.bb=function(){OS(this)};function OS(E){if(E.h&&typeof o<"u"&&(!E.v[1]||da(E)!=4||E.Z()!=2)){if(E.u&&da(E)==4)sS(E.Ea,0,E);else if(es(E,"readystatechange"),da(E)==4){E.h=!1;try{const Ue=E.Z();e:switch(Ue){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var A=!0;break e;default:A=!1}var O;if(!(O=A)){var B;if(B=Ue===0){var Z=String(E.D).match(SS)[1]||null;!Z&&a.self&&a.self.location&&(Z=a.self.location.protocol.slice(0,-1)),B=!UZ.test(Z?Z.toLowerCase():"")}O=B}if(O)es(E,"complete"),es(E,"success");else{E.m=6;try{var ee=2<da(E)?E.g.statusText:""}catch{ee=""}E.l=ee+" ["+E.Z()+"]",NS(E)}}finally{eU(E)}}}}function eU(E,A){if(E.g){PS(E);const O=E.g,B=E.v[0]?()=>{}:null;E.g=null,E.v=null,A||es(E,"ready");try{O.onreadystatechange=B}catch{}}}function PS(E){E.I&&(a.clearTimeout(E.I),E.I=null)}e.isActive=function(){return!!this.g};function da(E){return E.g?E.g.readyState:0}e.Z=function(){try{return 2<da(this)?this.g.status:-1}catch{return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},e.Oa=function(E){if(this.g){var A=this.g.responseText;return E&&A.indexOf(E)==0&&(A=A.substring(E.length)),ZK(A)}};function FS(E){try{if(!E.g)return null;if("response"in E.g)return E.g.response;switch(E.H){case"":case"text":return E.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in E.g)return E.g.mozResponseArrayBuffer}return null}catch{return null}}function yZ(E){const A={};E=(E.g&&2<=da(E)&&E.g.getAllResponseHeaders()||"").split(`\r
`);for(let B=0;B<E.length;B++){if(y(E[B]))continue;var O=R(E[B]);const Z=O[0];if(O=O[1],typeof O!="string")continue;O=O.trim();const ee=A[Z]||[];A[Z]=ee,ee.push(O)}_(A,function(B){return B.join(", ")})}e.Ba=function(){return this.m},e.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Yg(E,A,O){return O&&O.internalChannelParams&&O.internalChannelParams[E]||A}function BS(E){this.Aa=0,this.i=[],this.j=new zg,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Yg("failFast",!1,E),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Yg("baseRetryDelayMs",5e3,E),this.cb=Yg("retryDelaySeedMs",1e4,E),this.Wa=Yg("forwardChannelMaxRetries",2,E),this.wa=Yg("forwardChannelRequestTimeoutMs",2e4,E),this.pa=E&&E.xmlHttpFactory||void 0,this.Xa=E&&E.Tb||void 0,this.Ca=E&&E.useFetchStreams||!1,this.L=void 0,this.J=E&&E.supportsCrossDomainXhr||!1,this.K="",this.h=new ES(E&&E.concurrentRequestLimit),this.Da=new mZ,this.P=E&&E.fastHandshake||!1,this.O=E&&E.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=E&&E.Rb||!1,E&&E.xa&&this.j.xa(),E&&E.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&E&&E.detectBufferingProxy||!1,this.ja=void 0,E&&E.longPollingTimeout&&0<E.longPollingTimeout&&(this.ja=E.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}e=BS.prototype,e.la=8,e.G=1,e.connect=function(E,A,O,B){ts(0),this.W=E,this.H=A||{},O&&B!==void 0&&(this.H.OSID=O,this.H.OAID=B),this.F=this.X,this.I=WS(this,null,this.W),nU(this)};function SE(E){if(zS(E),E.G==3){var A=E.U++,O=ua(E.I);if(Qt(O,"SID",E.K),Qt(O,"RID",A),Qt(O,"TYPE","terminate"),Wg(E,O),A=new Sl(E,E.j,A),A.L=2,A.v=qp(ua(O)),O=!1,a.navigator&&a.navigator.sendBeacon)try{O=a.navigator.sendBeacon(A.v.toString(),"")}catch{}!O&&a.Image&&(new Image().src=A.v,O=!0),O||(A.g=KS(A.j,null),A.g.ea(A.v)),A.F=Date.now(),Wp(A)}YS(E)}function tU(E){E.g&&(CE(E),E.g.cancel(),E.g=null)}function zS(E){tU(E),E.u&&(a.clearTimeout(E.u),E.u=null),iU(E),E.h.cancel(),E.s&&(typeof E.s=="number"&&a.clearTimeout(E.s),E.s=null)}function nU(E){if(!vS(E.h)&&!E.s){E.s=!0;var A=E.Ga;V||W(),$||(V(),$=!0),j.add(A,E),E.B=0}}function EZ(E,A){return wS(E.h)>=E.h.j-(E.s?1:0)?!1:E.s?(E.i=A.D.concat(E.i),!0):E.G==1||E.G==2||E.B>=(E.Va?0:E.Wa)?!1:(E.s=Bg(f(E.Ga,E,A),jS(E,E.B)),E.B++,!0)}e.Ga=function(E){if(this.s)if(this.s=null,this.G==1){if(!E){this.U=Math.floor(1e5*Math.random()),E=this.U++;const Z=new Sl(this,this.j,E);let ee=this.o;if(this.S&&(ee?(ee=T(ee),S(ee,this.S)):ee=this.S),this.m!==null||this.O||(Z.H=ee,ee=null),this.P)e:{for(var A=0,O=0;O<this.i.length;O++){t:{var B=this.i[O];if("__data__"in B.map&&(B=B.map.__data__,typeof B=="string")){B=B.length;break t}B=void 0}if(B===void 0)break;if(A+=B,4096<A){A=O;break e}if(A===4096||O===this.i.length-1){A=O+1;break e}}A=1e3}else A=1e3;A=VS(this,Z,A),O=ua(this.I),Qt(O,"RID",E),Qt(O,"CVER",22),this.D&&Qt(O,"X-HTTP-Session-Id",this.D),Wg(this,O),ee&&(this.O?A="headers="+encodeURIComponent(String(DS(ee)))+"&"+A:this.m&&IE(O,this.m,ee)),TE(this.h,Z),this.Ua&&Qt(O,"TYPE","init"),this.P?(Qt(O,"$req",A),Qt(O,"SID","null"),Z.T=!0,EE(Z,O,null)):EE(Z,O,A),this.G=2}}else this.G==3&&(E?HS(this,E):this.i.length==0||vS(this.h)||HS(this))};function HS(E,A){var O;A?O=A.l:O=E.U++;const B=ua(E.I);Qt(B,"SID",E.K),Qt(B,"RID",O),Qt(B,"AID",E.T),Wg(E,B),E.m&&E.o&&IE(B,E.m,E.o),O=new Sl(E,E.j,O,E.B+1),E.m===null&&(O.H=E.o),A&&(E.i=A.D.concat(E.i)),A=VS(E,O,1e3),O.I=Math.round(.5*E.wa)+Math.round(.5*E.wa*Math.random()),TE(E.h,O),EE(O,B,A)}function Wg(E,A){E.H&&C(E.H,function(O,B){Qt(A,B,O)}),E.l&&IS({},function(O,B){Qt(A,B,O)})}function VS(E,A,O){O=Math.min(E.i.length,O);var B=E.l?f(E.l.Na,E.l,E):null;e:{var Z=E.i;let ee=-1;for(;;){const Ue=["count="+O];ee==-1?0<O?(ee=Z[0].g,Ue.push("ofs="+ee)):ee=0:Ue.push("ofs="+ee);let $t=!0;for(let _i=0;_i<O;_i++){let vt=Z[_i].g;const Oi=Z[_i].map;if(vt-=ee,0>vt)ee=Math.max(0,Z[_i].g-100),$t=!1;else try{pZ(Oi,Ue,"req"+vt+"_")}catch{B&&B(Oi)}}if($t){B=Ue.join("&");break e}}}return E=E.i.splice(0,O),A.D=E,B}function $S(E){if(!E.g&&!E.u){E.Y=1;var A=E.Fa;V||W(),$||(V(),$=!0),j.add(A,E),E.v=0}}function xE(E){return E.g||E.u||3<=E.v?!1:(E.Y++,E.u=Bg(f(E.Fa,E),jS(E,E.v)),E.v++,!0)}e.Fa=function(){if(this.u=null,GS(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var E=2*this.R;this.j.info("BP detection timer enabled: "+E),this.A=Bg(f(this.ab,this),E)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ts(10),tU(this),GS(this))};function CE(E){E.A!=null&&(a.clearTimeout(E.A),E.A=null)}function GS(E){E.g=new Sl(E,E.j,"rpc",E.Y),E.m===null&&(E.g.H=E.o),E.g.O=0;var A=ua(E.qa);Qt(A,"RID","rpc"),Qt(A,"SID",E.K),Qt(A,"AID",E.T),Qt(A,"CI",E.F?"0":"1"),!E.F&&E.ja&&Qt(A,"TO",E.ja),Qt(A,"TYPE","xmlhttp"),Wg(E,A),E.m&&E.o&&IE(A,E.m,E.o),E.L&&(E.g.I=E.L);var O=E.g;E=E.ia,O.L=1,O.v=qp(ua(A)),O.m=null,O.P=!0,US(O,E)}e.Za=function(){this.C!=null&&(this.C=null,tU(this),xE(this),ts(19))};function iU(E){E.C!=null&&(a.clearTimeout(E.C),E.C=null)}function XS(E,A){var O=null;if(E.g==A){iU(E),CE(E),E.g=null;var B=2}else if(_E(E.h,A))O=A.D,_S(E.h,A),B=1;else return;if(E.G!=0){if(A.o)if(B==1){O=A.m?A.m.length:0,A=Date.now()-A.F;var Z=E.B;B=Xp(),es(B,new hS(B,O)),nU(E)}else $S(E);else if(Z=A.s,Z==3||Z==0&&0<A.X||!(B==1&&EZ(E,A)||B==2&&xE(E)))switch(O&&0<O.length&&(A=E.h,A.i=A.i.concat(O)),Z){case 1:fu(E,5);break;case 4:fu(E,10);break;case 3:fu(E,6);break;default:fu(E,2)}}}function jS(E,A){let O=E.Ta+Math.floor(Math.random()*E.cb);return E.isActive()||(O*=2),O*A}function fu(E,A){if(E.j.info("Error code "+A),A==2){var O=f(E.fb,E),B=E.Xa;const Z=!B;B=new du(B||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Kp(B,"https"),qp(B),Z?hZ(B.toString(),O):gZ(B.toString(),O)}else ts(2);E.G=0,E.l&&E.l.sa(A),YS(E),zS(E)}e.fb=function(E){E?(this.j.info("Successfully pinged google.com"),ts(2)):(this.j.info("Failed to ping google.com"),ts(1))};function YS(E){if(E.G=0,E.ka=[],E.l){const A=TS(E.h);(A.length!=0||E.i.length!=0)&&(U(E.ka,A),U(E.ka,E.i),E.h.i.length=0,p(E.i),E.i.length=0),E.l.ra()}}function WS(E,A,O){var B=O instanceof du?ua(O):new du(O);if(B.g!="")A&&(B.g=A+"."+B.g),Zp(B,B.s);else{var Z=a.location;B=Z.protocol,A=A?A+"."+Z.hostname:Z.hostname,Z=+Z.port;var ee=new du(null);B&&Kp(ee,B),A&&(ee.g=A),Z&&Zp(ee,Z),O&&(ee.l=O),B=ee}return O=E.D,A=E.ya,O&&A&&Qt(B,O,A),Qt(B,"VER",E.la),Wg(E,B),B}function KS(E,A,O){if(A&&!E.J)throw Error("Can't create secondary domain capable XhrIo object.");return A=E.Ca&&!E.pa?new En(new Qp({eb:O})):new En(E.pa),A.Ha(E.J),A}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function ZS(){}e=ZS.prototype,e.ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){};function sU(){}sU.prototype.g=function(E,A){return new Rs(E,A)};function Rs(E,A){Ni.call(this),this.g=new BS(A),this.l=E,this.h=A&&A.messageUrlParams||null,E=A&&A.messageHeaders||null,A&&A.clientProtocolHeaderRequired&&(E?E["X-Client-Protocol"]="webchannel":E={"X-Client-Protocol":"webchannel"}),this.g.o=E,E=A&&A.initMessageHeaders||null,A&&A.messageContentType&&(E?E["X-WebChannel-Content-Type"]=A.messageContentType:E={"X-WebChannel-Content-Type":A.messageContentType}),A&&A.va&&(E?E["X-WebChannel-Client-Profile"]=A.va:E={"X-WebChannel-Client-Profile":A.va}),this.g.S=E,(E=A&&A.Sb)&&!y(E)&&(this.g.m=E),this.v=A&&A.supportsCrossDomainXhr||!1,this.u=A&&A.sendRawJson||!1,(A=A&&A.httpSessionIdParam)&&!y(A)&&(this.g.D=A,E=this.h,E!==null&&A in E&&(E=this.h,A in E&&delete E[A])),this.j=new Qd(this)}m(Rs,Ni),Rs.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Rs.prototype.close=function(){SE(this.g)},Rs.prototype.o=function(E){var A=this.g;if(typeof E=="string"){var O={};O.__data__=E,E=O}else this.u&&(O={},O.__data__=gE(E),E=O);A.i.push(new iZ(A.Ya++,E)),A.G==3&&nU(A)},Rs.prototype.N=function(){this.g.l=null,delete this.j,SE(this.g),delete this.g,Rs.aa.N.call(this)};function qS(E){pE.call(this),E.__headers__&&(this.headers=E.__headers__,this.statusCode=E.__status__,delete E.__headers__,delete E.__status__);var A=E.__sm__;if(A){e:{for(const O in A){E=O;break e}E=void 0}(this.i=E)&&(E=this.i,A=A!==null&&E in A?A[E]:void 0),this.data=A}else this.data=E}m(qS,pE);function QS(){UE.call(this),this.status=1}m(QS,UE);function Qd(E){this.g=E}m(Qd,ZS),Qd.prototype.ua=function(){es(this.g,"a")},Qd.prototype.ta=function(E){es(this.g,new qS(E))},Qd.prototype.sa=function(E){es(this.g,new QS)},Qd.prototype.ra=function(){es(this.g,"b")},sU.prototype.createWebChannel=sU.prototype.g,Rs.prototype.send=Rs.prototype.o,Rs.prototype.open=Rs.prototype.m,Rs.prototype.close=Rs.prototype.close,nW=function(){return new sU},tW=function(){return Xp()},eW=cu,jv={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},jp.NO_ERROR=0,jp.TIMEOUT=8,jp.HTTP_ERROR=6,tb=jp,gS.COMPLETE="complete",JY=gS,cS.EventType=Pg,Pg.OPEN="a",Pg.CLOSE="b",Pg.ERROR="c",Pg.MESSAGE="d",Ni.prototype.listen=Ni.prototype.K,Y1=cS,En.prototype.listenOnce=En.prototype.L,En.prototype.getLastError=En.prototype.Ka,En.prototype.getLastErrorCode=En.prototype.Ba,En.prototype.getStatus=En.prototype.Z,En.prototype.getResponseJson=En.prototype.Oa,En.prototype.getResponseText=En.prototype.oa,En.prototype.send=En.prototype.ea,En.prototype.setWithCredentials=En.prototype.Ha,QY=En}).apply(typeof s2<"u"?s2:typeof self<"u"?self:typeof window<"u"?window:{});const aL="@firebase/firestore",lL="4.7.8";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vi{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Vi.UNAUTHENTICATED=new Vi(null),Vi.GOOGLE_CREDENTIALS=new Vi("google-credentials-uid"),Vi.FIRST_PARTY=new Vi("first-party-uid"),Vi.MOCK_USER=new Vi("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kg="11.3.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xd=new HY("@firebase/firestore");function wf(){return xd.logLevel}function we(e,...t){if(xd.logLevel<=ut.DEBUG){const n=t.map(pI);xd.debug(`Firestore (${kg}): ${e}`,...n)}}function pl(e,...t){if(xd.logLevel<=ut.ERROR){const n=t.map(pI);xd.error(`Firestore (${kg}): ${e}`,...n)}}function eg(e,...t){if(xd.logLevel<=ut.WARN){const n=t.map(pI);xd.warn(`Firestore (${kg}): ${e}`,...n)}}function pI(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Le(e="Unexpected state"){const t=`FIRESTORE (${kg}) INTERNAL ASSERTION FAILED: `+e;throw pl(t),new Error(t)}function Xt(e,t){e||Le()}function nt(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const se={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ce extends Xd{constructor(t,n){super(t,n),this.code=t,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ac{constructor(){this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iW{constructor(t,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class B9e{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,n){t.enqueueRetryable(()=>n(Vi.UNAUTHENTICATED))}shutdown(){}}class z9e{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,n){this.changeListener=n,t.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class H9e{constructor(t){this.t=t,this.currentUser=Vi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,n){Xt(this.o===void 0);let i=this.i;const s=l=>this.i!==i?(i=this.i,n(l)):Promise.resolve();let r=new Ac;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new Ac,t.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=r;t.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{we("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(we("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new Ac)}},0),o()}getToken(){const t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(i=>this.i!==t?(we("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Xt(typeof i.accessToken=="string"),new iW(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return Xt(t===null||typeof t=="string"),new Vi(t)}}class V9e{constructor(t,n,i){this.l=t,this.h=n,this.P=i,this.type="FirstParty",this.user=Vi.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const t=this.I();return t&&this.T.set("Authorization",t),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class $9e{constructor(t,n,i){this.l=t,this.h=n,this.P=i}getToken(){return Promise.resolve(new V9e(this.l,this.h,this.P))}start(t,n){t.enqueueRetryable(()=>n(Vi.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class cL{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class G9e{constructor(t,n){this.A=n,this.forceRefresh=!1,this.appCheck=null,this.R=null,this.V=null,XY(t)&&t.settings.appCheckToken&&(this.V=t.settings.appCheckToken)}start(t,n){Xt(this.o===void 0);const i=r=>{r.error!=null&&we("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${r.error.message}`);const o=r.token!==this.R;return this.R=r.token,we("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(r.token):Promise.resolve()};this.o=r=>{t.enqueueRetryable(()=>i(r))};const s=r=>{we("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=r,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(r=>s(r)),setTimeout(()=>{if(!this.appCheck){const r=this.A.getImmediate({optional:!0});r?s(r):we("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.V)return Promise.resolve(new cL(this.V));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(n=>n?(Xt(typeof n.token=="string"),this.R=n.token,new cL(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X9e(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(n);else for(let i=0;i<e;i++)n[i]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sW{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const s=X9e(40);for(let r=0;r<s.length;++r)i.length<20&&s[r]<n&&(i+=t.charAt(s[r]%62))}return i}}function dt(e,t){return e<t?-1:e>t?1:0}function tg(e,t,n){return e.length===t.length&&e.every((i,s)=>n(i,t[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uL=-62135596800,dL=1e6;class Ei{static now(){return Ei.fromMillis(Date.now())}static fromDate(t){return Ei.fromMillis(t.getTime())}static fromMillis(t){const n=Math.floor(t/1e3),i=Math.floor((t-1e3*n)*dL);return new Ei(n,i)}constructor(t,n){if(this.seconds=t,this.nanoseconds=n,n<0)throw new Ce(se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Ce(se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<uL)throw new Ce(se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Ce(se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/dL}_compareTo(t){return this.seconds===t.seconds?dt(this.nanoseconds,t.nanoseconds):dt(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds-uL;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{static fromTimestamp(t){return new Pe(t)}static min(){return new Pe(new Ei(0,0))}static max(){return new Pe(new Ei(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fL="__name__";class Mo{constructor(t,n,i){n===void 0?n=0:n>t.length&&Le(),i===void 0?i=t.length-n:i>t.length-n&&Le(),this.segments=t,this.offset=n,this.len=i}get length(){return this.len}isEqual(t){return Mo.comparator(this,t)===0}child(t){const n=this.segments.slice(this.offset,this.limit());return t instanceof Mo?t.forEach(i=>{n.push(i)}):n.push(t),this.construct(n)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0}forEach(t){for(let n=this.offset,i=this.limit();n<i;n++)t(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,n){const i=Math.min(t.length,n.length);for(let s=0;s<i;s++){const r=Mo.compareSegments(t.get(s),n.get(s));if(r!==0)return r}return Math.sign(t.length-n.length)}static compareSegments(t,n){const i=Mo.isNumericId(t),s=Mo.isNumericId(n);return i&&!s?-1:!i&&s?1:i&&s?Mo.extractNumericId(t).compare(Mo.extractNumericId(n)):t<n?-1:t>n?1:0}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return Cc.fromString(t.substring(4,t.length-2))}}class ln extends Mo{construct(t,n,i){return new ln(t,n,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const n=[];for(const i of t){if(i.indexOf("//")>=0)throw new Ce(se.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);n.push(...i.split("/").filter(s=>s.length>0))}return new ln(n)}static emptyPath(){return new ln([])}}const j9e=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Xi extends Mo{construct(t,n,i){return new Xi(t,n,i)}static isValidIdentifier(t){return j9e.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Xi.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===fL}static keyField(){return new Xi([fL])}static fromServerFormat(t){const n=[];let i="",s=0;const r=()=>{if(i.length===0)throw new Ce(se.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(i),i=""};let o=!1;for(;s<t.length;){const a=t[s];if(a==="\\"){if(s+1===t.length)throw new Ce(se.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const l=t[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Ce(se.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);i+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(i+=a,s++):(r(),s++)}if(r(),o)throw new Ce(se.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Xi(n)}static emptyPath(){return new Xi([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ne{constructor(t){this.path=t}static fromPath(t){return new Ne(ln.fromString(t))}static fromName(t){return new Ne(ln.fromString(t).popFirst(5))}static empty(){return new Ne(ln.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&ln.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,n){return ln.comparator(t.path,n.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Ne(new ln(t.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zm=-1;function Y9e(e,t){const n=e.toTimestamp().seconds,i=e.toTimestamp().nanoseconds+1,s=Pe.fromTimestamp(i===1e9?new Ei(n+1,0):new Ei(n,i));return new Yc(s,Ne.empty(),t)}function W9e(e){return new Yc(e.readTime,e.key,zm)}class Yc{constructor(t,n,i){this.readTime=t,this.documentKey=n,this.largestBatchId=i}static min(){return new Yc(Pe.min(),Ne.empty(),zm)}static max(){return new Yc(Pe.max(),Ne.empty(),zm)}}function K9e(e,t){let n=e.readTime.compareTo(t.readTime);return n!==0?n:(n=Ne.comparator(e.documentKey,t.documentKey),n!==0?n:dt(e.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z9e="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class q9e{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ky(e){if(e.code!==se.FAILED_PRECONDITION||e.message!==Z9e)throw e;we("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ie{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(t){return this.next(void 0,t)}next(t,n){return this.callbackAttached&&Le(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new ie((i,s)=>{this.nextCallback=r=>{this.wrapSuccess(t,r).next(i,s)},this.catchCallback=r=>{this.wrapFailure(n,r).next(i,s)}})}toPromise(){return new Promise((t,n)=>{this.next(t,n)})}wrapUserFunction(t){try{const n=t();return n instanceof ie?n:ie.resolve(n)}catch(n){return ie.reject(n)}}wrapSuccess(t,n){return t?this.wrapUserFunction(()=>t(n)):ie.resolve(n)}wrapFailure(t,n){return t?this.wrapUserFunction(()=>t(n)):ie.reject(n)}static resolve(t){return new ie((n,i)=>{n(t)})}static reject(t){return new ie((n,i)=>{i(t)})}static waitFor(t){return new ie((n,i)=>{let s=0,r=0,o=!1;t.forEach(a=>{++s,a.next(()=>{++r,o&&r===s&&n()},l=>i(l))}),o=!0,r===s&&n()})}static or(t){let n=ie.resolve(!1);for(const i of t)n=n.next(s=>s?ie.resolve(s):i());return n}static forEach(t,n){const i=[];return t.forEach((s,r)=>{i.push(n.call(this,s,r))}),this.waitFor(i)}static mapArray(t,n){return new ie((i,s)=>{const r=t.length,o=new Array(r);let a=0;for(let l=0;l<r;l++){const c=l;n(t[c]).next(u=>{o[c]=u,++a,a===r&&i(o)},u=>s(u))}})}static doWhile(t,n){return new ie((i,s)=>{const r=()=>{t()===!0?n().next(()=>{r()},s):i()};r()})}}function Q9e(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Rg(e){return e.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zy{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=i=>this.oe(i),this._e=i=>n.writeSequenceNumber(i))}oe(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this._e&&this._e(t),t}}Zy.ae=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J9e=-1;function Fp(e){return e==null}function t5(e){return e===0&&1/e==-1/0}function e_e(e){return typeof e=="number"&&Number.isInteger(e)&&!t5(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rW="";function t_e(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=hL(t)),t=n_e(e.get(n),t);return hL(t)}function n_e(e,t){let n=t;const i=e.length;for(let s=0;s<i;s++){const r=e.charAt(s);switch(r){case"\0":n+="";break;case rW:n+="";break;default:n+=r}}return n}function hL(e){return e+rW+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gL(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function jd(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function oW(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ln{constructor(t,n){this.comparator=t,this.root=n||Ci.EMPTY}insert(t,n){return new Ln(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,Ci.BLACK,null,null))}remove(t){return new Ln(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Ci.BLACK,null,null))}get(t){let n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(i===0)return n.value;i<0?n=n.left:i>0&&(n=n.right)}return null}indexOf(t){let n=0,i=this.root;for(;!i.isEmpty();){const s=this.comparator(t,i.key);if(s===0)return n+i.left.size;s<0?i=i.left:(n+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((n,i)=>(t(n,i),!1))}toString(){const t=[];return this.inorderTraversal((n,i)=>(t.push(`${n}:${i}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new r2(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new r2(this.root,t,this.comparator,!1)}getReverseIterator(){return new r2(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new r2(this.root,t,this.comparator,!0)}}class r2{constructor(t,n,i,s){this.isReverse=s,this.nodeStack=[];let r=1;for(;!t.isEmpty();)if(r=n?i(t.key,n):1,n&&s&&(r*=-1),r<0)t=this.isReverse?t.left:t.right;else{if(r===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const n={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Ci{constructor(t,n,i,s,r){this.key=t,this.value=n,this.color=i??Ci.RED,this.left=s??Ci.EMPTY,this.right=r??Ci.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,n,i,s,r){return new Ci(t??this.key,n??this.value,i??this.color,s??this.left,r??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,n,i){let s=this;const r=i(t,s.key);return s=r<0?s.copy(null,null,null,s.left.insert(t,n,i),null):r===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(t,n,i)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Ci.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,n){let i,s=this;if(n(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(t,s.key)===0){if(s.right.isEmpty())return Ci.EMPTY;i=s.right.min(),s=s.copy(i.key,i.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Ci.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Ci.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,n)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Le();const t=this.left.check();if(t!==this.right.check())throw Le();return t+(this.isRed()?0:1)}}Ci.EMPTY=null,Ci.RED=!0,Ci.BLACK=!1;Ci.EMPTY=new class{constructor(){this.size=0}get key(){throw Le()}get value(){throw Le()}get color(){throw Le()}get left(){throw Le()}get right(){throw Le()}copy(t,n,i,s,r){return this}insert(t,n,i){return new Ci(t,n)}remove(t,n){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(t){this.comparator=t,this.data=new Ln(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((n,i)=>(t(n),!1))}forEachInRange(t,n){const i=this.data.getIteratorFrom(t[0]);for(;i.hasNext();){const s=i.getNext();if(this.comparator(s.key,t[1])>=0)return;n(s.key)}}forEachWhile(t,n){let i;for(i=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();i.hasNext();)if(!t(i.getNext().key))return}firstAfterOrEqual(t){const n=this.data.getIteratorFrom(t);return n.hasNext()?n.getNext().key:null}getIterator(){return new mL(this.data.getIterator())}getIteratorFrom(t){return new mL(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let n=this;return n.size<t.size&&(n=t,t=this),t.forEach(i=>{n=n.add(i)}),n}isEqual(t){if(!(t instanceof ni)||this.size!==t.size)return!1;const n=this.data.getIterator(),i=t.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,r=i.getNext().key;if(this.comparator(s,r)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(n=>{t.push(n)}),t}toString(){const t=[];return this.forEach(n=>t.push(n)),"SortedSet("+t.toString()+")"}copy(t){const n=new ni(this.comparator);return n.data=t,n}}class mL{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{constructor(t){this.fields=t,t.sort(Xi.comparator)}static empty(){return new wr([])}unionWith(t){let n=new ni(Xi.comparator);for(const i of this.fields)n=n.add(i);for(const i of t)n=n.add(i);return new wr(n.toArray())}covers(t){for(const n of this.fields)if(n.isPrefixOf(t))return!0;return!1}isEqual(t){return tg(this.fields,t.fields,(n,i)=>n.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aW extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Li{constructor(t){this.binaryString=t}static fromBase64String(t){const n=function(s){try{return atob(s)}catch(r){throw typeof DOMException<"u"&&r instanceof DOMException?new aW("Invalid base64 string: "+r):r}}(t);return new Li(n)}static fromUint8Array(t){const n=function(s){let r="";for(let o=0;o<s.length;++o)r+=String.fromCharCode(s[o]);return r}(t);return new Li(n)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const i=new Uint8Array(n.length);for(let s=0;s<n.length;s++)i[s]=n.charCodeAt(s);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return dt(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Li.EMPTY_BYTE_STRING=new Li("");const i_e=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Wc(e){if(Xt(!!e),typeof e=="string"){let t=0;const n=i_e.exec(e);if(Xt(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),t=Number(s)}const i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:kn(e.seconds),nanos:kn(e.nanos)}}function kn(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function Kc(e){return typeof e=="string"?Li.fromBase64String(e):Li.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lW="server_timestamp",cW="__type__",uW="__previous_value__",dW="__local_write_time__";function UI(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{})[cW])===null||n===void 0?void 0:n.stringValue)===lW}function qy(e){const t=e.mapValue.fields[uW];return UI(t)?qy(t):t}function Hm(e){const t=Wc(e.mapValue.fields[dW].timestampValue);return new Ei(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s_e{constructor(t,n,i,s,r,o,a,l,c){this.databaseId=t,this.appId=n,this.persistenceKey=i,this.host=s,this.ssl=r,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}}const n5="(default)";class Vm{constructor(t,n){this.projectId=t,this.database=n||n5}static empty(){return new Vm("","")}get isDefaultDatabase(){return this.database===n5}isEqual(t){return t instanceof Vm&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fW="__type__",r_e="__max__",o2={mapValue:{}},hW="__vector__",i5="value";function Zc(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?UI(e)?4:a_e(e)?9007199254740991:o_e(e)?10:11:Le()}function sa(e,t){if(e===t)return!0;const n=Zc(e);if(n!==Zc(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Hm(e).isEqual(Hm(t));case 3:return function(s,r){if(typeof s.timestampValue=="string"&&typeof r.timestampValue=="string"&&s.timestampValue.length===r.timestampValue.length)return s.timestampValue===r.timestampValue;const o=Wc(s.timestampValue),a=Wc(r.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(s,r){return Kc(s.bytesValue).isEqual(Kc(r.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(s,r){return kn(s.geoPointValue.latitude)===kn(r.geoPointValue.latitude)&&kn(s.geoPointValue.longitude)===kn(r.geoPointValue.longitude)}(e,t);case 2:return function(s,r){if("integerValue"in s&&"integerValue"in r)return kn(s.integerValue)===kn(r.integerValue);if("doubleValue"in s&&"doubleValue"in r){const o=kn(s.doubleValue),a=kn(r.doubleValue);return o===a?t5(o)===t5(a):isNaN(o)&&isNaN(a)}return!1}(e,t);case 9:return tg(e.arrayValue.values||[],t.arrayValue.values||[],sa);case 10:case 11:return function(s,r){const o=s.mapValue.fields||{},a=r.mapValue.fields||{};if(gL(o)!==gL(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!sa(o[l],a[l])))return!1;return!0}(e,t);default:return Le()}}function $m(e,t){return(e.values||[]).find(n=>sa(n,t))!==void 0}function ng(e,t){if(e===t)return 0;const n=Zc(e),i=Zc(t);if(n!==i)return dt(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return dt(e.booleanValue,t.booleanValue);case 2:return function(r,o){const a=kn(r.integerValue||r.doubleValue),l=kn(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(e,t);case 3:return pL(e.timestampValue,t.timestampValue);case 4:return pL(Hm(e),Hm(t));case 5:return dt(e.stringValue,t.stringValue);case 6:return function(r,o){const a=Kc(r),l=Kc(o);return a.compareTo(l)}(e.bytesValue,t.bytesValue);case 7:return function(r,o){const a=r.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const u=dt(a[c],l[c]);if(u!==0)return u}return dt(a.length,l.length)}(e.referenceValue,t.referenceValue);case 8:return function(r,o){const a=dt(kn(r.latitude),kn(o.latitude));return a!==0?a:dt(kn(r.longitude),kn(o.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return UL(e.arrayValue,t.arrayValue);case 10:return function(r,o){var a,l,c,u;const d=r.fields||{},f=o.fields||{},h=(a=d[i5])===null||a===void 0?void 0:a.arrayValue,m=(l=f[i5])===null||l===void 0?void 0:l.arrayValue,p=dt(((c=h==null?void 0:h.values)===null||c===void 0?void 0:c.length)||0,((u=m==null?void 0:m.values)===null||u===void 0?void 0:u.length)||0);return p!==0?p:UL(h,m)}(e.mapValue,t.mapValue);case 11:return function(r,o){if(r===o2.mapValue&&o===o2.mapValue)return 0;if(r===o2.mapValue)return 1;if(o===o2.mapValue)return-1;const a=r.fields||{},l=Object.keys(a),c=o.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let d=0;d<l.length&&d<u.length;++d){const f=dt(l[d],u[d]);if(f!==0)return f;const h=ng(a[l[d]],c[u[d]]);if(h!==0)return h}return dt(l.length,u.length)}(e.mapValue,t.mapValue);default:throw Le()}}function pL(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return dt(e,t);const n=Wc(e),i=Wc(t),s=dt(n.seconds,i.seconds);return s!==0?s:dt(n.nanos,i.nanos)}function UL(e,t){const n=e.values||[],i=t.values||[];for(let s=0;s<n.length&&s<i.length;++s){const r=ng(n[s],i[s]);if(r)return r}return dt(n.length,i.length)}function ig(e){return Yv(e)}function Yv(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(n){const i=Wc(n);return`time(${i.seconds},${i.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(n){return Kc(n).toBase64()}(e.bytesValue):"referenceValue"in e?function(n){return Ne.fromName(n).toString()}(e.referenceValue):"geoPointValue"in e?function(n){return`geo(${n.latitude},${n.longitude})`}(e.geoPointValue):"arrayValue"in e?function(n){let i="[",s=!0;for(const r of n.values||[])s?s=!1:i+=",",i+=Yv(r);return i+"]"}(e.arrayValue):"mapValue"in e?function(n){const i=Object.keys(n.fields||{}).sort();let s="{",r=!0;for(const o of i)r?r=!1:s+=",",s+=`${o}:${Yv(n.fields[o])}`;return s+"}"}(e.mapValue):Le()}function nb(e){switch(Zc(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=qy(e);return t?16+nb(t):16;case 5:return 2*e.stringValue.length;case 6:return Kc(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(i){return(i.values||[]).reduce((s,r)=>s+nb(r),0)}(e.arrayValue);case 10:case 11:return function(i){let s=0;return jd(i.fields,(r,o)=>{s+=r.length+nb(o)}),s}(e.mapValue);default:throw Le()}}function Wv(e){return!!e&&"integerValue"in e}function bI(e){return!!e&&"arrayValue"in e}function bL(e){return!!e&&"nullValue"in e}function yL(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function X3(e){return!!e&&"mapValue"in e}function o_e(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{})[fW])===null||n===void 0?void 0:n.stringValue)===hW}function L0(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return jd(e.mapValue.fields,(n,i)=>t.mapValue.fields[n]=L0(i)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=L0(e.arrayValue.values[n]);return t}return Object.assign({},e)}function a_e(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===r_e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es{constructor(t){this.value=t}static empty(){return new Es({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let n=this.value;for(let i=0;i<t.length-1;++i)if(n=(n.mapValue.fields||{})[t.get(i)],!X3(n))return null;return n=(n.mapValue.fields||{})[t.lastSegment()],n||null}}set(t,n){this.getFieldsMap(t.popLast())[t.lastSegment()]=L0(n)}setAll(t){let n=Xi.emptyPath(),i={},s=[];t.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,i,s),i={},s=[],n=a.popLast()}o?i[a.lastSegment()]=L0(o):s.push(a.lastSegment())});const r=this.getFieldsMap(n);this.applyChanges(r,i,s)}delete(t){const n=this.field(t.popLast());X3(n)&&n.mapValue.fields&&delete n.mapValue.fields[t.lastSegment()]}isEqual(t){return sa(this.value,t.value)}getFieldsMap(t){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let i=0;i<t.length;++i){let s=n.mapValue.fields[t.get(i)];X3(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[t.get(i)]=s),n=s}return n.mapValue.fields}applyChanges(t,n,i){jd(n,(s,r)=>t[s]=r);for(const s of i)delete t[s]}clone(){return new Es(L0(this.value))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(t,n,i,s,r,o,a){this.key=t,this.documentType=n,this.version=i,this.readTime=s,this.createTime=r,this.data=o,this.documentState=a}static newInvalidDocument(t){return new mi(t,0,Pe.min(),Pe.min(),Pe.min(),Es.empty(),0)}static newFoundDocument(t,n,i,s){return new mi(t,1,n,Pe.min(),i,s,0)}static newNoDocument(t,n){return new mi(t,2,n,Pe.min(),Pe.min(),Es.empty(),0)}static newUnknownDocument(t,n){return new mi(t,3,n,Pe.min(),Pe.min(),Es.empty(),2)}convertToFoundDocument(t,n){return!this.createTime.isEqual(Pe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Es.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Es.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Pe.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof mi&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new mi(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s5{constructor(t,n){this.position=t,this.inclusive=n}}function EL(e,t,n){let i=0;for(let s=0;s<e.position.length;s++){const r=t[s],o=e.position[s];if(r.field.isKeyField()?i=Ne.comparator(Ne.fromName(o.referenceValue),n.key):i=ng(o,n.data.field(r.field)),r.dir==="desc"&&(i*=-1),i!==0)break}return i}function vL(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!sa(e.position[n],t.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r5{constructor(t,n="asc"){this.field=t,this.dir=n}}function l_e(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gW{}class ti extends gW{constructor(t,n,i){super(),this.field=t,this.op=n,this.value=i}static create(t,n,i){return t.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(t,n,i):new u_e(t,n,i):n==="array-contains"?new h_e(t,i):n==="in"?new g_e(t,i):n==="not-in"?new m_e(t,i):n==="array-contains-any"?new p_e(t,i):new ti(t,n,i)}static createKeyFieldInFilter(t,n,i){return n==="in"?new d_e(t,i):new f_e(t,i)}matches(t){const n=t.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(ng(n,this.value)):n!==null&&Zc(this.value)===Zc(n)&&this.matchesComparison(ng(n,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return Le()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ra extends gW{constructor(t,n){super(),this.filters=t,this.op=n,this.ce=null}static create(t,n){return new ra(t,n)}matches(t){return mW(this)?this.filters.find(n=>!n.matches(t))===void 0:this.filters.find(n=>n.matches(t))!==void 0}getFlattenedFilters(){return this.ce!==null||(this.ce=this.filters.reduce((t,n)=>t.concat(n.getFlattenedFilters()),[])),this.ce}getFilters(){return Object.assign([],this.filters)}}function mW(e){return e.op==="and"}function pW(e){return c_e(e)&&mW(e)}function c_e(e){for(const t of e.filters)if(t instanceof ra)return!1;return!0}function Kv(e){if(e instanceof ti)return e.field.canonicalString()+e.op.toString()+ig(e.value);if(pW(e))return e.filters.map(t=>Kv(t)).join(",");{const t=e.filters.map(n=>Kv(n)).join(",");return`${e.op}(${t})`}}function UW(e,t){return e instanceof ti?function(i,s){return s instanceof ti&&i.op===s.op&&i.field.isEqual(s.field)&&sa(i.value,s.value)}(e,t):e instanceof ra?function(i,s){return s instanceof ra&&i.op===s.op&&i.filters.length===s.filters.length?i.filters.reduce((r,o,a)=>r&&UW(o,s.filters[a]),!0):!1}(e,t):void Le()}function bW(e){return e instanceof ti?function(n){return`${n.field.canonicalString()} ${n.op} ${ig(n.value)}`}(e):e instanceof ra?function(n){return n.op.toString()+" {"+n.getFilters().map(bW).join(" ,")+"}"}(e):"Filter"}class u_e extends ti{constructor(t,n,i){super(t,n,i),this.key=Ne.fromName(i.referenceValue)}matches(t){const n=Ne.comparator(t.key,this.key);return this.matchesComparison(n)}}class d_e extends ti{constructor(t,n){super(t,"in",n),this.keys=yW("in",n)}matches(t){return this.keys.some(n=>n.isEqual(t.key))}}class f_e extends ti{constructor(t,n){super(t,"not-in",n),this.keys=yW("not-in",n)}matches(t){return!this.keys.some(n=>n.isEqual(t.key))}}function yW(e,t){var n;return(((n=t.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(i=>Ne.fromName(i.referenceValue))}class h_e extends ti{constructor(t,n){super(t,"array-contains",n)}matches(t){const n=t.data.field(this.field);return bI(n)&&$m(n.arrayValue,this.value)}}class g_e extends ti{constructor(t,n){super(t,"in",n)}matches(t){const n=t.data.field(this.field);return n!==null&&$m(this.value.arrayValue,n)}}class m_e extends ti{constructor(t,n){super(t,"not-in",n)}matches(t){if($m(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=t.data.field(this.field);return n!==null&&!$m(this.value.arrayValue,n)}}class p_e extends ti{constructor(t,n){super(t,"array-contains-any",n)}matches(t){const n=t.data.field(this.field);return!(!bI(n)||!n.arrayValue.values)&&n.arrayValue.values.some(i=>$m(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U_e{constructor(t,n=null,i=[],s=[],r=null,o=null,a=null){this.path=t,this.collectionGroup=n,this.orderBy=i,this.filters=s,this.limit=r,this.startAt=o,this.endAt=a,this.le=null}}function wL(e,t=null,n=[],i=[],s=null,r=null,o=null){return new U_e(e,t,n,i,s,r,o)}function yI(e){const t=nt(e);if(t.le===null){let n=t.path.canonicalString();t.collectionGroup!==null&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(i=>Kv(i)).join(","),n+="|ob:",n+=t.orderBy.map(i=>function(r){return r.field.canonicalString()+r.dir}(i)).join(","),Fp(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(i=>ig(i)).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(i=>ig(i)).join(",")),t.le=n}return t.le}function EI(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!l_e(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!UW(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!vL(e.startAt,t.startAt)&&vL(e.endAt,t.endAt)}function Zv(e){return Ne.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qy{constructor(t,n=null,i=[],s=[],r=null,o="F",a=null,l=null){this.path=t,this.collectionGroup=n,this.explicitOrderBy=i,this.filters=s,this.limit=r,this.limitType=o,this.startAt=a,this.endAt=l,this.he=null,this.Pe=null,this.Te=null,this.startAt,this.endAt}}function b_e(e,t,n,i,s,r,o,a){return new Qy(e,t,n,i,s,r,o,a)}function vI(e){return new Qy(e)}function _L(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function y_e(e){return e.collectionGroup!==null}function N0(e){const t=nt(e);if(t.he===null){t.he=[];const n=new Set;for(const r of t.explicitOrderBy)t.he.push(r),n.add(r.field.canonicalString());const i=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new ni(Xi.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(t).forEach(r=>{n.has(r.canonicalString())||r.isKeyField()||t.he.push(new r5(r,i))}),n.has(Xi.keyField().canonicalString())||t.he.push(new r5(Xi.keyField(),i))}return t.he}function jo(e){const t=nt(e);return t.Pe||(t.Pe=E_e(t,N0(e))),t.Pe}function E_e(e,t){if(e.limitType==="F")return wL(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(s=>{const r=s.dir==="desc"?"asc":"desc";return new r5(s.field,r)});const n=e.endAt?new s5(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new s5(e.startAt.position,e.startAt.inclusive):null;return wL(e.path,e.collectionGroup,t,e.filters,e.limit,n,i)}}function qv(e,t,n){return new Qy(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Jy(e,t){return EI(jo(e),jo(t))&&e.limitType===t.limitType}function EW(e){return`${yI(jo(e))}|lt:${e.limitType}`}function _f(e){return`Query(target=${function(n){let i=n.path.canonicalString();return n.collectionGroup!==null&&(i+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(i+=`, filters: [${n.filters.map(s=>bW(s)).join(", ")}]`),Fp(n.limit)||(i+=", limit: "+n.limit),n.orderBy.length>0&&(i+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(i+=", startAt: ",i+=n.startAt.inclusive?"b:":"a:",i+=n.startAt.position.map(s=>ig(s)).join(",")),n.endAt&&(i+=", endAt: ",i+=n.endAt.inclusive?"a:":"b:",i+=n.endAt.position.map(s=>ig(s)).join(",")),`Target(${i})`}(jo(e))}; limitType=${e.limitType})`}function eE(e,t){return t.isFoundDocument()&&function(i,s){const r=s.key.path;return i.collectionGroup!==null?s.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(r):Ne.isDocumentKey(i.path)?i.path.isEqual(r):i.path.isImmediateParentOf(r)}(e,t)&&function(i,s){for(const r of N0(i))if(!r.field.isKeyField()&&s.data.field(r.field)===null)return!1;return!0}(e,t)&&function(i,s){for(const r of i.filters)if(!r.matches(s))return!1;return!0}(e,t)&&function(i,s){return!(i.startAt&&!function(o,a,l){const c=EL(o,a,l);return o.inclusive?c<=0:c<0}(i.startAt,N0(i),s)||i.endAt&&!function(o,a,l){const c=EL(o,a,l);return o.inclusive?c>=0:c>0}(i.endAt,N0(i),s))}(e,t)}function v_e(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function vW(e){return(t,n)=>{let i=!1;for(const s of N0(e)){const r=w_e(s,t,n);if(r!==0)return r;i=i||s.field.isKeyField()}return 0}}function w_e(e,t,n){const i=e.field.isKeyField()?Ne.comparator(t.key,n.key):function(r,o,a){const l=o.data.field(r),c=a.data.field(r);return l!==null&&c!==null?ng(l,c):Le()}(e.field,t,n);switch(e.dir){case"asc":return i;case"desc":return-1*i;default:return Le()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yd{constructor(t,n){this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}get(t){const n=this.mapKeyFn(t),i=this.inner[n];if(i!==void 0){for(const[s,r]of i)if(this.equalsFn(s,t))return r}}has(t){return this.get(t)!==void 0}set(t,n){const i=this.mapKeyFn(t),s=this.inner[i];if(s===void 0)return this.inner[i]=[[t,n]],void this.innerSize++;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],t))return void(s[r]=[t,n]);s.push([t,n]),this.innerSize++}delete(t){const n=this.mapKeyFn(t),i=this.inner[n];if(i===void 0)return!1;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],t))return i.length===1?delete this.inner[n]:i.splice(s,1),this.innerSize--,!0;return!1}forEach(t){jd(this.inner,(n,i)=>{for(const[s,r]of i)t(s,r)})}isEmpty(){return oW(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const __e=new Ln(Ne.comparator);function qc(){return __e}const wW=new Ln(Ne.comparator);function W1(...e){let t=wW;for(const n of e)t=t.insert(n.key,n);return t}function T_e(e){let t=wW;return e.forEach((n,i)=>t=t.insert(n,i.overlayedDocument)),t}function zu(){return O0()}function _W(){return O0()}function O0(){return new Yd(e=>e.toString(),(e,t)=>e.isEqual(t))}const I_e=new ni(Ne.comparator);function Et(...e){let t=I_e;for(const n of e)t=t.add(n);return t}const S_e=new ni(dt);function x_e(){return S_e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wI(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:t5(t)?"-0":t}}function TW(e){return{integerValue:""+e}}function C_e(e,t){return e_e(t)?TW(t):wI(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tE{constructor(){this._=void 0}}function A_e(e,t,n){return e instanceof o5?function(s,r){const o={fields:{[cW]:{stringValue:lW},[dW]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return r&&UI(r)&&(r=qy(r)),r&&(o.fields[uW]=r),{mapValue:o}}(n,t):e instanceof Gm?IW(e,t):e instanceof Xm?SW(e,t):function(s,r){const o=k_e(s,r),a=TL(o)+TL(s.Ie);return Wv(o)&&Wv(s.Ie)?TW(a):wI(s.serializer,a)}(e,t)}function M_e(e,t,n){return e instanceof Gm?IW(e,t):e instanceof Xm?SW(e,t):n}function k_e(e,t){return e instanceof a5?function(i){return Wv(i)||function(r){return!!r&&"doubleValue"in r}(i)}(t)?t:{integerValue:0}:null}class o5 extends tE{}class Gm extends tE{constructor(t){super(),this.elements=t}}function IW(e,t){const n=xW(t);for(const i of e.elements)n.some(s=>sa(s,i))||n.push(i);return{arrayValue:{values:n}}}class Xm extends tE{constructor(t){super(),this.elements=t}}function SW(e,t){let n=xW(t);for(const i of e.elements)n=n.filter(s=>!sa(s,i));return{arrayValue:{values:n}}}class a5 extends tE{constructor(t,n){super(),this.serializer=t,this.Ie=n}}function TL(e){return kn(e.integerValue||e.doubleValue)}function xW(e){return bI(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}function R_e(e,t){return e.field.isEqual(t.field)&&function(i,s){return i instanceof Gm&&s instanceof Gm||i instanceof Xm&&s instanceof Xm?tg(i.elements,s.elements,sa):i instanceof a5&&s instanceof a5?sa(i.Ie,s.Ie):i instanceof o5&&s instanceof o5}(e.transform,t.transform)}class br{constructor(t,n){this.updateTime=t,this.exists=n}static none(){return new br}static exists(t){return new br(void 0,t)}static updateTime(t){return new br(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function ib(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class nE{}function CW(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new _I(e.key,br.none()):new Bp(e.key,e.data,br.none());{const n=e.data,i=Es.empty();let s=new ni(Xi.comparator);for(let r of t.fields)if(!s.has(r)){let o=n.field(r);o===null&&r.length>1&&(r=r.popLast(),o=n.field(r)),o===null?i.delete(r):i.set(r,o),s=s.add(r)}return new Wd(e.key,i,new wr(s.toArray()),br.none())}}function D_e(e,t,n){e instanceof Bp?function(s,r,o){const a=s.value.clone(),l=SL(s.fieldTransforms,r,o.transformResults);a.setAll(l),r.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(e,t,n):e instanceof Wd?function(s,r,o){if(!ib(s.precondition,r))return void r.convertToUnknownDocument(o.version);const a=SL(s.fieldTransforms,r,o.transformResults),l=r.data;l.setAll(AW(s)),l.setAll(a),r.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(e,t,n):function(s,r,o){r.convertToNoDocument(o.version).setHasCommittedMutations()}(0,t,n)}function P0(e,t,n,i){return e instanceof Bp?function(r,o,a,l){if(!ib(r.precondition,o))return a;const c=r.value.clone(),u=xL(r.fieldTransforms,l,o);return c.setAll(u),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(e,t,n,i):e instanceof Wd?function(r,o,a,l){if(!ib(r.precondition,o))return a;const c=xL(r.fieldTransforms,l,o),u=o.data;return u.setAll(AW(r)),u.setAll(c),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map(d=>d.field))}(e,t,n,i):function(r,o,a){return ib(r.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(e,t,n)}function IL(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(i,s){return i===void 0&&s===void 0||!(!i||!s)&&tg(i,s,(r,o)=>R_e(r,o))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Bp extends nE{constructor(t,n,i,s=[]){super(),this.key=t,this.value=n,this.precondition=i,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Wd extends nE{constructor(t,n,i,s,r=[]){super(),this.key=t,this.data=n,this.fieldMask=i,this.precondition=s,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function AW(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const i=e.data.field(n);t.set(n,i)}}),t}function SL(e,t,n){const i=new Map;Xt(e.length===n.length);for(let s=0;s<n.length;s++){const r=e[s],o=r.transform,a=t.data.field(r.field);i.set(r.field,M_e(o,a,n[s]))}return i}function xL(e,t,n){const i=new Map;for(const s of e){const r=s.transform,o=n.data.field(s.field);i.set(s.field,A_e(r,o,t))}return i}class _I extends nE{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class MW extends nE{constructor(t,n){super(),this.key=t,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L_e{constructor(t,n,i,s){this.batchId=t,this.localWriteTime=n,this.baseMutations=i,this.mutations=s}applyToRemoteDocument(t,n){const i=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const r=this.mutations[s];r.key.isEqual(t.key)&&D_e(r,t,i[s])}}applyToLocalView(t,n){for(const i of this.baseMutations)i.key.isEqual(t.key)&&(n=P0(i,t,n,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(t.key)&&(n=P0(i,t,n,this.localWriteTime));return n}applyToLocalDocumentSet(t,n){const i=_W();return this.mutations.forEach(s=>{const r=t.get(s.key),o=r.overlayedDocument;let a=this.applyToLocalView(o,r.mutatedFields);a=n.has(s.key)?null:a;const l=CW(o,a);l!==null&&i.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(Pe.min())}),i}keys(){return this.mutations.reduce((t,n)=>t.add(n.key),Et())}isEqual(t){return this.batchId===t.batchId&&tg(this.mutations,t.mutations,(n,i)=>IL(n,i))&&tg(this.baseMutations,t.baseMutations,(n,i)=>IL(n,i))}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N_e{constructor(t,n){this.largestBatchId=t,this.mutation=n}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O_e{constructor(t,n){this.count=t,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Pn,ct;function P_e(e){switch(e){case se.OK:return Le();case se.CANCELLED:case se.UNKNOWN:case se.DEADLINE_EXCEEDED:case se.RESOURCE_EXHAUSTED:case se.INTERNAL:case se.UNAVAILABLE:case se.UNAUTHENTICATED:return!1;case se.INVALID_ARGUMENT:case se.NOT_FOUND:case se.ALREADY_EXISTS:case se.PERMISSION_DENIED:case se.FAILED_PRECONDITION:case se.ABORTED:case se.OUT_OF_RANGE:case se.UNIMPLEMENTED:case se.DATA_LOSS:return!0;default:return Le()}}function kW(e){if(e===void 0)return pl("GRPC error has no .code"),se.UNKNOWN;switch(e){case Pn.OK:return se.OK;case Pn.CANCELLED:return se.CANCELLED;case Pn.UNKNOWN:return se.UNKNOWN;case Pn.DEADLINE_EXCEEDED:return se.DEADLINE_EXCEEDED;case Pn.RESOURCE_EXHAUSTED:return se.RESOURCE_EXHAUSTED;case Pn.INTERNAL:return se.INTERNAL;case Pn.UNAVAILABLE:return se.UNAVAILABLE;case Pn.UNAUTHENTICATED:return se.UNAUTHENTICATED;case Pn.INVALID_ARGUMENT:return se.INVALID_ARGUMENT;case Pn.NOT_FOUND:return se.NOT_FOUND;case Pn.ALREADY_EXISTS:return se.ALREADY_EXISTS;case Pn.PERMISSION_DENIED:return se.PERMISSION_DENIED;case Pn.FAILED_PRECONDITION:return se.FAILED_PRECONDITION;case Pn.ABORTED:return se.ABORTED;case Pn.OUT_OF_RANGE:return se.OUT_OF_RANGE;case Pn.UNIMPLEMENTED:return se.UNIMPLEMENTED;case Pn.DATA_LOSS:return se.DATA_LOSS;default:return Le()}}(ct=Pn||(Pn={}))[ct.OK=0]="OK",ct[ct.CANCELLED=1]="CANCELLED",ct[ct.UNKNOWN=2]="UNKNOWN",ct[ct.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ct[ct.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ct[ct.NOT_FOUND=5]="NOT_FOUND",ct[ct.ALREADY_EXISTS=6]="ALREADY_EXISTS",ct[ct.PERMISSION_DENIED=7]="PERMISSION_DENIED",ct[ct.UNAUTHENTICATED=16]="UNAUTHENTICATED",ct[ct.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ct[ct.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ct[ct.ABORTED=10]="ABORTED",ct[ct.OUT_OF_RANGE=11]="OUT_OF_RANGE",ct[ct.UNIMPLEMENTED=12]="UNIMPLEMENTED",ct[ct.INTERNAL=13]="INTERNAL",ct[ct.UNAVAILABLE=14]="UNAVAILABLE",ct[ct.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F_e(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B_e=new Cc([4294967295,4294967295],0);function CL(e){const t=F_e().encode(e),n=new qY;return n.update(t),new Uint8Array(n.digest())}function AL(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),i=t.getUint32(4,!0),s=t.getUint32(8,!0),r=t.getUint32(12,!0);return[new Cc([n,i],0),new Cc([s,r],0)]}class TI{constructor(t,n,i){if(this.bitmap=t,this.padding=n,this.hashCount=i,n<0||n>=8)throw new K1(`Invalid padding: ${n}`);if(i<0)throw new K1(`Invalid hash count: ${i}`);if(t.length>0&&this.hashCount===0)throw new K1(`Invalid hash count: ${i}`);if(t.length===0&&n!==0)throw new K1(`Invalid padding when bitmap length is 0: ${n}`);this.Ee=8*t.length-n,this.de=Cc.fromNumber(this.Ee)}Ae(t,n,i){let s=t.add(n.multiply(Cc.fromNumber(i)));return s.compare(B_e)===1&&(s=new Cc([s.getBits(0),s.getBits(1)],0)),s.modulo(this.de).toNumber()}Re(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.Ee===0)return!1;const n=CL(t),[i,s]=AL(n);for(let r=0;r<this.hashCount;r++){const o=this.Ae(i,s,r);if(!this.Re(o))return!1}return!0}static create(t,n,i){const s=t%8==0?0:8-t%8,r=new Uint8Array(Math.ceil(t/8)),o=new TI(r,s,n);return i.forEach(a=>o.insert(a)),o}insert(t){if(this.Ee===0)return;const n=CL(t),[i,s]=AL(n);for(let r=0;r<this.hashCount;r++){const o=this.Ae(i,s,r);this.Ve(o)}}Ve(t){const n=Math.floor(t/8),i=t%8;this.bitmap[n]|=1<<i}}class K1 extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iE{constructor(t,n,i,s,r){this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=i,this.documentUpdates=s,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(t,n,i){const s=new Map;return s.set(t,zp.createSynthesizedTargetChangeForCurrentChange(t,n,i)),new iE(Pe.min(),s,new Ln(dt),qc(),Et())}}class zp{constructor(t,n,i,s,r){this.resumeToken=t,this.current=n,this.addedDocuments=i,this.modifiedDocuments=s,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(t,n,i){return new zp(i,n,Et(),Et(),Et())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sb{constructor(t,n,i,s){this.me=t,this.removedTargetIds=n,this.key=i,this.fe=s}}class RW{constructor(t,n){this.targetId=t,this.ge=n}}class DW{constructor(t,n,i=Li.EMPTY_BYTE_STRING,s=null){this.state=t,this.targetIds=n,this.resumeToken=i,this.cause=s}}class ML{constructor(){this.pe=0,this.ye=kL(),this.we=Li.EMPTY_BYTE_STRING,this.Se=!1,this.be=!0}get current(){return this.Se}get resumeToken(){return this.we}get De(){return this.pe!==0}get ve(){return this.be}Ce(t){t.approximateByteSize()>0&&(this.be=!0,this.we=t)}Fe(){let t=Et(),n=Et(),i=Et();return this.ye.forEach((s,r)=>{switch(r){case 0:t=t.add(s);break;case 2:n=n.add(s);break;case 1:i=i.add(s);break;default:Le()}}),new zp(this.we,this.Se,t,n,i)}Me(){this.be=!1,this.ye=kL()}xe(t,n){this.be=!0,this.ye=this.ye.insert(t,n)}Oe(t){this.be=!0,this.ye=this.ye.remove(t)}Ne(){this.pe+=1}Be(){this.pe-=1,Xt(this.pe>=0)}Le(){this.be=!0,this.Se=!0}}class z_e{constructor(t){this.ke=t,this.qe=new Map,this.Qe=qc(),this.$e=a2(),this.Ke=a2(),this.Ue=new Ln(dt)}We(t){for(const n of t.me)t.fe&&t.fe.isFoundDocument()?this.Ge(n,t.fe):this.ze(n,t.key,t.fe);for(const n of t.removedTargetIds)this.ze(n,t.key,t.fe)}je(t){this.forEachTarget(t,n=>{const i=this.He(n);switch(t.state){case 0:this.Je(n)&&i.Ce(t.resumeToken);break;case 1:i.Be(),i.De||i.Me(),i.Ce(t.resumeToken);break;case 2:i.Be(),i.De||this.removeTarget(n);break;case 3:this.Je(n)&&(i.Le(),i.Ce(t.resumeToken));break;case 4:this.Je(n)&&(this.Ye(n),i.Ce(t.resumeToken));break;default:Le()}})}forEachTarget(t,n){t.targetIds.length>0?t.targetIds.forEach(n):this.qe.forEach((i,s)=>{this.Je(s)&&n(s)})}Ze(t){const n=t.targetId,i=t.ge.count,s=this.Xe(n);if(s){const r=s.target;if(Zv(r))if(i===0){const o=new Ne(r.path);this.ze(n,o,mi.newNoDocument(o,Pe.min()))}else Xt(i===1);else{const o=this.et(n);if(o!==i){const a=this.tt(t),l=a?this.nt(a,t,o):1;if(l!==0){this.Ye(n);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ue=this.Ue.insert(n,c)}}}}}tt(t){const n=t.ge.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:i="",padding:s=0},hashCount:r=0}=n;let o,a;try{o=Kc(i).toUint8Array()}catch(l){if(l instanceof aW)return eg("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new TI(o,s,r)}catch(l){return eg(l instanceof K1?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ee===0?null:a}nt(t,n,i){return n.ge.count===i-this.st(t,n.targetId)?0:2}st(t,n){const i=this.ke.getRemoteKeysForTarget(n);let s=0;return i.forEach(r=>{const o=this.ke.it(),a=`projects/${o.projectId}/databases/${o.database}/documents/${r.path.canonicalString()}`;t.mightContain(a)||(this.ze(n,r,null),s++)}),s}ot(t){const n=new Map;this.qe.forEach((r,o)=>{const a=this.Xe(o);if(a){if(r.current&&Zv(a.target)){const l=new Ne(a.target.path);this._t(l).has(o)||this.ut(o,l)||this.ze(o,l,mi.newNoDocument(l,t))}r.ve&&(n.set(o,r.Fe()),r.Me())}});let i=Et();this.Ke.forEach((r,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.Xe(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(i=i.add(r))}),this.Qe.forEach((r,o)=>o.setReadTime(t));const s=new iE(t,n,this.Ue,this.Qe,i);return this.Qe=qc(),this.$e=a2(),this.Ke=a2(),this.Ue=new Ln(dt),s}Ge(t,n){if(!this.Je(t))return;const i=this.ut(t,n.key)?2:0;this.He(t).xe(n.key,i),this.Qe=this.Qe.insert(n.key,n),this.$e=this.$e.insert(n.key,this._t(n.key).add(t)),this.Ke=this.Ke.insert(n.key,this.ct(n.key).add(t))}ze(t,n,i){if(!this.Je(t))return;const s=this.He(t);this.ut(t,n)?s.xe(n,1):s.Oe(n),this.Ke=this.Ke.insert(n,this.ct(n).delete(t)),this.Ke=this.Ke.insert(n,this.ct(n).add(t)),i&&(this.Qe=this.Qe.insert(n,i))}removeTarget(t){this.qe.delete(t)}et(t){const n=this.He(t).Fe();return this.ke.getRemoteKeysForTarget(t).size+n.addedDocuments.size-n.removedDocuments.size}Ne(t){this.He(t).Ne()}He(t){let n=this.qe.get(t);return n||(n=new ML,this.qe.set(t,n)),n}ct(t){let n=this.Ke.get(t);return n||(n=new ni(dt),this.Ke=this.Ke.insert(t,n)),n}_t(t){let n=this.$e.get(t);return n||(n=new ni(dt),this.$e=this.$e.insert(t,n)),n}Je(t){const n=this.Xe(t)!==null;return n||we("WatchChangeAggregator","Detected inactive target",t),n}Xe(t){const n=this.qe.get(t);return n&&n.De?null:this.ke.lt(t)}Ye(t){this.qe.set(t,new ML),this.ke.getRemoteKeysForTarget(t).forEach(n=>{this.ze(t,n,null)})}ut(t,n){return this.ke.getRemoteKeysForTarget(t).has(n)}}function a2(){return new Ln(Ne.comparator)}function kL(){return new Ln(Ne.comparator)}const H_e={asc:"ASCENDING",desc:"DESCENDING"},V_e={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},$_e={and:"AND",or:"OR"};class G_e{constructor(t,n){this.databaseId=t,this.useProto3Json=n}}function Qv(e,t){return e.useProto3Json||Fp(t)?t:{value:t}}function l5(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function LW(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function X_e(e,t){return l5(e,t.toTimestamp())}function Ja(e){return Xt(!!e),Pe.fromTimestamp(function(n){const i=Wc(n);return new Ei(i.seconds,i.nanos)}(e))}function II(e,t){return Jv(e,t).canonicalString()}function Jv(e,t){const n=function(s){return new ln(["projects",s.projectId,"databases",s.database])}(e).child("documents");return t===void 0?n:n.child(t)}function NW(e){const t=ln.fromString(e);return Xt(zW(t)),t}function c5(e,t){return II(e.databaseId,t.path)}function F0(e,t){const n=NW(t);if(n.get(1)!==e.databaseId.projectId)throw new Ce(se.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Ce(se.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Ne(PW(n))}function OW(e,t){return II(e.databaseId,t)}function j_e(e){const t=NW(e);return t.length===4?ln.emptyPath():PW(t)}function RL(e){return new ln(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function PW(e){return Xt(e.length>4&&e.get(4)==="documents"),e.popFirst(5)}function DL(e,t,n){return{name:c5(e,t),fields:n.value.mapValue.fields}}function Y_e(e,t){return"found"in t?function(i,s){Xt(!!s.found),s.found.name,s.found.updateTime;const r=F0(i,s.found.name),o=Ja(s.found.updateTime),a=s.found.createTime?Ja(s.found.createTime):Pe.min(),l=new Es({mapValue:{fields:s.found.fields}});return mi.newFoundDocument(r,o,a,l)}(e,t):"missing"in t?function(i,s){Xt(!!s.missing),Xt(!!s.readTime);const r=F0(i,s.missing),o=Ja(s.readTime);return mi.newNoDocument(r,o)}(e,t):Le()}function W_e(e,t){let n;if("targetChange"in t){t.targetChange;const i=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Le()}(t.targetChange.targetChangeType||"NO_CHANGE"),s=t.targetChange.targetIds||[],r=function(c,u){return c.useProto3Json?(Xt(u===void 0||typeof u=="string"),Li.fromBase64String(u||"")):(Xt(u===void 0||u instanceof Buffer||u instanceof Uint8Array),Li.fromUint8Array(u||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(c){const u=c.code===void 0?se.UNKNOWN:kW(c.code);return new Ce(u,c.message||"")}(o);n=new DW(i,s,r,a||null)}else if("documentChange"in t){t.documentChange;const i=t.documentChange;i.document,i.document.name,i.document.updateTime;const s=F0(e,i.document.name),r=Ja(i.document.updateTime),o=i.document.createTime?Ja(i.document.createTime):Pe.min(),a=new Es({mapValue:{fields:i.document.fields}}),l=mi.newFoundDocument(s,r,o,a),c=i.targetIds||[],u=i.removedTargetIds||[];n=new sb(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const i=t.documentDelete;i.document;const s=F0(e,i.document),r=i.readTime?Ja(i.readTime):Pe.min(),o=mi.newNoDocument(s,r),a=i.removedTargetIds||[];n=new sb([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const i=t.documentRemove;i.document;const s=F0(e,i.document),r=i.removedTargetIds||[];n=new sb([],r,s,null)}else{if(!("filter"in t))return Le();{t.filter;const i=t.filter;i.targetId;const{count:s=0,unchangedNames:r}=i,o=new O_e(s,r),a=i.targetId;n=new RW(a,o)}}return n}function K_e(e,t){let n;if(t instanceof Bp)n={update:DL(e,t.key,t.value)};else if(t instanceof _I)n={delete:c5(e,t.key)};else if(t instanceof Wd)n={update:DL(e,t.key,t.data),updateMask:iTe(t.fieldMask)};else{if(!(t instanceof MW))return Le();n={verify:c5(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(i=>function(r,o){const a=o.transform;if(a instanceof o5)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Gm)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Xm)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof a5)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw Le()}(0,i))),t.precondition.isNone||(n.currentDocument=function(s,r){return r.updateTime!==void 0?{updateTime:X_e(s,r.updateTime)}:r.exists!==void 0?{exists:r.exists}:Le()}(e,t.precondition)),n}function Z_e(e,t){return{documents:[OW(e,t.path)]}}function q_e(e,t){const n={structuredQuery:{}},i=t.path;let s;t.collectionGroup!==null?(s=i,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(s=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=OW(e,s);const r=function(c){if(c.length!==0)return BW(ra.create(c,"and"))}(t.filters);r&&(n.structuredQuery.where=r);const o=function(c){if(c.length!==0)return c.map(u=>function(f){return{field:Tf(f.field),direction:eTe(f.dir)}}(u))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Qv(e,t.limit);return a!==null&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(t.endAt)),{ht:n,parent:s}}function Q_e(e){let t=j_e(e.parent);const n=e.structuredQuery,i=n.from?n.from.length:0;let s=null;if(i>0){Xt(i===1);const u=n.from[0];u.allDescendants?s=u.collectionId:t=t.child(u.collectionId)}let r=[];n.where&&(r=function(d){const f=FW(d);return f instanceof ra&&pW(f)?f.getFilters():[f]}(n.where));let o=[];n.orderBy&&(o=function(d){return d.map(f=>function(m){return new r5(If(m.field),function(U){switch(U){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(m.direction))}(f))}(n.orderBy));let a=null;n.limit&&(a=function(d){let f;return f=typeof d=="object"?d.value:d,Fp(f)?null:f}(n.limit));let l=null;n.startAt&&(l=function(d){const f=!!d.before,h=d.values||[];return new s5(h,f)}(n.startAt));let c=null;return n.endAt&&(c=function(d){const f=!d.before,h=d.values||[];return new s5(h,f)}(n.endAt)),b_e(t,s,o,r,a,"F",l,c)}function J_e(e,t){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Le()}}(t.purpose);return n==null?null:{"goog-listen-tags":n}}function FW(e){return e.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const i=If(n.unaryFilter.field);return ti.create(i,"==",{doubleValue:NaN});case"IS_NULL":const s=If(n.unaryFilter.field);return ti.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=If(n.unaryFilter.field);return ti.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=If(n.unaryFilter.field);return ti.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Le()}}(e):e.fieldFilter!==void 0?function(n){return ti.create(If(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Le()}}(n.fieldFilter.op),n.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(n){return ra.create(n.compositeFilter.filters.map(i=>FW(i)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Le()}}(n.compositeFilter.op))}(e):Le()}function eTe(e){return H_e[e]}function tTe(e){return V_e[e]}function nTe(e){return $_e[e]}function Tf(e){return{fieldPath:e.canonicalString()}}function If(e){return Xi.fromServerFormat(e.fieldPath)}function BW(e){return e instanceof ti?function(n){if(n.op==="=="){if(yL(n.value))return{unaryFilter:{field:Tf(n.field),op:"IS_NAN"}};if(bL(n.value))return{unaryFilter:{field:Tf(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(yL(n.value))return{unaryFilter:{field:Tf(n.field),op:"IS_NOT_NAN"}};if(bL(n.value))return{unaryFilter:{field:Tf(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Tf(n.field),op:tTe(n.op),value:n.value}}}(e):e instanceof ra?function(n){const i=n.getFilters().map(s=>BW(s));return i.length===1?i[0]:{compositeFilter:{op:nTe(n.op),filters:i}}}(e):Le()}function iTe(e){const t=[];return e.fields.forEach(n=>t.push(n.canonicalString())),{fieldPaths:t}}function zW(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lc{constructor(t,n,i,s,r=Pe.min(),o=Pe.min(),a=Li.EMPTY_BYTE_STRING,l=null){this.target=t,this.targetId=n,this.purpose=i,this.sequenceNumber=s,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(t){return new lc(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,n){return new lc(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new lc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new lc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sTe{constructor(t){this.Tt=t}}function rTe(e){const t=Q_e({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?qv(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oTe{constructor(){this.Tn=new aTe}addToCollectionParentIndex(t,n){return this.Tn.add(n),ie.resolve()}getCollectionParents(t,n){return ie.resolve(this.Tn.getEntries(n))}addFieldIndex(t,n){return ie.resolve()}deleteFieldIndex(t,n){return ie.resolve()}deleteAllFieldIndexes(t){return ie.resolve()}createTargetIndexes(t,n){return ie.resolve()}getDocumentsMatchingTarget(t,n){return ie.resolve(null)}getIndexType(t,n){return ie.resolve(0)}getFieldIndexes(t,n){return ie.resolve([])}getNextCollectionGroupToUpdate(t){return ie.resolve(null)}getMinOffset(t,n){return ie.resolve(Yc.min())}getMinOffsetFromCollectionGroup(t,n){return ie.resolve(Yc.min())}updateCollectionGroup(t,n,i){return ie.resolve()}updateIndexEntries(t,n){return ie.resolve()}}class aTe{constructor(){this.index={}}add(t){const n=t.lastSegment(),i=t.popLast(),s=this.index[n]||new ni(ln.comparator),r=!s.has(i);return this.index[n]=s.add(i),r}has(t){const n=t.lastSegment(),i=t.popLast(),s=this.index[n];return s&&s.has(i)}getEntries(t){return(this.index[t]||new ni(ln.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LL={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},HW=41943040;class ys{static withCacheSize(t){return new ys(t,ys.DEFAULT_COLLECTION_PERCENTILE,ys.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,n,i){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ys.DEFAULT_COLLECTION_PERCENTILE=10,ys.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ys.DEFAULT=new ys(HW,ys.DEFAULT_COLLECTION_PERCENTILE,ys.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ys.DISABLED=new ys(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sg{constructor(t){this.$n=t}next(){return this.$n+=2,this.$n}static Kn(){return new sg(0)}static Un(){return new sg(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NL="LruGarbageCollector",lTe=1048576;function OL([e,t],[n,i]){const s=dt(e,n);return s===0?dt(t,i):s}class cTe{constructor(t){this.Hn=t,this.buffer=new ni(OL),this.Jn=0}Yn(){return++this.Jn}Zn(t){const n=[t,this.Yn()];if(this.buffer.size<this.Hn)this.buffer=this.buffer.add(n);else{const i=this.buffer.last();OL(n,i)<0&&(this.buffer=this.buffer.delete(i).add(n))}}get maxValue(){return this.buffer.last()[0]}}class uTe{constructor(t,n,i){this.garbageCollector=t,this.asyncQueue=n,this.localStore=i,this.Xn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.er(6e4)}stop(){this.Xn&&(this.Xn.cancel(),this.Xn=null)}get started(){return this.Xn!==null}er(t){we(NL,`Garbage collection scheduled in ${t}ms`),this.Xn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,async()=>{this.Xn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Rg(n)?we(NL,"Ignoring IndexedDB error during garbage collection: ",n):await Ky(n)}await this.er(3e5)})}}class dTe{constructor(t,n){this.tr=t,this.params=n}calculateTargetCount(t,n){return this.tr.nr(t).next(i=>Math.floor(n/100*i))}nthSequenceNumber(t,n){if(n===0)return ie.resolve(Zy.ae);const i=new cTe(n);return this.tr.forEachTarget(t,s=>i.Zn(s.sequenceNumber)).next(()=>this.tr.rr(t,s=>i.Zn(s))).next(()=>i.maxValue)}removeTargets(t,n,i){return this.tr.removeTargets(t,n,i)}removeOrphanedDocuments(t,n){return this.tr.removeOrphanedDocuments(t,n)}collect(t,n){return this.params.cacheSizeCollectionThreshold===-1?(we("LruGarbageCollector","Garbage collection skipped; disabled"),ie.resolve(LL)):this.getCacheSize(t).next(i=>i<this.params.cacheSizeCollectionThreshold?(we("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),LL):this.ir(t,n))}getCacheSize(t){return this.tr.getCacheSize(t)}ir(t,n){let i,s,r,o,a,l,c;const u=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(we("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),s=this.params.maximumSequenceNumbersToCollect):s=d,o=Date.now(),this.nthSequenceNumber(t,s))).next(d=>(i=d,a=Date.now(),this.removeTargets(t,i,n))).next(d=>(r=d,l=Date.now(),this.removeOrphanedDocuments(t,i))).next(d=>(c=Date.now(),wf()<=ut.DEBUG&&we("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${r} targets in `+(l-a)+`ms
	Removed ${d} documents in `+(c-l)+`ms
Total Duration: ${c-u}ms`),ie.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:r,documentsRemoved:d})))}}function fTe(e,t){return new dTe(e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hTe{constructor(){this.changes=new Yd(t=>t.toString(),(t,n)=>t.isEqual(n)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,n){this.assertNotApplied(),this.changes.set(t,mi.newInvalidDocument(t).setReadTime(n))}getEntry(t,n){this.assertNotApplied();const i=this.changes.get(n);return i!==void 0?ie.resolve(i):this.getFromCache(t,n)}getEntries(t,n){return this.getAllFromCache(t,n)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gTe{constructor(t,n){this.overlayedDocument=t,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mTe{constructor(t,n,i,s){this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=i,this.indexManager=s}getDocument(t,n){let i=null;return this.documentOverlayCache.getOverlay(t,n).next(s=>(i=s,this.remoteDocumentCache.getEntry(t,n))).next(s=>(i!==null&&P0(i.mutation,s,wr.empty(),Ei.now()),s))}getDocuments(t,n){return this.remoteDocumentCache.getEntries(t,n).next(i=>this.getLocalViewOfDocuments(t,i,Et()).next(()=>i))}getLocalViewOfDocuments(t,n,i=Et()){const s=zu();return this.populateOverlays(t,s,n).next(()=>this.computeViews(t,n,s,i).next(r=>{let o=W1();return r.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(t,n){const i=zu();return this.populateOverlays(t,i,n).next(()=>this.computeViews(t,n,i,Et()))}populateOverlays(t,n,i){const s=[];return i.forEach(r=>{n.has(r)||s.push(r)}),this.documentOverlayCache.getOverlays(t,s).next(r=>{r.forEach((o,a)=>{n.set(o,a)})})}computeViews(t,n,i,s){let r=qc();const o=O0(),a=function(){return O0()}();return n.forEach((l,c)=>{const u=i.get(c.key);s.has(c.key)&&(u===void 0||u.mutation instanceof Wd)?r=r.insert(c.key,c):u!==void 0?(o.set(c.key,u.mutation.getFieldMask()),P0(u.mutation,c,u.mutation.getFieldMask(),Ei.now())):o.set(c.key,wr.empty())}),this.recalculateAndSaveOverlays(t,r).next(l=>(l.forEach((c,u)=>o.set(c,u)),n.forEach((c,u)=>{var d;return a.set(c,new gTe(u,(d=o.get(c))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(t,n){const i=O0();let s=new Ln((o,a)=>o-a),r=Et();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=n.get(l);if(c===null)return;let u=i.get(l)||wr.empty();u=a.applyToLocalView(c,u),i.set(l,u);const d=(s.get(a.batchId)||Et()).add(l);s=s.insert(a.batchId,d)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,u=l.value,d=_W();u.forEach(f=>{if(!r.has(f)){const h=CW(n.get(f),i.get(f));h!==null&&d.set(f,h),r=r.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(t,c,d))}return ie.waitFor(o)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(t,n){return this.remoteDocumentCache.getEntries(t,n).next(i=>this.recalculateAndSaveOverlays(t,i))}getDocumentsMatchingQuery(t,n,i,s){return function(o){return Ne.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(t,n.path):y_e(n)?this.getDocumentsMatchingCollectionGroupQuery(t,n,i,s):this.getDocumentsMatchingCollectionQuery(t,n,i,s)}getNextDocuments(t,n,i,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,n,i,s).next(r=>{const o=s-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,n,i.largestBatchId,s-r.size):ie.resolve(zu());let a=zm,l=r;return o.next(c=>ie.forEach(c,(u,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),r.get(u)?ie.resolve():this.remoteDocumentCache.getEntry(t,u).next(f=>{l=l.insert(u,f)}))).next(()=>this.populateOverlays(t,c,r)).next(()=>this.computeViews(t,l,c,Et())).next(u=>({batchId:a,changes:T_e(u)})))})}getDocumentsMatchingDocumentQuery(t,n){return this.getDocument(t,new Ne(n)).next(i=>{let s=W1();return i.isFoundDocument()&&(s=s.insert(i.key,i)),s})}getDocumentsMatchingCollectionGroupQuery(t,n,i,s){const r=n.collectionGroup;let o=W1();return this.indexManager.getCollectionParents(t,r).next(a=>ie.forEach(a,l=>{const c=function(d,f){return new Qy(f,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,l.child(r));return this.getDocumentsMatchingCollectionQuery(t,c,i,s).next(u=>{u.forEach((d,f)=>{o=o.insert(d,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(t,n,i,s){let r;return this.documentOverlayCache.getOverlaysForCollection(t,n.path,i.largestBatchId).next(o=>(r=o,this.remoteDocumentCache.getDocumentsMatchingQuery(t,n,i,r,s))).next(o=>{r.forEach((l,c)=>{const u=c.getKey();o.get(u)===null&&(o=o.insert(u,mi.newInvalidDocument(u)))});let a=W1();return o.forEach((l,c)=>{const u=r.get(l);u!==void 0&&P0(u.mutation,c,wr.empty(),Ei.now()),eE(n,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pTe{constructor(t){this.serializer=t,this.dr=new Map,this.Ar=new Map}getBundleMetadata(t,n){return ie.resolve(this.dr.get(n))}saveBundleMetadata(t,n){return this.dr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Ja(s.createTime)}}(n)),ie.resolve()}getNamedQuery(t,n){return ie.resolve(this.Ar.get(n))}saveNamedQuery(t,n){return this.Ar.set(n.name,function(s){return{name:s.name,query:rTe(s.bundledQuery),readTime:Ja(s.readTime)}}(n)),ie.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UTe{constructor(){this.overlays=new Ln(Ne.comparator),this.Rr=new Map}getOverlay(t,n){return ie.resolve(this.overlays.get(n))}getOverlays(t,n){const i=zu();return ie.forEach(n,s=>this.getOverlay(t,s).next(r=>{r!==null&&i.set(s,r)})).next(()=>i)}saveOverlays(t,n,i){return i.forEach((s,r)=>{this.Et(t,n,r)}),ie.resolve()}removeOverlaysForBatchId(t,n,i){const s=this.Rr.get(i);return s!==void 0&&(s.forEach(r=>this.overlays=this.overlays.remove(r)),this.Rr.delete(i)),ie.resolve()}getOverlaysForCollection(t,n,i){const s=zu(),r=n.length+1,o=new Ne(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===r&&l.largestBatchId>i&&s.set(l.getKey(),l)}return ie.resolve(s)}getOverlaysForCollectionGroup(t,n,i,s){let r=new Ln((c,u)=>c-u);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>i){let u=r.get(c.largestBatchId);u===null&&(u=zu(),r=r.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const a=zu(),l=r.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>a.set(c,u)),!(a.size()>=s)););return ie.resolve(a)}Et(t,n,i){const s=this.overlays.get(i.key);if(s!==null){const o=this.Rr.get(s.largestBatchId).delete(i.key);this.Rr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new N_e(n,i));let r=this.Rr.get(n);r===void 0&&(r=Et(),this.Rr.set(n,r)),this.Rr.set(n,r.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bTe{constructor(){this.sessionToken=Li.EMPTY_BYTE_STRING}getSessionToken(t){return ie.resolve(this.sessionToken)}setSessionToken(t,n){return this.sessionToken=n,ie.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SI{constructor(){this.Vr=new ni(di.mr),this.gr=new ni(di.pr)}isEmpty(){return this.Vr.isEmpty()}addReference(t,n){const i=new di(t,n);this.Vr=this.Vr.add(i),this.gr=this.gr.add(i)}yr(t,n){t.forEach(i=>this.addReference(i,n))}removeReference(t,n){this.wr(new di(t,n))}Sr(t,n){t.forEach(i=>this.removeReference(i,n))}br(t){const n=new Ne(new ln([])),i=new di(n,t),s=new di(n,t+1),r=[];return this.gr.forEachInRange([i,s],o=>{this.wr(o),r.push(o.key)}),r}Dr(){this.Vr.forEach(t=>this.wr(t))}wr(t){this.Vr=this.Vr.delete(t),this.gr=this.gr.delete(t)}vr(t){const n=new Ne(new ln([])),i=new di(n,t),s=new di(n,t+1);let r=Et();return this.gr.forEachInRange([i,s],o=>{r=r.add(o.key)}),r}containsKey(t){const n=new di(t,0),i=this.Vr.firstAfterOrEqual(n);return i!==null&&t.isEqual(i.key)}}class di{constructor(t,n){this.key=t,this.Cr=n}static mr(t,n){return Ne.comparator(t.key,n.key)||dt(t.Cr,n.Cr)}static pr(t,n){return dt(t.Cr,n.Cr)||Ne.comparator(t.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yTe{constructor(t,n){this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.Fr=1,this.Mr=new ni(di.mr)}checkEmpty(t){return ie.resolve(this.mutationQueue.length===0)}addMutationBatch(t,n,i,s){const r=this.Fr;this.Fr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new L_e(r,n,i,s);this.mutationQueue.push(o);for(const a of s)this.Mr=this.Mr.add(new di(a.key,r)),this.indexManager.addToCollectionParentIndex(t,a.key.path.popLast());return ie.resolve(o)}lookupMutationBatch(t,n){return ie.resolve(this.Or(n))}getNextMutationBatchAfterBatchId(t,n){const i=n+1,s=this.Nr(i),r=s<0?0:s;return ie.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return ie.resolve(this.mutationQueue.length===0?J9e:this.Fr-1)}getAllMutationBatches(t){return ie.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,n){const i=new di(n,0),s=new di(n,Number.POSITIVE_INFINITY),r=[];return this.Mr.forEachInRange([i,s],o=>{const a=this.Or(o.Cr);r.push(a)}),ie.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(t,n){let i=new ni(dt);return n.forEach(s=>{const r=new di(s,0),o=new di(s,Number.POSITIVE_INFINITY);this.Mr.forEachInRange([r,o],a=>{i=i.add(a.Cr)})}),ie.resolve(this.Br(i))}getAllMutationBatchesAffectingQuery(t,n){const i=n.path,s=i.length+1;let r=i;Ne.isDocumentKey(r)||(r=r.child(""));const o=new di(new Ne(r),0);let a=new ni(dt);return this.Mr.forEachWhile(l=>{const c=l.key.path;return!!i.isPrefixOf(c)&&(c.length===s&&(a=a.add(l.Cr)),!0)},o),ie.resolve(this.Br(a))}Br(t){const n=[];return t.forEach(i=>{const s=this.Or(i);s!==null&&n.push(s)}),n}removeMutationBatch(t,n){Xt(this.Lr(n.batchId,"removed")===0),this.mutationQueue.shift();let i=this.Mr;return ie.forEach(n.mutations,s=>{const r=new di(s.key,n.batchId);return i=i.delete(r),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)}).next(()=>{this.Mr=i})}qn(t){}containsKey(t,n){const i=new di(n,0),s=this.Mr.firstAfterOrEqual(i);return ie.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(t){return this.mutationQueue.length,ie.resolve()}Lr(t,n){return this.Nr(t)}Nr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Or(t){const n=this.Nr(t);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ETe{constructor(t){this.kr=t,this.docs=function(){return new Ln(Ne.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,n){const i=n.key,s=this.docs.get(i),r=s?s.size:0,o=this.kr(n);return this.docs=this.docs.insert(i,{document:n.mutableCopy(),size:o}),this.size+=o-r,this.indexManager.addToCollectionParentIndex(t,i.path.popLast())}removeEntry(t){const n=this.docs.get(t);n&&(this.docs=this.docs.remove(t),this.size-=n.size)}getEntry(t,n){const i=this.docs.get(n);return ie.resolve(i?i.document.mutableCopy():mi.newInvalidDocument(n))}getEntries(t,n){let i=qc();return n.forEach(s=>{const r=this.docs.get(s);i=i.insert(s,r?r.document.mutableCopy():mi.newInvalidDocument(s))}),ie.resolve(i)}getDocumentsMatchingQuery(t,n,i,s){let r=qc();const o=n.path,a=new Ne(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||K9e(W9e(u),i)<=0||(s.has(u.key)||eE(n,u))&&(r=r.insert(u.key,u.mutableCopy()))}return ie.resolve(r)}getAllFromCollectionGroup(t,n,i,s){Le()}qr(t,n){return ie.forEach(this.docs,i=>n(i))}newChangeBuffer(t){return new vTe(this)}getSize(t){return ie.resolve(this.size)}}class vTe extends hTe{constructor(t){super(),this.Ir=t}applyChanges(t){const n=[];return this.changes.forEach((i,s)=>{s.isValidDocument()?n.push(this.Ir.addEntry(t,s)):this.Ir.removeEntry(i)}),ie.waitFor(n)}getFromCache(t,n){return this.Ir.getEntry(t,n)}getAllFromCache(t,n){return this.Ir.getEntries(t,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wTe{constructor(t){this.persistence=t,this.Qr=new Yd(n=>yI(n),EI),this.lastRemoteSnapshotVersion=Pe.min(),this.highestTargetId=0,this.$r=0,this.Kr=new SI,this.targetCount=0,this.Ur=sg.Kn()}forEachTarget(t,n){return this.Qr.forEach((i,s)=>n(s)),ie.resolve()}getLastRemoteSnapshotVersion(t){return ie.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return ie.resolve(this.$r)}allocateTargetId(t){return this.highestTargetId=this.Ur.next(),ie.resolve(this.highestTargetId)}setTargetsMetadata(t,n,i){return i&&(this.lastRemoteSnapshotVersion=i),n>this.$r&&(this.$r=n),ie.resolve()}zn(t){this.Qr.set(t.target,t);const n=t.targetId;n>this.highestTargetId&&(this.Ur=new sg(n),this.highestTargetId=n),t.sequenceNumber>this.$r&&(this.$r=t.sequenceNumber)}addTargetData(t,n){return this.zn(n),this.targetCount+=1,ie.resolve()}updateTargetData(t,n){return this.zn(n),ie.resolve()}removeTargetData(t,n){return this.Qr.delete(n.target),this.Kr.br(n.targetId),this.targetCount-=1,ie.resolve()}removeTargets(t,n,i){let s=0;const r=[];return this.Qr.forEach((o,a)=>{a.sequenceNumber<=n&&i.get(a.targetId)===null&&(this.Qr.delete(o),r.push(this.removeMatchingKeysForTargetId(t,a.targetId)),s++)}),ie.waitFor(r).next(()=>s)}getTargetCount(t){return ie.resolve(this.targetCount)}getTargetData(t,n){const i=this.Qr.get(n)||null;return ie.resolve(i)}addMatchingKeys(t,n,i){return this.Kr.yr(n,i),ie.resolve()}removeMatchingKeys(t,n,i){this.Kr.Sr(n,i);const s=this.persistence.referenceDelegate,r=[];return s&&n.forEach(o=>{r.push(s.markPotentiallyOrphaned(t,o))}),ie.waitFor(r)}removeMatchingKeysForTargetId(t,n){return this.Kr.br(n),ie.resolve()}getMatchingKeysForTargetId(t,n){const i=this.Kr.vr(n);return ie.resolve(i)}containsKey(t,n){return ie.resolve(this.Kr.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VW{constructor(t,n){this.Wr={},this.overlays={},this.Gr=new Zy(0),this.zr=!1,this.zr=!0,this.jr=new bTe,this.referenceDelegate=t(this),this.Hr=new wTe(this),this.indexManager=new oTe,this.remoteDocumentCache=function(s){return new ETe(s)}(i=>this.referenceDelegate.Jr(i)),this.serializer=new sTe(n),this.Yr=new pTe(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.zr=!1,Promise.resolve()}get started(){return this.zr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let n=this.overlays[t.toKey()];return n||(n=new UTe,this.overlays[t.toKey()]=n),n}getMutationQueue(t,n){let i=this.Wr[t.toKey()];return i||(i=new yTe(n,this.referenceDelegate),this.Wr[t.toKey()]=i),i}getGlobalsCache(){return this.jr}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Yr}runTransaction(t,n,i){we("MemoryPersistence","Starting transaction:",t);const s=new _Te(this.Gr.next());return this.referenceDelegate.Zr(),i(s).next(r=>this.referenceDelegate.Xr(s).next(()=>r)).toPromise().then(r=>(s.raiseOnCommittedEvent(),r))}ei(t,n){return ie.or(Object.values(this.Wr).map(i=>()=>i.containsKey(t,n)))}}class _Te extends q9e{constructor(t){super(),this.currentSequenceNumber=t}}class xI{constructor(t){this.persistence=t,this.ti=new SI,this.ni=null}static ri(t){return new xI(t)}get ii(){if(this.ni)return this.ni;throw Le()}addReference(t,n,i){return this.ti.addReference(i,n),this.ii.delete(i.toString()),ie.resolve()}removeReference(t,n,i){return this.ti.removeReference(i,n),this.ii.add(i.toString()),ie.resolve()}markPotentiallyOrphaned(t,n){return this.ii.add(n.toString()),ie.resolve()}removeTarget(t,n){this.ti.br(n.targetId).forEach(s=>this.ii.add(s.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(t,n.targetId).next(s=>{s.forEach(r=>this.ii.add(r.toString()))}).next(()=>i.removeTargetData(t,n))}Zr(){this.ni=new Set}Xr(t){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ie.forEach(this.ii,i=>{const s=Ne.fromPath(i);return this.si(t,s).next(r=>{r||n.removeEntry(s,Pe.min())})}).next(()=>(this.ni=null,n.apply(t)))}updateLimboDocument(t,n){return this.si(t,n).next(i=>{i?this.ii.delete(n.toString()):this.ii.add(n.toString())})}Jr(t){return 0}si(t,n){return ie.or([()=>ie.resolve(this.ti.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(t,n),()=>this.persistence.ei(t,n)])}}class u5{constructor(t,n){this.persistence=t,this.oi=new Yd(i=>t_e(i.path),(i,s)=>i.isEqual(s)),this.garbageCollector=fTe(this,n)}static ri(t,n){return new u5(t,n)}Zr(){}Xr(t){return ie.resolve()}forEachTarget(t,n){return this.persistence.getTargetCache().forEachTarget(t,n)}nr(t){const n=this.sr(t);return this.persistence.getTargetCache().getTargetCount(t).next(i=>n.next(s=>i+s))}sr(t){let n=0;return this.rr(t,i=>{n++}).next(()=>n)}rr(t,n){return ie.forEach(this.oi,(i,s)=>this.ar(t,i,s).next(r=>r?ie.resolve():n(s)))}removeTargets(t,n,i){return this.persistence.getTargetCache().removeTargets(t,n,i)}removeOrphanedDocuments(t,n){let i=0;const s=this.persistence.getRemoteDocumentCache(),r=s.newChangeBuffer();return s.qr(t,o=>this.ar(t,o,n).next(a=>{a||(i++,r.removeEntry(o,Pe.min()))})).next(()=>r.apply(t)).next(()=>i)}markPotentiallyOrphaned(t,n){return this.oi.set(n,t.currentSequenceNumber),ie.resolve()}removeTarget(t,n){const i=n.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,i)}addReference(t,n,i){return this.oi.set(i,t.currentSequenceNumber),ie.resolve()}removeReference(t,n,i){return this.oi.set(i,t.currentSequenceNumber),ie.resolve()}updateLimboDocument(t,n){return this.oi.set(n,t.currentSequenceNumber),ie.resolve()}Jr(t){let n=t.key.toString().length;return t.isFoundDocument()&&(n+=nb(t.data.value)),n}ar(t,n,i){return ie.or([()=>this.persistence.ei(t,n),()=>this.persistence.getTargetCache().containsKey(t,n),()=>{const s=this.oi.get(n);return ie.resolve(s!==void 0&&s>i)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CI{constructor(t,n,i,s){this.targetId=t,this.fromCache=n,this.Hi=i,this.Ji=s}static Yi(t,n){let i=Et(),s=Et();for(const r of n.docChanges)switch(r.type){case 0:i=i.add(r.doc.key);break;case 1:s=s.add(r.doc.key)}return new CI(t,n.fromCache,i,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TTe{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ITe{constructor(){this.Zi=!1,this.Xi=!1,this.es=100,this.ts=function(){return _we()?8:Q9e(vwe())>0?6:4}()}initialize(t,n){this.ns=t,this.indexManager=n,this.Zi=!0}getDocumentsMatchingQuery(t,n,i,s){const r={result:null};return this.rs(t,n).next(o=>{r.result=o}).next(()=>{if(!r.result)return this.ss(t,n,s,i).next(o=>{r.result=o})}).next(()=>{if(r.result)return;const o=new TTe;return this._s(t,n,o).next(a=>{if(r.result=a,this.Xi)return this.us(t,n,o,a.size)})}).next(()=>r.result)}us(t,n,i,s){return i.documentReadCount<this.es?(wf()<=ut.DEBUG&&we("QueryEngine","SDK will not create cache indexes for query:",_f(n),"since it only creates cache indexes for collection contains","more than or equal to",this.es,"documents"),ie.resolve()):(wf()<=ut.DEBUG&&we("QueryEngine","Query:",_f(n),"scans",i.documentReadCount,"local documents and returns",s,"documents as results."),i.documentReadCount>this.ts*s?(wf()<=ut.DEBUG&&we("QueryEngine","The SDK decides to create cache indexes for query:",_f(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,jo(n))):ie.resolve())}rs(t,n){if(_L(n))return ie.resolve(null);let i=jo(n);return this.indexManager.getIndexType(t,i).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=qv(n,null,"F"),i=jo(n)),this.indexManager.getDocumentsMatchingTarget(t,i).next(r=>{const o=Et(...r);return this.ns.getDocuments(t,o).next(a=>this.indexManager.getMinOffset(t,i).next(l=>{const c=this.cs(n,a);return this.ls(n,c,o,l.readTime)?this.rs(t,qv(n,null,"F")):this.hs(t,c,n,l)}))})))}ss(t,n,i,s){return _L(n)||s.isEqual(Pe.min())?ie.resolve(null):this.ns.getDocuments(t,i).next(r=>{const o=this.cs(n,r);return this.ls(n,o,i,s)?ie.resolve(null):(wf()<=ut.DEBUG&&we("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),_f(n)),this.hs(t,o,n,Y9e(s,zm)).next(a=>a))})}cs(t,n){let i=new ni(vW(t));return n.forEach((s,r)=>{eE(t,r)&&(i=i.add(r))}),i}ls(t,n,i,s){if(t.limit===null)return!1;if(i.size!==n.size)return!0;const r=t.limitType==="F"?n.last():n.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(s)>0)}_s(t,n,i){return wf()<=ut.DEBUG&&we("QueryEngine","Using full collection scan to execute query:",_f(n)),this.ns.getDocumentsMatchingQuery(t,n,Yc.min(),i)}hs(t,n,i,s){return this.ns.getDocumentsMatchingQuery(t,i,s).next(r=>(n.forEach(o=>{r=r.insert(o.key,o)}),r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AI="LocalStore",STe=3e8;class xTe{constructor(t,n,i,s){this.persistence=t,this.Ps=n,this.serializer=s,this.Ts=new Ln(dt),this.Is=new Yd(r=>yI(r),EI),this.Es=new Map,this.ds=t.getRemoteDocumentCache(),this.Hr=t.getTargetCache(),this.Yr=t.getBundleCache(),this.As(i)}As(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new mTe(this.ds,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ds.setIndexManager(this.indexManager),this.Ps.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>t.collect(n,this.Ts))}}function CTe(e,t,n,i){return new xTe(e,t,n,i)}async function $W(e,t){const n=nt(e);return await n.persistence.runTransaction("Handle user change","readonly",i=>{let s;return n.mutationQueue.getAllMutationBatches(i).next(r=>(s=r,n.As(t),n.mutationQueue.getAllMutationBatches(i))).next(r=>{const o=[],a=[];let l=Et();for(const c of s){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of r){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return n.localDocuments.getDocuments(i,l).next(c=>({Rs:c,removedBatchIds:o,addedBatchIds:a}))})})}function GW(e){const t=nt(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",n=>t.Hr.getLastRemoteSnapshotVersion(n))}function ATe(e,t){const n=nt(e),i=t.snapshotVersion;let s=n.Ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",r=>{const o=n.ds.newChangeBuffer({trackRemovals:!0});s=n.Ts;const a=[];t.targetChanges.forEach((u,d)=>{const f=s.get(d);if(!f)return;a.push(n.Hr.removeMatchingKeys(r,u.removedDocuments,d).next(()=>n.Hr.addMatchingKeys(r,u.addedDocuments,d)));let h=f.withSequenceNumber(r.currentSequenceNumber);t.targetMismatches.get(d)!==null?h=h.withResumeToken(Li.EMPTY_BYTE_STRING,Pe.min()).withLastLimboFreeSnapshotVersion(Pe.min()):u.resumeToken.approximateByteSize()>0&&(h=h.withResumeToken(u.resumeToken,i)),s=s.insert(d,h),function(p,U,b){return p.resumeToken.approximateByteSize()===0||U.snapshotVersion.toMicroseconds()-p.snapshotVersion.toMicroseconds()>=STe?!0:b.addedDocuments.size+b.modifiedDocuments.size+b.removedDocuments.size>0}(f,h,u)&&a.push(n.Hr.updateTargetData(r,h))});let l=qc(),c=Et();if(t.documentUpdates.forEach(u=>{t.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(r,u))}),a.push(MTe(r,o,t.documentUpdates).next(u=>{l=u.Vs,c=u.fs})),!i.isEqual(Pe.min())){const u=n.Hr.getLastRemoteSnapshotVersion(r).next(d=>n.Hr.setTargetsMetadata(r,r.currentSequenceNumber,i));a.push(u)}return ie.waitFor(a).next(()=>o.apply(r)).next(()=>n.localDocuments.getLocalViewOfDocuments(r,l,c)).next(()=>l)}).then(r=>(n.Ts=s,r))}function MTe(e,t,n){let i=Et(),s=Et();return n.forEach(r=>i=i.add(r)),t.getEntries(e,i).next(r=>{let o=qc();return n.forEach((a,l)=>{const c=r.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(Pe.min())?(t.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(t.addEntry(l),o=o.insert(a,l)):we(AI,"Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Vs:o,fs:s}})}function kTe(e,t){const n=nt(e);return n.persistence.runTransaction("Allocate target","readwrite",i=>{let s;return n.Hr.getTargetData(i,t).next(r=>r?(s=r,ie.resolve(s)):n.Hr.allocateTargetId(i).next(o=>(s=new lc(t,o,"TargetPurposeListen",i.currentSequenceNumber),n.Hr.addTargetData(i,s).next(()=>s))))}).then(i=>{const s=n.Ts.get(i.targetId);return(s===null||i.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ts=n.Ts.insert(i.targetId,i),n.Is.set(t,i.targetId)),i})}async function ew(e,t,n){const i=nt(e),s=i.Ts.get(t),r=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",r,o=>i.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Rg(o))throw o;we(AI,`Failed to update sequence numbers for target ${t}: ${o}`)}i.Ts=i.Ts.remove(t),i.Is.delete(s.target)}function PL(e,t,n){const i=nt(e);let s=Pe.min(),r=Et();return i.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,u){const d=nt(l),f=d.Is.get(u);return f!==void 0?ie.resolve(d.Ts.get(f)):d.Hr.getTargetData(c,u)}(i,o,jo(t)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,i.Hr.getMatchingKeysForTargetId(o,a.targetId).next(l=>{r=l})}).next(()=>i.Ps.getDocumentsMatchingQuery(o,t,n?s:Pe.min(),n?r:Et())).next(a=>(RTe(i,v_e(t),a),{documents:a,gs:r})))}function RTe(e,t,n){let i=e.Es.get(t)||Pe.min();n.forEach((s,r)=>{r.readTime.compareTo(i)>0&&(i=r.readTime)}),e.Es.set(t,i)}class FL{constructor(){this.activeTargetIds=x_e()}Ds(t){this.activeTargetIds=this.activeTargetIds.add(t)}vs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}bs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class DTe{constructor(){this.ho=new FL,this.Po={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,n,i){}addLocalQueryTarget(t,n=!0){return n&&this.ho.Ds(t),this.Po[t]||"not-current"}updateQueryState(t,n,i){this.Po[t]=n}removeLocalQueryTarget(t){this.ho.vs(t)}isLocalQueryTarget(t){return this.ho.activeTargetIds.has(t)}clearQueryState(t){delete this.Po[t]}getAllActiveQueryTargets(){return this.ho.activeTargetIds}isActiveQueryTarget(t){return this.ho.activeTargetIds.has(t)}start(){return this.ho=new FL,Promise.resolve()}handleUserChange(t,n,i){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LTe{To(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BL="ConnectivityMonitor";class zL{constructor(){this.Io=()=>this.Eo(),this.Ao=()=>this.Ro(),this.Vo=[],this.mo()}To(t){this.Vo.push(t)}shutdown(){window.removeEventListener("online",this.Io),window.removeEventListener("offline",this.Ao)}mo(){window.addEventListener("online",this.Io),window.addEventListener("offline",this.Ao)}Eo(){we(BL,"Network connectivity changed: AVAILABLE");for(const t of this.Vo)t(0)}Ro(){we(BL,"Network connectivity changed: UNAVAILABLE");for(const t of this.Vo)t(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let l2=null;function tw(){return l2===null?l2=function(){return 268435456+Math.round(2147483648*Math.random())}():l2++,"0x"+l2.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j3="RestConnection",NTe={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class OTe{get fo(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const n=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.po=n+"://"+t.host,this.yo=`projects/${i}/databases/${s}`,this.wo=this.databaseId.database===n5?`project_id=${i}`:`project_id=${i}&database_id=${s}`}So(t,n,i,s,r){const o=tw(),a=this.bo(t,n.toUriEncodedString());we(j3,`Sending RPC '${t}' ${o}:`,a,i);const l={"google-cloud-resource-prefix":this.yo,"x-goog-request-params":this.wo};return this.Do(l,s,r),this.vo(t,a,l,i).then(c=>(we(j3,`Received RPC '${t}' ${o}: `,c),c),c=>{throw eg(j3,`RPC '${t}' ${o} failed with error: `,c,"url: ",a,"request:",i),c})}Co(t,n,i,s,r,o){return this.So(t,n,i,s,r)}Do(t,n,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+kg}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,r)=>t[r]=s),i&&i.headers.forEach((s,r)=>t[r]=s)}bo(t,n){const i=NTe[t];return`${this.po}/v1/${n}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PTe{constructor(t){this.Fo=t.Fo,this.Mo=t.Mo}xo(t){this.Oo=t}No(t){this.Bo=t}Lo(t){this.ko=t}onMessage(t){this.qo=t}close(){this.Mo()}send(t){this.Fo(t)}Qo(){this.Oo()}$o(){this.Bo()}Ko(t){this.ko(t)}Uo(t){this.qo(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bi="WebChannelConnection";class FTe extends OTe{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}vo(t,n,i,s){const r=tw();return new Promise((o,a)=>{const l=new QY;l.setWithCredentials(!0),l.listenOnce(JY.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case tb.NO_ERROR:const u=l.getResponseJson();we(Bi,`XHR for RPC '${t}' ${r} received:`,JSON.stringify(u)),o(u);break;case tb.TIMEOUT:we(Bi,`RPC '${t}' ${r} timed out`),a(new Ce(se.DEADLINE_EXCEEDED,"Request time out"));break;case tb.HTTP_ERROR:const d=l.getStatus();if(we(Bi,`RPC '${t}' ${r} failed with status:`,d,"response text:",l.getResponseText()),d>0){let f=l.getResponseJson();Array.isArray(f)&&(f=f[0]);const h=f==null?void 0:f.error;if(h&&h.status&&h.message){const m=function(U){const b=U.toLowerCase().replace(/_/g,"-");return Object.values(se).indexOf(b)>=0?b:se.UNKNOWN}(h.status);a(new Ce(m,h.message))}else a(new Ce(se.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new Ce(se.UNAVAILABLE,"Connection failed."));break;default:Le()}}finally{we(Bi,`RPC '${t}' ${r} completed.`)}});const c=JSON.stringify(s);we(Bi,`RPC '${t}' ${r} sending request:`,s),l.send(n,"POST",c,i,15)})}Wo(t,n,i){const s=tw(),r=[this.po,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=nW(),a=tW(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Do(l.initMessageHeaders,n,i),l.encodeInitMessageHeaders=!0;const u=r.join("");we(Bi,`Creating RPC '${t}' stream ${s}: ${u}`,l);const d=o.createWebChannel(u,l);let f=!1,h=!1;const m=new PTe({Fo:U=>{h?we(Bi,`Not sending because RPC '${t}' stream ${s} is closed:`,U):(f||(we(Bi,`Opening RPC '${t}' stream ${s} transport.`),d.open(),f=!0),we(Bi,`RPC '${t}' stream ${s} sending:`,U),d.send(U))},Mo:()=>d.close()}),p=(U,b,y)=>{U.listen(b,w=>{try{y(w)}catch(v){setTimeout(()=>{throw v},0)}})};return p(d,Y1.EventType.OPEN,()=>{h||(we(Bi,`RPC '${t}' stream ${s} transport opened.`),m.Qo())}),p(d,Y1.EventType.CLOSE,()=>{h||(h=!0,we(Bi,`RPC '${t}' stream ${s} transport closed`),m.Ko())}),p(d,Y1.EventType.ERROR,U=>{h||(h=!0,eg(Bi,`RPC '${t}' stream ${s} transport errored:`,U),m.Ko(new Ce(se.UNAVAILABLE,"The operation could not be completed")))}),p(d,Y1.EventType.MESSAGE,U=>{var b;if(!h){const y=U.data[0];Xt(!!y);const w=y,v=(w==null?void 0:w.error)||((b=w[0])===null||b===void 0?void 0:b.error);if(v){we(Bi,`RPC '${t}' stream ${s} received error:`,v);const I=v.status;let C=function(k){const S=Pn[k];if(S!==void 0)return kW(S)}(I),_=v.message;C===void 0&&(C=se.INTERNAL,_="Unknown error status: "+I+" with message "+v.message),h=!0,m.Ko(new Ce(C,_)),d.close()}else we(Bi,`RPC '${t}' stream ${s} received:`,y),m.Uo(y)}}),p(a,eW.STAT_EVENT,U=>{U.stat===jv.PROXY?we(Bi,`RPC '${t}' stream ${s} detected buffering proxy`):U.stat===jv.NOPROXY&&we(Bi,`RPC '${t}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{m.$o()},0),m}}function Y3(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sE(e){return new G_e(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MI{constructor(t,n,i=1e3,s=1.5,r=6e4){this.Ti=t,this.timerId=n,this.Go=i,this.zo=s,this.jo=r,this.Ho=0,this.Jo=null,this.Yo=Date.now(),this.reset()}reset(){this.Ho=0}Zo(){this.Ho=this.jo}Xo(t){this.cancel();const n=Math.floor(this.Ho+this.e_()),i=Math.max(0,Date.now()-this.Yo),s=Math.max(0,n-i);s>0&&we("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ho} ms, delay with jitter: ${n} ms, last attempt: ${i} ms ago)`),this.Jo=this.Ti.enqueueAfterDelay(this.timerId,s,()=>(this.Yo=Date.now(),t())),this.Ho*=this.zo,this.Ho<this.Go&&(this.Ho=this.Go),this.Ho>this.jo&&(this.Ho=this.jo)}t_(){this.Jo!==null&&(this.Jo.skipDelay(),this.Jo=null)}cancel(){this.Jo!==null&&(this.Jo.cancel(),this.Jo=null)}e_(){return(Math.random()-.5)*this.Ho}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HL="PersistentStream";class BTe{constructor(t,n,i,s,r,o,a,l){this.Ti=t,this.n_=i,this.r_=s,this.connection=r,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.i_=0,this.s_=null,this.o_=null,this.stream=null,this.__=0,this.a_=new MI(t,n)}u_(){return this.state===1||this.state===5||this.c_()}c_(){return this.state===2||this.state===3}start(){this.__=0,this.state!==4?this.auth():this.l_()}async stop(){this.u_()&&await this.close(0)}h_(){this.state=0,this.a_.reset()}P_(){this.c_()&&this.s_===null&&(this.s_=this.Ti.enqueueAfterDelay(this.n_,6e4,()=>this.T_()))}I_(t){this.E_(),this.stream.send(t)}async T_(){if(this.c_())return this.close(0)}E_(){this.s_&&(this.s_.cancel(),this.s_=null)}d_(){this.o_&&(this.o_.cancel(),this.o_=null)}async close(t,n){this.E_(),this.d_(),this.a_.cancel(),this.i_++,t!==4?this.a_.reset():n&&n.code===se.RESOURCE_EXHAUSTED?(pl(n.toString()),pl("Using maximum backoff delay to prevent overloading the backend."),this.a_.Zo()):n&&n.code===se.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.A_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.Lo(n)}A_(){}auth(){this.state=1;const t=this.R_(this.i_),n=this.i_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,s])=>{this.i_===n&&this.V_(i,s)},i=>{t(()=>{const s=new Ce(se.UNKNOWN,"Fetching auth token failed: "+i.message);return this.m_(s)})})}V_(t,n){const i=this.R_(this.i_);this.stream=this.f_(t,n),this.stream.xo(()=>{i(()=>this.listener.xo())}),this.stream.No(()=>{i(()=>(this.state=2,this.o_=this.Ti.enqueueAfterDelay(this.r_,1e4,()=>(this.c_()&&(this.state=3),Promise.resolve())),this.listener.No()))}),this.stream.Lo(s=>{i(()=>this.m_(s))}),this.stream.onMessage(s=>{i(()=>++this.__==1?this.g_(s):this.onNext(s))})}l_(){this.state=5,this.a_.Xo(async()=>{this.state=0,this.start()})}m_(t){return we(HL,`close with error: ${t}`),this.stream=null,this.close(4,t)}R_(t){return n=>{this.Ti.enqueueAndForget(()=>this.i_===t?n():(we(HL,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class zTe extends BTe{constructor(t,n,i,s,r,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,i,s,o),this.serializer=r}f_(t,n){return this.connection.Wo("Listen",t,n)}g_(t){return this.onNext(t)}onNext(t){this.a_.reset();const n=W_e(this.serializer,t),i=function(r){if(!("targetChange"in r))return Pe.min();const o=r.targetChange;return o.targetIds&&o.targetIds.length?Pe.min():o.readTime?Ja(o.readTime):Pe.min()}(t);return this.listener.p_(n,i)}y_(t){const n={};n.database=RL(this.serializer),n.addTarget=function(r,o){let a;const l=o.target;if(a=Zv(l)?{documents:Z_e(r,l)}:{query:q_e(r,l).ht},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=LW(r,o.resumeToken);const c=Qv(r,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(Pe.min())>0){a.readTime=l5(r,o.snapshotVersion.toTimestamp());const c=Qv(r,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,t);const i=J_e(this.serializer,t);i&&(n.labels=i),this.I_(n)}w_(t){const n={};n.database=RL(this.serializer),n.removeTarget=t,this.I_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HTe{}class VTe extends HTe{constructor(t,n,i,s){super(),this.authCredentials=t,this.appCheckCredentials=n,this.connection=i,this.serializer=s,this.F_=!1}M_(){if(this.F_)throw new Ce(se.FAILED_PRECONDITION,"The client has already been terminated.")}So(t,n,i,s){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,o])=>this.connection.So(t,Jv(n,i),s,r,o)).catch(r=>{throw r.name==="FirebaseError"?(r.code===se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new Ce(se.UNKNOWN,r.toString())})}Co(t,n,i,s,r){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Co(t,Jv(n,i),s,o,a,r)).catch(o=>{throw o.name==="FirebaseError"?(o.code===se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ce(se.UNKNOWN,o.toString())})}terminate(){this.F_=!0,this.connection.terminate()}}class $Te{constructor(t,n){this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.x_=0,this.O_=null,this.N_=!0}B_(){this.x_===0&&(this.L_("Unknown"),this.O_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.O_=null,this.k_("Backend didn't respond within 10 seconds."),this.L_("Offline"),Promise.resolve())))}q_(t){this.state==="Online"?this.L_("Unknown"):(this.x_++,this.x_>=1&&(this.Q_(),this.k_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.L_("Offline")))}set(t){this.Q_(),this.x_=0,t==="Online"&&(this.N_=!1),this.L_(t)}L_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}k_(t){const n=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.N_?(pl(n),this.N_=!1):we("OnlineStateTracker",n)}Q_(){this.O_!==null&&(this.O_.cancel(),this.O_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rg="RemoteStore";class GTe{constructor(t,n,i,s,r){this.localStore=t,this.datastore=n,this.asyncQueue=i,this.remoteSyncer={},this.K_=[],this.U_=new Map,this.W_=new Set,this.G_=[],this.z_=r,this.z_.To(o=>{i.enqueueAndForget(async()=>{Vp(this)&&(we(rg,"Restarting streams for network reachability change."),await async function(l){const c=nt(l);c.W_.add(4),await Hp(c),c.j_.set("Unknown"),c.W_.delete(4),await rE(c)}(this))})}),this.j_=new $Te(i,s)}}async function rE(e){if(Vp(e))for(const t of e.G_)await t(!0)}async function Hp(e){for(const t of e.G_)await t(!1)}function XW(e,t){const n=nt(e);n.U_.has(t.targetId)||(n.U_.set(t.targetId,t),LI(n)?DI(n):Dg(n).c_()&&RI(n,t))}function kI(e,t){const n=nt(e),i=Dg(n);n.U_.delete(t),i.c_()&&jW(n,t),n.U_.size===0&&(i.c_()?i.P_():Vp(n)&&n.j_.set("Unknown"))}function RI(e,t){if(e.H_.Ne(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Pe.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Dg(e).y_(t)}function jW(e,t){e.H_.Ne(t),Dg(e).w_(t)}function DI(e){e.H_=new z_e({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),lt:t=>e.U_.get(t)||null,it:()=>e.datastore.serializer.databaseId}),Dg(e).start(),e.j_.B_()}function LI(e){return Vp(e)&&!Dg(e).u_()&&e.U_.size>0}function Vp(e){return nt(e).W_.size===0}function YW(e){e.H_=void 0}async function XTe(e){e.j_.set("Online")}async function jTe(e){e.U_.forEach((t,n)=>{RI(e,t)})}async function YTe(e,t){YW(e),LI(e)?(e.j_.q_(t),DI(e)):e.j_.set("Unknown")}async function WTe(e,t,n){if(e.j_.set("Online"),t instanceof DW&&t.state===2&&t.cause)try{await async function(s,r){const o=r.cause;for(const a of r.targetIds)s.U_.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.U_.delete(a),s.H_.removeTarget(a))}(e,t)}catch(i){we(rg,"Failed to remove targets %s: %s ",t.targetIds.join(","),i),await VL(e,i)}else if(t instanceof sb?e.H_.We(t):t instanceof RW?e.H_.Ze(t):e.H_.je(t),!n.isEqual(Pe.min()))try{const i=await GW(e.localStore);n.compareTo(i)>=0&&await function(r,o){const a=r.H_.ot(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=r.U_.get(c);u&&r.U_.set(c,u.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const u=r.U_.get(l);if(!u)return;r.U_.set(l,u.withResumeToken(Li.EMPTY_BYTE_STRING,u.snapshotVersion)),jW(r,l);const d=new lc(u.target,l,c,u.sequenceNumber);RI(r,d)}),r.remoteSyncer.applyRemoteEvent(a)}(e,n)}catch(i){we(rg,"Failed to raise snapshot:",i),await VL(e,i)}}async function VL(e,t,n){if(!Rg(t))throw t;e.W_.add(1),await Hp(e),e.j_.set("Offline"),n||(n=()=>GW(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{we(rg,"Retrying IndexedDB access"),await n(),e.W_.delete(1),await rE(e)})}async function $L(e,t){const n=nt(e);n.asyncQueue.verifyOperationInProgress(),we(rg,"RemoteStore received new credentials");const i=Vp(n);n.W_.add(3),await Hp(n),i&&n.j_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.W_.delete(3),await rE(n)}async function KTe(e,t){const n=nt(e);t?(n.W_.delete(2),await rE(n)):t||(n.W_.add(2),await Hp(n),n.j_.set("Unknown"))}function Dg(e){return e.J_||(e.J_=function(n,i,s){const r=nt(n);return r.M_(),new zTe(i,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,s)}(e.datastore,e.asyncQueue,{xo:XTe.bind(null,e),No:jTe.bind(null,e),Lo:YTe.bind(null,e),p_:WTe.bind(null,e)}),e.G_.push(async t=>{t?(e.J_.h_(),LI(e)?DI(e):e.j_.set("Unknown")):(await e.J_.stop(),YW(e))})),e.J_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NI{constructor(t,n,i,s,r){this.asyncQueue=t,this.timerId=n,this.targetTimeMs=i,this.op=s,this.removalCallback=r,this.deferred=new Ac,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,n,i,s,r){const o=Date.now()+i,a=new NI(t,n,o,s,r);return a.start(i),a}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ce(se.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function WW(e,t){if(pl("AsyncQueue",`${t}: ${e}`),Rg(e))return new Ce(se.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eh{static emptySet(t){return new Eh(t.comparator)}constructor(t){this.comparator=t?(n,i)=>t(n,i)||Ne.comparator(n.key,i.key):(n,i)=>Ne.comparator(n.key,i.key),this.keyedMap=W1(),this.sortedSet=new Ln(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const n=this.keyedMap.get(t);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((n,i)=>(t(n),!1))}add(t){const n=this.delete(t.key);return n.copy(n.keyedMap.insert(t.key,t),n.sortedSet.insert(t,null))}delete(t){const n=this.get(t);return n?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(n)):this}isEqual(t){if(!(t instanceof Eh)||this.size!==t.size)return!1;const n=this.sortedSet.getIterator(),i=t.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,r=i.getNext().key;if(!s.isEqual(r))return!1}return!0}toString(){const t=[];return this.forEach(n=>{t.push(n.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,n){const i=new Eh;return i.comparator=this.comparator,i.keyedMap=t,i.sortedSet=n,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GL{constructor(){this.Z_=new Ln(Ne.comparator)}track(t){const n=t.doc.key,i=this.Z_.get(n);i?t.type!==0&&i.type===3?this.Z_=this.Z_.insert(n,t):t.type===3&&i.type!==1?this.Z_=this.Z_.insert(n,{type:i.type,doc:t.doc}):t.type===2&&i.type===2?this.Z_=this.Z_.insert(n,{type:2,doc:t.doc}):t.type===2&&i.type===0?this.Z_=this.Z_.insert(n,{type:0,doc:t.doc}):t.type===1&&i.type===0?this.Z_=this.Z_.remove(n):t.type===1&&i.type===2?this.Z_=this.Z_.insert(n,{type:1,doc:i.doc}):t.type===0&&i.type===1?this.Z_=this.Z_.insert(n,{type:2,doc:t.doc}):Le():this.Z_=this.Z_.insert(n,t)}X_(){const t=[];return this.Z_.inorderTraversal((n,i)=>{t.push(i)}),t}}class og{constructor(t,n,i,s,r,o,a,l,c){this.query=t,this.docs=n,this.oldDocs=i,this.docChanges=s,this.mutatedKeys=r,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(t,n,i,s,r){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new og(t,n,Eh.emptySet(n),o,i,s,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Jy(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const n=this.docChanges,i=t.docChanges;if(n.length!==i.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==i[s].type||!n[s].doc.isEqual(i[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZTe{constructor(){this.ea=void 0,this.ta=[]}na(){return this.ta.some(t=>t.ra())}}class qTe{constructor(){this.queries=XL(),this.onlineState="Unknown",this.ia=new Set}terminate(){(function(n,i){const s=nt(n),r=s.queries;s.queries=XL(),r.forEach((o,a)=>{for(const l of a.ta)l.onError(i)})})(this,new Ce(se.ABORTED,"Firestore shutting down"))}}function XL(){return new Yd(e=>EW(e),Jy)}async function QTe(e,t){const n=nt(e);let i=3;const s=t.query;let r=n.queries.get(s);r?!r.na()&&t.ra()&&(i=2):(r=new ZTe,i=t.ra()?0:1);try{switch(i){case 0:r.ea=await n.onListen(s,!0);break;case 1:r.ea=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const a=WW(o,`Initialization of query '${_f(t.query)}' failed`);return void t.onError(a)}n.queries.set(s,r),r.ta.push(t),t.sa(n.onlineState),r.ea&&t.oa(r.ea)&&OI(n)}async function JTe(e,t){const n=nt(e),i=t.query;let s=3;const r=n.queries.get(i);if(r){const o=r.ta.indexOf(t);o>=0&&(r.ta.splice(o,1),r.ta.length===0?s=t.ra()?0:1:!r.na()&&t.ra()&&(s=2))}switch(s){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}}function eIe(e,t){const n=nt(e);let i=!1;for(const s of t){const r=s.query,o=n.queries.get(r);if(o){for(const a of o.ta)a.oa(s)&&(i=!0);o.ea=s}}i&&OI(n)}function tIe(e,t,n){const i=nt(e),s=i.queries.get(t);if(s)for(const r of s.ta)r.onError(n);i.queries.delete(t)}function OI(e){e.ia.forEach(t=>{t.next()})}var nw,jL;(jL=nw||(nw={}))._a="default",jL.Cache="cache";class nIe{constructor(t,n,i){this.query=t,this.aa=n,this.ua=!1,this.ca=null,this.onlineState="Unknown",this.options=i||{}}oa(t){if(!this.options.includeMetadataChanges){const i=[];for(const s of t.docChanges)s.type!==3&&i.push(s);t=new og(t.query,t.docs,t.oldDocs,i,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let n=!1;return this.ua?this.la(t)&&(this.aa.next(t),n=!0):this.ha(t,this.onlineState)&&(this.Pa(t),n=!0),this.ca=t,n}onError(t){this.aa.error(t)}sa(t){this.onlineState=t;let n=!1;return this.ca&&!this.ua&&this.ha(this.ca,t)&&(this.Pa(this.ca),n=!0),n}ha(t,n){if(!t.fromCache||!this.ra())return!0;const i=n!=="Offline";return(!this.options.Ta||!i)&&(!t.docs.isEmpty()||t.hasCachedResults||n==="Offline")}la(t){if(t.docChanges.length>0)return!0;const n=this.ca&&this.ca.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Pa(t){t=og.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.ua=!0,this.aa.next(t)}ra(){return this.options.source!==nw.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KW{constructor(t){this.key=t}}class ZW{constructor(t){this.key=t}}class iIe{constructor(t,n){this.query=t,this.fa=n,this.ga=null,this.hasCachedResults=!1,this.current=!1,this.pa=Et(),this.mutatedKeys=Et(),this.ya=vW(t),this.wa=new Eh(this.ya)}get Sa(){return this.fa}ba(t,n){const i=n?n.Da:new GL,s=n?n.wa:this.wa;let r=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal((u,d)=>{const f=s.get(u),h=eE(this.query,d)?d:null,m=!!f&&this.mutatedKeys.has(f.key),p=!!h&&(h.hasLocalMutations||this.mutatedKeys.has(h.key)&&h.hasCommittedMutations);let U=!1;f&&h?f.data.isEqual(h.data)?m!==p&&(i.track({type:3,doc:h}),U=!0):this.va(f,h)||(i.track({type:2,doc:h}),U=!0,(l&&this.ya(h,l)>0||c&&this.ya(h,c)<0)&&(a=!0)):!f&&h?(i.track({type:0,doc:h}),U=!0):f&&!h&&(i.track({type:1,doc:f}),U=!0,(l||c)&&(a=!0)),U&&(h?(o=o.add(h),r=p?r.add(u):r.delete(u)):(o=o.delete(u),r=r.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),r=r.delete(u.key),i.track({type:1,doc:u})}return{wa:o,Da:i,ls:a,mutatedKeys:r}}va(t,n){return t.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(t,n,i,s){const r=this.wa;this.wa=t.wa,this.mutatedKeys=t.mutatedKeys;const o=t.Da.X_();o.sort((u,d)=>function(h,m){const p=U=>{switch(U){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Le()}};return p(h)-p(m)}(u.type,d.type)||this.ya(u.doc,d.doc)),this.Ca(i),s=s!=null&&s;const a=n&&!s?this.Fa():[],l=this.pa.size===0&&this.current&&!s?1:0,c=l!==this.ga;return this.ga=l,o.length!==0||c?{snapshot:new og(this.query,t.wa,r,o,t.mutatedKeys,l===0,c,!1,!!i&&i.resumeToken.approximateByteSize()>0),Ma:a}:{Ma:a}}sa(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({wa:this.wa,Da:new GL,mutatedKeys:this.mutatedKeys,ls:!1},!1)):{Ma:[]}}xa(t){return!this.fa.has(t)&&!!this.wa.has(t)&&!this.wa.get(t).hasLocalMutations}Ca(t){t&&(t.addedDocuments.forEach(n=>this.fa=this.fa.add(n)),t.modifiedDocuments.forEach(n=>{}),t.removedDocuments.forEach(n=>this.fa=this.fa.delete(n)),this.current=t.current)}Fa(){if(!this.current)return[];const t=this.pa;this.pa=Et(),this.wa.forEach(i=>{this.xa(i.key)&&(this.pa=this.pa.add(i.key))});const n=[];return t.forEach(i=>{this.pa.has(i)||n.push(new ZW(i))}),this.pa.forEach(i=>{t.has(i)||n.push(new KW(i))}),n}Oa(t){this.fa=t.gs,this.pa=Et();const n=this.ba(t.documents);return this.applyChanges(n,!0)}Na(){return og.fromInitialDocuments(this.query,this.wa,this.mutatedKeys,this.ga===0,this.hasCachedResults)}}const PI="SyncEngine";class sIe{constructor(t,n,i){this.query=t,this.targetId=n,this.view=i}}class rIe{constructor(t){this.key=t,this.Ba=!1}}class oIe{constructor(t,n,i,s,r,o){this.localStore=t,this.remoteStore=n,this.eventManager=i,this.sharedClientState=s,this.currentUser=r,this.maxConcurrentLimboResolutions=o,this.La={},this.ka=new Yd(a=>EW(a),Jy),this.qa=new Map,this.Qa=new Set,this.$a=new Ln(Ne.comparator),this.Ka=new Map,this.Ua=new SI,this.Wa={},this.Ga=new Map,this.za=sg.Un(),this.onlineState="Unknown",this.ja=void 0}get isPrimaryClient(){return this.ja===!0}}async function aIe(e,t,n=!0){const i=tK(e);let s;const r=i.ka.get(t);return r?(i.sharedClientState.addLocalQueryTarget(r.targetId),s=r.view.Na()):s=await qW(i,t,n,!0),s}async function lIe(e,t){const n=tK(e);await qW(n,t,!0,!1)}async function qW(e,t,n,i){const s=await kTe(e.localStore,jo(t)),r=s.targetId,o=e.sharedClientState.addLocalQueryTarget(r,n);let a;return i&&(a=await cIe(e,t,r,o==="current",s.resumeToken)),e.isPrimaryClient&&n&&XW(e.remoteStore,s),a}async function cIe(e,t,n,i,s){e.Ha=(d,f,h)=>async function(p,U,b,y){let w=U.view.ba(b);w.ls&&(w=await PL(p.localStore,U.query,!1).then(({documents:_})=>U.view.ba(_,w)));const v=y&&y.targetChanges.get(U.targetId),I=y&&y.targetMismatches.get(U.targetId)!=null,C=U.view.applyChanges(w,p.isPrimaryClient,v,I);return WL(p,U.targetId,C.Ma),C.snapshot}(e,d,f,h);const r=await PL(e.localStore,t,!0),o=new iIe(t,r.gs),a=o.ba(r.documents),l=zp.createSynthesizedTargetChangeForCurrentChange(n,i&&e.onlineState!=="Offline",s),c=o.applyChanges(a,e.isPrimaryClient,l);WL(e,n,c.Ma);const u=new sIe(t,n,o);return e.ka.set(t,u),e.qa.has(n)?e.qa.get(n).push(t):e.qa.set(n,[t]),c.snapshot}async function uIe(e,t,n){const i=nt(e),s=i.ka.get(t),r=i.qa.get(s.targetId);if(r.length>1)return i.qa.set(s.targetId,r.filter(o=>!Jy(o,t))),void i.ka.delete(t);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(s.targetId),i.sharedClientState.isActiveQueryTarget(s.targetId)||await ew(i.localStore,s.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(s.targetId),n&&kI(i.remoteStore,s.targetId),iw(i,s.targetId)}).catch(Ky)):(iw(i,s.targetId),await ew(i.localStore,s.targetId,!0))}async function dIe(e,t){const n=nt(e),i=n.ka.get(t),s=n.qa.get(i.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),kI(n.remoteStore,i.targetId))}async function QW(e,t){const n=nt(e);try{const i=await ATe(n.localStore,t);t.targetChanges.forEach((s,r)=>{const o=n.Ka.get(r);o&&(Xt(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.Ba=!0:s.modifiedDocuments.size>0?Xt(o.Ba):s.removedDocuments.size>0&&(Xt(o.Ba),o.Ba=!1))}),await eK(n,i,t)}catch(i){await Ky(i)}}function YL(e,t,n){const i=nt(e);if(i.isPrimaryClient&&n===0||!i.isPrimaryClient&&n===1){const s=[];i.ka.forEach((r,o)=>{const a=o.view.sa(t);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=nt(o);l.onlineState=a;let c=!1;l.queries.forEach((u,d)=>{for(const f of d.ta)f.sa(a)&&(c=!0)}),c&&OI(l)}(i.eventManager,t),s.length&&i.La.p_(s),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function fIe(e,t,n){const i=nt(e);i.sharedClientState.updateQueryState(t,"rejected",n);const s=i.Ka.get(t),r=s&&s.key;if(r){let o=new Ln(Ne.comparator);o=o.insert(r,mi.newNoDocument(r,Pe.min()));const a=Et().add(r),l=new iE(Pe.min(),new Map,new Ln(dt),o,a);await QW(i,l),i.$a=i.$a.remove(r),i.Ka.delete(t),FI(i)}else await ew(i.localStore,t,!1).then(()=>iw(i,t,n)).catch(Ky)}function iw(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const i of e.qa.get(t))e.ka.delete(i),n&&e.La.Ja(i,n);e.qa.delete(t),e.isPrimaryClient&&e.Ua.br(t).forEach(i=>{e.Ua.containsKey(i)||JW(e,i)})}function JW(e,t){e.Qa.delete(t.path.canonicalString());const n=e.$a.get(t);n!==null&&(kI(e.remoteStore,n),e.$a=e.$a.remove(t),e.Ka.delete(n),FI(e))}function WL(e,t,n){for(const i of n)i instanceof KW?(e.Ua.addReference(i.key,t),hIe(e,i)):i instanceof ZW?(we(PI,"Document no longer in limbo: "+i.key),e.Ua.removeReference(i.key,t),e.Ua.containsKey(i.key)||JW(e,i.key)):Le()}function hIe(e,t){const n=t.key,i=n.path.canonicalString();e.$a.get(n)||e.Qa.has(i)||(we(PI,"New document in limbo: "+n),e.Qa.add(i),FI(e))}function FI(e){for(;e.Qa.size>0&&e.$a.size<e.maxConcurrentLimboResolutions;){const t=e.Qa.values().next().value;e.Qa.delete(t);const n=new Ne(ln.fromString(t)),i=e.za.next();e.Ka.set(i,new rIe(n)),e.$a=e.$a.insert(n,i),XW(e.remoteStore,new lc(jo(vI(n.path)),i,"TargetPurposeLimboResolution",Zy.ae))}}async function eK(e,t,n){const i=nt(e),s=[],r=[],o=[];i.ka.isEmpty()||(i.ka.forEach((a,l)=>{o.push(i.Ha(l,t,n).then(c=>{var u;if((c||n)&&i.isPrimaryClient){const d=c?!c.fromCache:(u=n==null?void 0:n.targetChanges.get(l.targetId))===null||u===void 0?void 0:u.current;i.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(c){s.push(c);const d=CI.Yi(l.targetId,c);r.push(d)}}))}),await Promise.all(o),i.La.p_(s),await async function(l,c){const u=nt(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>ie.forEach(c,f=>ie.forEach(f.Hi,h=>u.persistence.referenceDelegate.addReference(d,f.targetId,h)).next(()=>ie.forEach(f.Ji,h=>u.persistence.referenceDelegate.removeReference(d,f.targetId,h)))))}catch(d){if(!Rg(d))throw d;we(AI,"Failed to update sequence numbers: "+d)}for(const d of c){const f=d.targetId;if(!d.fromCache){const h=u.Ts.get(f),m=h.snapshotVersion,p=h.withLastLimboFreeSnapshotVersion(m);u.Ts=u.Ts.insert(f,p)}}}(i.localStore,r))}async function gIe(e,t){const n=nt(e);if(!n.currentUser.isEqual(t)){we(PI,"User change. New user:",t.toKey());const i=await $W(n.localStore,t);n.currentUser=t,function(r,o){r.Ga.forEach(a=>{a.forEach(l=>{l.reject(new Ce(se.CANCELLED,o))})}),r.Ga.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,i.removedBatchIds,i.addedBatchIds),await eK(n,i.Rs)}}function mIe(e,t){const n=nt(e),i=n.Ka.get(t);if(i&&i.Ba)return Et().add(i.key);{let s=Et();const r=n.qa.get(t);if(!r)return s;for(const o of r){const a=n.ka.get(o);s=s.unionWith(a.view.Sa)}return s}}function tK(e){const t=nt(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=QW.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=mIe.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=fIe.bind(null,t),t.La.p_=eIe.bind(null,t.eventManager),t.La.Ja=tIe.bind(null,t.eventManager),t}class d5{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=sE(t.databaseInfo.databaseId),this.sharedClientState=this.Za(t),this.persistence=this.Xa(t),await this.persistence.start(),this.localStore=this.eu(t),this.gcScheduler=this.tu(t,this.localStore),this.indexBackfillerScheduler=this.nu(t,this.localStore)}tu(t,n){return null}nu(t,n){return null}eu(t){return CTe(this.persistence,new ITe,t.initialUser,this.serializer)}Xa(t){return new VW(xI.ri,this.serializer)}Za(t){return new DTe}async terminate(){var t,n;(t=this.gcScheduler)===null||t===void 0||t.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}d5.provider={build:()=>new d5};class pIe extends d5{constructor(t){super(),this.cacheSizeBytes=t}tu(t,n){Xt(this.persistence.referenceDelegate instanceof u5);const i=this.persistence.referenceDelegate.garbageCollector;return new uTe(i,t.asyncQueue,n)}Xa(t){const n=this.cacheSizeBytes!==void 0?ys.withCacheSize(this.cacheSizeBytes):ys.DEFAULT;return new VW(i=>u5.ri(i,n),this.serializer)}}class sw{async initialize(t,n){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>YL(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=gIe.bind(null,this.syncEngine),await KTe(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new qTe}()}createDatastore(t){const n=sE(t.databaseInfo.databaseId),i=function(r){return new FTe(r)}(t.databaseInfo);return function(r,o,a,l){return new VTe(r,o,a,l)}(t.authCredentials,t.appCheckCredentials,i,n)}createRemoteStore(t){return function(i,s,r,o,a){return new GTe(i,s,r,o,a)}(this.localStore,this.datastore,t.asyncQueue,n=>YL(this.syncEngine,n,0),function(){return zL.D()?new zL:new LTe}())}createSyncEngine(t,n){return function(s,r,o,a,l,c,u){const d=new oIe(s,r,o,a,l,c);return u&&(d.ja=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,n)}async terminate(){var t,n;await async function(s){const r=nt(s);we(rg,"RemoteStore shutting down."),r.W_.add(5),await Hp(r),r.z_.shutdown(),r.j_.set("Unknown")}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}sw.provider={build:()=>new sw};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UIe{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.iu(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.iu(this.observer.error,t):pl("Uncaught Error in snapshot listener:",t.toString()))}su(){this.muted=!0}iu(t,n){setTimeout(()=>{this.muted||t(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bIe{constructor(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(t){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new Ce(se.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const n=await async function(s,r){const o=nt(s),a={documents:r.map(d=>c5(o.serializer,d))},l=await o.Co("BatchGetDocuments",o.serializer.databaseId,ln.emptyPath(),a,r.length),c=new Map;l.forEach(d=>{const f=Y_e(o.serializer,d);c.set(f.key.toString(),f)});const u=[];return r.forEach(d=>{const f=c.get(d.toString());Xt(!!f),u.push(f)}),u}(this.datastore,t);return n.forEach(i=>this.recordVersion(i)),n}set(t,n){this.write(n.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())}update(t,n){try{this.write(n.toMutation(t,this.preconditionForUpdate(t)))}catch(i){this.lastTransactionError=i}this.writtenDocs.add(t.toString())}delete(t){this.write(new _I(t,this.precondition(t))),this.writtenDocs.add(t.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const t=this.readVersions;this.mutations.forEach(n=>{t.delete(n.key.toString())}),t.forEach((n,i)=>{const s=Ne.fromPath(i);this.mutations.push(new MW(s,this.precondition(s)))}),await async function(i,s){const r=nt(i),o={writes:s.map(a=>K_e(r.serializer,a))};await r.So("Commit",r.serializer.databaseId,ln.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(t){let n;if(t.isFoundDocument())n=t.version;else{if(!t.isNoDocument())throw Le();n=Pe.min()}const i=this.readVersions.get(t.key.toString());if(i){if(!n.isEqual(i))throw new Ce(se.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),n)}precondition(t){const n=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&n?n.isEqual(Pe.min())?br.exists(!1):br.updateTime(n):br.none()}preconditionForUpdate(t){const n=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&n){if(n.isEqual(Pe.min()))throw new Ce(se.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return br.updateTime(n)}return br.exists(!0)}write(t){this.ensureCommitNotCalled(),this.mutations.push(t)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yIe{constructor(t,n,i,s,r){this.asyncQueue=t,this.datastore=n,this.options=i,this.updateFunction=s,this.deferred=r,this.Tu=i.maxAttempts,this.a_=new MI(this.asyncQueue,"transaction_retry")}Iu(){this.Tu-=1,this.Eu()}Eu(){this.a_.Xo(async()=>{const t=new bIe(this.datastore),n=this.du(t);n&&n.then(i=>{this.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{this.deferred.resolve(i)}).catch(s=>{this.Au(s)}))}).catch(i=>{this.Au(i)})})}du(t){try{const n=this.updateFunction(t);return!Fp(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Au(t){this.Tu>0&&this.Ru(t)?(this.Tu-=1,this.asyncQueue.enqueueAndForget(()=>(this.Eu(),Promise.resolve()))):this.deferred.reject(t)}Ru(t){if(t.name==="FirebaseError"){const n=t.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!P_e(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qc="FirestoreClient";class EIe{constructor(t,n,i,s,r){this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=i,this.databaseInfo=s,this.user=Vi.UNAUTHENTICATED,this.clientId=sW.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=r,this.authCredentials.start(i,async o=>{we(Qc,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(i,o=>(we(Qc,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Ac;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(n){const i=WW(n,"Failed to shutdown persistence");t.reject(i)}}),t.promise}}async function W3(e,t){e.asyncQueue.verifyOperationInProgress(),we(Qc,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let i=n.initialUser;e.setCredentialChangeListener(async s=>{i.isEqual(s)||(await $W(t.localStore,s),i=s)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function KL(e,t){e.asyncQueue.verifyOperationInProgress();const n=await vIe(e);we(Qc,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(i=>$L(t.remoteStore,i)),e.setAppCheckTokenChangeListener((i,s)=>$L(t.remoteStore,s)),e._onlineComponents=t}async function vIe(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){we(Qc,"Using user provided OfflineComponentProvider");try{await W3(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(s){return s.name==="FirebaseError"?s.code===se.FAILED_PRECONDITION||s.code===se.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;eg("Error using user provided cache. Falling back to memory cache: "+n),await W3(e,new d5)}}else we(Qc,"Using default OfflineComponentProvider"),await W3(e,new pIe(void 0));return e._offlineComponents}async function nK(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(we(Qc,"Using user provided OnlineComponentProvider"),await KL(e,e._uninitializedComponentsProvider._online)):(we(Qc,"Using default OnlineComponentProvider"),await KL(e,new sw))),e._onlineComponents}function wIe(e){return nK(e).then(t=>t.datastore)}async function _Ie(e){const t=await nK(e),n=t.eventManager;return n.onListen=aIe.bind(null,t.syncEngine),n.onUnlisten=uIe.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=lIe.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=dIe.bind(null,t.syncEngine),n}function TIe(e,t,n={}){const i=new Ac;return e.asyncQueue.enqueueAndForget(async()=>function(r,o,a,l,c){const u=new UIe({next:f=>{u.su(),o.enqueueAndForget(()=>JTe(r,d));const h=f.docs.has(a);!h&&f.fromCache?c.reject(new Ce(se.UNAVAILABLE,"Failed to get document because the client is offline.")):h&&f.fromCache&&l&&l.source==="server"?c.reject(new Ce(se.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(f)},error:f=>c.reject(f)}),d=new nIe(vI(a.path),u,{includeMetadataChanges:!0,Ta:!0});return QTe(r,d)}(await _Ie(e),e.asyncQueue,t,n,i)),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iK(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZL=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IIe(e,t,n){if(!n)throw new Ce(se.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function SIe(e,t,n,i){if(t===!0&&i===!0)throw new Ce(se.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function qL(e){if(!Ne.isDocumentKey(e))throw new Ce(se.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function BI(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(i){return i.constructor?i.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":Le()}function f5(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Ce(se.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=BI(e);throw new Ce(se.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sK="firestore.googleapis.com",QL=!0;class JL{constructor(t){var n,i;if(t.host===void 0){if(t.ssl!==void 0)throw new Ce(se.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=sK,this.ssl=QL}else this.host=t.host,this.ssl=(n=t.ssl)!==null&&n!==void 0?n:QL;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=HW;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<lTe)throw new Ce(se.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}SIe("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=iK((i=t.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Ce(se.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Ce(se.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Ce(se.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(i,s){return i.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class zI{constructor(t,n,i,s){this._authCredentials=t,this._appCheckCredentials=n,this._databaseId=i,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new JL({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ce(se.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new Ce(se.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new JL(t),t.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new B9e;switch(i.type){case"firstParty":return new $9e(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Ce(se.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const i=ZL.get(n);i&&(we("ComponentProvider","Removing Datastore"),ZL.delete(n),i.terminate())}(this),Promise.resolve()}}function xIe(e,t,n,i={}){var s;const r=(e=f5(e,zI))._getSettings(),o=`${t}:${n}`;if(r.host!==sK&&r.host!==o&&eg("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},r),{host:o,ssl:!1})),i.mockUserToken){let a,l;if(typeof i.mockUserToken=="string")a=i.mockUserToken,l=Vi.MOCK_USER;else{a=BY(i.mockUserToken,(s=e._app)===null||s===void 0?void 0:s.options.projectId);const c=i.mockUserToken.sub||i.mockUserToken.user_id;if(!c)throw new Ce(se.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Vi(c)}e._authCredentials=new z9e(new iW(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HI{constructor(t,n,i){this.converter=n,this._query=i,this.type="query",this.firestore=t}withConverter(t){return new HI(this.firestore,t,this._query)}}class Cr{constructor(t,n,i){this.converter=n,this._key=i,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new jm(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Cr(this.firestore,t,this._key)}}class jm extends HI{constructor(t,n,i){super(t,n,vI(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Cr(this.firestore,null,new Ne(t))}withConverter(t){return new jm(this.firestore,t,this._path)}}function rK(e,t,...n){if(e=fo(e),arguments.length===1&&(t=sW.newId()),IIe("doc","path",t),e instanceof zI){const i=ln.fromString(t,...n);return qL(i),new Cr(e,null,new Ne(i))}{if(!(e instanceof Cr||e instanceof jm))throw new Ce(se.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=e._path.child(ln.fromString(t,...n));return qL(i),new Cr(e.firestore,e instanceof jm?e.converter:null,new Ne(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eN="AsyncQueue";class tN{constructor(t=Promise.resolve()){this.Vu=[],this.mu=!1,this.fu=[],this.gu=null,this.pu=!1,this.yu=!1,this.wu=[],this.a_=new MI(this,"async_queue_retry"),this.Su=()=>{const i=Y3();i&&we(eN,"Visibility state changed to "+i.visibilityState),this.a_.t_()},this.bu=t;const n=Y3();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Su)}get isShuttingDown(){return this.mu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.Du(),this.vu(t)}enterRestrictedMode(t){if(!this.mu){this.mu=!0,this.yu=t||!1;const n=Y3();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Su)}}enqueue(t){if(this.Du(),this.mu)return new Promise(()=>{});const n=new Ac;return this.vu(()=>this.mu&&this.yu?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Vu.push(t),this.Cu()))}async Cu(){if(this.Vu.length!==0){try{await this.Vu[0](),this.Vu.shift(),this.a_.reset()}catch(t){if(!Rg(t))throw t;we(eN,"Operation failed with retryable error: "+t)}this.Vu.length>0&&this.a_.Xo(()=>this.Cu())}}vu(t){const n=this.bu.then(()=>(this.pu=!0,t().catch(i=>{this.gu=i,this.pu=!1;const s=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(i);throw pl("INTERNAL UNHANDLED ERROR: ",s),i}).then(i=>(this.pu=!1,i))));return this.bu=n,n}enqueueAfterDelay(t,n,i){this.Du(),this.wu.indexOf(t)>-1&&(n=0);const s=NI.createAndSchedule(this,t,n,i,r=>this.Fu(r));return this.fu.push(s),s}Du(){this.gu&&Le()}verifyOperationInProgress(){}async Mu(){let t;do t=this.bu,await t;while(t!==this.bu)}xu(t){for(const n of this.fu)if(n.timerId===t)return!0;return!1}Ou(t){return this.Mu().then(()=>{this.fu.sort((n,i)=>n.targetTimeMs-i.targetTimeMs);for(const n of this.fu)if(n.skipDelay(),t!=="all"&&n.timerId===t)break;return this.Mu()})}Nu(t){this.wu.push(t)}Fu(t){const n=this.fu.indexOf(t);this.fu.splice(n,1)}}class VI extends zI{constructor(t,n,i,s){super(t,n,i,s),this.type="firestore",this._queue=new tN,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new tN(t),this._firestoreClient=void 0,await t}}}function CIe(e,t){const n=typeof e=="object"?e:WY(),i=typeof e=="string"?e:n5,s=GY(n,"firestore").getImmediate({identifier:i});if(!s._initialized){const r=PY("firestore");r&&xIe(s,...r)}return s}function oK(e){if(e._terminated)throw new Ce(se.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||AIe(e),e._firestoreClient}function AIe(e){var t,n,i;const s=e._freezeSettings(),r=function(a,l,c,u){return new s_e(a,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,iK(u.experimentalLongPollingOptions),u.useFetchStreams)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,s);e._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((i=s.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(e._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),e._firestoreClient=new EIe(e._authCredentials,e._appCheckCredentials,e._queue,r,e._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(e._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ul{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Ul(Li.fromBase64String(t))}catch(n){throw new Ce(se.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(t){return new Ul(Li.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oE{constructor(...t){for(let n=0;n<t.length;++n)if(t[n].length===0)throw new Ce(se.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Xi(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $I{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GI{constructor(t,n){if(!isFinite(t)||t<-90||t>90)throw new Ce(se.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new Ce(se.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return dt(this._lat,t._lat)||dt(this._long,t._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XI{constructor(t){this._values=(t||[]).map(n=>n)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(i,s){if(i.length!==s.length)return!1;for(let r=0;r<i.length;++r)if(i[r]!==s[r])return!1;return!0}(this._values,t._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MIe=/^__.*__$/;class kIe{constructor(t,n,i){this.data=t,this.fieldMask=n,this.fieldTransforms=i}toMutation(t,n){return this.fieldMask!==null?new Wd(t,this.data,this.fieldMask,n,this.fieldTransforms):new Bp(t,this.data,n,this.fieldTransforms)}}class aK{constructor(t,n,i){this.data=t,this.fieldMask=n,this.fieldTransforms=i}toMutation(t,n){return new Wd(t,this.data,this.fieldMask,n,this.fieldTransforms)}}function lK(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Le()}}class jI{constructor(t,n,i,s,r,o){this.settings=t,this.databaseId=n,this.serializer=i,this.ignoreUndefinedProperties=s,r===void 0&&this.Bu(),this.fieldTransforms=r||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Lu(){return this.settings.Lu}ku(t){return new jI(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}qu(t){var n;const i=(n=this.path)===null||n===void 0?void 0:n.child(t),s=this.ku({path:i,Qu:!1});return s.$u(t),s}Ku(t){var n;const i=(n=this.path)===null||n===void 0?void 0:n.child(t),s=this.ku({path:i,Qu:!1});return s.Bu(),s}Uu(t){return this.ku({path:void 0,Qu:!0})}Wu(t){return h5(t,this.settings.methodName,this.settings.Gu||!1,this.path,this.settings.zu)}contains(t){return this.fieldMask.find(n=>t.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>t.isPrefixOf(n.field))!==void 0}Bu(){if(this.path)for(let t=0;t<this.path.length;t++)this.$u(this.path.get(t))}$u(t){if(t.length===0)throw this.Wu("Document fields must not be empty");if(lK(this.Lu)&&MIe.test(t))throw this.Wu('Document fields cannot begin and end with "__"')}}class RIe{constructor(t,n,i){this.databaseId=t,this.ignoreUndefinedProperties=n,this.serializer=i||sE(t)}ju(t,n,i,s=!1){return new jI({Lu:t,methodName:n,zu:i,path:Xi.emptyPath(),Qu:!1,Gu:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function DIe(e){const t=e._freezeSettings(),n=sE(e._databaseId);return new RIe(e._databaseId,!!t.ignoreUndefinedProperties,n)}function LIe(e,t,n,i,s,r={}){const o=e.ju(r.merge||r.mergeFields?2:0,t,n,s);YI("Data must be an object, but it was:",o,i);const a=cK(i,o);let l,c;if(r.merge)l=new wr(o.fieldMask),c=o.fieldTransforms;else if(r.mergeFields){const u=[];for(const d of r.mergeFields){const f=rw(t,d,n);if(!o.contains(f))throw new Ce(se.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);dK(u,f)||u.push(f)}l=new wr(u),c=o.fieldTransforms.filter(d=>l.covers(d.field))}else l=null,c=o.fieldTransforms;return new kIe(new Es(a),l,c)}class aE extends $I{_toFieldTransform(t){if(t.Lu!==2)throw t.Lu===1?t.Wu(`${this._methodName}() can only appear at the top level of your update data`):t.Wu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof aE}}function NIe(e,t,n,i){const s=e.ju(1,t,n);YI("Data must be an object, but it was:",s,i);const r=[],o=Es.empty();jd(i,(l,c)=>{const u=WI(t,l,n);c=fo(c);const d=s.Ku(u);if(c instanceof aE)r.push(u);else{const f=lE(c,d);f!=null&&(r.push(u),o.set(u,f))}});const a=new wr(r);return new aK(o,a,s.fieldTransforms)}function OIe(e,t,n,i,s,r){const o=e.ju(1,t,n),a=[rw(t,i,n)],l=[s];if(r.length%2!=0)throw new Ce(se.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<r.length;f+=2)a.push(rw(t,r[f])),l.push(r[f+1]);const c=[],u=Es.empty();for(let f=a.length-1;f>=0;--f)if(!dK(c,a[f])){const h=a[f];let m=l[f];m=fo(m);const p=o.Ku(h);if(m instanceof aE)c.push(h);else{const U=lE(m,p);U!=null&&(c.push(h),u.set(h,U))}}const d=new wr(c);return new aK(u,d,o.fieldTransforms)}function lE(e,t){if(uK(e=fo(e)))return YI("Unsupported field value:",t,e),cK(e,t);if(e instanceof $I)return function(i,s){if(!lK(s.Lu))throw s.Wu(`${i._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Wu(`${i._methodName}() is not currently supported inside arrays`);const r=i._toFieldTransform(s);r&&s.fieldTransforms.push(r)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Qu&&t.Lu!==4)throw t.Wu("Nested arrays are not supported");return function(i,s){const r=[];let o=0;for(const a of i){let l=lE(a,s.Uu(o));l==null&&(l={nullValue:"NULL_VALUE"}),r.push(l),o++}return{arrayValue:{values:r}}}(e,t)}return function(i,s){if((i=fo(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return C_e(s.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const r=Ei.fromDate(i);return{timestampValue:l5(s.serializer,r)}}if(i instanceof Ei){const r=new Ei(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:l5(s.serializer,r)}}if(i instanceof GI)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Ul)return{bytesValue:LW(s.serializer,i._byteString)};if(i instanceof Cr){const r=s.databaseId,o=i.firestore._databaseId;if(!o.isEqual(r))throw s.Wu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:II(i.firestore._databaseId||s.databaseId,i._key.path)}}if(i instanceof XI)return function(o,a){return{mapValue:{fields:{[fW]:{stringValue:hW},[i5]:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw a.Wu("VectorValues must only contain numeric values.");return wI(a.serializer,c)})}}}}}}(i,s);throw s.Wu(`Unsupported field value: ${BI(i)}`)}(e,t)}function cK(e,t){const n={};return oW(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):jd(e,(i,s)=>{const r=lE(s,t.qu(i));r!=null&&(n[i]=r)}),{mapValue:{fields:n}}}function uK(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof Ei||e instanceof GI||e instanceof Ul||e instanceof Cr||e instanceof $I||e instanceof XI)}function YI(e,t,n){if(!uK(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const i=BI(n);throw i==="an object"?t.Wu(e+" a custom object"):t.Wu(e+" "+i)}}function rw(e,t,n){if((t=fo(t))instanceof oE)return t._internalPath;if(typeof t=="string")return WI(e,t);throw h5("Field path arguments must be of type string or ",e,!1,void 0,n)}const PIe=new RegExp("[~\\*/\\[\\]]");function WI(e,t,n){if(t.search(PIe)>=0)throw h5(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new oE(...t.split("."))._internalPath}catch{throw h5(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function h5(e,t,n,i,s){const r=i&&!i.isEmpty(),o=s!==void 0;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(r||o)&&(l+=" (found",r&&(l+=` in field ${i}`),o&&(l+=` in document ${s}`),l+=")"),new Ce(se.INVALID_ARGUMENT,a+e+l)}function dK(e,t){return e.some(n=>n.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g5{constructor(t,n,i,s,r){this._firestore=t,this._userDataWriter=n,this._key=i,this._document=s,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new Cr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new FIe(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const n=this._document.data.field(fK("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n)}}}class FIe extends g5{data(){return super.data()}}function fK(e,t){return typeof t=="string"?WI(e,t):t instanceof oE?t._internalPath:t._delegate._internalPath}class hK{convertValue(t,n="none"){switch(Zc(t)){case 0:return null;case 1:return t.booleanValue;case 2:return kn(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,n);case 5:return t.stringValue;case 6:return this.convertBytes(Kc(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,n);case 11:return this.convertObject(t.mapValue,n);case 10:return this.convertVectorValue(t.mapValue);default:throw Le()}}convertObject(t,n){return this.convertObjectMap(t.fields,n)}convertObjectMap(t,n="none"){const i={};return jd(t,(s,r)=>{i[s]=this.convertValue(r,n)}),i}convertVectorValue(t){var n,i,s;const r=(s=(i=(n=t.fields)===null||n===void 0?void 0:n[i5].arrayValue)===null||i===void 0?void 0:i.values)===null||s===void 0?void 0:s.map(o=>kn(o.doubleValue));return new XI(r)}convertGeoPoint(t){return new GI(kn(t.latitude),kn(t.longitude))}convertArray(t,n){return(t.values||[]).map(i=>this.convertValue(i,n))}convertServerTimestamp(t,n){switch(n){case"previous":const i=qy(t);return i==null?null:this.convertValue(i,n);case"estimate":return this.convertTimestamp(Hm(t));default:return null}}convertTimestamp(t){const n=Wc(t);return new Ei(n.seconds,n.nanos)}convertDocumentKey(t,n){const i=ln.fromString(t);Xt(zW(i));const s=new Vm(i.get(1),i.get(3)),r=new Ne(i.popFirst(5));return s.isEqual(n)||pl(`Document ${r} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BIe(e,t,n){let i;return i=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,i}class zIe extends hK{constructor(t){super(),this.firestore=t}convertBytes(t){return new Ul(t)}convertReference(t){const n=this.convertDocumentKey(t,this.firestore._databaseId);return new Cr(this.firestore,null,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gK{constructor(t,n){this.hasPendingWrites=t,this.fromCache=n}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class KI extends g5{constructor(t,n,i,s,r,o){super(t,n,i,s,o),this._firestore=t,this._firestoreImpl=t,this.metadata=r}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const n=new HIe(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,n={}){if(this._document){const i=this._document.data.field(fK("DocumentSnapshot.get",t));if(i!==null)return this._userDataWriter.convertValue(i,n.serverTimestamps)}}}class HIe extends KI{data(t={}){return super.data(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VIe(e){e=f5(e,Cr);const t=f5(e.firestore,VI);return TIe(oK(t),e._key).then(n=>$Ie(t,e,n))}class mK extends hK{constructor(t){super(),this.firestore=t}convertBytes(t){return new Ul(t)}convertReference(t){const n=this.convertDocumentKey(t,this.firestore._databaseId);return new Cr(this.firestore,null,n)}}function $Ie(e,t,n){const i=n.docs.get(t._key),s=new mK(e);return new KI(e,s,t._key,i,new gK(n.hasPendingWrites,n.fromCache),t.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GIe={maxAttempts:5};function Z1(e,t){if((e=fo(e)).firestore!==t)throw new Ce(se.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XIe{constructor(t,n){this._firestore=t,this._transaction=n,this._dataReader=DIe(t)}get(t){const n=Z1(t,this._firestore),i=new zIe(this._firestore);return this._transaction.lookup([n._key]).then(s=>{if(!s||s.length!==1)return Le();const r=s[0];if(r.isFoundDocument())return new g5(this._firestore,i,r.key,r,n.converter);if(r.isNoDocument())return new g5(this._firestore,i,n._key,null,n.converter);throw Le()})}set(t,n,i){const s=Z1(t,this._firestore),r=BIe(s.converter,n,i),o=LIe(this._dataReader,"Transaction.set",s._key,r,s.converter!==null,i);return this._transaction.set(s._key,o),this}update(t,n,i,...s){const r=Z1(t,this._firestore);let o;return o=typeof(n=fo(n))=="string"||n instanceof oE?OIe(this._dataReader,"Transaction.update",r._key,n,i,s):NIe(this._dataReader,"Transaction.update",r._key,n),this._transaction.update(r._key,o),this}delete(t){const n=Z1(t,this._firestore);return this._transaction.delete(n._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jIe extends XIe{constructor(t,n){super(t,n),this._firestore=t}get(t){const n=Z1(t,this._firestore),i=new mK(this._firestore);return super.get(t).then(s=>new KI(this._firestore,i,n._key,s._document,new gK(!1,!1),n.converter))}}function YIe(e,t,n){e=f5(e,VI);const i=Object.assign(Object.assign({},GIe),n);return function(r){if(r.maxAttempts<1)throw new Ce(se.INVALID_ARGUMENT,"Max attempts must be at least 1")}(i),function(r,o,a){const l=new Ac;return r.asyncQueue.enqueueAndForget(async()=>{const c=await wIe(r);new yIe(r.asyncQueue,c,a,o,l).Iu()}),l.promise}(oK(e),s=>t(new jIe(e,s)),i)}(function(t,n=!0){(function(s){kg=s})(jY),Fm(new Jh("firestore",(i,{instanceIdentifier:s,options:r})=>{const o=i.getProvider("app").getImmediate(),a=new VI(new H9e(i.getProvider("auth-internal")),new G9e(o,i.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Ce(se.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Vm(c.options.projectId,u)}(o,s),o);return r=Object.assign({useFetchStreams:n},r),a._setSettings(r),a},"PUBLIC").setMultipleInstances(!0)),xc(aL,lL,t),xc(aL,lL,"esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pK="firebasestorage.googleapis.com",UK="storageBucket",WIe=2*60*1e3,KIe=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn extends Xd{constructor(t,n,i=0){super(K3(t),`Firebase Storage: ${n} (${K3(t)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Kn.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return K3(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Wn;(function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Wn||(Wn={}));function K3(e){return"storage/"+e}function ZI(){const e="An unknown error occurred, please check the error payload for server response.";return new Kn(Wn.UNKNOWN,e)}function ZIe(e){return new Kn(Wn.QUOTA_EXCEEDED,"Quota for bucket '"+e+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function qIe(){const e="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Kn(Wn.UNAUTHENTICATED,e)}function QIe(){return new Kn(Wn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function JIe(e){return new Kn(Wn.UNAUTHORIZED,"User does not have permission to access '"+e+"'.")}function eSe(){return new Kn(Wn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function tSe(){return new Kn(Wn.CANCELED,"User canceled the upload/download.")}function nSe(e){return new Kn(Wn.INVALID_URL,"Invalid URL '"+e+"'.")}function iSe(e){return new Kn(Wn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}function sSe(){return new Kn(Wn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+UK+"' property when initializing the app?")}function rSe(){return new Kn(Wn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function oSe(e){return new Kn(Wn.UNSUPPORTED_ENVIRONMENT,`${e} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function ow(e){return new Kn(Wn.INVALID_ARGUMENT,e)}function bK(){return new Kn(Wn.APP_DELETED,"The Firebase app was deleted.")}function aSe(e){return new Kn(Wn.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function B0(e,t){return new Kn(Wn.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function _1(e){throw new Kn(Wn.INTERNAL_ERROR,"Internal error: "+e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class js{constructor(t,n){this.bucket=t,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,n){let i;try{i=js.makeFromUrl(t,n)}catch{return new js(t,"")}if(i.path==="")return i;throw iSe(t)}static makeFromUrl(t,n){let i=null;const s="([A-Za-z0-9.\\-_]+)";function r(v){v.path.charAt(v.path.length-1)==="/"&&(v.path_=v.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),l={bucket:1,path:3};function c(v){v.path_=decodeURIComponent(v.path)}const u="v[A-Za-z0-9_]+",d=n.replace(/[.]/g,"\\."),f="(/([^?#]*).*)?$",h=new RegExp(`^https?://${d}/${u}/b/${s}/o${f}`,"i"),m={bucket:1,path:3},p=n===pK?"(?:storage.googleapis.com|storage.cloud.google.com)":n,U="([^?#]*)",b=new RegExp(`^https?://${p}/${s}/${U}`,"i"),w=[{regex:a,indices:l,postModify:r},{regex:h,indices:m,postModify:c},{regex:b,indices:{bucket:1,path:2},postModify:c}];for(let v=0;v<w.length;v++){const I=w[v],C=I.regex.exec(t);if(C){const _=C[I.indices.bucket];let T=C[I.indices.path];T||(T=""),i=new js(_,T),I.postModify(i);break}}if(i==null)throw nSe(t);return i}}class lSe{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cSe(e,t,n){let i=1,s=null,r=null,o=!1,a=0;function l(){return a===2}let c=!1;function u(...U){c||(c=!0,t.apply(null,U))}function d(U){s=setTimeout(()=>{s=null,e(h,l())},U)}function f(){r&&clearTimeout(r)}function h(U,...b){if(c){f();return}if(U){f(),u.call(null,U,...b);return}if(l()||o){f(),u.call(null,U,...b);return}i<64&&(i*=2);let w;a===1?(a=2,w=0):w=(i+Math.random())*1e3,d(w)}let m=!1;function p(U){m||(m=!0,f(),!c&&(s!==null?(U||(a=2),clearTimeout(s),d(0)):U||(a=1)))}return d(0),r=setTimeout(()=>{o=!0,p(!0)},n),p}function uSe(e){e(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dSe(e){return e!==void 0}function fSe(e){return typeof e=="object"&&!Array.isArray(e)}function yK(e){return typeof e=="string"||e instanceof String}function nN(e){return qI()&&e instanceof Blob}function qI(){return typeof Blob<"u"}function iN(e,t,n,i){if(i<t)throw ow(`Invalid value for '${e}'. Expected ${t} or greater.`);if(i>n)throw ow(`Invalid value for '${e}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hSe(e,t,n){let i=t;return n==null&&(i=`https://${t}`),`${n}://${i}/v0${e}`}function gSe(e){const t=encodeURIComponent;let n="?";for(const i in e)if(e.hasOwnProperty(i)){const s=t(i)+"="+t(e[i]);n=n+s+"&"}return n=n.slice(0,-1),n}var ed;(function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"})(ed||(ed={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mSe(e,t){const n=e>=500&&e<600,s=[408,429].indexOf(e)!==-1,r=t.indexOf(e)!==-1;return n||s||r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pSe{constructor(t,n,i,s,r,o,a,l,c,u,d,f=!0){this.url_=t,this.method_=n,this.headers_=i,this.body_=s,this.successCodes_=r,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=d,this.retry=f,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((h,m)=>{this.resolve_=h,this.reject_=m,this.start_()})}start_(){const t=(i,s)=>{if(s){i(!1,new c2(!1,null,!0));return}const r=this.connectionFactory_();this.pendingConnection_=r;const o=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&r.addUploadProgressListener(o),r.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&r.removeUploadProgressListener(o),this.pendingConnection_=null;const a=r.getErrorCode()===ed.NO_ERROR,l=r.getStatus();if(!a||mSe(l,this.additionalRetryCodes_)&&this.retry){const u=r.getErrorCode()===ed.ABORT;i(!1,new c2(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;i(!0,new c2(c,r))})},n=(i,s)=>{const r=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());dSe(l)?r(l):r()}catch(l){o(l)}else if(a!==null){const l=ZI();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(s.canceled){const l=this.appDelete_?bK():tSe();o(l)}else{const l=eSe();o(l)}};this.canceled_?n(!1,new c2(!1,null,!0)):this.backoffId_=cSe(t,n,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&uSe(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class c2{constructor(t,n,i){this.wasSuccessCode=t,this.connection=n,this.canceled=!!i}}function USe(e,t){t!==null&&t.length>0&&(e.Authorization="Firebase "+t)}function bSe(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}function ySe(e,t){t&&(e["X-Firebase-GMPID"]=t)}function ESe(e,t){t!==null&&(e["X-Firebase-AppCheck"]=t)}function vSe(e,t,n,i,s,r,o=!0){const a=gSe(e.urlParams),l=e.url+a,c=Object.assign({},e.headers);return ySe(c,t),USe(c,n),bSe(c,r),ESe(c,i),new pSe(l,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,s,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wSe(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function _Se(...e){const t=wSe();if(t!==void 0){const n=new t;for(let i=0;i<e.length;i++)n.append(e[i]);return n.getBlob()}else{if(qI())return new Blob(e);throw new Kn(Wn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function TSe(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ISe(e){if(typeof atob>"u")throw oSe("base-64");return atob(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bo={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Z3{constructor(t,n){this.data=t,this.contentType=n||null}}function SSe(e,t){switch(e){case Bo.RAW:return new Z3(EK(t));case Bo.BASE64:case Bo.BASE64URL:return new Z3(vK(e,t));case Bo.DATA_URL:return new Z3(CSe(t),ASe(t))}throw ZI()}function EK(e){const t=[];for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);if(i<=127)t.push(i);else if(i<=2047)t.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(n<e.length-1&&(e.charCodeAt(n+1)&64512)===56320))t.push(239,191,189);else{const r=i,o=e.charCodeAt(++n);i=65536|(r&1023)<<10|o&1023,t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?t.push(239,191,189):t.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(t)}function xSe(e){let t;try{t=decodeURIComponent(e)}catch{throw B0(Bo.DATA_URL,"Malformed data URL.")}return EK(t)}function vK(e,t){switch(e){case Bo.BASE64:{const s=t.indexOf("-")!==-1,r=t.indexOf("_")!==-1;if(s||r)throw B0(e,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Bo.BASE64URL:{const s=t.indexOf("+")!==-1,r=t.indexOf("/")!==-1;if(s||r)throw B0(e,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=ISe(t)}catch(s){throw s.message.includes("polyfill")?s:B0(e,"Invalid character found")}const i=new Uint8Array(n.length);for(let s=0;s<n.length;s++)i[s]=n.charCodeAt(s);return i}class wK{constructor(t){this.base64=!1,this.contentType=null;const n=t.match(/^data:([^,]+)?,/);if(n===null)throw B0(Bo.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=n[1]||null;i!=null&&(this.base64=MSe(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=t.substring(t.indexOf(",")+1)}}function CSe(e){const t=new wK(e);return t.base64?vK(Bo.BASE64,t.rest):xSe(t.rest)}function ASe(e){return new wK(e).contentType}function MSe(e,t){return e.length>=t.length?e.substring(e.length-t.length)===t:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tc{constructor(t,n){let i=0,s="";nN(t)?(this.data_=t,i=t.size,s=t.type):t instanceof ArrayBuffer?(n?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),i=this.data_.length):t instanceof Uint8Array&&(n?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),i=t.length),this.size_=i,this.type_=s}size(){return this.size_}type(){return this.type_}slice(t,n){if(nN(this.data_)){const i=this.data_,s=TSe(i,t,n);return s===null?null:new tc(s)}else{const i=new Uint8Array(this.data_.buffer,t,n-t);return new tc(i,!0)}}static getBlob(...t){if(qI()){const n=t.map(i=>i instanceof tc?i.data_:i);return new tc(_Se.apply(null,n))}else{const n=t.map(o=>yK(o)?SSe(Bo.RAW,o).data:o.data_);let i=0;n.forEach(o=>{i+=o.byteLength});const s=new Uint8Array(i);let r=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)s[r++]=o[a]}),new tc(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kSe(e){let t;try{t=JSON.parse(e)}catch{return null}return fSe(t)?t:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RSe(e){if(e.length===0)return null;const t=e.lastIndexOf("/");return t===-1?"":e.slice(0,t)}function DSe(e,t){const n=t.split("/").filter(i=>i.length>0).join("/");return e.length===0?n:e+"/"+n}function _K(e){const t=e.lastIndexOf("/",e.length-2);return t===-1?e:e.slice(t+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LSe(e,t){return t}class ns{constructor(t,n,i,s){this.server=t,this.local=n||t,this.writable=!!i,this.xform=s||LSe}}let u2=null;function NSe(e){return!yK(e)||e.length<2?e:_K(e)}function OSe(){if(u2)return u2;const e=[];e.push(new ns("bucket")),e.push(new ns("generation")),e.push(new ns("metageneration")),e.push(new ns("name","fullPath",!0));function t(r,o){return NSe(o)}const n=new ns("name");n.xform=t,e.push(n);function i(r,o){return o!==void 0?Number(o):o}const s=new ns("size");return s.xform=i,e.push(s),e.push(new ns("timeCreated")),e.push(new ns("updated")),e.push(new ns("md5Hash",null,!0)),e.push(new ns("cacheControl",null,!0)),e.push(new ns("contentDisposition",null,!0)),e.push(new ns("contentEncoding",null,!0)),e.push(new ns("contentLanguage",null,!0)),e.push(new ns("contentType",null,!0)),e.push(new ns("metadata","customMetadata",!0)),u2=e,u2}function PSe(e,t){function n(){const i=e.bucket,s=e.fullPath,r=new js(i,s);return t._makeStorageReference(r)}Object.defineProperty(e,"ref",{get:n})}function FSe(e,t,n){const i={};i.type="file";const s=n.length;for(let r=0;r<s;r++){const o=n[r];i[o.local]=o.xform(i,t[o.server])}return PSe(i,e),i}function BSe(e,t,n){const i=kSe(t);return i===null?null:FSe(e,i,n)}function zSe(e,t){const n={},i=t.length;for(let s=0;s<i;s++){const r=t[s];r.writable&&(n[r.server]=e[r.local])}return JSON.stringify(n)}class HSe{constructor(t,n,i,s){this.url=t,this.method=n,this.handler=i,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VSe(e){if(!e)throw ZI()}function $Se(e,t){function n(i,s){const r=BSe(e,s,t);return VSe(r!==null),r}return n}function GSe(e){function t(n,i){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=QIe():s=qIe():n.getStatus()===402?s=ZIe(e.bucket):n.getStatus()===403?s=JIe(e.path):s=i,s.status=n.getStatus(),s.serverResponse=i.serverResponse,s}return t}function XSe(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}function jSe(e,t,n){const i=Object.assign({},n);return i.fullPath=e.path,i.size=t.size(),i.contentType||(i.contentType=XSe(null,t)),i}function YSe(e,t,n,i,s){const r=t.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let w="";for(let v=0;v<2;v++)w=w+Math.random().toString().slice(2);return w}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const c=jSe(t,i,s),u=zSe(c,n),d="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,f=`\r
--`+l+"--",h=tc.getBlob(d,i,f);if(h===null)throw rSe();const m={name:c.fullPath},p=hSe(r,e.host,e._protocol),U="POST",b=e.maxUploadRetryTime,y=new HSe(p,U,$Se(e,n),b);return y.urlParams=m,y.headers=o,y.body=h.uploadData(),y.errorHandler=GSe(t),y}class WSe{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ed.NO_ERROR,this.sendPromise_=new Promise(t=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ed.ABORT,t()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ed.NETWORK_ERROR,t()}),this.xhr_.addEventListener("load",()=>{t()})})}send(t,n,i,s){if(this.sent_)throw _1("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,t,!0),s!==void 0)for(const r in s)s.hasOwnProperty(r)&&this.xhr_.setRequestHeader(r,s[r].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw _1("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw _1("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw _1("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw _1("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(t){return this.xhr_.getResponseHeader(t)}addUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",t)}removeUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",t)}}class KSe extends WSe{initXhr(){this.xhr_.responseType="text"}}function ZSe(){return new KSe}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cd{constructor(t,n){this._service=t,n instanceof js?this._location=n:this._location=js.makeFromUrl(n,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,n){return new Cd(t,n)}get root(){const t=new js(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return _K(this._location.path)}get storage(){return this._service}get parent(){const t=RSe(this._location.path);if(t===null)return null;const n=new js(this._location.bucket,t);return new Cd(this._service,n)}_throwIfRoot(t){if(this._location.path==="")throw aSe(t)}}function qSe(e,t,n){e._throwIfRoot("uploadBytes");const i=YSe(e.storage,e._location,OSe(),new tc(t,!0),n);return e.storage.makeRequestWithTokens(i,ZSe).then(s=>({metadata:s,ref:e}))}function QSe(e,t){const n=DSe(e._location.path,t),i=new js(e._location.bucket,n);return new Cd(e.storage,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JSe(e){return/^[A-Za-z]+:\/\//.test(e)}function exe(e,t){return new Cd(e,t)}function TK(e,t){if(e instanceof QI){const n=e;if(n._bucket==null)throw sSe();const i=new Cd(n,n._bucket);return t!=null?TK(i,t):i}else return t!==void 0?QSe(e,t):e}function txe(e,t){if(t&&JSe(t)){if(e instanceof QI)return exe(e,t);throw ow("To use ref(service, url), the first argument must be a Storage instance.")}else return TK(e,t)}function sN(e,t){const n=t==null?void 0:t[UK];return n==null?null:js.makeFromBucketSpec(n,e)}function nxe(e,t,n,i={}){e.host=`${t}:${n}`,e._protocol="http";const{mockUserToken:s}=i;s&&(e._overrideAuthToken=typeof s=="string"?s:BY(s,e.app.options.projectId))}class QI{constructor(t,n,i,s,r){this.app=t,this._authProvider=n,this._appCheckProvider=i,this._url=s,this._firebaseVersion=r,this._bucket=null,this._host=pK,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=WIe,this._maxUploadRetryTime=KIe,this._requests=new Set,s!=null?this._bucket=js.makeFromBucketSpec(s,this._host):this._bucket=sN(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=js.makeFromBucketSpec(this._url,t):this._bucket=sN(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){iN("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){iN("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const n=await t.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(XY(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new Cd(this,t)}_makeRequest(t,n,i,s,r=!0){if(this._deleted)return new lSe(bK());{const o=vSe(t,this._appId,i,s,n,this._firebaseVersion,r);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(t,n){const[i,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,n,i,s).getPromise()}}const rN="@firebase/storage",oN="0.13.6";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IK="storage";function SK(e,t,n){return e=fo(e),qSe(e,t,n)}function xK(e,t){return e=fo(e),txe(e,t)}function ixe(e=WY(),t){e=fo(e);const i=GY(e,IK).getImmediate({identifier:t}),s=PY("storage");return s&&sxe(i,...s),i}function sxe(e,t,n,i={}){nxe(e,t,n,i)}function rxe(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return new QI(n,i,s,t,jY)}function oxe(){Fm(new Jh(IK,rxe,"PUBLIC").setMultipleInstances(!0)),xc(rN,oN,""),xc(rN,oN,"esm2017")}oxe();let m5;try{m5=JSON.parse('{"apiKey":"AIzaSyAd15pYlMci_xIp9ko6wkEsDzAAA0Dn0RU","authDomain":"excalidraw-room-persistence.firebaseapp.com","databaseURL":"https://excalidraw-room-persistence.firebaseio.com","projectId":"excalidraw-room-persistence","storageBucket":"excalidraw-room-persistence.appspot.com","messagingSenderId":"654800341332","appId":"1:654800341332:web:4a692de832b55bd57ce0c1"}')}catch{console.warn('Error JSON parsing firebase config. Supplied value: {"apiKey":"AIzaSyAd15pYlMci_xIp9ko6wkEsDzAAA0Dn0RU","authDomain":"excalidraw-room-persistence.firebaseapp.com","databaseURL":"https://excalidraw-room-persistence.firebaseio.com","projectId":"excalidraw-room-persistence","storageBucket":"excalidraw-room-persistence.appspot.com","messagingSenderId":"654800341332","appId":"1:654800341332:web:4a692de832b55bd57ce0c1"}'),m5={}}let q3=null,Q3=null,J3=null;const CK=()=>(q3||(q3=YY(m5)),q3),AK=()=>(Q3||(Q3=CIe(CK())),Q3),axe=()=>(J3||(J3=ixe(CK())),J3),MK=async()=>axe(),lxe=async(e,t)=>{const n=JSON.stringify(t),i=new TextEncoder().encode(n),{encryptedBuffer:s,iv:r}=await My(e,i);return{ciphertext:s,iv:r}},aw=async(e,t)=>{const n=e.ciphertext.toUint8Array(),i=e.iv.toUint8Array(),s=await Cm(i,n,t),r=new TextDecoder("utf-8").decode(new Uint8Array(s));return JSON.parse(r)},Au=class Au{};F(Au,"cache",new WeakMap),F(Au,"get",t=>Au.cache.get(t)),F(Au,"set",(t,n)=>{Au.cache.set(t,Jl(n))});let Ym=Au;const kK=(e,t)=>{if(e.socket&&e.roomId&&e.roomKey){const n=Jl(t);return Ym.get(e.socket)===n}return!0},JI=async({prefix:e,files:t})=>{const n=await MK(),i=[],s=[];return await Promise.all(t.map(async({id:r,buffer:o})=>{try{const a=xK(n,`${e}/${r}`);await SK(a,o,{cacheControl:`public, max-age=${iwe}`}),s.push(r)}catch{i.push(r)}})),{savedFiles:s,erroredFiles:i}},aN=async(e,t)=>{const n=Jl(e),{ciphertext:i,iv:s}=await lxe(t,e);return{sceneVersion:n,ciphertext:Ul.fromUint8Array(new Uint8Array(i)),iv:Ul.fromUint8Array(s)}},cxe=async(e,t,n)=>{const{roomId:i,roomKey:s,socket:r}=e;if(!i||!s||!r||kK(e,t))return null;const o=AK(),a=rK(o,"scenes",i),l=await YIe(o,async u=>{const d=await u.get(a);if(!d.exists()){const U=await aN(t,s);return u.set(a,U),U}const f=d.data(),h=cc(_d(await aw(f,s),null)),m=cc(dI(t,h,n)),p=await aN(m,s);return u.update(a,p),p}),c=cc(_d(await aw(l,s),null));return Ym.set(r,c),c},uxe=async(e,t,n)=>{const i=AK(),s=rK(i,"scenes",e),r=await VIe(s);if(!r.exists())return null;const o=r.data(),a=cc(_d(await aw(o,t),null,{deleteInvisibleElements:!0}));return n&&Ym.set(n,a),a},RK=async(e,t,n)=>{const i=[],s=new Map;return await Promise.all([...new Set(n)].map(async r=>{try{const o=`https://firebasestorage.googleapis.com/v0/b/${m5.storageBucket}/o/${encodeURIComponent(e.replace(/^\//,""))}%2F${r}`,a=await fetch(`${o}?alt=media`);if(a.status<400){const l=await a.arrayBuffer(),{data:c,metadata:u}=await VG(new Uint8Array(l),{decryptionKey:t}),d=new TextDecoder().decode(c);i.push({mimeType:u.mimeType||_e.binary,id:r,dataURL:d,created:(u==null?void 0:u.created)||Date.now(),lastRetrieved:(u==null?void 0:u.created)||Date.now()})}else s.set(r,!0)}catch(o){s.set(r,!0),console.error(o)}})),{loadedFiles:i,erroredFiles:s}},DK=e=>e.isDeleted?e.updated>Date.now()-nwe:!qa(e),cc=e=>e.filter(t=>DK(t)),dxe="https://json.excalidraw.com/api/v2/",fxe="https://json.excalidraw.com/api/v2/post/",hxe=async()=>{const e=new Uint8Array(swe);return window.crypto.getRandomValues(e),CB(e)},LK=/^#room=([a-zA-Z0-9_-]+),([a-zA-Z0-9_-]+)$/,lN=e=>{const t=new URL(e).hash;return LK.test(t)},gxe=e=>{const n=new URL(e).hash.match(LK);return n&&n[2].length!==22?(window.alert(M("alerts.invalidEncryptionKey")),null):n?{roomId:n[1],roomKey:n[2]}:null},mxe=async()=>{const e=await hxe(),t=await _T();if(!t)throw new Error("Couldn't generate room key");return{roomId:e,roomKey:t}},pxe=e=>`${window.location.origin}${window.location.pathname}#room=${e.roomId},${e.roomKey}`,Uxe=async({buffer:e,decryptionKey:t})=>{let n;try{const r=e.slice(0,Y2),o=e.slice(Y2,e.byteLength);n=await Cm(new Uint8Array(r),o,t)}catch{const o=new Uint8Array(Y2);n=await Cm(o,e,t)}const i=new window.TextDecoder("utf-8").decode(new Uint8Array(n)),s=JSON.parse(i);return{elements:s.elements||null,appState:s.appState||null}},bxe=async(e,t)=>{try{const n=await fetch(`${dxe}${e}`);if(!n.ok)return window.alert(M("alerts.importBackendFailed")),{};const i=await n.arrayBuffer();try{const{data:s}=await VG(new Uint8Array(i),{decryptionKey:t}),r=JSON.parse(new TextDecoder().decode(s));return{elements:r.elements||null,appState:r.appState||null}}catch(s){return console.warn("error when decoding shareLink data using the new format:",s),Uxe({buffer:i,decryptionKey:t})}}catch(n){return window.alert(M("alerts.importBackendFailed")),console.error(n),{}}},cN=async(e,t,n)=>{let i;return e!=null&&t!=null?i=Td(await bxe(e,t),n==null?void 0:n.appState,n==null?void 0:n.elements,{repairBindings:!0,refreshDimensions:!1,deleteInvisibleElements:!0}):i=Td(n||null,null,null,{repairBindings:!0,deleteInvisibleElements:!0}),{elements:i.elements,appState:i.appState,files:i.files}},yxe=async(e,t,n)=>{const i=await _T("string"),s=await HG(new TextEncoder().encode(Ag(e,t,n,"database")),{encryptionKey:i});try{const r=new Map;for(const c of e)Dn(c)&&n[c.fileId]&&r.set(c.fileId,n[c.fileId]);const o=await hI({files:r,encryptionKey:i,maxBytes:fI}),l=await(await fetch(fxe,{method:"POST",body:s.buffer})).json();if(l.id){const c=new URL(window.location.href);c.hash=`json=${l.id},${i}`;const u=c.toString();return await JI({prefix:`/files/shareLinks/${l.id}`,files:o}),{url:u,errorMessage:null}}else if(l.error_class==="RequestTooLargeError")return{url:null,errorMessage:M("alerts.couldNotCreateShareableLinkTooBig")};return{url:null,errorMessage:M("alerts.couldNotCreateShareableLink")}}catch(r){return console.error(r),{url:null,errorMessage:M("alerts.couldNotCreateShareableLink")}}};function Exe(){var e=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!e||!indexedDB.databases)return Promise.resolve();var t;return new Promise(function(n){var i=function(){return indexedDB.databases().finally(n)};t=setInterval(i,100),i()}).finally(function(){return clearInterval(t)})}function Kd(e){return new Promise((t,n)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>n(e.error)})}function eS(e,t){const n=Exe().then(()=>{const i=indexedDB.open(e);return i.onupgradeneeded=()=>i.result.createObjectStore(t),Kd(i)});return(i,s)=>n.then(r=>s(r.transaction(t,i).objectStore(t)))}let e7;function Lg(){return e7||(e7=eS("keyval-store","keyval")),e7}function vxe(e,t=Lg()){return t("readonly",n=>Kd(n.get(e)))}function NK(e,t,n=Lg()){return n("readwrite",i=>(i.put(t,e),Kd(i.transaction)))}function wxe(e,t=Lg()){return t("readwrite",n=>(e.forEach(i=>n.put(i[1],i[0])),Kd(n.transaction)))}function _xe(e,t=Lg()){return t("readonly",n=>Promise.all(e.map(i=>Kd(n.get(i)))))}function Txe(e,t=Lg()){return t("readwrite",n=>(n.delete(e),Kd(n.transaction)))}function Ixe(e,t){return e("readonly",n=>(n.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},Kd(n.transaction)))}function Sxe(e=Lg()){const t=[];return Ixe(e,n=>t.push([n.key,n.value])).then(()=>t)}class xxe{constructor(){F(this,"locks",new Map);F(this,"lock",t=>{this.locks.set(t,!0)});F(this,"unlock",t=>(this.locks.delete(t),!this.isLocked()))}isLocked(t){return t?this.locks.has(t):!!this.locks.size}}const p5={[Sn.VERSION_DATA_STATE]:-1,[Sn.VERSION_FILES]:-1},uN=e=>JSON.parse(localStorage.getItem(e)||"-1")>p5[e],OK=e=>{const t=Date.now();try{localStorage.setItem(e,JSON.stringify(t)),p5[e]=t}catch(n){console.error("error while updating browser state verison",n)}},Cxe=()=>{try{for(const e of Object.keys(p5))localStorage.setItem(e,JSON.stringify(-1)),p5[e]=-1}catch(e){console.error("error while resetting browser state verison",e)}},z0=eS("files-db","files-store"),rb=Yt(!1);class Axe extends LY{constructor(){super(...arguments);F(this,"clearObsoleteFiles",async n=>{await Sxe(z0).then(i=>{for(const[s,r]of i)(!r.lastRetrieved||Date.now()-r.lastRetrieved>24*3600*1e3)&&!n.currentFileIds.includes(s)&&Txe(s,z0)})})}}const Mxe=(e,t)=>{var i;const n=Xr.get(rb);try{const s=G$(t);((i=s.openSidebar)==null?void 0:i.name)===Ir.name&&s.openSidebar.tab===Wu&&(s.openSidebar=null),localStorage.setItem(Sn.LOCAL_STORAGE_ELEMENTS,JSON.stringify(pH(e))),localStorage.setItem(Sn.LOCAL_STORAGE_APP_STATE,JSON.stringify(s)),OK(Sn.VERSION_DATA_STATE),n&&Xr.set(rb,!1)}catch(s){console.error(s),kxe(s)&&!n&&Xr.set(rb,!0)}},kxe=e=>e instanceof DOMException&&e.name==="QuotaExceededError",Ti=class Ti{};F(Ti,"_save",sl(async(t,n,i,s)=>{Mxe(t,n),await Ti.fileStorage.saveFiles({elements:t,files:i}),s()},Zve)),F(Ti,"save",(t,n,i,s)=>{Ti.isSavePaused()||Ti._save(t,n,i,s)}),F(Ti,"flushSave",()=>{Ti._save.flush()}),F(Ti,"locker",new xxe),F(Ti,"pauseSave",t=>{Ti.locker.lock(t)}),F(Ti,"resumeSave",t=>{Ti.locker.unlock(t)}),F(Ti,"isSavePaused",()=>document.hidden||Ti.locker.isLocked()),F(Ti,"fileStorage",new Axe({getFiles(t){return _xe(t,z0).then(async n=>{const i=[],s=new Map,r=[];n.forEach((o,a)=>{const l=t[a];if(o){const c={...o,lastRetrieved:Date.now()};r.push([l,c]),i.push(c)}else s.set(l,!0)});try{wxe(r,z0)}catch(o){console.warn(o)}return{loadedFiles:i,erroredFiles:s}})},async saveFiles({addedFiles:t}){const n=new Map,i=new Map;return OK(Sn.VERSION_FILES),await Promise.all([...t].map(async([s,r])=>{try{await NK(s,r,z0),n.set(s,r)}catch(o){console.error(o),i.set(s,r)}})),{savedFiles:n,erroredFiles:i}}}));let xi=Ti;const zr=class zr{static async load(){return await vxe(zr.key,zr.store)||null}static save(t){return NK(zr.key,t,zr.store)}};F(zr,"idb_name",Sn.IDB_LIBRARY),F(zr,"key","libraryData"),F(zr,"store",eS(`${zr.idb_name}-db`,`${zr.idb_name}-store`));let U5=zr;class Rxe{static load(){const t=localStorage.getItem(Sn.__LEGACY_LOCAL_STORAGE_LIBRARY);if(t!=null){const n=JSON.parse(t);if(n)return{libraryItems:n}}return null}static clear(){localStorage.removeItem(Sn.__LEGACY_LOCAL_STORAGE_LIBRARY)}}const lw=Yt({message:null,nonce:0}),PK=({collabError:e})=>{const[t,n]=D.useState(!1),i=D.useRef(0);return D.useEffect(()=>(n(!0),i.current=window.setTimeout(()=>{n(!1)},1e3),()=>{window.clearTimeout(i.current)}),[e.message,e.nonce]),e.message?g(hl,{label:e.message,long:!0,children:g("div",{className:re("collab-errors-button",{"collab-errors-button-shake":t}),children:mde})}):null};PK.displayName="CollabError";class Dxe{constructor(t){F(this,"collab");F(this,"socket",null);F(this,"socketInitialized",!1);F(this,"roomId",null);F(this,"roomKey",null);F(this,"broadcastedElementVersions",new Map);F(this,"queueFileUpload",Oo(async()=>{try{await this.collab.fileManager.saveFiles({elements:this.collab.excalidrawAPI.getSceneElementsIncludingDeleted(),files:this.collab.excalidrawAPI.getFiles()})}catch(i){i.name!=="AbortError"&&this.collab.excalidrawAPI.updateScene({appState:{errorMessage:i.message}})}let t=!1;const n=this.collab.excalidrawAPI.getSceneElementsIncludingDeleted().map(i=>this.collab.fileManager.shouldUpdateImageElementStatus(i)?(t=!0,Te(i,{status:"saved"})):i);t&&this.collab.excalidrawAPI.updateScene({elements:n,captureUpdate:K.NEVER})},Qve));F(this,"broadcastScene",async(t,n,i)=>{if(t===os.INIT&&!i)throw new Error("syncAll must be true when sending SCENE.INIT");const s=n.reduce((o,a)=>((i||!this.broadcastedElementVersions.has(a.id)||a.version>this.broadcastedElementVersions.get(a.id))&&DK(a)&&o.push(a),o),[]),r={type:t,payload:{elements:s}};for(const o of s)this.broadcastedElementVersions.set(o.id,o.version);this.queueFileUpload(),await this._broadcastSocketData(r)});F(this,"broadcastIdleChange",t=>{var n;if((n=this.socket)!=null&&n.id){const i={type:os.IDLE_STATUS,payload:{socketId:this.socket.id,userState:t,username:this.collab.state.username}};return this._broadcastSocketData(i,!0)}});F(this,"broadcastMouseLocation",t=>{var n;if((n=this.socket)!=null&&n.id){const i={type:os.MOUSE_LOCATION,payload:{socketId:this.socket.id,pointer:t.pointer,button:t.button||"up",selectedElementIds:this.collab.excalidrawAPI.getAppState().selectedElementIds,username:this.collab.state.username}};return this._broadcastSocketData(i,!0)}});F(this,"broadcastVisibleSceneBounds",(t,n)=>{var i;if((i=this.socket)!=null&&i.id){const s={type:os.USER_VISIBLE_SCENE_BOUNDS,payload:{socketId:this.socket.id,username:this.collab.state.username,sceneBounds:t.sceneBounds}};return this._broadcastSocketData(s,!0,n)}});F(this,"broadcastUserFollowed",t=>{var n;(n=this.socket)!=null&&n.id&&this.socket.emit(eb.USER_FOLLOW_CHANGE,t)});this.collab=t}open(t,n,i){return this.socket=t,this.roomId=n,this.roomKey=i,this.socket.on("init-room",()=>{this.socket&&(this.socket.emit("join-room",this.roomId),Qe("share","room joined"))}),this.socket.on("new-user",async s=>{this.broadcastScene(os.INIT,this.collab.getSceneElementsIncludingDeleted(),!0)}),this.socket.on("room-user-change",s=>{this.collab.setCollaborators(s)}),t}close(){this.socket&&(this.queueFileUpload.flush(),this.socket.close(),this.socket=null,this.roomId=null,this.roomKey=null,this.socketInitialized=!1,this.broadcastedElementVersions=new Map)}isOpen(){return!!(this.socketInitialized&&this.socket&&this.roomId&&this.roomKey)}async _broadcastSocketData(t,n=!1,i){var s;if(this.isOpen()){const r=JSON.stringify(t),o=new TextEncoder().encode(r),{encryptedBuffer:a,iv:l}=await My(this.roomKey,o);(s=this.socket)==null||s.emit(n?eb.SERVER_VOLATILE:eb.SERVER,i??this.roomId,a,l)}}}var Lxe={};const FK=Yt(null),cw=Yt(!1),BK=Yt(!1),zK=Yt(null);class Nxe extends D.PureComponent{constructor(n){super(n);F(this,"portal");F(this,"fileManager");F(this,"excalidrawAPI");F(this,"activeIntervalId");F(this,"idleTimeoutId");F(this,"socketInitializationTimer");F(this,"lastBroadcastedOrReceivedSceneVersion",-1);F(this,"collaborators",new Map);F(this,"onUmmount",null);F(this,"onOfflineStatusToggle",()=>{Xr.set(BK,!window.navigator.onLine)});F(this,"isCollaborating",()=>Xr.get(cw));F(this,"setIsCollaborating",n=>{Xr.set(cw,n)});F(this,"onUnload",()=>{this.destroySocketClient({isUnload:!0})});F(this,"beforeUnload",on(n=>{const i=cc(this.getSceneElementsIncludingDeleted());this.isCollaborating()&&(this.fileManager.shouldPreventUnload(i)||!kK(this.portal,i))&&(this.saveCollabRoomToFirebase(i),Lxe.VITE_APP_DISABLE_PREVENT_UNLOAD!=="true"?P9(n):console.warn("preventing unload disabled (VITE_APP_DISABLE_PREVENT_UNLOAD)"))}));F(this,"saveCollabRoomToFirebase",async n=>{try{const i=await cxe(this.portal,n,this.excalidrawAPI.getAppState());this.resetErrorIndicator(),this.isCollaborating()&&i&&this.handleRemoteSceneUpdate(this._reconcileElements(i))}catch(i){const s=/is longer than.*?bytes/.test(i.message)?M("errors.collabSaveFailed_sizeExceeded"):M("errors.collabSaveFailed");(!this.state.dialogNotifiedErrors[s]||!this.isCollaborating())&&(this.setErrorDialog(s),this.setState({dialogNotifiedErrors:{...this.state.dialogNotifiedErrors,[s]:!0}})),this.isCollaborating()&&this.setErrorIndicator(s),console.error(i)}});F(this,"stopCollaboration",(n=!0)=>{if(this.queueBroadcastAllElements.cancel(),this.queueSaveToFirebase.cancel(),this.loadImageFiles.cancel(),this.resetErrorIndicator(!0),this.saveCollabRoomToFirebase(cc(this.excalidrawAPI.getSceneElementsIncludingDeleted())),this.portal.socket&&this.fallbackInitializationHandler&&this.portal.socket.off("connect_error",this.fallbackInitializationHandler),!n)xi.fileStorage.reset(),this.destroySocketClient();else if(window.confirm(M("alerts.collabStopOverridePrompt"))){Cxe(),window.history.pushState({},bc,window.location.origin),this.destroySocketClient(),xi.fileStorage.reset();const i=this.excalidrawAPI.getSceneElementsIncludingDeleted().map(s=>yt(s)&&s.status==="saved"?Te(s,{status:"pending"}):s);this.excalidrawAPI.updateScene({elements:i,captureUpdate:K.NEVER})}});F(this,"destroySocketClient",n=>{this.lastBroadcastedOrReceivedSceneVersion=-1,this.portal.close(),this.fileManager.reset(),n!=null&&n.isUnload||(this.setIsCollaborating(!1),this.setActiveRoomLink(null),this.collaborators=new Map,this.excalidrawAPI.updateScene({collaborators:this.collaborators}),xi.resumeSave("collaboration"))});F(this,"fetchImageFilesFromFirebase",async n=>{const i=n.elements.filter(s=>Dn(s)&&!this.fileManager.isFileTracked(s.fileId)&&!s.isDeleted&&(n.forceFetchFiles?s.status!=="pending"||Date.now()-s.updated>1e4:s.status==="saved")).map(s=>s.fileId);return await this.fileManager.getFiles(i)});F(this,"decryptPayload",async(n,i,s)=>{try{const r=await Cm(n,i,s),o=new TextDecoder("utf-8").decode(new Uint8Array(r));return JSON.parse(o)}catch(r){return window.alert(M("alerts.decryptFailed")),console.error(r),{type:os.INVALID_RESPONSE}}});F(this,"fallbackInitializationHandler",null);F(this,"startCollaboration",async n=>{if(this.state.username||ye(()=>import("./random-username.esm-__vdrxyo.js"),__vite__mapDeps([])).then(({getRandomUsername:l})=>{const c=l();this.setUsername(c)}),this.portal.socket)return null;let i,s;n?{roomId:i,roomKey:s}=n:({roomId:i,roomKey:s}=await mxe(),window.history.pushState({},bc,pxe({roomId:i,roomKey:s})));const r=j5();this.setIsCollaborating(!0),xi.pauseSave("collaboration");const{default:o}=await ye(()=>import("./index-ChGp7972.js"),__vite__mapDeps([])),a=()=>{this.initializeRoom({roomLinkData:n,fetchScene:!0}).then(l=>{r.resolve(l)})};this.fallbackInitializationHandler=a;try{this.portal.socket=this.portal.open(o("https://oss-collab.excalidraw.com",{transports:["websocket","polling"]}),i,s),this.portal.socket.once("connect_error",a)}catch(l){return console.error(l),this.setErrorDialog(l.message),null}if(n)this.excalidrawAPI.resetScene();else{const l=this.excalidrawAPI.getSceneElements().map(c=>yt(c)&&c.status==="saved"?Te(c,{status:"pending"}):c);this.excalidrawAPI.updateScene({elements:l,captureUpdate:K.NEVER}),this.saveCollabRoomToFirebase(cc(l))}return this.socketInitializationTimer=window.setTimeout(a,qve),this.portal.socket.on("client-broadcast",async(l,c)=>{var d;if(!this.portal.roomKey)return;const u=await this.decryptPayload(c,l,this.portal.roomKey);switch(u.type){case os.INVALID_RESPONSE:return;case os.INIT:{if(!this.portal.socketInitialized){this.initializeRoom({fetchScene:!1});const f=u.payload.elements,h=this._reconcileElements(f);this.handleRemoteSceneUpdate(h),r.resolve({elements:h,scrollToContent:!0})}break}case os.UPDATE:this.handleRemoteSceneUpdate(this._reconcileElements(u.payload.elements));break;case os.MOUSE_LOCATION:{const{pointer:f,button:h,username:m,selectedElementIds:p}=u.payload,U=u.payload.socketId||u.payload.socketID;this.updateCollaborator(U,{pointer:f,button:h,selectedElementIds:p,username:m});break}case os.USER_VISIBLE_SCENE_BOUNDS:{const{sceneBounds:f,socketId:h}=u.payload,m=this.excalidrawAPI.getAppState();if(((d=m.userToFollow)==null?void 0:d.socketId)!==h){console.warn(`receiving remote client's (from ${h}) viewport bounds even though we're not subscribed to it!`);return}if(m.userToFollow&&m.followedBy.has(m.userToFollow.socketId))return;this.excalidrawAPI.updateScene({appState:Z$({appState:m,bounds:f,fitToViewport:!0,viewportZoomFactor:1}).appState});break}case os.IDLE_STATUS:{const{userState:f,socketId:h,username:m}=u.payload;this.updateCollaborator(h,{userState:f,username:m});break}default:Ko(u,null)}}),this.portal.socket.on("first-in-room",async()=>{this.portal.socket&&this.portal.socket.off("first-in-room");const l=await this.initializeRoom({fetchScene:!0,roomLinkData:n});r.resolve(l)}),this.portal.socket.on(eb.USER_FOLLOW_ROOM_CHANGE,l=>{this.excalidrawAPI.updateScene({appState:{followedBy:new Set(l)}}),this.relayVisibleSceneBounds({force:!0})}),this.initializeIdleDetector(),this.setActiveRoomLink(window.location.href),r});F(this,"initializeRoom",async({fetchScene:n,roomLinkData:i})=>{if(clearTimeout(this.socketInitializationTimer),this.portal.socket&&this.fallbackInitializationHandler&&this.portal.socket.off("connect_error",this.fallbackInitializationHandler),n&&i&&this.portal.socket){this.excalidrawAPI.resetScene();try{const s=await uxe(i.roomId,i.roomKey,this.portal.socket);if(s)return this.setLastBroadcastedOrReceivedSceneVersion(Jl(s)),{elements:s,scrollToContent:!0}}catch(s){console.error(s)}finally{this.portal.socketInitialized=!0}}else this.portal.socketInitialized=!0;return null});F(this,"_reconcileElements",n=>{const i=this.getSceneElementsIncludingDeleted(),s=this.excalidrawAPI.getAppState(),r=_d(n,null),o=dI(i,r,s);return this.setLastBroadcastedOrReceivedSceneVersion(Jl(o)),o});F(this,"loadImageFiles",Oo(async()=>{const{loadedFiles:n,erroredFiles:i}=await this.fetchImageFilesFromFirebase({elements:this.excalidrawAPI.getSceneElementsIncludingDeleted()});this.excalidrawAPI.addFiles(n),j1({excalidrawAPI:this.excalidrawAPI,erroredFiles:i,elements:this.excalidrawAPI.getSceneElementsIncludingDeleted()})},Jve));F(this,"handleRemoteSceneUpdate",n=>{this.excalidrawAPI.updateScene({elements:n,captureUpdate:K.NEVER}),this.loadImageFiles()});F(this,"onPointerMove",()=>{this.idleTimeoutId&&(window.clearTimeout(this.idleTimeoutId),this.idleTimeoutId=null),this.idleTimeoutId=window.setTimeout(this.reportIdle,uA),this.activeIntervalId||(this.activeIntervalId=window.setInterval(this.reportActive,dA))});F(this,"onVisibilityChange",()=>{document.hidden?(this.idleTimeoutId&&(window.clearTimeout(this.idleTimeoutId),this.idleTimeoutId=null),this.activeIntervalId&&(window.clearInterval(this.activeIntervalId),this.activeIntervalId=null),this.onIdleStateChange(Ru.AWAY)):(this.idleTimeoutId=window.setTimeout(this.reportIdle,uA),this.activeIntervalId=window.setInterval(this.reportActive,dA),this.onIdleStateChange(Ru.ACTIVE))});F(this,"reportIdle",()=>{this.onIdleStateChange(Ru.IDLE),this.activeIntervalId&&(window.clearInterval(this.activeIntervalId),this.activeIntervalId=null)});F(this,"reportActive",()=>{this.onIdleStateChange(Ru.ACTIVE)});F(this,"initializeIdleDetector",()=>{document.addEventListener(te.POINTER_MOVE,this.onPointerMove),document.addEventListener(te.VISIBILITY_CHANGE,this.onVisibilityChange)});F(this,"updateCollaborator",(n,i)=>{var o;const s=new Map(this.collaborators),r=Object.assign({},s.get(n),i,{isCurrentUser:n===((o=this.portal.socket)==null?void 0:o.id)});s.set(n,r),this.collaborators=s,this.excalidrawAPI.updateScene({collaborators:s})});F(this,"setLastBroadcastedOrReceivedSceneVersion",n=>{this.lastBroadcastedOrReceivedSceneVersion=n});F(this,"getLastBroadcastedOrReceivedSceneVersion",()=>this.lastBroadcastedOrReceivedSceneVersion);F(this,"getSceneElementsIncludingDeleted",()=>this.excalidrawAPI.getSceneElementsIncludingDeleted());F(this,"onPointerUpdate",Oo(n=>{n.pointersMap.size<2&&this.portal.socket&&this.portal.broadcastMouseLocation(n)},twe));F(this,"relayVisibleSceneBounds",n=>{const i=this.excalidrawAPI.getAppState();this.portal.socket&&(i.followedBy.size>0||n!=null&&n.force)&&this.portal.broadcastVisibleSceneBounds({sceneBounds:zz(i)},`follow@${this.portal.socket.id}`)});F(this,"onIdleStateChange",n=>{this.portal.broadcastIdleChange(n)});F(this,"broadcastElements",n=>{Jl(n)>this.getLastBroadcastedOrReceivedSceneVersion()&&(this.portal.broadcastScene(os.UPDATE,n,!1),this.lastBroadcastedOrReceivedSceneVersion=Jl(n),this.queueBroadcastAllElements())});F(this,"syncElements",n=>{this.broadcastElements(n),this.queueSaveToFirebase()});F(this,"queueBroadcastAllElements",Oo(()=>{this.portal.broadcastScene(os.UPDATE,this.excalidrawAPI.getSceneElementsIncludingDeleted(),!0);const n=this.getLastBroadcastedOrReceivedSceneVersion(),i=Math.max(n,Jl(this.getSceneElementsIncludingDeleted()));this.setLastBroadcastedOrReceivedSceneVersion(i)},WD));F(this,"queueSaveToFirebase",Oo(()=>{this.portal.socketInitialized&&this.saveCollabRoomToFirebase(cc(this.excalidrawAPI.getSceneElementsIncludingDeleted()))},WD,{leading:!1}));F(this,"setUsername",n=>{this.setState({username:n}),owe(n)});F(this,"getUsername",()=>this.state.username);F(this,"setActiveRoomLink",n=>{this.setState({activeRoomLink:n}),Xr.set(zK,n)});F(this,"getActiveRoomLink",()=>this.state.activeRoomLink);F(this,"setErrorIndicator",n=>{Xr.set(lw,{message:n,nonce:Date.now()})});F(this,"resetErrorIndicator",(n=!1)=>{Xr.set(lw,{message:null,nonce:0}),n&&this.setState({dialogNotifiedErrors:{}})});F(this,"setErrorDialog",n=>{this.setState({errorMessage:n})});this.state={errorMessage:null,dialogNotifiedErrors:{},username:kY()||"",activeRoomLink:null},this.portal=new Dxe(this),this.fileManager=new LY({getFiles:async i=>{const{roomId:s,roomKey:r}=this.portal;if(!s||!r)throw new Gh;return RK(`files/rooms/${s}`,r,i)},saveFiles:async({addedFiles:i})=>{const{roomId:s,roomKey:r}=this.portal;if(!s||!r)throw new Gh;const{savedFiles:o,erroredFiles:a}=await JI({prefix:`${MY.collabFiles}/${s}`,files:await hI({files:i,encryptionKey:r,maxBytes:fI})});return{savedFiles:o.reduce((l,c)=>{const u=i.get(c);return u&&l.set(c,u),l},new Map),erroredFiles:a.reduce((l,c)=>{const u=i.get(c);return u&&l.set(c,u),l},new Map)}}}),this.excalidrawAPI=n.excalidrawAPI,this.activeIntervalId=null,this.idleTimeoutId=null}componentDidMount(){window.addEventListener(te.BEFORE_UNLOAD,this.beforeUnload),window.addEventListener("online",this.onOfflineStatusToggle),window.addEventListener("offline",this.onOfflineStatusToggle),window.addEventListener(te.UNLOAD,this.onUnload);const n=this.excalidrawAPI.onUserFollow(o=>{this.portal.socket&&this.portal.broadcastUserFollowed(o)}),i=Ug(this.relayVisibleSceneBounds),s=this.excalidrawAPI.onScrollChange(()=>i());this.onUmmount=()=>{n(),s()},this.onOfflineStatusToggle();const r={isCollaborating:this.isCollaborating,onPointerUpdate:this.onPointerUpdate,startCollaboration:this.startCollaboration,syncElements:this.syncElements,fetchImageFilesFromFirebase:this.fetchImageFilesFromFirebase,stopCollaboration:this.stopCollaboration,setUsername:this.setUsername,getUsername:this.getUsername,getActiveRoomLink:this.getActiveRoomLink,setCollabError:this.setErrorDialog};Xr.set(FK,r)}componentWillUnmount(){var n;window.removeEventListener("online",this.onOfflineStatusToggle),window.removeEventListener("offline",this.onOfflineStatusToggle),window.removeEventListener(te.BEFORE_UNLOAD,this.beforeUnload),window.removeEventListener(te.UNLOAD,this.onUnload),window.removeEventListener(te.POINTER_MOVE,this.onPointerMove),window.removeEventListener(te.VISIBILITY_CHANGE,this.onVisibilityChange),this.activeIntervalId&&(window.clearInterval(this.activeIntervalId),this.activeIntervalId=null),this.idleTimeoutId&&(window.clearTimeout(this.idleTimeoutId),this.idleTimeoutId=null),(n=this.onUmmount)==null||n.call(this)}setCollaborators(n){var s;const i=new Map;for(const r of n)i.set(r,Object.assign({},this.collaborators.get(r),{isCurrentUser:r===((s=this.portal.socket)==null?void 0:s.id)}));this.collaborators=i,this.excalidrawAPI.updateScene({collaborators:i})}render(){const{errorMessage:n}=this.state;return g(fe,{children:n!=null&&g(YT,{onClose:()=>this.setErrorDialog(null),children:n})})}}const Oxe=(e,t,n,i)=>{e.save(),e.strokeStyle=i,e.beginPath(),e.moveTo(n[0][0]*t,n[0][1]*t),e.lineTo(n[1][0]*t,n[1][1]*t),e.stroke(),e.restore()},Pxe=(e,t,[n,i,s,r],o)=>{e.save(),e.strokeStyle=o,e.beginPath(),e.moveTo(n[0]*t,n[1]*t),e.bezierCurveTo(i[0]*t,i[1]*t,s[0]*t,s[1]*t,r[0]*t,r[1]*t),e.stroke(),e.restore()},Fxe=(e,t)=>{e.strokeStyle="#888",e.save(),e.beginPath(),e.moveTo(-10*t,-10*t),e.lineTo(10*t,10*t),e.moveTo(10*t,-10*t),e.lineTo(-10*t,10*t),e.stroke(),e.save()},dN=(e,t,n)=>{e.forEach(i=>{switch(!0){case ure(i.data):Oxe(t,n.zoom.value,i.data,i.color);break;case ire(i.data):Pxe(t,n.zoom.value,i.data,i.color);break;default:throw new Error(`Unknown element type ${JSON.stringify(i)}`)}})},Bxe=(e,t,n,i)=>{var a,l,c,u;const[s,r]=Ry(e,n),o=Dy({canvas:e,scale:n,normalizedWidth:s,normalizedHeight:r,viewBackgroundColor:"transparent"});if(o.save(),o.translate(t.scrollX*t.zoom.value,t.scrollY*t.zoom.value),Fxe(o,t.zoom.value),(a=window.visualDebug)!=null&&a.currentFrame&&((l=window.visualDebug)!=null&&l.data)&&window.visualDebug.data.length>0){const[d]=zxe();dN(window.visualDebug.data[d],o,t)}else(c=window.visualDebug)==null||c.data.forEach(d=>{dN(d,o,t)});window.visualDebug&&(window.visualDebug.data=((u=window.visualDebug)==null?void 0:u.data.map(d=>d.filter(f=>f.permanent)))??[])},zxe=()=>{var n,i,s;const e=((n=window.visualDebug)==null?void 0:n.currentFrame)??0,t=((i=window.visualDebug)==null?void 0:i.data.length)??0;return t>0?[e%t,((s=window.visualDebug)==null?void 0:s.currentFrame)??0]:[0,0]},Hxe=Ug((e,t,n,i)=>{Bxe(e,t,n)},{trailing:!0}),HK=()=>{var e;return Array.isArray((e=window.visualDebug)==null?void 0:e.data)},Vxe=({onChange:e})=>{const t=D.useCallback(()=>{var r,o;(!((r=window.visualDebug)!=null&&r.currentFrame)||isNaN(((o=window.visualDebug)==null?void 0:o.currentFrame)??-1))&&(window.visualDebug.currentFrame=0),window.visualDebug.currentFrame+=1,e()},[e]),n=D.useCallback(()=>{var r,o,a;(!((r=window.visualDebug)!=null&&r.currentFrame)||isNaN(((o=window.visualDebug)==null?void 0:o.currentFrame)??-1)||((a=window.visualDebug)==null?void 0:a.currentFrame)<1)&&(window.visualDebug.currentFrame=1),window.visualDebug.currentFrame-=1,e()},[e]),i=D.useCallback(()=>{window.visualDebug.currentFrame=void 0,e()},[e]),s=D.useCallback(()=>{window.visualDebug&&(window.visualDebug.currentFrame=void 0,window.visualDebug.data=[]),e()},[e]);return N(fe,{children:[g("button",{className:"ToolIcon_type_button","data-testid":"debug-forward","aria-label":"Move forward",type:"button",onClick:s,children:g("div",{className:"ToolIcon__icon","aria-hidden":"true","aria-disabled":"false",children:Hc})}),g("button",{className:"ToolIcon_type_button","data-testid":"debug-forward","aria-label":"Move forward",type:"button",onClick:n,children:g("div",{className:"ToolIcon__icon","aria-hidden":"true","aria-disabled":"false",children:g(J4,{flip:!0})})}),g("button",{className:"ToolIcon_type_button","data-testid":"debug-forward","aria-label":"Move forward",type:"button",onClick:i,children:g("div",{className:"ToolIcon__icon","aria-hidden":"true","aria-disabled":"false",children:Vd})}),g("button",{className:"ToolIcon_type_button","data-testid":"debug-backward","aria-label":"Move backward",type:"button",onClick:t,children:g("div",{className:"ToolIcon__icon","aria-hidden":"true","aria-disabled":"false",children:g(J4,{})})})]})},$xe=ae.forwardRef(({appState:e,scale:t},n)=>{const{width:i,height:s}=e;return g("canvas",{style:{width:i,height:s,position:"absolute",zIndex:2,pointerEvents:"none"},width:i*t,height:s*t,ref:n,children:"Debug Canvas"})}),Gxe=()=>{const{t:e}=dn();return g("a",{className:"encrypted-icon tooltip",href:"https://plus.excalidraw.com/blog/end-to-end-encryption",target:"_blank",rel:"noopener","aria-label":e("encrypted.link"),children:g(hl,{label:e("encrypted.tooltip"),long:!0,children:vde})})},Xxe=()=>Sd?g("a",{href:"https://app.excalidraw.com?utm_source=excalidraw&utm_medium=app&utm_content=signedInUserRedirectButton#excalidraw-redirect",target:"_blank",rel:"noopener",className:"plus-button",children:"Go to Excalidraw+"}):null,jxe=ae.memo(({onChange:e})=>g(wY,{children:N("div",{style:{display:"flex",gap:".5rem",alignItems:"center"},children:[HK()&&g(Vxe,{onChange:e}),Sd?g(Xxe,{}):g(Gxe,{})]})}));function Yxe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wm(e){"@babel/helpers - typeof";return Wm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wm(e)}function Wxe(e,t){if(Wm(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Wm(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function Kxe(e){var t=Wxe(e,"string");return Wm(t)=="symbol"?t:t+""}function Zxe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Kxe(i.key),i)}}function qxe(e,t,n){return t&&Zxe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}var VK=[],Qxe=VK.forEach,Jxe=VK.slice;function eCe(e){return Qxe.call(Jxe.call(arguments,1),function(t){if(t)for(var n in t)e[n]===void 0&&(e[n]=t[n])}),e}var fN=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,tCe=function(t,n,i){var s=i||{};s.path=s.path||"/";var r=encodeURIComponent(n),o=t+"="+r;if(s.maxAge>0){var a=s.maxAge-0;if(isNaN(a))throw new Error("maxAge should be a Number");o+="; Max-Age="+Math.floor(a)}if(s.domain){if(!fN.test(s.domain))throw new TypeError("option domain is invalid");o+="; Domain="+s.domain}if(s.path){if(!fN.test(s.path))throw new TypeError("option path is invalid");o+="; Path="+s.path}if(s.expires){if(typeof s.expires.toUTCString!="function")throw new TypeError("option expires is invalid");o+="; Expires="+s.expires.toUTCString()}if(s.httpOnly&&(o+="; HttpOnly"),s.secure&&(o+="; Secure"),s.sameSite){var l=typeof s.sameSite=="string"?s.sameSite.toLowerCase():s.sameSite;switch(l){case!0:o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"strict":o+="; SameSite=Strict";break;case"none":o+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return o},hN={create:function(t,n,i,s){var r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};i&&(r.expires=new Date,r.expires.setTime(r.expires.getTime()+i*60*1e3)),s&&(r.domain=s),document.cookie=tCe(t,encodeURIComponent(n),r)},read:function(t){for(var n=t+"=",i=document.cookie.split(";"),s=0;s<i.length;s++){for(var r=i[s];r.charAt(0)===" ";)r=r.substring(1,r.length);if(r.indexOf(n)===0)return r.substring(n.length,r.length)}return null},remove:function(t){this.create(t,"",-1)}},nCe={name:"cookie",lookup:function(t){var n;if(t.lookupCookie&&typeof document<"u"){var i=hN.read(t.lookupCookie);i&&(n=i)}return n},cacheUserLanguage:function(t,n){n.lookupCookie&&typeof document<"u"&&hN.create(n.lookupCookie,t,n.cookieMinutes,n.cookieDomain,n.cookieOptions)}},iCe={name:"querystring",lookup:function(t){var n;if(typeof window<"u"){var i=window.location.search;!window.location.search&&window.location.hash&&window.location.hash.indexOf("?")>-1&&(i=window.location.hash.substring(window.location.hash.indexOf("?")));for(var s=i.substring(1),r=s.split("&"),o=0;o<r.length;o++){var a=r[o].indexOf("=");if(a>0){var l=r[o].substring(0,a);l===t.lookupQuerystring&&(n=r[o].substring(a+1))}}}return n}},T1=null,gN=function(){if(T1!==null)return T1;try{T1=window!=="undefined"&&window.localStorage!==null;var t="i18next.translate.boo";window.localStorage.setItem(t,"foo"),window.localStorage.removeItem(t)}catch{T1=!1}return T1},sCe={name:"localStorage",lookup:function(t){var n;if(t.lookupLocalStorage&&gN()){var i=window.localStorage.getItem(t.lookupLocalStorage);i&&(n=i)}return n},cacheUserLanguage:function(t,n){n.lookupLocalStorage&&gN()&&window.localStorage.setItem(n.lookupLocalStorage,t)}},I1=null,mN=function(){if(I1!==null)return I1;try{I1=window!=="undefined"&&window.sessionStorage!==null;var t="i18next.translate.boo";window.sessionStorage.setItem(t,"foo"),window.sessionStorage.removeItem(t)}catch{I1=!1}return I1},rCe={name:"sessionStorage",lookup:function(t){var n;if(t.lookupSessionStorage&&mN()){var i=window.sessionStorage.getItem(t.lookupSessionStorage);i&&(n=i)}return n},cacheUserLanguage:function(t,n){n.lookupSessionStorage&&mN()&&window.sessionStorage.setItem(n.lookupSessionStorage,t)}},oCe={name:"navigator",lookup:function(t){var n=[];if(typeof navigator<"u"){if(navigator.languages)for(var i=0;i<navigator.languages.length;i++)n.push(navigator.languages[i]);navigator.userLanguage&&n.push(navigator.userLanguage),navigator.language&&n.push(navigator.language)}return n.length>0?n:void 0}},aCe={name:"htmlTag",lookup:function(t){var n,i=t.htmlTag||(typeof document<"u"?document.documentElement:null);return i&&typeof i.getAttribute=="function"&&(n=i.getAttribute("lang")),n}},lCe={name:"path",lookup:function(t){var n;if(typeof window<"u"){var i=window.location.pathname.match(/\/([a-zA-Z-]*)/g);if(i instanceof Array)if(typeof t.lookupFromPathIndex=="number"){if(typeof i[t.lookupFromPathIndex]!="string")return;n=i[t.lookupFromPathIndex].replace("/","")}else n=i[0].replace("/","")}return n}},cCe={name:"subdomain",lookup:function(t){var n;if(typeof window<"u"){var i=window.location.href.match(/(?:http[s]*\:\/\/)*(.*?)\.(?=[^\/]*\..{2,5})/gi);i instanceof Array&&(typeof t.lookupFromSubdomainIndex=="number"?n=i[t.lookupFromSubdomainIndex].replace("http://","").replace("https://","").replace(".",""):n=i[0].replace("http://","").replace("https://","").replace(".",""))}return n}};function uCe(){return{order:["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"],lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"]}}var $K=function(){function e(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Yxe(this,e),this.type="languageDetector",this.detectors={},this.init(t,n)}return qxe(e,[{key:"init",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=n,this.options=eCe(i,this.options||{},uCe()),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=s,this.addDetector(nCe),this.addDetector(iCe),this.addDetector(sCe),this.addDetector(rCe),this.addDetector(oCe),this.addDetector(aCe),this.addDetector(lCe),this.addDetector(cCe)}},{key:"addDetector",value:function(n){this.detectors[n.name]=n}},{key:"detect",value:function(n){var i=this;n||(n=this.options.order);var s=[];return n.forEach(function(r){if(i.detectors[r]){var o=i.detectors[r].lookup(i.options);o&&typeof o=="string"&&(o=[o]),o&&(s=s.concat(o))}}),this.services.languageUtils.getBestMatchFromCodes?s:s.length>0?s[0]:null}},{key:"cacheUserLanguage",value:function(n,i){var s=this;i||(i=this.options.caches),i&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(n)>-1||i.forEach(function(r){s.detectors[r]&&s.detectors[r].cacheUserLanguage(n,s.options)}))}}]),e}();$K.type="languageDetector";const tS=new $K;tS.init({languageUtils:{}});const GK=()=>{var i;const e=tS.detect(),t=Array.isArray(e)?e[0]:e;return(t?(i=oy.find(s=>s.code.startsWith(t)))==null?void 0:i.code:null)||Hd.code},XK=Yt(GK()),dCe=()=>{const[e,t]=$h(XK);return D.useEffect(()=>{tS.cacheUserLanguage(e)},[e]),[e,t]},fCe=({style:e})=>{const{t,langCode:n}=dn(),i=M_(XK);return g("select",{className:"dropdown-select dropdown-select__language",onChange:({target:s})=>i(s.value),value:n,"aria-label":t("buttons.selectLanguage"),style:e,children:oy.map(s=>g("option",{value:s.code,children:s.label},s.code))})},hCe=ae.memo(e=>N(Tt,{children:[g(Tt.DefaultItems.LoadScene,{}),g(Tt.DefaultItems.SaveToActiveFile,{}),g(Tt.DefaultItems.Export,{}),g(Tt.DefaultItems.SaveAsImage,{}),e.isCollabEnabled&&g(Tt.DefaultItems.LiveCollaborationTrigger,{isCollaborating:e.isCollaborating,onSelect:()=>e.onCollabDialogOpen()}),g(Tt.DefaultItems.CommandPalette,{className:"highlighted"}),g(Tt.DefaultItems.SearchMenu,{}),g(Tt.DefaultItems.Help,{}),g(Tt.DefaultItems.ClearCanvas,{}),g(Tt.Separator,{}),g(Tt.ItemLink,{icon:W4,href:"https://plus.excalidraw.com/plus?utm_source=excalidraw&utm_medium=app&utm_content=hamburger",className:"",children:"Excalidraw+"}),g(Tt.DefaultItems.Socials,{}),g(Tt.ItemLink,{icon:CV,href:`https://app.excalidraw.com${Sd?"":"/sign-up"}?utm_source=signin&utm_medium=app&utm_content=hamburger`,className:"highlighted",children:Sd?"Sign in":"Sign up"}),F9(),g(Tt.Separator,{}),g(Tt.DefaultItems.ToggleTheme,{allowSystemTheme:!0,theme:e.theme,onSelect:e.setTheme}),g(Tt.ItemCustom,{children:g(fCe,{style:{width:"100%"}})}),g(Tt.DefaultItems.ChangeCanvasBackground,{})]})),gCe=ae.memo(e=>{const{t}=dn();let n;return Sd?n=t("welcomeScreen.app.center_heading_plus").split(/(Excalidraw\+)/).map((i,s)=>i==="Excalidraw+"?g("a",{style:{pointerEvents:Eu.inheritFromUI},href:"https://app.excalidraw.com?utm_source=excalidraw&utm_medium=app&utm_content=welcomeScreenSignedInUser",children:"Excalidraw+"},s):i):n=t("welcomeScreen.app.center_heading"),N(ss,{children:[g(ss.Hints.MenuHint,{children:t("welcomeScreen.app.menuHint")}),g(ss.Hints.ToolbarHint,{}),g(ss.Hints.HelpHint,{}),N(ss.Center,{children:[g(ss.Center.Logo,{}),g(ss.Center.Heading,{children:n}),N(ss.Center.Menu,{children:[g(ss.Center.MenuItemLoadScene,{}),g(ss.Center.MenuItemHelp,{}),e.isCollabEnabled&&g(ss.Center.MenuItemLiveCollaborationTrigger,{onSelect:()=>e.onCollabDialogOpen()}),!Sd&&g(ss.Center.MenuItemLink,{href:"https://plus.excalidraw.com/plus?utm_source=excalidraw&utm_medium=app&utm_content=welcomeScreenGuest",shortcut:null,icon:CV,children:"Sign up"})]})]})]})}),uw=async(e,t,n,i)=>{const s=await MK(),r=`${_B(12)}`,o=await _T(),a=await My(o,Ag(e,t,n,"database")),l=new Blob([a.iv,new Uint8Array(a.encryptedBuffer)],{type:_e.binary}),c=xK(s,`/migrations/scenes/${r}`);await SK(c,l,{customMetadata:{data:JSON.stringify({version:2,name:i}),created:Date.now().toString()}});const u=new Map;for(const d of e)Dn(d)&&n[d.fileId]&&u.set(d.fileId,n[d.fileId]);if(u.size){const d=await hI({files:u,encryptionKey:o,maxBytes:fI});await JI({prefix:`/migrations/files/scenes/${r}`,files:d})}window.open(`https://app.excalidraw.com/import?excalidraw=${r},${o}`)},mCe=({elements:e,appState:t,files:n,name:i,onError:s,onSuccess:r})=>{const{t:o}=dn();return N(Bv,{color:"primary",children:[g("div",{className:"Card-icon",children:g(TY,{style:{"--color-logo-icon":"#fff",width:"2.8rem",height:"2.8rem"}})}),g("h2",{children:"Excalidraw+"}),g("div",{className:"Card-details",children:o("exportDialog.excalidrawplus_description")}),g($e,{className:"Card-button",type:"button",title:o("exportDialog.excalidrawplus_button"),"aria-label":o("exportDialog.excalidrawplus_button"),showAriaLabel:!0,onClick:async()=>{try{Qe("export","eplus",`ui (${gp()})`),await uw(e,t,n,i),r()}catch(a){console.error(a),a.name!=="AbortError"&&s(new Error(o("exportDialog.excalidrawplus_exportError")))}}})]})};class pCe extends ae.Component{constructor(){super(...arguments);F(this,"state",{hasError:!1,sentryEventId:"",localStorage:""})}render(){return this.state.hasError?this.errorSplash():this.props.children}componentDidCatch(n,i){const s={};for(const[r,o]of Object.entries({...localStorage}))try{s[r]=JSON.parse(o)}catch{s[r]=o}U9(r=>{r.setExtras(i);const o=v9(n);this.setState(a=>({hasError:!0,sentryEventId:o,localStorage:JSON.stringify(s)}))})}selectTextArea(n){n.target!==document.activeElement&&(n.preventDefault(),n.target.select())}async createGithubIssue(){let n="";try{const i=(await ye(()=>import("./bug-issue-template-BID_ABWq.js"),__vite__mapDeps([]))).default;n=encodeURIComponent(i(this.state.sentryEventId))}catch(i){console.error(i)}window.open(`https://github.com/excalidraw/excalidraw/issues/new?body=${n}`,"_blank","noopener noreferrer")}errorSplash(){return g("div",{className:"ErrorSplash excalidraw",children:N("div",{className:"ErrorSplash-messageContainer",children:[g("div",{className:"ErrorSplash-paragraph bigger align-center",children:g(Ts,{i18nKey:"errorSplash.headingMain",button:n=>g("button",{onClick:()=>window.location.reload(),children:n})})}),N("div",{className:"ErrorSplash-paragraph align-center",children:[g(Ts,{i18nKey:"errorSplash.clearCanvasMessage",button:n=>g("button",{onClick:()=>{try{localStorage.clear(),window.location.reload()}catch(i){console.error(i)}},children:n})}),g("br",{}),N("div",{className:"smaller",children:[g("span",{role:"img","aria-label":"warning",children:""}),M("errorSplash.clearCanvasCaveat"),g("span",{role:"img","aria-hidden":"true",children:""})]})]}),N("div",{children:[g("div",{className:"ErrorSplash-paragraph",children:M("errorSplash.trackedToSentry",{eventId:this.state.sentryEventId})}),g("div",{className:"ErrorSplash-paragraph",children:g(Ts,{i18nKey:"errorSplash.openIssueMessage",button:n=>g("button",{onClick:()=>this.createGithubIssue(),children:n})})}),g("div",{className:"ErrorSplash-paragraph",children:N("div",{className:"ErrorSplash-details",children:[g("label",{children:M("errorSplash.sceneContent")}),g("textarea",{rows:5,onPointerDown:this.selectTextArea,readOnly:!0,value:this.state.localStorage})]})})]})]})})}}const jK=Yt({isOpen:!1}),UCe=()=>{const e=window.navigator,t=/Apple/.test(e.vendor),n=e.appVersion.indexOf("Win")!==-1;return t?pde:n?bde:H_},bCe=({collabAPI:e,activeRoomLink:t,handleClose:n})=>{const{t:i}=dn(),[,s]=D.useState(!1),r=D.useRef(0),o=D.useRef(null),a="share"in navigator,{onCopy:l,copyStatus:c}=WT(),u=async()=>{var f;try{await au(t)}catch{e.setCollabError(i("errors.copyToSystemClipboardFailed"))}s(!0),r.current&&window.clearTimeout(r.current),r.current=window.setTimeout(()=>{s(!1)},3e3),(f=o.current)==null||f.select()},d=async()=>{try{await navigator.share({title:i("roomDialog.shareTitle"),text:i("roomDialog.shareTitle"),url:t})}catch{}};return N(fe,{children:[g("h3",{className:"ShareDialog__active__header",children:i("labels.liveCollaboration").replace(/\./g,"")}),g(Id,{defaultValue:e.getUsername(),placeholder:"Your name",label:"Your name",onChange:e.setUsername,onKeyDown:f=>f.key===H.ENTER&&n()}),N("div",{className:"ShareDialog__active__linkRow",children:[g(Id,{ref:o,label:"Link",readonly:!0,fullWidth:!0,value:t}),a&&g(io,{size:"large",variant:"icon",label:"Share",icon:UCe(),className:"ShareDialog__active__share",onClick:d}),g(io,{size:"large",label:i("buttons.copyLink"),icon:xp,status:c,onClick:()=>{u(),l()}})]}),N("div",{className:"ShareDialog__active__description",children:[N("p",{children:[N("span",{role:"img","aria-hidden":"true",className:"ShareDialog__active__description__emoji",children:[""," "]}),i("roomDialog.desc_privacy")]}),g("p",{children:i("roomDialog.desc_exitSession")})]}),g("div",{className:"ShareDialog__active__actions",children:g(io,{size:"large",variant:"outlined",color:"danger",label:i("roomDialog.button_stopSession"),icon:afe,onClick:()=>{Qe("share","room closed"),e.stopCollaboration(),e.isCollaborating()||n()}})})]})},yCe=e=>{const{t}=dn(),{collabAPI:n}=e,i=n?N(fe,{children:[g("div",{className:"ShareDialog__picker__header",children:t("labels.liveCollaboration").replace(/\./g,"")}),N("div",{className:"ShareDialog__picker__description",children:[g("div",{style:{marginBottom:"1em"},children:t("roomDialog.desc_intro")}),t("roomDialog.desc_privacy")]}),g("div",{className:"ShareDialog__picker__button",children:g(io,{size:"large",label:t("roomDialog.button_startSession"),icon:ofe,onClick:()=>{Qe("share","room creation",`ui (${gp()})`),n.startCollaboration(null)}})}),e.type==="share"&&g("div",{className:"ShareDialog__separator",children:g("span",{children:t("shareDialog.or")})})]}):null;return N(fe,{children:[i,e.type==="share"&&N(fe,{children:[g("div",{className:"ShareDialog__picker__header",children:t("exportDialog.link_title")}),g("div",{className:"ShareDialog__picker__description",children:t("exportDialog.link_details")}),g("div",{className:"ShareDialog__picker__button",children:g(io,{size:"large",label:t("exportDialog.link_button"),icon:x6,onClick:async()=>{await e.onExportToBackend(),e.handleClose()}})})]})]})},ECe=e=>{const t=fh(zK);return g(ir,{size:"small",onCloseRequest:e.handleClose,title:!1,children:g("div",{className:"ShareDialog",children:e.collabAPI&&t?g(bCe,{collabAPI:e.collabAPI,activeRoomLink:t,handleClose:e.handleClose}):g(yCe,{...e})})})},vCe=e=>{const[t,n]=$h(jK),{openDialog:i}=wi();return D.useEffect(()=>{i&&n({isOpen:!1})},[i,n]),t.isOpen?g(ECe,{handleClose:()=>n({isOpen:!1}),collabAPI:e.collabAPI,onExportToBackend:e.onExportToBackend,type:t.type}):null},pN=()=>{var e;return(e=window.matchMedia)==null?void 0:e.call(window,"(prefers-color-scheme: dark)")},wCe=()=>{const[e,t]=D.useState(()=>localStorage.getItem(Sn.LOCAL_STORAGE_THEME)||ke.LIGHT),[n,i]=D.useState(ke.LIGHT);return D.useEffect(()=>{const s=pN(),r=a=>{i(a.matches?ke.DARK:ke.LIGHT)};e==="system"&&(s==null||s.addEventListener("change",r));const o=a=>{!a[H.CTRL_OR_CMD]&&a.altKey&&a.shiftKey&&a.code===tt.D&&(a.preventDefault(),a.stopImmediatePropagation(),t(n===ke.DARK?ke.LIGHT:ke.DARK))};return document.addEventListener(te.KEYDOWN,o,{capture:!0}),()=>{s==null||s.removeEventListener("change",r),document.removeEventListener(te.KEYDOWN,o,{capture:!0})}},[e,n,t]),D.useLayoutEffect(()=>{var s;localStorage.setItem(Sn.LOCAL_STORAGE_THEME,e),i(e==="system"?(s=pN())!=null&&s.matches?ke.DARK:ke.LIGHT:e)},[e]),{editorTheme:n,appTheme:e,setAppTheme:t}},_Ce=({excalidrawAPI:e})=>N(fe,{children:[g(jve,{generate:async({frame:t,children:n})=>{const i=e.getAppState(),s=await NEe({elements:n,appState:{...i,exportBackground:!0,viewBackgroundColor:i.viewBackgroundColor},exportingFrame:t,files:e.getFiles(),mimeType:_e.jpg}),r=await oX(s),o=sz(n),a=await fetch("https://oss-ai.excalidraw.com/v1/ai/diagram-to-code/generate",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({texts:o,image:r,theme:i.theme})});if(!a.ok){const l=await a.text(),c=Ore(l);if(!c)throw new Error(l);if(c.statusCode===429)return{html:`<html>
                <body style="margin: 0; text-align: center">
                <div style="display: flex; align-items: center; justify-content: center; flex-direction: column; height: 100vh; padding: 0 60px">
                  <div style="color:red">Too many requests today,</br>please try again tomorrow!</div>
                  </br>
                  </br>
                  <div>You can also try <a href="https://plus.excalidraw.com/plus?utm_source=excalidraw&utm_medium=app&utm_content=d2c" target="_blank" rel="noopener">Excalidraw+</a> to get more requests.</div>
                </div>
                </body>
                </html>`};throw new Error(c.message||l)}try{const{html:l}=await a.json();if(!l)throw new Error("Generation failed (invalid response)");return{html:l}}catch{throw new Error("Generation failed (invalid response)")}}}),g(UY,{onTextSubmit:async t=>{try{const n=await fetch("https://oss-ai.excalidraw.com/v1/ai/text-to-diagram/generate",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({prompt:t})}),i=n.headers.has("X-Ratelimit-Limit")?parseInt(n.headers.get("X-Ratelimit-Limit")||"0",10):void 0,s=n.headers.has("X-Ratelimit-Remaining")?parseInt(n.headers.get("X-Ratelimit-Remaining")||"0",10):void 0,r=await n.json();if(!n.ok){if(n.status===429)return{rateLimit:i,rateLimitRemaining:s,error:new Error("Too many requests today, please try again tomorrow!")};throw new Error(r.message||"Generation failed...")}const o=r.generatedResponse;if(!o)throw new Error("Generation failed...");return{generatedResponse:o,rateLimit:i,rateLimitRemaining:s}}catch{throw new Error("Request failed")}}})]}),TCe="REQUEST_SCENE",d2="https://app.excalidraw.com",ICe=async({rawElementsString:e,rawAppStateString:t})=>{if(!e||!t)throw new qr("Elements or appstate is missing.");try{const n=JSON.parse(e);if(!n.length)throw new qr("Scene is empty, nothing to export.");const i=JSON.parse(t),s=n.reduce((o,a)=>("fileId"in a&&a.fileId&&o.push(a.fileId),o),[]),r=await xi.fileStorage.getFiles(s);return{type:"SCENE_DATA",elements:n,appState:i,files:r}}catch(n){throw n instanceof qr?n:new qr("Failed to parse scene data.")}},SCe=async({token:e,publicKey:t})=>{try{const[n,i,s]=e.split(".");if(!n||!i||!s)throw new qr("Invalid JWT format");const r=wR(i),o=wR(s),a=`${n}.${i}`,l=Uint8Array.from(o,p=>p.charCodeAt(0)),c=t.replace(/-----\w+ PUBLIC KEY-----/g,""),u=Uint8Array.from(atob(c),p=>p.charCodeAt(0)),d=await crypto.subtle.importKey("spki",u,{name:"RSASSA-PKCS1-v1_5",hash:"SHA-256"},!0,["verify"]);if(!await crypto.subtle.verify("RSASSA-PKCS1-v1_5",d,l,new TextEncoder().encode(a)))throw new Error("Invalid JWT");const h=JSON.parse(r),m=Math.floor(Date.now()/1e3);if(h.exp&&h.exp<m)throw new Error("JWT has expired")}catch(n){throw console.error("Failed to verify JWT:",n),new Error(n instanceof Error?n.message:"Invalid JWT")}},xCe=()=>{const e=D.useRef(!1);return D.useLayoutEffect(()=>{const t=async n=>{if(n.origin!==d2)throw new qr("Invalid origin");if(n.data.type===TCe){if(!n.data.jwt)throw new qr("JWT is missing");try{try{await SCe({token:n.data.jwt,publicKey:`MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEApQ0jM9Qz8TdFLzcuAZZX
/WvuKSOJxiw6AR/ZcE3eFQWM/mbFdhQgyK8eHGkKQifKzH1xUZjCxyXcxW6ZO02t
kPOPxhz+nxUrIoWCD/V4NGmUA1lxwHuO21HN1gzKrN3xHg5EGjyouR9vibT9VDGF
gq6+4Ic/kJX+AD2MM7Yre2+FsOdysrmuW2Fu3ahuC1uQE7pOe1j0k7auNP0y1q53
PrB8Ts2LUpepWC1l7zIXFm4ViDULuyWXTEpUcHSsEH8vpd1tckjypxCwkipfZsXx
iPszy0o0Dx2iArPfWMXlFAI9mvyFCyFC3+nSvfyAUb2C4uZgCwAuyFh/ydPF4DEE
PQIDAQAB`})}catch(s){throw console.error(`Failed to verify JWT: ${s.message}`),new qr("Failed to verify JWT")}const i=await ICe({rawAppStateString:localStorage.getItem(Sn.LOCAL_STORAGE_APP_STATE),rawElementsString:localStorage.getItem(Sn.LOCAL_STORAGE_ELEMENTS)});n.source.postMessage(i,{targetOrigin:d2})}catch(i){const s={type:"ERROR",message:i instanceof qr?i.message:"Failed to export scene data"};n.source.postMessage(s,{targetOrigin:d2})}}};if(window.addEventListener("message",t),!e.current){e.current=!0;const n={type:"READY"};window.parent.postMessage(n,d2)}return()=>{window.removeEventListener("message",t)}},[]),null};var CCe={};xY();window.EXCALIDRAW_THROTTLE_RENDER=!0;let Sf=null;window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),Sf=e});let YK=!1;if(window.self!==window.top)try{const e=new URL(document.referrer),t=new URL(window.location.href);e.origin===t.origin&&(YK=!0)}catch{}const UN={title:M("overwriteConfirm.modal.shareableLink.title"),description:g(Ts,{i18nKey:"overwriteConfirm.modal.shareableLink.description",bold:e=>g("strong",{children:e}),br:()=>g("br",{})}),actionLabel:M("overwriteConfirm.modal.shareableLink.button"),color:"danger"},dw=async e=>{var c,u;const n=new URLSearchParams(window.location.search).get("id"),i=window.location.hash.match(/^#json=([a-zA-Z0-9_-]+),([a-zA-Z0-9_-]+)$/),s=window.location.hash.match(/^#url=(.*)$/),r=RY();let o=await cN(null,null,r),a=gxe(window.location.href);const l=!!(n||i||a);if(l)if(!o.elements.length||a||await Lv(UN))i&&(o=await cN(i[1],i[2],r)),o.scrollToContent=!0,a||window.history.replaceState({},bc,window.location.origin);else{if(document.hidden)return new Promise((d,f)=>{window.addEventListener("focus",()=>dw(e).then(d).catch(f),{once:!0})});a=null,window.history.replaceState({},bc,window.location.origin)}else if(s){window.history.replaceState({},bc,window.location.origin);const d=s[1];try{const f=await fetch(window.decodeURIComponent(d)),h=await AT(await f.blob(),null,null);if(!o.elements.length||await Lv(UN))return{scene:h,isExternalScene:l}}catch{return{scene:{appState:{errorMessage:M("alerts.invalidSceneUrl")}},isExternalScene:l}}}if(a&&e.collabAPI){const{excalidrawAPI:d}=e,f=await e.collabAPI.startCollaboration(a);return{scene:{...f,appState:{...eX({...f==null?void 0:f.appState,theme:((c=r==null?void 0:r.appState)==null?void 0:c.theme)||((u=f==null?void 0:f.appState)==null?void 0:u.theme)},d.getAppState()),isLoading:!1},elements:dI((f==null?void 0:f.elements)||[],d.getSceneElementsIncludingDeleted(),d.getAppState())},isExternalScene:!0,id:a.roomId,key:a.roomKey}}else if(o)return l&&i?{scene:o,isExternalScene:l,id:i[1],key:i[2]}:{scene:o,isExternalScene:!1};return{scene:null,isExternalScene:!1}},ACe=()=>{const[e,t]=D.useState(""),n=Rre(),{editorTheme:i,appTheme:s,setAppTheme:r}=wCe(),[o,a]=dCe(),l=D.useRef({promise:null});l.current.promise||(l.current.promise=j5());const c=D.useRef(null);D.useEffect(()=>{Qe("load","frame",gp()),setTimeout(()=>{Qe("load","version",p4())},kse)},[]);const[u,d]=CX(),[,f]=$h(jK),[h]=$h(FK),[m]=uwe(cw,()=>lN(window.location.href)),p=fh(lw);HEe({excalidrawAPI:u,adapter:U5,migrationAdapter:Rxe});const[,U]=D.useState(!1);D.useEffect(()=>{},[u]),D.useEffect(()=>{if(!u||!n&&!h)return;const R=(z,V=!1)=>{var $;if(z.scene)if(h!=null&&h.isCollaborating())z.scene.elements&&h.fetchImageFilesFromFirebase({elements:z.scene.elements,forceFetchFiles:!0}).then(({loadedFiles:j,erroredFiles:W})=>{u.addFiles(j),j1({excalidrawAPI:u,erroredFiles:W,elements:u.getSceneElementsIncludingDeleted()})});else{const j=(($=z.scene.elements)==null?void 0:$.reduce((W,Q)=>Dn(Q)?W.concat(Q.fileId):W,[]))||[];z.isExternalScene?RK(`${MY.shareLinkFiles}/${z.id}`,z.key,j).then(({loadedFiles:W,erroredFiles:Q})=>{u.addFiles(W),j1({excalidrawAPI:u,erroredFiles:Q,elements:u.getSceneElementsIncludingDeleted()})}):V&&(j.length&&xi.fileStorage.getFiles(j).then(({loadedFiles:W,erroredFiles:Q})=>{W.length&&u.addFiles(W),j1({excalidrawAPI:u,erroredFiles:Q,elements:u.getSceneElementsIncludingDeleted()})}),xi.fileStorage.clearObsoleteFiles({currentFileIds:j}))}};dw({collabAPI:h,excalidrawAPI:u}).then(async z=>{R(z,!0),l.current.promise.resolve(z.scene)});const P=async z=>{z.preventDefault(),Sv()||(h!=null&&h.isCollaborating()&&!lN(window.location.href)&&h.stopCollaboration(!1),u.updateScene({appState:{isLoading:!0}}),dw({collabAPI:h,excalidrawAPI:u}).then($=>{R($),$.scene&&u.updateScene({...$.scene,...Td($.scene,null,null,{repairBindings:!0}),captureUpdate:K.IMMEDIATELY})}))},L=sl(()=>{if(!document.hidden&&(h&&!h.isCollaborating()||n)){if(uN(Sn.VERSION_DATA_STATE)){const z=RY(),V=kY();a(GK()),u.updateScene({...z,captureUpdate:K.NEVER}),U5.load().then($=>{$&&u.updateLibrary({libraryItems:$.libraryItems})}),h==null||h.setUsername(V||"")}if(uN(Sn.VERSION_FILES)){const z=u.getSceneElementsIncludingDeleted(),V=u.getFiles(),$=(z==null?void 0:z.reduce((j,W)=>Dn(W)&&!V[W.fileId]?j.concat(W.fileId):j,[]))||[];$.length&&xi.fileStorage.getFiles($).then(({loadedFiles:j,erroredFiles:W})=>{j.length&&u.addFiles(j),j1({excalidrawAPI:u,erroredFiles:W,elements:u.getSceneElementsIncludingDeleted()})})}}},ewe),X=()=>{xi.flushSave()},G=z=>{(z.type===te.BLUR||document.hidden)&&xi.flushSave(),(z.type===te.VISIBILITY_CHANGE||z.type===te.FOCUS)&&L()};return window.addEventListener(te.HASHCHANGE,P,!1),window.addEventListener(te.UNLOAD,X,!1),window.addEventListener(te.BLUR,G,!1),document.addEventListener(te.VISIBILITY_CHANGE,G,!1),window.addEventListener(te.FOCUS,G,!1),()=>{window.removeEventListener(te.HASHCHANGE,P,!1),window.removeEventListener(te.UNLOAD,X,!1),window.removeEventListener(te.BLUR,G,!1),window.removeEventListener(te.FOCUS,G,!1),document.removeEventListener(te.VISIBILITY_CHANGE,G,!1)}},[n,h,u,a]),D.useEffect(()=>{const R=P=>{xi.flushSave(),u&&xi.fileStorage.shouldPreventUnload(u.getSceneElements())&&(CCe.VITE_APP_DISABLE_PREVENT_UNLOAD!=="true"?P9(P):console.warn("preventing unload disabled (VITE_APP_DISABLE_PREVENT_UNLOAD)"))};return window.addEventListener(te.BEFORE_UNLOAD,R),()=>{window.removeEventListener(te.BEFORE_UNLOAD,R)}},[u]);const b=(R,P,L)=>{h!=null&&h.isCollaborating()&&h.syncElements(R),xi.isSavePaused()||xi.save(R,P,L,()=>{if(u){let X=!1;const G=u.getSceneElementsIncludingDeleted().map(z=>{if(xi.fileStorage.shouldUpdateImageElementStatus(z)){const V=Te(z,{status:"saved"});return V!==z&&(X=!0),V}return z});X&&u.updateScene({elements:G,captureUpdate:K.NEVER})}}),c.current&&u&&Hxe(c.current,P,window.devicePixelRatio,()=>U(X=>!X))},[y,w]=D.useState(null),v=async(R,P,L)=>{if(R.length===0)throw new Error(M("alerts.cannotExportEmptyCanvas"));try{const{url:X,errorMessage:G}=await yxe(R,{...P,viewBackgroundColor:P.exportBackground?P.viewBackgroundColor:ia().viewBackgroundColor},L);if(G)throw new Error(G);X&&w(X)}catch(X){if(X.name!=="AbortError"){const{width:G,height:z}=P;throw console.error(X,{width:G,height:z,devicePixelRatio:window.devicePixelRatio}),new Error(X.message)}}},I=(R,P)=>g(cwe,{setToast:L=>u.setToast({message:L}),appState:P,elements:R}),C=fh(BK),_=fh(rb),T=D.useCallback(()=>f({isOpen:!0,type:"collaborationOnly"}),[f]);if(YK)return g("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",height:"100%"},children:g("h1",{children:"I'm not a pretzel!"})});const k={label:"Excalidraw+",category:st.links,predicate:!0,icon:g("div",{style:{width:14},children:W4}),keywords:["plus","cloud","server"],perform:()=>{window.open("https://plus.excalidraw.com/plus?utm_source=excalidraw&utm_medium=app&utm_content=command_palette","_blank")}},S={label:"Sign up",category:st.links,predicate:!0,icon:g("div",{style:{width:14},children:W4}),keywords:["excalidraw","plus","cloud","server","signin","login","signup"],perform:()=>{window.open("https://app.excalidraw.com?utm_source=excalidraw&utm_medium=app&utm_content=command_palette","_blank")}};return g("div",{style:{height:"100%"},className:re("excalidraw-app",{"is-collaborating":m}),children:N(AY,{excalidrawAPI:d,onChange:b,initialData:l.current.promise,isCollaborating:m,onPointerUpdate:h==null?void 0:h.onPointerUpdate,UIOptions:{canvasActions:{toggleTheme:!0,export:{onExportToBackend:v,renderCustomUI:u?(R,P,L)=>g(mCe,{elements:R,appState:P,files:L,name:u.getName(),onError:X=>{u==null||u.updateScene({appState:{errorMessage:X.message}})},onSuccess:()=>{u.updateScene({appState:{openDialog:null}})}}):void 0}}},langCode:o,renderCustomStats:I,detectScroll:!1,handleKeyboardGlobally:!0,autoFocus:!0,theme:i,renderTopRightUI:R=>R||!h||n?null:N("div",{className:"top-right-ui",children:[p.message&&g(PK,{collabError:p}),g(_Y,{isCollaborating:m,onSelect:()=>f({isOpen:!0,type:"share"})})]}),onLinkOpen:(R,P)=>{R.link&&ch(R.link)&&(P.preventDefault(),u==null||u.scrollToContent(R.link,{animate:!0}))},children:[g(hCe,{onCollabDialogOpen:T,isCollaborating:m,isCollabEnabled:!n,theme:s,setTheme:R=>r(R),refresh:()=>U(R=>!R)}),g(gCe,{onCollabDialogOpen:T,isCollabEnabled:!n}),N(Bu,{children:[g(Bu.Actions.ExportToImage,{}),g(Bu.Actions.SaveToDisk,{}),u&&g(Bu.Action,{title:M("overwriteConfirm.action.excalidrawPlus.title"),actionLabel:M("overwriteConfirm.action.excalidrawPlus.button"),onClick:()=>{uw(u.getSceneElements(),u.getAppState(),u.getFiles(),u.getName())},children:M("overwriteConfirm.action.excalidrawPlus.description")})]}),g(jxe,{onChange:()=>u==null?void 0:u.refresh()}),u&&g(_Ce,{excalidrawAPI:u}),g(CY,{}),m&&C&&g("div",{className:"alertalert--warning",children:M("alerts.collabOfflineWarning")}),_&&g("div",{className:"alert alert--danger",children:M("alerts.localStorageQuotaExceeded")}),y&&g(Kve,{link:y,onCloseRequest:()=>w(null),setErrorMessage:t}),u&&!n&&g(Nxe,{excalidrawAPI:u}),g(vCe,{collabAPI:h,onExportToBackend:async()=>{if(u)try{await v(u.getSceneElements(),u.getAppState(),u.getFiles())}catch(R){t(R.message)}}}),e&&g(YT,{onClose:()=>t(""),children:e}),g(nD,{customCommandPaletteItems:[{label:M("labels.liveCollaboration"),category:st.app,keywords:["team","multiplayer","share","public","session","invite"],icon:V_,perform:()=>{f({isOpen:!0,type:"collaborationOnly"})}},{label:M("roomDialog.button_stopSession"),category:st.app,predicate:()=>!!(h!=null&&h.isCollaborating()),keywords:["stop","session","end","leave","close","exit","collaboration"],perform:()=>{h&&(h.stopCollaboration(),h.isCollaborating()||f({isOpen:!1}))}},{label:M("labels.share"),category:st.app,predicate:!0,icon:H_,keywords:["link","shareable","readonly","export","publish","snapshot","url","collaborate","invite"],perform:async()=>{f({isOpen:!0,type:"share"})}},{label:"GitHub",icon:B_,category:st.links,predicate:!0,keywords:["issues","bugs","requests","report","features","social","community"],perform:()=>{window.open("https://github.com/excalidraw/excalidraw","_blank","noopener noreferrer")}},{label:M("labels.followUs"),icon:yV,category:st.links,predicate:!0,keywords:["twitter","contact","social","community"],perform:()=>{window.open("https://x.com/excalidraw","_blank","noopener noreferrer")}},{label:M("labels.discordChat"),category:st.links,predicate:!0,icon:bV,keywords:["chat","talk","contact","bugs","requests","report","feedback","suggestions","social","community"],perform:()=>{window.open("https://discord.gg/UexuTaE","_blank","noopener noreferrer")}},{label:"YouTube",icon:AV,category:st.links,predicate:!0,keywords:["features","tutorials","howto","help","community"],perform:()=>{window.open("https://youtube.com/@excalidraw","_blank","noopener noreferrer")}},...Sd?[{...S,label:"Sign in / Go to Excalidraw+"}]:[k,S],{label:M("overwriteConfirm.action.excalidrawPlus.button"),category:st.export,icon:Ude,predicate:!0,keywords:["plus","export","save","backup"],perform:()=>{u&&uw(u.getSceneElements(),u.getAppState(),u.getFiles(),u.getName())}},{...nD.defaultItems.toggleTheme,perform:()=>{r(i===ke.DARK?ke.LIGHT:ke.DARK)}},{label:M("labels.installPWA"),category:st.app,predicate:()=>!!Sf,perform:()=>{Sf&&(Sf.prompt(),Sf.userChoice.then(()=>{Sf=null}))}}]}),HK()&&u&&g($xe,{appState:u.getAppState(),scale:window.devicePixelRatio,ref:c})]})})},MCe=()=>window.location.pathname==="/excalidraw-plus-export"?g(xCe,{}):g(pCe,{children:g(Bue,{store:Xr,children:g(ACe,{})})});window.__EXCALIDRAW_SHA__="4e0441eeb413ad7234f65cbb8fbb397bc715ff46";const kCe=document.getElementById("root"),RCe=vJ.createRoot(kCe);TJ();RCe.render(g(D.StrictMode,{children:g(MCe,{})}));export{ye as _,La as c,bl as g};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/subset-worker.chunk-CVR6pt27.js","assets/subset-shared.chunk-D3ioWSie.js","assets/pica-CjMP7JXY.js","assets/_commonjs-dynamic-modules-TDtrdbi3.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
//# sourceMappingURL=index-DRrONsog.js.map
